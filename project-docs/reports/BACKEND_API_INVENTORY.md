# üéØ BACKEND API INVENTORY - Mentara Platform

**Generated by Backend Agent | Date: 2025-01-14**  
**Purpose**: Comprehensive documentation of all backend controllers and endpoints for testing and validation

---

## üìä **Executive Summary**

- **Total Controllers Identified**: 18+
- **Total Services**: 25+
- **Database Models**: 16+
- **API Architecture**: Enterprise-level NestJS with advanced features
- **Security**: Role-based access control (admin, therapist, client, moderator)
- **Real-time**: WebSocket support for messaging and meetings

---

## üîê **Authentication & User Management**

### **AuthController** (`/auth`)
| Endpoint | Method | Description | Guards | Rate Limit |
|----------|---------|-------------|---------|------------|
| `/auth/register/client` | POST | Register new client account | ClerkAuthGuard | 5/5min |
| `/auth/register/therapist` | POST | Register new therapist account | ClerkAuthGuard | 3/10min |
| `/auth/me` | GET | Get current user profile | ClerkAuthGuard | - |
| `/auth/users` | GET | Get all users (admin only) | ClerkAuthGuard | - |
| `/auth/force-logout` | POST | Force logout user | ClerkAuthGuard | 20/5min |

### **UsersController** (`/users`)
| Endpoint | Method | Description | Guards | Access Level |
|----------|---------|-------------|---------|--------------|
| `/users` | GET | Get all active users | AdminAuthGuard | Admin Only |
| `/users/all-including-inactive` | GET | Get all users including inactive | AdminAuthGuard | Admin Only |
| `/users/:id` | GET | Get specific user | ClerkAuthGuard | Self/Admin |
| `/users/:id` | PUT | Update user profile | ClerkAuthGuard | Self/Admin |
| `/users/:id` | DELETE | Deactivate user account | ClerkAuthGuard | Self/Admin |
| `/users/:id/deactivate` | POST | Admin deactivate user | AdminAuthGuard | Admin Only |
| `/users/:id/reactivate` | POST | Admin reactivate user | AdminAuthGuard | Admin Only |

---

## üë®‚Äç‚öïÔ∏è **Therapist Management**

### **TherapistManagementController** (`/therapist-management`)
- **Status**: Basic controller structure identified
- **Services**: TherapistManagementService, WorksheetsService
- **Functionality**: Therapist profile and worksheet management

### **TherapistApplicationController** (`/therapist-application`)
- **Purpose**: Handle therapist application submissions and status updates
- **DTOs**: TherapistApplicationDto, ApplicationStatusUpdateDto
- **Response Types**: TherapistApplicationResponse

### **TherapistRecommendationController** (`/therapist-recommendation`)
- **Purpose**: Advanced therapist matching and recommendation system
- **Service**: TherapistRecommendationService
- **Features**: AI-powered therapist matching

### **TherapistProfileController** (`/therapist/profile`)
- **Purpose**: Therapist profile management
- **Functionality**: Profile CRUD operations

### **TherapistClientController** (`/therapist/client`)
- **Purpose**: Therapist-client relationship management
- **Functionality**: Client assignment and management

### **TherapistWorksheetController** (`/therapist/worksheet`)
- **Purpose**: Therapist worksheet management
- **Functionality**: Assignment and review of client worksheets

---

## üìÖ **Booking & Sessions**

### **BookingController** (`/booking`)
- **Purpose**: Session scheduling and availability management
- **Services**: BookingService, ConflictDetectionService, SlotGeneratorService
- **Features**: 
  - Availability validation
  - Conflict detection
  - Time slot generation
  - Automated scheduling

### **SessionsController** (`/sessions`)
- **Purpose**: Therapy session tracking and management
- **Service**: SessionsService
- **Functionality**: Session lifecycle management

### **MeetingsController** (`/meetings`)
- **Purpose**: Video meeting coordination
- **Service**: MeetingsService
- **Features**: Real-time meeting management with WebSocket

---

## üí¨ **Communication & Community**

### **MessagingController** (`/messaging`)
- **Purpose**: Real-time messaging system
- **Service**: MessagingService
- **Features**: 
  - WebSocket integration
  - Message persistence
  - Conversation management
  - Typing indicators
  - Message reactions

### **CommunitiesController** (`/communities`)
- **Purpose**: Mental health support communities
- **Service**: CommunitiesService, CommunityAssignmentService
- **Features**: 
  - 30+ pre-configured communities
  - Illness-specific assignments
  - Community statistics

### **PostsController** (`/posts`)
- **Purpose**: Community post management
- **Service**: PostsService
- **Functionality**: Create, read, update, delete posts

### **CommentsController** (`/comments`)
- **Purpose**: Post comment management
- **Service**: CommentsService
- **Functionality**: Comment CRUD operations

---

## üß† **Assessments & AI**

### **PreAssessmentController** (`/pre-assessment`)
- **Purpose**: Mental health assessment processing
- **Service**: PreAssessmentService
- **Features**:
  - 201-item questionnaire processing
  - 13 assessment scales
  - AI service integration
  - Severity level calculation

### **OnboardingController** (`/onboarding`)
- **Purpose**: User onboarding flow management
- **Service**: OnboardingService
- **Features**: Multi-step onboarding with progress tracking

---

## üìã **Content & Workflows**

### **WorksheetsController** (`/worksheets`)
- **Purpose**: Therapy worksheet management
- **Service**: WorksheetsService
- **Functionality**: Worksheet assignment and submission

### **WorksheetUploadsController** (`/worksheet-uploads`)
- **Purpose**: File upload handling for worksheets
- **Features**: Secure file upload and validation

### **ReviewsController** (`/reviews`)
- **Purpose**: Therapist review and rating system
- **Service**: ReviewsService
- **Features**:
  - Review creation and moderation
  - Rating statistics
  - Review status management

---

## üîß **Administrative & Support**

### **AdminController** (`/admin`)
- **Purpose**: Main admin dashboard controller
- **Service**: AdminService
- **Functionality**: General admin operations

### **AdminAccountController** (`/admin/account`)
- **Purpose**: Admin account management
- **Functionality**: Admin-specific account operations

### **AdminAnalyticsController** (`/admin/analytics`)
- **Purpose**: System analytics and reporting
- **Functionality**: Usage metrics and system insights

### **AdminModerationController** (`/admin/moderation`)
- **Purpose**: Content moderation tools
- **Functionality**: Content review and moderation actions

### **AdminTherapistController** (`/admin/therapist`)
- **Purpose**: Therapist administration
- **Functionality**: Therapist account management

### **AdminUserController** (`/admin/user`)
- **Purpose**: User administration
- **Functionality**: User account management

### **ModeratorController** (`/moderator`)
- **Purpose**: Content moderation interface
- **Service**: ModeratorService
- **Functionality**: Community moderation tools

---

## üìä **Analytics & Data**

### **AnalyticsController** (`/analytics`)
- **Purpose**: Platform analytics and metrics
- **Service**: AnalyticsService
- **Functionality**: Usage analytics and insights

### **DashboardController** (`/dashboard`)
- **Purpose**: Dashboard data aggregation
- **Service**: DashboardService
- **Functionality**: Role-specific dashboard data

### **SearchController** (`/search`)
- **Purpose**: Platform-wide search functionality
- **Service**: SearchService
- **Functionality**: Content and user search

---

## üîê **System & Infrastructure**

### **FilesController** (`/files`)
- **Purpose**: File upload and management
- **Service**: FilesService
- **Features**:
  - Supabase Storage integration
  - AWS S3 support
  - File validation and security

### **NotificationsController** (`/notifications`)
- **Purpose**: User notification system
- **Service**: NotificationsService
- **Functionality**: Notification delivery and management

### **BillingController** (`/billing`)
- **Purpose**: Payment and billing management
- **Service**: BillingService
- **Functionality**: Payment processing and invoicing

### **AuditLogsController** (`/audit-logs`)
- **Purpose**: System audit and logging
- **Service**: AuditLogsService
- **Functionality**: Comprehensive system audit trail

### **ClientController** (`/client`)
- **Purpose**: Client-specific functionality
- **Service**: ClientService
- **Functionality**: Client dashboard and features

---

## üéØ **Advanced Features Identified**

### **Real-time Communication**
- **MessagingGateway**: WebSocket messaging
- **MeetingsGateway**: Video meeting coordination
- **Event-driven Architecture**: Comprehensive domain events

### **Advanced Matching System**
- **AdvancedMatchingService**: AI-powered therapist matching
- **CompatibilityAnalysisService**: Compatibility assessment
- **MatchingAnalyticsService**: Matching performance analytics

### **Event System**
- **EventBusService**: Domain event handling
- **Event Categories**: User, Booking, Messaging, Assessment, Billing, Social, System
- **Comprehensive Events**: 50+ domain events across all features

---

## ‚úÖ **Next Steps for Testing**

### **Phase 1 Priorities**
1. **Validate DTOs**: Ensure all DTOs match frontend expectations
2. **Test Authentication Flow**: All auth endpoints and guards
3. **Verify Role-based Access**: Admin, therapist, client, moderator permissions
4. **Check Rate Limiting**: Verify rate limit implementations

### **Phase 2 Priorities**
1. **Advanced Features**: Test matching algorithms and analytics
2. **Real-time Features**: WebSocket functionality
3. **Integration Points**: External service connections
4. **Database Operations**: Complex queries and relationships

### **Phase 3 Priorities**
1. **Performance Testing**: Load testing and optimization
2. **Security Validation**: Comprehensive security audit
3. **Error Handling**: Exception scenarios and edge cases
4. **Documentation**: API documentation completion

---

**Status**: ‚úÖ **Phase 1 Controller Analysis Complete**  
**Next Phase**: DTO & Validation Testing