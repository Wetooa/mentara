// Client-Therapist Request System
model ClientTherapistRequest {
  id          String              @id @default(uuid())
  clientId    String
  therapistId String
  
  // Request status and metadata
  status      ClientRequestStatus @default(PENDING)
  priority    RequestPriority     @default(NORMAL)
  
  // Timing
  requestedAt   DateTime  @default(now())
  respondedAt   DateTime?
  expiresAt     DateTime? // Auto-expire after 7 days
  
  // Messages and communication
  clientMessage     String? @db.Text // Initial message from client
  therapistResponse String? @db.Text // Response from therapist
  
  // Recommendation context
  recommendationRank Int?   // Position in original recommendation list (1st, 2nd, etc.)
  matchScore         Float? // Original compatibility score
  
  // Relations
  client    Client    @relation(fields: [clientId], references: [userId], onDelete: Cascade)
  therapist Therapist @relation(fields: [therapistId], references: [userId], onDelete: Cascade)
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  
  // Constraints and indexes
  @@unique([clientId, therapistId]) // One active request per client-therapist pair
  @@index([status])
  @@index([requestedAt])
  @@index([expiresAt])
  @@index([clientId])
  @@index([therapistId])
}

enum ClientRequestStatus {
  PENDING     // Waiting for therapist response
  ACCEPTED    // Therapist accepted the client
  DECLINED    // Therapist declined the client
  EXPIRED     // Request expired without response
  CANCELLED   // Client cancelled the request
  WITHDRAWN   // Client withdrew after therapist acceptance
}

enum RequestPriority {
  LOW
  NORMAL
  HIGH
  URGENT
}