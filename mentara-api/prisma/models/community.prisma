model Community {
    id                   String               @id @default(uuid())
    name                 String               @unique
    slug                 String               @unique
    description          String?
    illness              String?              // Associated illness/condition
    imageUrl             String?
    isActive             Boolean              @default(true)
    isPrivate            Boolean              @default(false)
    memberCount          Int                  @default(0)
    postCount            Int                  @default(0)
    createdAt            DateTime             @default(now())
    updatedAt            DateTime             @updatedAt
    memberships          Membership[]
    posts                Post[]
    moderatorCommunities ModeratorCommunity[]

    @@index([name])
    @@index([slug])
    @@index([illness])
}

model Membership {
    id          String    @id @default(uuid())
    communityId String
    role        String    @default("member") // member, moderator, admin
    joinedAt    DateTime  @default(now())
    community   Community @relation(fields: [communityId], references: [id])
    user        User?     @relation(fields: [userId], references: [id])
    userId      String?

    @@unique([userId, communityId])
    @@index([userId])
    @@index([communityId])
}
