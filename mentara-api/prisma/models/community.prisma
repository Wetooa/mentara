model Community {
    id                   String               @id @default(uuid())
    name                 String               @unique
    slug                 String               @unique
    description          String
    imageUrl             String
    createdAt            DateTime             @default(now())
    updatedAt            DateTime             @updatedAt
    memberships          Membership[]
    moderatorCommunities ModeratorCommunity[]
    roomGroups           RoomGroup[]

    @@index([name])
    @@index([slug])
}

model Membership {
    id          String    @id @default(uuid())
    communityId String
    role        String    @default("member") // member, moderator, admin
    joinedAt    DateTime  @default(now())
    community   Community @relation(fields: [communityId], references: [id])
    user        User?     @relation(fields: [userId], references: [id])
    userId      String?

    @@unique([userId, communityId])
    @@index([userId])
    @@index([communityId])
}

model ModeratorCommunity {
    id          String   @id @default(uuid())
    moderatorId String
    communityId String
    assignedAt  DateTime @default(now())

    moderator Moderator @relation(fields: [moderatorId], references: [userId], onDelete: Cascade)
    community Community @relation(fields: [communityId], references: [id], onDelete: Cascade)

    @@unique([moderatorId, communityId])
    @@index([moderatorId])
    @@index([communityId])
}

model RoomGroup {
    id          String    @id @default(uuid())
    name        String
    order       Int // for UI ordering
    community   Community @relation(fields: [communityId], references: [id])
    communityId String
    rooms       Room[]
}

model Room {
    id          String    @id @default(uuid())
    name        String
    order       Int
    roomGroup   RoomGroup @relation(fields: [roomGroupId], references: [id])
    roomGroupId String
    posts       Post[]
} 