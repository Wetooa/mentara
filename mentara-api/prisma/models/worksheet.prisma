model Worksheet {
    id           String                @id @default(uuid())
    clientId     String // Use clientId for proper relation with Client model
    therapistId  String?
    title        String
    instructions String? // Added instructions field
    description  String?
    dueDate      DateTime // Added due date
    status       String                @default("upcoming") // upcoming, past_due, completed, assigned
    isCompleted  Boolean               @default(false) // Completion status
    submittedAt  DateTime? // When the worksheet was submitted
    feedback     String? // Therapist feedback
    
    // Additional attachments (beyond materials and submissions)
    attachmentUrls  String[] @default([])
    attachmentNames String[] @default([])
    attachmentSizes Int[]    @default([])
    
    createdAt    DateTime              @default(now())
    updatedAt    DateTime              @updatedAt
    materials    WorksheetMaterial[]
    submissions  WorksheetSubmission[]
    client       Client                @relation(fields: [clientId], references: [userId])
    therapist    Therapist?            @relation(fields: [therapistId], references: [userId])

    @@index([clientId])
    @@index([therapistId])
    @@index([status])
    @@index([isCompleted])
}

model WorksheetMaterial {
    id          String    @id @default(uuid())
    worksheetId String
    filename    String // Original filename
    url         String // URL to the file
    fileSize    Int? // File size in bytes
    fileType    String? // MIME type
    createdAt   DateTime  @default(now())
    worksheet   Worksheet @relation(fields: [worksheetId], references: [id], onDelete: Cascade)

    @@index([worksheetId])
}

model WorksheetSubmission {
    id          String    @id @default(uuid())
    worksheetId String
    clientId    String // Use clientId for proper relation with Client model
    filename    String // Original filename
    url         String // URL to the file
    fileSize    Int? // File size in bytes
    fileType    String? // MIME type
    content     String?   @db.Text // Optional text content
    createdAt   DateTime  @default(now())
    worksheet   Worksheet @relation(fields: [worksheetId], references: [id], onDelete: Cascade)
    client      Client    @relation(fields: [clientId], references: [userId])

    @@index([worksheetId])
    @@index([clientId])
}
