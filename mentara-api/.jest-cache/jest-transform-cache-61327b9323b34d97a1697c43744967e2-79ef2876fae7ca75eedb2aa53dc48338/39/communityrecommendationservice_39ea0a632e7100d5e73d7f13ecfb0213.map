{"version":3,"names":["cov_1303dtehex","actualCoverage","common_1","s","require","prisma_client_provider_1","community_matching_service_1","community_configs_1","ai_service_client_1","CommunityRecommendationService","CommunityRecommendationService_1","prisma","communityMatching","aiServiceClient","logger","Logger","name","constructor","f","getUserRecommendations","userId","user","findUnique","where","id","include","client","preAssessment","memberships","select","communityId","b","NotFoundException","warn","getFallbackRecommendations","disorderPredictions","assessmentAnswers","answers","questionnaires","Array","isArray","aiResult","predict","predictions","log","Object","keys","filter","k","join","error","currentCommunityIds","map","m","aiRecommendations","getCommunityRecommendationsWithScores","length","recommendedSlugs","rec","slug","communities","community","findMany","in","notIn","_count","recommendations","now","Date","aiRec","find","push","description","imageUrl","memberCount","compatibilityScore","score","reason","generateAIBasedReason","status","createdAt","updatedAt","sortedRecommendations","sort","a","slice","calculateCompatibilityScore","assessmentResponses","baseScore","Math","random","sizeBonus","min","generateRecommendationReason","communitySlug","activeDisorders","disorder","getCommunityBySlug","disorderNames","Has_Depression","Has_Anxiety","Has_Social_Anxiety","Has_PTSD","Has_Panic_Disorder","Has_Bipolar","Has_OCD","Has_Insomnia","Has_High_Stress","Has_Burnout","Has_Binge_Eating","Has_ADHD","Has_Alcohol_Problem","Has_Drug_Problem","Has_Phobia","Has_Agoraphobia","Has_BloodPhobia","Has_SocialPhobia","Has_Hoarding","relevantDisorders","disorderList","orderBy","take","index","generateRecommendationsForUser","force","getRecommendationById","recommendationId","handleRecommendationInteraction","data","action","getRecommendationStats","totalRecommendations","acceptedRecommendations","rejectedRecommendations","pendingRecommendations","averageCompatibilityScore","topCommunities","joinRecommendedCommunities","communitySlugs","successfulJoins","failedJoins","existingMembership","membership","userId_communityId","create","joinedAt","communityName","Error","message","exports","__decorate","Injectable","PrismaService","_a","_b","CommunityMatchingService","_c","AiServiceClient"],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/communities/services/community-recommendation.service.ts"],"sourcesContent":["import { Injectable, Logger, NotFoundException } from '@nestjs/common';\nimport { PrismaService } from '../../providers/prisma-client.provider';\nimport { CommunityMatchingService } from './community-matching.service';\nimport { \n  getCommunityRecommendationsWithScores,\n  getCommunityBySlug,\n  ILLNESS_COMMUNITIES \n} from '../../config/community-configs';\nimport { AiServiceClient } from '../../pre-assessment/services/ai-service.client';\n\nexport interface CommunityRecommendation {\n  id: string;\n  name: string;\n  slug: string;\n  description: string;\n  imageUrl: string;\n  memberCount: number;\n  compatibilityScore: number;\n  score: number; // alias for compatibility\n  reason: string;\n  status: string; // calculated on-demand\n  createdAt: Date; // dummy values for compatibility\n  updatedAt: Date; // dummy values for compatibility\n}\n\n@Injectable()\nexport class CommunityRecommendationService {\n  private readonly logger = new Logger(CommunityRecommendationService.name);\n\n  constructor(\n    private readonly prisma: PrismaService,\n    private readonly communityMatching: CommunityMatchingService,\n    private readonly aiServiceClient: AiServiceClient,\n  ) {}\n\n  /**\n   * Calculate community recommendations based on AI disorder predictions from user's assessment\n   */\n  async getUserRecommendations(\n    userId: string,\n  ): Promise<CommunityRecommendation[]> {\n    try {\n      // Get user's data including preassessment and current memberships\n      const user = await this.prisma.user.findUnique({\n        where: { id: userId },\n        include: {\n          client: {\n            include: {\n              preAssessment: true,\n            },\n          },\n          memberships: {\n            select: { communityId: true },\n          },\n        },\n      });\n\n      if (!user || !user.client) {\n        throw new NotFoundException(`User ${userId} not found or not a client`);\n      }\n\n      // Check if user has completed preassessment\n      if (!user.client.preAssessment) {\n        this.logger.warn(`No preassessment found for user ${userId}`);\n        return this.getFallbackRecommendations(userId);\n      }\n\n      // Get AI disorder predictions from preassessment data\n      let disorderPredictions: Record<string, boolean> = {};\n      try {\n        const assessmentAnswers = user.client.preAssessment.answers as any;\n        if (assessmentAnswers?.questionnaires && Array.isArray(assessmentAnswers.questionnaires)) {\n          const aiResult = await this.aiServiceClient.predict(assessmentAnswers.questionnaires);\n          disorderPredictions = aiResult.predictions || {};\n          this.logger.log(`AI predictions obtained for user ${userId}: ${Object.keys(disorderPredictions).filter(k => disorderPredictions[k]).join(', ')}`);\n        } else {\n          this.logger.warn(`Invalid preassessment data format for user ${userId}`);\n          return this.getFallbackRecommendations(userId);\n        }\n      } catch (error) {\n        this.logger.error(`Failed to get AI predictions for user ${userId}:`, error);\n        return this.getFallbackRecommendations(userId);\n      }\n\n      // Get user's current communities to exclude from recommendations\n      const currentCommunityIds = user.memberships.map((m) => m.communityId);\n\n      // Get community recommendations based on AI predictions\n      const aiRecommendations = getCommunityRecommendationsWithScores(disorderPredictions);\n      \n      if (aiRecommendations.length === 0) {\n        this.logger.log(`No AI-based recommendations for user ${userId}, using fallback`);\n        return this.getFallbackRecommendations(userId);\n      }\n\n      // Get database communities that match recommendations\n      const recommendedSlugs = aiRecommendations.map(rec => rec.slug);\n      const communities = await this.prisma.community.findMany({\n        where: {\n          slug: { in: recommendedSlugs },\n          id: { notIn: currentCommunityIds },\n        },\n        include: {\n          _count: {\n            select: { memberships: true },\n          },\n        },\n      });\n\n      // Create final recommendations with real data\n      const recommendations: CommunityRecommendation[] = [];\n      const now = new Date();\n\n      for (const community of communities) {\n        const aiRec = aiRecommendations.find(rec => rec.slug === community.slug);\n        if (aiRec) {\n          recommendations.push({\n            id: community.id,\n            name: community.name,\n            slug: community.slug,\n            description: community.description,\n            imageUrl: community.imageUrl || '/images/communities/default.jpg',\n            memberCount: community._count.memberships,\n            compatibilityScore: aiRec.score,\n            score: aiRec.score,\n            reason: this.generateAIBasedReason(disorderPredictions, aiRec.slug),\n            status: 'pending',\n            createdAt: now,\n            updatedAt: now,\n          });\n        }\n      }\n\n      // Sort by AI compatibility score and return\n      const sortedRecommendations = recommendations\n        .sort((a, b) => b.compatibilityScore - a.compatibilityScore)\n        .slice(0, 8); // Limit to top 8 recommendations\n\n      this.logger.log(`Generated ${sortedRecommendations.length} AI-based community recommendations for user ${userId}`);\n      return sortedRecommendations;\n\n    } catch (error) {\n      this.logger.error(\n        `Error getting recommendations for user ${userId}:`,\n        error,\n      );\n      return this.getFallbackRecommendations(userId);\n    }\n  }\n\n  private async calculateCompatibilityScore(\n    assessmentResponses: any[],\n    community: any,\n  ): Promise<number> {\n    // Simplified compatibility calculation\n    // In a real system, this would use the assessment responses to match with community characteristics\n    const baseScore = Math.random() * 0.8 + 0.2; // 0.2-1.0 for demo\n\n    // Factor in community size (smaller communities might be better matches)\n    const sizeBonus = community._count.memberships < 50 ? 0.1 : 0;\n\n    return Math.min(baseScore + sizeBonus, 1.0);\n  }\n\n  private generateRecommendationReason(score: number): string {\n    if (score > 0.8)\n      return 'Excellent match based on your assessment responses';\n    if (score > 0.6) return 'Good compatibility with your interests';\n    if (score > 0.4) return 'Potential good fit for your needs';\n    return 'Moderate compatibility';\n  }\n\n  /**\n   * Generate AI-based recommendation reason\n   */\n  private generateAIBasedReason(disorderPredictions: Record<string, boolean>, communitySlug: string): string {\n    const activeDisorders = Object.keys(disorderPredictions).filter(disorder => disorderPredictions[disorder]);\n    const community = getCommunityBySlug(communitySlug);\n    \n    if (!community) {\n      return 'Recommended based on your assessment responses';\n    }\n\n    // Map common disorders to user-friendly terms\n    const disorderNames: Record<string, string> = {\n      Has_Depression: 'depression',\n      Has_Anxiety: 'anxiety',\n      Has_Social_Anxiety: 'social anxiety',\n      Has_PTSD: 'PTSD',\n      Has_Panic_Disorder: 'panic disorder',\n      Has_Bipolar: 'bipolar disorder',\n      Has_OCD: 'OCD',\n      Has_Insomnia: 'sleep issues',\n      Has_High_Stress: 'stress',\n      Has_Burnout: 'burnout',\n      Has_Binge_Eating: 'eating concerns',\n      Has_ADHD: 'ADHD',\n      Has_Alcohol_Problem: 'alcohol concerns',\n      Has_Drug_Problem: 'substance concerns',\n      Has_Phobia: 'phobias',\n      Has_Agoraphobia: 'agoraphobia',\n      Has_BloodPhobia: 'blood phobia',\n      Has_SocialPhobia: 'social phobia',\n      Has_Hoarding: 'hoarding tendencies',\n    };\n\n    const relevantDisorders = activeDisorders\n      .filter(disorder => disorderNames[disorder])\n      .map(disorder => disorderNames[disorder]);\n\n    if (relevantDisorders.length > 0) {\n      const disorderList = relevantDisorders.length === 1 \n        ? relevantDisorders[0]\n        : relevantDisorders.slice(0, -1).join(', ') + ' and ' + relevantDisorders[relevantDisorders.length - 1];\n      \n      return `Recommended based on your ${disorderList} assessment results`;\n    }\n\n    return 'Recommended based on your mental health assessment';\n  }\n\n  /**\n   * Get fallback community recommendations when AI predictions are not available\n   */\n  private async getFallbackRecommendations(userId: string): Promise<CommunityRecommendation[]> {\n    try {\n      // Get user's current communities to exclude\n      const user = await this.prisma.user.findUnique({\n        where: { id: userId },\n        include: {\n          memberships: {\n            select: { communityId: true },\n          },\n        },\n      });\n\n      const currentCommunityIds = user?.memberships.map((m) => m.communityId) || [];\n\n      // Get popular communities (by member count) as fallback\n      const communities = await this.prisma.community.findMany({\n        where: {\n          id: { notIn: currentCommunityIds },\n        },\n        include: {\n          _count: {\n            select: { memberships: true },\n          },\n        },\n        orderBy: {\n          memberships: {\n            _count: 'desc',\n          },\n        },\n        take: 6,\n      });\n\n      const now = new Date();\n      return communities.map((community, index) => ({\n        id: community.id,\n        name: community.name,\n        slug: community.slug,\n        description: community.description,\n        imageUrl: community.imageUrl || '/images/communities/default.jpg',\n        memberCount: community._count.memberships,\n        compatibilityScore: 0.6 - (index * 0.05), // Decreasing score based on popularity\n        score: 0.6 - (index * 0.05),\n        reason: 'Popular community that might interest you',\n        status: 'pending',\n        createdAt: now,\n        updatedAt: now,\n      }));\n\n    } catch (error) {\n      this.logger.error(`Error getting fallback recommendations for user ${userId}:`, error);\n      return [];\n    }\n  }\n\n  /**\n   * Generate recommendations for a user (just returns the calculated ones)\n   */\n  async generateRecommendationsForUser(\n    userId: string,\n    force = false,\n  ): Promise<void> {\n    // No-op since we calculate on-demand\n    this.logger.log(\n      `Generated recommendations for user ${userId} (calculated on-demand)`,\n    );\n  }\n\n  /**\n   * Get a specific recommendation by ID (simplified)\n   */\n  async getRecommendationById(\n    recommendationId: string,\n  ): Promise<CommunityRecommendation | null> {\n    // Since we don't store recommendations, we can't fetch by ID\n    // In a real scenario, you'd need to recalculate or return null\n    return null;\n  }\n\n  /**\n   * Handle recommendation interaction (simplified)\n   */\n  async handleRecommendationInteraction(data: {\n    recommendationId: string;\n    action: string;\n    userId: string;\n  }): Promise<void> {\n    // No-op since we don't store interactions\n    this.logger.log(\n      `User ${data.userId} ${data.action}ed recommendation ${data.recommendationId}`,\n    );\n  }\n\n  /**\n   * Stub method for stats - simplified since no table to query\n   */\n  async getRecommendationStats(): Promise<any> {\n    return {\n      totalRecommendations: 0,\n      acceptedRecommendations: 0,\n      rejectedRecommendations: 0,\n      pendingRecommendations: 0,\n      averageCompatibilityScore: 0,\n      topCommunities: [],\n    };\n  }\n\n  /**\n   * Join multiple recommended communities immediately\n   */\n  async joinRecommendedCommunities(\n    userId: string,\n    communitySlugs: string[]\n  ): Promise<{\n    successfulJoins: Array<{ communityId: string; communityName: string; slug: string }>;\n    failedJoins: Array<{ slug: string; reason: string }>;\n  }> {\n    const successfulJoins: Array<{ communityId: string; communityName: string; slug: string }> = [];\n    const failedJoins: Array<{ slug: string; reason: string }> = [];\n\n    for (const slug of communitySlugs) {\n      try {\n        // Find the community by slug\n        const community = await this.prisma.community.findUnique({\n          where: { slug },\n          select: { id: true, name: true, slug: true }\n        });\n\n        if (!community) {\n          failedJoins.push({ slug, reason: 'Community not found' });\n          continue;\n        }\n\n        // Check if user is already a member\n        const existingMembership = await this.prisma.membership.findUnique({\n          where: {\n            userId_communityId: {\n              userId,\n              communityId: community.id\n            }\n          }\n        });\n\n        if (existingMembership) {\n          failedJoins.push({ slug, reason: 'Already a member' });\n          continue;\n        }\n\n        // Create membership\n        await this.prisma.membership.create({\n          data: {\n            userId,\n            communityId: community.id,\n            joinedAt: new Date()\n          }\n        });\n\n        successfulJoins.push({\n          communityId: community.id,\n          communityName: community.name,\n          slug: community.slug\n        });\n\n        this.logger.log(`User ${userId} successfully joined community ${community.name} (${slug})`);\n\n      } catch (error) {\n        this.logger.error(`Error joining community ${slug} for user ${userId}:`, error);\n        failedJoins.push({ \n          slug, \n          reason: error instanceof Error ? error.message : 'Unknown error' \n        });\n      }\n    }\n\n    this.logger.log(\n      `Community join results for user ${userId}: ${successfulJoins.length} successful, ${failedJoins.length} failed`\n    );\n\n    return { successfulJoins, failedJoins };\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}