{"file":"/home/wetooa/Documents/code/projects/mentara/mentara-api/src/messaging/services/message-encryption.service.spec.ts","mappings":"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","names":[],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/messaging/services/message-encryption.service.spec.ts"],"sourcesContent":["import { Test, TestingModule } from '@nestjs/testing';\nimport { MessageEncryptionService, EncryptedMessage, DecryptedMessage } from './message-encryption.service';\nimport { Logger } from '@nestjs/common';\nimport * as crypto from 'crypto';\n\ndescribe('MessageEncryptionService', () => {\n  let service: MessageEncryptionService;\n  let originalEnv: NodeJS.ProcessEnv;\n\n  beforeEach(async () => {\n    // Save original environment\n    originalEnv = process.env;\n\n    // Set a test encryption key\n    process.env.MESSAGE_ENCRYPTION_KEY = crypto.randomBytes(32).toString('hex');\n\n    const module: TestingModule = await Test.createTestingModule({\n      providers: [MessageEncryptionService],\n    }).compile();\n\n    service = module.get<MessageEncryptionService>(MessageEncryptionService);\n  });\n\n  afterEach(() => {\n    // Restore original environment\n    process.env = originalEnv;\n    jest.clearAllMocks();\n  });\n\n  it('should be defined', () => {\n    expect(service).toBeDefined();\n  });\n\n  describe('Service Initialization', () => {\n    it('should initialize encryption keys on construction', () => {\n      expect(service.isEncryptionAvailable()).toBe(true);\n      \n      const status = service.getEncryptionStatus();\n      expect(status.keyCount).toBe(3);\n      expect(status.availableKeyTypes).toEqual(['default', 'therapy', 'support']);\n      expect(status.algorithm).toBe('aes-256-gcm');\n      expect(status.isConfigured).toBe(true);\n    });\n\n    it('should initialize with random key when no environment key is set', () => {\n      delete process.env.MESSAGE_ENCRYPTION_KEY;\n      \n      // Create a new service instance\n      const newService = new MessageEncryptionService();\n      \n      expect(newService.isEncryptionAvailable()).toBe(true);\n      expect(newService.getEncryptionStatus().keyCount).toBe(3);\n    });\n\n    it('should log successful key initialization', () => {\n      const loggerSpy = jest.spyOn(Logger.prototype, 'log');\n      \n      // Create a new service instance to trigger initialization\n      new MessageEncryptionService();\n      \n      expect(loggerSpy).toHaveBeenCalledWith('Message encryption keys initialized');\n    });\n  });\n\n  describe('encryptMessage', () => {\n    it('should encrypt a message with default key', async () => {\n      const testMessage = 'Hello, this is a test message';\n      const loggerSpy = jest.spyOn(Logger.prototype, 'debug');\n      \n      const encrypted = await service.encryptMessage(testMessage);\n      \n      expect(encrypted).toBeDefined();\n      expect(encrypted.encryptedContent).toBeTruthy();\n      expect(encrypted.iv).toBeTruthy();\n      expect(encrypted.authTag).toBeTruthy();\n      expect(encrypted.keyId).toBe('default');\n      expect(encrypted.encryptedContent).not.toBe(testMessage);\n      expect(loggerSpy).toHaveBeenCalledWith(\n        `Message encrypted with default key (length: ${testMessage.length} chars)`\n      );\n    });\n\n    it('should encrypt a message with therapy key', async () => {\n      const testMessage = 'Confidential therapy session notes';\n      \n      const encrypted = await service.encryptMessage(testMessage, 'therapy');\n      \n      expect(encrypted.keyId).toBe('therapy');\n      expect(encrypted.encryptedContent).toBeTruthy();\n      expect(encrypted.iv).toBeTruthy();\n      expect(encrypted.authTag).toBeTruthy();\n    });\n\n    it('should encrypt a message with support key', async () => {\n      const testMessage = 'Support conversation content';\n      \n      const encrypted = await service.encryptMessage(testMessage, 'support');\n      \n      expect(encrypted.keyId).toBe('support');\n      expect(encrypted.encryptedContent).toBeTruthy();\n      expect(encrypted.iv).toBeTruthy();\n      expect(encrypted.authTag).toBeTruthy();\n    });\n\n    it('should use default key when invalid conversation type is provided', async () => {\n      const testMessage = 'Test message';\n      \n      const encrypted = await service.encryptMessage(testMessage, 'invalid' as any);\n      \n      expect(encrypted.keyId).toBe('invalid');\n      expect(encrypted.encryptedContent).toBeTruthy();\n    });\n\n    it('should generate unique IV for each encryption', async () => {\n      const testMessage = 'Same message content';\n      \n      const encrypted1 = await service.encryptMessage(testMessage);\n      const encrypted2 = await service.encryptMessage(testMessage);\n      \n      expect(encrypted1.iv).not.toBe(encrypted2.iv);\n      expect(encrypted1.encryptedContent).not.toBe(encrypted2.encryptedContent);\n      expect(encrypted1.authTag).not.toBe(encrypted2.authTag);\n    });\n\n    it('should encrypt empty string', async () => {\n      const encrypted = await service.encryptMessage('');\n      \n      expect(encrypted).toBeDefined();\n      expect(encrypted.encryptedContent).toBeTruthy();\n      expect(encrypted.iv).toBeTruthy();\n      expect(encrypted.authTag).toBeTruthy();\n    });\n\n    it('should encrypt very long messages', async () => {\n      const longMessage = 'A'.repeat(10000);\n      \n      const encrypted = await service.encryptMessage(longMessage);\n      \n      expect(encrypted).toBeDefined();\n      expect(encrypted.encryptedContent).toBeTruthy();\n      expect(encrypted.iv).toBeTruthy();\n      expect(encrypted.authTag).toBeTruthy();\n    });\n\n    it('should encrypt unicode characters', async () => {\n      const unicodeMessage = 'Test ðŸš€ emoji and special chars: Ã¤Ã¶Ã¼ Ã± ä¸­æ–‡';\n      \n      const encrypted = await service.encryptMessage(unicodeMessage);\n      \n      expect(encrypted).toBeDefined();\n      expect(encrypted.encryptedContent).toBeTruthy();\n    });\n\n    it('should handle encryption errors gracefully', async () => {\n      const loggerSpy = jest.spyOn(Logger.prototype, 'error');\n      \n      // Mock crypto.createCipheriv to throw an error\n      const originalCreateCipheriv = crypto.createCipheriv;\n      jest.spyOn(crypto, 'createCipheriv').mockImplementation(() => {\n        throw new Error('Crypto error');\n      });\n      \n      await expect(service.encryptMessage('test')).rejects.toThrow('Failed to encrypt message');\n      expect(loggerSpy).toHaveBeenCalledWith('Message encryption failed:', expect.any(Error));\n      \n      // Restore the original function\n      crypto.createCipheriv = originalCreateCipheriv;\n    });\n  });\n\n  describe('decryptMessage', () => {\n    it('should decrypt a message encrypted with default key', async () => {\n      const testMessage = 'Hello, this is a test message';\n      const loggerSpy = jest.spyOn(Logger.prototype, 'debug');\n      \n      const encrypted = await service.encryptMessage(testMessage);\n      const decrypted = await service.decryptMessage(encrypted);\n      \n      expect(decrypted.content).toBe(testMessage);\n      expect(decrypted.decryptedAt).toBeInstanceOf(Date);\n      expect(loggerSpy).toHaveBeenCalledWith(\n        `Message decrypted with default key (length: ${testMessage.length} chars)`\n      );\n    });\n\n    it('should decrypt a message encrypted with therapy key', async () => {\n      const testMessage = 'Confidential therapy session notes';\n      \n      const encrypted = await service.encryptMessage(testMessage, 'therapy');\n      const decrypted = await service.decryptMessage(encrypted);\n      \n      expect(decrypted.content).toBe(testMessage);\n      expect(decrypted.decryptedAt).toBeInstanceOf(Date);\n    });\n\n    it('should decrypt a message encrypted with support key', async () => {\n      const testMessage = 'Support conversation content';\n      \n      const encrypted = await service.encryptMessage(testMessage, 'support');\n      const decrypted = await service.decryptMessage(encrypted);\n      \n      expect(decrypted.content).toBe(testMessage);\n      expect(decrypted.decryptedAt).toBeInstanceOf(Date);\n    });\n\n    it('should decrypt empty string', async () => {\n      const encrypted = await service.encryptMessage('');\n      const decrypted = await service.decryptMessage(encrypted);\n      \n      expect(decrypted.content).toBe('');\n      expect(decrypted.decryptedAt).toBeInstanceOf(Date);\n    });\n\n    it('should decrypt very long messages', async () => {\n      const longMessage = 'A'.repeat(10000);\n      \n      const encrypted = await service.encryptMessage(longMessage);\n      const decrypted = await service.decryptMessage(encrypted);\n      \n      expect(decrypted.content).toBe(longMessage);\n    });\n\n    it('should decrypt unicode characters', async () => {\n      const unicodeMessage = 'Test ðŸš€ emoji and special chars: Ã¤Ã¶Ã¼ Ã± ä¸­æ–‡';\n      \n      const encrypted = await service.encryptMessage(unicodeMessage);\n      const decrypted = await service.decryptMessage(encrypted);\n      \n      expect(decrypted.content).toBe(unicodeMessage);\n    });\n\n    it('should fail to decrypt with tampered encrypted content', async () => {\n      const testMessage = 'Test message';\n      const loggerSpy = jest.spyOn(Logger.prototype, 'error');\n      \n      const encrypted = await service.encryptMessage(testMessage);\n      // Tamper with the encrypted content\n      encrypted.encryptedContent = encrypted.encryptedContent.slice(0, -2) + '00';\n      \n      await expect(service.decryptMessage(encrypted)).rejects.toThrow('Failed to decrypt message - content may be corrupted');\n      expect(loggerSpy).toHaveBeenCalledWith('Message decryption failed:', expect.any(Error));\n    });\n\n    it('should fail to decrypt with tampered IV', async () => {\n      const testMessage = 'Test message';\n      \n      const encrypted = await service.encryptMessage(testMessage);\n      // Tamper with the IV\n      encrypted.iv = encrypted.iv.slice(0, -2) + '00';\n      \n      await expect(service.decryptMessage(encrypted)).rejects.toThrow('Failed to decrypt message - content may be corrupted');\n    });\n\n    it('should fail to decrypt with tampered auth tag', async () => {\n      const testMessage = 'Test message';\n      \n      const encrypted = await service.encryptMessage(testMessage);\n      // Tamper with the auth tag\n      encrypted.authTag = encrypted.authTag.slice(0, -2) + '00';\n      \n      await expect(service.decryptMessage(encrypted)).rejects.toThrow('Failed to decrypt message - content may be corrupted');\n    });\n\n    it('should use default key when keyId is not found', async () => {\n      const testMessage = 'Test message';\n      \n      const encrypted = await service.encryptMessage(testMessage);\n      // Use a non-existent key ID\n      encrypted.keyId = 'nonexistent';\n      \n      const decrypted = await service.decryptMessage(encrypted);\n      expect(decrypted.content).toBe(testMessage);\n    });\n\n    it('should fail to decrypt with invalid hex values', async () => {\n      const invalidEncrypted: EncryptedMessage = {\n        encryptedContent: 'invalid-hex',\n        iv: 'invalid-hex',\n        authTag: 'invalid-hex',\n        keyId: 'default',\n      };\n      \n      await expect(service.decryptMessage(invalidEncrypted)).rejects.toThrow('Failed to decrypt message - content may be corrupted');\n    });\n  });\n\n  describe('getConversationType', () => {\n    it('should return therapy for therapist-client conversations', () => {\n      const participants = [\n        { role: 'therapist' },\n        { role: 'client' }\n      ];\n      \n      const type = service.getConversationType(participants);\n      expect(type).toBe('therapy');\n    });\n\n    it('should return therapy for conversations with therapist, client, and others', () => {\n      const participants = [\n        { role: 'therapist' },\n        { role: 'client' },\n        { role: 'moderator' }\n      ];\n      \n      const type = service.getConversationType(participants);\n      expect(type).toBe('therapy');\n    });\n\n    it('should return support for conversations with moderator (but no therapy)', () => {\n      const participants = [\n        { role: 'moderator' },\n        { role: 'client' }\n      ];\n      \n      const type = service.getConversationType(participants);\n      expect(type).toBe('support');\n    });\n\n    it('should return support for conversations with only moderator', () => {\n      const participants = [\n        { role: 'moderator' }\n      ];\n      \n      const type = service.getConversationType(participants);\n      expect(type).toBe('support');\n    });\n\n    it('should return default for regular user conversations', () => {\n      const participants = [\n        { role: 'client' },\n        { role: 'client' }\n      ];\n      \n      const type = service.getConversationType(participants);\n      expect(type).toBe('default');\n    });\n\n    it('should return default for conversations with unknown roles', () => {\n      const participants = [\n        { role: 'unknown' },\n        { role: 'other' }\n      ];\n      \n      const type = service.getConversationType(participants);\n      expect(type).toBe('default');\n    });\n\n    it('should return default for empty participants array', () => {\n      const participants: { role: string }[] = [];\n      \n      const type = service.getConversationType(participants);\n      expect(type).toBe('default');\n    });\n  });\n\n  describe('validateMessageIntegrity', () => {\n    it('should validate integrity of valid encrypted message', async () => {\n      const testMessage = 'Test message for integrity validation';\n      \n      const encrypted = await service.encryptMessage(testMessage);\n      const isValid = await service.validateMessageIntegrity(encrypted);\n      \n      expect(isValid).toBe(true);\n    });\n\n    it('should detect tampered encrypted content', async () => {\n      const testMessage = 'Test message';\n      const loggerSpy = jest.spyOn(Logger.prototype, 'warn');\n      \n      const encrypted = await service.encryptMessage(testMessage);\n      // Tamper with the encrypted content\n      encrypted.encryptedContent = encrypted.encryptedContent.slice(0, -2) + '00';\n      \n      const isValid = await service.validateMessageIntegrity(encrypted);\n      \n      expect(isValid).toBe(false);\n      expect(loggerSpy).toHaveBeenCalledWith('Message integrity validation failed:', expect.any(Error));\n    });\n\n    it('should detect tampered IV', async () => {\n      const testMessage = 'Test message';\n      \n      const encrypted = await service.encryptMessage(testMessage);\n      // Tamper with the IV\n      encrypted.iv = encrypted.iv.slice(0, -2) + '00';\n      \n      const isValid = await service.validateMessageIntegrity(encrypted);\n      expect(isValid).toBe(false);\n    });\n\n    it('should detect tampered auth tag', async () => {\n      const testMessage = 'Test message';\n      \n      const encrypted = await service.encryptMessage(testMessage);\n      // Tamper with the auth tag\n      encrypted.authTag = encrypted.authTag.slice(0, -2) + '00';\n      \n      const isValid = await service.validateMessageIntegrity(encrypted);\n      expect(isValid).toBe(false);\n    });\n\n    it('should handle invalid hex values gracefully', async () => {\n      const invalidEncrypted: EncryptedMessage = {\n        encryptedContent: 'invalid-hex',\n        iv: 'invalid-hex',\n        authTag: 'invalid-hex',\n        keyId: 'default',\n      };\n      \n      const isValid = await service.validateMessageIntegrity(invalidEncrypted);\n      expect(isValid).toBe(false);\n    });\n  });\n\n  describe('batchEncryptMessages', () => {\n    it('should encrypt multiple messages successfully', async () => {\n      const messages = [\n        { content: 'Message 1' },\n        { content: 'Message 2', conversationType: 'therapy' as const },\n        { content: 'Message 3', conversationType: 'support' as const },\n      ];\n      const loggerSpy = jest.spyOn(Logger.prototype, 'log');\n      \n      const results = await service.batchEncryptMessages(messages);\n      \n      expect(results).toHaveLength(3);\n      expect(results[0].keyId).toBe('default');\n      expect(results[1].keyId).toBe('therapy');\n      expect(results[2].keyId).toBe('support');\n      expect(results.every(r => r.encryptedContent !== '')).toBe(true);\n      expect(loggerSpy).toHaveBeenCalledWith('Batch encrypted 3 messages');\n    });\n\n    it('should handle empty messages array', async () => {\n      const messages: { content: string; conversationType?: 'therapy' | 'support' | 'default' }[] = [];\n      const loggerSpy = jest.spyOn(Logger.prototype, 'log');\n      \n      const results = await service.batchEncryptMessages(messages);\n      \n      expect(results).toHaveLength(0);\n      expect(loggerSpy).toHaveBeenCalledWith('Batch encrypted 0 messages');\n    });\n\n    it('should handle encryption failures gracefully', async () => {\n      const messages = [\n        { content: 'Valid message' },\n        { content: 'Message that will fail' },\n      ];\n      const loggerSpy = jest.spyOn(Logger.prototype, 'error');\n      \n      // Mock the service to fail on the second message\n      const originalEncrypt = service.encryptMessage;\n      jest.spyOn(service, 'encryptMessage').mockImplementation(async (content, type) => {\n        if (content === 'Message that will fail') {\n          throw new Error('Encryption failed');\n        }\n        return originalEncrypt.call(service, content, type);\n      });\n      \n      const results = await service.batchEncryptMessages(messages);\n      \n      expect(results).toHaveLength(2);\n      expect(results[0].encryptedContent).toBeTruthy();\n      expect(results[1].encryptedContent).toBe('');\n      expect(results[1].keyId).toBe('failed');\n      expect(loggerSpy).toHaveBeenCalledWith('Batch encryption failed for message:', expect.any(Error));\n    });\n\n    it('should continue processing after individual failures', async () => {\n      const messages = [\n        { content: 'Message 1' },\n        { content: 'Failing message' },\n        { content: 'Message 3' },\n      ];\n      \n      // Mock the service to fail on the middle message\n      const originalEncrypt = service.encryptMessage;\n      jest.spyOn(service, 'encryptMessage').mockImplementation(async (content, type) => {\n        if (content === 'Failing message') {\n          throw new Error('Encryption failed');\n        }\n        return originalEncrypt.call(service, content, type);\n      });\n      \n      const results = await service.batchEncryptMessages(messages);\n      \n      expect(results).toHaveLength(3);\n      expect(results[0].encryptedContent).toBeTruthy();\n      expect(results[1].encryptedContent).toBe('');\n      expect(results[2].encryptedContent).toBeTruthy();\n    });\n\n    it('should handle very large batch sizes', async () => {\n      const messages = Array.from({ length: 100 }, (_, i) => ({\n        content: `Message ${i}`,\n        conversationType: (i % 3 === 0 ? 'therapy' : i % 3 === 1 ? 'support' : 'default') as const,\n      }));\n      \n      const results = await service.batchEncryptMessages(messages);\n      \n      expect(results).toHaveLength(100);\n      expect(results.every(r => r.encryptedContent !== '')).toBe(true);\n    });\n  });\n\n  describe('rotateKeys', () => {\n    it('should log warning for unimplemented key rotation', async () => {\n      const loggerSpy = jest.spyOn(Logger.prototype, 'warn');\n      \n      await service.rotateKeys();\n      \n      expect(loggerSpy).toHaveBeenCalledWith(\n        'Key rotation not implemented - should integrate with secure key management service'\n      );\n    });\n\n    it('should not throw error when called', async () => {\n      await expect(service.rotateKeys()).resolves.not.toThrow();\n    });\n  });\n\n  describe('isEncryptionAvailable', () => {\n    it('should return true when encryption is properly configured', () => {\n      expect(service.isEncryptionAvailable()).toBe(true);\n    });\n\n    it('should return false when no keys are available', () => {\n      // Create a service with no keys by mocking the initialization\n      const mockService = Object.create(MessageEncryptionService.prototype);\n      mockService.encryptionKeys = new Map();\n      \n      expect(mockService.isEncryptionAvailable()).toBe(false);\n    });\n\n    it('should return false when default key is missing', () => {\n      // Create a service with keys but no default key\n      const mockService = Object.create(MessageEncryptionService.prototype);\n      mockService.encryptionKeys = new Map([['therapy', Buffer.from('test')]]);\n      \n      expect(mockService.isEncryptionAvailable()).toBe(false);\n    });\n  });\n\n  describe('getEncryptionStatus', () => {\n    it('should return correct encryption status', () => {\n      const status = service.getEncryptionStatus();\n      \n      expect(status).toEqual({\n        algorithm: 'aes-256-gcm',\n        keyCount: 3,\n        availableKeyTypes: ['default', 'therapy', 'support'],\n        isConfigured: true,\n      });\n    });\n\n    it('should reflect changes in key availability', () => {\n      // Create a service with no keys\n      const mockService = Object.create(MessageEncryptionService.prototype);\n      mockService.encryptionKeys = new Map();\n      mockService.algorithm = 'aes-256-gcm';\n      \n      const status = mockService.getEncryptionStatus();\n      \n      expect(status).toEqual({\n        algorithm: 'aes-256-gcm',\n        keyCount: 0,\n        availableKeyTypes: [],\n        isConfigured: false,\n      });\n    });\n  });\n\n  describe('Integration Tests', () => {\n    it('should handle full encryption-decryption cycle with all key types', async () => {\n      const testMessage = 'Integration test message';\n      const keyTypes: ('default' | 'therapy' | 'support')[] = ['default', 'therapy', 'support'];\n      \n      for (const keyType of keyTypes) {\n        const encrypted = await service.encryptMessage(testMessage, keyType);\n        const decrypted = await service.decryptMessage(encrypted);\n        \n        expect(decrypted.content).toBe(testMessage);\n        expect(encrypted.keyId).toBe(keyType);\n      }\n    });\n\n    it('should handle concurrent encryption and decryption operations', async () => {\n      const testMessages = Array.from({ length: 10 }, (_, i) => `Message ${i}`);\n      \n      // Encrypt all messages concurrently\n      const encryptPromises = testMessages.map(msg => service.encryptMessage(msg));\n      const encryptedMessages = await Promise.all(encryptPromises);\n      \n      // Decrypt all messages concurrently\n      const decryptPromises = encryptedMessages.map(msg => service.decryptMessage(msg));\n      const decryptedMessages = await Promise.all(decryptPromises);\n      \n      // Verify all messages were correctly decrypted\n      decryptedMessages.forEach((decrypted, i) => {\n        expect(decrypted.content).toBe(testMessages[i]);\n      });\n    });\n\n    it('should maintain data integrity across multiple operations', async () => {\n      const testMessage = 'Integrity test message';\n      \n      // Encrypt the same message multiple times\n      const encrypted1 = await service.encryptMessage(testMessage);\n      const encrypted2 = await service.encryptMessage(testMessage);\n      \n      // Decrypt both messages\n      const decrypted1 = await service.decryptMessage(encrypted1);\n      const decrypted2 = await service.decryptMessage(encrypted2);\n      \n      // Both should decrypt to the same content\n      expect(decrypted1.content).toBe(testMessage);\n      expect(decrypted2.content).toBe(testMessage);\n      \n      // But encrypted forms should be different (due to different IVs)\n      expect(encrypted1.encryptedContent).not.toBe(encrypted2.encryptedContent);\n      expect(encrypted1.iv).not.toBe(encrypted2.iv);\n    });\n  });\n});"],"version":3}