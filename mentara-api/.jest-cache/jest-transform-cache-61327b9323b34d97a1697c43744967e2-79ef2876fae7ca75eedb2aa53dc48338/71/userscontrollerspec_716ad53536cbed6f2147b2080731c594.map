{"file":"/home/wetooa/Documents/code/projects/mentara/mentara-api/src/users/users.controller.spec.ts","mappings":"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","names":[],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/users/users.controller.spec.ts"],"sourcesContent":["import { Test, TestingModule } from '@nestjs/testing';\nimport {\n  HttpException,\n  HttpStatus,\n  ForbiddenException,\n  NotFoundException,\n} from '@nestjs/common';\nimport { UsersController } from './users.controller';\nimport { UsersService } from './users.service';\nimport { RoleUtils } from '../utils/role-utils';\nimport {\n  createMockPrismaService,\n  createMockEventBus,\n  TEST_USER_IDS,\n} from '../test-utils';\nimport {\n  MockBuilder,\n  TestDataGenerator,\n  TestAssertions,\n} from '../test-utils/enhanced-test-helpers';\n\ndescribe('UsersController', () => {\n  let controller: UsersController;\n  let usersService: jest.Mocked<UsersService>;\n  let roleUtils: jest.Mocked<RoleUtils>;\n\n  const mockUsersService = {\n    findAll: jest.fn(),\n    findAllIncludeInactive: jest.fn(),\n    findOne: jest.fn(),\n    findOneIncludeInactive: jest.fn(),\n    update: jest.fn(),\n    remove: jest.fn(),\n    deactivate: jest.fn(),\n    reactivate: jest.fn(),\n  };\n\n  const mockRoleUtils = {\n    isUserAdmin: jest.fn(),\n    isUserModerator: jest.fn(),\n    isUserTherapist: jest.fn(),\n    isUserClient: jest.fn(),\n  };\n\n  beforeEach(async () => {\n    const module: TestingModule = await Test.createTestingModule({\n      controllers: [UsersController],\n      providers: [\n        { provide: UsersService, useValue: mockUsersService },\n        { provide: RoleUtils, useValue: mockRoleUtils },\n      ],\n    }).compile();\n\n    controller = module.get<UsersController>(UsersController);\n    usersService = module.get(UsersService);\n    roleUtils = module.get(RoleUtils);\n  });\n\n  afterEach(() => {\n    jest.clearAllMocks();\n  });\n\n  describe('findAll', () => {\n    it('should return all active users for admin', async () => {\n      const mockUsers = [\n        TestDataGenerator.createUser({ isActive: true }),\n        TestDataGenerator.createUser({ isActive: true }),\n      ];\n\n      usersService.findAll.mockResolvedValue(mockUsers as any);\n\n      const result = await controller.findAll(TEST_USER_IDS.ADMIN);\n\n      expect(usersService.findAll).toHaveBeenCalled();\n      expect(result).toEqual(mockUsers);\n    });\n\n    it('should handle service errors gracefully', async () => {\n      usersService.findAll.mockRejectedValue(new Error('Database error'));\n\n      await expect(controller.findAll(TEST_USER_IDS.ADMIN)).rejects.toThrow(\n        HttpException,\n      );\n    });\n  });\n\n  describe('findAllIncludeInactive', () => {\n    it('should return all users including inactive for admin', async () => {\n      const mockUsers = [\n        TestDataGenerator.createUser({ isActive: true }),\n        TestDataGenerator.createUser({ isActive: false }),\n      ];\n\n      usersService.findAllIncludeInactive.mockResolvedValue(mockUsers as any);\n\n      const result = await controller.findAllIncludeInactive(\n        TEST_USER_IDS.ADMIN,\n      );\n\n      expect(usersService.findAllIncludeInactive).toHaveBeenCalled();\n      expect(result).toEqual(mockUsers);\n    });\n\n    it('should handle service errors when fetching all users', async () => {\n      usersService.findAllIncludeInactive.mockRejectedValue(\n        new Error('Database connection failed'),\n      );\n\n      await expect(\n        controller.findAllIncludeInactive(TEST_USER_IDS.ADMIN),\n      ).rejects.toThrow(HttpException);\n    });\n  });\n\n  describe('findOne', () => {\n    const mockUser = TestDataGenerator.createUser({ id: TEST_USER_IDS.CLIENT });\n\n    it('should allow user to view their own profile', async () => {\n      roleUtils.isUserAdmin.mockResolvedValue(false);\n      usersService.findOne.mockResolvedValue(mockUser as any);\n\n      const result = await controller.findOne(\n        TEST_USER_IDS.CLIENT,\n        TEST_USER_IDS.CLIENT,\n      );\n\n      expect(roleUtils.isUserAdmin).toHaveBeenCalledWith(TEST_USER_IDS.CLIENT);\n      expect(usersService.findOne).toHaveBeenCalledWith(TEST_USER_IDS.CLIENT);\n      expect(result).toEqual(mockUser);\n    });\n\n    it('should allow admin to view any user profile', async () => {\n      roleUtils.isUserAdmin.mockResolvedValue(true);\n      usersService.findOneIncludeInactive.mockResolvedValue(mockUser as any);\n\n      const result = await controller.findOne(\n        TEST_USER_IDS.CLIENT,\n        TEST_USER_IDS.ADMIN,\n      );\n\n      expect(roleUtils.isUserAdmin).toHaveBeenCalledWith(TEST_USER_IDS.ADMIN);\n      expect(usersService.findOneIncludeInactive).toHaveBeenCalledWith(\n        TEST_USER_IDS.CLIENT,\n      );\n      expect(result).toEqual(mockUser);\n    });\n\n    it('should throw ForbiddenException when non-admin tries to view other user', async () => {\n      roleUtils.isUserAdmin.mockResolvedValue(false);\n\n      await expect(\n        controller.findOne(TEST_USER_IDS.THERAPIST, TEST_USER_IDS.CLIENT),\n      ).rejects.toThrow(ForbiddenException);\n\n      expect(usersService.findOne).not.toHaveBeenCalled();\n    });\n\n    it('should throw HttpException when user not found', async () => {\n      roleUtils.isUserAdmin.mockResolvedValue(false);\n      usersService.findOne.mockResolvedValue(null);\n\n      await expect(\n        controller.findOne(TEST_USER_IDS.CLIENT, TEST_USER_IDS.CLIENT),\n      ).rejects.toThrow(HttpException);\n    });\n  });\n\n  describe('update', () => {\n    const updateData = {\n      firstName: 'Updated',\n      lastName: 'Name',\n      bio: 'Updated bio',\n    };\n\n    it('should allow user to update their own profile', async () => {\n      const updatedUser = { ...TestDataGenerator.createUser(), ...updateData };\n      roleUtils.isUserAdmin.mockResolvedValue(false);\n      usersService.update.mockResolvedValue(updatedUser as any);\n\n      const result = await controller.update(\n        TEST_USER_IDS.CLIENT,\n        updateData,\n        TEST_USER_IDS.CLIENT,\n      );\n\n      expect(roleUtils.isUserAdmin).toHaveBeenCalledWith(TEST_USER_IDS.CLIENT);\n      expect(usersService.update).toHaveBeenCalledWith(\n        TEST_USER_IDS.CLIENT,\n        updateData,\n      );\n      expect(result).toEqual(updatedUser);\n    });\n\n    it('should allow admin to update any user with all fields', async () => {\n      const adminUpdateData = {\n        firstName: 'Admin Updated',\n        role: 'moderator',\n        isActive: false,\n      };\n      const updatedUser = {\n        ...TestDataGenerator.createUser(),\n        ...adminUpdateData,\n      };\n\n      roleUtils.isUserAdmin.mockResolvedValue(true);\n      usersService.update.mockResolvedValue(updatedUser as any);\n\n      const result = await controller.update(\n        TEST_USER_IDS.CLIENT,\n        adminUpdateData,\n        TEST_USER_IDS.ADMIN,\n      );\n\n      expect(usersService.update).toHaveBeenCalledWith(\n        TEST_USER_IDS.CLIENT,\n        adminUpdateData,\n      );\n      expect(result).toEqual(updatedUser);\n    });\n\n    it('should sanitize non-admin updates to allowed fields only', async () => {\n      const unauthorizedData = {\n        firstName: 'John',\n        role: 'admin', // Should be filtered out\n        isActive: false, // Should be filtered out\n        bio: 'New bio',\n      };\n      const sanitizedData = {\n        firstName: 'John',\n        bio: 'New bio',\n      };\n      const updatedUser = {\n        ...TestDataGenerator.createUser(),\n        ...sanitizedData,\n      };\n\n      roleUtils.isUserAdmin.mockResolvedValue(false);\n      usersService.update.mockResolvedValue(updatedUser as any);\n\n      const result = await controller.update(\n        TEST_USER_IDS.CLIENT,\n        unauthorizedData,\n        TEST_USER_IDS.CLIENT,\n      );\n\n      expect(usersService.update).toHaveBeenCalledWith(\n        TEST_USER_IDS.CLIENT,\n        sanitizedData,\n      );\n      expect(result).toEqual(updatedUser);\n    });\n\n    it('should throw ForbiddenException when non-admin tries to update other user', async () => {\n      roleUtils.isUserAdmin.mockResolvedValue(false);\n\n      await expect(\n        controller.update(\n          TEST_USER_IDS.THERAPIST,\n          updateData,\n          TEST_USER_IDS.CLIENT,\n        ),\n      ).rejects.toThrow(ForbiddenException);\n\n      expect(usersService.update).not.toHaveBeenCalled();\n    });\n  });\n\n  describe('remove', () => {\n    it('should allow user to deactivate their own account', async () => {\n      roleUtils.isUserAdmin.mockResolvedValue(false);\n      usersService.remove.mockResolvedValue({} as any);\n\n      const result = await controller.remove(\n        TEST_USER_IDS.CLIENT,\n        TEST_USER_IDS.CLIENT,\n      );\n\n      expect(roleUtils.isUserAdmin).toHaveBeenCalledWith(TEST_USER_IDS.CLIENT);\n      expect(usersService.remove).toHaveBeenCalledWith(TEST_USER_IDS.CLIENT);\n      expect(result).toEqual({\n        message: 'User account deactivated successfully',\n      });\n    });\n\n    it('should allow admin to deactivate any user account', async () => {\n      roleUtils.isUserAdmin.mockResolvedValue(true);\n      usersService.remove.mockResolvedValue({} as any);\n\n      const result = await controller.remove(\n        TEST_USER_IDS.CLIENT,\n        TEST_USER_IDS.ADMIN,\n      );\n\n      expect(usersService.remove).toHaveBeenCalledWith(TEST_USER_IDS.CLIENT);\n      expect(result).toEqual({\n        message: 'User account deactivated successfully',\n      });\n    });\n\n    it('should throw ForbiddenException when non-admin tries to deactivate other user', async () => {\n      roleUtils.isUserAdmin.mockResolvedValue(false);\n\n      await expect(\n        controller.remove(TEST_USER_IDS.THERAPIST, TEST_USER_IDS.CLIENT),\n      ).rejects.toThrow(ForbiddenException);\n\n      expect(usersService.remove).not.toHaveBeenCalled();\n    });\n  });\n\n  describe('deactivateUser (admin only)', () => {\n    it('should allow admin to deactivate user with reason', async () => {\n      const deactivationBody = { reason: 'Policy violation' };\n      usersService.deactivate.mockResolvedValue({} as any);\n\n      const result = await controller.deactivateUser(\n        TEST_USER_IDS.CLIENT,\n        deactivationBody,\n        TEST_USER_IDS.ADMIN,\n      );\n\n      expect(usersService.deactivate).toHaveBeenCalledWith(\n        TEST_USER_IDS.CLIENT,\n        'Policy violation',\n        TEST_USER_IDS.ADMIN,\n      );\n      expect(result).toEqual({\n        message: 'User account deactivated by administrator',\n      });\n    });\n\n    it('should handle deactivation without reason', async () => {\n      const deactivationBody = {};\n      usersService.deactivate.mockResolvedValue({} as any);\n\n      const result = await controller.deactivateUser(\n        TEST_USER_IDS.CLIENT,\n        deactivationBody,\n        TEST_USER_IDS.ADMIN,\n      );\n\n      expect(usersService.deactivate).toHaveBeenCalledWith(\n        TEST_USER_IDS.CLIENT,\n        undefined,\n        TEST_USER_IDS.ADMIN,\n      );\n      expect(result).toEqual({\n        message: 'User account deactivated by administrator',\n      });\n    });\n\n    it('should handle service errors during deactivation', async () => {\n      const deactivationBody = { reason: 'Test reason' };\n      usersService.deactivate.mockRejectedValue(new Error('Service error'));\n\n      await expect(\n        controller.deactivateUser(\n          TEST_USER_IDS.CLIENT,\n          deactivationBody,\n          TEST_USER_IDS.ADMIN,\n        ),\n      ).rejects.toThrow(HttpException);\n    });\n  });\n\n  describe('reactivateUser (admin only)', () => {\n    it('should allow admin to reactivate user', async () => {\n      usersService.reactivate.mockResolvedValue({} as any);\n\n      const result = await controller.reactivateUser(\n        TEST_USER_IDS.CLIENT,\n        TEST_USER_IDS.ADMIN,\n      );\n\n      expect(usersService.reactivate).toHaveBeenCalledWith(\n        TEST_USER_IDS.CLIENT,\n      );\n      expect(result).toEqual({\n        message: 'User account reactivated successfully',\n      });\n    });\n\n    it('should handle service errors during reactivation', async () => {\n      usersService.reactivate.mockRejectedValue(\n        new Error('Reactivation failed'),\n      );\n\n      await expect(\n        controller.reactivateUser(TEST_USER_IDS.CLIENT, TEST_USER_IDS.ADMIN),\n      ).rejects.toThrow(HttpException);\n    });\n  });\n\n  describe('error handling', () => {\n    it('should preserve ForbiddenException from service layer', async () => {\n      roleUtils.isUserAdmin.mockResolvedValue(true);\n      usersService.findOneIncludeInactive.mockRejectedValue(\n        new ForbiddenException('Access denied'),\n      );\n\n      await expect(\n        controller.findOne(TEST_USER_IDS.CLIENT, TEST_USER_IDS.ADMIN),\n      ).rejects.toThrow(ForbiddenException);\n    });\n\n    it('should wrap generic errors in HttpException', async () => {\n      roleUtils.isUserAdmin.mockResolvedValue(false);\n      usersService.findOne.mockRejectedValue(new Error('Generic error'));\n\n      await expect(\n        controller.findOne(TEST_USER_IDS.CLIENT, TEST_USER_IDS.CLIENT),\n      ).rejects.toThrow(HttpException);\n    });\n\n    it('should handle role utils errors gracefully', async () => {\n      roleUtils.isUserAdmin.mockRejectedValue(new Error('Role check failed'));\n\n      await expect(\n        controller.findOne(TEST_USER_IDS.CLIENT, TEST_USER_IDS.CLIENT),\n      ).rejects.toThrow(HttpException);\n    });\n  });\n\n  describe('authorization edge cases', () => {\n    it('should handle empty update data for non-admin', async () => {\n      roleUtils.isUserAdmin.mockResolvedValue(false);\n      usersService.update.mockResolvedValue(\n        TestDataGenerator.createUser() as any,\n      );\n\n      await controller.update(TEST_USER_IDS.CLIENT, {}, TEST_USER_IDS.CLIENT);\n\n      expect(usersService.update).toHaveBeenCalledWith(\n        TEST_USER_IDS.CLIENT,\n        {},\n      );\n    });\n\n    it('should handle mixed allowed and disallowed fields for non-admin', async () => {\n      const mixedData = {\n        firstName: 'John', // Allowed\n        lastName: 'Doe', // Allowed\n        role: 'admin', // Not allowed\n        bio: 'New bio', // Allowed\n        isActive: false, // Not allowed\n        avatarUrl: 'http://example.com/avatar.jpg', // Allowed\n      };\n      const expectedSanitizedData = {\n        firstName: 'John',\n        lastName: 'Doe',\n        bio: 'New bio',\n        avatarUrl: 'http://example.com/avatar.jpg',\n      };\n\n      roleUtils.isUserAdmin.mockResolvedValue(false);\n      usersService.update.mockResolvedValue(\n        TestDataGenerator.createUser() as any,\n      );\n\n      await controller.update(\n        TEST_USER_IDS.CLIENT,\n        mixedData,\n        TEST_USER_IDS.CLIENT,\n      );\n\n      expect(usersService.update).toHaveBeenCalledWith(\n        TEST_USER_IDS.CLIENT,\n        expectedSanitizedData,\n      );\n    });\n  });\n});\n"],"version":3}