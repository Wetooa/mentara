{"version":3,"names":["cov_1ar02lz2eu","actualCoverage","common_1","s","require","jwt_1","prisma_client_provider_1","crypto","bcrypt","TokenService","jwtService","prisma","constructor","f","generateToken","userId","email","role","payload","sub","token","sign","logout","user","update","where","id","data","lastLoginAt","Date","hashPassword","password","saltRounds","parseInt","b","process","env","BCRYPT_SALT_ROUNDS","hash","comparePassword","hashedPassword","compare","generateEmailVerificationToken","randomBytes","toString","hashedToken","createHash","digest","expiresAt","setHours","getHours","generatePasswordResetToken","checkAccountLockout","findUnique","select","lockoutUntil","failedLoginCount","handleFailedLogin","maxAttempts","MAX_LOGIN_ATTEMPTS","lockoutDuration","LOCKOUT_DURATION_MINUTES","newFailedCount","updateData","setMinutes","getMinutes","resetFailedLoginCount","validateToken","verify","valid","error","Error","message","exports","__decorate","Injectable","JwtService","_a","Object","_b","PrismaService"],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/auth/services/token.service.ts"],"sourcesContent":["import { Injectable, UnauthorizedException } from '@nestjs/common';\nimport { JwtService } from '@nestjs/jwt';\nimport { PrismaService } from '../../providers/prisma-client.provider';\nimport { JwtPayload } from '../strategies/jwt.strategy';\nimport * as crypto from 'crypto';\nimport * as bcrypt from 'bcrypt';\n\nexport interface SimpleToken {\n  token: string;\n}\n\n@Injectable()\nexport class TokenService {\n  constructor(\n    private readonly jwtService: JwtService,\n    private readonly prisma: PrismaService,\n  ) {}\n\n  async generateToken(\n    userId: string,\n    email: string,\n    role: string,\n  ): Promise<SimpleToken> {\n    const payload: JwtPayload = {\n      sub: userId,\n      email,\n      role,\n    };\n\n    // Generate non-expiring token for simplicity\n    const token = this.jwtService.sign(payload);\n\n    return { token };\n  }\n\n  // Removed refresh token generation - no longer needed\n\n  // Removed refresh token functionality - no longer needed\n\n  // Simple logout - no complex token management needed\n  async logout(userId: string): Promise<void> {\n    // With non-expiring tokens, we could implement a blacklist if needed\n    // For now, just update last login to track activity\n    await this.prisma.user.update({\n      where: { id: userId },\n      data: { lastLoginAt: new Date() },\n    });\n  }\n\n  // Password hashing utilities\n  async hashPassword(password: string): Promise<string> {\n    const saltRounds = parseInt(process.env.BCRYPT_SALT_ROUNDS || '12');\n    return bcrypt.hash(password, saltRounds);\n  }\n\n  async comparePassword(\n    password: string,\n    hashedPassword: string,\n  ): Promise<boolean> {\n    return bcrypt.compare(password, hashedPassword);\n  }\n\n  // Email verification token generation\n  async generateEmailVerificationToken(): Promise<{\n    token: string;\n    hashedToken: string;\n    expiresAt: Date;\n  }> {\n    const token = crypto.randomBytes(32).toString('hex');\n    const hashedToken = crypto.createHash('sha256').update(token).digest('hex');\n\n    const expiresAt = new Date();\n    expiresAt.setHours(expiresAt.getHours() + 24); // 24 hours expiry\n\n    return { token, hashedToken, expiresAt };\n  }\n\n  // Password reset token generation\n  async generatePasswordResetToken(): Promise<{\n    token: string;\n    hashedToken: string;\n    expiresAt: Date;\n  }> {\n    const token = crypto.randomBytes(32).toString('hex');\n    const hashedToken = crypto.createHash('sha256').update(token).digest('hex');\n\n    const expiresAt = new Date();\n    expiresAt.setHours(expiresAt.getHours() + 1); // 1 hour expiry for security\n\n    return { token, hashedToken, expiresAt };\n  }\n\n  // Account lockout utilities\n  async checkAccountLockout(userId: string): Promise<boolean> {\n    const user = await this.prisma.user.findUnique({\n      where: { id: userId },\n      select: { lockoutUntil: true, failedLoginCount: true },\n    });\n\n    if (!user) return false;\n\n    // Check if account is currently locked\n    if (user.lockoutUntil && user.lockoutUntil > new Date()) {\n      return true;\n    }\n\n    // Clear lockout if time has passed\n    if (user.lockoutUntil && user.lockoutUntil <= new Date()) {\n      await this.prisma.user.update({\n        where: { id: userId },\n        data: {\n          lockoutUntil: null,\n          failedLoginCount: 0,\n        },\n      });\n    }\n\n    return false;\n  }\n\n  async handleFailedLogin(userId: string): Promise<void> {\n    const maxAttempts = parseInt(process.env.MAX_LOGIN_ATTEMPTS || '5');\n    const lockoutDuration = parseInt(\n      process.env.LOCKOUT_DURATION_MINUTES || '15',\n    );\n\n    const user = await this.prisma.user.findUnique({\n      where: { id: userId },\n      select: { failedLoginCount: true },\n    });\n\n    if (!user) return;\n\n    const newFailedCount = user.failedLoginCount + 1;\n    const updateData: any = { failedLoginCount: newFailedCount };\n\n    // Lock account if max attempts reached\n    if (newFailedCount >= maxAttempts) {\n      const lockoutUntil = new Date();\n      lockoutUntil.setMinutes(lockoutUntil.getMinutes() + lockoutDuration);\n      updateData.lockoutUntil = lockoutUntil;\n    }\n\n    await this.prisma.user.update({\n      where: { id: userId },\n      data: updateData,\n    });\n  }\n\n  async resetFailedLoginCount(userId: string): Promise<void> {\n    await this.prisma.user.update({\n      where: { id: userId },\n      data: {\n        failedLoginCount: 0,\n        lockoutUntil: null,\n        lastLoginAt: new Date(),\n      },\n    });\n  }\n\n  /**\n   * Validates a JWT token and returns the payload (simplified - no expiration)\n   * @param token - The JWT token to validate\n   * @returns Promise with validation result\n   */\n  async validateToken(token: string): Promise<{\n    valid: boolean;\n    payload?: any;\n    error?: string;\n  }> {\n    try {\n      // Verify and decode the token (no expiration check since we're using non-expiring tokens)\n      const payload = this.jwtService.verify(token);\n\n      return {\n        valid: true,\n        payload,\n      };\n    } catch (error) {\n      return {\n        valid: false,\n        error: error instanceof Error ? error.message : 'Invalid token',\n      };\n    }\n  }\n\n  // Removed all session management - no longer needed with single tokens\n\n  // Removed helper methods - no longer needed with simplified approach\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}