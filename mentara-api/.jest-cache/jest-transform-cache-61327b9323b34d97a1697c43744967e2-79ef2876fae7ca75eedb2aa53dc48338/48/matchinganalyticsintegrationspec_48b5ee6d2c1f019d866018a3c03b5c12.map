{"file":"/home/wetooa/Documents/code/projects/mentara/mentara-api/src/test-utils/integration-tests/matching-analytics.integration.spec.ts","mappings":"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","names":[],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/test-utils/integration-tests/matching-analytics.integration.spec.ts"],"sourcesContent":["import { Test, TestingModule } from '@nestjs/testing';\nimport { INestApplication } from '@nestjs/common';\nimport { PrismaService } from '../../providers/prisma-client.provider';\nimport { DatabaseTestSetup } from '../database-test.setup';\nimport { TestDataGenerator } from '../enhanced-test-helpers';\n\n/**\n * Matching Analytics Integration Tests\n * \n * Comprehensive testing of the AI/ML matching analytics system including\n * match history, client compatibility, recommendation feedback, and algorithm performance tracking.\n */\ndescribe('Matching Analytics Integration', () => {\n  let app: INestApplication;\n  let prisma: PrismaService;\n  let moduleRef: TestingModule;\n\n  // Test entities\n  let testClients: any[] = [];\n  let testTherapists: any[] = [];\n\n  beforeAll(async () => {\n    // Setup test database\n    prisma = await DatabaseTestSetup.setupTestDatabase();\n\n    moduleRef = await Test.createTestingModule({\n      providers: [\n        {\n          provide: PrismaService,\n          useValue: prisma,\n        },\n      ],\n    }).compile();\n\n    app = moduleRef.createNestApplication();\n    await app.init();\n\n    // Create test users and profiles\n    await setupTestData();\n  });\n\n  afterEach(async () => {\n    // Clean analytics data but keep users\n    await cleanAnalyticsData();\n  });\n\n  afterAll(async () => {\n    await DatabaseTestSetup.stopContainer();\n    await app.close();\n    await moduleRef.close();\n  });\n\n  async function setupTestData() {\n    // Create test clients\n    for (let i = 1; i <= 3; i++) {\n      const clientUser = await prisma.user.create({\n        data: TestDataGenerator.createUser({\n          id: `analytics-client-${i}`,\n          email: `client${i}@analytics.com`,\n          firstName: `Client${i}`,\n          lastName: 'User',\n          role: 'client',\n        }),\n      });\n\n      const client = await prisma.client.create({\n        data: {\n          userId: clientUser.id,\n          hasSeenTherapistRecommendations: i > 1, // First client hasn't seen recommendations yet\n        },\n      });\n\n      testClients.push({ user: clientUser, client });\n    }\n\n    // Create test therapists\n    const specializations = [\n      ['Anxiety', 'Depression', 'PTSD'],\n      ['ADHD', 'Bipolar', 'Eating Disorders'],\n      ['Addiction', 'Trauma', 'Grief'],\n    ];\n\n    const approaches = [\n      ['CBT', 'DBT', 'ACT'],\n      ['Psychodynamic', 'Humanistic', 'Solution-Focused'],\n      ['EMDR', 'Narrative Therapy', 'Family Systems'],\n    ];\n\n    for (let i = 1; i <= 3; i++) {\n      const therapistUser = await prisma.user.create({\n        data: TestDataGenerator.createUser({\n          id: `analytics-therapist-${i}`,\n          email: `therapist${i}@analytics.com`,\n          firstName: `Dr. Therapist${i}`,\n          lastName: 'Professional',\n          role: 'therapist',\n        }),\n      });\n\n      const therapist = await prisma.therapist.create({\n        data: {\n          userId: therapistUser.id,\n          mobile: `+123456789${i}`,\n          province: 'Ontario',\n          providerType: 'Clinical Psychologist',\n          professionalLicenseType: 'Licensed',\n          isPRCLicensed: 'yes',\n          prcLicenseNumber: `PRC12345${i}`,\n          practiceStartDate: new Date('2020-01-01'),\n          yearsOfExperience: 5 + i,\n          areasOfExpertise: specializations[i - 1],\n          assessmentTools: ['PHQ-9', 'GAD-7', 'PCL-5'].slice(0, i + 1),\n          therapeuticApproachesUsedList: approaches[i - 1],\n          languagesOffered: ['English', 'French'].slice(0, i),\n          providedOnlineTherapyBefore: true,\n          comfortableUsingVideoConferencing: true,\n          preferredSessionLength: [60, 90].slice(0, i),\n          acceptTypes: ['Individual', 'Couples', 'Family'].slice(0, i + 1),\n          status: 'approved',\n          hourlyRate: 100 + (i * 25),\n          expirationDateOfLicense: new Date('2025-01-01'),\n          compliesWithDataPrivacyAct: true,\n          willingToAbideByPlatformGuidelines: true,\n          treatmentSuccessRates: {\n            anxiety: 0.85 + (i * 0.05),\n            depression: 0.80 + (i * 0.03),\n          },\n          sessionLength: '60 minutes',\n        },\n      });\n\n      testTherapists.push({ user: therapistUser, therapist });\n    }\n  }\n\n  async function cleanAnalyticsData() {\n    await prisma.recommendationFeedback.deleteMany();\n    await prisma.algorithmPerformance.deleteMany();\n    await prisma.clientCompatibility.deleteMany();\n    await prisma.matchHistory.deleteMany();\n    await prisma.matchingWeight.deleteMany();\n  }\n\n  describe('Matching Weight Configuration', () => {\n    it('should create and manage matching weights', async () => {\n      // Create matching weights\n      const weights = await prisma.matchingWeight.createMany({\n        data: [\n          {\n            name: 'conditionMatch',\n            weight: 0.30,\n            description: 'How well therapist specializations match client conditions',\n            isActive: true,\n          },\n          {\n            name: 'approachCompatibility',\n            weight: 0.25,\n            description: 'Compatibility of therapeutic approaches with client preferences',\n            isActive: true,\n          },\n          {\n            name: 'experienceLevel',\n            weight: 0.20,\n            description: 'Therapist experience level and track record',\n            isActive: true,\n          },\n          {\n            name: 'logisticsMatch',\n            weight: 0.15,\n            description: 'Schedule, location, and session format compatibility',\n            isActive: true,\n          },\n          {\n            name: 'reviewScore',\n            weight: 0.10,\n            description: 'Therapist average rating and reviews',\n            isActive: true,\n          },\n        ],\n      });\n\n      // Verify weights created\n      const createdWeights = await prisma.matchingWeight.findMany({\n        orderBy: { weight: 'desc' },\n      });\n\n      expect(createdWeights).toHaveLength(5);\n      expect(createdWeights[0].name).toBe('conditionMatch');\n      expect(createdWeights[0].weight).toBe(0.30);\n      \n      // Verify total weights sum to 1.0\n      const totalWeight = createdWeights.reduce((sum, w) => sum + w.weight, 0);\n      expect(totalWeight).toBeCloseTo(1.0, 2);\n    });\n\n    it('should handle weight updates and deactivation', async () => {\n      // Create initial weight\n      const weight = await prisma.matchingWeight.create({\n        data: {\n          name: 'personalityMatch',\n          weight: 0.15,\n          description: 'Personality compatibility assessment',\n          isActive: true,\n        },\n      });\n\n      // Update weight value\n      const updatedWeight = await prisma.matchingWeight.update({\n        where: { id: weight.id },\n        data: {\n          weight: 0.18,\n          description: 'Enhanced personality compatibility assessment',\n        },\n      });\n\n      // Deactivate weight\n      await prisma.matchingWeight.update({\n        where: { id: weight.id },\n        data: { isActive: false },\n      });\n\n      // Verify changes\n      const finalWeight = await prisma.matchingWeight.findUnique({\n        where: { id: weight.id },\n      });\n\n      expect(finalWeight?.weight).toBe(0.18);\n      expect(finalWeight?.isActive).toBe(false);\n      expect(finalWeight?.description).toContain('Enhanced');\n    });\n  });\n\n  describe('Match History Creation and Tracking', () => {\n    it('should create comprehensive match history records', async () => {\n      const client = testClients[0];\n      const therapist = testTherapists[0];\n\n      // Create match history\n      const matchHistory = await prisma.matchHistory.create({\n        data: {\n          clientId: client.client.userId,\n          therapistId: therapist.therapist.userId,\n          totalScore: 85,\n          conditionScore: 90,\n          approachScore: 80,\n          experienceScore: 85,\n          reviewScore: 88,\n          logisticsScore: 75,\n          compatibilityScore: 82,\n          primaryMatches: ['Anxiety', 'Depression'],\n          secondaryMatches: ['Stress Management'],\n          approachMatches: ['CBT', 'DBT'],\n          recommendationRank: 1,\n          totalRecommendations: 5,\n          wasViewed: true,\n          wasContacted: true,\n          becameClient: true,\n          sessionCount: 3,\n          clientSatisfactionScore: 5,\n          recommendationAlgorithm: 'advanced',\n          userAgent: 'Mozilla/5.0 Chrome/120.0',\n        },\n      });\n\n      // Verify match history creation\n      const createdMatch = await prisma.matchHistory.findUnique({\n        where: { id: matchHistory.id },\n        include: {\n          client: {\n            include: {\n              user: true,\n            },\n          },\n          therapist: {\n            include: {\n              user: true,\n            },\n          },\n        },\n      });\n\n      expect(createdMatch?.totalScore).toBe(85);\n      expect(createdMatch?.primaryMatches).toContain('Anxiety');\n      expect(createdMatch?.approachMatches).toContain('CBT');\n      expect(createdMatch?.recommendationRank).toBe(1);\n      expect(createdMatch?.becameClient).toBe(true);\n      expect(createdMatch?.clientSatisfactionScore).toBe(5);\n    });\n\n    it('should track recommendation funnel progression', async () => {\n      const client = testClients[1];\n\n      // Create multiple match histories for different therapists with different outcomes\n      const matches = [\n        {\n          therapistId: testTherapists[0].therapist.userId,\n          rank: 1,\n          wasViewed: true,\n          wasContacted: true,\n          becameClient: true,\n          sessions: 5,\n          satisfaction: 5,\n        },\n        {\n          therapistId: testTherapists[1].therapist.userId,\n          rank: 2,\n          wasViewed: true,\n          wasContacted: false,\n          becameClient: false,\n          sessions: 0,\n          satisfaction: null,\n        },\n        {\n          therapistId: testTherapists[2].therapist.userId,\n          rank: 3,\n          wasViewed: false,\n          wasContacted: false,\n          becameClient: false,\n          sessions: 0,\n          satisfaction: null,\n        },\n      ];\n\n      for (const match of matches) {\n        await prisma.matchHistory.create({\n          data: {\n            clientId: client.client.userId,\n            therapistId: match.therapistId,\n            totalScore: 85 - (match.rank * 5),\n            conditionScore: 90 - (match.rank * 3),\n            approachScore: 80 - (match.rank * 2),\n            experienceScore: 85 - (match.rank * 2),\n            reviewScore: 85 - (match.rank * 3),\n            logisticsScore: 75,\n            primaryMatches: ['Depression'],\n            secondaryMatches: ['Anxiety'],\n            approachMatches: ['CBT'],\n            recommendationRank: match.rank,\n            totalRecommendations: 3,\n            wasViewed: match.wasViewed,\n            wasContacted: match.wasContacted,\n            becameClient: match.becameClient,\n            sessionCount: match.sessions,\n            clientSatisfactionScore: match.satisfaction,\n            recommendationAlgorithm: 'advanced',\n          },\n        });\n      }\n\n      // Analyze funnel metrics\n      const clientMatches = await prisma.matchHistory.findMany({\n        where: { clientId: client.client.userId },\n        orderBy: { recommendationRank: 'asc' },\n      });\n\n      const viewedCount = clientMatches.filter(m => m.wasViewed).length;\n      const contactedCount = clientMatches.filter(m => m.wasContacted).length;\n      const convertedCount = clientMatches.filter(m => m.becameClient).length;\n\n      expect(clientMatches).toHaveLength(3);\n      expect(viewedCount).toBe(2); // 67% view rate\n      expect(contactedCount).toBe(1); // 50% contact rate from viewed\n      expect(convertedCount).toBe(1); // 100% conversion rate from contacted\n    });\n  });\n\n  describe('Client Compatibility Analysis', () => {\n    it('should create detailed compatibility assessments', async () => {\n      const client = testClients[0];\n      const therapist = testTherapists[0];\n\n      // Create compatibility assessment\n      const compatibility = await prisma.clientCompatibility.create({\n        data: {\n          clientId: client.client.userId,\n          therapistId: therapist.therapist.userId,\n          personalityCompatibility: 85,\n          sessionCompatibility: 90,\n          demographicCompatibility: 75,\n          overallCompatibility: 83,\n          communicationStyleScore: 88,\n          personalityMatchScore: 82,\n          culturalCompatibilityScore: 78,\n          formatMatchScore: 95,\n          durationMatchScore: 85,\n          frequencyMatchScore: 80,\n          schedulingCompatibilityScore: 70,\n          ageCompatibilityScore: 85,\n          genderCompatibilityScore: 90,\n          languageCompatibilityScore: 100,\n          strengths: [\n            'Excellent communication style match',\n            'Strong therapeutic approach alignment',\n            'Compatible session preferences',\n          ],\n          concerns: [\n            'Slight scheduling conflicts',\n            'Geographic distance considerations',\n          ],\n          recommendations: [\n            'Schedule sessions during mutually available times',\n            'Consider video sessions to overcome distance',\n            'Focus on CBT techniques given strong alignment',\n          ],\n          analysisVersion: '2.1',\n        },\n      });\n\n      // Verify compatibility assessment\n      const createdCompatibility = await prisma.clientCompatibility.findUnique({\n        where: { id: compatibility.id },\n        include: {\n          client: {\n            include: {\n              user: true,\n            },\n          },\n          therapist: {\n            include: {\n              user: true,\n            },\n          },\n        },\n      });\n\n      expect(createdCompatibility?.overallCompatibility).toBe(83);\n      expect(createdCompatibility?.strengths).toHaveLength(3);\n      expect(createdCompatibility?.concerns).toHaveLength(2);\n      expect(createdCompatibility?.recommendations).toHaveLength(3);\n      expect(createdCompatibility?.languageCompatibilityScore).toBe(100);\n    });\n\n    it('should handle compatibility updates and versioning', async () => {\n      const client = testClients[1];\n      const therapist = testTherapists[1];\n\n      // Create initial compatibility\n      const initialCompatibility = await prisma.clientCompatibility.create({\n        data: {\n          clientId: client.client.userId,\n          therapistId: therapist.therapist.userId,\n          personalityCompatibility: 70,\n          sessionCompatibility: 75,\n          demographicCompatibility: 80,\n          overallCompatibility: 75,\n          communicationStyleScore: 72,\n          personalityMatchScore: 68,\n          culturalCompatibilityScore: 85,\n          formatMatchScore: 80,\n          durationMatchScore: 70,\n          frequencyMatchScore: 75,\n          schedulingCompatibilityScore: 65,\n          ageCompatibilityScore: 90,\n          genderCompatibilityScore: 85,\n          languageCompatibilityScore: 90,\n          strengths: ['Good demographic match'],\n          concerns: ['Some communication style differences'],\n          recommendations: ['Consider communication preferences'],\n          analysisVersion: '1.0',\n        },\n      });\n\n      // Update compatibility with new analysis\n      const updatedCompatibility = await prisma.clientCompatibility.update({\n        where: { id: initialCompatibility.id },\n        data: {\n          personalityCompatibility: 78,\n          sessionCompatibility: 82,\n          overallCompatibility: 80,\n          communicationStyleScore: 80,\n          personalityMatchScore: 76,\n          strengths: [\n            'Good demographic match',\n            'Improved communication alignment after assessment',\n          ],\n          concerns: ['Minor scheduling conflicts remain'],\n          recommendations: [\n            'Focus on building rapport early',\n            'Flexible scheduling arrangements',\n          ],\n          analysisVersion: '1.1',\n        },\n      });\n\n      expect(updatedCompatibility.overallCompatibility).toBe(80);\n      expect(updatedCompatibility.analysisVersion).toBe('1.1');\n      expect(updatedCompatibility.strengths).toHaveLength(2);\n    });\n  });\n\n  describe('Recommendation Feedback Loop', () => {\n    it('should track comprehensive recommendation feedback', async () => {\n      const client = testClients[0];\n      const therapist = testTherapists[0];\n\n      // Create match history first\n      const matchHistory = await prisma.matchHistory.create({\n        data: {\n          clientId: client.client.userId,\n          therapistId: therapist.therapist.userId,\n          totalScore: 88,\n          conditionScore: 90,\n          approachScore: 85,\n          experienceScore: 90,\n          reviewScore: 85,\n          logisticsScore: 80,\n          primaryMatches: ['Anxiety'],\n          secondaryMatches: ['Depression'],\n          approachMatches: ['CBT'],\n          recommendationRank: 1,\n          totalRecommendations: 3,\n          wasViewed: true,\n          wasContacted: true,\n          becameClient: true,\n          recommendationAlgorithm: 'advanced',\n        },\n      });\n\n      // Create feedback\n      const feedback = await prisma.recommendationFeedback.create({\n        data: {\n          clientId: client.client.userId,\n          therapistId: therapist.therapist.userId,\n          matchHistoryId: matchHistory.id,\n          relevanceScore: 5,\n          accuracyScore: 4,\n          helpfulnessScore: 5,\n          feedbackText: 'Excellent match! The therapist\\'s specialization in anxiety perfectly matched my needs.',\n          selectedTherapist: true,\n          hadInitialSession: true,\n          continuedTherapy: true,\n          overallSatisfaction: 5,\n        },\n      });\n\n      // Verify feedback creation\n      const createdFeedback = await prisma.recommendationFeedback.findUnique({\n        where: { id: feedback.id },\n        include: {\n          client: {\n            include: {\n              user: true,\n            },\n          },\n          therapist: {\n            include: {\n              user: true,\n            },\n          },\n          matchHistory: true,\n        },\n      });\n\n      expect(createdFeedback?.relevanceScore).toBe(5);\n      expect(createdFeedback?.selectedTherapist).toBe(true);\n      expect(createdFeedback?.continuedTherapy).toBe(true);\n      expect(createdFeedback?.matchHistory?.totalScore).toBe(88);\n    });\n\n    it('should handle negative feedback scenarios', async () => {\n      const client = testClients[1];\n      const therapist = testTherapists[1];\n\n      // Create match history for unsuccessful match\n      const matchHistory = await prisma.matchHistory.create({\n        data: {\n          clientId: client.client.userId,\n          therapistId: therapist.therapist.userId,\n          totalScore: 72,\n          conditionScore: 75,\n          approachScore: 70,\n          experienceScore: 75,\n          reviewScore: 68,\n          logisticsScore: 70,\n          primaryMatches: ['ADHD'],\n          secondaryMatches: [],\n          approachMatches: ['Psychodynamic'],\n          recommendationRank: 2,\n          totalRecommendations: 5,\n          wasViewed: true,\n          wasContacted: true,\n          becameClient: false,\n          recommendationAlgorithm: 'basic',\n        },\n      });\n\n      // Create negative feedback\n      const feedback = await prisma.recommendationFeedback.create({\n        data: {\n          clientId: client.client.userId,\n          therapistId: therapist.therapist.userId,\n          matchHistoryId: matchHistory.id,\n          relevanceScore: 2,\n          accuracyScore: 2,\n          helpfulnessScore: 1,\n          feedbackText: 'The recommendation did not match my needs. The therapeutic approach was not suitable for my condition.',\n          selectedTherapist: false,\n          reasonNotSelected: 'Therapeutic approach mismatch and poor initial consultation experience',\n          hadInitialSession: true,\n          continuedTherapy: false,\n          overallSatisfaction: 2,\n        },\n      });\n\n      expect(feedback.relevanceScore).toBe(2);\n      expect(feedback.selectedTherapist).toBe(false);\n      expect(feedback.reasonNotSelected).toContain('approach mismatch');\n      expect(feedback.continuedTherapy).toBe(false);\n    });\n  });\n\n  describe('Algorithm Performance Tracking', () => {\n    it('should track algorithm performance metrics', async () => {\n      // Create performance record for advanced algorithm\n      const performance = await prisma.algorithmPerformance.create({\n        data: {\n          algorithmName: 'advanced_ml',\n          version: '2.1',\n          totalRecommendations: 500,\n          successfulMatches: 185,\n          averageMatchScore: 82.5,\n          averageSatisfactionScore: 4.2,\n          periodStart: new Date('2024-01-01'),\n          periodEnd: new Date('2024-01-31'),\n          clickThroughRate: 0.75, // 75% viewed recommendations\n          conversionRate: 0.37, // 37% became clients\n          retentionRate: 0.82, // 82% continued therapy\n        },\n      });\n\n      // Create performance record for basic algorithm\n      const basicPerformance = await prisma.algorithmPerformance.create({\n        data: {\n          algorithmName: 'basic_scoring',\n          version: '1.0',\n          totalRecommendations: 300,\n          successfulMatches: 90,\n          averageMatchScore: 68.5,\n          averageSatisfactionScore: 3.8,\n          periodStart: new Date('2024-01-01'),\n          periodEnd: new Date('2024-01-31'),\n          clickThroughRate: 0.60,\n          conversionRate: 0.30,\n          retentionRate: 0.70,\n        },\n      });\n\n      // Compare algorithm performance\n      const algorithms = await prisma.algorithmPerformance.findMany({\n        where: {\n          periodStart: new Date('2024-01-01'),\n          periodEnd: new Date('2024-01-31'),\n        },\n        orderBy: {\n          conversionRate: 'desc',\n        },\n      });\n\n      expect(algorithms).toHaveLength(2);\n      expect(algorithms[0].algorithmName).toBe('advanced_ml');\n      expect(algorithms[0].conversionRate).toBeGreaterThan(algorithms[1].conversionRate);\n      expect(algorithms[0].averageSatisfactionScore).toBeGreaterThan(algorithms[1].averageSatisfactionScore);\n    });\n\n    it('should track performance trends over time', async () => {\n      const algorithmName = 'ml_enhanced';\n      const periods = [\n        {\n          start: new Date('2024-01-01'),\n          end: new Date('2024-01-31'),\n          conversion: 0.32,\n          satisfaction: 3.9,\n        },\n        {\n          start: new Date('2024-02-01'),\n          end: new Date('2024-02-29'),\n          conversion: 0.35,\n          satisfaction: 4.1,\n        },\n        {\n          start: new Date('2024-03-01'),\n          end: new Date('2024-03-31'),\n          conversion: 0.38,\n          satisfaction: 4.3,\n        },\n      ];\n\n      // Create performance records for each period\n      for (const [index, period] of periods.entries()) {\n        await prisma.algorithmPerformance.create({\n          data: {\n            algorithmName,\n            version: '1.5',\n            totalRecommendations: 400 + (index * 50),\n            successfulMatches: Math.round((400 + (index * 50)) * period.conversion),\n            averageMatchScore: 75.0 + (index * 2),\n            averageSatisfactionScore: period.satisfaction,\n            periodStart: period.start,\n            periodEnd: period.end,\n            clickThroughRate: 0.70 + (index * 0.02),\n            conversionRate: period.conversion,\n            retentionRate: 0.75 + (index * 0.03),\n          },\n        });\n      }\n\n      // Analyze performance trends\n      const performanceTrend = await prisma.algorithmPerformance.findMany({\n        where: { algorithmName },\n        orderBy: { periodStart: 'asc' },\n      });\n\n      expect(performanceTrend).toHaveLength(3);\n      expect(performanceTrend[2].conversionRate).toBeGreaterThan(performanceTrend[0].conversionRate);\n      expect(performanceTrend[2].averageSatisfactionScore).toBeGreaterThan(performanceTrend[0].averageSatisfactionScore);\n    });\n  });\n\n  describe('Complete Analytics Workflow', () => {\n    it('should demonstrate end-to-end analytics flow', async () => {\n      const client = testClients[2];\n      const therapist = testTherapists[2];\n\n      // 1. Setup matching weights\n      await prisma.matchingWeight.createMany({\n        data: [\n          { name: 'conditionMatch', weight: 0.35, isActive: true },\n          { name: 'approachCompatibility', weight: 0.30, isActive: true },\n          { name: 'experienceLevel', weight: 0.20, isActive: true },\n          { name: 'logisticsMatch', weight: 0.15, isActive: true },\n        ],\n      });\n\n      // 2. Create compatibility analysis\n      const compatibility = await prisma.clientCompatibility.create({\n        data: {\n          clientId: client.client.userId,\n          therapistId: therapist.therapist.userId,\n          personalityCompatibility: 92,\n          sessionCompatibility: 88,\n          demographicCompatibility: 85,\n          overallCompatibility: 88,\n          communicationStyleScore: 90,\n          personalityMatchScore: 94,\n          culturalCompatibilityScore: 82,\n          formatMatchScore: 90,\n          durationMatchScore: 85,\n          frequencyMatchScore: 88,\n          schedulingCompatibilityScore: 85,\n          ageCompatibilityScore: 80,\n          genderCompatibilityScore: 95,\n          languageCompatibilityScore: 100,\n          strengths: [\n            'Exceptional personality compatibility',\n            'Strong therapeutic approach alignment',\n            'Excellent communication style match',\n          ],\n          concerns: [\n            'Minor cultural adaptation needed',\n          ],\n          recommendations: [\n            'Leverage strong personality match',\n            'Focus on trauma-informed approaches',\n            'Maintain consistent session schedule',\n          ],\n          analysisVersion: '3.0',\n        },\n      });\n\n      // 3. Create match history\n      const matchHistory = await prisma.matchHistory.create({\n        data: {\n          clientId: client.client.userId,\n          therapistId: therapist.therapist.userId,\n          totalScore: 92,\n          conditionScore: 95,\n          approachScore: 90,\n          experienceScore: 88,\n          reviewScore: 92,\n          logisticsScore: 85,\n          compatibilityScore: compatibility.overallCompatibility,\n          primaryMatches: ['Trauma', 'PTSD'],\n          secondaryMatches: ['Anxiety', 'Depression'],\n          approachMatches: ['EMDR', 'Trauma-Informed CBT'],\n          recommendationRank: 1,\n          totalRecommendations: 4,\n          wasViewed: true,\n          wasContacted: true,\n          becameClient: true,\n          sessionCount: 8,\n          clientSatisfactionScore: 5,\n          recommendationAlgorithm: 'ml_enhanced',\n          userAgent: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)',\n        },\n      });\n\n      // 4. Create positive feedback\n      const feedback = await prisma.recommendationFeedback.create({\n        data: {\n          clientId: client.client.userId,\n          therapistId: therapist.therapist.userId,\n          matchHistoryId: matchHistory.id,\n          relevanceScore: 5,\n          accuracyScore: 5,\n          helpfulnessScore: 5,\n          feedbackText: 'Outstanding match! The therapist\\'s expertise in trauma therapy and EMDR has been transformative for my healing journey.',\n          selectedTherapist: true,\n          hadInitialSession: true,\n          continuedTherapy: true,\n          overallSatisfaction: 5,\n        },\n      });\n\n      // 5. Update algorithm performance\n      const algorithmPerformance = await prisma.algorithmPerformance.create({\n        data: {\n          algorithmName: 'ml_enhanced',\n          version: '3.0',\n          totalRecommendations: 100,\n          successfulMatches: 42,\n          averageMatchScore: 86.5,\n          averageSatisfactionScore: 4.4,\n          periodStart: new Date('2024-03-01'),\n          periodEnd: new Date('2024-03-31'),\n          clickThroughRate: 0.82,\n          conversionRate: 0.42,\n          retentionRate: 0.88,\n        },\n      });\n\n      // 6. Verify complete analytics workflow\n      const completeAnalytics = await prisma.matchHistory.findUnique({\n        where: { id: matchHistory.id },\n        include: {\n          client: {\n            include: {\n              user: true,\n            },\n          },\n          therapist: {\n            include: {\n              user: true,\n            },\n          },\n          feedback: {\n            include: {\n              client: true,\n              therapist: true,\n            },\n          },\n        },\n      });\n\n      const relatedCompatibility = await prisma.clientCompatibility.findUnique({\n        where: {\n          clientId_therapistId: {\n            clientId: client.client.userId,\n            therapistId: therapist.therapist.userId,\n          },\n        },\n      });\n\n      const weights = await prisma.matchingWeight.findMany({\n        where: { isActive: true },\n      });\n\n      const performance = await prisma.algorithmPerformance.findUnique({\n        where: { id: algorithmPerformance.id },\n      });\n\n      // Comprehensive assertions\n      expect(completeAnalytics?.totalScore).toBe(92);\n      expect(completeAnalytics?.becameClient).toBe(true);\n      expect(completeAnalytics?.feedback).toHaveLength(1);\n      expect(completeAnalytics?.feedback[0].overallSatisfaction).toBe(5);\n      expect(relatedCompatibility?.overallCompatibility).toBe(88);\n      expect(weights.reduce((sum, w) => sum + w.weight, 0)).toBeCloseTo(1.0);\n      expect(performance?.conversionRate).toBe(0.42);\n      expect(performance?.retentionRate).toBe(0.88);\n\n      console.log(' Complete Analytics Workflow Verified:');\n      console.log(`   Match Score: ${completeAnalytics?.totalScore}/100`);\n      console.log(`   Compatibility: ${relatedCompatibility?.overallCompatibility}/100`);\n      console.log(`   Client Satisfaction: ${completeAnalytics?.feedback[0].overallSatisfaction}/5`);\n      console.log(`   Algorithm Performance: ${(performance?.conversionRate! * 100).toFixed(1)}% conversion`);\n    });\n  });\n});"],"version":3}