{"version":3,"names":["cov_wxxlszdlp","actualCoverage","exports","ZodValidationPipeFactory","s","ValidateBody","ValidateQuery","ValidateParam","common_1","require","zod_1","ZodValidationPipe","schema","constructor","f","transform","value","metadata","parsedValue","parse","error","z","ZodError","b","errorMessages","issues","map","err","path","length","join","message","BadRequestException","errors","statusCode","type","__decorate","Injectable","target","propertyKey","parameterIndex"],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/common/pipes/zod-validation.pipe.ts"],"sourcesContent":["import {\n  PipeTransform,\n  Injectable,\n  ArgumentMetadata,\n  BadRequestException,\n} from '@nestjs/common';\nimport { z } from 'zod';\n\n@Injectable()\nexport class ZodValidationPipe implements PipeTransform {\n  constructor(private schema: any) {}\n\n  transform(value: any, metadata: ArgumentMetadata) {\n    try {\n      // Validate all types: body, query, param\n      const parsedValue = this.schema.parse(value);\n      return parsedValue;\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        const errorMessages = error.issues.map((err) => {\n          const path = err.path.length > 0 ? err.path.join('.') : 'root';\n          return `${path}: ${err.message}`;\n        });\n\n        throw new BadRequestException({\n          message: 'Validation failed',\n          errors: errorMessages,\n          statusCode: 400,\n          type: metadata.type,\n        });\n      }\n      throw new BadRequestException('Validation failed');\n    }\n  }\n}\n\n// Factory function to create validation pipes\nexport function ZodValidationPipeFactory(schema: any) {\n  return new ZodValidationPipe(schema);\n}\n\n// Decorator for easy parameter validation\nexport function ValidateBody(schema: any) {\n  return function (target: any, propertyKey: string, parameterIndex: number) {\n    // This would work with a custom decorator implementation\n    // For now, we'll use the pipe directly in controllers\n  };\n}\n\n// Decorator for query validation\nexport function ValidateQuery(schema: any) {\n  return function (target: any, propertyKey: string, parameterIndex: number) {\n    // This would work with a custom decorator implementation\n  };\n}\n\n// Decorator for param validation\nexport function ValidateParam(schema: any) {\n  return function (target: any, propertyKey: string, parameterIndex: number) {\n    // This would work with a custom decorator implementation\n  };\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}