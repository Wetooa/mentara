9cd0448e5fb8f699e540373b1ca6ead3
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const common_1 = require("@nestjs/common");
const throttler_1 = require("@nestjs/throttler");
const therapist_auth_controller_1 = require("./therapist-auth.controller");
const therapist_auth_service_1 = require("../services/therapist-auth.service");
const jwt_auth_guard_1 = require("../guards/jwt-auth.guard");
const supabase_storage_service_1 = require("../../common/services/supabase-storage.service");
const zod_validation_pipe_1 = require("../../common/pipes/zod-validation.pipe");
const auth_testing_helpers_1 = require("../../test-utils/auth-testing-helpers");
describe('TherapistAuthController', () => {
    let controller;
    let therapistAuthService;
    let supabaseStorageService;
    let mockJwtAuthGuard;
    // Test data constants
    const mockTherapistUser = {
        id: auth_testing_helpers_1.TEST_USER_IDS.THERAPIST,
        email: auth_testing_helpers_1.TEST_EMAILS.THERAPIST,
        firstName: 'Dr. Jane',
        lastName: 'Smith',
        role: 'therapist',
        emailVerified: false,
        licenseNumber: 'LIC123456',
        specializations: ['anxiety', 'depression'],
        approvalStatus: 'pending',
        profileComplete: true,
        createdAt: new Date(),
    };
    const mockTokens = {
        accessToken: 'mock-access-token',
        refreshToken: 'mock-refresh-token',
        expiresIn: 3600,
    };
    const mockRegistrationResult = {
        user: mockTherapistUser,
        tokens: mockTokens,
        message: 'Therapist account created successfully',
    };
    const mockLoginResult = {
        user: mockTherapistUser,
        tokens: mockTokens,
    };
    const mockTherapistApplication = {
        id: 'app-123',
        email: auth_testing_helpers_1.TEST_EMAILS.THERAPIST,
        firstName: 'Dr. Jane',
        lastName: 'Smith',
        licenseNumber: 'LIC123456',
        specializations: ['anxiety', 'depression'],
        education: 'PhD in Psychology',
        experience: '5 years',
        status: 'pending',
        submittedAt: new Date(),
        reviewedAt: null,
        notes: null,
        reviewerComments: null,
    };
    const mockApplicationFiles = [
        {
            id: 'file-123',
            fileName: 'license.pdf',
            fileUrl: 'https://example.com/license.pdf',
            uploadedAt: new Date().toISOString(),
        },
        {
            id: 'file-456',
            fileName: 'diploma.pdf',
            fileUrl: 'https://example.com/diploma.pdf',
            uploadedAt: new Date().toISOString(),
        },
    ];
    const mockFiles = [
        {
            fieldname: 'files',
            originalname: 'license.pdf',
            encoding: '7bit',
            mimetype: 'application/pdf',
            size: 1024,
            buffer: Buffer.from('test license content'),
        },
        {
            fieldname: 'files',
            originalname: 'diploma.pdf',
            encoding: '7bit',
            mimetype: 'application/pdf',
            size: 2048,
            buffer: Buffer.from('test diploma content'),
        },
    ];
    const mockApplicationData = {
        email: auth_testing_helpers_1.TEST_EMAILS.THERAPIST,
        firstName: 'Dr. Jane',
        lastName: 'Smith',
        licenseNumber: 'LIC123456',
        specializations: ['anxiety', 'depression'],
        education: 'PhD in Psychology',
        experience: '5 years',
    };
    beforeEach(async () => {
        // Create mock services
        const mockTherapistAuthService = {
            registerTherapist: jest.fn(),
            loginTherapist: jest.fn(),
            getTherapistProfile: jest.fn(),
            createApplicationWithDocuments: jest.fn(),
            getAllApplications: jest.fn(),
            getApplicationById: jest.fn(),
            updateApplicationStatus: jest.fn(),
            getApplicationFiles: jest.fn(),
        };
        const mockSupabaseStorageService = {
            validateFile: jest.fn(),
            uploadFiles: jest.fn(),
            getSupportedBuckets: jest.fn(),
        };
        mockJwtAuthGuard = {
            canActivate: jest.fn().mockReturnValue(true),
        };
        const module = await testing_1.Test.createTestingModule({
            imports: [
                throttler_1.ThrottlerModule.forRoot([
                    {
                        name: 'short',
                        ttl: 1000,
                        limit: 3,
                    },
                ]),
            ],
            controllers: [therapist_auth_controller_1.TherapistAuthController],
            providers: [
                {
                    provide: therapist_auth_service_1.TherapistAuthService,
                    useValue: mockTherapistAuthService,
                },
                {
                    provide: supabase_storage_service_1.SupabaseStorageService,
                    useValue: mockSupabaseStorageService,
                },
            ],
        })
            .overrideGuard(jwt_auth_guard_1.JwtAuthGuard)
            .useValue(mockJwtAuthGuard)
            .overrideGuard(throttler_1.ThrottlerGuard)
            .useValue({ canActivate: jest.fn().mockReturnValue(true) })
            .compile();
        controller = module.get(therapist_auth_controller_1.TherapistAuthController);
        therapistAuthService = module.get(therapist_auth_service_1.TherapistAuthService);
        supabaseStorageService = module.get(supabase_storage_service_1.SupabaseStorageService);
    });
    afterEach(() => {
        jest.clearAllMocks();
    });
    describe('register', () => {
        const validRegisterDto = {
            email: 'newtherapist@example.com',
            password: 'SecurePass123!',
            firstName: 'Dr. Sarah',
            lastName: 'Johnson',
        };
        it('should register therapist successfully', async () => {
            // Arrange
            jest.spyOn(therapistAuthService, 'registerTherapist').mockResolvedValue(mockRegistrationResult);
            // Act
            const result = await controller.register(validRegisterDto);
            // Assert
            expect(therapistAuthService.registerTherapist).toHaveBeenCalledWith(validRegisterDto.email, validRegisterDto.password, validRegisterDto.firstName, validRegisterDto.lastName);
            expect(result).toEqual({
                user: {
                    id: mockTherapistUser.id,
                    email: mockTherapistUser.email,
                    firstName: mockTherapistUser.firstName,
                    lastName: mockTherapistUser.lastName,
                    role: mockTherapistUser.role,
                    emailVerified: mockTherapistUser.emailVerified,
                },
                accessToken: mockTokens.accessToken,
                refreshToken: mockTokens.refreshToken,
                expiresIn: mockTokens.expiresIn,
                message: mockRegistrationResult.message,
            });
        });
        it('should handle email already exists error', async () => {
            // Arrange
            const error = new common_1.BadRequestException('Email already exists');
            jest.spyOn(therapistAuthService, 'registerTherapist').mockRejectedValue(error);
            // Act & Assert
            await expect(controller.register(validRegisterDto)).rejects.toThrow(common_1.BadRequestException);
        });
        it('should handle service errors', async () => {
            // Arrange
            const error = new Error('Database error');
            jest.spyOn(therapistAuthService, 'registerTherapist').mockRejectedValue(error);
            // Act & Assert
            await expect(controller.register(validRegisterDto)).rejects.toThrow(error);
        });
    });
    describe('login', () => {
        const validLoginDto = {
            email: auth_testing_helpers_1.TEST_EMAILS.THERAPIST,
            password: 'SecurePass123!',
        };
        const mockRequest = {
            ip: '192.168.1.1',
            get: jest.fn().mockReturnValue('Test User Agent'),
        };
        it('should login therapist successfully with valid credentials', async () => {
            // Arrange
            jest.spyOn(therapistAuthService, 'loginTherapist').mockResolvedValue(mockLoginResult);
            // Act
            const result = await controller.login(validLoginDto, mockRequest);
            // Assert
            expect(therapistAuthService.loginTherapist).toHaveBeenCalledWith(validLoginDto.email, validLoginDto.password, mockRequest.ip, 'Test User Agent');
            expect(result).toEqual({
                user: {
                    id: mockTherapistUser.id,
                    email: mockTherapistUser.email,
                    firstName: mockTherapistUser.firstName,
                    lastName: mockTherapistUser.lastName,
                    role: mockTherapistUser.role,
                    emailVerified: mockTherapistUser.emailVerified,
                },
                accessToken: mockTokens.accessToken,
                refreshToken: mockTokens.refreshToken,
                expiresIn: mockTokens.expiresIn,
            });
        });
        it('should handle missing User-Agent header', async () => {
            // Arrange
            const mockRequestWithoutUserAgent = {
                ip: '192.168.1.1',
                get: jest.fn().mockReturnValue(undefined),
            };
            jest.spyOn(therapistAuthService, 'loginTherapist').mockResolvedValue(mockLoginResult);
            // Act
            await controller.login(validLoginDto, mockRequestWithoutUserAgent);
            // Assert
            expect(therapistAuthService.loginTherapist).toHaveBeenCalledWith(validLoginDto.email, validLoginDto.password, mockRequestWithoutUserAgent.ip, undefined);
        });
        it('should handle invalid credentials', async () => {
            // Arrange
            const authError = new common_1.UnauthorizedException('Invalid credentials');
            jest.spyOn(therapistAuthService, 'loginTherapist').mockRejectedValue(authError);
            // Act & Assert
            await expect(controller.login(validLoginDto, mockRequest)).rejects.toThrow(authError);
        });
        it('should handle service errors', async () => {
            // Arrange
            const serviceError = new Error('Database connection failed');
            jest.spyOn(therapistAuthService, 'loginTherapist').mockRejectedValue(serviceError);
            // Act & Assert
            await expect(controller.login(validLoginDto, mockRequest)).rejects.toThrow(serviceError);
        });
    });
    describe('getProfile', () => {
        it('should return therapist profile successfully', async () => {
            // Arrange
            jest.spyOn(therapistAuthService, 'getTherapistProfile').mockResolvedValue(mockTherapistUser);
            // Act
            const result = await controller.getProfile(auth_testing_helpers_1.TEST_USER_IDS.THERAPIST);
            // Assert
            expect(therapistAuthService.getTherapistProfile).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_USER_IDS.THERAPIST);
            expect(result).toEqual(mockTherapistUser);
        });
        it('should handle profile not found', async () => {
            // Arrange
            const notFoundError = new Error('Therapist profile not found');
            jest.spyOn(therapistAuthService, 'getTherapistProfile').mockRejectedValue(notFoundError);
            // Act & Assert
            await expect(controller.getProfile(auth_testing_helpers_1.TEST_USER_IDS.THERAPIST)).rejects.toThrow(notFoundError);
        });
    });
    describe('applyWithDocuments', () => {
        const validApplicationDataJson = JSON.stringify(mockApplicationData);
        const validFileTypes = JSON.stringify({ '0': 'license', '1': 'diploma' });
        const mockApplicationResult = {
            application: { userId: 'temp_12345_therapist_at_example.com' },
            uploadedFiles: [
                { id: 'file-123', fileName: 'license.pdf', url: 'https://example.com/license.pdf' },
                { id: 'file-456', fileName: 'diploma.pdf', url: 'https://example.com/diploma.pdf' },
            ],
        };
        it('should submit application with documents successfully', async () => {
            // Arrange
            jest.spyOn(therapistAuthService, 'createApplicationWithDocuments').mockResolvedValue(mockApplicationResult);
            // Act
            const result = await controller.applyWithDocuments(validApplicationDataJson, validFileTypes, mockFiles);
            // Assert
            expect(therapistAuthService.createApplicationWithDocuments).toHaveBeenCalledWith(expect.objectContaining({
                ...mockApplicationData,
                userId: expect.stringContaining('temp_'),
            }), mockFiles, { '0': 'license', '1': 'diploma' });
            expect(result).toEqual({
                success: true,
                message: 'Application submitted successfully with documents',
                applicationId: mockApplicationResult.application.userId,
                uploadedFiles: mockApplicationResult.uploadedFiles,
            });
        });
        it('should submit application without files', async () => {
            // Arrange
            jest.spyOn(therapistAuthService, 'createApplicationWithDocuments').mockResolvedValue(mockApplicationResult);
            // Act
            const result = await controller.applyWithDocuments(validApplicationDataJson, validFileTypes, []);
            // Assert
            expect(therapistAuthService.createApplicationWithDocuments).toHaveBeenCalledWith(expect.objectContaining(mockApplicationData), [], { '0': 'license', '1': 'diploma' });
            expect(result.success).toBe(true);
        });
        it('should handle missing application data', async () => {
            // Act & Assert
            await expect(controller.applyWithDocuments('', validFileTypes, mockFiles)).rejects.toThrow(common_1.BadRequestException);
        });
        it('should handle invalid JSON format', async () => {
            // Act & Assert
            await expect(controller.applyWithDocuments('invalid json', validFileTypes, mockFiles)).rejects.toThrow(common_1.BadRequestException);
        });
        it('should handle email already exists error', async () => {
            // Arrange
            const error = new Error('email already exists');
            jest.spyOn(therapistAuthService, 'createApplicationWithDocuments').mockRejectedValue(error);
            // Act & Assert
            await expect(controller.applyWithDocuments(validApplicationDataJson, validFileTypes, mockFiles)).rejects.toThrow(common_1.BadRequestException);
        });
        it('should handle file upload errors', async () => {
            // Arrange
            const error = new Error('file upload failed');
            jest.spyOn(therapistAuthService, 'createApplicationWithDocuments').mockRejectedValue(error);
            // Act & Assert
            await expect(controller.applyWithDocuments(validApplicationDataJson, validFileTypes, mockFiles)).rejects.toThrow(common_1.BadRequestException);
        });
        it('should handle validation errors', async () => {
            // Arrange
            const error = new Error('validation failed');
            jest.spyOn(therapistAuthService, 'createApplicationWithDocuments').mockRejectedValue(error);
            // Act & Assert
            await expect(controller.applyWithDocuments(validApplicationDataJson, validFileTypes, mockFiles)).rejects.toThrow(common_1.BadRequestException);
        });
        it('should handle service errors', async () => {
            // Arrange
            const error = new Error('Unknown database error');
            jest.spyOn(therapistAuthService, 'createApplicationWithDocuments').mockRejectedValue(error);
            // Act & Assert
            await expect(controller.applyWithDocuments(validApplicationDataJson, validFileTypes, mockFiles)).rejects.toThrow(common_1.InternalServerErrorException);
        });
        it('should handle invalid file types JSON', async () => {
            // Arrange
            jest.spyOn(therapistAuthService, 'createApplicationWithDocuments').mockResolvedValue(mockApplicationResult);
            // Act
            const result = await controller.applyWithDocuments(validApplicationDataJson, 'invalid json', mockFiles);
            // Assert
            expect(therapistAuthService.createApplicationWithDocuments).toHaveBeenCalledWith(expect.objectContaining(mockApplicationData), mockFiles, {});
            expect(result.success).toBe(true);
        });
    });
    describe('getAllApplications', () => {
        const mockApplicationsResult = {
            applications: [mockTherapistApplication],
            totalCount: 1,
            page: 1,
            totalPages: 1,
        };
        it('should return all applications for admin user', async () => {
            // Arrange
            jest.spyOn(therapistAuthService, 'getAllApplications').mockResolvedValue(mockApplicationsResult);
            // Act
            const result = await controller.getAllApplications('admin');
            // Assert
            expect(therapistAuthService.getAllApplications).toHaveBeenCalledWith({
                status: undefined,
                page: 1,
                limit: 10,
            });
            expect(result).toEqual(mockApplicationsResult);
        });
        it('should return applications with custom filters', async () => {
            // Arrange
            jest.spyOn(therapistAuthService, 'getAllApplications').mockResolvedValue(mockApplicationsResult);
            // Act
            const result = await controller.getAllApplications('admin', 'pending', 2, 20);
            // Assert
            expect(therapistAuthService.getAllApplications).toHaveBeenCalledWith({
                status: 'pending',
                page: 2,
                limit: 20,
            });
            expect(result).toEqual(mockApplicationsResult);
        });
        it('should handle pagination bounds', async () => {
            // Arrange
            jest.spyOn(therapistAuthService, 'getAllApplications').mockResolvedValue(mockApplicationsResult);
            // Act
            await controller.getAllApplications('admin', undefined, 0, 200);
            // Assert
            expect(therapistAuthService.getAllApplications).toHaveBeenCalledWith({
                status: undefined,
                page: 1, // Clamped to minimum 1
                limit: 100, // Clamped to maximum 100
            });
        });
        it('should throw ForbiddenException for non-admin users', async () => {
            // Act & Assert
            await expect(controller.getAllApplications('client')).rejects.toThrow(common_1.ForbiddenException);
        });
        it('should handle service errors', async () => {
            // Arrange
            const error = new Error('Database error');
            jest.spyOn(therapistAuthService, 'getAllApplications').mockRejectedValue(error);
            // Act & Assert
            await expect(controller.getAllApplications('admin')).rejects.toThrow(common_1.InternalServerErrorException);
        });
    });
    describe('getApplicationById', () => {
        it('should return application by ID for admin user', async () => {
            // Arrange
            jest.spyOn(therapistAuthService, 'getApplicationById').mockResolvedValue(mockTherapistApplication);
            // Act
            const result = await controller.getApplicationById('admin', 'app-123');
            // Assert
            expect(therapistAuthService.getApplicationById).toHaveBeenCalledWith('app-123');
            expect(result).toEqual(mockTherapistApplication);
        });
        it('should throw ForbiddenException for non-admin users', async () => {
            // Act & Assert
            await expect(controller.getApplicationById('client', 'app-123')).rejects.toThrow(common_1.ForbiddenException);
        });
        it('should throw NotFoundException when application not found', async () => {
            // Arrange
            jest.spyOn(therapistAuthService, 'getApplicationById').mockResolvedValue(null);
            // Act & Assert
            await expect(controller.getApplicationById('admin', 'app-123')).rejects.toThrow(common_1.NotFoundException);
        });
        it('should handle service errors', async () => {
            // Arrange
            const error = new Error('Database error');
            jest.spyOn(therapistAuthService, 'getApplicationById').mockRejectedValue(error);
            // Act & Assert
            await expect(controller.getApplicationById('admin', 'app-123')).rejects.toThrow(common_1.InternalServerErrorException);
        });
    });
    describe('updateApplicationStatus', () => {
        const mockUpdateData = {
            status: 'approved',
            notes: 'Approved by admin',
            reviewerComments: 'All documents verified',
        };
        const mockUpdateResult = {
            success: true,
            message: 'Application approved successfully',
            credentials: {
                email: auth_testing_helpers_1.TEST_EMAILS.THERAPIST,
                password: 'generated-password',
            },
        };
        it('should update application status successfully for admin user', async () => {
            // Arrange
            jest.spyOn(therapistAuthService, 'updateApplicationStatus').mockResolvedValue(mockUpdateResult);
            // Act
            const result = await controller.updateApplicationStatus('admin', 'app-123', mockUpdateData);
            // Assert
            expect(therapistAuthService.updateApplicationStatus).toHaveBeenCalledWith('app-123', mockUpdateData);
            expect(result).toEqual(mockUpdateResult);
        });
        it('should throw ForbiddenException for non-admin users', async () => {
            // Act & Assert
            await expect(controller.updateApplicationStatus('client', 'app-123', mockUpdateData)).rejects.toThrow(common_1.ForbiddenException);
        });
        it('should handle NotFoundException', async () => {
            // Arrange
            const notFoundError = new common_1.NotFoundException('Application not found');
            jest.spyOn(therapistAuthService, 'updateApplicationStatus').mockRejectedValue(notFoundError);
            // Act & Assert
            await expect(controller.updateApplicationStatus('admin', 'app-123', mockUpdateData)).rejects.toThrow(common_1.NotFoundException);
        });
        it('should handle service errors', async () => {
            // Arrange
            const error = new Error('Database error');
            jest.spyOn(therapistAuthService, 'updateApplicationStatus').mockRejectedValue(error);
            // Act & Assert
            await expect(controller.updateApplicationStatus('admin', 'app-123', mockUpdateData)).rejects.toThrow(common_1.InternalServerErrorException);
        });
    });
    describe('getApplicationFiles', () => {
        it('should return application files for admin user', async () => {
            // Arrange
            jest.spyOn(therapistAuthService, 'getApplicationFiles').mockResolvedValue(mockApplicationFiles);
            // Act
            const result = await controller.getApplicationFiles('admin', 'app-123');
            // Assert
            expect(therapistAuthService.getApplicationFiles).toHaveBeenCalledWith('app-123');
            expect(result).toEqual(mockApplicationFiles);
        });
        it('should throw ForbiddenException for non-admin users', async () => {
            // Act & Assert
            await expect(controller.getApplicationFiles('client', 'app-123')).rejects.toThrow(common_1.ForbiddenException);
        });
        it('should handle NotFoundException', async () => {
            // Arrange
            const notFoundError = new common_1.NotFoundException('Application files not found');
            jest.spyOn(therapistAuthService, 'getApplicationFiles').mockRejectedValue(notFoundError);
            // Act & Assert
            await expect(controller.getApplicationFiles('admin', 'app-123')).rejects.toThrow(common_1.NotFoundException);
        });
        it('should handle service errors', async () => {
            // Arrange
            const error = new Error('Database error');
            jest.spyOn(therapistAuthService, 'getApplicationFiles').mockRejectedValue(error);
            // Act & Assert
            await expect(controller.getApplicationFiles('admin', 'app-123')).rejects.toThrow(common_1.InternalServerErrorException);
        });
    });
    describe('Security Tests', () => {
        it('should validate input data through ZodValidationPipe', () => {
            // This tests that the controller uses proper validation
            const validationPipe = new zod_validation_pipe_1.ZodValidationPipe({});
            expect(validationPipe).toBeDefined();
        });
        it('should apply rate limiting through ThrottlerGuard', () => {
            // Test that throttling is configured
            const registerMetadata = Reflect.getMetadata('__throttler_options__', controller.register);
            const loginMetadata = Reflect.getMetadata('__throttler_options__', controller.login);
            expect(registerMetadata).toBeDefined();
            expect(loginMetadata).toBeDefined();
        });
        it('should require authentication for protected endpoints', () => {
            // Test that protected endpoints have JwtAuthGuard
            const protectedMethods = ['getProfile', 'getAllApplications', 'getApplicationById', 'updateApplicationStatus', 'getApplicationFiles'];
            protectedMethods.forEach(method => {
                const guards = Reflect.getMetadata('__guards__', controller[method]);
                expect(guards).toBeDefined();
            });
        });
        it('should allow public access to public endpoints', () => {
            // Test that public endpoints are marked as public
            const publicMethods = ['register', 'login', 'applyWithDocuments'];
            publicMethods.forEach(method => {
                const publicMetadata = Reflect.getMetadata('isPublic', controller[method]);
                expect(publicMetadata).toBeTruthy();
            });
        });
    });
    describe('Role-based Access Control', () => {
        it('should test role-based access for admin endpoints', async () => {
            // Test that admin endpoints require admin role
            await auth_testing_helpers_1.RoleBasedTestUtils.testWithRoles(async (userId, role) => {
                // Mock the auth guard to return the specific role
                mockJwtAuthGuard.canActivate.mockReturnValue(role === 'admin');
                try {
                    await controller.getAllApplications(role);
                    return true;
                }
                catch (error) {
                    return false;
                }
            }, {
                client: false,
                therapist: false,
                admin: true,
                moderator: false,
            });
        });
        it('should validate therapist-specific functionality', async () => {
            // Test that therapist-specific endpoints work for therapists
            const therapistContext = auth_testing_helpers_1.MockBuilder.createAuthContext('therapist');
            jest.spyOn(therapistAuthService, 'getTherapistProfile').mockResolvedValue(mockTherapistUser);
            const result = await controller.getProfile(therapistContext.userId);
            expect(result).toBeDefined();
            expect(result.role).toBe('therapist');
        });
    });
    describe('Error Handling', () => {
        it('should handle network errors gracefully', async () => {
            // Arrange
            const networkError = new Error('Network timeout');
            jest.spyOn(therapistAuthService, 'getTherapistProfile').mockRejectedValue(networkError);
            // Act & Assert
            await expect(controller.getProfile(auth_testing_helpers_1.TEST_USER_IDS.THERAPIST)).rejects.toThrow(networkError);
        });
        it('should handle validation errors', async () => {
            // Test that invalid data would be caught by the validation pipe
            const invalidData = {
                email: 'invalid-email',
                password: '123', // Too short
                firstName: '',
                lastName: '',
            };
            // In a real scenario, this would throw a validation error
            // The pipe would catch this before it reaches the controller
            expect(() => {
                // This would be handled by ZodValidationPipe
                // and would throw a BadRequestException
            }).not.toThrow();
        });
    });
    describe('Integration Tests', () => {
        it('should handle complete therapist registration workflow', async () => {
            // Arrange
            const registrationDto = {
                email: 'integration@example.com',
                password: 'SecurePass123!',
                firstName: 'Dr. Integration',
                lastName: 'Test',
            };
            jest.spyOn(therapistAuthService, 'registerTherapist').mockResolvedValue(mockRegistrationResult);
            // Act
            const result = await controller.register(registrationDto);
            // Assert
            expect(result).toBeDefined();
            expect(result.user.email).toBe(mockTherapistUser.email);
            expect(result.accessToken).toBe(mockTokens.accessToken);
            expect(result.refreshToken).toBe(mockTokens.refreshToken);
            expect(result.expiresIn).toBe(mockTokens.expiresIn);
            expect(result.message).toBe(mockRegistrationResult.message);
        });
        it('should handle complete therapist login workflow', async () => {
            // Arrange
            const loginDto = {
                email: auth_testing_helpers_1.TEST_EMAILS.THERAPIST,
                password: 'SecurePass123!',
            };
            const mockRequest = {
                ip: '192.168.1.1',
                get: jest.fn().mockReturnValue('Test User Agent'),
            };
            jest.spyOn(therapistAuthService, 'loginTherapist').mockResolvedValue(mockLoginResult);
            // Act
            const result = await controller.login(loginDto, mockRequest);
            // Assert
            expect(result).toBeDefined();
            expect(result.user.email).toBe(mockTherapistUser.email);
            expect(result.accessToken).toBe(mockTokens.accessToken);
            expect(result.refreshToken).toBe(mockTokens.refreshToken);
            expect(result.expiresIn).toBe(mockTokens.expiresIn);
        });
        it('should handle complete application submission workflow', async () => {
            // Arrange
            const mockApplicationResult = {
                application: { userId: 'temp_12345_therapist_at_example.com' },
                uploadedFiles: mockApplicationFiles,
            };
            jest.spyOn(therapistAuthService, 'createApplicationWithDocuments').mockResolvedValue(mockApplicationResult);
            // Act
            const result = await controller.applyWithDocuments(JSON.stringify(mockApplicationData), JSON.stringify({ '0': 'license', '1': 'diploma' }), mockFiles);
            // Assert
            expect(result).toBeDefined();
            expect(result.success).toBe(true);
            expect(result.applicationId).toBe(mockApplicationResult.application.userId);
            expect(result.uploadedFiles).toEqual(mockApplicationFiles);
        });
        it('should handle complete admin application management workflow', async () => {
            // Arrange
            const mockApplicationsResult = {
                applications: [mockTherapistApplication],
                totalCount: 1,
                page: 1,
                totalPages: 1,
            };
            jest.spyOn(therapistAuthService, 'getAllApplications').mockResolvedValue(mockApplicationsResult);
            jest.spyOn(therapistAuthService, 'getApplicationById').mockResolvedValue(mockTherapistApplication);
            // Act - Get all applications
            const allApplications = await controller.getAllApplications('admin');
            // Act - Get specific application
            const specificApplication = await controller.getApplicationById('admin', 'app-123');
            // Assert
            expect(allApplications).toBeDefined();
            expect(allApplications.applications.length).toBe(1);
            expect(allApplications.totalCount).toBe(1);
            expect(specificApplication).toBeDefined();
            expect(specificApplication.id).toBe('app-123');
        });
    });
    describe('Data Validation', () => {
        it('should validate registration data structure', () => {
            // Test that we're using the correct DTO structure
            const validRegistrationData = {
                email: 'test@example.com',
                password: 'SecurePass123!',
                firstName: 'Dr. Test',
                lastName: 'User',
            };
            // Verify all required fields are present
            expect(validRegistrationData.email).toBeDefined();
            expect(validRegistrationData.password).toBeDefined();
            expect(validRegistrationData.firstName).toBeDefined();
            expect(validRegistrationData.lastName).toBeDefined();
        });
        it('should validate login data structure', () => {
            // Test that we're using the correct DTO structure
            const validLoginData = {
                email: 'test@example.com',
                password: 'SecurePass123!',
            };
            // Verify all required fields are present
            expect(validLoginData.email).toBeDefined();
            expect(validLoginData.password).toBeDefined();
        });
        it('should validate application data structure', () => {
            // Test that we're using the correct DTO structure
            const validApplicationData = {
                email: 'test@example.com',
                firstName: 'Dr. Test',
                lastName: 'User',
                licenseNumber: 'LIC123456',
                specializations: ['anxiety', 'depression'],
                education: 'PhD in Psychology',
                experience: '5 years',
            };
            // Verify all required fields are present
            expect(validApplicationData.email).toBeDefined();
            expect(validApplicationData.firstName).toBeDefined();
            expect(validApplicationData.lastName).toBeDefined();
            expect(validApplicationData.licenseNumber).toBeDefined();
            expect(validApplicationData.specializations).toBeDefined();
            expect(validApplicationData.education).toBeDefined();
            expect(validApplicationData.experience).toBeDefined();
        });
    });
    describe('Response Format Validation', () => {
        it('should return correctly formatted registration response', async () => {
            // Arrange
            const registerDto = {
                email: 'format@example.com',
                password: 'SecurePass123!',
                firstName: 'Dr. Format',
                lastName: 'Test',
            };
            jest.spyOn(therapistAuthService, 'registerTherapist').mockResolvedValue(mockRegistrationResult);
            // Act
            const result = await controller.register(registerDto);
            // Assert
            expect(result).toHaveProperty('user');
            expect(result).toHaveProperty('accessToken');
            expect(result).toHaveProperty('refreshToken');
            expect(result).toHaveProperty('expiresIn');
            expect(result).toHaveProperty('message');
            expect(result.user).toHaveProperty('id');
            expect(result.user).toHaveProperty('email');
            expect(result.user).toHaveProperty('firstName');
            expect(result.user).toHaveProperty('lastName');
            expect(result.user).toHaveProperty('role');
            expect(result.user).toHaveProperty('emailVerified');
        });
        it('should return correctly formatted login response', async () => {
            // Arrange
            const loginDto = {
                email: auth_testing_helpers_1.TEST_EMAILS.THERAPIST,
                password: 'SecurePass123!',
            };
            const mockRequest = {
                ip: '192.168.1.1',
                get: jest.fn().mockReturnValue('Test User Agent'),
            };
            jest.spyOn(therapistAuthService, 'loginTherapist').mockResolvedValue(mockLoginResult);
            // Act
            const result = await controller.login(loginDto, mockRequest);
            // Assert
            expect(result).toHaveProperty('user');
            expect(result).toHaveProperty('accessToken');
            expect(result).toHaveProperty('refreshToken');
            expect(result).toHaveProperty('expiresIn');
            expect(result).not.toHaveProperty('message'); // Login doesn't include message
        });
        it('should return correctly formatted application response', async () => {
            // Arrange
            const mockApplicationResult = {
                application: { userId: 'temp_12345_therapist_at_example.com' },
                uploadedFiles: mockApplicationFiles,
            };
            jest.spyOn(therapistAuthService, 'createApplicationWithDocuments').mockResolvedValue(mockApplicationResult);
            // Act
            const result = await controller.applyWithDocuments(JSON.stringify(mockApplicationData), JSON.stringify({ '0': 'license', '1': 'diploma' }), mockFiles);
            // Assert
            expect(result).toHaveProperty('success');
            expect(result).toHaveProperty('message');
            expect(result).toHaveProperty('applicationId');
            expect(result).toHaveProperty('uploadedFiles');
            expect(result.success).toBe(true);
            expect(result.uploadedFiles).toBeInstanceOf(Array);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL2F1dGgvY29udHJvbGxlcnMvdGhlcmFwaXN0LWF1dGguY29udHJvbGxlci5zcGVjLnRzIiwibWFwcGluZ3MiOiI7O0FBQUEsNkNBQXNEO0FBQ3RELDJDQU13QjtBQUN4QixpREFBb0U7QUFDcEUsMkVBQXNFO0FBQ3RFLCtFQUEwRTtBQUMxRSw2REFBd0Q7QUFDeEQsNkZBQXdGO0FBQ3hGLGdGQUEyRTtBQUMzRSxnRkFRK0M7QUFFL0MsUUFBUSxDQUFDLHlCQUF5QixFQUFFLEdBQUcsRUFBRTtJQUN2QyxJQUFJLFVBQW1DLENBQUM7SUFDeEMsSUFBSSxvQkFBMEMsQ0FBQztJQUMvQyxJQUFJLHNCQUE4QyxDQUFDO0lBQ25ELElBQUksZ0JBQTJDLENBQUM7SUFFaEQsc0JBQXNCO0lBQ3RCLE1BQU0saUJBQWlCLEdBQUc7UUFDeEIsRUFBRSxFQUFFLG9DQUFhLENBQUMsU0FBUztRQUMzQixLQUFLLEVBQUUsa0NBQVcsQ0FBQyxTQUFTO1FBQzVCLFNBQVMsRUFBRSxVQUFVO1FBQ3JCLFFBQVEsRUFBRSxPQUFPO1FBQ2pCLElBQUksRUFBRSxXQUFXO1FBQ2pCLGFBQWEsRUFBRSxLQUFLO1FBQ3BCLGFBQWEsRUFBRSxXQUFXO1FBQzFCLGVBQWUsRUFBRSxDQUFDLFNBQVMsRUFBRSxZQUFZLENBQUM7UUFDMUMsY0FBYyxFQUFFLFNBQVM7UUFDekIsZUFBZSxFQUFFLElBQUk7UUFDckIsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFO0tBQ3RCLENBQUM7SUFFRixNQUFNLFVBQVUsR0FBRztRQUNqQixXQUFXLEVBQUUsbUJBQW1CO1FBQ2hDLFlBQVksRUFBRSxvQkFBb0I7UUFDbEMsU0FBUyxFQUFFLElBQUk7S0FDaEIsQ0FBQztJQUVGLE1BQU0sc0JBQXNCLEdBQUc7UUFDN0IsSUFBSSxFQUFFLGlCQUFpQjtRQUN2QixNQUFNLEVBQUUsVUFBVTtRQUNsQixPQUFPLEVBQUUsd0NBQXdDO0tB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QyxFQUNsRCxTQUFTLENBQ1YsQ0FBQztZQUVGLFNBQVM7WUFDVCxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsY0FBYyxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQ3pDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxjQUFjLENBQUMsU0FBUyxDQUFDLENBQUM7WUFDekMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGNBQWMsQ0FBQyxlQUFlLENBQUMsQ0FBQztZQUMvQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsY0FBYyxDQUFDLGVBQWUsQ0FBQyxDQUFDO1lBRS9DLE1BQU0sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ2xDLE1BQU0sQ0FBQyxNQUFNLENBQUMsYUFBYSxDQUFDLENBQUMsY0FBYyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3JELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS93ZXRvb2EvRG9jdW1lbnRzL2NvZGUvcHJvamVjdHMvbWVudGFyYS9tZW50YXJhLWFwaS9zcmMvYXV0aC9jb250cm9sbGVycy90aGVyYXBpc3QtYXV0aC5jb250cm9sbGVyLnNwZWMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVGVzdCwgVGVzdGluZ01vZHVsZSB9IGZyb20gJ0BuZXN0anMvdGVzdGluZyc7XG5pbXBvcnQgeyBcbiAgVW5hdXRob3JpemVkRXhjZXB0aW9uLCBcbiAgQmFkUmVxdWVzdEV4Y2VwdGlvbiwgXG4gIE5vdEZvdW5kRXhjZXB0aW9uLCBcbiAgRm9yYmlkZGVuRXhjZXB0aW9uLCBcbiAgSW50ZXJuYWxTZXJ2ZXJFcnJvckV4Y2VwdGlvbiBcbn0gZnJvbSAnQG5lc3Rqcy9jb21tb24nO1xuaW1wb3J0IHsgVGhyb3R0bGVyR3VhcmQsIFRocm90dGxlck1vZHVsZSB9IGZyb20gJ0BuZXN0anMvdGhyb3R0bGVyJztcbmltcG9ydCB7IFRoZXJhcGlzdEF1dGhDb250cm9sbGVyIH0gZnJvbSAnLi90aGVyYXBpc3QtYXV0aC5jb250cm9sbGVyJztcbmltcG9ydCB7IFRoZXJhcGlzdEF1dGhTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvdGhlcmFwaXN0LWF1dGguc2VydmljZSc7XG5pbXBvcnQgeyBKd3RBdXRoR3VhcmQgfSBmcm9tICcuLi9ndWFyZHMvand0LWF1dGguZ3VhcmQnO1xuaW1wb3J0IHsgU3VwYWJhc2VTdG9yYWdlU2VydmljZSB9IGZyb20gJy4uLy4uL2NvbW1vbi9zZXJ2aWNlcy9zdXBhYmFzZS1zdG9yYWdlLnNlcnZpY2UnO1xuaW1wb3J0IHsgWm9kVmFsaWRhdGlvblBpcGUgfSBmcm9tICcuLi8uLi9jb21tb24vcGlwZXMvem9kLXZhbGlkYXRpb24ucGlwZSc7XG5pbXBvcnQge1xuICBNb2NrQnVpbGRlcixcbiAgVGVzdERhdGFHZW5lcmF0b3IsXG4gIFRlc3RBc3NlcnRpb25zLFxuICBTZWN1cml0eUd1YXJkVGVzdFV0aWxzLFxuICBSb2xlQmFzZWRUZXN0VXRpbHMsXG4gIFRFU1RfVVNFUl9JRFMsXG4gIFRFU1RfRU1BSUxTLFxufSBmcm9tICcuLi8uLi90ZXN0LXV0aWxzL2F1dGgtdGVzdGluZy1oZWxwZXJzJztcblxuZGVzY3JpYmUoJ1RoZXJhcGlzdEF1dGhDb250cm9sbGVyJywgKCkgPT4ge1xuICBsZXQgY29udHJvbGxlcjogVGhlcmFwaXN0QXV0aENvbnRyb2xsZXI7XG4gIGxldCB0aGVyYXBpc3RBdXRoU2VydmljZTogVGhlcmFwaXN0QXV0aFNlcnZpY2U7XG4gIGxldCBzdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlOiBTdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlO1xuICBsZXQgbW9ja0p3dEF1dGhHdWFyZDogamVzdC5Nb2NrZWQ8Snd0QXV0aEd1YXJkPjtcblxuICAvLyBUZXN0IGRhdGEgY29uc3RhbnRzXG4gIGNvbnN0IG1vY2tUaGVyYXBpc3RVc2VyID0ge1xuICAgIGlkOiBURVNUX1VTRVJfSURTLlRIRVJBUElTVCxcbiAgICBlbWFpbDogVEVTVF9FTUFJTFMuVEhFUkFQSVNULFxuICAgIGZpcnN0TmFtZTogJ0RyLiBKYW5lJyxcbiAgICBsYXN0TmFtZTogJ1NtaXRoJyxcbiAgICByb2xlOiAndGhlcmFwaXN0JyxcbiAgICBlbWFpbFZlcmlmaWVkOiBmYWxzZSxcbiAgICBsaWNlbnNlTnVtYmVyOiAnTElDMTIzNDU2JyxcbiAgICBzcGVjaWFsaXphdGlvbnM6IFsnYW54aWV0eScsICdkZXByZXNzaW9uJ10sXG4gICAgYXBwcm92YWxTdGF0dXM6ICdwZW5kaW5nJyxcbiAgICBwcm9maWxlQ29tcGxldGU6IHRydWUsXG4gICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICB9O1xuXG4gIGNvbnN0IG1vY2tUb2tlbnMgPSB7XG4gICAgYWNjZXNzVG9rZW46ICdtb2NrLWFjY2Vzcy10b2tlbicsXG4gICAgcmVmcmVzaFRva2VuOiAnbW9jay1yZWZyZXNoLXRva2VuJyxcbiAgICBleHBpcmVzSW46IDM2MDAsXG4gIH07XG5cbiAgY29uc3QgbW9ja1JlZ2lzdHJhdGlvblJlc3VsdCA9IHtcbiAgICB1c2VyOiBtb2NrVGhlcmFwaXN0VXNlcixcbiAgICB0b2tlbnM6IG1vY2tUb2tlbnMsXG4gICAgbWVzc2FnZTogJ1RoZXJhcGlzdCBhY2NvdW50IGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5JyxcbiAgfTtcblxuICBjb25zdCBtb2NrTG9naW5SZXN1bHQgPSB7XG4gICAgdXNlcjogbW9ja1RoZXJhcGlzdFVzZXIsXG4gICAgdG9rZW5zOiBtb2NrVG9rZW5zLFxuICB9O1xuXG4gIGNvbnN0IG1vY2tUaGVyYXBpc3RBcHBsaWNhdGlvbiA9IHtcbiAgICBpZDogJ2FwcC0xMjMnLFxuICAgIGVtYWlsOiBURVNUX0VNQUlMUy5USEVSQVBJU1QsXG4gICAgZmlyc3ROYW1lOiAnRHIuIEphbmUnLFxuICAgIGxhc3ROYW1lOiAnU21pdGgnLFxuICAgIGxpY2Vuc2VOdW1iZXI6ICdMSUMxMjM0NTYnLFxuICAgIHNwZWNpYWxpemF0aW9uczogWydhbnhpZXR5JywgJ2RlcHJlc3Npb24nXSxcbiAgICBlZHVjYXRpb246ICdQaEQgaW4gUHN5Y2hvbG9neScsXG4gICAgZXhwZXJpZW5jZTogJzUgeWVhcnMnLFxuICAgIHN0YXR1czogJ3BlbmRpbmcnLFxuICAgIHN1Ym1pdHRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgIHJldmlld2VkQXQ6IG51bGwsXG4gICAgbm90ZXM6IG51bGwsXG4gICAgcmV2aWV3ZXJDb21tZW50czogbnVsbCxcbiAgfTtcblxuICBjb25zdCBtb2NrQXBwbGljYXRpb25GaWxlcyA9IFtcbiAgICB7XG4gICAgICBpZDogJ2ZpbGUtMTIzJyxcbiAgICAgIGZpbGVOYW1lOiAnbGljZW5zZS5wZGYnLFxuICAgICAgZmlsZVVybDogJ2h0dHBzOi8vZXhhbXBsZS5jb20vbGljZW5zZS5wZGYnLFxuICAgICAgdXBsb2FkZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgIH0sXG4gICAge1xuICAgICAgaWQ6ICdmaWxlLTQ1NicsXG4gICAgICBmaWxlTmFtZTogJ2RpcGxvbWEucGRmJyxcbiAgICAgIGZpbGVVcmw6ICdodHRwczovL2V4YW1wbGUuY29tL2RpcGxvbWEucGRmJyxcbiAgICAgIHVwbG9hZGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICB9LFxuICBdO1xuXG4gIGNvbnN0IG1vY2tGaWxlcyA9IFtcbiAgICB7XG4gICAgICBmaWVsZG5hbWU6ICdmaWxlcycsXG4gICAgICBvcmlnaW5hbG5hbWU6ICdsaWNlbnNlLnBkZicsXG4gICAgICBlbmNvZGluZzogJzdiaXQnLFxuICAgICAgbWltZXR5cGU6ICdhcHBsaWNhdGlvbi9wZGYnLFxuICAgICAgc2l6ZTogMTAyNCxcbiAgICAgIGJ1ZmZlcjogQnVmZmVyLmZyb20oJ3Rlc3QgbGljZW5zZSBjb250ZW50JyksXG4gICAgfSxcbiAgICB7XG4gICAgICBmaWVsZG5hbWU6ICdmaWxlcycsXG4gICAgICBvcmlnaW5hbG5hbWU6ICdkaXBsb21hLnBkZicsXG4gICAgICBlbmNvZGluZzogJzdiaXQnLFxuICAgICAgbWltZXR5cGU6ICdhcHBsaWNhdGlvbi9wZGYnLFxuICAgICAgc2l6ZTogMjA0OCxcbiAgICAgIGJ1ZmZlcjogQnVmZmVyLmZyb20oJ3Rlc3QgZGlwbG9tYSBjb250ZW50JyksXG4gICAgfSxcbiAgXSBhcyBFeHByZXNzLk11bHRlci5GaWxlW107XG5cbiAgY29uc3QgbW9ja0FwcGxpY2F0aW9uRGF0YSA9IHtcbiAgICBlbWFpbDogVEVTVF9FTUFJTFMuVEhFUkFQSVNULFxuICAgIGZpcnN0TmFtZTogJ0RyLiBKYW5lJyxcbiAgICBsYXN0TmFtZTogJ1NtaXRoJyxcbiAgICBsaWNlbnNlTnVtYmVyOiAnTElDMTIzNDU2JyxcbiAgICBzcGVjaWFsaXphdGlvbnM6IFsnYW54aWV0eScsICdkZXByZXNzaW9uJ10sXG4gICAgZWR1Y2F0aW9uOiAnUGhEIGluIFBzeWNob2xvZ3knLFxuICAgIGV4cGVyaWVuY2U6ICc1IHllYXJzJyxcbiAgfTtcblxuICBiZWZvcmVFYWNoKGFzeW5jICgpID0+IHtcbiAgICAvLyBDcmVhdGUgbW9jayBzZXJ2aWNlc1xuICAgIGNvbnN0IG1vY2tUaGVyYXBpc3RBdXRoU2VydmljZSA9IHtcbiAgICAgIHJlZ2lzdGVyVGhlcmFwaXN0OiBqZXN0LmZuKCksXG4gICAgICBsb2dpblRoZXJhcGlzdDogamVzdC5mbigpLFxuICAgICAgZ2V0VGhlcmFwaXN0UHJvZmlsZTogamVzdC5mbigpLFxuICAgICAgY3JlYXRlQXBwbGljYXRpb25XaXRoRG9jdW1lbnRzOiBqZXN0LmZuKCksXG4gICAgICBnZXRBbGxBcHBsaWNhdGlvbnM6IGplc3QuZm4oKSxcbiAgICAgIGdldEFwcGxpY2F0aW9uQnlJZDogamVzdC5mbigpLFxuICAgICAgdXBkYXRlQXBwbGljYXRpb25TdGF0dXM6IGplc3QuZm4oKSxcbiAgICAgIGdldEFwcGxpY2F0aW9uRmlsZXM6IGplc3QuZm4oKSxcbiAgICB9O1xuXG4gICAgY29uc3QgbW9ja1N1cGFiYXNlU3RvcmFnZVNlcnZpY2UgPSB7XG4gICAgICB2YWxpZGF0ZUZpbGU6IGplc3QuZm4oKSxcbiAgICAgIHVwbG9hZEZpbGVzOiBqZXN0LmZuKCksXG4gICAgICBnZXRTdXBwb3J0ZWRCdWNrZXRzOiBqZXN0LmZuKCksXG4gICAgfTtcblxuICAgIG1vY2tKd3RBdXRoR3VhcmQgPSB7XG4gICAgICBjYW5BY3RpdmF0ZTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh0cnVlKSxcbiAgICB9IGFzIGFueTtcblxuICAgIGNvbnN0IG1vZHVsZTogVGVzdGluZ01vZHVsZSA9IGF3YWl0IFRlc3QuY3JlYXRlVGVzdGluZ01vZHVsZSh7XG4gICAgICBpbXBvcnRzOiBbXG4gICAgICAgIFRocm90dGxlck1vZHVsZS5mb3JSb290KFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBuYW1lOiAnc2hvcnQnLFxuICAgICAgICAgICAgdHRsOiAxMDAwLFxuICAgICAgICAgICAgbGltaXQ6IDMsXG4gICAgICAgICAgfSxcbiAgICAgICAgXSksXG4gICAgICBdLFxuICAgICAgY29udHJvbGxlcnM6IFtUaGVyYXBpc3RBdXRoQ29udHJvbGxlcl0sXG4gICAgICBwcm92aWRlcnM6IFtcbiAgICAgICAge1xuICAgICAgICAgIHByb3ZpZGU6IFRoZXJhcGlzdEF1dGhTZXJ2aWNlLFxuICAgICAgICAgIHVzZVZhbHVlOiBtb2NrVGhlcmFwaXN0QXV0aFNlcnZpY2UsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlOiBTdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlLFxuICAgICAgICAgIHVzZVZhbHVlOiBtb2NrU3VwYWJhc2VTdG9yYWdlU2VydmljZSxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSlcbiAgICAgIC5vdmVycmlkZUd1YXJkKEp3dEF1dGhHdWFyZClcbiAgICAgIC51c2VWYWx1ZShtb2NrSnd0QXV0aEd1YXJkKVxuICAgICAgLm92ZXJyaWRlR3VhcmQoVGhyb3R0bGVyR3VhcmQpXG4gICAgICAudXNlVmFsdWUoeyBjYW5BY3RpdmF0ZTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh0cnVlKSB9KVxuICAgICAgLmNvbXBpbGUoKTtcblxuICAgIGNvbnRyb2xsZXIgPSBtb2R1bGUuZ2V0PFRoZXJhcGlzdEF1dGhDb250cm9sbGVyPihUaGVyYXBpc3RBdXRoQ29udHJvbGxlcik7XG4gICAgdGhlcmFwaXN0QXV0aFNlcnZpY2UgPSBtb2R1bGUuZ2V0PFRoZXJhcGlzdEF1dGhTZXJ2aWNlPihUaGVyYXBpc3RBdXRoU2VydmljZSk7XG4gICAgc3VwYWJhc2VTdG9yYWdlU2VydmljZSA9IG1vZHVsZS5nZXQ8U3VwYWJhc2VTdG9yYWdlU2VydmljZT4oU3VwYWJhc2VTdG9yYWdlU2VydmljZSk7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdyZWdpc3RlcicsICgpID0+IHtcbiAgICBjb25zdCB2YWxpZFJlZ2lzdGVyRHRvID0ge1xuICAgICAgZW1haWw6ICduZXd0aGVyYXBpc3RAZXhhbXBsZS5jb20nLFxuICAgICAgcGFzc3dvcmQ6ICdTZWN1cmVQYXNzMTIzIScsXG4gICAgICBmaXJzdE5hbWU6ICdEci4gU2FyYWgnLFxuICAgICAgbGFzdE5hbWU6ICdKb2huc29uJyxcbiAgICB9O1xuXG4gICAgaXQoJ3Nob3VsZCByZWdpc3RlciB0aGVyYXBpc3Qgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgamVzdC5zcHlPbih0aGVyYXBpc3RBdXRoU2VydmljZSwgJ3JlZ2lzdGVyVGhlcmFwaXN0JykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1JlZ2lzdHJhdGlvblJlc3VsdCk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5yZWdpc3Rlcih2YWxpZFJlZ2lzdGVyRHRvKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QodGhlcmFwaXN0QXV0aFNlcnZpY2UucmVnaXN0ZXJUaGVyYXBpc3QpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICB2YWxpZFJlZ2lzdGVyRHRvLmVtYWlsLFxuICAgICAgICB2YWxpZFJlZ2lzdGVyRHRvLnBhc3N3b3JkLFxuICAgICAgICB2YWxpZFJlZ2lzdGVyRHRvLmZpcnN0TmFtZSxcbiAgICAgICAgdmFsaWRSZWdpc3RlckR0by5sYXN0TmFtZSxcbiAgICAgICk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiBtb2NrVGhlcmFwaXN0VXNlci5pZCxcbiAgICAgICAgICBlbWFpbDogbW9ja1RoZXJhcGlzdFVzZXIuZW1haWwsXG4gICAgICAgICAgZmlyc3ROYW1lOiBtb2NrVGhlcmFwaXN0VXNlci5maXJzdE5hbWUsXG4gICAgICAgICAgbGFzdE5hbWU6IG1vY2tUaGVyYXBpc3RVc2VyLmxhc3ROYW1lLFxuICAgICAgICAgIHJvbGU6IG1vY2tUaGVyYXBpc3RVc2VyLnJvbGUsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogbW9ja1RoZXJhcGlzdFVzZXIuZW1haWxWZXJpZmllZCxcbiAgICAgICAgfSxcbiAgICAgICAgYWNjZXNzVG9rZW46IG1vY2tUb2tlbnMuYWNjZXNzVG9rZW4sXG4gICAgICAgIHJlZnJlc2hUb2tlbjogbW9ja1Rva2Vucy5yZWZyZXNoVG9rZW4sXG4gICAgICAgIGV4cGlyZXNJbjogbW9ja1Rva2Vucy5leHBpcmVzSW4sXG4gICAgICAgIG1lc3NhZ2U6IG1vY2tSZWdpc3RyYXRpb25SZXN1bHQubWVzc2FnZSxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZW1haWwgYWxyZWFkeSBleGlzdHMgZXJyb3InLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBCYWRSZXF1ZXN0RXhjZXB0aW9uKCdFbWFpbCBhbHJlYWR5IGV4aXN0cycpO1xuICAgICAgamVzdC5zcHlPbih0aGVyYXBpc3RBdXRoU2VydmljZSwgJ3JlZ2lzdGVyVGhlcmFwaXN0JykubW9ja1JlamVjdGVkVmFsdWUoZXJyb3IpO1xuXG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChjb250cm9sbGVyLnJlZ2lzdGVyKHZhbGlkUmVnaXN0ZXJEdG8pKS5yZWplY3RzLnRvVGhyb3coQmFkUmVxdWVzdEV4Y2VwdGlvbik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzZXJ2aWNlIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCdEYXRhYmFzZSBlcnJvcicpO1xuICAgICAgamVzdC5zcHlPbih0aGVyYXBpc3RBdXRoU2VydmljZSwgJ3JlZ2lzdGVyVGhlcmFwaXN0JykubW9ja1JlamVjdGVkVmFsdWUoZXJyb3IpO1xuXG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChjb250cm9sbGVyLnJlZ2lzdGVyKHZhbGlkUmVnaXN0ZXJEdG8pKS5yZWplY3RzLnRvVGhyb3coZXJyb3IpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnbG9naW4nLCAoKSA9PiB7XG4gICAgY29uc3QgdmFsaWRMb2dpbkR0byA9IHtcbiAgICAgIGVtYWlsOiBURVNUX0VNQUlMUy5USEVSQVBJU1QsXG4gICAgICBwYXNzd29yZDogJ1NlY3VyZVBhc3MxMjMhJyxcbiAgICB9O1xuXG4gICAgY29uc3QgbW9ja1JlcXVlc3QgPSB7XG4gICAgICBpcDogJzE5Mi4xNjguMS4xJyxcbiAgICAgIGdldDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnVGVzdCBVc2VyIEFnZW50JyksXG4gICAgfSBhcyBhbnk7XG5cbiAgICBpdCgnc2hvdWxkIGxvZ2luIHRoZXJhcGlzdCBzdWNjZXNzZnVsbHkgd2l0aCB2YWxpZCBjcmVkZW50aWFscycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGplc3Quc3B5T24odGhlcmFwaXN0QXV0aFNlcnZpY2UsICdsb2dpblRoZXJhcGlzdCcpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tMb2dpblJlc3VsdCk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5sb2dpbih2YWxpZExvZ2luRHRvLCBtb2NrUmVxdWVzdCk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHRoZXJhcGlzdEF1dGhTZXJ2aWNlLmxvZ2luVGhlcmFwaXN0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgdmFsaWRMb2dpbkR0by5lbWFpbCxcbiAgICAgICAgdmFsaWRMb2dpbkR0by5wYXNzd29yZCxcbiAgICAgICAgbW9ja1JlcXVlc3QuaXAsXG4gICAgICAgICdUZXN0IFVzZXIgQWdlbnQnLFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogbW9ja1RoZXJhcGlzdFVzZXIuaWQsXG4gICAgICAgICAgZW1haWw6IG1vY2tUaGVyYXBpc3RVc2VyLmVtYWlsLFxuICAgICAgICAgIGZpcnN0TmFtZTogbW9ja1RoZXJhcGlzdFVzZXIuZmlyc3ROYW1lLFxuICAgICAgICAgIGxhc3ROYW1lOiBtb2NrVGhlcmFwaXN0VXNlci5sYXN0TmFtZSxcbiAgICAgICAgICByb2xlOiBtb2NrVGhlcmFwaXN0VXNlci5yb2xlLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IG1vY2tUaGVyYXBpc3RVc2VyLmVtYWlsVmVyaWZpZWQsXG4gICAgICAgIH0sXG4gICAgICAgIGFjY2Vzc1Rva2VuOiBtb2NrVG9rZW5zLmFjY2Vzc1Rva2VuLFxuICAgICAgICByZWZyZXNoVG9rZW46IG1vY2tUb2tlbnMucmVmcmVzaFRva2VuLFxuICAgICAgICBleHBpcmVzSW46IG1vY2tUb2tlbnMuZXhwaXJlc0luLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBtaXNzaW5nIFVzZXItQWdlbnQgaGVhZGVyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgbW9ja1JlcXVlc3RXaXRob3V0VXNlckFnZW50ID0ge1xuICAgICAgICBpcDogJzE5Mi4xNjguMS4xJyxcbiAgICAgICAgZ2V0OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHVuZGVmaW5lZCksXG4gICAgICB9IGFzIGFueTtcblxuICAgICAgamVzdC5zcHlPbih0aGVyYXBpc3RBdXRoU2VydmljZSwgJ2xvZ2luVGhlcmFwaXN0JykubW9ja1Jlc29sdmVkVmFsdWUobW9ja0xvZ2luUmVzdWx0KTtcblxuICAgICAgLy8gQWN0XG4gICAgICBhd2FpdCBjb250cm9sbGVyLmxvZ2luKHZhbGlkTG9naW5EdG8sIG1vY2tSZXF1ZXN0V2l0aG91dFVzZXJBZ2VudCk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHRoZXJhcGlzdEF1dGhTZXJ2aWNlLmxvZ2luVGhlcmFwaXN0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgdmFsaWRMb2dpbkR0by5lbWFpbCxcbiAgICAgICAgdmFsaWRMb2dpbkR0by5wYXNzd29yZCxcbiAgICAgICAgbW9ja1JlcXVlc3RXaXRob3V0VXNlckFnZW50LmlwLFxuICAgICAgICB1bmRlZmluZWQsXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgaW52YWxpZCBjcmVkZW50aWFscycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IGF1dGhFcnJvciA9IG5ldyBVbmF1dGhvcml6ZWRFeGNlcHRpb24oJ0ludmFsaWQgY3JlZGVudGlhbHMnKTtcbiAgICAgIGplc3Quc3B5T24odGhlcmFwaXN0QXV0aFNlcnZpY2UsICdsb2dpblRoZXJhcGlzdCcpLm1vY2tSZWplY3RlZFZhbHVlKGF1dGhFcnJvcik7XG5cbiAgICAgIC8vIEFjdCAmIEFzc2VydFxuICAgICAgYXdhaXQgZXhwZWN0KGNvbnRyb2xsZXIubG9naW4odmFsaWRMb2dpbkR0bywgbW9ja1JlcXVlc3QpKS5yZWplY3RzLnRvVGhyb3coYXV0aEVycm9yKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHNlcnZpY2UgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3Qgc2VydmljZUVycm9yID0gbmV3IEVycm9yKCdEYXRhYmFzZSBjb25uZWN0aW9uIGZhaWxlZCcpO1xuICAgICAgamVzdC5zcHlPbih0aGVyYXBpc3RBdXRoU2VydmljZSwgJ2xvZ2luVGhlcmFwaXN0JykubW9ja1JlamVjdGVkVmFsdWUoc2VydmljZUVycm9yKTtcblxuICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICBhd2FpdCBleHBlY3QoY29udHJvbGxlci5sb2dpbih2YWxpZExvZ2luRHRvLCBtb2NrUmVxdWVzdCkpLnJlamVjdHMudG9UaHJvdyhzZXJ2aWNlRXJyb3IpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZ2V0UHJvZmlsZScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiB0aGVyYXBpc3QgcHJvZmlsZSBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBqZXN0LnNweU9uKHRoZXJhcGlzdEF1dGhTZXJ2aWNlLCAnZ2V0VGhlcmFwaXN0UHJvZmlsZScpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tUaGVyYXBpc3RVc2VyKTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldFByb2ZpbGUoVEVTVF9VU0VSX0lEUy5USEVSQVBJU1QpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdCh0aGVyYXBpc3RBdXRoU2VydmljZS5nZXRUaGVyYXBpc3RQcm9maWxlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChURVNUX1VTRVJfSURTLlRIRVJBUElTVCk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKG1vY2tUaGVyYXBpc3RVc2VyKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHByb2ZpbGUgbm90IGZvdW5kJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3Qgbm90Rm91bmRFcnJvciA9IG5ldyBFcnJvcignVGhlcmFwaXN0IHByb2ZpbGUgbm90IGZvdW5kJyk7XG4gICAgICBqZXN0LnNweU9uKHRoZXJhcGlzdEF1dGhTZXJ2aWNlLCAnZ2V0VGhlcmFwaXN0UHJvZmlsZScpLm1vY2tSZWplY3RlZFZhbHVlKG5vdEZvdW5kRXJyb3IpO1xuXG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChjb250cm9sbGVyLmdldFByb2ZpbGUoVEVTVF9VU0VSX0lEUy5USEVSQVBJU1QpKS5yZWplY3RzLnRvVGhyb3cobm90Rm91bmRFcnJvcik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdhcHBseVdpdGhEb2N1bWVudHMnLCAoKSA9PiB7XG4gICAgY29uc3QgdmFsaWRBcHBsaWNhdGlvbkRhdGFKc29uID0gSlNPTi5zdHJpbmdpZnkobW9ja0FwcGxpY2F0aW9uRGF0YSk7XG4gICAgY29uc3QgdmFsaWRGaWxlVHlwZXMgPSBKU09OLnN0cmluZ2lmeSh7ICcwJzogJ2xpY2Vuc2UnLCAnMSc6ICdkaXBsb21hJyB9KTtcblxuICAgIGNvbnN0IG1vY2tBcHBsaWNhdGlvblJlc3VsdCA9IHtcbiAgICAgIGFwcGxpY2F0aW9uOiB7IHVzZXJJZDogJ3RlbXBfMTIzNDVfdGhlcmFwaXN0X2F0X2V4YW1wbGUuY29tJyB9LFxuICAgICAgdXBsb2FkZWRGaWxlczogW1xuICAgICAgICB7IGlkOiAnZmlsZS0xMjMnLCBmaWxlTmFtZTogJ2xpY2Vuc2UucGRmJywgdXJsOiAnaHR0cHM6Ly9leGFtcGxlLmNvbS9saWNlbnNlLnBkZicgfSxcbiAgICAgICAgeyBpZDogJ2ZpbGUtNDU2JywgZmlsZU5hbWU6ICdkaXBsb21hLnBkZicsIHVybDogJ2h0dHBzOi8vZXhhbXBsZS5jb20vZGlwbG9tYS5wZGYnIH0sXG4gICAgICBdLFxuICAgIH07XG5cbiAgICBpdCgnc2hvdWxkIHN1Ym1pdCBhcHBsaWNhdGlvbiB3aXRoIGRvY3VtZW50cyBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBqZXN0LnNweU9uKHRoZXJhcGlzdEF1dGhTZXJ2aWNlLCAnY3JlYXRlQXBwbGljYXRpb25XaXRoRG9jdW1lbnRzJykubW9ja1Jlc29sdmVkVmFsdWUobW9ja0FwcGxpY2F0aW9uUmVzdWx0KTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmFwcGx5V2l0aERvY3VtZW50cyhcbiAgICAgICAgdmFsaWRBcHBsaWNhdGlvbkRhdGFKc29uLFxuICAgICAgICB2YWxpZEZpbGVUeXBlcyxcbiAgICAgICAgbW9ja0ZpbGVzLFxuICAgICAgKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QodGhlcmFwaXN0QXV0aFNlcnZpY2UuY3JlYXRlQXBwbGljYXRpb25XaXRoRG9jdW1lbnRzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgIC4uLm1vY2tBcHBsaWNhdGlvbkRhdGEsXG4gICAgICAgICAgdXNlcklkOiBleHBlY3Quc3RyaW5nQ29udGFpbmluZygndGVtcF8nKSxcbiAgICAgICAgfSksXG4gICAgICAgIG1vY2tGaWxlcyxcbiAgICAgICAgeyAnMCc6ICdsaWNlbnNlJywgJzEnOiAnZGlwbG9tYScgfSxcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoe1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBtZXNzYWdlOiAnQXBwbGljYXRpb24gc3VibWl0dGVkIHN1Y2Nlc3NmdWxseSB3aXRoIGRvY3VtZW50cycsXG4gICAgICAgIGFwcGxpY2F0aW9uSWQ6IG1vY2tBcHBsaWNhdGlvblJlc3VsdC5hcHBsaWNhdGlvbi51c2VySWQsXG4gICAgICAgIHVwbG9hZGVkRmlsZXM6IG1vY2tBcHBsaWNhdGlvblJlc3VsdC51cGxvYWRlZEZpbGVzLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHN1Ym1pdCBhcHBsaWNhdGlvbiB3aXRob3V0IGZpbGVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgamVzdC5zcHlPbih0aGVyYXBpc3RBdXRoU2VydmljZSwgJ2NyZWF0ZUFwcGxpY2F0aW9uV2l0aERvY3VtZW50cycpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tBcHBsaWNhdGlvblJlc3VsdCk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5hcHBseVdpdGhEb2N1bWVudHMoXG4gICAgICAgIHZhbGlkQXBwbGljYXRpb25EYXRhSnNvbixcbiAgICAgICAgdmFsaWRGaWxlVHlwZXMsXG4gICAgICAgIFtdLFxuICAgICAgKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QodGhlcmFwaXN0QXV0aFNlcnZpY2UuY3JlYXRlQXBwbGljYXRpb25XaXRoRG9jdW1lbnRzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcobW9ja0FwcGxpY2F0aW9uRGF0YSksXG4gICAgICAgIFtdLFxuICAgICAgICB7ICcwJzogJ2xpY2Vuc2UnLCAnMSc6ICdkaXBsb21hJyB9LFxuICAgICAgKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG1pc3NpbmcgYXBwbGljYXRpb24gZGF0YScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFjdCAmIEFzc2VydFxuICAgICAgYXdhaXQgZXhwZWN0KGNvbnRyb2xsZXIuYXBwbHlXaXRoRG9jdW1lbnRzKCcnLCB2YWxpZEZpbGVUeXBlcywgbW9ja0ZpbGVzKSkucmVqZWN0cy50b1Rocm93KFxuICAgICAgICBCYWRSZXF1ZXN0RXhjZXB0aW9uLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGludmFsaWQgSlNPTiBmb3JtYXQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5hcHBseVdpdGhEb2N1bWVudHMoJ2ludmFsaWQganNvbicsIHZhbGlkRmlsZVR5cGVzLCBtb2NrRmlsZXMpLFxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coQmFkUmVxdWVzdEV4Y2VwdGlvbik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBlbWFpbCBhbHJlYWR5IGV4aXN0cyBlcnJvcicsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCdlbWFpbCBhbHJlYWR5IGV4aXN0cycpO1xuICAgICAgamVzdC5zcHlPbih0aGVyYXBpc3RBdXRoU2VydmljZSwgJ2NyZWF0ZUFwcGxpY2F0aW9uV2l0aERvY3VtZW50cycpLm1vY2tSZWplY3RlZFZhbHVlKGVycm9yKTtcblxuICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIuYXBwbHlXaXRoRG9jdW1lbnRzKHZhbGlkQXBwbGljYXRpb25EYXRhSnNvbiwgdmFsaWRGaWxlVHlwZXMsIG1vY2tGaWxlcyksXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhCYWRSZXF1ZXN0RXhjZXB0aW9uKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGZpbGUgdXBsb2FkIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCdmaWxlIHVwbG9hZCBmYWlsZWQnKTtcbiAgICAgIGplc3Quc3B5T24odGhlcmFwaXN0QXV0aFNlcnZpY2UsICdjcmVhdGVBcHBsaWNhdGlvbldpdGhEb2N1bWVudHMnKS5tb2NrUmVqZWN0ZWRWYWx1ZShlcnJvcik7XG5cbiAgICAgIC8vIEFjdCAmIEFzc2VydFxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLmFwcGx5V2l0aERvY3VtZW50cyh2YWxpZEFwcGxpY2F0aW9uRGF0YUpzb24sIHZhbGlkRmlsZVR5cGVzLCBtb2NrRmlsZXMpLFxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coQmFkUmVxdWVzdEV4Y2VwdGlvbik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSB2YWxpZGF0aW9uIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCd2YWxpZGF0aW9uIGZhaWxlZCcpO1xuICAgICAgamVzdC5zcHlPbih0aGVyYXBpc3RBdXRoU2VydmljZSwgJ2NyZWF0ZUFwcGxpY2F0aW9uV2l0aERvY3VtZW50cycpLm1vY2tSZWplY3RlZFZhbHVlKGVycm9yKTtcblxuICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIuYXBwbHlXaXRoRG9jdW1lbnRzKHZhbGlkQXBwbGljYXRpb25EYXRhSnNvbiwgdmFsaWRGaWxlVHlwZXMsIG1vY2tGaWxlcyksXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhCYWRSZXF1ZXN0RXhjZXB0aW9uKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHNlcnZpY2UgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ1Vua25vd24gZGF0YWJhc2UgZXJyb3InKTtcbiAgICAgIGplc3Quc3B5T24odGhlcmFwaXN0QXV0aFNlcnZpY2UsICdjcmVhdGVBcHBsaWNhdGlvbldpdGhEb2N1bWVudHMnKS5tb2NrUmVqZWN0ZWRWYWx1ZShlcnJvcik7XG5cbiAgICAgIC8vIEFjdCAmIEFzc2VydFxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLmFwcGx5V2l0aERvY3VtZW50cyh2YWxpZEFwcGxpY2F0aW9uRGF0YUpzb24sIHZhbGlkRmlsZVR5cGVzLCBtb2NrRmlsZXMpLFxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coSW50ZXJuYWxTZXJ2ZXJFcnJvckV4Y2VwdGlvbik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBpbnZhbGlkIGZpbGUgdHlwZXMgSlNPTicsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGplc3Quc3B5T24odGhlcmFwaXN0QXV0aFNlcnZpY2UsICdjcmVhdGVBcHBsaWNhdGlvbldpdGhEb2N1bWVudHMnKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrQXBwbGljYXRpb25SZXN1bHQpO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuYXBwbHlXaXRoRG9jdW1lbnRzKFxuICAgICAgICB2YWxpZEFwcGxpY2F0aW9uRGF0YUpzb24sXG4gICAgICAgICdpbnZhbGlkIGpzb24nLFxuICAgICAgICBtb2NrRmlsZXMsXG4gICAgICApO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdCh0aGVyYXBpc3RBdXRoU2VydmljZS5jcmVhdGVBcHBsaWNhdGlvbldpdGhEb2N1bWVudHMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyhtb2NrQXBwbGljYXRpb25EYXRhKSxcbiAgICAgICAgbW9ja0ZpbGVzLFxuICAgICAgICB7fSwgLy8gRW1wdHkgb2JqZWN0IHdoZW4gSlNPTiBwYXJzaW5nIGZhaWxzXG4gICAgICApO1xuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZ2V0QWxsQXBwbGljYXRpb25zJywgKCkgPT4ge1xuICAgIGNvbnN0IG1vY2tBcHBsaWNhdGlvbnNSZXN1bHQgPSB7XG4gICAgICBhcHBsaWNhdGlvbnM6IFttb2NrVGhlcmFwaXN0QXBwbGljYXRpb25dLFxuICAgICAgdG90YWxDb3VudDogMSxcbiAgICAgIHBhZ2U6IDEsXG4gICAgICB0b3RhbFBhZ2VzOiAxLFxuICAgIH07XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBhbGwgYXBwbGljYXRpb25zIGZvciBhZG1pbiB1c2VyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgamVzdC5zcHlPbih0aGVyYXBpc3RBdXRoU2VydmljZSwgJ2dldEFsbEFwcGxpY2F0aW9ucycpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tBcHBsaWNhdGlvbnNSZXN1bHQpO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0QWxsQXBwbGljYXRpb25zKCdhZG1pbicpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdCh0aGVyYXBpc3RBdXRoU2VydmljZS5nZXRBbGxBcHBsaWNhdGlvbnMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgc3RhdHVzOiB1bmRlZmluZWQsXG4gICAgICAgIHBhZ2U6IDEsXG4gICAgICAgIGxpbWl0OiAxMCxcbiAgICAgIH0pO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2NrQXBwbGljYXRpb25zUmVzdWx0KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGFwcGxpY2F0aW9ucyB3aXRoIGN1c3RvbSBmaWx0ZXJzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgamVzdC5zcHlPbih0aGVyYXBpc3RBdXRoU2VydmljZSwgJ2dldEFsbEFwcGxpY2F0aW9ucycpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tBcHBsaWNhdGlvbnNSZXN1bHQpO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0QWxsQXBwbGljYXRpb25zKCdhZG1pbicsICdwZW5kaW5nJywgMiwgMjApO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdCh0aGVyYXBpc3RBdXRoU2VydmljZS5nZXRBbGxBcHBsaWNhdGlvbnMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgc3RhdHVzOiAncGVuZGluZycsXG4gICAgICAgIHBhZ2U6IDIsXG4gICAgICAgIGxpbWl0OiAyMCxcbiAgICAgIH0pO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2NrQXBwbGljYXRpb25zUmVzdWx0KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHBhZ2luYXRpb24gYm91bmRzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgamVzdC5zcHlPbih0aGVyYXBpc3RBdXRoU2VydmljZSwgJ2dldEFsbEFwcGxpY2F0aW9ucycpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tBcHBsaWNhdGlvbnNSZXN1bHQpO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGF3YWl0IGNvbnRyb2xsZXIuZ2V0QWxsQXBwbGljYXRpb25zKCdhZG1pbicsIHVuZGVmaW5lZCwgMCwgMjAwKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QodGhlcmFwaXN0QXV0aFNlcnZpY2UuZ2V0QWxsQXBwbGljYXRpb25zKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIHN0YXR1czogdW5kZWZpbmVkLFxuICAgICAgICBwYWdlOiAxLCAvLyBDbGFtcGVkIHRvIG1pbmltdW0gMVxuICAgICAgICBsaW1pdDogMTAwLCAvLyBDbGFtcGVkIHRvIG1heGltdW0gMTAwXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdGhyb3cgRm9yYmlkZGVuRXhjZXB0aW9uIGZvciBub24tYWRtaW4gdXNlcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChjb250cm9sbGVyLmdldEFsbEFwcGxpY2F0aW9ucygnY2xpZW50JykpLnJlamVjdHMudG9UaHJvdyhGb3JiaWRkZW5FeGNlcHRpb24pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2VydmljZSBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcignRGF0YWJhc2UgZXJyb3InKTtcbiAgICAgIGplc3Quc3B5T24odGhlcmFwaXN0QXV0aFNlcnZpY2UsICdnZXRBbGxBcHBsaWNhdGlvbnMnKS5tb2NrUmVqZWN0ZWRWYWx1ZShlcnJvcik7XG5cbiAgICAgIC8vIEFjdCAmIEFzc2VydFxuICAgICAgYXdhaXQgZXhwZWN0KGNvbnRyb2xsZXIuZ2V0QWxsQXBwbGljYXRpb25zKCdhZG1pbicpKS5yZWplY3RzLnRvVGhyb3coSW50ZXJuYWxTZXJ2ZXJFcnJvckV4Y2VwdGlvbik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdnZXRBcHBsaWNhdGlvbkJ5SWQnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gYXBwbGljYXRpb24gYnkgSUQgZm9yIGFkbWluIHVzZXInLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBqZXN0LnNweU9uKHRoZXJhcGlzdEF1dGhTZXJ2aWNlLCAnZ2V0QXBwbGljYXRpb25CeUlkJykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1RoZXJhcGlzdEFwcGxpY2F0aW9uKTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldEFwcGxpY2F0aW9uQnlJZCgnYWRtaW4nLCAnYXBwLTEyMycpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdCh0aGVyYXBpc3RBdXRoU2VydmljZS5nZXRBcHBsaWNhdGlvbkJ5SWQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdhcHAtMTIzJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKG1vY2tUaGVyYXBpc3RBcHBsaWNhdGlvbik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IEZvcmJpZGRlbkV4Y2VwdGlvbiBmb3Igbm9uLWFkbWluIHVzZXJzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICBhd2FpdCBleHBlY3QoY29udHJvbGxlci5nZXRBcHBsaWNhdGlvbkJ5SWQoJ2NsaWVudCcsICdhcHAtMTIzJykpLnJlamVjdHMudG9UaHJvdyhGb3JiaWRkZW5FeGNlcHRpb24pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0aHJvdyBOb3RGb3VuZEV4Y2VwdGlvbiB3aGVuIGFwcGxpY2F0aW9uIG5vdCBmb3VuZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGplc3Quc3B5T24odGhlcmFwaXN0QXV0aFNlcnZpY2UsICdnZXRBcHBsaWNhdGlvbkJ5SWQnKS5tb2NrUmVzb2x2ZWRWYWx1ZShudWxsKTtcblxuICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICBhd2FpdCBleHBlY3QoY29udHJvbGxlci5nZXRBcHBsaWNhdGlvbkJ5SWQoJ2FkbWluJywgJ2FwcC0xMjMnKSkucmVqZWN0cy50b1Rocm93KE5vdEZvdW5kRXhjZXB0aW9uKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHNlcnZpY2UgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ0RhdGFiYXNlIGVycm9yJyk7XG4gICAgICBqZXN0LnNweU9uKHRoZXJhcGlzdEF1dGhTZXJ2aWNlLCAnZ2V0QXBwbGljYXRpb25CeUlkJykubW9ja1JlamVjdGVkVmFsdWUoZXJyb3IpO1xuXG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChjb250cm9sbGVyLmdldEFwcGxpY2F0aW9uQnlJZCgnYWRtaW4nLCAnYXBwLTEyMycpKS5yZWplY3RzLnRvVGhyb3coSW50ZXJuYWxTZXJ2ZXJFcnJvckV4Y2VwdGlvbik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCd1cGRhdGVBcHBsaWNhdGlvblN0YXR1cycsICgpID0+IHtcbiAgICBjb25zdCBtb2NrVXBkYXRlRGF0YSA9IHtcbiAgICAgIHN0YXR1czogJ2FwcHJvdmVkJyBhcyBjb25zdCxcbiAgICAgIG5vdGVzOiAnQXBwcm92ZWQgYnkgYWRtaW4nLFxuICAgICAgcmV2aWV3ZXJDb21tZW50czogJ0FsbCBkb2N1bWVudHMgdmVyaWZpZWQnLFxuICAgIH07XG5cbiAgICBjb25zdCBtb2NrVXBkYXRlUmVzdWx0ID0ge1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIG1lc3NhZ2U6ICdBcHBsaWNhdGlvbiBhcHByb3ZlZCBzdWNjZXNzZnVsbHknLFxuICAgICAgY3JlZGVudGlhbHM6IHtcbiAgICAgICAgZW1haWw6IFRFU1RfRU1BSUxTLlRIRVJBUElTVCxcbiAgICAgICAgcGFzc3dvcmQ6ICdnZW5lcmF0ZWQtcGFzc3dvcmQnLFxuICAgICAgfSxcbiAgICB9O1xuXG4gICAgaXQoJ3Nob3VsZCB1cGRhdGUgYXBwbGljYXRpb24gc3RhdHVzIHN1Y2Nlc3NmdWxseSBmb3IgYWRtaW4gdXNlcicsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGplc3Quc3B5T24odGhlcmFwaXN0QXV0aFNlcnZpY2UsICd1cGRhdGVBcHBsaWNhdGlvblN0YXR1cycpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVcGRhdGVSZXN1bHQpO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIudXBkYXRlQXBwbGljYXRpb25TdGF0dXMoJ2FkbWluJywgJ2FwcC0xMjMnLCBtb2NrVXBkYXRlRGF0YSk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHRoZXJhcGlzdEF1dGhTZXJ2aWNlLnVwZGF0ZUFwcGxpY2F0aW9uU3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnYXBwLTEyMycsIG1vY2tVcGRhdGVEYXRhKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja1VwZGF0ZVJlc3VsdCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IEZvcmJpZGRlbkV4Y2VwdGlvbiBmb3Igbm9uLWFkbWluIHVzZXJzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICBhd2FpdCBleHBlY3QoY29udHJvbGxlci51cGRhdGVBcHBsaWNhdGlvblN0YXR1cygnY2xpZW50JywgJ2FwcC0xMjMnLCBtb2NrVXBkYXRlRGF0YSkpLnJlamVjdHMudG9UaHJvdyhcbiAgICAgICAgRm9yYmlkZGVuRXhjZXB0aW9uLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIE5vdEZvdW5kRXhjZXB0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3Qgbm90Rm91bmRFcnJvciA9IG5ldyBOb3RGb3VuZEV4Y2VwdGlvbignQXBwbGljYXRpb24gbm90IGZvdW5kJyk7XG4gICAgICBqZXN0LnNweU9uKHRoZXJhcGlzdEF1dGhTZXJ2aWNlLCAndXBkYXRlQXBwbGljYXRpb25TdGF0dXMnKS5tb2NrUmVqZWN0ZWRWYWx1ZShub3RGb3VuZEVycm9yKTtcblxuICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICBhd2FpdCBleHBlY3QoY29udHJvbGxlci51cGRhdGVBcHBsaWNhdGlvblN0YXR1cygnYWRtaW4nLCAnYXBwLTEyMycsIG1vY2tVcGRhdGVEYXRhKSkucmVqZWN0cy50b1Rocm93KFxuICAgICAgICBOb3RGb3VuZEV4Y2VwdGlvbixcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzZXJ2aWNlIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCdEYXRhYmFzZSBlcnJvcicpO1xuICAgICAgamVzdC5zcHlPbih0aGVyYXBpc3RBdXRoU2VydmljZSwgJ3VwZGF0ZUFwcGxpY2F0aW9uU3RhdHVzJykubW9ja1JlamVjdGVkVmFsdWUoZXJyb3IpO1xuXG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChjb250cm9sbGVyLnVwZGF0ZUFwcGxpY2F0aW9uU3RhdHVzKCdhZG1pbicsICdhcHAtMTIzJywgbW9ja1VwZGF0ZURhdGEpKS5yZWplY3RzLnRvVGhyb3coXG4gICAgICAgIEludGVybmFsU2VydmVyRXJyb3JFeGNlcHRpb24sXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZ2V0QXBwbGljYXRpb25GaWxlcycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiBhcHBsaWNhdGlvbiBmaWxlcyBmb3IgYWRtaW4gdXNlcicsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGplc3Quc3B5T24odGhlcmFwaXN0QXV0aFNlcnZpY2UsICdnZXRBcHBsaWNhdGlvbkZpbGVzJykubW9ja1Jlc29sdmVkVmFsdWUobW9ja0FwcGxpY2F0aW9uRmlsZXMpO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0QXBwbGljYXRpb25GaWxlcygnYWRtaW4nLCAnYXBwLTEyMycpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdCh0aGVyYXBpc3RBdXRoU2VydmljZS5nZXRBcHBsaWNhdGlvbkZpbGVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnYXBwLTEyMycpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2NrQXBwbGljYXRpb25GaWxlcyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IEZvcmJpZGRlbkV4Y2VwdGlvbiBmb3Igbm9uLWFkbWluIHVzZXJzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICBhd2FpdCBleHBlY3QoY29udHJvbGxlci5nZXRBcHBsaWNhdGlvbkZpbGVzKCdjbGllbnQnLCAnYXBwLTEyMycpKS5yZWplY3RzLnRvVGhyb3coRm9yYmlkZGVuRXhjZXB0aW9uKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIE5vdEZvdW5kRXhjZXB0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3Qgbm90Rm91bmRFcnJvciA9IG5ldyBOb3RGb3VuZEV4Y2VwdGlvbignQXBwbGljYXRpb24gZmlsZXMgbm90IGZvdW5kJyk7XG4gICAgICBqZXN0LnNweU9uKHRoZXJhcGlzdEF1dGhTZXJ2aWNlLCAnZ2V0QXBwbGljYXRpb25GaWxlcycpLm1vY2tSZWplY3RlZFZhbHVlKG5vdEZvdW5kRXJyb3IpO1xuXG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChjb250cm9sbGVyLmdldEFwcGxpY2F0aW9uRmlsZXMoJ2FkbWluJywgJ2FwcC0xMjMnKSkucmVqZWN0cy50b1Rocm93KE5vdEZvdW5kRXhjZXB0aW9uKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHNlcnZpY2UgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ0RhdGFiYXNlIGVycm9yJyk7XG4gICAgICBqZXN0LnNweU9uKHRoZXJhcGlzdEF1dGhTZXJ2aWNlLCAnZ2V0QXBwbGljYXRpb25GaWxlcycpLm1vY2tSZWplY3RlZFZhbHVlKGVycm9yKTtcblxuICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICBhd2FpdCBleHBlY3QoY29udHJvbGxlci5nZXRBcHBsaWNhdGlvbkZpbGVzKCdhZG1pbicsICdhcHAtMTIzJykpLnJlamVjdHMudG9UaHJvdyhJbnRlcm5hbFNlcnZlckVycm9yRXhjZXB0aW9uKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1NlY3VyaXR5IFRlc3RzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgaW5wdXQgZGF0YSB0aHJvdWdoIFpvZFZhbGlkYXRpb25QaXBlJywgKCkgPT4ge1xuICAgICAgLy8gVGhpcyB0ZXN0cyB0aGF0IHRoZSBjb250cm9sbGVyIHVzZXMgcHJvcGVyIHZhbGlkYXRpb25cbiAgICAgIGNvbnN0IHZhbGlkYXRpb25QaXBlID0gbmV3IFpvZFZhbGlkYXRpb25QaXBlKHt9IGFzIGFueSk7XG4gICAgICBleHBlY3QodmFsaWRhdGlvblBpcGUpLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFwcGx5IHJhdGUgbGltaXRpbmcgdGhyb3VnaCBUaHJvdHRsZXJHdWFyZCcsICgpID0+IHtcbiAgICAgIC8vIFRlc3QgdGhhdCB0aHJvdHRsaW5nIGlzIGNvbmZpZ3VyZWRcbiAgICAgIGNvbnN0IHJlZ2lzdGVyTWV0YWRhdGEgPSBSZWZsZWN0LmdldE1ldGFkYXRhKCdfX3Rocm90dGxlcl9vcHRpb25zX18nLCBjb250cm9sbGVyLnJlZ2lzdGVyKTtcbiAgICAgIGNvbnN0IGxvZ2luTWV0YWRhdGEgPSBSZWZsZWN0LmdldE1ldGFkYXRhKCdfX3Rocm90dGxlcl9vcHRpb25zX18nLCBjb250cm9sbGVyLmxvZ2luKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlZ2lzdGVyTWV0YWRhdGEpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QobG9naW5NZXRhZGF0YSkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVxdWlyZSBhdXRoZW50aWNhdGlvbiBmb3IgcHJvdGVjdGVkIGVuZHBvaW50cycsICgpID0+IHtcbiAgICAgIC8vIFRlc3QgdGhhdCBwcm90ZWN0ZWQgZW5kcG9pbnRzIGhhdmUgSnd0QXV0aEd1YXJkXG4gICAgICBjb25zdCBwcm90ZWN0ZWRNZXRob2RzID0gWydnZXRQcm9maWxlJywgJ2dldEFsbEFwcGxpY2F0aW9ucycsICdnZXRBcHBsaWNhdGlvbkJ5SWQnLCAndXBkYXRlQXBwbGljYXRpb25TdGF0dXMnLCAnZ2V0QXBwbGljYXRpb25GaWxlcyddO1xuICAgICAgXG4gICAgICBwcm90ZWN0ZWRNZXRob2RzLmZvckVhY2gobWV0aG9kID0+IHtcbiAgICAgICAgY29uc3QgZ3VhcmRzID0gUmVmbGVjdC5nZXRNZXRhZGF0YSgnX19ndWFyZHNfXycsIGNvbnRyb2xsZXJbbWV0aG9kIGFzIGtleW9mIFRoZXJhcGlzdEF1dGhDb250cm9sbGVyXSk7XG4gICAgICAgIGV4cGVjdChndWFyZHMpLnRvQmVEZWZpbmVkKCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYWxsb3cgcHVibGljIGFjY2VzcyB0byBwdWJsaWMgZW5kcG9pbnRzJywgKCkgPT4ge1xuICAgICAgLy8gVGVzdCB0aGF0IHB1YmxpYyBlbmRwb2ludHMgYXJlIG1hcmtlZCBhcyBwdWJsaWNcbiAgICAgIGNvbnN0IHB1YmxpY01ldGhvZHMgPSBbJ3JlZ2lzdGVyJywgJ2xvZ2luJywgJ2FwcGx5V2l0aERvY3VtZW50cyddO1xuICAgICAgXG4gICAgICBwdWJsaWNNZXRob2RzLmZvckVhY2gobWV0aG9kID0+IHtcbiAgICAgICAgY29uc3QgcHVibGljTWV0YWRhdGEgPSBSZWZsZWN0LmdldE1ldGFkYXRhKCdpc1B1YmxpYycsIGNvbnRyb2xsZXJbbWV0aG9kIGFzIGtleW9mIFRoZXJhcGlzdEF1dGhDb250cm9sbGVyXSk7XG4gICAgICAgIGV4cGVjdChwdWJsaWNNZXRhZGF0YSkudG9CZVRydXRoeSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdSb2xlLWJhc2VkIEFjY2VzcyBDb250cm9sJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgdGVzdCByb2xlLWJhc2VkIGFjY2VzcyBmb3IgYWRtaW4gZW5kcG9pbnRzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gVGVzdCB0aGF0IGFkbWluIGVuZHBvaW50cyByZXF1aXJlIGFkbWluIHJvbGVcbiAgICAgIGF3YWl0IFJvbGVCYXNlZFRlc3RVdGlscy50ZXN0V2l0aFJvbGVzKFxuICAgICAgICBhc3luYyAodXNlcklkOiBzdHJpbmcsIHJvbGU6IHN0cmluZykgPT4ge1xuICAgICAgICAgIC8vIE1vY2sgdGhlIGF1dGggZ3VhcmQgdG8gcmV0dXJuIHRoZSBzcGVjaWZpYyByb2xlXG4gICAgICAgICAgbW9ja0p3dEF1dGhHdWFyZC5jYW5BY3RpdmF0ZS5tb2NrUmV0dXJuVmFsdWUocm9sZSA9PT0gJ2FkbWluJyk7XG4gICAgICAgICAgXG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IGNvbnRyb2xsZXIuZ2V0QWxsQXBwbGljYXRpb25zKHJvbGUpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBjbGllbnQ6IGZhbHNlLFxuICAgICAgICAgIHRoZXJhcGlzdDogZmFsc2UsXG4gICAgICAgICAgYWRtaW46IHRydWUsXG4gICAgICAgICAgbW9kZXJhdG9yOiBmYWxzZSxcbiAgICAgICAgfSxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIHRoZXJhcGlzdC1zcGVjaWZpYyBmdW5jdGlvbmFsaXR5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gVGVzdCB0aGF0IHRoZXJhcGlzdC1zcGVjaWZpYyBlbmRwb2ludHMgd29yayBmb3IgdGhlcmFwaXN0c1xuICAgICAgY29uc3QgdGhlcmFwaXN0Q29udGV4dCA9IE1vY2tCdWlsZGVyLmNyZWF0ZUF1dGhDb250ZXh0KCd0aGVyYXBpc3QnKTtcbiAgICAgIFxuICAgICAgamVzdC5zcHlPbih0aGVyYXBpc3RBdXRoU2VydmljZSwgJ2dldFRoZXJhcGlzdFByb2ZpbGUnKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVGhlcmFwaXN0VXNlcik7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0UHJvZmlsZSh0aGVyYXBpc3RDb250ZXh0LnVzZXJJZCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QocmVzdWx0LnJvbGUpLnRvQmUoJ3RoZXJhcGlzdCcpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRXJyb3IgSGFuZGxpbmcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbmV0d29yayBlcnJvcnMgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IG5ldHdvcmtFcnJvciA9IG5ldyBFcnJvcignTmV0d29yayB0aW1lb3V0Jyk7XG4gICAgICBqZXN0LnNweU9uKHRoZXJhcGlzdEF1dGhTZXJ2aWNlLCAnZ2V0VGhlcmFwaXN0UHJvZmlsZScpLm1vY2tSZWplY3RlZFZhbHVlKG5ldHdvcmtFcnJvcik7XG5cbiAgICAgIC8vIEFjdCAmIEFzc2VydFxuICAgICAgYXdhaXQgZXhwZWN0KGNvbnRyb2xsZXIuZ2V0UHJvZmlsZShURVNUX1VTRVJfSURTLlRIRVJBUElTVCkpLnJlamVjdHMudG9UaHJvdyhuZXR3b3JrRXJyb3IpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgdmFsaWRhdGlvbiBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBUZXN0IHRoYXQgaW52YWxpZCBkYXRhIHdvdWxkIGJlIGNhdWdodCBieSB0aGUgdmFsaWRhdGlvbiBwaXBlXG4gICAgICBjb25zdCBpbnZhbGlkRGF0YSA9IHtcbiAgICAgICAgZW1haWw6ICdpbnZhbGlkLWVtYWlsJyxcbiAgICAgICAgcGFzc3dvcmQ6ICcxMjMnLCAvLyBUb28gc2hvcnRcbiAgICAgICAgZmlyc3ROYW1lOiAnJyxcbiAgICAgICAgbGFzdE5hbWU6ICcnLFxuICAgICAgfTtcblxuICAgICAgLy8gSW4gYSByZWFsIHNjZW5hcmlvLCB0aGlzIHdvdWxkIHRocm93IGEgdmFsaWRhdGlvbiBlcnJvclxuICAgICAgLy8gVGhlIHBpcGUgd291bGQgY2F0Y2ggdGhpcyBiZWZvcmUgaXQgcmVhY2hlcyB0aGUgY29udHJvbGxlclxuICAgICAgZXhwZWN0KCgpID0+IHtcbiAgICAgICAgLy8gVGhpcyB3b3VsZCBiZSBoYW5kbGVkIGJ5IFpvZFZhbGlkYXRpb25QaXBlXG4gICAgICAgIC8vIGFuZCB3b3VsZCB0aHJvdyBhIEJhZFJlcXVlc3RFeGNlcHRpb25cbiAgICAgIH0pLm5vdC50b1Rocm93KCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdJbnRlZ3JhdGlvbiBUZXN0cycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBjb21wbGV0ZSB0aGVyYXBpc3QgcmVnaXN0cmF0aW9uIHdvcmtmbG93JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgcmVnaXN0cmF0aW9uRHRvID0ge1xuICAgICAgICBlbWFpbDogJ2ludGVncmF0aW9uQGV4YW1wbGUuY29tJyxcbiAgICAgICAgcGFzc3dvcmQ6ICdTZWN1cmVQYXNzMTIzIScsXG4gICAgICAgIGZpcnN0TmFtZTogJ0RyLiBJbnRlZ3JhdGlvbicsXG4gICAgICAgIGxhc3ROYW1lOiAnVGVzdCcsXG4gICAgICB9O1xuXG4gICAgICBqZXN0LnNweU9uKHRoZXJhcGlzdEF1dGhTZXJ2aWNlLCAncmVnaXN0ZXJUaGVyYXBpc3QnKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUmVnaXN0cmF0aW9uUmVzdWx0KTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLnJlZ2lzdGVyKHJlZ2lzdHJhdGlvbkR0byk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQudXNlci5lbWFpbCkudG9CZShtb2NrVGhlcmFwaXN0VXNlci5lbWFpbCk7XG4gICAgICBleHBlY3QocmVzdWx0LmFjY2Vzc1Rva2VuKS50b0JlKG1vY2tUb2tlbnMuYWNjZXNzVG9rZW4pO1xuICAgICAgZXhwZWN0KHJlc3VsdC5yZWZyZXNoVG9rZW4pLnRvQmUobW9ja1Rva2Vucy5yZWZyZXNoVG9rZW4pO1xuICAgICAgZXhwZWN0KHJlc3VsdC5leHBpcmVzSW4pLnRvQmUobW9ja1Rva2Vucy5leHBpcmVzSW4pO1xuICAgICAgZXhwZWN0KHJlc3VsdC5tZXNzYWdlKS50b0JlKG1vY2tSZWdpc3RyYXRpb25SZXN1bHQubWVzc2FnZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBjb21wbGV0ZSB0aGVyYXBpc3QgbG9naW4gd29ya2Zsb3cnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBsb2dpbkR0byA9IHtcbiAgICAgICAgZW1haWw6IFRFU1RfRU1BSUxTLlRIRVJBUElTVCxcbiAgICAgICAgcGFzc3dvcmQ6ICdTZWN1cmVQYXNzMTIzIScsXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBtb2NrUmVxdWVzdCA9IHtcbiAgICAgICAgaXA6ICcxOTIuMTY4LjEuMScsXG4gICAgICAgIGdldDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnVGVzdCBVc2VyIEFnZW50JyksXG4gICAgICB9IGFzIGFueTtcblxuICAgICAgamVzdC5zcHlPbih0aGVyYXBpc3RBdXRoU2VydmljZSwgJ2xvZ2luVGhlcmFwaXN0JykubW9ja1Jlc29sdmVkVmFsdWUobW9ja0xvZ2luUmVzdWx0KTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmxvZ2luKGxvZ2luRHRvLCBtb2NrUmVxdWVzdCk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQudXNlci5lbWFpbCkudG9CZShtb2NrVGhlcmFwaXN0VXNlci5lbWFpbCk7XG4gICAgICBleHBlY3QocmVzdWx0LmFjY2Vzc1Rva2VuKS50b0JlKG1vY2tUb2tlbnMuYWNjZXNzVG9rZW4pO1xuICAgICAgZXhwZWN0KHJlc3VsdC5yZWZyZXNoVG9rZW4pLnRvQmUobW9ja1Rva2Vucy5yZWZyZXNoVG9rZW4pO1xuICAgICAgZXhwZWN0KHJlc3VsdC5leHBpcmVzSW4pLnRvQmUobW9ja1Rva2Vucy5leHBpcmVzSW4pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgY29tcGxldGUgYXBwbGljYXRpb24gc3VibWlzc2lvbiB3b3JrZmxvdycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IG1vY2tBcHBsaWNhdGlvblJlc3VsdCA9IHtcbiAgICAgICAgYXBwbGljYXRpb246IHsgdXNlcklkOiAndGVtcF8xMjM0NV90aGVyYXBpc3RfYXRfZXhhbXBsZS5jb20nIH0sXG4gICAgICAgIHVwbG9hZGVkRmlsZXM6IG1vY2tBcHBsaWNhdGlvbkZpbGVzLFxuICAgICAgfTtcblxuICAgICAgamVzdC5zcHlPbih0aGVyYXBpc3RBdXRoU2VydmljZSwgJ2NyZWF0ZUFwcGxpY2F0aW9uV2l0aERvY3VtZW50cycpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tBcHBsaWNhdGlvblJlc3VsdCk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5hcHBseVdpdGhEb2N1bWVudHMoXG4gICAgICAgIEpTT04uc3RyaW5naWZ5KG1vY2tBcHBsaWNhdGlvbkRhdGEpLFxuICAgICAgICBKU09OLnN0cmluZ2lmeSh7ICcwJzogJ2xpY2Vuc2UnLCAnMSc6ICdkaXBsb21hJyB9KSxcbiAgICAgICAgbW9ja0ZpbGVzLFxuICAgICAgKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5hcHBsaWNhdGlvbklkKS50b0JlKG1vY2tBcHBsaWNhdGlvblJlc3VsdC5hcHBsaWNhdGlvbi51c2VySWQpO1xuICAgICAgZXhwZWN0KHJlc3VsdC51cGxvYWRlZEZpbGVzKS50b0VxdWFsKG1vY2tBcHBsaWNhdGlvbkZpbGVzKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbXBsZXRlIGFkbWluIGFwcGxpY2F0aW9uIG1hbmFnZW1lbnQgd29ya2Zsb3cnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBtb2NrQXBwbGljYXRpb25zUmVzdWx0ID0ge1xuICAgICAgICBhcHBsaWNhdGlvbnM6IFttb2NrVGhlcmFwaXN0QXBwbGljYXRpb25dLFxuICAgICAgICB0b3RhbENvdW50OiAxLFxuICAgICAgICBwYWdlOiAxLFxuICAgICAgICB0b3RhbFBhZ2VzOiAxLFxuICAgICAgfTtcblxuICAgICAgamVzdC5zcHlPbih0aGVyYXBpc3RBdXRoU2VydmljZSwgJ2dldEFsbEFwcGxpY2F0aW9ucycpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tBcHBsaWNhdGlvbnNSZXN1bHQpO1xuICAgICAgamVzdC5zcHlPbih0aGVyYXBpc3RBdXRoU2VydmljZSwgJ2dldEFwcGxpY2F0aW9uQnlJZCcpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tUaGVyYXBpc3RBcHBsaWNhdGlvbik7XG5cbiAgICAgIC8vIEFjdCAtIEdldCBhbGwgYXBwbGljYXRpb25zXG4gICAgICBjb25zdCBhbGxBcHBsaWNhdGlvbnMgPSBhd2FpdCBjb250cm9sbGVyLmdldEFsbEFwcGxpY2F0aW9ucygnYWRtaW4nKTtcbiAgICAgIFxuICAgICAgLy8gQWN0IC0gR2V0IHNwZWNpZmljIGFwcGxpY2F0aW9uXG4gICAgICBjb25zdCBzcGVjaWZpY0FwcGxpY2F0aW9uID0gYXdhaXQgY29udHJvbGxlci5nZXRBcHBsaWNhdGlvbkJ5SWQoJ2FkbWluJywgJ2FwcC0xMjMnKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QoYWxsQXBwbGljYXRpb25zKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGFsbEFwcGxpY2F0aW9ucy5hcHBsaWNhdGlvbnMubGVuZ3RoKS50b0JlKDEpO1xuICAgICAgZXhwZWN0KGFsbEFwcGxpY2F0aW9ucy50b3RhbENvdW50KS50b0JlKDEpO1xuICAgICAgXG4gICAgICBleHBlY3Qoc3BlY2lmaWNBcHBsaWNhdGlvbikudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChzcGVjaWZpY0FwcGxpY2F0aW9uLmlkKS50b0JlKCdhcHAtMTIzJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdEYXRhIFZhbGlkYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSByZWdpc3RyYXRpb24gZGF0YSBzdHJ1Y3R1cmUnLCAoKSA9PiB7XG4gICAgICAvLyBUZXN0IHRoYXQgd2UncmUgdXNpbmcgdGhlIGNvcnJlY3QgRFRPIHN0cnVjdHVyZVxuICAgICAgY29uc3QgdmFsaWRSZWdpc3RyYXRpb25EYXRhID0ge1xuICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgICBwYXNzd29yZDogJ1NlY3VyZVBhc3MxMjMhJyxcbiAgICAgICAgZmlyc3ROYW1lOiAnRHIuIFRlc3QnLFxuICAgICAgICBsYXN0TmFtZTogJ1VzZXInLFxuICAgICAgfTtcblxuICAgICAgLy8gVmVyaWZ5IGFsbCByZXF1aXJlZCBmaWVsZHMgYXJlIHByZXNlbnRcbiAgICAgIGV4cGVjdCh2YWxpZFJlZ2lzdHJhdGlvbkRhdGEuZW1haWwpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QodmFsaWRSZWdpc3RyYXRpb25EYXRhLnBhc3N3b3JkKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHZhbGlkUmVnaXN0cmF0aW9uRGF0YS5maXJzdE5hbWUpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QodmFsaWRSZWdpc3RyYXRpb25EYXRhLmxhc3ROYW1lKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBsb2dpbiBkYXRhIHN0cnVjdHVyZScsICgpID0+IHtcbiAgICAgIC8vIFRlc3QgdGhhdCB3ZSdyZSB1c2luZyB0aGUgY29ycmVjdCBEVE8gc3RydWN0dXJlXG4gICAgICBjb25zdCB2YWxpZExvZ2luRGF0YSA9IHtcbiAgICAgICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcbiAgICAgICAgcGFzc3dvcmQ6ICdTZWN1cmVQYXNzMTIzIScsXG4gICAgICB9O1xuXG4gICAgICAvLyBWZXJpZnkgYWxsIHJlcXVpcmVkIGZpZWxkcyBhcmUgcHJlc2VudFxuICAgICAgZXhwZWN0KHZhbGlkTG9naW5EYXRhLmVtYWlsKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHZhbGlkTG9naW5EYXRhLnBhc3N3b3JkKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBhcHBsaWNhdGlvbiBkYXRhIHN0cnVjdHVyZScsICgpID0+IHtcbiAgICAgIC8vIFRlc3QgdGhhdCB3ZSdyZSB1c2luZyB0aGUgY29ycmVjdCBEVE8gc3RydWN0dXJlXG4gICAgICBjb25zdCB2YWxpZEFwcGxpY2F0aW9uRGF0YSA9IHtcbiAgICAgICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcbiAgICAgICAgZmlyc3ROYW1lOiAnRHIuIFRlc3QnLFxuICAgICAgICBsYXN0TmFtZTogJ1VzZXInLFxuICAgICAgICBsaWNlbnNlTnVtYmVyOiAnTElDMTIzNDU2JyxcbiAgICAgICAgc3BlY2lhbGl6YXRpb25zOiBbJ2FueGlldHknLCAnZGVwcmVzc2lvbiddLFxuICAgICAgICBlZHVjYXRpb246ICdQaEQgaW4gUHN5Y2hvbG9neScsXG4gICAgICAgIGV4cGVyaWVuY2U6ICc1IHllYXJzJyxcbiAgICAgIH07XG5cbiAgICAgIC8vIFZlcmlmeSBhbGwgcmVxdWlyZWQgZmllbGRzIGFyZSBwcmVzZW50XG4gICAgICBleHBlY3QodmFsaWRBcHBsaWNhdGlvbkRhdGEuZW1haWwpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QodmFsaWRBcHBsaWNhdGlvbkRhdGEuZmlyc3ROYW1lKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHZhbGlkQXBwbGljYXRpb25EYXRhLmxhc3ROYW1lKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHZhbGlkQXBwbGljYXRpb25EYXRhLmxpY2Vuc2VOdW1iZXIpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QodmFsaWRBcHBsaWNhdGlvbkRhdGEuc3BlY2lhbGl6YXRpb25zKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHZhbGlkQXBwbGljYXRpb25EYXRhLmVkdWNhdGlvbikudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdCh2YWxpZEFwcGxpY2F0aW9uRGF0YS5leHBlcmllbmNlKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUmVzcG9uc2UgRm9ybWF0IFZhbGlkYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gY29ycmVjdGx5IGZvcm1hdHRlZCByZWdpc3RyYXRpb24gcmVzcG9uc2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCByZWdpc3RlckR0byA9IHtcbiAgICAgICAgZW1haWw6ICdmb3JtYXRAZXhhbXBsZS5jb20nLFxuICAgICAgICBwYXNzd29yZDogJ1NlY3VyZVBhc3MxMjMhJyxcbiAgICAgICAgZmlyc3ROYW1lOiAnRHIuIEZvcm1hdCcsXG4gICAgICAgIGxhc3ROYW1lOiAnVGVzdCcsXG4gICAgICB9O1xuXG4gICAgICBqZXN0LnNweU9uKHRoZXJhcGlzdEF1dGhTZXJ2aWNlLCAncmVnaXN0ZXJUaGVyYXBpc3QnKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUmVnaXN0cmF0aW9uUmVzdWx0KTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLnJlZ2lzdGVyKHJlZ2lzdGVyRHRvKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgndXNlcicpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ2FjY2Vzc1Rva2VuJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgncmVmcmVzaFRva2VuJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgnZXhwaXJlc0luJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgnbWVzc2FnZScpO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0LnVzZXIpLnRvSGF2ZVByb3BlcnR5KCdpZCcpO1xuICAgICAgZXhwZWN0KHJlc3VsdC51c2VyKS50b0hhdmVQcm9wZXJ0eSgnZW1haWwnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQudXNlcikudG9IYXZlUHJvcGVydHkoJ2ZpcnN0TmFtZScpO1xuICAgICAgZXhwZWN0KHJlc3VsdC51c2VyKS50b0hhdmVQcm9wZXJ0eSgnbGFzdE5hbWUnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQudXNlcikudG9IYXZlUHJvcGVydHkoJ3JvbGUnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQudXNlcikudG9IYXZlUHJvcGVydHkoJ2VtYWlsVmVyaWZpZWQnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvcnJlY3RseSBmb3JtYXR0ZWQgbG9naW4gcmVzcG9uc2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBsb2dpbkR0byA9IHtcbiAgICAgICAgZW1haWw6IFRFU1RfRU1BSUxTLlRIRVJBUElTVCxcbiAgICAgICAgcGFzc3dvcmQ6ICdTZWN1cmVQYXNzMTIzIScsXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBtb2NrUmVxdWVzdCA9IHtcbiAgICAgICAgaXA6ICcxOTIuMTY4LjEuMScsXG4gICAgICAgIGdldDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnVGVzdCBVc2VyIEFnZW50JyksXG4gICAgICB9IGFzIGFueTtcblxuICAgICAgamVzdC5zcHlPbih0aGVyYXBpc3RBdXRoU2VydmljZSwgJ2xvZ2luVGhlcmFwaXN0JykubW9ja1Jlc29sdmVkVmFsdWUobW9ja0xvZ2luUmVzdWx0KTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmxvZ2luKGxvZ2luRHRvLCBtb2NrUmVxdWVzdCk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ3VzZXInKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdhY2Nlc3NUb2tlbicpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ3JlZnJlc2hUb2tlbicpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ2V4cGlyZXNJbicpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkubm90LnRvSGF2ZVByb3BlcnR5KCdtZXNzYWdlJyk7IC8vIExvZ2luIGRvZXNuJ3QgaW5jbHVkZSBtZXNzYWdlXG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBjb3JyZWN0bHkgZm9ybWF0dGVkIGFwcGxpY2F0aW9uIHJlc3BvbnNlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgbW9ja0FwcGxpY2F0aW9uUmVzdWx0ID0ge1xuICAgICAgICBhcHBsaWNhdGlvbjogeyB1c2VySWQ6ICd0ZW1wXzEyMzQ1X3RoZXJhcGlzdF9hdF9leGFtcGxlLmNvbScgfSxcbiAgICAgICAgdXBsb2FkZWRGaWxlczogbW9ja0FwcGxpY2F0aW9uRmlsZXMsXG4gICAgICB9O1xuXG4gICAgICBqZXN0LnNweU9uKHRoZXJhcGlzdEF1dGhTZXJ2aWNlLCAnY3JlYXRlQXBwbGljYXRpb25XaXRoRG9jdW1lbnRzJykubW9ja1Jlc29sdmVkVmFsdWUobW9ja0FwcGxpY2F0aW9uUmVzdWx0KTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmFwcGx5V2l0aERvY3VtZW50cyhcbiAgICAgICAgSlNPTi5zdHJpbmdpZnkobW9ja0FwcGxpY2F0aW9uRGF0YSksXG4gICAgICAgIEpTT04uc3RyaW5naWZ5KHsgJzAnOiAnbGljZW5zZScsICcxJzogJ2RpcGxvbWEnIH0pLFxuICAgICAgICBtb2NrRmlsZXMsXG4gICAgICApO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdzdWNjZXNzJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgnbWVzc2FnZScpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ2FwcGxpY2F0aW9uSWQnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCd1cGxvYWRlZEZpbGVzJyk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQudXBsb2FkZWRGaWxlcykudG9CZUluc3RhbmNlT2YoQXJyYXkpO1xuICAgIH0pO1xuICB9KTtcbn0pOyJdLCJ2ZXJzaW9uIjozfQ==