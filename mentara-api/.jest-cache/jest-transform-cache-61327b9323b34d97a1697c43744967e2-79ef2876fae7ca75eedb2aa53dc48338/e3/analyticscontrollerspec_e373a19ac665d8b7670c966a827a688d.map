{"file":"/home/wetooa/Documents/code/projects/mentara/mentara-api/src/analytics/analytics.controller.spec.ts","mappings":"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","names":[],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/analytics/analytics.controller.spec.ts"],"sourcesContent":["/**\n * Comprehensive Test Suite for AnalyticsController\n * Tests analytics reporting functionality with role-based access control\n */\n\nimport { Test, TestingModule } from '@nestjs/testing';\nimport { BadRequestException, NotFoundException, ForbiddenException, HttpException, HttpStatus } from '@nestjs/common';\nimport { AnalyticsController } from './analytics.controller';\nimport { AnalyticsService } from './analytics.service';\nimport { JwtAuthGuard } from '../auth/guards/jwt-auth.guard';\nimport { ZodValidationPipe } from '../common/pipes/zod-validation.pipe';\nimport { SecurityGuardTestUtils, RoleBasedTestUtils } from '../test-utils/auth-testing-helpers';\nimport { MockBuilder, TestDataGenerator, TestAssertions } from '../test-utils/enhanced-test-helpers';\nimport { TEST_USER_IDS, TEST_EMAILS } from '../test-utils/index';\n\ndescribe('AnalyticsController', () => {\n  let controller: AnalyticsController;\n  let analyticsService: AnalyticsService;\n  let module: TestingModule;\n\n  // Mock AnalyticsService\n  const mockAnalyticsService = {\n    getPlatformAnalytics: jest.fn(),\n    getTherapistAnalytics: jest.fn(),\n    getClientAnalytics: jest.fn(),\n  };\n\n  // Mock JwtAuthGuard\n  const mockJwtAuthGuard = {\n    canActivate: jest.fn().mockReturnValue(true),\n  };\n\n  // Test data\n  const mockPlatformAnalytics = {\n    userStats: {\n      totalUsers: 15420,\n      newUsers: 234,\n      activeUsers: 8760,\n      userGrowthRate: 12.5,\n      userRetentionRate: 87.3,\n      averageSessionsPerUser: 4.7,\n    },\n    sessionStats: {\n      totalSessions: 72840,\n      averageSessionDuration: 52.3, // minutes\n      sessionCompletionRate: 91.7,\n      missedSessionRate: 8.3,\n      rescheduledSessionRate: 15.2,\n    },\n    therapistStats: {\n      totalTherapists: 890,\n      activeTherapists: 756,\n      averageRating: 4.7,\n      therapistUtilization: 78.4,\n      averageResponseTime: 18.5, // minutes\n    },\n    revenue: {\n      totalRevenue: 2847360.50,\n      monthlyRevenue: 186420.75,\n      revenueGrowth: 15.8,\n      averageRevenuePerUser: 184.65,\n      revenueByService: {\n        individual_therapy: 2103845.20,\n        group_therapy: 485726.30,\n        workshops: 257789.00,\n      },\n    },\n    communityStats: {\n      totalPosts: 12450,\n      totalComments: 48720,\n      activeMembers: 5680,\n      engagementRate: 73.2,\n    },\n    timeRangeMetrics: {\n      period: 'last_30_days',\n      startDate: new Date('2024-01-15T00:00:00Z'),\n      endDate: new Date('2024-02-14T23:59:59Z'),\n    },\n  };\n\n  const mockTherapistAnalytics = {\n    therapistInfo: {\n      id: TEST_USER_IDS.THERAPIST,\n      name: 'Dr. Sarah Smith',\n      specializations: ['anxiety', 'depression', 'trauma'],\n      yearsOfExperience: 8,\n      licenseNumber: 'PSY123456',\n    },\n    clientStats: {\n      totalClients: 47,\n      activeClients: 34,\n      newClients: 8,\n      clientRetentionRate: 89.4,\n      averageClientsPerWeek: 25,\n    },\n    sessionMetrics: {\n      totalSessions: 468,\n      averageSessionDuration: 55.7,\n      sessionRating: 4.8,\n      completionRate: 94.2,\n      noShowRate: 5.8,\n      cancellationRate: 12.1,\n    },\n    performanceMetrics: {\n      responseTime: 12.3, // minutes\n      clientSatisfaction: 4.7,\n      treatmentEffectiveness: 86.5,\n      goalAchievementRate: 78.9,\n      clientProgress: {\n        improved: 73.4,\n        stable: 21.3,\n        declined: 5.3,\n      },\n    },\n    revenueMetrics: {\n      totalEarnings: 70200.00,\n      monthlyEarnings: 5850.00,\n      hourlyRate: 150.00,\n      utilizationRate: 82.5,\n    },\n    timeRangeMetrics: {\n      period: 'last_30_days',\n      startDate: new Date('2024-01-15T00:00:00Z'),\n      endDate: new Date('2024-02-14T23:59:59Z'),\n    },\n  };\n\n  const mockClientAnalytics = {\n    clientInfo: {\n      id: TEST_USER_IDS.CLIENT,\n      name: 'John Doe',\n      joinDate: new Date('2023-10-15T00:00:00Z'),\n      currentTherapist: 'Dr. Sarah Smith',\n      primaryConcerns: ['anxiety', 'stress'],\n    },\n    sessionHistory: {\n      totalSessions: 24,\n      completedSessions: 22,\n      cancelledSessions: 2,\n      averageSessionRating: 4.6,\n      sessionFrequency: 'weekly',\n      lastSessionDate: new Date('2024-02-12T14:00:00Z'),\n    },\n    progressMetrics: {\n      moodTrend: [3.2, 3.8, 4.1, 4.3, 4.6, 4.5, 4.7, 4.8], // last 8 weeks\n      goalAchievements: 7,\n      totalGoals: 10,\n      improvementScore: 78.5,\n      worksheetsCompleted: 15,\n      assignedWorksheets: 18,\n    },\n    engagementStats: {\n      loginFrequency: 4.2, // times per week\n      messagesSent: 167,\n      messagesReceived: 203,\n      averageResponseTime: 45.2, // minutes\n      communityParticipation: {\n        postsCreated: 8,\n        commentsLeft: 23,\n        likesGiven: 156,\n      },\n    },\n    assessmentScores: {\n      initial: {\n        anxiety: 7.2,\n        depression: 6.8,\n        stress: 8.1,\n      },\n      current: {\n        anxiety: 4.3,\n        depression: 3.9,\n        stress: 4.8,\n      },\n      improvement: {\n        anxiety: -2.9,\n        depression: -2.9,\n        stress: -3.3,\n      },\n    },\n    timeRangeMetrics: {\n      period: 'last_30_days',\n      startDate: new Date('2024-01-15T00:00:00Z'),\n      endDate: new Date('2024-02-14T23:59:59Z'),\n    },\n  };\n\n  beforeEach(async () => {\n    module = await Test.createTestingModule({\n      controllers: [AnalyticsController],\n      providers: [\n        {\n          provide: AnalyticsService,\n          useValue: mockAnalyticsService,\n        },\n      ],\n    })\n      .overrideGuard(JwtAuthGuard)\n      .useValue(mockJwtAuthGuard)\n      .compile();\n\n    controller = module.get<AnalyticsController>(AnalyticsController);\n    analyticsService = module.get<AnalyticsService>(AnalyticsService);\n  });\n\n  afterEach(() => {\n    jest.clearAllMocks();\n  });\n\n  describe('Controller Initialization', () => {\n    it('should be defined', () => {\n      expect(controller).toBeDefined();\n    });\n\n    it('should have analyticsService injected', () => {\n      expect(analyticsService).toBeDefined();\n    });\n  });\n\n  describe('Security Guards', () => {\n    it('should be protected by JwtAuthGuard', () => {\n      const guards = Reflect.getMetadata('__guards__', AnalyticsController);\n      expect(guards).toContain(JwtAuthGuard);\n    });\n\n    it('should have proper route decorators', () => {\n      const controllerMetadata = Reflect.getMetadata('path', AnalyticsController);\n      expect(controllerMetadata).toBe('analytics');\n    });\n  });\n\n  describe('GET /analytics/platform', () => {\n    const mockQuery = {\n      dateFrom: '2024-01-15T00:00:00Z',\n      dateTo: '2024-02-14T23:59:59Z',\n    };\n\n    it('should get platform analytics for admin successfully', async () => {\n      mockAnalyticsService.getPlatformAnalytics.mockResolvedValue(mockPlatformAnalytics);\n\n      const result = await controller.getPlatformAnalytics('admin', mockQuery);\n\n      expect(result).toEqual(mockPlatformAnalytics);\n      expect(analyticsService.getPlatformAnalytics).toHaveBeenCalledWith(\n        new Date(mockQuery.dateFrom),\n        new Date(mockQuery.dateTo),\n      );\n    });\n\n    it('should get platform analytics without date filters', async () => {\n      mockAnalyticsService.getPlatformAnalytics.mockResolvedValue(mockPlatformAnalytics);\n\n      const result = await controller.getPlatformAnalytics('admin', {});\n\n      expect(result).toEqual(mockPlatformAnalytics);\n      expect(analyticsService.getPlatformAnalytics).toHaveBeenCalledWith(undefined, undefined);\n    });\n\n    it('should deny access to non-admin users', async () => {\n      const nonAdminRoles = ['client', 'therapist', 'moderator'];\n\n      for (const role of nonAdminRoles) {\n        await expect(controller.getPlatformAnalytics(role, mockQuery)).rejects.toThrow(ForbiddenException);\n        await expect(controller.getPlatformAnalytics(role, mockQuery)).rejects.toThrow('Access denied: Admin role required');\n      }\n    });\n\n    it('should handle different date range formats', async () => {\n      const dateRanges = [\n        { dateFrom: '2024-01-01', dateTo: '2024-01-31' },\n        { dateFrom: '2024-02-01T00:00:00.000Z', dateTo: '2024-02-29T23:59:59.999Z' },\n        { dateFrom: '2024-01-15T10:30:00Z' }, // only start date\n        { dateTo: '2024-02-14T18:45:00Z' }, // only end date\n      ];\n\n      for (const range of dateRanges) {\n        mockAnalyticsService.getPlatformAnalytics.mockResolvedValue(mockPlatformAnalytics);\n\n        const result = await controller.getPlatformAnalytics('admin', range);\n\n        expect(result).toEqual(mockPlatformAnalytics);\n        expect(analyticsService.getPlatformAnalytics).toHaveBeenCalledWith(\n          range.dateFrom ? new Date(range.dateFrom) : undefined,\n          range.dateTo ? new Date(range.dateTo) : undefined,\n        );\n      }\n    });\n\n    it('should validate platform analytics response structure', async () => {\n      mockAnalyticsService.getPlatformAnalytics.mockResolvedValue(mockPlatformAnalytics);\n\n      const result = await controller.getPlatformAnalytics('admin', {});\n\n      expect(result).toHaveProperty('userStats');\n      expect(result).toHaveProperty('sessionStats');\n      expect(result).toHaveProperty('therapistStats');\n      expect(result).toHaveProperty('revenue');\n      expect(result.userStats).toHaveProperty('totalUsers');\n      expect(result.userStats).toHaveProperty('newUsers');\n      expect(result.sessionStats).toHaveProperty('totalSessions');\n      expect(result.revenue).toHaveProperty('totalRevenue');\n      expect(typeof result.userStats.totalUsers).toBe('number');\n      expect(typeof result.revenue.totalRevenue).toBe('number');\n    });\n\n    it('should handle service errors', async () => {\n      const serviceError = new Error('Analytics service unavailable');\n      mockAnalyticsService.getPlatformAnalytics.mockRejectedValue(serviceError);\n\n      await expect(controller.getPlatformAnalytics('admin', {})).rejects.toThrow(serviceError);\n    });\n  });\n\n  describe('GET /analytics/therapist', () => {\n    const mockQuery = {\n      therapistId: TEST_USER_IDS.THERAPIST,\n      dateFrom: '2024-01-15T00:00:00Z',\n      dateTo: '2024-02-14T23:59:59Z',\n    };\n\n    it('should get therapist analytics for therapist (own data)', async () => {\n      mockAnalyticsService.getTherapistAnalytics.mockResolvedValue(mockTherapistAnalytics);\n\n      const result = await controller.getTherapistAnalytics(\n        TEST_USER_IDS.THERAPIST,\n        'therapist',\n        { dateFrom: mockQuery.dateFrom, dateTo: mockQuery.dateTo },\n      );\n\n      expect(result).toEqual(mockTherapistAnalytics);\n      expect(analyticsService.getTherapistAnalytics).toHaveBeenCalledWith(\n        TEST_USER_IDS.THERAPIST,\n        new Date(mockQuery.dateFrom),\n        new Date(mockQuery.dateTo),\n      );\n    });\n\n    it('should get therapist analytics for admin (any therapist)', async () => {\n      mockAnalyticsService.getTherapistAnalytics.mockResolvedValue(mockTherapistAnalytics);\n\n      const result = await controller.getTherapistAnalytics(\n        TEST_USER_IDS.ADMIN,\n        'admin',\n        mockQuery,\n      );\n\n      expect(result).toEqual(mockTherapistAnalytics);\n      expect(analyticsService.getTherapistAnalytics).toHaveBeenCalledWith(\n        mockQuery.therapistId,\n        new Date(mockQuery.dateFrom),\n        new Date(mockQuery.dateTo),\n      );\n    });\n\n    it('should deny therapist access to other therapist data', async () => {\n      await expect(\n        controller.getTherapistAnalytics(\n          TEST_USER_IDS.THERAPIST,\n          'therapist',\n          { therapistId: 'other_therapist_id' },\n        )\n      ).rejects.toThrow(ForbiddenException);\n      await expect(\n        controller.getTherapistAnalytics(\n          TEST_USER_IDS.THERAPIST,\n          'therapist',\n          { therapistId: 'other_therapist_id' },\n        )\n      ).rejects.toThrow('Access denied: Can only view your own analytics');\n    });\n\n    it('should deny access to non-therapist/non-admin users', async () => {\n      const unauthorizedRoles = ['client', 'moderator'];\n\n      for (const role of unauthorizedRoles) {\n        await expect(\n          controller.getTherapistAnalytics(TEST_USER_IDS.CLIENT, role, {})\n        ).rejects.toThrow(ForbiddenException);\n        await expect(\n          controller.getTherapistAnalytics(TEST_USER_IDS.CLIENT, role, {})\n        ).rejects.toThrow('Access denied: Therapist or Admin role required');\n      }\n    });\n\n    it('should default to current user ID when therapistId not provided', async () => {\n      mockAnalyticsService.getTherapistAnalytics.mockResolvedValue(mockTherapistAnalytics);\n\n      const result = await controller.getTherapistAnalytics(\n        TEST_USER_IDS.THERAPIST,\n        'therapist',\n        {},\n      );\n\n      expect(analyticsService.getTherapistAnalytics).toHaveBeenCalledWith(\n        TEST_USER_IDS.THERAPIST,\n        undefined,\n        undefined,\n      );\n    });\n\n    it('should validate therapist analytics response structure', async () => {\n      mockAnalyticsService.getTherapistAnalytics.mockResolvedValue(mockTherapistAnalytics);\n\n      const result = await controller.getTherapistAnalytics(\n        TEST_USER_IDS.THERAPIST,\n        'therapist',\n        {},\n      );\n\n      expect(result).toHaveProperty('therapistInfo');\n      expect(result).toHaveProperty('clientStats');\n      expect(result).toHaveProperty('sessionMetrics');\n      expect(result).toHaveProperty('performanceMetrics');\n      expect(result.therapistInfo).toHaveProperty('id');\n      expect(result.therapistInfo).toHaveProperty('name');\n      expect(result.clientStats).toHaveProperty('totalClients');\n      expect(result.sessionMetrics).toHaveProperty('totalSessions');\n      expect(typeof result.clientStats.totalClients).toBe('number');\n      expect(typeof result.performanceMetrics.clientSatisfaction).toBe('number');\n    });\n\n    it('should handle service errors', async () => {\n      const serviceError = new Error('Therapist analytics service failed');\n      mockAnalyticsService.getTherapistAnalytics.mockRejectedValue(serviceError);\n\n      await expect(\n        controller.getTherapistAnalytics(TEST_USER_IDS.THERAPIST, 'therapist', {})\n      ).rejects.toThrow(serviceError);\n    });\n  });\n\n  describe('GET /analytics/client', () => {\n    const mockQuery = {\n      clientId: TEST_USER_IDS.CLIENT,\n      dateFrom: '2024-01-15T00:00:00Z',\n      dateTo: '2024-02-14T23:59:59Z',\n    };\n\n    it('should get client analytics for client (own data)', async () => {\n      mockAnalyticsService.getClientAnalytics.mockResolvedValue(mockClientAnalytics);\n\n      const result = await controller.getClientAnalytics(\n        TEST_USER_IDS.CLIENT,\n        'user',\n        { dateFrom: mockQuery.dateFrom, dateTo: mockQuery.dateTo },\n      );\n\n      expect(result).toEqual(mockClientAnalytics);\n      expect(analyticsService.getClientAnalytics).toHaveBeenCalledWith(\n        TEST_USER_IDS.CLIENT,\n        new Date(mockQuery.dateFrom),\n        new Date(mockQuery.dateTo),\n      );\n    });\n\n    it('should get client analytics for therapist (assigned client)', async () => {\n      mockAnalyticsService.getClientAnalytics.mockResolvedValue(mockClientAnalytics);\n\n      const result = await controller.getClientAnalytics(\n        TEST_USER_IDS.THERAPIST,\n        'therapist',\n        mockQuery,\n      );\n\n      expect(result).toEqual(mockClientAnalytics);\n      expect(analyticsService.getClientAnalytics).toHaveBeenCalledWith(\n        mockQuery.clientId,\n        new Date(mockQuery.dateFrom),\n        new Date(mockQuery.dateTo),\n      );\n    });\n\n    it('should get client analytics for admin (any client)', async () => {\n      mockAnalyticsService.getClientAnalytics.mockResolvedValue(mockClientAnalytics);\n\n      const result = await controller.getClientAnalytics(\n        TEST_USER_IDS.ADMIN,\n        'admin',\n        mockQuery,\n      );\n\n      expect(result).toEqual(mockClientAnalytics);\n      expect(analyticsService.getClientAnalytics).toHaveBeenCalledWith(\n        mockQuery.clientId,\n        new Date(mockQuery.dateFrom),\n        new Date(mockQuery.dateTo),\n      );\n    });\n\n    it('should deny client access to other client data', async () => {\n      await expect(\n        controller.getClientAnalytics(\n          TEST_USER_IDS.CLIENT,\n          'user',\n          { clientId: 'other_client_id' },\n        )\n      ).rejects.toThrow(ForbiddenException);\n      await expect(\n        controller.getClientAnalytics(\n          TEST_USER_IDS.CLIENT,\n          'user',\n          { clientId: 'other_client_id' },\n        )\n      ).rejects.toThrow('Access denied: Can only view your own analytics');\n    });\n\n    it('should deny access to unauthorized roles', async () => {\n      const unauthorizedRoles = ['moderator'];\n\n      for (const role of unauthorizedRoles) {\n        await expect(\n          controller.getClientAnalytics(TEST_USER_IDS.MODERATOR, role, {})\n        ).rejects.toThrow(ForbiddenException);\n        await expect(\n          controller.getClientAnalytics(TEST_USER_IDS.MODERATOR, role, {})\n        ).rejects.toThrow('Access denied: Invalid role');\n      }\n    });\n\n    it('should default to current user ID when clientId not provided', async () => {\n      mockAnalyticsService.getClientAnalytics.mockResolvedValue(mockClientAnalytics);\n\n      const result = await controller.getClientAnalytics(\n        TEST_USER_IDS.CLIENT,\n        'user',\n        {},\n      );\n\n      expect(analyticsService.getClientAnalytics).toHaveBeenCalledWith(\n        TEST_USER_IDS.CLIENT,\n        undefined,\n        undefined,\n      );\n    });\n\n    it('should validate client analytics response structure', async () => {\n      mockAnalyticsService.getClientAnalytics.mockResolvedValue(mockClientAnalytics);\n\n      const result = await controller.getClientAnalytics(\n        TEST_USER_IDS.CLIENT,\n        'user',\n        {},\n      );\n\n      expect(result).toHaveProperty('clientInfo');\n      expect(result).toHaveProperty('sessionHistory');\n      expect(result).toHaveProperty('progressMetrics');\n      expect(result).toHaveProperty('engagementStats');\n      expect(result.clientInfo).toHaveProperty('id');\n      expect(result.clientInfo).toHaveProperty('name');\n      expect(result.sessionHistory).toHaveProperty('totalSessions');\n      expect(result.progressMetrics).toHaveProperty('moodTrend');\n      expect(Array.isArray(result.progressMetrics.moodTrend)).toBe(true);\n      expect(typeof result.sessionHistory.totalSessions).toBe('number');\n      expect(typeof result.engagementStats.loginFrequency).toBe('number');\n    });\n\n    it('should handle service errors', async () => {\n      const serviceError = new Error('Client analytics service failed');\n      mockAnalyticsService.getClientAnalytics.mockRejectedValue(serviceError);\n\n      await expect(\n        controller.getClientAnalytics(TEST_USER_IDS.CLIENT, 'user', {})\n      ).rejects.toThrow(serviceError);\n    });\n  });\n\n  describe('Role-Based Access Control', () => {\n    it('should allow admin access to all analytics endpoints', async () => {\n      mockAnalyticsService.getPlatformAnalytics.mockResolvedValue(mockPlatformAnalytics);\n      mockAnalyticsService.getTherapistAnalytics.mockResolvedValue(mockTherapistAnalytics);\n      mockAnalyticsService.getClientAnalytics.mockResolvedValue(mockClientAnalytics);\n\n      // Platform analytics\n      const platformResult = await controller.getPlatformAnalytics('admin', {});\n      expect(platformResult).toEqual(mockPlatformAnalytics);\n\n      // Therapist analytics\n      const therapistResult = await controller.getTherapistAnalytics(\n        TEST_USER_IDS.ADMIN,\n        'admin',\n        { therapistId: TEST_USER_IDS.THERAPIST },\n      );\n      expect(therapistResult).toEqual(mockTherapistAnalytics);\n\n      // Client analytics\n      const clientResult = await controller.getClientAnalytics(\n        TEST_USER_IDS.ADMIN,\n        'admin',\n        { clientId: TEST_USER_IDS.CLIENT },\n      );\n      expect(clientResult).toEqual(mockClientAnalytics);\n    });\n\n    it('should restrict therapist access appropriately', async () => {\n      mockAnalyticsService.getTherapistAnalytics.mockResolvedValue(mockTherapistAnalytics);\n      mockAnalyticsService.getClientAnalytics.mockResolvedValue(mockClientAnalytics);\n\n      // Can access own therapist analytics\n      const ownResult = await controller.getTherapistAnalytics(\n        TEST_USER_IDS.THERAPIST,\n        'therapist',\n        {},\n      );\n      expect(ownResult).toEqual(mockTherapistAnalytics);\n\n      // Can access client analytics (for assigned clients)\n      const clientResult = await controller.getClientAnalytics(\n        TEST_USER_IDS.THERAPIST,\n        'therapist',\n        { clientId: TEST_USER_IDS.CLIENT },\n      );\n      expect(clientResult).toEqual(mockClientAnalytics);\n\n      // Cannot access platform analytics\n      await expect(\n        controller.getPlatformAnalytics('therapist', {})\n      ).rejects.toThrow(ForbiddenException);\n\n      // Cannot access other therapist analytics\n      await expect(\n        controller.getTherapistAnalytics(\n          TEST_USER_IDS.THERAPIST,\n          'therapist',\n          { therapistId: 'other_therapist' },\n        )\n      ).rejects.toThrow(ForbiddenException);\n    });\n\n    it('should restrict client access appropriately', async () => {\n      mockAnalyticsService.getClientAnalytics.mockResolvedValue(mockClientAnalytics);\n\n      // Can access own client analytics\n      const ownResult = await controller.getClientAnalytics(\n        TEST_USER_IDS.CLIENT,\n        'user',\n        {},\n      );\n      expect(ownResult).toEqual(mockClientAnalytics);\n\n      // Cannot access platform analytics\n      await expect(\n        controller.getPlatformAnalytics('user', {})\n      ).rejects.toThrow(ForbiddenException);\n\n      // Cannot access therapist analytics\n      await expect(\n        controller.getTherapistAnalytics(TEST_USER_IDS.CLIENT, 'user', {})\n      ).rejects.toThrow(ForbiddenException);\n\n      // Cannot access other client analytics\n      await expect(\n        controller.getClientAnalytics(\n          TEST_USER_IDS.CLIENT,\n          'user',\n          { clientId: 'other_client' },\n        )\n      ).rejects.toThrow(ForbiddenException);\n    });\n  });\n\n  describe('Date Range Handling', () => {\n    it('should handle various date formats correctly', async () => {\n      const dateFormats = [\n        '2024-01-15',\n        '2024-01-15T00:00:00Z',\n        '2024-01-15T10:30:45.123Z',\n        '2024-01-15T15:45:30+05:30',\n      ];\n\n      mockAnalyticsService.getPlatformAnalytics.mockResolvedValue(mockPlatformAnalytics);\n\n      for (const dateFrom of dateFormats) {\n        const result = await controller.getPlatformAnalytics('admin', { dateFrom });\n        expect(analyticsService.getPlatformAnalytics).toHaveBeenCalledWith(\n          new Date(dateFrom),\n          undefined,\n        );\n      }\n    });\n\n    it('should handle date range validation', async () => {\n      mockAnalyticsService.getPlatformAnalytics.mockResolvedValue(mockPlatformAnalytics);\n\n      // Valid date range\n      const validRange = {\n        dateFrom: '2024-01-01T00:00:00Z',\n        dateTo: '2024-01-31T23:59:59Z',\n      };\n\n      const result = await controller.getPlatformAnalytics('admin', validRange);\n      expect(analyticsService.getPlatformAnalytics).toHaveBeenCalledWith(\n        new Date(validRange.dateFrom),\n        new Date(validRange.dateTo),\n      );\n    });\n\n    it('should handle missing date parameters gracefully', async () => {\n      mockAnalyticsService.getPlatformAnalytics.mockResolvedValue(mockPlatformAnalytics);\n\n      const queries = [\n        {},\n        { dateFrom: '2024-01-15' },\n        { dateTo: '2024-01-31' },\n      ];\n\n      for (const query of queries) {\n        const result = await controller.getPlatformAnalytics('admin', query);\n        expect(analyticsService.getPlatformAnalytics).toHaveBeenCalledWith(\n          query.dateFrom ? new Date(query.dateFrom) : undefined,\n          query.dateTo ? new Date(query.dateTo) : undefined,\n        );\n      }\n    });\n  });\n\n  describe('Response Format Validation', () => {\n    it('should return properly formatted platform analytics', async () => {\n      mockAnalyticsService.getPlatformAnalytics.mockResolvedValue(mockPlatformAnalytics);\n\n      const result = await controller.getPlatformAnalytics('admin', {});\n\n      TestAssertions.expectValidEntity(result, ['userStats', 'sessionStats', 'therapistStats', 'revenue']);\n      expect(typeof result.userStats.totalUsers).toBe('number');\n      expect(typeof result.sessionStats.averageSessionDuration).toBe('number');\n      expect(typeof result.revenue.totalRevenue).toBe('number');\n      expect(result.userStats.totalUsers).toBeGreaterThanOrEqual(0);\n      expect(result.revenue.totalRevenue).toBeGreaterThanOrEqual(0);\n    });\n\n    it('should return properly formatted therapist analytics', async () => {\n      mockAnalyticsService.getTherapistAnalytics.mockResolvedValue(mockTherapistAnalytics);\n\n      const result = await controller.getTherapistAnalytics(TEST_USER_IDS.THERAPIST, 'therapist', {});\n\n      TestAssertions.expectValidEntity(result, ['therapistInfo', 'clientStats', 'sessionMetrics', 'performanceMetrics']);\n      expect(result.therapistInfo.id).toBe(TEST_USER_IDS.THERAPIST);\n      expect(Array.isArray(result.therapistInfo.specializations)).toBe(true);\n      expect(typeof result.clientStats.totalClients).toBe('number');\n      expect(typeof result.performanceMetrics.clientSatisfaction).toBe('number');\n    });\n\n    it('should return properly formatted client analytics', async () => {\n      mockAnalyticsService.getClientAnalytics.mockResolvedValue(mockClientAnalytics);\n\n      const result = await controller.getClientAnalytics(TEST_USER_IDS.CLIENT, 'user', {});\n\n      TestAssertions.expectValidEntity(result, ['clientInfo', 'sessionHistory', 'progressMetrics', 'engagementStats']);\n      expect(result.clientInfo.id).toBe(TEST_USER_IDS.CLIENT);\n      expect(result.clientInfo.joinDate).toBeInstanceOf(Date);\n      expect(Array.isArray(result.progressMetrics.moodTrend)).toBe(true);\n      expect(typeof result.sessionHistory.totalSessions).toBe('number');\n      expect(typeof result.engagementStats.loginFrequency).toBe('number');\n    });\n  });\n\n  describe('Error Handling', () => {\n    it('should handle service unavailable scenarios', async () => {\n      const serviceError = new Error('Analytics service temporarily unavailable');\n      mockAnalyticsService.getPlatformAnalytics.mockRejectedValue(serviceError);\n\n      await expect(controller.getPlatformAnalytics('admin', {})).rejects.toThrow(serviceError);\n    });\n\n    it('should handle database connection errors', async () => {\n      const dbError = new Error('Database connection failed');\n      mockAnalyticsService.getTherapistAnalytics.mockRejectedValue(dbError);\n\n      await expect(\n        controller.getTherapistAnalytics(TEST_USER_IDS.THERAPIST, 'therapist', {})\n      ).rejects.toThrow(dbError);\n    });\n\n    it('should handle invalid date formats gracefully', async () => {\n      mockAnalyticsService.getPlatformAnalytics.mockResolvedValue(mockPlatformAnalytics);\n\n      const invalidDates = [\n        { dateFrom: 'invalid-date' },\n        { dateTo: 'not-a-date' },\n        { dateFrom: '2024-13-45' }, // invalid month/day\n      ];\n\n      for (const invalidQuery of invalidDates) {\n        // The controller should still call the service with potentially invalid dates\n        // The service layer should handle date validation\n        await controller.getPlatformAnalytics('admin', invalidQuery);\n        expect(analyticsService.getPlatformAnalytics).toHaveBeenCalled();\n      }\n    });\n\n    it('should handle data not found scenarios', async () => {\n      const notFoundError = new Error('Analytics data not found');\n      mockAnalyticsService.getClientAnalytics.mockRejectedValue(notFoundError);\n\n      await expect(\n        controller.getClientAnalytics(TEST_USER_IDS.CLIENT, 'user', {})\n      ).rejects.toThrow(notFoundError);\n    });\n  });\n\n  describe('Integration Tests', () => {\n    it('should handle complete admin analytics workflow', async () => {\n      mockAnalyticsService.getPlatformAnalytics.mockResolvedValue(mockPlatformAnalytics);\n      mockAnalyticsService.getTherapistAnalytics.mockResolvedValue(mockTherapistAnalytics);\n      mockAnalyticsService.getClientAnalytics.mockResolvedValue(mockClientAnalytics);\n\n      // Platform overview\n      const platformResult = await controller.getPlatformAnalytics('admin', {\n        dateFrom: '2024-01-01',\n        dateTo: '2024-01-31',\n      });\n      expect(platformResult.userStats.totalUsers).toBeGreaterThan(0);\n\n      // Specific therapist details\n      const therapistResult = await controller.getTherapistAnalytics(\n        TEST_USER_IDS.ADMIN,\n        'admin',\n        { therapistId: TEST_USER_IDS.THERAPIST },\n      );\n      expect(therapistResult.therapistInfo.id).toBe(TEST_USER_IDS.THERAPIST);\n\n      // Specific client details\n      const clientResult = await controller.getClientAnalytics(\n        TEST_USER_IDS.ADMIN,\n        'admin',\n        { clientId: TEST_USER_IDS.CLIENT },\n      );\n      expect(clientResult.clientInfo.id).toBe(TEST_USER_IDS.CLIENT);\n    });\n\n    it('should handle therapist self-service analytics workflow', async () => {\n      mockAnalyticsService.getTherapistAnalytics.mockResolvedValue(mockTherapistAnalytics);\n      mockAnalyticsService.getClientAnalytics.mockResolvedValue(mockClientAnalytics);\n\n      // Get own performance metrics\n      const ownMetrics = await controller.getTherapistAnalytics(\n        TEST_USER_IDS.THERAPIST,\n        'therapist',\n        {},\n      );\n      expect(ownMetrics.performanceMetrics.clientSatisfaction).toBeDefined();\n\n      // Get assigned client progress\n      const clientProgress = await controller.getClientAnalytics(\n        TEST_USER_IDS.THERAPIST,\n        'therapist',\n        { clientId: TEST_USER_IDS.CLIENT },\n      );\n      expect(clientProgress.progressMetrics.improvementScore).toBeDefined();\n    });\n\n    it('should handle client self-monitoring workflow', async () => {\n      mockAnalyticsService.getClientAnalytics.mockResolvedValue(mockClientAnalytics);\n\n      // Get personal progress metrics\n      const progressResult = await controller.getClientAnalytics(\n        TEST_USER_IDS.CLIENT,\n        'user',\n        { dateFrom: '2024-01-01', dateTo: '2024-01-31' },\n      );\n\n      expect(progressResult.progressMetrics.moodTrend).toBeDefined();\n      expect(progressResult.sessionHistory.totalSessions).toBeGreaterThanOrEqual(0);\n      expect(progressResult.engagementStats.loginFrequency).toBeGreaterThanOrEqual(0);\n    });\n  });\n});"],"version":3}