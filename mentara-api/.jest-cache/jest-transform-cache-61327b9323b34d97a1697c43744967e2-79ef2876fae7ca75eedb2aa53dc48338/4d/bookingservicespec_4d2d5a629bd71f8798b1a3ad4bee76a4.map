{"file":"/home/wetooa/Documents/code/projects/mentara/mentara-api/src/booking/booking.service.spec.ts","mappings":"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","names":[],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/booking/booking.service.spec.ts"],"sourcesContent":["import { Test, TestingModule } from '@nestjs/testing';\nimport {\n  BadRequestException,\n  NotFoundException,\n  ForbiddenException,\n} from '@nestjs/common';\nimport { BookingService } from './booking.service';\nimport { PrismaService } from '../providers/prisma-client.provider';\nimport { MeetingStatus } from '@prisma/client';\nimport {\n  createMockPrismaService,\n  TEST_USER_IDS,\n  TestDataFactory,\n} from '../test-utils';\n\ndescribe('BookingService', () => {\n  let service: BookingService;\n  let prismaService: jest.Mocked<PrismaService>;\n  let testFactory: TestDataFactory;\n\n  beforeEach(async () => {\n    const mockPrisma = createMockPrismaService();\n\n    const module: TestingModule = await Test.createTestingModule({\n      providers: [\n        BookingService,\n        {\n          provide: PrismaService,\n          useValue: mockPrisma,\n        },\n      ],\n    }).compile();\n\n    service = module.get<BookingService>(BookingService);\n    prismaService = module.get(PrismaService);\n    testFactory = new TestDataFactory(prismaService as any);\n  });\n\n  afterEach(() => {\n    jest.clearAllMocks();\n  });\n\n  describe('createMeeting', () => {\n    const mockCreateMeetingDto = {\n      startTime: '2024-01-15T14:00:00Z',\n      duration: 60,\n      therapistId: TEST_USER_IDS.THERAPIST,\n      title: 'Therapy Session',\n      description: 'Regular therapy session',\n      meetingType: 'followup' as const,\n    };\n\n    const mockTherapist = {\n      id: 'therapist-db-id',\n      userId: TEST_USER_IDS.THERAPIST,\n    };\n\n    const mockRelationship = {\n      id: 'relationship-id',\n      clientId: TEST_USER_IDS.CLIENT,\n      therapistId: TEST_USER_IDS.THERAPIST,\n    };\n\n    const mockAvailability = {\n      id: 'availability-id',\n      therapistId: TEST_USER_IDS.THERAPIST,\n      dayOfWeek: 1, // Monday\n      startTime: '09:00',\n      endTime: '17:00',\n      isAvailable: true,\n    };\n\n    it('should successfully create a meeting', async () => {\n      const expectedMeeting = {\n        id: 'meeting-id',\n        ...mockCreateMeetingDto,\n        status: 'SCHEDULED',\n        clientId: TEST_USER_IDS.CLIENT,\n        client: {\n          user: {\n            firstName: 'John',\n            lastName: 'Doe',\n            email: 'john@example.com',\n          },\n        },\n        therapist: {\n          user: {\n            firstName: 'Dr. Jane',\n            lastName: 'Smith',\n            email: 'jane@example.com',\n          },\n        },\n      };\n\n      (prismaService.therapist.findFirst as jest.Mock).mockResolvedValue(\n        mockTherapist,\n      );\n      (prismaService.clientTherapist.findFirst as jest.Mock).mockResolvedValue(\n        mockRelationship,\n      );\n      (prismaService.meeting.findMany as jest.Mock).mockResolvedValue([]); // No conflicts\n      (\n        prismaService.therapistAvailability.findFirst as jest.Mock\n      ).mockResolvedValue(mockAvailability);\n      (prismaService.meeting.create as jest.Mock).mockResolvedValue(\n        expectedMeeting,\n      );\n\n      const result = await service.createMeeting(\n        mockCreateMeetingDto,\n        TEST_USER_IDS.CLIENT,\n      );\n\n      expect(result).toEqual(expectedMeeting);\n      expect(prismaService.meeting.create).toHaveBeenCalledWith({\n        data: {\n          ...mockCreateMeetingDto,\n          status: 'SCHEDULED',\n          clientId: TEST_USER_IDS.CLIENT,\n        },\n        include: {\n          client: {\n            select: {\n              user: {\n                select: {\n                  firstName: true,\n                  lastName: true,\n                  email: true,\n                },\n              },\n            },\n          },\n          therapist: {\n            select: {\n              user: {\n                select: {\n                  firstName: true,\n                  lastName: true,\n                  email: true,\n                },\n              },\n            },\n          },\n        },\n      });\n    });\n\n    it('should throw NotFoundException when therapist not found', async () => {\n      (prismaService.therapist.findFirst as jest.Mock).mockResolvedValue(null);\n\n      await expect(\n        service.createMeeting(mockCreateMeetingDto, TEST_USER_IDS.CLIENT),\n      ).rejects.toThrow(NotFoundException);\n\n      expect(prismaService.clientTherapist.findFirst).not.toHaveBeenCalled();\n    });\n\n    it('should throw ForbiddenException when no client-therapist relationship exists', async () => {\n      (prismaService.therapist.findFirst as jest.Mock).mockResolvedValue(\n        mockTherapist,\n      );\n      (prismaService.clientTherapist.findFirst as jest.Mock).mockResolvedValue(\n        null,\n      );\n\n      await expect(\n        service.createMeeting(mockCreateMeetingDto, TEST_USER_IDS.CLIENT),\n      ).rejects.toThrow(ForbiddenException);\n\n      expect(prismaService.meeting.findMany).not.toHaveBeenCalled();\n    });\n\n    it('should throw BadRequestException when there are scheduling conflicts', async () => {\n      const conflictingMeeting = {\n        id: 'conflict-id',\n        startTime: new Date('2024-01-15T14:30:00Z'),\n        duration: 60,\n        status: 'SCHEDULED' as MeetingStatus,\n      };\n\n      (prismaService.therapist.findFirst as jest.Mock).mockResolvedValue(\n        mockTherapist,\n      );\n      (prismaService.clientTherapist.findFirst as jest.Mock).mockResolvedValue(\n        mockRelationship,\n      );\n      (prismaService.meeting.findMany as jest.Mock).mockResolvedValue([\n        conflictingMeeting,\n      ]);\n\n      await expect(\n        service.createMeeting(mockCreateMeetingDto, TEST_USER_IDS.CLIENT),\n      ).rejects.toThrow(BadRequestException);\n\n      expect(\n        prismaService.therapistAvailability.findFirst,\n      ).not.toHaveBeenCalled();\n    });\n\n    it('should throw BadRequestException when therapist is not available', async () => {\n      (prismaService.therapist.findFirst as jest.Mock).mockResolvedValue(\n        mockTherapist,\n      );\n      (prismaService.clientTherapist.findFirst as jest.Mock).mockResolvedValue(\n        mockRelationship,\n      );\n      (prismaService.meeting.findMany as jest.Mock).mockResolvedValue([]);\n      (\n        prismaService.therapistAvailability.findFirst as jest.Mock\n      ).mockResolvedValue(null);\n\n      await expect(\n        service.createMeeting(mockCreateMeetingDto, TEST_USER_IDS.CLIENT),\n      ).rejects.toThrow(BadRequestException);\n\n      expect(prismaService.meeting.create).not.toHaveBeenCalled();\n    });\n\n    it('should validate time format and throw BadRequestException for invalid format', async () => {\n      const invalidTimeDto = {\n        ...mockCreateMeetingDto,\n        startTime: new Date('invalid-date'),\n      };\n\n      (prismaService.therapist.findFirst as jest.Mock).mockResolvedValue(\n        mockTherapist,\n      );\n      (prismaService.clientTherapist.findFirst as jest.Mock).mockResolvedValue(\n        mockRelationship,\n      );\n      (prismaService.meeting.findMany as jest.Mock).mockResolvedValue([]);\n      (\n        prismaService.therapistAvailability.findFirst as jest.Mock\n      ).mockResolvedValue(mockAvailability);\n\n      await expect(\n        service.createMeeting(invalidTimeDto, TEST_USER_IDS.CLIENT),\n      ).rejects.toThrow(BadRequestException);\n    });\n  });\n\n  describe('getMeetings', () => {\n    const mockMeetings = [\n      {\n        id: 'meeting-1',\n        startTime: new Date('2024-01-15T14:00:00Z'),\n        duration: 60,\n        status: 'SCHEDULED' as MeetingStatus,\n        client: {\n          user: {\n            firstName: 'John',\n            lastName: 'Doe',\n            email: 'john@example.com',\n          },\n        },\n        therapist: {\n          user: {\n            firstName: 'Dr. Jane',\n            lastName: 'Smith',\n            email: 'jane@example.com',\n          },\n        },\n      },\n    ];\n\n    it('should return meetings for therapist', async () => {\n      (prismaService.meeting.findMany as jest.Mock).mockResolvedValue(\n        mockMeetings,\n      );\n\n      const result = await service.getMeetings(\n        TEST_USER_IDS.THERAPIST,\n        'therapist',\n      );\n\n      expect(result).toEqual(mockMeetings);\n      expect(prismaService.meeting.findMany).toHaveBeenCalledWith({\n        where: { therapistId: TEST_USER_IDS.THERAPIST },\n        include: {\n          client: {\n            select: {\n              user: {\n                select: {\n                  firstName: true,\n                  lastName: true,\n                  email: true,\n                },\n              },\n            },\n          },\n          therapist: {\n            select: {\n              user: {\n                select: {\n                  firstName: true,\n                  lastName: true,\n                  email: true,\n                },\n              },\n            },\n          },\n        },\n        orderBy: { startTime: 'desc' },\n      });\n    });\n\n    it('should return meetings for client', async () => {\n      (prismaService.meeting.findMany as jest.Mock).mockResolvedValue(\n        mockMeetings,\n      );\n\n      const result = await service.getMeetings(TEST_USER_IDS.CLIENT, 'client');\n\n      expect(result).toEqual(mockMeetings);\n      expect(prismaService.meeting.findMany).toHaveBeenCalledWith({\n        where: { clientId: TEST_USER_IDS.CLIENT },\n        include: expect.any(Object),\n        orderBy: { startTime: 'desc' },\n      });\n    });\n\n    it('should handle database errors gracefully', async () => {\n      (prismaService.meeting.findMany as jest.Mock).mockRejectedValue(\n        new Error('Database error'),\n      );\n\n      await expect(\n        service.getMeetings(TEST_USER_IDS.CLIENT, 'client'),\n      ).rejects.toThrow(BadRequestException);\n    });\n  });\n\n  describe('getMeeting', () => {\n    const mockMeeting = {\n      id: 'meeting-id',\n      clientId: TEST_USER_IDS.CLIENT,\n      therapistId: TEST_USER_IDS.THERAPIST,\n      startTime: new Date('2024-01-15T14:00:00Z'),\n      status: 'SCHEDULED' as MeetingStatus,\n      client: {\n        user: {\n          firstName: 'John',\n          lastName: 'Doe',\n          email: 'john@example.com',\n        },\n      },\n      therapist: {\n        user: {\n          firstName: 'Dr. Jane',\n          lastName: 'Smith',\n          email: 'jane@example.com',\n        },\n      },\n    };\n\n    it('should return meeting for valid therapist access', async () => {\n      (prismaService.meeting.findUnique as jest.Mock).mockResolvedValue(\n        mockMeeting,\n      );\n\n      const result = await service.getMeeting(\n        'meeting-id',\n        TEST_USER_IDS.THERAPIST,\n        'therapist',\n      );\n\n      expect(result).toEqual(mockMeeting);\n      expect(prismaService.meeting.findUnique).toHaveBeenCalledWith({\n        where: { id: 'meeting-id' },\n        include: expect.any(Object),\n      });\n    });\n\n    it('should return meeting for valid client access', async () => {\n      (prismaService.meeting.findUnique as jest.Mock).mockResolvedValue(\n        mockMeeting,\n      );\n\n      const result = await service.getMeeting(\n        'meeting-id',\n        TEST_USER_IDS.CLIENT,\n        'client',\n      );\n\n      expect(result).toEqual(mockMeeting);\n    });\n\n    it('should throw NotFoundException when meeting does not exist', async () => {\n      (prismaService.meeting.findUnique as jest.Mock).mockResolvedValue(null);\n\n      await expect(\n        service.getMeeting('non-existent-id', TEST_USER_IDS.CLIENT, 'client'),\n      ).rejects.toThrow(NotFoundException);\n    });\n\n    it('should throw ForbiddenException when therapist accesses wrong meeting', async () => {\n      const wrongMeeting = {\n        ...mockMeeting,\n        therapistId: 'different-therapist-id',\n      };\n      (prismaService.meeting.findUnique as jest.Mock).mockResolvedValue(\n        wrongMeeting,\n      );\n\n      await expect(\n        service.getMeeting('meeting-id', TEST_USER_IDS.THERAPIST, 'therapist'),\n      ).rejects.toThrow(ForbiddenException);\n    });\n\n    it('should throw ForbiddenException when client accesses wrong meeting', async () => {\n      const wrongMeeting = {\n        ...mockMeeting,\n        clientId: 'different-client-id',\n      };\n      (prismaService.meeting.findUnique as jest.Mock).mockResolvedValue(\n        wrongMeeting,\n      );\n\n      await expect(\n        service.getMeeting('meeting-id', TEST_USER_IDS.CLIENT, 'client'),\n      ).rejects.toThrow(ForbiddenException);\n    });\n  });\n\n  describe('updateMeeting', () => {\n    const mockUpdateDto = {\n      startTime: '2024-01-15T14:00:00Z',\n      duration: 60,\n      therapistId: TEST_USER_IDS.THERAPIST,\n      title: 'Updated Session',\n      description: 'Updated description',\n      status: 'CONFIRMED' as MeetingStatus,\n    };\n\n    const mockMeeting = {\n      id: 'meeting-id',\n      clientId: TEST_USER_IDS.CLIENT,\n      therapistId: TEST_USER_IDS.THERAPIST,\n      status: 'SCHEDULED' as MeetingStatus,\n    };\n\n    it('should successfully update a meeting', async () => {\n      const updatedMeeting = {\n        ...mockMeeting,\n        ...mockUpdateDto,\n      };\n\n      jest.spyOn(service, 'getMeeting').mockResolvedValue(mockMeeting as any);\n      (prismaService.meeting.update as jest.Mock).mockResolvedValue(\n        updatedMeeting as any,\n      );\n\n      const result = await service.updateMeeting(\n        'meeting-id',\n        mockUpdateDto,\n        TEST_USER_IDS.CLIENT,\n        'client',\n      );\n\n      expect(result).toEqual(updatedMeeting);\n      expect(prismaService.meeting.update).toHaveBeenCalledWith({\n        where: { id: 'meeting-id' },\n        data: {\n          title: mockUpdateDto.title,\n          description: mockUpdateDto.description,\n          startTime: undefined,\n          duration: undefined,\n          meetingType: undefined,\n          therapistId: undefined,\n          status: mockUpdateDto.status,\n        },\n        include: expect.any(Object),\n      });\n    });\n\n    it('should throw BadRequestException when trying to update completed meeting', async () => {\n      const completedMeeting = {\n        ...mockMeeting,\n        status: 'COMPLETED' as MeetingStatus,\n      };\n\n      jest\n        .spyOn(service, 'getMeeting')\n        .mockResolvedValue(completedMeeting as any);\n\n      await expect(\n        service.updateMeeting(\n          'meeting-id',\n          mockUpdateDto,\n          TEST_USER_IDS.CLIENT,\n          'client',\n        ),\n      ).rejects.toThrow(BadRequestException);\n\n      expect(prismaService.meeting.update).not.toHaveBeenCalled();\n    });\n\n    it('should throw BadRequestException when trying to update cancelled meeting', async () => {\n      const cancelledMeeting = {\n        ...mockMeeting,\n        status: 'CANCELLED' as MeetingStatus,\n      };\n\n      jest\n        .spyOn(service, 'getMeeting')\n        .mockResolvedValue(cancelledMeeting as any);\n\n      await expect(\n        service.updateMeeting(\n          'meeting-id',\n          mockUpdateDto,\n          TEST_USER_IDS.CLIENT,\n          'client',\n        ),\n      ).rejects.toThrow(BadRequestException);\n    });\n  });\n\n  describe('cancelMeeting', () => {\n    const mockMeeting = {\n      id: 'meeting-id',\n      clientId: TEST_USER_IDS.CLIENT,\n      therapistId: TEST_USER_IDS.THERAPIST,\n      status: 'SCHEDULED' as MeetingStatus,\n    };\n\n    it('should successfully cancel a meeting', async () => {\n      const cancelledMeeting = {\n        ...mockMeeting,\n        status: 'CANCELLED' as MeetingStatus,\n      };\n\n      jest.spyOn(service, 'getMeeting').mockResolvedValue(mockMeeting as any);\n      (prismaService.meeting.update as jest.Mock).mockResolvedValue(\n        cancelledMeeting as any,\n      );\n\n      const result = await service.cancelMeeting(\n        'meeting-id',\n        TEST_USER_IDS.CLIENT,\n        'client',\n      );\n\n      expect(result).toEqual(cancelledMeeting);\n      expect(prismaService.meeting.update).toHaveBeenCalledWith({\n        where: { id: 'meeting-id' },\n        data: { status: 'CANCELLED' },\n        include: expect.any(Object),\n      });\n    });\n\n    it('should throw BadRequestException when meeting is already cancelled', async () => {\n      const cancelledMeeting = {\n        ...mockMeeting,\n        status: 'CANCELLED' as MeetingStatus,\n      };\n\n      jest\n        .spyOn(service, 'getMeeting')\n        .mockResolvedValue(cancelledMeeting as any);\n\n      await expect(\n        service.cancelMeeting('meeting-id', TEST_USER_IDS.CLIENT, 'client'),\n      ).rejects.toThrow(BadRequestException);\n\n      expect(prismaService.meeting.update).not.toHaveBeenCalled();\n    });\n\n    it('should throw BadRequestException when trying to cancel completed meeting', async () => {\n      const completedMeeting = {\n        ...mockMeeting,\n        status: 'COMPLETED' as MeetingStatus,\n      };\n\n      jest\n        .spyOn(service, 'getMeeting')\n        .mockResolvedValue(completedMeeting as any);\n\n      await expect(\n        service.cancelMeeting('meeting-id', TEST_USER_IDS.CLIENT, 'client'),\n      ).rejects.toThrow(BadRequestException);\n    });\n  });\n\n  describe('createAvailability', () => {\n    const mockCreateAvailabilityDto = {\n      dayOfWeek: 1, // Monday\n      startTime: '09:00',\n      endTime: '17:00',\n      notes: 'Regular availability',\n    };\n\n    it('should successfully create availability', async () => {\n      const expectedAvailability = {\n        id: 'availability-id',\n        therapistId: TEST_USER_IDS.THERAPIST,\n        ...mockCreateAvailabilityDto,\n      };\n\n      (\n        prismaService.therapistAvailability.findFirst as jest.Mock\n      ).mockResolvedValue(null); // No overlap\n      (\n        prismaService.therapistAvailability.create as jest.Mock\n      ).mockResolvedValue(expectedAvailability);\n\n      const result = await service.createAvailability(\n        mockCreateAvailabilityDto,\n        TEST_USER_IDS.THERAPIST,\n      );\n\n      expect(result).toEqual(expectedAvailability);\n      expect(prismaService.therapistAvailability.create).toHaveBeenCalledWith({\n        data: {\n          therapistId: TEST_USER_IDS.THERAPIST,\n          ...mockCreateAvailabilityDto,\n        },\n      });\n    });\n\n    it('should throw BadRequestException for invalid time format', async () => {\n      const invalidDto = {\n        ...mockCreateAvailabilityDto,\n        startTime: '25:00', // Invalid hour\n      };\n\n      await expect(\n        service.createAvailability(invalidDto, TEST_USER_IDS.THERAPIST),\n      ).rejects.toThrow(BadRequestException);\n\n      expect(\n        prismaService.therapistAvailability.findFirst,\n      ).not.toHaveBeenCalled();\n    });\n\n    it('should throw BadRequestException when start time is after end time', async () => {\n      const invalidDto = {\n        ...mockCreateAvailabilityDto,\n        startTime: '17:00',\n        endTime: '09:00',\n      };\n\n      await expect(\n        service.createAvailability(invalidDto, TEST_USER_IDS.THERAPIST),\n      ).rejects.toThrow(BadRequestException);\n    });\n\n    it('should throw BadRequestException when availability overlaps', async () => {\n      const overlappingAvailability = {\n        id: 'existing-id',\n        startTime: '10:00',\n        endTime: '16:00',\n      };\n\n      (\n        prismaService.therapistAvailability.findFirst as jest.Mock\n      ).mockResolvedValue(overlappingAvailability);\n\n      await expect(\n        service.createAvailability(\n          mockCreateAvailabilityDto,\n          TEST_USER_IDS.THERAPIST,\n        ),\n      ).rejects.toThrow(BadRequestException);\n\n      expect(prismaService.therapistAvailability.create).not.toHaveBeenCalled();\n    });\n  });\n\n  describe('getAvailability', () => {\n    const mockAvailabilities = [\n      {\n        id: 'availability-1',\n        therapistId: TEST_USER_IDS.THERAPIST,\n        dayOfWeek: 1,\n        startTime: '09:00',\n        endTime: '12:00',\n      },\n      {\n        id: 'availability-2',\n        therapistId: TEST_USER_IDS.THERAPIST,\n        dayOfWeek: 1,\n        startTime: '13:00',\n        endTime: '17:00',\n      },\n    ];\n\n    it('should return therapist availability', async () => {\n      (\n        prismaService.therapistAvailability.findMany as jest.Mock\n      ).mockResolvedValue(mockAvailabilities);\n\n      const result = await service.getAvailability(TEST_USER_IDS.THERAPIST);\n\n      expect(result).toEqual(mockAvailabilities);\n      expect(prismaService.therapistAvailability.findMany).toHaveBeenCalledWith(\n        {\n          where: { therapistId: TEST_USER_IDS.THERAPIST },\n          orderBy: [{ dayOfWeek: 'asc' }, { startTime: 'asc' }],\n        },\n      );\n    });\n\n    it('should handle database errors', async () => {\n      (\n        prismaService.therapistAvailability.findMany as jest.Mock\n      ).mockRejectedValue(new Error('Database error'));\n\n      await expect(\n        service.getAvailability(TEST_USER_IDS.THERAPIST),\n      ).rejects.toThrow(BadRequestException);\n    });\n  });\n\n  describe('updateAvailability', () => {\n    const mockUpdateDto = {\n      dayOfWeek: 1,\n      startTime: '10:00',\n      endTime: '16:00',\n      notes: 'Updated hours',\n    };\n\n    it('should successfully update availability', async () => {\n      const existingAvailability = {\n        id: 'availability-id',\n        therapistId: TEST_USER_IDS.THERAPIST,\n      };\n      const updatedAvailability = {\n        ...existingAvailability,\n        ...mockUpdateDto,\n      };\n\n      (\n        prismaService.therapistAvailability.findFirst as jest.Mock\n      ).mockResolvedValue(existingAvailability);\n      (\n        prismaService.therapistAvailability.update as jest.Mock\n      ).mockResolvedValue(updatedAvailability);\n\n      const result = await service.updateAvailability(\n        'availability-id',\n        mockUpdateDto,\n        TEST_USER_IDS.THERAPIST,\n      );\n\n      expect(result).toEqual(updatedAvailability);\n      expect(prismaService.therapistAvailability.update).toHaveBeenCalledWith({\n        where: { id: 'availability-id' },\n        data: mockUpdateDto,\n      });\n    });\n\n    it('should throw NotFoundException when availability does not exist', async () => {\n      (\n        prismaService.therapistAvailability.findFirst as jest.Mock\n      ).mockResolvedValue(null);\n\n      await expect(\n        service.updateAvailability(\n          'non-existent-id',\n          mockUpdateDto,\n          TEST_USER_IDS.THERAPIST,\n        ),\n      ).rejects.toThrow(NotFoundException);\n\n      expect(prismaService.therapistAvailability.update).not.toHaveBeenCalled();\n    });\n  });\n\n  describe('deleteAvailability', () => {\n    it('should successfully delete availability', async () => {\n      const existingAvailability = {\n        id: 'availability-id',\n        therapistId: TEST_USER_IDS.THERAPIST,\n      };\n\n      (\n        prismaService.therapistAvailability.findFirst as jest.Mock\n      ).mockResolvedValue(existingAvailability);\n      (\n        prismaService.therapistAvailability.delete as jest.Mock\n      ).mockResolvedValue(existingAvailability);\n\n      const result = await service.deleteAvailability(\n        'availability-id',\n        TEST_USER_IDS.THERAPIST,\n      );\n\n      expect(result).toEqual(existingAvailability);\n      expect(prismaService.therapistAvailability.delete).toHaveBeenCalledWith({\n        where: { id: 'availability-id' },\n      });\n    });\n\n    it('should throw NotFoundException when availability does not exist', async () => {\n      (\n        prismaService.therapistAvailability.findFirst as jest.Mock\n      ).mockResolvedValue(null);\n\n      await expect(\n        service.deleteAvailability('non-existent-id', TEST_USER_IDS.THERAPIST),\n      ).rejects.toThrow(NotFoundException);\n\n      expect(prismaService.therapistAvailability.delete).not.toHaveBeenCalled();\n    });\n  });\n\n  describe('getAvailableSlots', () => {\n    const mockDate = '2024-01-15'; // Monday\n    const mockAvailability = [\n      {\n        id: 'availability-1',\n        therapistId: TEST_USER_IDS.THERAPIST,\n        dayOfWeek: 1, // Monday\n        startTime: '09:00',\n        endTime: '17:00',\n        isAvailable: true,\n      },\n    ];\n\n    it('should return available slots when no conflicts', async () => {\n      (\n        prismaService.therapistAvailability.findMany as jest.Mock\n      ).mockResolvedValue(mockAvailability);\n      (prismaService.meeting.findMany as jest.Mock).mockResolvedValue([]); // No existing bookings\n\n      const result = await service.getAvailableSlots(\n        TEST_USER_IDS.THERAPIST,\n        mockDate,\n      );\n\n      expect(result).toBeDefined();\n      expect(Array.isArray(result)).toBe(true);\n      expect(prismaService.therapistAvailability.findMany).toHaveBeenCalledWith(\n        {\n          where: {\n            therapistId: TEST_USER_IDS.THERAPIST,\n            dayOfWeek: 1,\n            isAvailable: true,\n          },\n          orderBy: { startTime: 'asc' },\n        },\n      );\n    });\n\n    it('should return empty array when therapist has no availability', async () => {\n      (\n        prismaService.therapistAvailability.findMany as jest.Mock\n      ).mockResolvedValue([]);\n\n      const result = await service.getAvailableSlots(\n        TEST_USER_IDS.THERAPIST,\n        mockDate,\n      );\n\n      expect(result).toEqual([]);\n      expect(prismaService.meeting.findMany).not.toHaveBeenCalled();\n    });\n\n    it('should exclude conflicting time slots', async () => {\n      const existingBooking = {\n        id: 'booking-1',\n        startTime: new Date('2024-01-15T10:00:00Z'),\n        duration: 60,\n        status: 'SCHEDULED' as MeetingStatus,\n      };\n\n      (\n        prismaService.therapistAvailability.findMany as jest.Mock\n      ).mockResolvedValue(mockAvailability);\n      (prismaService.meeting.findMany as jest.Mock).mockResolvedValue([\n        existingBooking,\n      ]);\n\n      const result = await service.getAvailableSlots(\n        TEST_USER_IDS.THERAPIST,\n        mockDate,\n      );\n\n      expect(result).toBeDefined();\n      expect(prismaService.meeting.findMany).toHaveBeenCalledWith({\n        where: {\n          therapistId: TEST_USER_IDS.THERAPIST,\n          startTime: {\n            gte: expect.any(Date),\n            lte: expect.any(Date),\n          },\n          status: { in: ['SCHEDULED', 'CONFIRMED'] },\n        },\n        orderBy: { startTime: 'asc' },\n      });\n    });\n  });\n\n  describe('validateMeetingTime', () => {\n    it('should validate meeting time successfully', async () => {\n      const mockAvailability = {\n        id: 'availability-id',\n        therapistId: TEST_USER_IDS.THERAPIST,\n        dayOfWeek: 1,\n        startTime: '09:00',\n        endTime: '17:00',\n        isAvailable: true,\n      };\n\n      (\n        prismaService.therapistAvailability.findFirst as jest.Mock\n      ).mockResolvedValue(mockAvailability);\n      (prismaService.meeting.findMany as jest.Mock).mockResolvedValue([]); // No conflicts\n\n      await expect(\n        service.validateMeetingTime(\n          TEST_USER_IDS.THERAPIST,\n          TEST_USER_IDS.CLIENT,\n          '2024-01-15T14:00:00Z',\n          60,\n        ),\n      ).resolves.not.toThrow();\n\n      expect(prismaService.therapistAvailability.findFirst).toHaveBeenCalled();\n      expect(prismaService.meeting.findMany).toHaveBeenCalled();\n    });\n\n    it('should throw BadRequestException for invalid duration', async () => {\n      await expect(\n        service.validateMeetingTime(\n          TEST_USER_IDS.THERAPIST,\n          TEST_USER_IDS.CLIENT,\n          '2024-01-15T14:00:00Z',\n          999, // Invalid duration\n        ),\n      ).rejects.toThrow(BadRequestException);\n\n      expect(\n        prismaService.therapistAvailability.findFirst,\n      ).not.toHaveBeenCalled();\n    });\n\n    it('should throw BadRequestException when therapist not available', async () => {\n      (\n        prismaService.therapistAvailability.findFirst as jest.Mock\n      ).mockResolvedValue(null);\n\n      await expect(\n        service.validateMeetingTime(\n          TEST_USER_IDS.THERAPIST,\n          TEST_USER_IDS.CLIENT,\n          '2024-01-15T14:00:00Z',\n          60,\n        ),\n      ).rejects.toThrow(BadRequestException);\n    });\n\n    it('should throw BadRequestException for scheduling conflicts', async () => {\n      const mockAvailability = {\n        id: 'availability-id',\n        therapistId: TEST_USER_IDS.THERAPIST,\n        dayOfWeek: 1,\n        startTime: '09:00',\n        endTime: '17:00',\n        isAvailable: true,\n      };\n      const conflictingMeeting = {\n        id: 'conflict-id',\n        startTime: new Date('2024-01-15T14:30:00Z'),\n        duration: 60,\n        status: 'SCHEDULED' as MeetingStatus,\n      };\n\n      (\n        prismaService.therapistAvailability.findFirst as jest.Mock\n      ).mockResolvedValue(mockAvailability);\n      (prismaService.meeting.findMany as jest.Mock).mockResolvedValue([\n        conflictingMeeting,\n      ]);\n\n      await expect(\n        service.validateMeetingTime(\n          TEST_USER_IDS.THERAPIST,\n          TEST_USER_IDS.CLIENT,\n          '2024-01-15T14:00:00Z',\n          60,\n        ),\n      ).rejects.toThrow(BadRequestException);\n    });\n  });\n\n  describe('Edge Cases and Error Handling', () => {\n    it('should handle database connection errors', async () => {\n      (prismaService.meeting.findMany as jest.Mock).mockRejectedValue(\n        new Error('Connection timeout'),\n      );\n\n      await expect(\n        service.getMeetings(TEST_USER_IDS.CLIENT, 'client'),\n      ).rejects.toThrow(BadRequestException);\n    });\n\n    it('should handle invalid meeting status transitions', async () => {\n      const mockMeeting = {\n        id: 'meeting-id',\n        status: 'COMPLETED' as MeetingStatus,\n        clientId: TEST_USER_IDS.CLIENT,\n        therapistId: TEST_USER_IDS.THERAPIST,\n      };\n\n      jest.spyOn(service, 'getMeeting').mockResolvedValue(mockMeeting as any);\n\n      await expect(\n        service.updateMeeting(\n          'meeting-id',\n          {\n            startTime: '2024-01-15T14:00:00Z',\n            duration: 60,\n            therapistId: TEST_USER_IDS.THERAPIST,\n            title: 'Test Session',\n            description: 'Test description',\n            status: 'SCHEDULED' as MeetingStatus,\n          },\n          TEST_USER_IDS.CLIENT,\n          'client',\n        ),\n      ).rejects.toThrow(BadRequestException);\n    });\n\n    it('should handle timezone edge cases in slot calculation', async () => {\n      const mockAvailability = [\n        {\n          id: 'availability-1',\n          therapistId: TEST_USER_IDS.THERAPIST,\n          dayOfWeek: 1,\n          startTime: '23:30', // Near midnight\n          endTime: '23:59',\n          isAvailable: true,\n        },\n      ];\n\n      (\n        prismaService.therapistAvailability.findMany as jest.Mock\n      ).mockResolvedValue(mockAvailability);\n      (prismaService.meeting.findMany as jest.Mock).mockResolvedValue([]);\n\n      const result = await service.getAvailableSlots(\n        TEST_USER_IDS.THERAPIST,\n        '2024-01-15',\n      );\n\n      expect(result).toBeDefined();\n      expect(Array.isArray(result)).toBe(true);\n    });\n  });\n});\n"],"version":3}