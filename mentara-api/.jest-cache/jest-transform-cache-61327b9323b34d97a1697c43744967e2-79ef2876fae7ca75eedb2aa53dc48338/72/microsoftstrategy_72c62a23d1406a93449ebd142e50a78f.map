{"file":"/home/wetooa/Documents/code/projects/mentara/mentara-api/src/auth/strategies/microsoft.strategy.ts","mappings":";;;;;;;;;;;;AAAA,2CAA4C;AAC5C,+CAAoD;AACpD,2DAA8D;AAGvD,IAAM,iBAAiB,GAAvB,MAAM,iBAAkB,SAAQ,IAAA,2BAAgB,EAAC,6BAAQ,EAAE,WAAW,CAAC;IAC5E;QACE,KAAK,CAAC;YACJ,QAAQ,EAAE,OAAO,CAAC,GAAG,CAAC,mBAAmB;YACzC,YAAY,EAAE,OAAO,CAAC,GAAG,CAAC,uBAAuB;YACjD,WAAW,EACT,OAAO,CAAC,GAAG,CAAC,sBAAsB,IAAI,0BAA0B;YAClE,KAAK,EAAE,CAAC,WAAW,CAAC;SACrB,CAAC,CAAC;IACL,CAAC;IAED,KAAK,CAAC,QAAQ,CACZ,WAAmB,EACnB,YAAoB,EACpB,OAAY,EACZ,IAAoB;QAEpB,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,GAAG,OAAO,CAAC;QACjC,MAAM,IAAI,GAAG;YACX,KAAK,EAAE,MAAM,CAAC,CAAC,CAAC,CAAC,KAAK;YACtB,SAAS,EAAE,IAAI,CAAC,SAAS;YACzB,QAAQ,EAAE,IAAI,CAAC,UAAU;YACzB,WAAW;YACX,YAAY;SACb,CAAC;QACF,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;IACnB,CAAC;CACF,CAAA;AA3BY,8CAAiB;4BAAjB,iBAAiB;IAD7B,IAAA,mBAAU,GAAE;;GACA,iBAAiB,CA2B7B","names":[],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/auth/strategies/microsoft.strategy.ts"],"sourcesContent":["import { Injectable } from '@nestjs/common';\nimport { PassportStrategy } from '@nestjs/passport';\nimport { Strategy, VerifyCallback } from 'passport-microsoft';\n\n@Injectable()\nexport class MicrosoftStrategy extends PassportStrategy(Strategy, 'microsoft') {\n  constructor() {\n    super({\n      clientID: process.env.MICROSOFT_CLIENT_ID,\n      clientSecret: process.env.MICROSOFT_CLIENT_SECRET,\n      callbackURL:\n        process.env.MICROSOFT_CALLBACK_URL || '/auth/microsoft/callback',\n      scope: ['user.read'],\n    });\n  }\n\n  async validate(\n    accessToken: string,\n    refreshToken: string,\n    profile: any,\n    done: VerifyCallback,\n  ): Promise<any> {\n    const { name, emails } = profile;\n    const user = {\n      email: emails[0].value,\n      firstName: name.givenName,\n      lastName: name.familyName,\n      accessToken,\n      refreshToken,\n    };\n    done(null, user);\n  }\n}\n"],"version":3}