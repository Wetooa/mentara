317ecb4fff5a1c617d7dd7fc3fcabcf0
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.BaseDomainEvent = void 0;
const crypto_1 = require("crypto");
class BaseDomainEvent {
    eventId;
    eventType;
    aggregateId;
    aggregateType;
    eventData;
    metadata;
    timestamp;
    version;
    constructor(aggregateId, aggregateType, eventData, metadata = {}, version = 1) {
        this.eventId = this.generateEventId();
        this.eventType = this.constructor.name;
        this.aggregateId = aggregateId;
        this.aggregateType = aggregateType;
        this.eventData = eventData;
        this.metadata = {
            correlationId: this.generateCorrelationId(),
            ...metadata,
        };
        this.timestamp = new Date();
        this.version = version;
    }
    generateEventId() {
        return `event_${Date.now()}_${(0, crypto_1.randomBytes)(8).toString('hex')}`;
    }
    generateCorrelationId() {
        return `corr_${Date.now()}_${(0, crypto_1.randomBytes)(8).toString('hex')}`;
    }
}
exports.BaseDomainEvent = BaseDomainEvent;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL2NvbW1vbi9ldmVudHMvaW50ZXJmYWNlcy9kb21haW4tZXZlbnQuaW50ZXJmYWNlLnRzIiwibWFwcGluZ3MiOiI7OztBQUFBLG1DQUFxQztBQXdCckMsTUFBc0IsZUFBZTtJQUNuQixPQUFPLENBQVM7SUFDaEIsU0FBUyxDQUFTO0lBQ2xCLFdBQVcsQ0FBUztJQUNwQixhQUFhLENBQVM7SUFDdEIsU0FBUyxDQUFJO0lBQ2IsUUFBUSxDQUFnQjtJQUN4QixTQUFTLENBQU87SUFDaEIsT0FBTyxDQUFTO0lBRWhDLFlBQ0UsV0FBbUIsRUFDbkIsYUFBcUIsRUFDckIsU0FBWSxFQUNaLFdBQTBCLEVBQUUsRUFDNUIsVUFBa0IsQ0FBQztRQUVuQixJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQyxlQUFlLEVBQUUsQ0FBQztRQUN0QyxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDO1FBQ3ZDLElBQUksQ0FBQyxXQUFXLEdBQUcsV0FBVyxDQUFDO1FBQy9CLElBQUksQ0FBQyxhQUFhLEdBQUcsYUFBYSxDQUFDO1FBQ25DLElBQUksQ0FBQyxTQUFTLEdBQUcsU0FBUyxDQUFDO1FBQzNCLElBQUksQ0FBQyxRQUFRLEdBQUc7WUFDZCxhQUFhLEVBQUUsSUFBSSxDQUFDLHFCQUFxQixFQUFFO1lBQzNDLEdBQUcsUUFBUTtTQUNaLENBQUM7UUFDRixJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksSUFBSSxFQUFFLENBQUM7UUFDNUIsSUFBSSxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUM7SUFDekIsQ0FBQztJQUVPLGVBQWU7UUFDckIsT0FBTyxTQUFTLElBQUksQ0FBQyxHQUFHLEVBQUUsSUFBSSxJQUFBLG9CQUFXLEVBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUM7SUFDakUsQ0FBQztJQUVPLHFCQUFxQjtRQUMzQixPQUFPLFFBQVEsSUFBSSxDQUFDLEdBQUcsRUFBRSxJQUFJLElBQUEsb0JBQVcsRUFBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQztJQUNoRSxDQUFDO0NBQ0Y7QUFyQ0QsMENBcUNDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9ob21lL3dldG9vYS9Eb2N1bWVudHMvY29kZS9wcm9qZWN0cy9tZW50YXJhL21lbnRhcmEtYXBpL3NyYy9jb21tb24vZXZlbnRzL2ludGVyZmFjZXMvZG9tYWluLWV2ZW50LmludGVyZmFjZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyByYW5kb21CeXRlcyB9IGZyb20gJ2NyeXB0byc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRXZlbnRNZXRhZGF0YSB7XG4gIHVzZXJJZD86IHN0cmluZztcbiAgc2Vzc2lvbklkPzogc3RyaW5nO1xuICBjb3JyZWxhdGlvbklkPzogc3RyaW5nO1xuICBjYXVzYXRpb25JZD86IHN0cmluZztcbiAgdXNlclJvbGU/OiBzdHJpbmc7XG4gIGlwQWRkcmVzcz86IHN0cmluZztcbiAgdXNlckFnZW50Pzogc3RyaW5nO1xuICByZXF1ZXN0SWQ/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRG9tYWluRXZlbnQ8VCA9IGFueT4ge1xuICBldmVudElkOiBzdHJpbmc7XG4gIGV2ZW50VHlwZTogc3RyaW5nO1xuICBhZ2dyZWdhdGVJZDogc3RyaW5nO1xuICBhZ2dyZWdhdGVUeXBlOiBzdHJpbmc7XG4gIGV2ZW50RGF0YTogVDtcbiAgbWV0YWRhdGE6IEV2ZW50TWV0YWRhdGE7XG4gIHRpbWVzdGFtcDogRGF0ZTtcbiAgdmVyc2lvbjogbnVtYmVyO1xufVxuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQmFzZURvbWFpbkV2ZW50PFQgPSBhbnk+IGltcGxlbWVudHMgRG9tYWluRXZlbnQ8VD4ge1xuICBwdWJsaWMgcmVhZG9ubHkgZXZlbnRJZDogc3RyaW5nO1xuICBwdWJsaWMgcmVhZG9ubHkgZXZlbnRUeXBlOiBzdHJpbmc7XG4gIHB1YmxpYyByZWFkb25seSBhZ2dyZWdhdGVJZDogc3RyaW5nO1xuICBwdWJsaWMgcmVhZG9ubHkgYWdncmVnYXRlVHlwZTogc3RyaW5nO1xuICBwdWJsaWMgcmVhZG9ubHkgZXZlbnREYXRhOiBUO1xuICBwdWJsaWMgcmVhZG9ubHkgbWV0YWRhdGE6IEV2ZW50TWV0YWRhdGE7XG4gIHB1YmxpYyByZWFkb25seSB0aW1lc3RhbXA6IERhdGU7XG4gIHB1YmxpYyByZWFkb25seSB2ZXJzaW9uOiBudW1iZXI7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgYWdncmVnYXRlSWQ6IHN0cmluZyxcbiAgICBhZ2dyZWdhdGVUeXBlOiBzdHJpbmcsXG4gICAgZXZlbnREYXRhOiBULFxuICAgIG1ldGFkYXRhOiBFdmVudE1ldGFkYXRhID0ge30sXG4gICAgdmVyc2lvbjogbnVtYmVyID0gMSxcbiAgKSB7XG4gICAgdGhpcy5ldmVudElkID0gdGhpcy5nZW5lcmF0ZUV2ZW50SWQoKTtcbiAgICB0aGlzLmV2ZW50VHlwZSA9IHRoaXMuY29uc3RydWN0b3IubmFtZTtcbiAgICB0aGlzLmFnZ3JlZ2F0ZUlkID0gYWdncmVnYXRlSWQ7XG4gICAgdGhpcy5hZ2dyZWdhdGVUeXBlID0gYWdncmVnYXRlVHlwZTtcbiAgICB0aGlzLmV2ZW50RGF0YSA9IGV2ZW50RGF0YTtcbiAgICB0aGlzLm1ldGFkYXRhID0ge1xuICAgICAgY29ycmVsYXRpb25JZDogdGhpcy5nZW5lcmF0ZUNvcnJlbGF0aW9uSWQoKSxcbiAgICAgIC4uLm1ldGFkYXRhLFxuICAgIH07XG4gICAgdGhpcy50aW1lc3RhbXAgPSBuZXcgRGF0ZSgpO1xuICAgIHRoaXMudmVyc2lvbiA9IHZlcnNpb247XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlRXZlbnRJZCgpOiBzdHJpbmcge1xuICAgIHJldHVybiBgZXZlbnRfJHtEYXRlLm5vdygpfV8ke3JhbmRvbUJ5dGVzKDgpLnRvU3RyaW5nKCdoZXgnKX1gO1xuICB9XG5cbiAgcHJpdmF0ZSBnZW5lcmF0ZUNvcnJlbGF0aW9uSWQoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYGNvcnJfJHtEYXRlLm5vdygpfV8ke3JhbmRvbUJ5dGVzKDgpLnRvU3RyaW5nKCdoZXgnKX1gO1xuICB9XG59XG5cbi8vIEV2ZW50IEhhbmRsZXIgRGVjb3JhdG9yIEludGVyZmFjZVxuZXhwb3J0IGludGVyZmFjZSBFdmVudEhhbmRsZXJPcHRpb25zIHtcbiAgYXN5bmM/OiBib29sZWFuO1xuICBwYXJhbGxlbD86IGJvb2xlYW47XG4gIHNjb3BlPzogJ3VzZXInIHwgJ2dsb2JhbCc7XG59XG5cbi8vIEV2ZW50IEJ1cyBJbnRlcmZhY2VcbmV4cG9ydCBpbnRlcmZhY2UgSUV2ZW50QnVzIHtcbiAgZW1pdDxUID0gYW55PihldmVudDogRG9tYWluRXZlbnQ8VD4pOiBQcm9taXNlPHZvaWQ+O1xuICBzdWJzY3JpYmU8VCA9IGFueT4oXG4gICAgZXZlbnRUeXBlOiBzdHJpbmcsXG4gICAgaGFuZGxlcjogKGV2ZW50OiBEb21haW5FdmVudDxUPikgPT4gUHJvbWlzZTx2b2lkPixcbiAgICBvcHRpb25zPzogRXZlbnRIYW5kbGVyT3B0aW9ucyxcbiAgKTogdm9pZDtcbiAgdW5zdWJzY3JpYmUoZXZlbnRUeXBlOiBzdHJpbmcsIGhhbmRsZXI6ICguLi5hcmdzOiBhbnlbXSkgPT4gYW55KTogdm9pZDtcbn1cbiJdLCJ2ZXJzaW9uIjozfQ==