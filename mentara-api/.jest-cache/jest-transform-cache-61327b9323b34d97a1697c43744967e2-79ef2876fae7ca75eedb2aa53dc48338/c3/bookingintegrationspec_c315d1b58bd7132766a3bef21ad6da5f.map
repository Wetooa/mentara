{"file":"/home/wetooa/Documents/code/projects/mentara/mentara-api/src/test-utils/integration-tests/booking.integration.spec.ts","mappings":";;AAAA,6CAAsD;AAEtD,qCAAqC;AACrC,mFAAuE;AACvE,iEAA6D;AAC7D,2CAA+C;AAC/C,gEAA2D;AAE3D,QAAQ,CAAC,2BAA2B,EAAE,GAAG,EAAE;IACzC,IAAI,GAAqB,CAAC;IAC1B,IAAI,MAAqB,CAAC;IAC1B,IAAI,SAAwB,CAAC;IAC7B,IAAI,QAAgB,CAAC;IACrB,IAAI,WAAmB,CAAC;IAExB,SAAS,CAAC,KAAK,IAAI,EAAE;QACnB,sBAAsB;QACtB,MAAM,GAAG,MAAM,uCAAiB,CAAC,iBAAiB,EAAE,CAAC;QAErD,SAAS,GAAG,MAAM,cAAI,CAAC,mBAAmB,CAAC;YACzC,OAAO,EAAE,CAAC,8BAAa,CAAC;YACxB,SAAS,EAAE;gBACT;oBACE,OAAO,EAAE,sCAAa;oBACtB,QAAQ,EAAE,MAAM;iBACjB;aACF;SACF,CAAC,CAAC,OAAO,EAAE,CAAC;QAEb,GAAG,GAAG,SAAS,CAAC,qBAAqB,EAAE,CAAC;QACxC,MAAM,GAAG,CAAC,IAAI,EAAE,CAAC;QAEjB,oBAAoB;QACpB,MAAM,cAAc,EAAE,CAAC;IACzB,CAAC,CAAC,CAAC;IAEH,SAAS,CAAC,KAAK,IAAI,EAAE;QACnB,gDAAgD;QAChD,MAAM,MAAM,CAAC,OAAO,CAAC,UAAU,EAAE,CAAC;IACpC,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,KAAK,IAAI,EAAE;QAClB,MAAM,uCAAiB,CAAC,aAAa,EAAE,CAAC;QACxC,MAAM,GAAG,CAAC,KAAK,EAAE,CAAC;QAClB,MAAM,SAAS,CAAC,KAAK,EAAE,CAAC;IAC1B,CAAC,CAAC,CAAC;IAEH,KAAK,UAAU,cAAc;QAC3B,qBAAqB;QACrB,MAAM,UAAU,GAAG,MAAM,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC;YAC1C,IAAI,EAAE;gBACJ,EAAE,EAAE,iBAAiB;gBACrB,KAAK,EAAE,iBAAiB;gBACxB,SAAS,EAAE,MAAM;gBACjB,QAAQ,EAAE,QAAQ;gBAClB,IAAI,EAAE,QAAQ;aACf;SACF,CAAC,CAAC;QACH,QAAQ,GAAG,UAAU,CAAC,EAAE,CAAC;QAEzB,MAAM,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC;YACzB,IAAI,EAAE;gBACJ,MAAM,EAAE,QAAQ;gBAChB,+BAA+B,EAAE,KAAK;aACvC;SACF,CAAC,CAAC;QAEH,wBAAwB;QACxB,MAAM,aAAa,GAAG,MAAM,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC;YAC7C,IAAI,EAAE;gBACJ,EAAE,EAAE,oBAAoB;gBACxB,SAAS,EAAE,MAAM;gBACjB,QAAQ,EAAE,WAAW;gBACrB,KAAK,EAAE,oBAAoB;gBAC3B,IAAI,EAAE,WAAW;aAClB;SACF,CAAC,CAAC;QACH,WAAW,GAAG,aAAa,CAAC,EAAE,CAAC;QAE/B,MAAM,MAAM,CAAC,SAAS,CAAC,MAAM,CAAC;YAC5B,IAAI,EAAE;gBACJ,MAAM,EAAE,WAAW;gBACnB,MAAM,EAAE,aAAa;gBACrB,QAAQ,EAAE,SAAS;gBACnB,YAAY,EAAE,uBAAuB;gBACrC,uBAAuB,EAAE,UAAU;gBACnC,aAAa,EAAE,KAAK;gBACpB,gBAAgB,EAAE,WAAW;gBAC7B,iBAAiB,EAAE,IAAI,IAAI,CAAC,YAAY,CAAC;gBACzC,iBAAiB,EAAE,CAAC;gBACpB,gBAAgB,EAAE,CAAC,SAAS,CAAC;gBAC7B,eAAe,EAAE,CAAC,OAAO,CAAC;gBAC1B,6BAA6B,EAAE,CAAC,KAAK,CAAC;gBACtC,gBAAgB,EAAE,CAAC,SAAS,CAAC;gBAC7B,2BAA2B,EAAE,IAAI;gBACjC,iCAAiC,EAAE,IAAI;gBACvC,sBAAsB,EAAE,CAAC,EAAE,CAAC;gBAC5B,WAAW,EAAE,CAAC,YAAY,CAAC;gBAC3B,MAAM,EAAE,UAAU;gBAClB,UAAU,EAAE,GAAG;gBACf,uBAAuB,EAAE,IAAI,IAAI,CAAC,YAAY,CAAC;gBAC/C,0BAA0B,EAAE,IAAI;gBAChC,kCAAkC,EAAE,IAAI;gBACxC,qBAAqB,EAAE,EAAE;gBACzB,aAAa,EAAE,YAAY;aAC5B;SACF,CAAC,CAAC;IACL,CAAC;IAED,QAAQ,CAAC,wBAAwB,EAAE,GAAG,EAAE;QACtC,EAAE,CAAC,0CAA0C,EAAE,KAAK,IAAI,EAAE;YACxD,MAAM,WAAW,GAAG;gBAClB,WAAW,EAAE,WAAW;gBACxB,SAAS,EAAE,IAAI,IAAI,CAAC,sBAAsB,CAAC,CAAC,WAAW,EAAE;gBACzD,QAAQ,EAAE,EAAE;gBACZ,WAAW,EAAE,YAAY;gBACzB,KAAK,EAAE,sBAAsB;aAC9B,CAAC;YAEF,MAAM,QAAQ,GAAG,MAAM,OAAO,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;iBAChD,IAAI,CAAC,mBAAmB,CAAC;iBACzB,GAAG,CAAC,WAAW,EAAE,QAAQ,CAAC;iBAC1B,IAAI,CAAC,WAAW,CAAC;iBACjB,MAAM,CAAC,GAAG,CAAC,CAAC;YAEf,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,aAAa,CAAC;gBAClC,OAAO,EAAE,IAAI;gBACb,IAAI,EAAE,MAAM,CAAC,gBAAgB,CAAC;oBAC5B,EAAE,EAAE,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC;oBACtB,QAAQ,EAAE,QAAQ;oBAClB,WAAW,EAAE,WAAW;oBACxB,MAAM,EAAE,sBAAa,CAAC,SAAS;oBAC/B,QAAQ,EAAE,EAAE;iBACb,CAAC;aACH,CAAC,CAAC;YAEH,qBAAqB;YACrB,MAAM,OAAO,GAAG,MAAM,MAAM,CAAC,OAAO,CAAC,SAAS,CAAC;gBAC7C,KAAK,EAAE,EAAE,QAAQ,EAAE,QAAQ,EAAE;aAC9B,CAAC,CAAC;YAEH,MAAM,CAAC,OAAO,CAAC,CAAC,UAAU,EAAE,CAAC;YAC7B,MAAM,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC,IAAI,CAAC,sBAAa,CAAC,SAAS,CAAC,CAAC;QACxD,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,0CAA0C,EAAE,KAAK,IAAI,EAAE;YACxD,MAAM,eAAe,GAAG;gBACtB,WAAW,EAAE,WAAW;gBACxB,SAAS,EAAE,IAAI,IAAI,CAAC,sBAAsB,CAAC,CAAC,WAAW,EAAE;gBACzD,QAAQ,EAAE,EAAE;gBACZ,WAAW,EAAE,YAAY;aAC1B,CAAC;YAEF,MAAM,OAAO,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;iBAC/B,IAAI,CAAC,mBAAmB,CAAC;iBACzB,GAAG,CAAC,WAAW,EAAE,QAAQ,CAAC;iBAC1B,IAAI,CAAC,eAAe,CAAC;iBACrB,MAAM,CAAC,GAAG,CAAC,CAAC;QACjB,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,+BAA+B,EAAE,KAAK,IAAI,EAAE;YAC7C,MAAM,WAAW,GAAG,IAAI,IAAI,CAAC,sBAAsB,CAAC,CAAC;YAErD,uBAAuB;YACvB,MAAM,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC;gBAC1B,IAAI,EAAE;oBACJ,EAAE,EAAE,WAAW;oBACf,QAAQ,EAAE,QAAQ;oBAClB,WAAW,EAAE,WAAW;oBACxB,SAAS,EAAE,WAAW;oBACtB,QAAQ,EAAE,EAAE;oBACZ,MAAM,EAAE,sBAAa,CAAC,SAAS;oBAC/B,WAAW,EAAE,YAAY;iBAC1B;aACF,CAAC,CAAC;YAEH,4CAA4C;YAC5C,MAAM,sBAAsB,GAAG;gBAC7B,WAAW,EAAE,WAAW;gBACxB,SAAS,EAAE,WAAW,CAAC,WAAW,EAAE;gBACpC,QAAQ,EAAE,EAAE;gBACZ,WAAW,EAAE,YAAY;aAC1B,CAAC;YAEF,MAAM,OAAO,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;iBAC/B,IAAI,CAAC,mBAAmB,CAAC;iBACzB,GAAG,CAAC,WAAW,EAAE,QAAQ,CAAC;iBAC1B,IAAI,CAAC,sBAAsB,CAAC;iBAC5B,MAAM,CAAC,GAAG,CAAC,CAAC;QACjB,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,uBAAuB,EAAE,GAAG,EAAE;QACrC,UAAU,CAAC,KAAK,IAAI,EAAE;YACpB,uBAAuB;YACvB,MAAM,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC;gBAC9B,IAAI,EAAE;oBACJ;wBACE,EAAE,EAAE,WAAW;wBACf,QAAQ,EAAE,QAAQ;wBAClB,WAAW,EAAE,WAAW;wBACxB,SAAS,EAAE,IAAI,IAAI,CAAC,sBAAsB,CAAC;wBAC3C,QAAQ,EAAE,EAAE;wBACZ,MAAM,EAAE,sBAAa,CAAC,SAAS;wBAC/B,WAAW,EAAE,YAAY;qBAC1B;oBACD;wBACE,EAAE,EAAE,WAAW;wBACf,QAAQ,EAAE,QAAQ;wBAClB,WAAW,EAAE,WAAW;wBACxB,SAAS,EAAE,IAAI,IAAI,CAAC,sBAAsB,CAAC;wBAC3C,QAAQ,EAAE,EAAE;wBACZ,MAAM,EAAE,sBAAa,CAAC,SAAS;wBAC/B,WAAW,EAAE,YAAY;qBAC1B;iBACF;aACF,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,+BAA+B,EAAE,KAAK,IAAI,EAAE;YAC7C,MAAM,QAAQ,GAAG,MAAM,OAAO,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;iBAChD,GAAG,CAAC,mBAAmB,CAAC;iBACxB,GAAG,CAAC,WAAW,EAAE,QAAQ,CAAC;iBAC1B,GAAG,CAAC,aAAa,EAAE,QAAQ,CAAC;iBAC5B,MAAM,CAAC,GAAG,CAAC,CAAC;YAEf,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACzC,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;YAC3C,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,OAAO,CAChC,MAAM,CAAC,eAAe,CAAC;gBACrB,MAAM,CAAC,gBAAgB,CAAC;oBACtB,EAAE,EAAE,WAAW;oBACf,MAAM,EAAE,sBAAa,CAAC,SAAS;iBAChC,CAAC;gBACF,MAAM,CAAC,gBAAgB,CAAC;oBACtB,EAAE,EAAE,WAAW;oBACf,MAAM,EAAE,sBAAa,CAAC,SAAS;iBAChC,CAAC;aACH,CAAC,CACH,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,kCAAkC,EAAE,KAAK,IAAI,EAAE;YAChD,MAAM,QAAQ,GAAG,MAAM,OAAO,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;iBAChD,GAAG,CAAC,mBAAmB,CAAC;iBACxB,GAAG,CAAC,WAAW,EAAE,WAAW,CAAC;iBAC7B,GAAG,CAAC,aAAa,EAAE,WAAW,CAAC;iBAC/B,MAAM,CAAC,GAAG,CAAC,CAAC;YAEf,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACzC,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;QAC7C,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,mDAAmD,EAAE,KAAK,IAAI,EAAE;YACjE,MAAM,QAAQ,GAAG,MAAM,OAAO,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;iBAChD,GAAG,CAAC,mBAAmB,CAAC;iBACxB,GAAG,CAAC,WAAW,EAAE,mBAAmB,CAAC;iBACrC,GAAG,CAAC,aAAa,EAAE,QAAQ,CAAC;iBAC5B,MAAM,CAAC,GAAG,CAAC,CAAC;YAEf,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;QAC7C,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,2BAA2B,EAAE,GAAG,EAAE;QACzC,IAAI,SAAiB,CAAC;QAEtB,UAAU,CAAC,KAAK,IAAI,EAAE;YACpB,MAAM,OAAO,GAAG,MAAM,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC;gBAC1C,IAAI,EAAE;oBACJ,EAAE,EAAE,qBAAqB;oBACzB,QAAQ,EAAE,QAAQ;oBAClB,WAAW,EAAE,WAAW;oBACxB,SAAS,EAAE,IAAI,IAAI,CAAC,sBAAsB,CAAC;oBAC3C,QAAQ,EAAE,EAAE;oBACZ,MAAM,EAAE,sBAAa,CAAC,SAAS;oBAC/B,WAAW,EAAE,YAAY;oBACzB,WAAW,EAAE,oBAAoB;iBAClC;aACF,CAAC,CAAC;YACH,SAAS,GAAG,OAAO,CAAC,EAAE,CAAC;QACzB,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,0CAA0C,EAAE,KAAK,IAAI,EAAE;YACxD,MAAM,QAAQ,GAAG,MAAM,OAAO,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;iBAChD,GAAG,CAAC,qBAAqB,SAAS,EAAE,CAAC;iBACrC,GAAG,CAAC,WAAW,EAAE,QAAQ,CAAC;iBAC1B,GAAG,CAAC,aAAa,EAAE,QAAQ,CAAC;iBAC5B,MAAM,CAAC,GAAG,CAAC,CAAC;YAEf,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,aAAa,CAAC;gBAClC,OAAO,EAAE,IAAI;gBACb,IAAI,EAAE,MAAM,CAAC,gBAAgB,CAAC;oBAC5B,EAAE,EAAE,SAAS;oBACb,QAAQ,EAAE,QAAQ;oBAClB,WAAW,EAAE,WAAW;oBACxB,WAAW,EAAE,oBAAoB;iBAClC,CAAC;aACH,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,6CAA6C,EAAE,KAAK,IAAI,EAAE;YAC3D,MAAM,QAAQ,GAAG,MAAM,OAAO,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;iBAChD,GAAG,CAAC,qBAAqB,SAAS,EAAE,CAAC;iBACrC,GAAG,CAAC,WAAW,EAAE,WAAW,CAAC;iBAC7B,GAAG,CAAC,aAAa,EAAE,WAAW,CAAC;iBAC/B,MAAM,CAAC,GAAG,CAAC,CAAC;YAEf,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACzC,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QAChD,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,mCAAmC,EAAE,KAAK,IAAI,EAAE;YACjD,MAAM,OAAO,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;iBAC/B,GAAG,CAAC,qBAAqB,SAAS,EAAE,CAAC;iBACrC,GAAG,CAAC,WAAW,EAAE,mBAAmB,CAAC;iBACrC,GAAG,CAAC,aAAa,EAAE,QAAQ,CAAC;iBAC5B,MAAM,CAAC,GAAG,CAAC,CAAC;QACjB,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,oCAAoC,EAAE,KAAK,IAAI,EAAE;YAClD,MAAM,OAAO,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;iBAC/B,GAAG,CAAC,mCAAmC,CAAC;iBACxC,GAAG,CAAC,WAAW,EAAE,QAAQ,CAAC;iBAC1B,GAAG,CAAC,aAAa,EAAE,QAAQ,CAAC;iBAC5B,MAAM,CAAC,GAAG,CAAC,CAAC;QACjB,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,2BAA2B,EAAE,GAAG,EAAE;QACzC,IAAI,SAAiB,CAAC;QAEtB,UAAU,CAAC,KAAK,IAAI,EAAE;YACpB,MAAM,OAAO,GAAG,MAAM,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC;gBAC1C,IAAI,EAAE;oBACJ,EAAE,EAAE,qBAAqB;oBACzB,QAAQ,EAAE,QAAQ;oBAClB,WAAW,EAAE,WAAW;oBACxB,SAAS,EAAE,IAAI,IAAI,CAAC,sBAAsB,CAAC;oBAC3C,QAAQ,EAAE,EAAE;oBACZ,MAAM,EAAE,sBAAa,CAAC,SAAS;oBAC/B,WAAW,EAAE,YAAY;iBAC1B;aACF,CAAC,CAAC;YACH,SAAS,GAAG,OAAO,CAAC,EAAE,CAAC;QACzB,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,oCAAoC,EAAE,KAAK,IAAI,EAAE;YAClD,MAAM,UAAU,GAAG;gBACjB,SAAS,EAAE,IAAI,IAAI,CAAC,sBAAsB,CAAC,CAAC,WAAW,EAAE;gBACzD,KAAK,EAAE,eAAe;aACvB,CAAC;YAEF,MAAM,QAAQ,GAAG,MAAM,OAAO,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;iBAChD,GAAG,CAAC,qBAAqB,SAAS,EAAE,CAAC;iBACrC,GAAG,CAAC,WAAW,EAAE,QAAQ,CAAC;iBAC1B,GAAG,CAAC,aAAa,EAAE,QAAQ,CAAC;iBAC5B,IAAI,CAAC,UAAU,CAAC;iBAChB,MAAM,CAAC,GAAG,CAAC,CAAC;YAEf,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACzC,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;YAE7D,qBAAqB;YACrB,MAAM,cAAc,GAAG,MAAM,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC;gBACrD,KAAK,EAAE,EAAE,EAAE,EAAE,SAAS,EAAE;aACzB,CAAC,CAAC;YAEH,MAAM,CAAC,cAAc,EAAE,WAAW,CAAC,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;QAC5D,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,uCAAuC,EAAE,KAAK,IAAI,EAAE;YACrD,sBAAsB;YACtB,MAAM,WAAW,GAAG,MAAM,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC;gBAC9C,IAAI,EAAE;oBACJ,EAAE,EAAE,cAAc;oBAClB,QAAQ,EAAE,QAAQ;oBAClB,WAAW,EAAE,WAAW;oBACxB,SAAS,EAAE,IAAI,IAAI,CAAC,sBAAsB,CAAC;oBAC3C,QAAQ,EAAE,EAAE;oBACZ,MAAM,EAAE,sBAAa,CAAC,SAAS;oBAC/B,WAAW,EAAE,YAAY;iBAC1B;aACF,CAAC,CAAC;YAEH,MAAM,UAAU,GAAG;gBACjB,KAAK,EAAE,mBAAmB;aAC3B,CAAC;YAEF,MAAM,OAAO,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;iBAC/B,GAAG,CAAC,qBAAqB,WAAW,CAAC,EAAE,EAAE,CAAC;iBAC1C,GAAG,CAAC,WAAW,EAAE,QAAQ,CAAC;iBAC1B,GAAG,CAAC,aAAa,EAAE,QAAQ,CAAC;iBAC5B,IAAI,CAAC,UAAU,CAAC;iBAChB,MAAM,CAAC,GAAG,CAAC,CAAC;QACjB,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,qCAAqC,EAAE,GAAG,EAAE;QACnD,IAAI,SAAiB,CAAC;QAEtB,UAAU,CAAC,KAAK,IAAI,EAAE;YACpB,MAAM,OAAO,GAAG,MAAM,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC;gBAC1C,IAAI,EAAE;oBACJ,EAAE,EAAE,qBAAqB;oBACzB,QAAQ,EAAE,QAAQ;oBAClB,WAAW,EAAE,WAAW;oBACxB,SAAS,EAAE,IAAI,IAAI,CAAC,sBAAsB,CAAC;oBAC3C,QAAQ,EAAE,EAAE;oBACZ,MAAM,EAAE,sBAAa,CAAC,SAAS;oBAC/B,WAAW,EAAE,YAAY;iBAC1B;aACF,CAAC,CAAC;YACH,SAAS,GAAG,OAAO,CAAC,EAAE,CAAC;QACzB,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,oCAAoC,EAAE,KAAK,IAAI,EAAE;YAClD,MAAM,QAAQ,GAAG,MAAM,OAAO,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;iBAChD,MAAM,CAAC,qBAAqB,SAAS,SAAS,CAAC;iBAC/C,GAAG,CAAC,WAAW,EAAE,QAAQ,CAAC;iBAC1B,GAAG,CAAC,aAAa,EAAE,QAAQ,CAAC;iBAC5B,MAAM,CAAC,GAAG,CAAC,CAAC;YAEf,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACzC,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,sBAAa,CAAC,SAAS,CAAC,CAAC;YAEhE,qBAAqB;YACrB,MAAM,gBAAgB,GAAG,MAAM,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC;gBACvD,KAAK,EAAE,EAAE,EAAE,EAAE,SAAS,EAAE;aACzB,CAAC,CAAC;YAEH,MAAM,CAAC,gBAAgB,EAAE,MAAM,CAAC,CAAC,IAAI,CAAC,sBAAa,CAAC,SAAS,CAAC,CAAC;QACjE,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,sDAAsD,EAAE,KAAK,IAAI,EAAE;YACpE,qBAAqB;YACrB,MAAM,OAAO,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;iBAC/B,MAAM,CAAC,qBAAqB,SAAS,SAAS,CAAC;iBAC/C,GAAG,CAAC,WAAW,EAAE,QAAQ,CAAC;iBAC1B,GAAG,CAAC,aAAa,EAAE,QAAQ,CAAC;iBAC5B,MAAM,CAAC,GAAG,CAAC,CAAC;YAEf,8BAA8B;YAC9B,MAAM,OAAO,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;iBAC/B,MAAM,CAAC,qBAAqB,SAAS,SAAS,CAAC;iBAC/C,GAAG,CAAC,WAAW,EAAE,QAAQ,CAAC;iBAC1B,GAAG,CAAC,aAAa,EAAE,QAAQ,CAAC;iBAC5B,MAAM,CAAC,GAAG,CAAC,CAAC;QACjB,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,sBAAsB,EAAE,GAAG,EAAE;QACpC,UAAU,CAAC,KAAK,IAAI,EAAE;YACpB,mDAAmD;YACnD,MAAM,QAAQ,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC;gBACrD,EAAE,EAAE,gBAAgB,CAAC,EAAE;gBACvB,QAAQ,EAAE,QAAQ;gBAClB,WAAW,EAAE,WAAW;gBACxB,SAAS,EAAE,IAAI,IAAI,CACjB,WAAW,MAAM,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC,YAAY,CAC7D;gBACD,QAAQ,EAAE,EAAE;gBACZ,MAAM,EAAE,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,sBAAa,CAAC,SAAS,CAAC,CAAC,CAAC,sBAAa,CAAC,SAAS;gBACvE,WAAW,EAAE,YAAqB;aACnC,CAAC,CAAC,CAAC;YAEJ,MAAM,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC,CAAC;QACtD,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,0CAA0C,EAAE,KAAK,IAAI,EAAE;YACxD,MAAM,SAAS,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;YAE7B,MAAM,QAAQ,GAAG,MAAM,OAAO,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;iBAChD,GAAG,CAAC,mBAAmB,CAAC;iBACxB,GAAG,CAAC,WAAW,EAAE,QAAQ,CAAC;iBAC1B,GAAG,CAAC,aAAa,EAAE,QAAQ,CAAC;iBAC5B,MAAM,CAAC,GAAG,CAAC,CAAC;YAEf,MAAM,OAAO,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;YAC3B,MAAM,QAAQ,GAAG,OAAO,GAAG,SAAS,CAAC;YAErC,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC;YAC5C,MAAM,CAAC,QAAQ,CAAC,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,CAAC,kCAAkC;QACzE,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,+CAA+C,EAAE,KAAK,IAAI,EAAE;YAC7D,MAAM,SAAS,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;YAE7B,8BAA8B;YAC9B,MAAM,iBAAiB,GAAG,MAAM,MAAM,CAAC,OAAO,CAAC,QAAQ,CAAC;gBACtD,KAAK,EAAE;oBACL,QAAQ,EAAE,QAAQ;oBAClB,MAAM,EAAE,sBAAa,CAAC,SAAS;iBAChC;gBACD,OAAO,EAAE,EAAE,SAAS,EAAE,KAAK,EAAE;aAC9B,CAAC,CAAC;YAEH,MAAM,OAAO,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;YAC3B,MAAM,QAAQ,GAAG,OAAO,GAAG,SAAS,CAAC;YAErC,MAAM,CAAC,iBAAiB,CAAC,MAAM,CAAC,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC;YACpD,MAAM,CAAC,QAAQ,CAAC,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC,CAAC,+BAA+B;QACrE,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,uBAAuB,EAAE,GAAG,EAAE;QACrC,EAAE,CAAC,4CAA4C,EAAE,KAAK,IAAI,EAAE;YAC1D,MAAM,eAAe,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CACzD,OAAO,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;iBACzB,IAAI,CAAC,mBAAmB,CAAC;iBACzB,GAAG,CAAC,WAAW,EAAE,QAAQ,CAAC;iBAC1B,IAAI,CAAC;gBACJ,WAAW,EAAE,WAAW;gBACxB,SAAS,EAAE,IAAI,IAAI,CAAC,WAAW,CAAC,GAAG,EAAE,YAAY,CAAC,CAAC,WAAW,EAAE;gBAChE,QAAQ,EAAE,EAAE;gBACZ,WAAW,EAAE,YAAY;aAC1B,CAAC,CACL,CAAC;YAEF,MAAM,OAAO,GAAG,MAAM,OAAO,CAAC,UAAU,CAAC,eAAe,CAAC,CAAC;YAC1D,MAAM,UAAU,GAAG,OAAO,CAAC,MAAM,CAC/B,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,MAAM,KAAK,WAAW,IAAK,CAAC,CAAC,KAAa,CAAC,MAAM,KAAK,GAAG,CACnE,CAAC;YAEF,MAAM,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,2CAA2C;QAChF,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,yCAAyC,EAAE,KAAK,IAAI,EAAE;YACvD,6BAA6B;YAC7B,MAAM,OAAO,GAAG,MAAM,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC;gBAC1C,IAAI,EAAE;oBACJ,EAAE,EAAE,wBAAwB;oBAC5B,QAAQ,EAAE,QAAQ;oBAClB,WAAW,EAAE,WAAW;oBACxB,SAAS,EAAE,IAAI,IAAI,CAAC,sBAAsB,CAAC;oBAC3C,QAAQ,EAAE,EAAE;oBACZ,MAAM,EAAE,sBAAa,CAAC,SAAS;oBAC/B,WAAW,EAAE,YAAY;iBAC1B;aACF,CAAC,CAAC;YAEH,6BAA6B;YAC7B,MAAM,cAAc,GAAG;gBACrB,OAAO,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;qBACzB,GAAG,CAAC,qBAAqB,OAAO,CAAC,EAAE,EAAE,CAAC;qBACtC,GAAG,CAAC,WAAW,EAAE,QAAQ,CAAC;qBAC1B,GAAG,CAAC,aAAa,EAAE,QAAQ,CAAC;qBAC5B,IAAI,CAAC,EAAE,KAAK,EAAE,UAAU,EAAE,CAAC;gBAC9B,OAAO,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;qBACzB,GAAG,CAAC,qBAAqB,OAAO,CAAC,EAAE,EAAE,CAAC;qBACtC,GAAG,CAAC,WAAW,EAAE,WAAW,CAAC;qBAC7B,GAAG,CAAC,aAAa,EAAE,WAAW,CAAC;qBAC/B,IAAI,CAAC,EAAE,KAAK,EAAE,UAAU,EAAE,CAAC;aAC/B,CAAC;YAEF,MAAM,OAAO,GAAG,MAAM,OAAO,CAAC,UAAU,CAAC,cAAc,CAAC,CAAC;YACzD,MAAM,UAAU,GAAG,OAAO,CAAC,MAAM,CAC/B,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,MAAM,KAAK,WAAW,IAAK,CAAC,CAAC,KAAa,CAAC,MAAM,KAAK,GAAG,CACnE,CAAC;YAEF,MAAM,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC,CAAC,8BAA8B;YAEnF,mCAAmC;YACnC,MAAM,YAAY,GAAG,MAAM,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC;gBACnD,KAAK,EAAE,EAAE,EAAE,EAAE,OAAO,CAAC,EAAE,EAAE;aAC1B,CAAC,CAAC;YAEH,MAAM,CAAC,YAAY,EAAE,WAAW,CAAC,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC;QAC3D,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","names":[],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/test-utils/integration-tests/booking.integration.spec.ts"],"sourcesContent":["import { Test, TestingModule } from '@nestjs/testing';\nimport { INestApplication } from '@nestjs/common';\nimport * as request from 'supertest';\nimport { PrismaService } from '../../providers/prisma-client.provider';\nimport { BookingModule } from '../../booking/booking.module';\nimport { MeetingStatus } from '@prisma/client';\nimport { DatabaseTestSetup } from '../database-test.setup';\n\ndescribe('Booking Integration Tests', () => {\n  let app: INestApplication;\n  let prisma: PrismaService;\n  let moduleRef: TestingModule;\n  let clientId: string;\n  let therapistId: string;\n\n  beforeAll(async () => {\n    // Setup test database\n    prisma = await DatabaseTestSetup.setupTestDatabase();\n\n    moduleRef = await Test.createTestingModule({\n      imports: [BookingModule],\n      providers: [\n        {\n          provide: PrismaService,\n          useValue: prisma,\n        },\n      ],\n    }).compile();\n\n    app = moduleRef.createNestApplication();\n    await app.init();\n\n    // Create test users\n    await setupTestUsers();\n  });\n\n  afterEach(async () => {\n    // Clean meetings after each test but keep users\n    await prisma.meeting.deleteMany();\n  });\n\n  afterAll(async () => {\n    await DatabaseTestSetup.stopContainer();\n    await app.close();\n    await moduleRef.close();\n  });\n\n  async function setupTestUsers() {\n    // Create client user\n    const clientUser = await prisma.user.create({\n      data: {\n        id: 'client-test-123',\n        email: 'client@test.com',\n        firstName: 'Test',\n        lastName: 'Client',\n        role: 'client',\n      },\n    });\n    clientId = clientUser.id;\n\n    await prisma.client.create({\n      data: {\n        userId: clientId,\n        hasSeenTherapistRecommendations: false,\n      },\n    });\n\n    // Create therapist user\n    const therapistUser = await prisma.user.create({\n      data: {\n        id: 'therapist-test-123',\n        firstName: 'Test',\n        lastName: 'Therapist',\n        email: 'therapist@test.com',\n        role: 'therapist',\n      },\n    });\n    therapistId = therapistUser.id;\n\n    await prisma.therapist.create({\n      data: {\n        userId: therapistId,\n        mobile: '+1234567890',\n        province: 'Ontario',\n        providerType: 'Clinical Psychologist',\n        professionalLicenseType: 'Licensed',\n        isPRCLicensed: 'yes',\n        prcLicenseNumber: 'PRC123456',\n        practiceStartDate: new Date('2020-01-01'),\n        yearsOfExperience: 5,\n        areasOfExpertise: ['Anxiety'],\n        assessmentTools: ['PHQ-9'],\n        therapeuticApproachesUsedList: ['CBT'],\n        languagesOffered: ['English'],\n        providedOnlineTherapyBefore: true,\n        comfortableUsingVideoConferencing: true,\n        preferredSessionLength: [60],\n        acceptTypes: ['Individual'],\n        status: 'APPROVED',\n        hourlyRate: 150,\n        expirationDateOfLicense: new Date('2025-01-01'),\n        compliesWithDataPrivacyAct: true,\n        willingToAbideByPlatformGuidelines: true,\n        treatmentSuccessRates: {},\n        sessionLength: '60 minutes',\n      },\n    });\n  }\n\n  describe('POST /booking/meetings', () => {\n    it('should create a new meeting successfully', async () => {\n      const meetingData = {\n        therapistId: therapistId,\n        startTime: new Date('2024-12-01T10:00:00Z').toISOString(),\n        duration: 60,\n        meetingType: 'INDIVIDUAL',\n        notes: 'Initial consultation',\n      };\n\n      const response = await request(app.getHttpServer())\n        .post('/booking/meetings')\n        .set('x-user-id', clientId)\n        .send(meetingData)\n        .expect(201);\n\n      expect(response.body).toMatchObject({\n        success: true,\n        data: expect.objectContaining({\n          id: expect.any(String),\n          clientId: clientId,\n          therapistId: therapistId,\n          status: MeetingStatus.SCHEDULED,\n          duration: 60,\n        }),\n      });\n\n      // Verify in database\n      const meeting = await prisma.meeting.findFirst({\n        where: { clientId: clientId },\n      });\n\n      expect(meeting).toBeTruthy();\n      expect(meeting?.status).toBe(MeetingStatus.SCHEDULED);\n    });\n\n    it('should validate meeting time constraints', async () => {\n      const pastMeetingData = {\n        therapistId: therapistId,\n        startTime: new Date('2020-01-01T10:00:00Z').toISOString(),\n        duration: 60,\n        meetingType: 'INDIVIDUAL',\n      };\n\n      await request(app.getHttpServer())\n        .post('/booking/meetings')\n        .set('x-user-id', clientId)\n        .send(pastMeetingData)\n        .expect(400);\n    });\n\n    it('should prevent double booking', async () => {\n      const meetingTime = new Date('2024-12-01T10:00:00Z');\n\n      // Create first meeting\n      await prisma.meeting.create({\n        data: {\n          id: 'meeting-1',\n          clientId: clientId,\n          therapistId: therapistId,\n          startTime: meetingTime,\n          duration: 60,\n          status: MeetingStatus.SCHEDULED,\n          meetingType: 'INDIVIDUAL',\n        },\n      });\n\n      // Try to create second meeting at same time\n      const conflictingMeetingData = {\n        therapistId: therapistId,\n        startTime: meetingTime.toISOString(),\n        duration: 60,\n        meetingType: 'INDIVIDUAL',\n      };\n\n      await request(app.getHttpServer())\n        .post('/booking/meetings')\n        .set('x-user-id', clientId)\n        .send(conflictingMeetingData)\n        .expect(400);\n    });\n  });\n\n  describe('GET /booking/meetings', () => {\n    beforeEach(async () => {\n      // Create test meetings\n      await prisma.meeting.createMany({\n        data: [\n          {\n            id: 'meeting-1',\n            clientId: clientId,\n            therapistId: therapistId,\n            startTime: new Date('2024-12-01T10:00:00Z'),\n            duration: 60,\n            status: MeetingStatus.SCHEDULED,\n            meetingType: 'INDIVIDUAL',\n          },\n          {\n            id: 'meeting-2',\n            clientId: clientId,\n            therapistId: therapistId,\n            startTime: new Date('2024-12-02T14:00:00Z'),\n            duration: 60,\n            status: MeetingStatus.COMPLETED,\n            meetingType: 'INDIVIDUAL',\n          },\n        ],\n      });\n    });\n\n    it('should return client meetings', async () => {\n      const response = await request(app.getHttpServer())\n        .get('/booking/meetings')\n        .set('x-user-id', clientId)\n        .set('x-user-role', 'client')\n        .expect(200);\n\n      expect(response.body.success).toBe(true);\n      expect(response.body.data).toHaveLength(2);\n      expect(response.body.data).toEqual(\n        expect.arrayContaining([\n          expect.objectContaining({\n            id: 'meeting-1',\n            status: MeetingStatus.SCHEDULED,\n          }),\n          expect.objectContaining({\n            id: 'meeting-2',\n            status: MeetingStatus.COMPLETED,\n          }),\n        ]),\n      );\n    });\n\n    it('should return therapist meetings', async () => {\n      const response = await request(app.getHttpServer())\n        .get('/booking/meetings')\n        .set('x-user-id', therapistId)\n        .set('x-user-role', 'therapist')\n        .expect(200);\n\n      expect(response.body.success).toBe(true);\n      expect(response.body.data).toHaveLength(2);\n    });\n\n    it('should not return meetings for unauthorized users', async () => {\n      const response = await request(app.getHttpServer())\n        .get('/booking/meetings')\n        .set('x-user-id', 'unauthorized-user')\n        .set('x-user-role', 'client')\n        .expect(200);\n\n      expect(response.body.data).toHaveLength(0);\n    });\n  });\n\n  describe('GET /booking/meetings/:id', () => {\n    let meetingId: string;\n\n    beforeEach(async () => {\n      const meeting = await prisma.meeting.create({\n        data: {\n          id: 'test-meeting-detail',\n          clientId: clientId,\n          therapistId: therapistId,\n          startTime: new Date('2024-12-01T10:00:00Z'),\n          duration: 60,\n          status: MeetingStatus.SCHEDULED,\n          meetingType: 'INDIVIDUAL',\n          description: 'Test meeting notes',\n        },\n      });\n      meetingId = meeting.id;\n    });\n\n    it('should return meeting details for client', async () => {\n      const response = await request(app.getHttpServer())\n        .get(`/booking/meetings/${meetingId}`)\n        .set('x-user-id', clientId)\n        .set('x-user-role', 'client')\n        .expect(200);\n\n      expect(response.body).toMatchObject({\n        success: true,\n        data: expect.objectContaining({\n          id: meetingId,\n          clientId: clientId,\n          therapistId: therapistId,\n          description: 'Test meeting notes',\n        }),\n      });\n    });\n\n    it('should return meeting details for therapist', async () => {\n      const response = await request(app.getHttpServer())\n        .get(`/booking/meetings/${meetingId}`)\n        .set('x-user-id', therapistId)\n        .set('x-user-role', 'therapist')\n        .expect(200);\n\n      expect(response.body.success).toBe(true);\n      expect(response.body.data.id).toBe(meetingId);\n    });\n\n    it('should reject unauthorized access', async () => {\n      await request(app.getHttpServer())\n        .get(`/booking/meetings/${meetingId}`)\n        .set('x-user-id', 'unauthorized-user')\n        .set('x-user-role', 'client')\n        .expect(403);\n    });\n\n    it('should handle non-existent meeting', async () => {\n      await request(app.getHttpServer())\n        .get('/booking/meetings/non-existent-id')\n        .set('x-user-id', clientId)\n        .set('x-user-role', 'client')\n        .expect(404);\n    });\n  });\n\n  describe('PUT /booking/meetings/:id', () => {\n    let meetingId: string;\n\n    beforeEach(async () => {\n      const meeting = await prisma.meeting.create({\n        data: {\n          id: 'test-meeting-update',\n          clientId: clientId,\n          therapistId: therapistId,\n          startTime: new Date('2024-12-01T10:00:00Z'),\n          duration: 60,\n          status: MeetingStatus.SCHEDULED,\n          meetingType: 'INDIVIDUAL',\n        },\n      });\n      meetingId = meeting.id;\n    });\n\n    it('should update meeting successfully', async () => {\n      const updateData = {\n        startTime: new Date('2024-12-01T14:00:00Z').toISOString(),\n        notes: 'Updated notes',\n      };\n\n      const response = await request(app.getHttpServer())\n        .put(`/booking/meetings/${meetingId}`)\n        .set('x-user-id', clientId)\n        .set('x-user-role', 'client')\n        .send(updateData)\n        .expect(200);\n\n      expect(response.body.success).toBe(true);\n      expect(response.body.data.description).toBe('Updated notes');\n\n      // Verify in database\n      const updatedMeeting = await prisma.meeting.findUnique({\n        where: { id: meetingId },\n      });\n\n      expect(updatedMeeting?.description).toBe('Updated notes');\n    });\n\n    it('should prevent updating past meetings', async () => {\n      // Create past meeting\n      const pastMeeting = await prisma.meeting.create({\n        data: {\n          id: 'past-meeting',\n          clientId: clientId,\n          therapistId: therapistId,\n          startTime: new Date('2020-01-01T10:00:00Z'),\n          duration: 60,\n          status: MeetingStatus.COMPLETED,\n          meetingType: 'INDIVIDUAL',\n        },\n      });\n\n      const updateData = {\n        notes: 'Should not update',\n      };\n\n      await request(app.getHttpServer())\n        .put(`/booking/meetings/${pastMeeting.id}`)\n        .set('x-user-id', clientId)\n        .set('x-user-role', 'client')\n        .send(updateData)\n        .expect(400);\n    });\n  });\n\n  describe('DELETE /booking/meetings/:id/cancel', () => {\n    let meetingId: string;\n\n    beforeEach(async () => {\n      const meeting = await prisma.meeting.create({\n        data: {\n          id: 'test-meeting-cancel',\n          clientId: clientId,\n          therapistId: therapistId,\n          startTime: new Date('2024-12-01T10:00:00Z'),\n          duration: 60,\n          status: MeetingStatus.SCHEDULED,\n          meetingType: 'INDIVIDUAL',\n        },\n      });\n      meetingId = meeting.id;\n    });\n\n    it('should cancel meeting successfully', async () => {\n      const response = await request(app.getHttpServer())\n        .delete(`/booking/meetings/${meetingId}/cancel`)\n        .set('x-user-id', clientId)\n        .set('x-user-role', 'client')\n        .expect(200);\n\n      expect(response.body.success).toBe(true);\n      expect(response.body.data.status).toBe(MeetingStatus.CANCELLED);\n\n      // Verify in database\n      const cancelledMeeting = await prisma.meeting.findUnique({\n        where: { id: meetingId },\n      });\n\n      expect(cancelledMeeting?.status).toBe(MeetingStatus.CANCELLED);\n    });\n\n    it('should prevent cancelling already cancelled meetings', async () => {\n      // First cancellation\n      await request(app.getHttpServer())\n        .delete(`/booking/meetings/${meetingId}/cancel`)\n        .set('x-user-id', clientId)\n        .set('x-user-role', 'client')\n        .expect(200);\n\n      // Second cancellation attempt\n      await request(app.getHttpServer())\n        .delete(`/booking/meetings/${meetingId}/cancel`)\n        .set('x-user-id', clientId)\n        .set('x-user-role', 'client')\n        .expect(400);\n    });\n  });\n\n  describe('Database Performance', () => {\n    beforeEach(async () => {\n      // Create multiple meetings for performance testing\n      const meetings = Array.from({ length: 50 }, (_, i) => ({\n        id: `perf-meeting-${i}`,\n        clientId: clientId,\n        therapistId: therapistId,\n        startTime: new Date(\n          `2024-12-${String((i % 28) + 1).padStart(2, '0')}T10:00:00Z`,\n        ),\n        duration: 60,\n        status: i % 3 === 0 ? MeetingStatus.COMPLETED : MeetingStatus.SCHEDULED,\n        meetingType: 'INDIVIDUAL' as const,\n      }));\n\n      await prisma.meeting.createMany({ data: meetings });\n    });\n\n    it('should handle large datasets efficiently', async () => {\n      const startTime = Date.now();\n\n      const response = await request(app.getHttpServer())\n        .get('/booking/meetings')\n        .set('x-user-id', clientId)\n        .set('x-user-role', 'client')\n        .expect(200);\n\n      const endTime = Date.now();\n      const duration = endTime - startTime;\n\n      expect(response.body.data).toHaveLength(50);\n      expect(duration).toBeLessThan(1000); // Should complete within 1 second\n    });\n\n    it('should perform efficient queries with filters', async () => {\n      const startTime = Date.now();\n\n      // Get only scheduled meetings\n      const scheduledMeetings = await prisma.meeting.findMany({\n        where: {\n          clientId: clientId,\n          status: MeetingStatus.SCHEDULED,\n        },\n        orderBy: { startTime: 'asc' },\n      });\n\n      const endTime = Date.now();\n      const duration = endTime - startTime;\n\n      expect(scheduledMeetings.length).toBeGreaterThan(0);\n      expect(duration).toBeLessThan(500); // Should complete within 500ms\n    });\n  });\n\n  describe('Concurrent Operations', () => {\n    it('should handle concurrent meeting creations', async () => {\n      const meetingPromises = Array.from({ length: 5 }, (_, i) =>\n        request(app.getHttpServer())\n          .post('/booking/meetings')\n          .set('x-user-id', clientId)\n          .send({\n            therapistId: therapistId,\n            startTime: new Date(`2024-12-${i + 10}T10:00:00Z`).toISOString(),\n            duration: 60,\n            meetingType: 'INDIVIDUAL',\n          }),\n      );\n\n      const results = await Promise.allSettled(meetingPromises);\n      const successful = results.filter(\n        (r) => r.status === 'fulfilled' && (r.value as any).status === 201,\n      );\n\n      expect(successful.length).toBe(5); // All should succeed since different times\n    });\n\n    it('should handle concurrent updates safely', async () => {\n      // Create a meeting to update\n      const meeting = await prisma.meeting.create({\n        data: {\n          id: 'concurrent-update-test',\n          clientId: clientId,\n          therapistId: therapistId,\n          startTime: new Date('2024-12-01T10:00:00Z'),\n          duration: 60,\n          status: MeetingStatus.SCHEDULED,\n          meetingType: 'INDIVIDUAL',\n        },\n      });\n\n      // Attempt concurrent updates\n      const updatePromises = [\n        request(app.getHttpServer())\n          .put(`/booking/meetings/${meeting.id}`)\n          .set('x-user-id', clientId)\n          .set('x-user-role', 'client')\n          .send({ notes: 'Update 1' }),\n        request(app.getHttpServer())\n          .put(`/booking/meetings/${meeting.id}`)\n          .set('x-user-id', therapistId)\n          .set('x-user-role', 'therapist')\n          .send({ notes: 'Update 2' }),\n      ];\n\n      const results = await Promise.allSettled(updatePromises);\n      const successful = results.filter(\n        (r) => r.status === 'fulfilled' && (r.value as any).status === 200,\n      );\n\n      expect(successful.length).toBeGreaterThanOrEqual(1); // At least one should succeed\n\n      // Verify final state is consistent\n      const finalMeeting = await prisma.meeting.findUnique({\n        where: { id: meeting.id },\n      });\n\n      expect(finalMeeting?.description).toMatch(/Update [12]/);\n    });\n  });\n});\n"],"version":3}