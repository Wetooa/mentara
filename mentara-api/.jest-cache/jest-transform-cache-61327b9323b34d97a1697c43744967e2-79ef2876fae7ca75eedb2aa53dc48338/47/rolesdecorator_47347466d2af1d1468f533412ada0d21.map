{"version":3,"names":["cov_ttbncxvus","actualCoverage","s","common_1","require","exports","ROLES_KEY","Roles","roles","f","SetMetadata","AdminOnly","ModeratorOrAdmin","TherapistOrAdmin","ClientOnly","PERMISSIONS_KEY","RequirePermissions","permissions","RESOURCE_OWNER_KEY","AllowResourceOwner","paramName","b","AdminOrResourceOwner","target","propertyKey","descriptor","TherapistOrResourceOwner","TherapySessionAccess","AssessmentAccess","ModerationAccess"],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/auth/decorators/roles.decorator.ts"],"sourcesContent":["import { SetMetadata } from '@nestjs/common';\n\n// Role-based decorators\nexport const ROLES_KEY = 'roles';\nexport const Roles = (...roles: string[]) => SetMetadata(ROLES_KEY, roles);\n\n// Specific role decorators for convenience\nexport const AdminOnly = () => SetMetadata(ROLES_KEY, ['admin']);\nexport const ModeratorOrAdmin = () =>\n  SetMetadata(ROLES_KEY, ['moderator', 'admin']);\nexport const TherapistOrAdmin = () =>\n  SetMetadata(ROLES_KEY, ['therapist', 'admin']);\nexport const ClientOnly = () => SetMetadata(ROLES_KEY, ['client']);\n\n// Permission-based decorators\nexport const PERMISSIONS_KEY = 'permissions';\nexport const RequirePermissions = (...permissions: string[]) =>\n  SetMetadata(PERMISSIONS_KEY, permissions);\n\n// Resource ownership decorator\nexport const RESOURCE_OWNER_KEY = 'resource_owner';\nexport const AllowResourceOwner = (paramName: string = 'id') =>\n  SetMetadata(RESOURCE_OWNER_KEY, paramName);\n\n// Combined decorators for common scenarios\nexport const AdminOrResourceOwner =\n  (paramName: string = 'id') =>\n  (target: any, propertyKey: string, descriptor: PropertyDescriptor) => {\n    SetMetadata(ROLES_KEY, ['admin'])(target, propertyKey, descriptor);\n    SetMetadata(RESOURCE_OWNER_KEY, paramName)(target, propertyKey, descriptor);\n  };\n\nexport const TherapistOrResourceOwner =\n  (paramName: string = 'id') =>\n  (target: any, propertyKey: string, descriptor: PropertyDescriptor) => {\n    SetMetadata(ROLES_KEY, ['therapist', 'admin'])(\n      target,\n      propertyKey,\n      descriptor,\n    );\n    SetMetadata(RESOURCE_OWNER_KEY, paramName)(target, propertyKey, descriptor);\n  };\n\n// Therapy session access (therapist assigned to client or admin)\nexport const TherapySessionAccess = () =>\n  RequirePermissions('sessions:read:own', 'sessions:read:all');\n\n// Assessment access (client's own assessments, assigned therapist, or admin)\nexport const AssessmentAccess = () =>\n  RequirePermissions(\n    'assessments:read:own',\n    'assessments:read:assigned',\n    'assessments:read:all',\n  );\n\n// Moderation access (moderators and admins)\nexport const ModerationAccess = () =>\n  RequirePermissions(\n    'posts:moderate',\n    'communities:moderate',\n    'messages:moderate',\n  );\n"],"mappings":"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","ignoreList":[]}