07f4c0e37606e2b5c4770aaa8b1eef8b
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var NotificationsService_1;
var _a, _b, _c, _d, _e, _f;
Object.defineProperty(exports, "__esModule", { value: true });
exports.NotificationsService = void 0;
const common_1 = require("@nestjs/common");
const prisma_client_provider_1 = require("src/providers/prisma-client.provider");
const event_emitter_1 = require("@nestjs/event-emitter");
const client_1 = require("@prisma/client");
const messaging_gateway_1 = require("../messaging/messaging.gateway");
const messaging_events_1 = require("../common/events/messaging-events");
const social_events_1 = require("../common/events/social-events");
let NotificationsService = NotificationsService_1 = class NotificationsService {
    prisma;
    eventEmitter;
    messagingGateway;
    logger = new common_1.Logger(NotificationsService_1.name);
    webSocketServer = null;
    constructor(prisma, eventEmitter, messagingGateway) {
        this.prisma = prisma;
        this.eventEmitter = eventEmitter;
        this.messagingGateway = messagingGateway;
    }
    onModuleInit() {
        // Configure WebSocket server for real-time notifications
        // Use a slight delay to ensure MessagingGateway is fully initialized
        setTimeout(() => {
            this.setWebSocketServer(this.messagingGateway.server);
        }, 1000);
        this.logger.log('NotificationsService initialized with real-time capabilities');
    }
    /**
     * Set WebSocket server instance for real-time notifications
     */
    setWebSocketServer(server) {
        this.webSocketServer = server;
        this.logger.log('WebSocket server configured for real-time notifications');
    }
    async create(data, deliveryOptions) {
        const notification = await this.prisma.notification.create({
            data: {
                ...data,
                priority: data.priority || client_1.NotificationPriority.NORMAL,
            },
            include: {
                user: {
                    select: {
                        id: true,
                        firstName: true,
                        lastName: true,
                        email: true,
                    },
                },
            },
        });
        // Default delivery options
        const options = {
            realTime: true,
            email: false,
            push: false,
            scheduled: false,
            ...deliveryOptions,
        };
        // Deliver notification immediately since scheduling is not supported
        await this.deliverNotification(notification, options);
        return notification;
    }
    async findAll(userId, isRead, type, priority) {
        const where = { userId };
        if (isRead !== undefined)
            where.isRead = isRead;
        if (type)
            where.type = type;
        if (priority)
            where.priority = priority;
        return this.prisma.notification.findMany({
            where,
            orderBy: [{ priority: 'desc' }, { createdAt: 'desc' }],
            take: 50, // Limit to recent notifications
        });
    }
    async findOne(id) {
        return this.prisma.notification.findUnique({
            where: { id },
            include: {
                user: {
                    select: {
                        id: true,
                        firstName: true,
                        lastName: true,
                        email: true,
                    },
                },
            },
        });
    }
    async markAsRead(id) {
        const notification = await this.findOne(id);
        if (!notification) {
            throw new common_1.NotFoundException(`Notification with ID ${id} not found`);
        }
        return this.prisma.notification.update({
            where: { id },
            data: {
                isRead: true,
                readAt: new Date(),
            },
        });
    }
    async markAllAsRead(userId) {
        const result = await this.prisma.notification.updateMany({
            where: {
                userId,
                isRead: false,
            },
            data: {
                isRead: true,
                readAt: new Date(),
            },
        });
        return { count: result.count };
    }
    async delete(id) {
        const notification = await this.findOne(id);
        if (!notification) {
            throw new common_1.NotFoundException(`Notification with ID ${id} not found`);
        }
        return this.prisma.notification.delete({
            where: { id },
        });
    }
    async getUnreadCount(userId) {
        return this.prisma.notification.count({
            where: {
                userId,
                isRead: false,
            },
        });
    }
    async getNotificationSettings(userId) {
        // Return default notification settings since notificationSettings model doesn't exist
        // This provides a consistent interface while using in-memory defaults
        return {
            id: `default-${userId}`,
            userId,
            emailAppointmentReminders: true,
            emailNewMessages: true,
            emailWorksheetUpdates: true,
            emailSystemUpdates: false,
            emailMarketing: false,
            pushAppointmentReminders: true,
            pushNewMessages: true,
            pushWorksheetUpdates: true,
            pushSystemUpdates: false,
            inAppMessages: true,
            inAppUpdates: true,
            quietHoursEnabled: false,
            quietHoursStart: '22:00',
            quietHoursEnd: '08:00',
            quietHoursTimezone: 'UTC',
            createdAt: new Date(),
            updatedAt: new Date(),
        };
    }
    async updateNotificationSettings(userId, data) {
        // Return updated default settings since notificationSettings model doesn't exist
        // This provides a consistent interface while using in-memory defaults
        const currentSettings = await this.getNotificationSettings(userId);
        return {
            ...currentSettings,
            ...data,
            updatedAt: new Date(),
        };
    }
    /**
     * Deliver notification through configured channels
     */
    async deliverNotification(notification, options) {
        try {
            // Real-time WebSocket delivery
            if (options.realTime && this.webSocketServer) {
                await this.deliverRealTimeNotification(notification);
            }
            // Email delivery (if configured)
            if (options.email) {
                await this.deliverEmailNotification(notification);
            }
            // Push notification delivery (if configured)
            if (options.push) {
                await this.deliverPushNotification(notification);
            }
        }
        catch (error) {
            this.logger.error(`Error delivering notification ${notification.id}:`, error);
        }
    }
    /**
     * Deliver real-time notification via WebSocket
     */
    async deliverRealTimeNotification(notification) {
        if (!this.webSocketServer) {
            this.logger.warn('WebSocket server not configured for real-time notifications');
            return;
        }
        try {
            // Send to user's personal room
            this.webSocketServer
                .to(`user:${notification.userId}`)
                .emit('notification', {
                id: notification.id,
                title: notification.title,
                message: notification.message,
                type: notification.type,
                priority: notification.priority,
                actionUrl: notification.actionUrl,
                data: notification.data,
                createdAt: notification.createdAt,
                isRead: false,
            });
            // Send unread count update
            const unreadCount = await this.getUnreadCount(notification.userId);
            this.webSocketServer
                .to(`user:${notification.userId}`)
                .emit('unreadCount', {
                count: unreadCount,
            });
            this.logger.log(`Real-time notification delivered to user ${notification.userId}`);
        }
        catch (error) {
            this.logger.error(`Error delivering real-time notification:`, error);
        }
    }
    /**
     * Deliver email notification (placeholder for email service integration)
     */
    async deliverEmailNotification(notification) {
        // TODO: Integrate with email service (SendGrid, AWS SES, etc.)
        this.logger.log(`Email notification queued for user ${notification.userId}`);
    }
    /**
     * Deliver push notification (placeholder for push service integration)
     */
    async deliverPushNotification(notification) {
        // TODO: Integrate with push notification service (FCM, APNS, etc.)
        this.logger.log(`Push notification queued for user ${notification.userId}`);
    }
    /**
     * Batch create notifications with optimized delivery
     */
    async createBatch(notifications, deliveryOptions) {
        const createdNotifications = [];
        // Create notifications in batches for better performance
        for (const notificationData of notifications) {
            const notification = await this.create(notificationData, deliveryOptions);
            createdNotifications.push(notification);
        }
        return createdNotifications;
    }
    /**
     * Send notification to all users in a community
     */
    async sendToCommunity(communityId, notification, deliveryOptions) {
        try {
            // Get all community members
            const members = await this.prisma.membership.findMany({
                where: { communityId },
                select: { userId: true },
            });
            // Create notifications for all members (filter out null userIds)
            const notifications = members
                .filter((member) => member.userId !== null)
                .map((member) => ({
                ...notification,
                userId: member.userId,
            }));
            await this.createBatch(notifications, deliveryOptions);
            this.logger.log(`Sent notifications to ${members.length} community members`);
        }
        catch (error) {
            this.logger.error(`Error sending notifications to community ${communityId}:`, error);
        }
    }
    // ===== EVENT LISTENERS FOR COMMUNITY RECOMMENDATION SYSTEM =====
    /**
     * Handle community recommendation generated events
     */
    async handleRecommendationsGenerated(payload) {
        try {
            await this.create({
                userId: payload.userId,
                title: 'New Community Recommendations',
                message: `We've found ${payload.recommendationCount} new communities that might interest you based on your assessment results.`,
                type: client_1.NotificationType.COMMUNITY_RECOMMENDATION,
                priority: client_1.NotificationPriority.NORMAL,
                actionUrl: '/communities/recommendations',
                data: {
                    recommendationCount: payload.recommendationCount,
                    generatedAt: payload.timestamp,
                },
            }, {
                realTime: true,
                email: false,
                push: true,
            });
            this.logger.log(`Community recommendation notification sent to user ${payload.userId}`);
        }
        catch (error) {
            this.logger.error(`Error handling recommendations generated event:`, error);
        }
    }
    /**
     * Handle community recommendation interaction events
     */
    async handleRecommendationInteraction(payload) {
        try {
            if (payload.action === 'accept') {
                await this.create({
                    userId: payload.userId,
                    title: `Welcome to ${payload.communityName}!`,
                    message: `You've successfully joined ${payload.communityName}. Start exploring and connecting with the community.`,
                    type: client_1.NotificationType.COMMUNITY_JOINED,
                    priority: client_1.NotificationPriority.HIGH,
                    actionUrl: `/communities/${payload.communityId}`,
                    data: {
                        communityId: payload.communityId,
                        communityName: payload.communityName,
                        compatibilityScore: payload.compatibilityScore,
                        joinMethod: 'recommendation_accepted',
                    },
                }, {
                    realTime: true,
                    email: false,
                    push: true,
                });
                this.logger.log(`Community join notification sent to user ${payload.userId}`);
            }
        }
        catch (error) {
            this.logger.error(`Error handling recommendation interaction event:`, error);
        }
    }
    /**
     * Handle community member joined events
     */
    async handleMemberJoined(payload) {
        try {
            // Get community details
            const community = await this.prisma.community.findUnique({
                where: { id: payload.communityId },
                select: { name: true, _count: { select: { memberships: true } } },
            });
            if (!community)
                return;
            // Send welcome notification to the new member
            await this.create({
                userId: payload.userId,
                title: `Welcome to ${community.name}!`,
                message: `You're now part of a community with ${community._count.memberships} members. Start exploring and connecting!`,
                type: client_1.NotificationType.COMMUNITY_WELCOME,
                priority: client_1.NotificationPriority.HIGH,
                actionUrl: `/communities/${payload.communityId}`,
                data: {
                    communityId: payload.communityId,
                    communityName: community.name,
                    memberCount: community._count.memberships,
                    joinMethod: payload.joinMethod,
                },
            }, {
                realTime: true,
                email: false,
                push: true,
            });
            this.logger.log(`Community welcome notification sent to user ${payload.userId}`);
        }
        catch (error) {
            this.logger.error(`Error handling member joined event:`, error);
        }
    }
    /**
     * Handle recommendations refreshed events
     */
    async handleRecommendationsRefreshed(payload) {
        try {
            await this.create({
                userId: payload.userId,
                title: 'Community Recommendations Updated',
                message: 'Your community recommendations have been updated based on your latest assessment results.',
                type: client_1.NotificationType.RECOMMENDATIONS_UPDATED,
                priority: client_1.NotificationPriority.NORMAL,
                actionUrl: '/communities/recommendations',
                data: {
                    refreshedAt: payload.timestamp,
                    reason: 'assessment_change',
                },
            }, {
                realTime: true,
                email: false,
                push: false,
            });
            this.logger.log(`Recommendations refreshed notification sent to user ${payload.userId}`);
        }
        catch (error) {
            this.logger.error(`Error handling recommendations refreshed event:`, error);
        }
    }
    // ===== MESSAGING EVENT LISTENERS =====
    /**
     * Handle message sent events to create MESSAGE_RECEIVED notifications
     */
    async handleMessageSent(event) {
        try {
            const { senderId, conversationId, content, recipientIds } = event.eventData;
            // Get sender details
            const sender = await this.prisma.user.findUnique({
                where: { id: senderId },
                select: { firstName: true, lastName: true },
            });
            if (!sender) {
                this.logger.warn(`Sender not found for message notification: ${senderId}`);
                return;
            }
            const senderName = `${sender.firstName} ${sender.lastName}`;
            // Create notifications for each recipient
            for (const recipientId of recipientIds) {
                await this.create({
                    userId: recipientId,
                    title: 'New Message',
                    message: `You have a new message from ${senderName}.`,
                    type: client_1.NotificationType.MESSAGE_RECEIVED,
                    priority: client_1.NotificationPriority.NORMAL,
                    actionUrl: `/messages/${conversationId}`,
                    data: {
                        senderId,
                        conversationId,
                        messagePreview: content.substring(0, 100) + (content.length > 100 ? '...' : ''),
                        senderName,
                    },
                }, {
                    realTime: true,
                    email: false,
                    push: true,
                });
            }
            this.logger.log(`Message notifications sent to ${recipientIds.length} recipients for conversation ${conversationId}`);
        }
        catch (error) {
            this.logger.error(`Error handling message sent event:`, error);
        }
    }
    /**
     * Handle post created events to create COMMUNITY_POST notifications for community members
     */
    async handlePostCreated(event) {
        try {
            const { postId, authorId, communityId, title, content, isAnonymous } = event.eventData;
            // Skip notifications for anonymous posts or posts without community
            if (isAnonymous || !communityId) {
                return;
            }
            // Get post author details
            const author = await this.prisma.user.findUnique({
                where: { id: authorId },
                select: { firstName: true, lastName: true },
            });
            // Get community details and members
            const community = await this.prisma.community.findUnique({
                where: { id: communityId },
                select: {
                    name: true,
                    memberships: {
                        where: {
                            userId: { not: authorId }, // Don't notify the author
                        },
                        select: { userId: true },
                    },
                },
            });
            if (!author || !community) {
                this.logger.warn(`Author or community not found for post notification: ${postId}`);
                return;
            }
            const authorName = `${author.firstName} ${author.lastName}`;
            // Create notifications for community members
            const notifications = community.memberships
                .filter((member) => member.userId !== null)
                .map((member) => ({
                userId: member.userId,
                title: `New Post in ${community.name}`,
                message: `${authorName} posted: "${title || content.substring(0, 50)}${content.length > 50 ? '...' : ''}"`,
                type: client_1.NotificationType.COMMUNITY_POST,
                priority: client_1.NotificationPriority.LOW,
                actionUrl: `/communities/posts/${postId}`,
                data: {
                    postId,
                    authorId,
                    authorName,
                    communityId,
                    communityName: community.name,
                    postTitle: title,
                },
            }));
            await this.createBatch(notifications, {
                realTime: true,
                email: false,
                push: false,
            });
            this.logger.log(`Post notification sent to ${notifications.length} community members for post ${postId}`);
        }
        catch (error) {
            this.logger.error(`Error handling post created event:`, error);
        }
    }
    /**
     * Handle comment added events to create COMMUNITY_REPLY notifications for post author and parent comment author
     */
    async handleCommentAdded(event) {
        try {
            const { commentId, postId, authorId, content, parentCommentId } = event.eventData;
            // Get comment author details
            const author = await this.prisma.user.findUnique({
                where: { id: authorId },
                select: { firstName: true, lastName: true },
            });
            // Get post details and author
            const post = await this.prisma.post.findUnique({
                where: { id: postId },
                select: {
                    title: true,
                    userId: true,
                    user: {
                        select: { firstName: true, lastName: true },
                    },
                },
            });
            if (!author || !post) {
                this.logger.warn(`Author or post not found for comment notification: ${commentId}`);
                return;
            }
            const authorName = `${author.firstName} ${author.lastName}`;
            const recipients = new Set();
            // Notify post author (if not the commenter)
            if (post.userId !== authorId) {
                recipients.add(post.userId);
            }
            // If this is a reply to another comment, notify the parent comment author
            if (parentCommentId) {
                const parentComment = await this.prisma.comment.findUnique({
                    where: { id: parentCommentId },
                    select: { userId: true },
                });
                if (parentComment && parentComment.userId !== authorId && parentComment.userId !== post.userId) {
                    recipients.add(parentComment.userId);
                }
            }
            // Create notifications for all recipients
            const notifications = Array.from(recipients).map((recipientId) => ({
                userId: recipientId,
                title: parentCommentId ? 'New Reply to Your Comment' : 'New Comment on Your Post',
                message: `${authorName} ${parentCommentId ? 'replied to your comment' : 'commented on your post'}: "${content.substring(0, 100)}${content.length > 100 ? '...' : ''}"`,
                type: client_1.NotificationType.COMMUNITY_REPLY,
                priority: client_1.NotificationPriority.NORMAL,
                actionUrl: `/communities/posts/${postId}#comment-${commentId}`,
                data: {
                    commentId,
                    postId,
                    authorId,
                    authorName,
                    parentCommentId,
                    postTitle: post.title,
                },
            }));
            if (notifications.length > 0) {
                await this.createBatch(notifications, {
                    realTime: true,
                    email: false,
                    push: true,
                });
                this.logger.log(`Comment notifications sent to ${notifications.length} users for comment ${commentId}`);
            }
        }
        catch (error) {
            this.logger.error(`Error handling comment added event:`, error);
        }
    }
    // Helper methods for creating specific notification types
    async createAppointmentReminder(userId, appointmentId, appointmentTime, therapistName) {
        return this.create({
            userId,
            title: 'Upcoming Appointment',
            message: `You have an appointment with ${therapistName} in 1 hour.`,
            type: client_1.NotificationType.APPOINTMENT_REMINDER,
            priority: client_1.NotificationPriority.HIGH,
            actionUrl: `/appointments/${appointmentId}`,
            data: { appointmentId, appointmentTime },
        });
    }
    async createMessageNotification(userId, senderId, senderName, conversationId) {
        return this.create({
            userId,
            title: 'New Message',
            message: `You have a new message from ${senderName}.`,
            type: client_1.NotificationType.MESSAGE_RECEIVED,
            priority: client_1.NotificationPriority.NORMAL,
            actionUrl: `/messages/${conversationId}`,
            data: { senderId, conversationId },
        });
    }
    async createWorksheetAssignedNotification(userId, worksheetId, worksheetTitle, therapistName) {
        return this.create({
            userId,
            title: 'New Worksheet Assigned',
            message: `${therapistName} has assigned you a new worksheet: "${worksheetTitle}".`,
            type: client_1.NotificationType.WORKSHEET_ASSIGNED,
            priority: client_1.NotificationPriority.NORMAL,
            actionUrl: `/worksheets/${worksheetId}`,
            data: { worksheetId },
        });
    }
    async createTherapistApplicationNotification(userId, status) {
        const title = status === 'approved' ? 'Application Approved' : 'Application Update';
        const message = status === 'approved'
            ? 'Congratulations! Your therapist application has been approved.'
            : 'Your therapist application has been reviewed. Please check your application status.';
        return this.create({
            userId,
            title,
            message,
            type: status === 'approved'
                ? client_1.NotificationType.THERAPIST_APPROVED
                : client_1.NotificationType.THERAPIST_REJECTED,
            priority: client_1.NotificationPriority.HIGH,
            actionUrl: '/therapist/application',
            data: { status },
        });
    }
    async createReviewRequestNotification(userId, therapistId, therapistName, sessionId) {
        return this.create({
            userId,
            title: 'Review Request',
            message: `Please leave a review for your session with ${therapistName}.`,
            type: client_1.NotificationType.REVIEW_REQUEST,
            priority: client_1.NotificationPriority.NORMAL,
            actionUrl: `/therapists/${therapistId}/review?session=${sessionId}`,
            data: { therapistId, sessionId },
        });
    }
    async createCommunityPostNotification(userId, postId, communityName, authorName) {
        return this.create({
            userId,
            title: 'New Community Post',
            message: `${authorName} posted in ${communityName}.`,
            type: client_1.NotificationType.COMMUNITY_POST,
            priority: client_1.NotificationPriority.LOW,
            actionUrl: `/communities/posts/${postId}`,
            data: { postId, communityName },
        });
    }
    // ===== THERAPIST MATCHING SYSTEM NOTIFICATIONS =====
    async createClientRequestNotification(therapistId, clientId, clientName, requestMessage, priority = 'NORMAL') {
        const notificationPriority = priority === 'HIGH' || priority === 'URGENT' ? 'HIGH' : 'NORMAL';
        return this.create({
            userId: therapistId,
            title: `New Client Request ${priority === 'URGENT' ? '(Urgent)' : ''}`,
            message: `${clientName} has sent you a therapy request.${requestMessage ? ` "${requestMessage.substring(0, 100)}${requestMessage.length > 100 ? '...' : ''}"` : ''}`,
            type: 'CLIENT_REQUEST_RECEIVED',
            priority: notificationPriority,
            actionUrl: `/therapist/requests`,
            data: {
                clientId,
                clientName,
                requestType: 'therapy_request',
                priority,
                hasMessage: !!requestMessage,
            },
        });
    }
    async createRequestAcceptedNotification(clientId, therapistId, therapistName, responseMessage, schedulingInfo) {
        return this.create({
            userId: clientId,
            title: 'Therapist Request Accepted! ðŸŽ‰',
            message: `Great news! ${therapistName} has accepted your therapy request.${responseMessage ? ` "${responseMessage}"` : ''}`,
            type: 'THERAPIST_REQUEST_ACCEPTED',
            priority: 'HIGH',
            actionUrl: `/client/therapists/${therapistId}`,
            data: {
                therapistId,
                therapistName,
                responseMessage,
                schedulingInfo,
                nextStep: 'schedule_session',
            },
        });
    }
    async createRequestDeclinedNotification(clientId, therapistId, therapistName, responseMessage) {
        return this.create({
            userId: clientId,
            title: 'Therapist Request Update',
            message: `${therapistName} has responded to your therapy request.${responseMessage ? ` "${responseMessage}"` : ''} Don't worry - we can help you find other great matches!`,
            type: 'THERAPIST_REQUEST_DECLINED',
            priority: 'NORMAL',
            actionUrl: '/client/therapists/browse',
            data: {
                therapistId,
                therapistName,
                responseMessage,
                nextStep: 'browse_alternatives',
            },
        });
    }
    async createRequestCancelledNotification(therapistId, clientName, reason) {
        return this.create({
            userId: therapistId,
            title: 'Client Request Cancelled',
            message: `${clientName} has cancelled their therapy request.${reason ? ` Reason: ${reason}` : ''}`,
            type: 'CLIENT_REQUEST_CANCELLED',
            priority: 'NORMAL',
            actionUrl: '/therapist/requests',
            data: {
                clientName,
                reason,
                actionType: 'cancellation',
            },
        });
    }
    async createAdminTherapistApprovalNotification(therapistId, approvalMessage) {
        return this.create({
            userId: therapistId,
            title: 'Application Approved! Welcome to Mentara ðŸŽ‰',
            message: `Congratulations! Your therapist application has been approved. You can now start receiving client requests.${approvalMessage ? ` Message from our team: "${approvalMessage}"` : ''}`,
            type: 'THERAPIST_APPROVED',
            priority: 'HIGH',
            actionUrl: '/therapist/dashboard',
            data: {
                approvalMessage,
                nextSteps: [
                    'complete_profile',
                    'set_availability',
                    'review_guidelines',
                ],
                welcomeFlow: true,
            },
        });
    }
    async createAdminTherapistRejectionNotification(therapistId, rejectionReason, rejectionMessage, allowReapplication) {
        return this.create({
            userId: therapistId,
            title: 'Application Status Update',
            message: `Your therapist application has been reviewed. ${rejectionMessage}`,
            type: 'THERAPIST_REJECTED',
            priority: 'HIGH',
            actionUrl: allowReapplication
                ? '/therapist/reapply'
                : '/therapist/application-status',
            data: {
                rejectionReason,
                rejectionMessage,
                allowReapplication,
                nextStep: allowReapplication ? 'reapply' : 'contact_support',
            },
        });
    }
    async createNewRecommendationsNotification(clientId, therapistCount, updateReason = 'new_therapists') {
        const reasonMessages = {
            profile_update: 'based on your updated preferences',
            new_therapists: 'with newly approved therapists',
            algorithm_improvement: 'with improved matching',
        };
        return this.create({
            userId: clientId,
            title: 'New Therapist Recommendations Available',
            message: `We've found ${therapistCount} new therapist matches for you ${reasonMessages[updateReason]}. Check them out!`,
            type: 'NEW_RECOMMENDATIONS',
            priority: 'NORMAL',
            actionUrl: '/client/therapists/recommendations',
            data: {
                therapistCount,
                updateReason,
                recommendationType: 'updated_matches',
            },
        });
    }
    async createMatchingSystemUpdateNotification(userId, updateType, updateMessage) {
        const titles = {
            algorithm_improvement: 'Better Matching Available',
            feature_release: 'New Feature Available',
            maintenance: 'System Update Complete',
        };
        const priorities = {
            algorithm_improvement: 'NORMAL',
            feature_release: 'NORMAL',
            maintenance: 'LOW',
        };
        return this.create({
            userId,
            title: titles[updateType],
            message: updateMessage,
            type: 'SYSTEM_UPDATE',
            priority: priorities[updateType],
            actionUrl: '/dashboard',
            data: {
                updateType,
                systemUpdate: true,
            },
        });
    }
    async createRelationshipEstablishedNotification(clientId, therapistId, therapistName) {
        return this.create({
            userId: clientId,
            title: 'Welcome to Your Therapy Journey! ðŸŒŸ',
            message: `You're now connected with ${therapistName}. Your therapy relationship has officially begun. Take the first step by scheduling your initial session.`,
            type: 'RELATIONSHIP_ESTABLISHED',
            priority: 'HIGH',
            actionUrl: `/client/therapists/${therapistId}/schedule`,
            data: {
                therapistId,
                therapistName,
                relationshipStatus: 'active',
                nextStep: 'schedule_first_session',
            },
        });
    }
    async createTherapistRequestReminderNotification(therapistId, pendingRequestCount) {
        return this.create({
            userId: therapistId,
            title: `${pendingRequestCount} Pending Client Request${pendingRequestCount > 1 ? 's' : ''}`,
            message: `You have ${pendingRequestCount} client request${pendingRequestCount > 1 ? 's' : ''} waiting for your response. Clients appreciate timely responses!`,
            type: 'REQUEST_REMINDER',
            priority: pendingRequestCount > 3 ? 'HIGH' : 'NORMAL',
            actionUrl: '/therapist/requests/pending',
            data: {
                pendingRequestCount,
                reminderType: 'pending_requests',
                urgency: pendingRequestCount > 3 ? 'high' : 'normal',
            },
        });
    }
    async createProfileCompletionReminderNotification(userId, userType, missingFields) {
        const actionUrls = {
            client: '/client/profile',
            therapist: '/therapist/profile',
        };
        return this.create({
            userId,
            title: 'Complete Your Profile for Better Matches',
            message: `Complete your profile to get better therapist recommendations. Missing: ${missingFields.slice(0, 3).join(', ')}${missingFields.length > 3 ? '...' : ''}`,
            type: 'PROFILE_COMPLETION',
            priority: 'LOW',
            actionUrl: actionUrls[userType],
            data: {
                missingFields,
                userType,
                profileCompleteness: Math.max(0, 100 - missingFields.length * 10),
            },
        });
    }
    async sendScheduledNotifications() {
        // Since scheduledFor and sentAt fields don't exist in the Notification model,
        // this method returns a stub response. In a real implementation with these fields,
        // this would process and send scheduled notifications.
        this.logger.log('Scheduled notifications check completed (no scheduled fields available)');
        return { sent: 0 };
    }
    // ===== BOOKING & APPOINTMENT EVENT LISTENERS =====
    /**
     * Handle appointment booked events
     */
    async handleAppointmentBooked(event) {
        try {
            const { data } = event;
            // Get therapist and client details
            const [therapist, client] = await Promise.all([
                this.prisma.user.findUnique({
                    where: { id: data.therapistId },
                    select: { firstName: true, lastName: true },
                }),
                this.prisma.user.findUnique({
                    where: { id: data.clientId },
                    select: { firstName: true, lastName: true },
                }),
            ]);
            if (!therapist || !client)
                return;
            // Notify client about successful booking
            await this.create({
                userId: data.clientId,
                title: 'Session Booked Successfully!',
                message: `Your ${data.meetingType} session with ${therapist.firstName} ${therapist.lastName} has been scheduled for ${new Date(data.startTime).toLocaleDateString()} at ${new Date(data.startTime).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}.`,
                type: client_1.NotificationType.APPOINTMENT_CONFIRMED,
                priority: client_1.NotificationPriority.HIGH,
                actionUrl: `/client/meetings/${data.appointmentId}`,
                data: {
                    appointmentId: data.appointmentId,
                    therapistId: data.therapistId,
                    startTime: data.startTime,
                    duration: data.duration,
                    meetingType: data.meetingType,
                },
            }, {
                realTime: true,
                email: true,
                push: true,
            });
            // Notify therapist about new booking
            await this.create({
                userId: data.therapistId,
                title: 'New Session Booked',
                message: `${client.firstName} ${client.lastName} has booked a ${data.duration}-minute ${data.meetingType} session with you on ${new Date(data.startTime).toLocaleDateString()} at ${new Date(data.startTime).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}.`,
                type: client_1.NotificationType.APPOINTMENT_CONFIRMED,
                priority: client_1.NotificationPriority.HIGH,
                actionUrl: `/therapist/meetings/${data.appointmentId}`,
                data: {
                    appointmentId: data.appointmentId,
                    clientId: data.clientId,
                    startTime: data.startTime,
                    duration: data.duration,
                    meetingType: data.meetingType,
                },
            }, {
                realTime: true,
                email: true,
                push: true,
            });
            this.logger.log(`Appointment booked notifications sent for appointment ${data.appointmentId}`);
        }
        catch (error) {
            this.logger.error(`Error handling appointment booked event:`, error);
        }
    }
    /**
     * Handle appointment cancelled events
     */
    async handleAppointmentCancelled(event) {
        try {
            const { data } = event;
            // Get therapist and client details
            const [therapist, client] = await Promise.all([
                this.prisma.user.findUnique({
                    where: { id: data.therapistId },
                    select: { firstName: true, lastName: true },
                }),
                this.prisma.user.findUnique({
                    where: { id: data.clientId },
                    select: { firstName: true, lastName: true },
                }),
            ]);
            if (!therapist || !client)
                return;
            const isCancelledByClient = data.cancelledBy === data.clientId;
            // Notify the other party about the cancellation
            const notifyUserId = isCancelledByClient ? data.therapistId : data.clientId;
            const cancellerName = isCancelledByClient
                ? `${client.firstName} ${client.lastName}`
                : `${therapist.firstName} ${therapist.lastName}`;
            await this.create({
                userId: notifyUserId,
                title: 'Session Cancelled',
                message: `Your session scheduled for ${new Date(data.originalStartTime).toLocaleDateString()} at ${new Date(data.originalStartTime).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })} has been cancelled by ${cancellerName}. ${data.cancellationReason}`,
                type: client_1.NotificationType.APPOINTMENT_CANCELLED,
                priority: client_1.NotificationPriority.HIGH,
                actionUrl: isCancelledByClient ? '/therapist/schedule' : '/client/booking',
                data: {
                    appointmentId: data.appointmentId,
                    cancelledBy: data.cancelledBy,
                    cancellationReason: data.cancellationReason,
                    originalStartTime: data.originalStartTime,
                },
            }, {
                realTime: true,
                email: true,
                push: true,
            });
            // Notify the canceller with confirmation
            await this.create({
                userId: data.cancelledBy,
                title: 'Session Cancellation Confirmed',
                message: `Your session with ${isCancelledByClient ? therapist.firstName + ' ' + therapist.lastName : client.firstName + ' ' + client.lastName} scheduled for ${new Date(data.originalStartTime).toLocaleDateString()} has been successfully cancelled.`,
                type: client_1.NotificationType.APPOINTMENT_CANCELLED,
                priority: client_1.NotificationPriority.NORMAL,
                actionUrl: isCancelledByClient ? '/client/booking' : '/therapist/schedule',
                data: {
                    appointmentId: data.appointmentId,
                    originalStartTime: data.originalStartTime,
                    refundProcessed: true,
                },
            }, {
                realTime: true,
                email: false,
                push: false,
            });
            this.logger.log(`Appointment cancellation notifications sent for appointment ${data.appointmentId}`);
        }
        catch (error) {
            this.logger.error(`Error handling appointment cancelled event:`, error);
        }
    }
    /**
     * Handle appointment rescheduled events
     */
    async handleAppointmentRescheduled(event) {
        try {
            const { data } = event;
            // Get therapist and client details
            const [therapist, client] = await Promise.all([
                this.prisma.user.findUnique({
                    where: { id: data.therapistId },
                    select: { firstName: true, lastName: true },
                }),
                this.prisma.user.findUnique({
                    where: { id: data.clientId },
                    select: { firstName: true, lastName: true },
                }),
            ]);
            if (!therapist || !client)
                return;
            const isRescheduledByClient = data.rescheduledBy === data.clientId;
            // Notify the other party about the reschedule
            const notifyUserId = isRescheduledByClient ? data.therapistId : data.clientId;
            const reschedulerName = isRescheduledByClient
                ? `${client.firstName} ${client.lastName}`
                : `${therapist.firstName} ${therapist.lastName}`;
            await this.create({
                userId: notifyUserId,
                title: 'Session Rescheduled',
                message: `${reschedulerName} has rescheduled your session. New time: ${new Date(data.newStartTime).toLocaleDateString()} at ${new Date(data.newStartTime).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })} (previously ${new Date(data.originalStartTime).toLocaleDateString()} at ${new Date(data.originalStartTime).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}).`,
                type: client_1.NotificationType.APPOINTMENT_RESCHEDULED,
                priority: client_1.NotificationPriority.HIGH,
                actionUrl: `/client/meetings/${data.appointmentId}`,
                data: {
                    appointmentId: data.appointmentId,
                    rescheduledBy: data.rescheduledBy,
                    originalStartTime: data.originalStartTime,
                    newStartTime: data.newStartTime,
                    rescheduleReason: data.rescheduleReason,
                },
            }, {
                realTime: true,
                email: true,
                push: true,
            });
            // Notify the rescheduler with confirmation
            await this.create({
                userId: data.rescheduledBy,
                title: 'Session Reschedule Confirmed',
                message: `Your session has been successfully rescheduled to ${new Date(data.newStartTime).toLocaleDateString()} at ${new Date(data.newStartTime).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}.`,
                type: client_1.NotificationType.APPOINTMENT_RESCHEDULED,
                priority: client_1.NotificationPriority.NORMAL,
                actionUrl: `/client/meetings/${data.appointmentId}`,
                data: {
                    appointmentId: data.appointmentId,
                    originalStartTime: data.originalStartTime,
                    newStartTime: data.newStartTime,
                },
            }, {
                realTime: true,
                email: false,
                push: false,
            });
            this.logger.log(`Appointment rescheduled notifications sent for appointment ${data.appointmentId}`);
        }
        catch (error) {
            this.logger.error(`Error handling appointment rescheduled event:`, error);
        }
    }
    /**
     * Handle appointment completed events
     */
    async handleAppointmentCompleted(event) {
        try {
            const { data } = event;
            // Get therapist and client details
            const [therapist, client] = await Promise.all([
                this.prisma.user.findUnique({
                    where: { id: data.therapistId },
                    select: { firstName: true, lastName: true },
                }),
                this.prisma.user.findUnique({
                    where: { id: data.clientId },
                    select: { firstName: true, lastName: true },
                }),
            ]);
            if (!therapist || !client)
                return;
            // Notify client about session completion and review request
            await this.create({
                userId: data.clientId,
                title: 'Session Completed - Share Your Feedback',
                message: `Your session with ${therapist.firstName} ${therapist.lastName} has been completed. How was your experience? Your feedback helps us improve our services.`,
                type: client_1.NotificationType.REVIEW_REQUEST,
                priority: client_1.NotificationPriority.NORMAL,
                actionUrl: `/client/therapists/${data.therapistId}/review?session=${data.appointmentId}`,
                data: {
                    appointmentId: data.appointmentId,
                    therapistId: data.therapistId,
                    completedAt: data.completedAt,
                    duration: data.duration,
                    attendanceStatus: data.attendanceStatus,
                },
            }, {
                realTime: true,
                email: false,
                push: true,
            });
            // Notify therapist about session completion
            await this.create({
                userId: data.therapistId,
                title: 'Session Completed',
                message: `Your session with ${client.firstName} ${client.lastName} has been marked as completed. Duration: ${data.duration} minutes.`,
                type: client_1.NotificationType.APPOINTMENT_CONFIRMED,
                priority: client_1.NotificationPriority.NORMAL,
                actionUrl: `/therapist/sessions/${data.appointmentId}`,
                data: {
                    appointmentId: data.appointmentId,
                    clientId: data.clientId,
                    completedAt: data.completedAt,
                    duration: data.duration,
                    attendanceStatus: data.attendanceStatus,
                    sessionNotes: data.sessionNotes,
                },
            }, {
                realTime: true,
                email: false,
                push: false,
            });
            this.logger.log(`Appointment completed notifications sent for appointment ${data.appointmentId}`);
        }
        catch (error) {
            this.logger.error(`Error handling appointment completed event:`, error);
        }
    }
};
exports.NotificationsService = NotificationsService;
__decorate([
    (0, event_emitter_1.OnEvent)('community.recommendations.generated'),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", Promise)
], NotificationsService.prototype, "handleRecommendationsGenerated", null);
__decorate([
    (0, event_emitter_1.OnEvent)('community.recommendation.interaction'),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", Promise)
], NotificationsService.prototype, "handleRecommendationInteraction", null);
__decorate([
    (0, event_emitter_1.OnEvent)('community.member.joined'),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", Promise)
], NotificationsService.prototype, "handleMemberJoined", null);
__decorate([
    (0, event_emitter_1.OnEvent)('community.recommendations.refreshed'),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", Promise)
], NotificationsService.prototype, "handleRecommendationsRefreshed", null);
__decorate([
    (0, event_emitter_1.OnEvent)('MessageSentEvent'),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [typeof (_d = typeof messaging_events_1.MessageSentEvent !== "undefined" && messaging_events_1.MessageSentEvent) === "function" ? _d : Object]),
    __metadata("design:returntype", Promise)
], NotificationsService.prototype, "handleMessageSent", null);
__decorate([
    (0, event_emitter_1.OnEvent)('PostCreatedEvent'),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [typeof (_e = typeof social_events_1.PostCreatedEvent !== "undefined" && social_events_1.PostCreatedEvent) === "function" ? _e : Object]),
    __metadata("design:returntype", Promise)
], NotificationsService.prototype, "handlePostCreated", null);
__decorate([
    (0, event_emitter_1.OnEvent)('CommentAddedEvent'),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [typeof (_f = typeof social_events_1.CommentAddedEvent !== "undefined" && social_events_1.CommentAddedEvent) === "function" ? _f : Object]),
    __metadata("design:returntype", Promise)
], NotificationsService.prototype, "handleCommentAdded", null);
__decorate([
    (0, event_emitter_1.OnEvent)('AppointmentBookedEvent'),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", Promise)
], NotificationsService.prototype, "handleAppointmentBooked", null);
__decorate([
    (0, event_emitter_1.OnEvent)('AppointmentCancelledEvent'),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", Promise)
], NotificationsService.prototype, "handleAppointmentCancelled", null);
__decorate([
    (0, event_emitter_1.OnEvent)('AppointmentRescheduledEvent'),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", Promise)
], NotificationsService.prototype, "handleAppointmentRescheduled", null);
__decorate([
    (0, event_emitter_1.OnEvent)('AppointmentCompletedEvent'),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", Promise)
], NotificationsService.prototype, "handleAppointmentCompleted", null);
exports.NotificationsService = NotificationsService = NotificationsService_1 = __decorate([
    (0, common_1.Injectable)(),
    __metadata("design:paramtypes", [typeof (_a = typeof prisma_client_provider_1.PrismaService !== "undefined" && prisma_client_provider_1.PrismaService) === "function" ? _a : Object, typeof (_b = typeof event_emitter_1.EventEmitter2 !== "undefined" && event_emitter_1.EventEmitter2) === "function" ? _b : Object, typeof (_c = typeof messaging_gateway_1.MessagingGateway !== "undefined" && messaging_gateway_1.MessagingGateway) === "function" ? _c : Object])
], NotificationsService);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL25vdGlmaWNhdGlvbnMvbm90aWZpY2F0aW9ucy5zZXJ2aWNlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQUEsMkNBS3dCO0FBQ3hCLGlGQUFxRTtBQUNyRSx5REFBK0Q7QUFFL0QsMkNBSXdCO0FBQ3hCLHNFQUFrRTtBQUNsRSx3RUFBcUU7QUFDckUsa0VBQXFGO0FBMEI5RSxJQUFNLG9CQUFvQiw0QkFBMUIsTUFBTSxvQkFBb0I7SUFLWjtJQUNBO0lBQ0E7SUFORixNQUFNLEdBQUcsSUFBSSxlQUFNLENBQUMsc0JBQW9CLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDeEQsZUFBZSxHQUEyQixJQUFJLENBQUM7SUFFdkQsWUFDbUIsTUFBcUIsRUFDckIsWUFBMkIsRUFDM0IsZ0JBQWtDO1FBRmxDLFdBQU0sR0FBTixNQUFNLENBQWU7UUFDckIsaUJBQVksR0FBWixZQUFZLENBQWU7UUFDM0IscUJBQWdCLEdBQWhCLGdCQUFnQixDQUFrQjtJQUNsRCxDQUFDO0lBRUosWUFBWTtRQUNWLHlEQUF5RDtRQUN6RCxxRUFBcUU7UUFDckUsVUFBVSxDQUFDLEdBQUcsRUFBRTtZQUNkLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDeEQsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDO1FBRVQsSUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQ2IsOERBQThELENBQy9ELENBQUM7SUFDSixDQUFDO0lBRUQ7O09BRUc7SUFDSCxrQkFBa0IsQ0FBQyxNQUF1QjtRQUN4QyxJQUFJLENBQUMsZUFBZSxHQUFHLE1BQU0sQ0FBQztRQUM5QixJQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyx5REFBeUQsQ0FBQyxDQUFDO0lBQzdFLENBQUM7SUFFRCxLQUFLLENBQUMsTUFBTSxDQUNWLElBUUMsRUFDRCxlQUE2QztRQUU3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QUE2QixDQUFDOzs7O3dFQWlGdEM7QUFNSztJQURMLElBQUEsdUJBQU8sRUFBQywyQkFBMkIsQ0FBQzs7OztzRUE2RXBDOytCQWovQ1Usb0JBQW9CO0lBRGhDLElBQUEsbUJBQVUsR0FBRTt5REFNZ0Isc0NBQWEsb0JBQWIsc0NBQWEsb0RBQ1AsNkJBQWEsb0JBQWIsNkJBQWEsb0RBQ1Qsb0NBQWdCLG9CQUFoQixvQ0FBZ0I7R0FQMUMsb0JBQW9CLENBay9DaEMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL25vdGlmaWNhdGlvbnMvbm90aWZpY2F0aW9ucy5zZXJ2aWNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIEluamVjdGFibGUsXG4gIE5vdEZvdW5kRXhjZXB0aW9uLFxuICBMb2dnZXIsXG4gIE9uTW9kdWxlSW5pdCxcbn0gZnJvbSAnQG5lc3Rqcy9jb21tb24nO1xuaW1wb3J0IHsgUHJpc21hU2VydmljZSB9IGZyb20gJ3NyYy9wcm92aWRlcnMvcHJpc21hLWNsaWVudC5wcm92aWRlcic7XG5pbXBvcnQgeyBFdmVudEVtaXR0ZXIyLCBPbkV2ZW50IH0gZnJvbSAnQG5lc3Rqcy9ldmVudC1lbWl0dGVyJztcbmltcG9ydCB7IFNlcnZlciB9IGZyb20gJ3NvY2tldC5pbyc7XG5pbXBvcnQge1xuICBOb3RpZmljYXRpb24sXG4gIE5vdGlmaWNhdGlvblR5cGUsXG4gIE5vdGlmaWNhdGlvblByaW9yaXR5LFxufSBmcm9tICdAcHJpc21hL2NsaWVudCc7XG5pbXBvcnQgeyBNZXNzYWdpbmdHYXRld2F5IH0gZnJvbSAnLi4vbWVzc2FnaW5nL21lc3NhZ2luZy5nYXRld2F5JztcbmltcG9ydCB7IE1lc3NhZ2VTZW50RXZlbnQgfSBmcm9tICcuLi9jb21tb24vZXZlbnRzL21lc3NhZ2luZy1ldmVudHMnO1xuaW1wb3J0IHsgUG9zdENyZWF0ZWRFdmVudCwgQ29tbWVudEFkZGVkRXZlbnQgfSBmcm9tICcuLi9jb21tb24vZXZlbnRzL3NvY2lhbC1ldmVudHMnO1xuXG5pbnRlcmZhY2UgV2ViU29ja2V0U2VydmVyIHtcbiAgdG8ocm9vbTogc3RyaW5nKToge1xuICAgIGVtaXQoZXZlbnQ6IHN0cmluZywgZGF0YTogYW55KTogdm9pZDtcbiAgfTtcbn1cblxuaW50ZXJmYWNlIE5vdGlmaWNhdGlvbkRlbGl2ZXJ5T3B0aW9ucyB7XG4gIHJlYWxUaW1lPzogYm9vbGVhbjtcbiAgZW1haWw/OiBib29sZWFuO1xuICBwdXNoPzogYm9vbGVhbjtcbiAgc2NoZWR1bGVkPzogYm9vbGVhbjtcbiAgcHJpb3JpdHk/OiBOb3RpZmljYXRpb25Qcmlvcml0eTtcbn1cblxuaW50ZXJmYWNlIE5vdGlmaWNhdGlvblRlbXBsYXRlIHtcbiAgdGl0bGU6IHN0cmluZztcbiAgbWVzc2FnZTogc3RyaW5nO1xuICB0eXBlOiBOb3RpZmljYXRpb25UeXBlO1xuICBwcmlvcml0eTogTm90aWZpY2F0aW9uUHJpb3JpdHk7XG4gIGFjdGlvblVybD86IHN0cmluZztcbiAgZGF0YT86IGFueTtcbn1cblxuQEluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIE5vdGlmaWNhdGlvbnNTZXJ2aWNlIGltcGxlbWVudHMgT25Nb2R1bGVJbml0IHtcbiAgcHJpdmF0ZSByZWFkb25seSBsb2dnZXIgPSBuZXcgTG9nZ2VyKE5vdGlmaWNhdGlvbnNTZXJ2aWNlLm5hbWUpO1xuICBwcml2YXRlIHdlYlNvY2tldFNlcnZlcjogV2ViU29ja2V0U2VydmVyIHwgbnVsbCA9IG51bGw7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSByZWFkb25seSBwcmlzbWE6IFByaXNtYVNlcnZpY2UsXG4gICAgcHJpdmF0ZSByZWFkb25seSBldmVudEVtaXR0ZXI6IEV2ZW50RW1pdHRlcjIsXG4gICAgcHJpdmF0ZSByZWFkb25seSBtZXNzYWdpbmdHYXRld2F5OiBNZXNzYWdpbmdHYXRld2F5LFxuICApIHt9XG5cbiAgb25Nb2R1bGVJbml0KCkge1xuICAgIC8vIENvbmZpZ3VyZSBXZWJTb2NrZXQgc2VydmVyIGZvciByZWFsLXRpbWUgbm90aWZpY2F0aW9uc1xuICAgIC8vIFVzZSBhIHNsaWdodCBkZWxheSB0byBlbnN1cmUgTWVzc2FnaW5nR2F0ZXdheSBpcyBmdWxseSBpbml0aWFsaXplZFxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgdGhpcy5zZXRXZWJTb2NrZXRTZXJ2ZXIodGhpcy5tZXNzYWdpbmdHYXRld2F5LnNlcnZlcik7XG4gICAgfSwgMTAwMCk7XG4gICAgXG4gICAgdGhpcy5sb2dnZXIubG9nKFxuICAgICAgJ05vdGlmaWNhdGlvbnNTZXJ2aWNlIGluaXRpYWxpemVkIHdpdGggcmVhbC10aW1lIGNhcGFiaWxpdGllcycsXG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXQgV2ViU29ja2V0IHNlcnZlciBpbnN0YW5jZSBmb3IgcmVhbC10aW1lIG5vdGlmaWNhdGlvbnNcbiAgICovXG4gIHNldFdlYlNvY2tldFNlcnZlcihzZXJ2ZXI6IFdlYlNvY2tldFNlcnZlcikge1xuICAgIHRoaXMud2ViU29ja2V0U2VydmVyID0gc2VydmVyO1xuICAgIHRoaXMubG9nZ2VyLmxvZygnV2ViU29ja2V0IHNlcnZlciBjb25maWd1cmVkIGZvciByZWFsLXRpbWUgbm90aWZpY2F0aW9ucycpO1xuICB9XG5cbiAgYXN5bmMgY3JlYXRlKFxuICAgIGRhdGE6IHtcbiAgICAgIHVzZXJJZDogc3RyaW5nO1xuICAgICAgdGl0bGU6IHN0cmluZztcbiAgICAgIG1lc3NhZ2U6IHN0cmluZztcbiAgICAgIHR5cGU6IE5vdGlmaWNhdGlvblR5cGU7XG4gICAgICBwcmlvcml0eT86IE5vdGlmaWNhdGlvblByaW9yaXR5O1xuICAgICAgZGF0YT86IGFueTtcbiAgICAgIGFjdGlvblVybD86IHN0cmluZztcbiAgICB9LFxuICAgIGRlbGl2ZXJ5T3B0aW9ucz86IE5vdGlmaWNhdGlvbkRlbGl2ZXJ5T3B0aW9ucyxcbiAgKTogUHJvbWlzZTxOb3RpZmljYXRpb24+IHtcbiAgICBjb25zdCBub3RpZmljYXRpb24gPSBhd2FpdCB0aGlzLnByaXNtYS5ub3RpZmljYXRpb24uY3JlYXRlKHtcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgLi4uZGF0YSxcbiAgICAgICAgcHJpb3JpdHk6IGRhdGEucHJpb3JpdHkgfHwgTm90aWZpY2F0aW9uUHJpb3JpdHkuTk9STUFMLFxuICAgICAgfSxcbiAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIHNlbGVjdDoge1xuICAgICAgICAgICAgaWQ6IHRydWUsXG4gICAgICAgICAgICBmaXJzdE5hbWU6IHRydWUsXG4gICAgICAgICAgICBsYXN0TmFtZTogdHJ1ZSxcbiAgICAgICAgICAgIGVtYWlsOiB0cnVlLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgLy8gRGVmYXVsdCBkZWxpdmVyeSBvcHRpb25zXG4gICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgIHJlYWxUaW1lOiB0cnVlLFxuICAgICAgZW1haWw6IGZhbHNlLFxuICAgICAgcHVzaDogZmFsc2UsXG4gICAgICBzY2hlZHVsZWQ6IGZhbHNlLFxuICAgICAgLi4uZGVsaXZlcnlPcHRpb25zLFxuICAgIH07XG5cbiAgICAvLyBEZWxpdmVyIG5vdGlmaWNhdGlvbiBpbW1lZGlhdGVseSBzaW5jZSBzY2hlZHVsaW5nIGlzIG5vdCBzdXBwb3J0ZWRcbiAgICBhd2FpdCB0aGlzLmRlbGl2ZXJOb3RpZmljYXRpb24obm90aWZpY2F0aW9uLCBvcHRpb25zKTtcblxuICAgIHJldHVybiBub3RpZmljYXRpb247XG4gIH1cblxuICBhc3luYyBmaW5kQWxsKFxuICAgIHVzZXJJZDogc3RyaW5nLFxuICAgIGlzUmVhZD86IGJvb2xlYW4sXG4gICAgdHlwZT86IE5vdGlmaWNhdGlvblR5cGUsXG4gICAgcHJpb3JpdHk/OiBOb3RpZmljYXRpb25Qcmlvcml0eSxcbiAgKTogUHJvbWlzZTxOb3RpZmljYXRpb25bXT4ge1xuICAgIGNvbnN0IHdoZXJlOiBhbnkgPSB7IHVzZXJJZCB9O1xuXG4gICAgaWYgKGlzUmVhZCAhPT0gdW5kZWZpbmVkKSB3aGVyZS5pc1JlYWQgPSBpc1JlYWQ7XG4gICAgaWYgKHR5cGUpIHdoZXJlLnR5cGUgPSB0eXBlO1xuICAgIGlmIChwcmlvcml0eSkgd2hlcmUucHJpb3JpdHkgPSBwcmlvcml0eTtcblxuICAgIHJldHVybiB0aGlzLnByaXNtYS5ub3RpZmljYXRpb24uZmluZE1hbnkoe1xuICAgICAgd2hlcmUsXG4gICAgICBvcmRlckJ5OiBbeyBwcmlvcml0eTogJ2Rlc2MnIH0sIHsgY3JlYXRlZEF0OiAnZGVzYycgfV0sXG4gICAgICB0YWtlOiA1MCwgLy8gTGltaXQgdG8gcmVjZW50IG5vdGlmaWNhdGlvbnNcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIGZpbmRPbmUoaWQ6IHN0cmluZyk6IFByb21pc2U8Tm90aWZpY2F0aW9uIHwgbnVsbD4ge1xuICAgIHJldHVybiB0aGlzLnByaXNtYS5ub3RpZmljYXRpb24uZmluZFVuaXF1ZSh7XG4gICAgICB3aGVyZTogeyBpZCB9LFxuICAgICAgaW5jbHVkZToge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICAgIGZpcnN0TmFtZTogdHJ1ZSxcbiAgICAgICAgICAgIGxhc3ROYW1lOiB0cnVlLFxuICAgICAgICAgICAgZW1haWw6IHRydWUsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBtYXJrQXNSZWFkKGlkOiBzdHJpbmcpOiBQcm9taXNlPE5vdGlmaWNhdGlvbj4ge1xuICAgIGNvbnN0IG5vdGlmaWNhdGlvbiA9IGF3YWl0IHRoaXMuZmluZE9uZShpZCk7XG4gICAgaWYgKCFub3RpZmljYXRpb24pIHtcbiAgICAgIHRocm93IG5ldyBOb3RGb3VuZEV4Y2VwdGlvbihgTm90aWZpY2F0aW9uIHdpdGggSUQgJHtpZH0gbm90IGZvdW5kYCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMucHJpc21hLm5vdGlmaWNhdGlvbi51cGRhdGUoe1xuICAgICAgd2hlcmU6IHsgaWQgfSxcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgaXNSZWFkOiB0cnVlLFxuICAgICAgICByZWFkQXQ6IG5ldyBEYXRlKCksXG4gICAgICB9LFxuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgbWFya0FsbEFzUmVhZCh1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8eyBjb3VudDogbnVtYmVyIH0+IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnByaXNtYS5ub3RpZmljYXRpb24udXBkYXRlTWFueSh7XG4gICAgICB3aGVyZToge1xuICAgICAgICB1c2VySWQsXG4gICAgICAgIGlzUmVhZDogZmFsc2UsXG4gICAgICB9LFxuICAgICAgZGF0YToge1xuICAgICAgICBpc1JlYWQ6IHRydWUsXG4gICAgICAgIHJlYWRBdDogbmV3IERhdGUoKSxcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICByZXR1cm4geyBjb3VudDogcmVzdWx0LmNvdW50IH07XG4gIH1cblxuICBhc3luYyBkZWxldGUoaWQ6IHN0cmluZyk6IFByb21pc2U8Tm90aWZpY2F0aW9uPiB7XG4gICAgY29uc3Qgbm90aWZpY2F0aW9uID0gYXdhaXQgdGhpcy5maW5kT25lKGlkKTtcbiAgICBpZiAoIW5vdGlmaWNhdGlvbikge1xuICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uKGBOb3RpZmljYXRpb24gd2l0aCBJRCAke2lkfSBub3QgZm91bmRgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5wcmlzbWEubm90aWZpY2F0aW9uLmRlbGV0ZSh7XG4gICAgICB3aGVyZTogeyBpZCB9LFxuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgZ2V0VW5yZWFkQ291bnQodXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPG51bWJlcj4ge1xuICAgIHJldHVybiB0aGlzLnByaXNtYS5ub3RpZmljYXRpb24uY291bnQoe1xuICAgICAgd2hlcmU6IHtcbiAgICAgICAgdXNlcklkLFxuICAgICAgICBpc1JlYWQ6IGZhbHNlLFxuICAgICAgfSxcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIGdldE5vdGlmaWNhdGlvblNldHRpbmdzKHVzZXJJZDogc3RyaW5nKSB7XG4gICAgLy8gUmV0dXJuIGRlZmF1bHQgbm90aWZpY2F0aW9uIHNldHRpbmdzIHNpbmNlIG5vdGlmaWNhdGlvblNldHRpbmdzIG1vZGVsIGRvZXNuJ3QgZXhpc3RcbiAgICAvLyBUaGlzIHByb3ZpZGVzIGEgY29uc2lzdGVudCBpbnRlcmZhY2Ugd2hpbGUgdXNpbmcgaW4tbWVtb3J5IGRlZmF1bHRzXG4gICAgcmV0dXJuIHtcbiAgICAgIGlkOiBgZGVmYXVsdC0ke3VzZXJJZH1gLFxuICAgICAgdXNlcklkLFxuICAgICAgZW1haWxBcHBvaW50bWVudFJlbWluZGVyczogdHJ1ZSxcbiAgICAgIGVtYWlsTmV3TWVzc2FnZXM6IHRydWUsXG4gICAgICBlbWFpbFdvcmtzaGVldFVwZGF0ZXM6IHRydWUsXG4gICAgICBlbWFpbFN5c3RlbVVwZGF0ZXM6IGZhbHNlLFxuICAgICAgZW1haWxNYXJrZXRpbmc6IGZhbHNlLFxuICAgICAgcHVzaEFwcG9pbnRtZW50UmVtaW5kZXJzOiB0cnVlLFxuICAgICAgcHVzaE5ld01lc3NhZ2VzOiB0cnVlLFxuICAgICAgcHVzaFdvcmtzaGVldFVwZGF0ZXM6IHRydWUsXG4gICAgICBwdXNoU3lzdGVtVXBkYXRlczogZmFsc2UsXG4gICAgICBpbkFwcE1lc3NhZ2VzOiB0cnVlLFxuICAgICAgaW5BcHBVcGRhdGVzOiB0cnVlLFxuICAgICAgcXVpZXRIb3Vyc0VuYWJsZWQ6IGZhbHNlLFxuICAgICAgcXVpZXRIb3Vyc1N0YXJ0OiAnMjI6MDAnLFxuICAgICAgcXVpZXRIb3Vyc0VuZDogJzA4OjAwJyxcbiAgICAgIHF1aWV0SG91cnNUaW1lem9uZTogJ1VUQycsXG4gICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgfTtcbiAgfVxuXG4gIGFzeW5jIHVwZGF0ZU5vdGlmaWNhdGlvblNldHRpbmdzKFxuICAgIHVzZXJJZDogc3RyaW5nLFxuICAgIGRhdGE6IHtcbiAgICAgIGVtYWlsQXBwb2ludG1lbnRSZW1pbmRlcnM/OiBib29sZWFuO1xuICAgICAgZW1haWxOZXdNZXNzYWdlcz86IGJvb2xlYW47XG4gICAgICBlbWFpbFdvcmtzaGVldFVwZGF0ZXM/OiBib29sZWFuO1xuICAgICAgZW1haWxTeXN0ZW1VcGRhdGVzPzogYm9vbGVhbjtcbiAgICAgIGVtYWlsTWFya2V0aW5nPzogYm9vbGVhbjtcbiAgICAgIHB1c2hBcHBvaW50bWVudFJlbWluZGVycz86IGJvb2xlYW47XG4gICAgICBwdXNoTmV3TWVzc2FnZXM/OiBib29sZWFuO1xuICAgICAgcHVzaFdvcmtzaGVldFVwZGF0ZXM/OiBib29sZWFuO1xuICAgICAgcHVzaFN5c3RlbVVwZGF0ZXM/OiBib29sZWFuO1xuICAgICAgaW5BcHBNZXNzYWdlcz86IGJvb2xlYW47XG4gICAgICBpbkFwcFVwZGF0ZXM/OiBib29sZWFuO1xuICAgICAgcXVpZXRIb3Vyc0VuYWJsZWQ/OiBib29sZWFuO1xuICAgICAgcXVpZXRIb3Vyc1N0YXJ0Pzogc3RyaW5nO1xuICAgICAgcXVpZXRIb3Vyc0VuZD86IHN0cmluZztcbiAgICAgIHF1aWV0SG91cnNUaW1lem9uZT86IHN0cmluZztcbiAgICB9LFxuICApIHtcbiAgICAvLyBSZXR1cm4gdXBkYXRlZCBkZWZhdWx0IHNldHRpbmdzIHNpbmNlIG5vdGlmaWNhdGlvblNldHRpbmdzIG1vZGVsIGRvZXNuJ3QgZXhpc3RcbiAgICAvLyBUaGlzIHByb3ZpZGVzIGEgY29uc2lzdGVudCBpbnRlcmZhY2Ugd2hpbGUgdXNpbmcgaW4tbWVtb3J5IGRlZmF1bHRzXG4gICAgY29uc3QgY3VycmVudFNldHRpbmdzID0gYXdhaXQgdGhpcy5nZXROb3RpZmljYXRpb25TZXR0aW5ncyh1c2VySWQpO1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAuLi5jdXJyZW50U2V0dGluZ3MsXG4gICAgICAuLi5kYXRhLFxuICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogRGVsaXZlciBub3RpZmljYXRpb24gdGhyb3VnaCBjb25maWd1cmVkIGNoYW5uZWxzXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGRlbGl2ZXJOb3RpZmljYXRpb24oXG4gICAgbm90aWZpY2F0aW9uOiBOb3RpZmljYXRpb24gJiB7IHVzZXI6IGFueSB9LFxuICAgIG9wdGlvbnM6IE5vdGlmaWNhdGlvbkRlbGl2ZXJ5T3B0aW9ucyxcbiAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFJlYWwtdGltZSBXZWJTb2NrZXQgZGVsaXZlcnlcbiAgICAgIGlmIChvcHRpb25zLnJlYWxUaW1lICYmIHRoaXMud2ViU29ja2V0U2VydmVyKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuZGVsaXZlclJlYWxUaW1lTm90aWZpY2F0aW9uKG5vdGlmaWNhdGlvbik7XG4gICAgICB9XG5cbiAgICAgIC8vIEVtYWlsIGRlbGl2ZXJ5IChpZiBjb25maWd1cmVkKVxuICAgICAgaWYgKG9wdGlvbnMuZW1haWwpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5kZWxpdmVyRW1haWxOb3RpZmljYXRpb24obm90aWZpY2F0aW9uKTtcbiAgICAgIH1cblxuICAgICAgLy8gUHVzaCBub3RpZmljYXRpb24gZGVsaXZlcnkgKGlmIGNvbmZpZ3VyZWQpXG4gICAgICBpZiAob3B0aW9ucy5wdXNoKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuZGVsaXZlclB1c2hOb3RpZmljYXRpb24obm90aWZpY2F0aW9uKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoXG4gICAgICAgIGBFcnJvciBkZWxpdmVyaW5nIG5vdGlmaWNhdGlvbiAke25vdGlmaWNhdGlvbi5pZH06YCxcbiAgICAgICAgZXJyb3IsXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBEZWxpdmVyIHJlYWwtdGltZSBub3RpZmljYXRpb24gdmlhIFdlYlNvY2tldFxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBkZWxpdmVyUmVhbFRpbWVOb3RpZmljYXRpb24oXG4gICAgbm90aWZpY2F0aW9uOiBOb3RpZmljYXRpb24gJiB7IHVzZXI6IGFueSB9LFxuICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAoIXRoaXMud2ViU29ja2V0U2VydmVyKSB7XG4gICAgICB0aGlzLmxvZ2dlci53YXJuKFxuICAgICAgICAnV2ViU29ja2V0IHNlcnZlciBub3QgY29uZmlndXJlZCBmb3IgcmVhbC10aW1lIG5vdGlmaWNhdGlvbnMnLFxuICAgICAgKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgLy8gU2VuZCB0byB1c2VyJ3MgcGVyc29uYWwgcm9vbVxuICAgICAgdGhpcy53ZWJTb2NrZXRTZXJ2ZXJcbiAgICAgICAgLnRvKGB1c2VyOiR7bm90aWZpY2F0aW9uLnVzZXJJZH1gKVxuICAgICAgICAuZW1pdCgnbm90aWZpY2F0aW9uJywge1xuICAgICAgICAgIGlkOiBub3RpZmljYXRpb24uaWQsXG4gICAgICAgICAgdGl0bGU6IG5vdGlmaWNhdGlvbi50aXRsZSxcbiAgICAgICAgICBtZXNzYWdlOiBub3RpZmljYXRpb24ubWVzc2FnZSxcbiAgICAgICAgICB0eXBlOiBub3RpZmljYXRpb24udHlwZSxcbiAgICAgICAgICBwcmlvcml0eTogbm90aWZpY2F0aW9uLnByaW9yaXR5LFxuICAgICAgICAgIGFjdGlvblVybDogbm90aWZpY2F0aW9uLmFjdGlvblVybCxcbiAgICAgICAgICBkYXRhOiBub3RpZmljYXRpb24uZGF0YSxcbiAgICAgICAgICBjcmVhdGVkQXQ6IG5vdGlmaWNhdGlvbi5jcmVhdGVkQXQsXG4gICAgICAgICAgaXNSZWFkOiBmYWxzZSxcbiAgICAgICAgfSk7XG5cbiAgICAgIC8vIFNlbmQgdW5yZWFkIGNvdW50IHVwZGF0ZVxuICAgICAgY29uc3QgdW5yZWFkQ291bnQgPSBhd2FpdCB0aGlzLmdldFVucmVhZENvdW50KG5vdGlmaWNhdGlvbi51c2VySWQpO1xuICAgICAgdGhpcy53ZWJTb2NrZXRTZXJ2ZXJcbiAgICAgICAgLnRvKGB1c2VyOiR7bm90aWZpY2F0aW9uLnVzZXJJZH1gKVxuICAgICAgICAuZW1pdCgndW5yZWFkQ291bnQnLCB7XG4gICAgICAgICAgY291bnQ6IHVucmVhZENvdW50LFxuICAgICAgICB9KTtcblxuICAgICAgdGhpcy5sb2dnZXIubG9nKFxuICAgICAgICBgUmVhbC10aW1lIG5vdGlmaWNhdGlvbiBkZWxpdmVyZWQgdG8gdXNlciAke25vdGlmaWNhdGlvbi51c2VySWR9YCxcbiAgICAgICk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMubG9nZ2VyLmVycm9yKGBFcnJvciBkZWxpdmVyaW5nIHJlYWwtdGltZSBub3RpZmljYXRpb246YCwgZXJyb3IpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBEZWxpdmVyIGVtYWlsIG5vdGlmaWNhdGlvbiAocGxhY2Vob2xkZXIgZm9yIGVtYWlsIHNlcnZpY2UgaW50ZWdyYXRpb24pXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGRlbGl2ZXJFbWFpbE5vdGlmaWNhdGlvbihcbiAgICBub3RpZmljYXRpb246IE5vdGlmaWNhdGlvbiAmIHsgdXNlcjogYW55IH0sXG4gICk6IFByb21pc2U8dm9pZD4ge1xuICAgIC8vIFRPRE86IEludGVncmF0ZSB3aXRoIGVtYWlsIHNlcnZpY2UgKFNlbmRHcmlkLCBBV1MgU0VTLCBldGMuKVxuICAgIHRoaXMubG9nZ2VyLmxvZyhcbiAgICAgIGBFbWFpbCBub3RpZmljYXRpb24gcXVldWVkIGZvciB1c2VyICR7bm90aWZpY2F0aW9uLnVzZXJJZH1gLFxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogRGVsaXZlciBwdXNoIG5vdGlmaWNhdGlvbiAocGxhY2Vob2xkZXIgZm9yIHB1c2ggc2VydmljZSBpbnRlZ3JhdGlvbilcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgZGVsaXZlclB1c2hOb3RpZmljYXRpb24oXG4gICAgbm90aWZpY2F0aW9uOiBOb3RpZmljYXRpb24gJiB7IHVzZXI6IGFueSB9LFxuICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAvLyBUT0RPOiBJbnRlZ3JhdGUgd2l0aCBwdXNoIG5vdGlmaWNhdGlvbiBzZXJ2aWNlIChGQ00sIEFQTlMsIGV0Yy4pXG4gICAgdGhpcy5sb2dnZXIubG9nKGBQdXNoIG5vdGlmaWNhdGlvbiBxdWV1ZWQgZm9yIHVzZXIgJHtub3RpZmljYXRpb24udXNlcklkfWApO1xuICB9XG5cbiAgLyoqXG4gICAqIEJhdGNoIGNyZWF0ZSBub3RpZmljYXRpb25zIHdpdGggb3B0aW1pemVkIGRlbGl2ZXJ5XG4gICAqL1xuICBhc3luYyBjcmVhdGVCYXRjaChcbiAgICBub3RpZmljYXRpb25zOiBBcnJheTx7XG4gICAgICB1c2VySWQ6IHN0cmluZztcbiAgICAgIHRpdGxlOiBzdHJpbmc7XG4gICAgICBtZXNzYWdlOiBzdHJpbmc7XG4gICAgICB0eXBlOiBOb3RpZmljYXRpb25UeXBlO1xuICAgICAgcHJpb3JpdHk/OiBOb3RpZmljYXRpb25Qcmlvcml0eTtcbiAgICAgIGRhdGE/OiBhbnk7XG4gICAgICBhY3Rpb25Vcmw/OiBzdHJpbmc7XG4gICAgfT4sXG4gICAgZGVsaXZlcnlPcHRpb25zPzogTm90aWZpY2F0aW9uRGVsaXZlcnlPcHRpb25zLFxuICApOiBQcm9taXNlPE5vdGlmaWNhdGlvbltdPiB7XG4gICAgY29uc3QgY3JlYXRlZE5vdGlmaWNhdGlvbnM6IE5vdGlmaWNhdGlvbltdID0gW107XG5cbiAgICAvLyBDcmVhdGUgbm90aWZpY2F0aW9ucyBpbiBiYXRjaGVzIGZvciBiZXR0ZXIgcGVyZm9ybWFuY2VcbiAgICBmb3IgKGNvbnN0IG5vdGlmaWNhdGlvbkRhdGEgb2Ygbm90aWZpY2F0aW9ucykge1xuICAgICAgY29uc3Qgbm90aWZpY2F0aW9uID0gYXdhaXQgdGhpcy5jcmVhdGUobm90aWZpY2F0aW9uRGF0YSwgZGVsaXZlcnlPcHRpb25zKTtcbiAgICAgIGNyZWF0ZWROb3RpZmljYXRpb25zLnB1c2gobm90aWZpY2F0aW9uKTtcbiAgICB9XG5cbiAgICByZXR1cm4gY3JlYXRlZE5vdGlmaWNhdGlvbnM7XG4gIH1cblxuICAvKipcbiAgICogU2VuZCBub3RpZmljYXRpb24gdG8gYWxsIHVzZXJzIGluIGEgY29tbXVuaXR5XG4gICAqL1xuICBhc3luYyBzZW5kVG9Db21tdW5pdHkoXG4gICAgY29tbXVuaXR5SWQ6IHN0cmluZyxcbiAgICBub3RpZmljYXRpb246IE9taXQ8UGFyYW1ldGVyczx0eXBlb2YgdGhpcy5jcmVhdGU+WzBdLCAndXNlcklkJz4sXG4gICAgZGVsaXZlcnlPcHRpb25zPzogTm90aWZpY2F0aW9uRGVsaXZlcnlPcHRpb25zLFxuICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgLy8gR2V0IGFsbCBjb21tdW5pdHkgbWVtYmVyc1xuICAgICAgY29uc3QgbWVtYmVycyA9IGF3YWl0IHRoaXMucHJpc21hLm1lbWJlcnNoaXAuZmluZE1hbnkoe1xuICAgICAgICB3aGVyZTogeyBjb21tdW5pdHlJZCB9LFxuICAgICAgICBzZWxlY3Q6IHsgdXNlcklkOiB0cnVlIH0sXG4gICAgICB9KTtcblxuICAgICAgLy8gQ3JlYXRlIG5vdGlmaWNhdGlvbnMgZm9yIGFsbCBtZW1iZXJzIChmaWx0ZXIgb3V0IG51bGwgdXNlcklkcylcbiAgICAgIGNvbnN0IG5vdGlmaWNhdGlvbnMgPSBtZW1iZXJzXG4gICAgICAgIC5maWx0ZXIoKG1lbWJlcikgPT4gbWVtYmVyLnVzZXJJZCAhPT0gbnVsbClcbiAgICAgICAgLm1hcCgobWVtYmVyKSA9PiAoe1xuICAgICAgICAgIC4uLm5vdGlmaWNhdGlvbixcbiAgICAgICAgICB1c2VySWQ6IG1lbWJlci51c2VySWQhLFxuICAgICAgICB9KSk7XG5cbiAgICAgIGF3YWl0IHRoaXMuY3JlYXRlQmF0Y2gobm90aWZpY2F0aW9ucywgZGVsaXZlcnlPcHRpb25zKTtcblxuICAgICAgdGhpcy5sb2dnZXIubG9nKFxuICAgICAgICBgU2VudCBub3RpZmljYXRpb25zIHRvICR7bWVtYmVycy5sZW5ndGh9IGNvbW11bml0eSBtZW1iZXJzYCxcbiAgICAgICk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMubG9nZ2VyLmVycm9yKFxuICAgICAgICBgRXJyb3Igc2VuZGluZyBub3RpZmljYXRpb25zIHRvIGNvbW11bml0eSAke2NvbW11bml0eUlkfTpgLFxuICAgICAgICBlcnJvcixcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgLy8gPT09PT0gRVZFTlQgTElTVEVORVJTIEZPUiBDT01NVU5JVFkgUkVDT01NRU5EQVRJT04gU1lTVEVNID09PT09XG5cbiAgLyoqXG4gICAqIEhhbmRsZSBjb21tdW5pdHkgcmVjb21tZW5kYXRpb24gZ2VuZXJhdGVkIGV2ZW50c1xuICAgKi9cbiAgQE9uRXZlbnQoJ2NvbW11bml0eS5yZWNvbW1lbmRhdGlvbnMuZ2VuZXJhdGVkJylcbiAgYXN5bmMgaGFuZGxlUmVjb21tZW5kYXRpb25zR2VuZXJhdGVkKHBheWxvYWQ6IHtcbiAgICB1c2VySWQ6IHN0cmluZztcbiAgICByZWNvbW1lbmRhdGlvbkNvdW50OiBudW1iZXI7XG4gICAgdGltZXN0YW1wOiBEYXRlO1xuICB9KSB7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHRoaXMuY3JlYXRlKFxuICAgICAgICB7XG4gICAgICAgICAgdXNlcklkOiBwYXlsb2FkLnVzZXJJZCxcbiAgICAgICAgICB0aXRsZTogJ05ldyBDb21tdW5pdHkgUmVjb21tZW5kYXRpb25zJyxcbiAgICAgICAgICBtZXNzYWdlOiBgV2UndmUgZm91bmQgJHtwYXlsb2FkLnJlY29tbWVuZGF0aW9uQ291bnR9IG5ldyBjb21tdW5pdGllcyB0aGF0IG1pZ2h0IGludGVyZXN0IHlvdSBiYXNlZCBvbiB5b3VyIGFzc2Vzc21lbnQgcmVzdWx0cy5gLFxuICAgICAgICAgIHR5cGU6IE5vdGlmaWNhdGlvblR5cGUuQ09NTVVOSVRZX1JFQ09NTUVOREFUSU9OLFxuICAgICAgICAgIHByaW9yaXR5OiBOb3RpZmljYXRpb25Qcmlvcml0eS5OT1JNQUwsXG4gICAgICAgICAgYWN0aW9uVXJsOiAnL2NvbW11bml0aWVzL3JlY29tbWVuZGF0aW9ucycsXG4gICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgcmVjb21tZW5kYXRpb25Db3VudDogcGF5bG9hZC5yZWNvbW1lbmRhdGlvbkNvdW50LFxuICAgICAgICAgICAgZ2VuZXJhdGVkQXQ6IHBheWxvYWQudGltZXN0YW1wLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICByZWFsVGltZTogdHJ1ZSxcbiAgICAgICAgICBlbWFpbDogZmFsc2UsXG4gICAgICAgICAgcHVzaDogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgICk7XG5cbiAgICAgIHRoaXMubG9nZ2VyLmxvZyhcbiAgICAgICAgYENvbW11bml0eSByZWNvbW1lbmRhdGlvbiBub3RpZmljYXRpb24gc2VudCB0byB1c2VyICR7cGF5bG9hZC51c2VySWR9YCxcbiAgICAgICk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMubG9nZ2VyLmVycm9yKFxuICAgICAgICBgRXJyb3IgaGFuZGxpbmcgcmVjb21tZW5kYXRpb25zIGdlbmVyYXRlZCBldmVudDpgLFxuICAgICAgICBlcnJvcixcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEhhbmRsZSBjb21tdW5pdHkgcmVjb21tZW5kYXRpb24gaW50ZXJhY3Rpb24gZXZlbnRzXG4gICAqL1xuICBAT25FdmVudCgnY29tbXVuaXR5LnJlY29tbWVuZGF0aW9uLmludGVyYWN0aW9uJylcbiAgYXN5bmMgaGFuZGxlUmVjb21tZW5kYXRpb25JbnRlcmFjdGlvbihwYXlsb2FkOiB7XG4gICAgdXNlcklkOiBzdHJpbmc7XG4gICAgY29tbXVuaXR5SWQ6IHN0cmluZztcbiAgICBjb21tdW5pdHlOYW1lOiBzdHJpbmc7XG4gICAgYWN0aW9uOiAnYWNjZXB0JyB8ICdyZWplY3QnO1xuICAgIGNvbXBhdGliaWxpdHlTY29yZTogbnVtYmVyO1xuICAgIHRpbWVzdGFtcDogRGF0ZTtcbiAgfSkge1xuICAgIHRyeSB7XG4gICAgICBpZiAocGF5bG9hZC5hY3Rpb24gPT09ICdhY2NlcHQnKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuY3JlYXRlKFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHVzZXJJZDogcGF5bG9hZC51c2VySWQsXG4gICAgICAgICAgICB0aXRsZTogYFdlbGNvbWUgdG8gJHtwYXlsb2FkLmNvbW11bml0eU5hbWV9IWAsXG4gICAgICAgICAgICBtZXNzYWdlOiBgWW91J3ZlIHN1Y2Nlc3NmdWxseSBqb2luZWQgJHtwYXlsb2FkLmNvbW11bml0eU5hbWV9LiBTdGFydCBleHBsb3JpbmcgYW5kIGNvbm5lY3Rpbmcgd2l0aCB0aGUgY29tbXVuaXR5LmAsXG4gICAgICAgICAgICB0eXBlOiBOb3RpZmljYXRpb25UeXBlLkNPTU1VTklUWV9KT0lORUQsXG4gICAgICAgICAgICBwcmlvcml0eTogTm90aWZpY2F0aW9uUHJpb3JpdHkuSElHSCxcbiAgICAgICAgICAgIGFjdGlvblVybDogYC9jb21tdW5pdGllcy8ke3BheWxvYWQuY29tbXVuaXR5SWR9YCxcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgY29tbXVuaXR5SWQ6IHBheWxvYWQuY29tbXVuaXR5SWQsXG4gICAgICAgICAgICAgIGNvbW11bml0eU5hbWU6IHBheWxvYWQuY29tbXVuaXR5TmFtZSxcbiAgICAgICAgICAgICAgY29tcGF0aWJpbGl0eVNjb3JlOiBwYXlsb2FkLmNvbXBhdGliaWxpdHlTY29yZSxcbiAgICAgICAgICAgICAgam9pbk1ldGhvZDogJ3JlY29tbWVuZGF0aW9uX2FjY2VwdGVkJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICByZWFsVGltZTogdHJ1ZSxcbiAgICAgICAgICAgIGVtYWlsOiBmYWxzZSxcbiAgICAgICAgICAgIHB1c2g6IHRydWUsXG4gICAgICAgICAgfSxcbiAgICAgICAgKTtcblxuICAgICAgICB0aGlzLmxvZ2dlci5sb2coXG4gICAgICAgICAgYENvbW11bml0eSBqb2luIG5vdGlmaWNhdGlvbiBzZW50IHRvIHVzZXIgJHtwYXlsb2FkLnVzZXJJZH1gLFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aGlzLmxvZ2dlci5lcnJvcihcbiAgICAgICAgYEVycm9yIGhhbmRsaW5nIHJlY29tbWVuZGF0aW9uIGludGVyYWN0aW9uIGV2ZW50OmAsXG4gICAgICAgIGVycm9yLFxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogSGFuZGxlIGNvbW11bml0eSBtZW1iZXIgam9pbmVkIGV2ZW50c1xuICAgKi9cbiAgQE9uRXZlbnQoJ2NvbW11bml0eS5tZW1iZXIuam9pbmVkJylcbiAgYXN5bmMgaGFuZGxlTWVtYmVySm9pbmVkKHBheWxvYWQ6IHtcbiAgICB1c2VySWQ6IHN0cmluZztcbiAgICBjb21tdW5pdHlJZDogc3RyaW5nO1xuICAgIGpvaW5NZXRob2Q6IHN0cmluZztcbiAgICB0aW1lc3RhbXA6IERhdGU7XG4gIH0pIHtcbiAgICB0cnkge1xuICAgICAgLy8gR2V0IGNvbW11bml0eSBkZXRhaWxzXG4gICAgICBjb25zdCBjb21tdW5pdHkgPSBhd2FpdCB0aGlzLnByaXNtYS5jb21tdW5pdHkuZmluZFVuaXF1ZSh7XG4gICAgICAgIHdoZXJlOiB7IGlkOiBwYXlsb2FkLmNvbW11bml0eUlkIH0sXG4gICAgICAgIHNlbGVjdDogeyBuYW1lOiB0cnVlLCBfY291bnQ6IHsgc2VsZWN0OiB7IG1lbWJlcnNoaXBzOiB0cnVlIH0gfSB9LFxuICAgICAgfSk7XG5cbiAgICAgIGlmICghY29tbXVuaXR5KSByZXR1cm47XG5cbiAgICAgIC8vIFNlbmQgd2VsY29tZSBub3RpZmljYXRpb24gdG8gdGhlIG5ldyBtZW1iZXJcbiAgICAgIGF3YWl0IHRoaXMuY3JlYXRlKFxuICAgICAgICB7XG4gICAgICAgICAgdXNlcklkOiBwYXlsb2FkLnVzZXJJZCxcbiAgICAgICAgICB0aXRsZTogYFdlbGNvbWUgdG8gJHtjb21tdW5pdHkubmFtZX0hYCxcbiAgICAgICAgICBtZXNzYWdlOiBgWW91J3JlIG5vdyBwYXJ0IG9mIGEgY29tbXVuaXR5IHdpdGggJHtjb21tdW5pdHkuX2NvdW50Lm1lbWJlcnNoaXBzfSBtZW1iZXJzLiBTdGFydCBleHBsb3JpbmcgYW5kIGNvbm5lY3RpbmchYCxcbiAgICAgICAgICB0eXBlOiBOb3RpZmljYXRpb25UeXBlLkNPTU1VTklUWV9XRUxDT01FLFxuICAgICAgICAgIHByaW9yaXR5OiBOb3RpZmljYXRpb25Qcmlvcml0eS5ISUdILFxuICAgICAgICAgIGFjdGlvblVybDogYC9jb21tdW5pdGllcy8ke3BheWxvYWQuY29tbXVuaXR5SWR9YCxcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBjb21tdW5pdHlJZDogcGF5bG9hZC5jb21tdW5pdHlJZCxcbiAgICAgICAgICAgIGNvbW11bml0eU5hbWU6IGNvbW11bml0eS5uYW1lLFxuICAgICAgICAgICAgbWVtYmVyQ291bnQ6IGNvbW11bml0eS5fY291bnQubWVtYmVyc2hpcHMsXG4gICAgICAgICAgICBqb2luTWV0aG9kOiBwYXlsb2FkLmpvaW5NZXRob2QsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHJlYWxUaW1lOiB0cnVlLFxuICAgICAgICAgIGVtYWlsOiBmYWxzZSxcbiAgICAgICAgICBwdXNoOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgKTtcblxuICAgICAgdGhpcy5sb2dnZXIubG9nKFxuICAgICAgICBgQ29tbXVuaXR5IHdlbGNvbWUgbm90aWZpY2F0aW9uIHNlbnQgdG8gdXNlciAke3BheWxvYWQudXNlcklkfWAsXG4gICAgICApO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aGlzLmxvZ2dlci5lcnJvcihgRXJyb3IgaGFuZGxpbmcgbWVtYmVyIGpvaW5lZCBldmVudDpgLCBlcnJvcik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEhhbmRsZSByZWNvbW1lbmRhdGlvbnMgcmVmcmVzaGVkIGV2ZW50c1xuICAgKi9cbiAgQE9uRXZlbnQoJ2NvbW11bml0eS5yZWNvbW1lbmRhdGlvbnMucmVmcmVzaGVkJylcbiAgYXN5bmMgaGFuZGxlUmVjb21tZW5kYXRpb25zUmVmcmVzaGVkKHBheWxvYWQ6IHtcbiAgICB1c2VySWQ6IHN0cmluZztcbiAgICB0aW1lc3RhbXA6IERhdGU7XG4gIH0pIHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgdGhpcy5jcmVhdGUoXG4gICAgICAgIHtcbiAgICAgICAgICB1c2VySWQ6IHBheWxvYWQudXNlcklkLFxuICAgICAgICAgIHRpdGxlOiAnQ29tbXVuaXR5IFJlY29tbWVuZGF0aW9ucyBVcGRhdGVkJyxcbiAgICAgICAgICBtZXNzYWdlOlxuICAgICAgICAgICAgJ1lvdXIgY29tbXVuaXR5IHJlY29tbWVuZGF0aW9ucyBoYXZlIGJlZW4gdXBkYXRlZCBiYXNlZCBvbiB5b3VyIGxhdGVzdCBhc3Nlc3NtZW50IHJlc3VsdHMuJyxcbiAgICAgICAgICB0eXBlOiBOb3RpZmljYXRpb25UeXBlLlJFQ09NTUVOREFUSU9OU19VUERBVEVELFxuICAgICAgICAgIHByaW9yaXR5OiBOb3RpZmljYXRpb25Qcmlvcml0eS5OT1JNQUwsXG4gICAgICAgICAgYWN0aW9uVXJsOiAnL2NvbW11bml0aWVzL3JlY29tbWVuZGF0aW9ucycsXG4gICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgcmVmcmVzaGVkQXQ6IHBheWxvYWQudGltZXN0YW1wLFxuICAgICAgICAgICAgcmVhc29uOiAnYXNzZXNzbWVudF9jaGFuZ2UnLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICByZWFsVGltZTogdHJ1ZSxcbiAgICAgICAgICBlbWFpbDogZmFsc2UsXG4gICAgICAgICAgcHVzaDogZmFsc2UsXG4gICAgICAgIH0sXG4gICAgICApO1xuXG4gICAgICB0aGlzLmxvZ2dlci5sb2coXG4gICAgICAgIGBSZWNvbW1lbmRhdGlvbnMgcmVmcmVzaGVkIG5vdGlmaWNhdGlvbiBzZW50IHRvIHVzZXIgJHtwYXlsb2FkLnVzZXJJZH1gLFxuICAgICAgKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoXG4gICAgICAgIGBFcnJvciBoYW5kbGluZyByZWNvbW1lbmRhdGlvbnMgcmVmcmVzaGVkIGV2ZW50OmAsXG4gICAgICAgIGVycm9yLFxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICAvLyA9PT09PSBNRVNTQUdJTkcgRVZFTlQgTElTVEVORVJTID09PT09XG5cbiAgLyoqXG4gICAqIEhhbmRsZSBtZXNzYWdlIHNlbnQgZXZlbnRzIHRvIGNyZWF0ZSBNRVNTQUdFX1JFQ0VJVkVEIG5vdGlmaWNhdGlvbnNcbiAgICovXG4gIEBPbkV2ZW50KCdNZXNzYWdlU2VudEV2ZW50JylcbiAgYXN5bmMgaGFuZGxlTWVzc2FnZVNlbnQoZXZlbnQ6IE1lc3NhZ2VTZW50RXZlbnQpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBcbiAgICAgICAgc2VuZGVySWQsIFxuICAgICAgICBjb252ZXJzYXRpb25JZCwgXG4gICAgICAgIGNvbnRlbnQsIFxuICAgICAgICByZWNpcGllbnRJZHMgXG4gICAgICB9ID0gZXZlbnQuZXZlbnREYXRhO1xuXG4gICAgICAvLyBHZXQgc2VuZGVyIGRldGFpbHNcbiAgICAgIGNvbnN0IHNlbmRlciA9IGF3YWl0IHRoaXMucHJpc21hLnVzZXIuZmluZFVuaXF1ZSh7XG4gICAgICAgIHdoZXJlOiB7IGlkOiBzZW5kZXJJZCB9LFxuICAgICAgICBzZWxlY3Q6IHsgZmlyc3ROYW1lOiB0cnVlLCBsYXN0TmFtZTogdHJ1ZSB9LFxuICAgICAgfSk7XG5cbiAgICAgIGlmICghc2VuZGVyKSB7XG4gICAgICAgIHRoaXMubG9nZ2VyLndhcm4oYFNlbmRlciBub3QgZm91bmQgZm9yIG1lc3NhZ2Ugbm90aWZpY2F0aW9uOiAke3NlbmRlcklkfWApO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHNlbmRlck5hbWUgPSBgJHtzZW5kZXIuZmlyc3ROYW1lfSAke3NlbmRlci5sYXN0TmFtZX1gO1xuXG4gICAgICAvLyBDcmVhdGUgbm90aWZpY2F0aW9ucyBmb3IgZWFjaCByZWNpcGllbnRcbiAgICAgIGZvciAoY29uc3QgcmVjaXBpZW50SWQgb2YgcmVjaXBpZW50SWRzKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuY3JlYXRlKFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHVzZXJJZDogcmVjaXBpZW50SWQsXG4gICAgICAgICAgICB0aXRsZTogJ05ldyBNZXNzYWdlJyxcbiAgICAgICAgICAgIG1lc3NhZ2U6IGBZb3UgaGF2ZSBhIG5ldyBtZXNzYWdlIGZyb20gJHtzZW5kZXJOYW1lfS5gLFxuICAgICAgICAgICAgdHlwZTogTm90aWZpY2F0aW9uVHlwZS5NRVNTQUdFX1JFQ0VJVkVELFxuICAgICAgICAgICAgcHJpb3JpdHk6IE5vdGlmaWNhdGlvblByaW9yaXR5Lk5PUk1BTCxcbiAgICAgICAgICAgIGFjdGlvblVybDogYC9tZXNzYWdlcy8ke2NvbnZlcnNhdGlvbklkfWAsXG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgIHNlbmRlcklkLFxuICAgICAgICAgICAgICBjb252ZXJzYXRpb25JZCxcbiAgICAgICAgICAgICAgbWVzc2FnZVByZXZpZXc6IGNvbnRlbnQuc3Vic3RyaW5nKDAsIDEwMCkgKyAoY29udGVudC5sZW5ndGggPiAxMDAgPyAnLi4uJyA6ICcnKSxcbiAgICAgICAgICAgICAgc2VuZGVyTmFtZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICByZWFsVGltZTogdHJ1ZSxcbiAgICAgICAgICAgIGVtYWlsOiBmYWxzZSxcbiAgICAgICAgICAgIHB1c2g6IHRydWUsXG4gICAgICAgICAgfSxcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5sb2dnZXIubG9nKFxuICAgICAgICBgTWVzc2FnZSBub3RpZmljYXRpb25zIHNlbnQgdG8gJHtyZWNpcGllbnRJZHMubGVuZ3RofSByZWNpcGllbnRzIGZvciBjb252ZXJzYXRpb24gJHtjb252ZXJzYXRpb25JZH1gLFxuICAgICAgKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoXG4gICAgICAgIGBFcnJvciBoYW5kbGluZyBtZXNzYWdlIHNlbnQgZXZlbnQ6YCxcbiAgICAgICAgZXJyb3IsXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBIYW5kbGUgcG9zdCBjcmVhdGVkIGV2ZW50cyB0byBjcmVhdGUgQ09NTVVOSVRZX1BPU1Qgbm90aWZpY2F0aW9ucyBmb3IgY29tbXVuaXR5IG1lbWJlcnNcbiAgICovXG4gIEBPbkV2ZW50KCdQb3N0Q3JlYXRlZEV2ZW50JylcbiAgYXN5bmMgaGFuZGxlUG9zdENyZWF0ZWQoZXZlbnQ6IFBvc3RDcmVhdGVkRXZlbnQpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBcbiAgICAgICAgcG9zdElkLCBcbiAgICAgICAgYXV0aG9ySWQsIFxuICAgICAgICBjb21tdW5pdHlJZCwgXG4gICAgICAgIHRpdGxlLCBcbiAgICAgICAgY29udGVudCwgXG4gICAgICAgIGlzQW5vbnltb3VzIFxuICAgICAgfSA9IGV2ZW50LmV2ZW50RGF0YTtcblxuICAgICAgLy8gU2tpcCBub3RpZmljYXRpb25zIGZvciBhbm9ueW1vdXMgcG9zdHMgb3IgcG9zdHMgd2l0aG91dCBjb21tdW5pdHlcbiAgICAgIGlmIChpc0Fub255bW91cyB8fCAhY29tbXVuaXR5SWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBHZXQgcG9zdCBhdXRob3IgZGV0YWlsc1xuICAgICAgY29uc3QgYXV0aG9yID0gYXdhaXQgdGhpcy5wcmlzbWEudXNlci5maW5kVW5pcXVlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IGF1dGhvcklkIH0sXG4gICAgICAgIHNlbGVjdDogeyBmaXJzdE5hbWU6IHRydWUsIGxhc3ROYW1lOiB0cnVlIH0sXG4gICAgICB9KTtcblxuICAgICAgLy8gR2V0IGNvbW11bml0eSBkZXRhaWxzIGFuZCBtZW1iZXJzXG4gICAgICBjb25zdCBjb21tdW5pdHkgPSBhd2FpdCB0aGlzLnByaXNtYS5jb21tdW5pdHkuZmluZFVuaXF1ZSh7XG4gICAgICAgIHdoZXJlOiB7IGlkOiBjb21tdW5pdHlJZCB9LFxuICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICBuYW1lOiB0cnVlLFxuICAgICAgICAgIG1lbWJlcnNoaXBzOiB7XG4gICAgICAgICAgICB3aGVyZToge1xuICAgICAgICAgICAgICB1c2VySWQ6IHsgbm90OiBhdXRob3JJZCB9LCAvLyBEb24ndCBub3RpZnkgdGhlIGF1dGhvclxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNlbGVjdDogeyB1c2VySWQ6IHRydWUgfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIGlmICghYXV0aG9yIHx8ICFjb21tdW5pdHkpIHtcbiAgICAgICAgdGhpcy5sb2dnZXIud2FybihgQXV0aG9yIG9yIGNvbW11bml0eSBub3QgZm91bmQgZm9yIHBvc3Qgbm90aWZpY2F0aW9uOiAke3Bvc3RJZH1gKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBhdXRob3JOYW1lID0gYCR7YXV0aG9yLmZpcnN0TmFtZX0gJHthdXRob3IubGFzdE5hbWV9YDtcblxuICAgICAgLy8gQ3JlYXRlIG5vdGlmaWNhdGlvbnMgZm9yIGNvbW11bml0eSBtZW1iZXJzXG4gICAgICBjb25zdCBub3RpZmljYXRpb25zID0gY29tbXVuaXR5Lm1lbWJlcnNoaXBzXG4gICAgICAgIC5maWx0ZXIoKG1lbWJlcikgPT4gbWVtYmVyLnVzZXJJZCAhPT0gbnVsbClcbiAgICAgICAgLm1hcCgobWVtYmVyKSA9PiAoe1xuICAgICAgICAgIHVzZXJJZDogbWVtYmVyLnVzZXJJZCEsXG4gICAgICAgICAgdGl0bGU6IGBOZXcgUG9zdCBpbiAke2NvbW11bml0eS5uYW1lfWAsXG4gICAgICAgICAgbWVzc2FnZTogYCR7YXV0aG9yTmFtZX0gcG9zdGVkOiBcIiR7dGl0bGUgfHwgY29udGVudC5zdWJzdHJpbmcoMCwgNTApfSR7Y29udGVudC5sZW5ndGggPiA1MCA/ICcuLi4nIDogJyd9XCJgLFxuICAgICAgICAgIHR5cGU6IE5vdGlmaWNhdGlvblR5cGUuQ09NTVVOSVRZX1BPU1QsXG4gICAgICAgICAgcHJpb3JpdHk6IE5vdGlmaWNhdGlvblByaW9yaXR5LkxPVyxcbiAgICAgICAgICBhY3Rpb25Vcmw6IGAvY29tbXVuaXRpZXMvcG9zdHMvJHtwb3N0SWR9YCxcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBwb3N0SWQsXG4gICAgICAgICAgICBhdXRob3JJZCxcbiAgICAgICAgICAgIGF1dGhvck5hbWUsXG4gICAgICAgICAgICBjb21tdW5pdHlJZCxcbiAgICAgICAgICAgIGNvbW11bml0eU5hbWU6IGNvbW11bml0eS5uYW1lLFxuICAgICAgICAgICAgcG9zdFRpdGxlOiB0aXRsZSxcbiAgICAgICAgICB9LFxuICAgICAgICB9KSk7XG5cbiAgICAgIGF3YWl0IHRoaXMuY3JlYXRlQmF0Y2gobm90aWZpY2F0aW9ucywge1xuICAgICAgICByZWFsVGltZTogdHJ1ZSxcbiAgICAgICAgZW1haWw6IGZhbHNlLFxuICAgICAgICBwdXNoOiBmYWxzZSxcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLmxvZ2dlci5sb2coXG4gICAgICAgIGBQb3N0IG5vdGlmaWNhdGlvbiBzZW50IHRvICR7bm90aWZpY2F0aW9ucy5sZW5ndGh9IGNvbW11bml0eSBtZW1iZXJzIGZvciBwb3N0ICR7cG9zdElkfWAsXG4gICAgICApO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aGlzLmxvZ2dlci5lcnJvcihcbiAgICAgICAgYEVycm9yIGhhbmRsaW5nIHBvc3QgY3JlYXRlZCBldmVudDpgLFxuICAgICAgICBlcnJvcixcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEhhbmRsZSBjb21tZW50IGFkZGVkIGV2ZW50cyB0byBjcmVhdGUgQ09NTVVOSVRZX1JFUExZIG5vdGlmaWNhdGlvbnMgZm9yIHBvc3QgYXV0aG9yIGFuZCBwYXJlbnQgY29tbWVudCBhdXRob3JcbiAgICovXG4gIEBPbkV2ZW50KCdDb21tZW50QWRkZWRFdmVudCcpXG4gIGFzeW5jIGhhbmRsZUNvbW1lbnRBZGRlZChldmVudDogQ29tbWVudEFkZGVkRXZlbnQpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBcbiAgICAgICAgY29tbWVudElkLCBcbiAgICAgICAgcG9zdElkLCBcbiAgICAgICAgYXV0aG9ySWQsIFxuICAgICAgICBjb250ZW50LCBcbiAgICAgICAgcGFyZW50Q29tbWVudElkIFxuICAgICAgfSA9IGV2ZW50LmV2ZW50RGF0YTtcblxuICAgICAgLy8gR2V0IGNvbW1lbnQgYXV0aG9yIGRldGFpbHNcbiAgICAgIGNvbnN0IGF1dGhvciA9IGF3YWl0IHRoaXMucHJpc21hLnVzZXIuZmluZFVuaXF1ZSh7XG4gICAgICAgIHdoZXJlOiB7IGlkOiBhdXRob3JJZCB9LFxuICAgICAgICBzZWxlY3Q6IHsgZmlyc3ROYW1lOiB0cnVlLCBsYXN0TmFtZTogdHJ1ZSB9LFxuICAgICAgfSk7XG5cbiAgICAgIC8vIEdldCBwb3N0IGRldGFpbHMgYW5kIGF1dGhvclxuICAgICAgY29uc3QgcG9zdCA9IGF3YWl0IHRoaXMucHJpc21hLnBvc3QuZmluZFVuaXF1ZSh7XG4gICAgICAgIHdoZXJlOiB7IGlkOiBwb3N0SWQgfSxcbiAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgdGl0bGU6IHRydWUsXG4gICAgICAgICAgdXNlcklkOiB0cnVlLFxuICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgIHNlbGVjdDogeyBmaXJzdE5hbWU6IHRydWUsIGxhc3ROYW1lOiB0cnVlIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoIWF1dGhvciB8fCAhcG9zdCkge1xuICAgICAgICB0aGlzLmxvZ2dlci53YXJuKGBBdXRob3Igb3IgcG9zdCBub3QgZm91bmQgZm9yIGNvbW1lbnQgbm90aWZpY2F0aW9uOiAke2NvbW1lbnRJZH1gKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBhdXRob3JOYW1lID0gYCR7YXV0aG9yLmZpcnN0TmFtZX0gJHthdXRob3IubGFzdE5hbWV9YDtcbiAgICAgIGNvbnN0IHJlY2lwaWVudHMgPSBuZXcgU2V0PHN0cmluZz4oKTtcblxuICAgICAgLy8gTm90aWZ5IHBvc3QgYXV0aG9yIChpZiBub3QgdGhlIGNvbW1lbnRlcilcbiAgICAgIGlmIChwb3N0LnVzZXJJZCAhPT0gYXV0aG9ySWQpIHtcbiAgICAgICAgcmVjaXBpZW50cy5hZGQocG9zdC51c2VySWQpO1xuICAgICAgfVxuXG4gICAgICAvLyBJZiB0aGlzIGlzIGEgcmVwbHkgdG8gYW5vdGhlciBjb21tZW50LCBub3RpZnkgdGhlIHBhcmVudCBjb21tZW50IGF1dGhvclxuICAgICAgaWYgKHBhcmVudENvbW1lbnRJZCkge1xuICAgICAgICBjb25zdCBwYXJlbnRDb21tZW50ID0gYXdhaXQgdGhpcy5wcmlzbWEuY29tbWVudC5maW5kVW5pcXVlKHtcbiAgICAgICAgICB3aGVyZTogeyBpZDogcGFyZW50Q29tbWVudElkIH0sXG4gICAgICAgICAgc2VsZWN0OiB7IHVzZXJJZDogdHJ1ZSB9LFxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAocGFyZW50Q29tbWVudCAmJiBwYXJlbnRDb21tZW50LnVzZXJJZCAhPT0gYXV0aG9ySWQgJiYgcGFyZW50Q29tbWVudC51c2VySWQgIT09IHBvc3QudXNlcklkKSB7XG4gICAgICAgICAgcmVjaXBpZW50cy5hZGQocGFyZW50Q29tbWVudC51c2VySWQpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIENyZWF0ZSBub3RpZmljYXRpb25zIGZvciBhbGwgcmVjaXBpZW50c1xuICAgICAgY29uc3Qgbm90aWZpY2F0aW9ucyA9IEFycmF5LmZyb20ocmVjaXBpZW50cykubWFwKChyZWNpcGllbnRJZCkgPT4gKHtcbiAgICAgICAgdXNlcklkOiByZWNpcGllbnRJZCxcbiAgICAgICAgdGl0bGU6IHBhcmVudENvbW1lbnRJZCA/ICdOZXcgUmVwbHkgdG8gWW91ciBDb21tZW50JyA6ICdOZXcgQ29tbWVudCBvbiBZb3VyIFBvc3QnLFxuICAgICAgICBtZXNzYWdlOiBgJHthdXRob3JOYW1lfSAke3BhcmVudENvbW1lbnRJZCA/ICdyZXBsaWVkIHRvIHlvdXIgY29tbWVudCcgOiAnY29tbWVudGVkIG9uIHlvdXIgcG9zdCd9OiBcIiR7Y29udGVudC5zdWJzdHJpbmcoMCwgMTAwKX0ke2NvbnRlbnQubGVuZ3RoID4gMTAwID8gJy4uLicgOiAnJ31cImAsXG4gICAgICAgIHR5cGU6IE5vdGlmaWNhdGlvblR5cGUuQ09NTVVOSVRZX1JFUExZLFxuICAgICAgICBwcmlvcml0eTogTm90aWZpY2F0aW9uUHJpb3JpdHkuTk9STUFMLFxuICAgICAgICBhY3Rpb25Vcmw6IGAvY29tbXVuaXRpZXMvcG9zdHMvJHtwb3N0SWR9I2NvbW1lbnQtJHtjb21tZW50SWR9YCxcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIGNvbW1lbnRJZCxcbiAgICAgICAgICBwb3N0SWQsXG4gICAgICAgICAgYXV0aG9ySWQsXG4gICAgICAgICAgYXV0aG9yTmFtZSxcbiAgICAgICAgICBwYXJlbnRDb21tZW50SWQsXG4gICAgICAgICAgcG9zdFRpdGxlOiBwb3N0LnRpdGxlLFxuICAgICAgICB9LFxuICAgICAgfSkpO1xuXG4gICAgICBpZiAobm90aWZpY2F0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuY3JlYXRlQmF0Y2gobm90aWZpY2F0aW9ucywge1xuICAgICAgICAgIHJlYWxUaW1lOiB0cnVlLFxuICAgICAgICAgIGVtYWlsOiBmYWxzZSxcbiAgICAgICAgICBwdXNoOiB0cnVlLFxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmxvZ2dlci5sb2coXG4gICAgICAgICAgYENvbW1lbnQgbm90aWZpY2F0aW9ucyBzZW50IHRvICR7bm90aWZpY2F0aW9ucy5sZW5ndGh9IHVzZXJzIGZvciBjb21tZW50ICR7Y29tbWVudElkfWAsXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMubG9nZ2VyLmVycm9yKFxuICAgICAgICBgRXJyb3IgaGFuZGxpbmcgY29tbWVudCBhZGRlZCBldmVudDpgLFxuICAgICAgICBlcnJvcixcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgLy8gSGVscGVyIG1ldGhvZHMgZm9yIGNyZWF0aW5nIHNwZWNpZmljIG5vdGlmaWNhdGlvbiB0eXBlc1xuXG4gIGFzeW5jIGNyZWF0ZUFwcG9pbnRtZW50UmVtaW5kZXIoXG4gICAgdXNlcklkOiBzdHJpbmcsXG4gICAgYXBwb2ludG1lbnRJZDogc3RyaW5nLFxuICAgIGFwcG9pbnRtZW50VGltZTogRGF0ZSxcbiAgICB0aGVyYXBpc3ROYW1lOiBzdHJpbmcsXG4gICkge1xuICAgIHJldHVybiB0aGlzLmNyZWF0ZSh7XG4gICAgICB1c2VySWQsXG4gICAgICB0aXRsZTogJ1VwY29taW5nIEFwcG9pbnRtZW50JyxcbiAgICAgIG1lc3NhZ2U6IGBZb3UgaGF2ZSBhbiBhcHBvaW50bWVudCB3aXRoICR7dGhlcmFwaXN0TmFtZX0gaW4gMSBob3VyLmAsXG4gICAgICB0eXBlOiBOb3RpZmljYXRpb25UeXBlLkFQUE9JTlRNRU5UX1JFTUlOREVSLFxuICAgICAgcHJpb3JpdHk6IE5vdGlmaWNhdGlvblByaW9yaXR5LkhJR0gsXG4gICAgICBhY3Rpb25Vcmw6IGAvYXBwb2ludG1lbnRzLyR7YXBwb2ludG1lbnRJZH1gLFxuICAgICAgZGF0YTogeyBhcHBvaW50bWVudElkLCBhcHBvaW50bWVudFRpbWUgfSxcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIGNyZWF0ZU1lc3NhZ2VOb3RpZmljYXRpb24oXG4gICAgdXNlcklkOiBzdHJpbmcsXG4gICAgc2VuZGVySWQ6IHN0cmluZyxcbiAgICBzZW5kZXJOYW1lOiBzdHJpbmcsXG4gICAgY29udmVyc2F0aW9uSWQ6IHN0cmluZyxcbiAgKSB7XG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlKHtcbiAgICAgIHVzZXJJZCxcbiAgICAgIHRpdGxlOiAnTmV3IE1lc3NhZ2UnLFxuICAgICAgbWVzc2FnZTogYFlvdSBoYXZlIGEgbmV3IG1lc3NhZ2UgZnJvbSAke3NlbmRlck5hbWV9LmAsXG4gICAgICB0eXBlOiBOb3RpZmljYXRpb25UeXBlLk1FU1NBR0VfUkVDRUlWRUQsXG4gICAgICBwcmlvcml0eTogTm90aWZpY2F0aW9uUHJpb3JpdHkuTk9STUFMLFxuICAgICAgYWN0aW9uVXJsOiBgL21lc3NhZ2VzLyR7Y29udmVyc2F0aW9uSWR9YCxcbiAgICAgIGRhdGE6IHsgc2VuZGVySWQsIGNvbnZlcnNhdGlvbklkIH0sXG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBjcmVhdGVXb3Jrc2hlZXRBc3NpZ25lZE5vdGlmaWNhdGlvbihcbiAgICB1c2VySWQ6IHN0cmluZyxcbiAgICB3b3Jrc2hlZXRJZDogc3RyaW5nLFxuICAgIHdvcmtzaGVldFRpdGxlOiBzdHJpbmcsXG4gICAgdGhlcmFwaXN0TmFtZTogc3RyaW5nLFxuICApIHtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGUoe1xuICAgICAgdXNlcklkLFxuICAgICAgdGl0bGU6ICdOZXcgV29ya3NoZWV0IEFzc2lnbmVkJyxcbiAgICAgIG1lc3NhZ2U6IGAke3RoZXJhcGlzdE5hbWV9IGhhcyBhc3NpZ25lZCB5b3UgYSBuZXcgd29ya3NoZWV0OiBcIiR7d29ya3NoZWV0VGl0bGV9XCIuYCxcbiAgICAgIHR5cGU6IE5vdGlmaWNhdGlvblR5cGUuV09SS1NIRUVUX0FTU0lHTkVELFxuICAgICAgcHJpb3JpdHk6IE5vdGlmaWNhdGlvblByaW9yaXR5Lk5PUk1BTCxcbiAgICAgIGFjdGlvblVybDogYC93b3Jrc2hlZXRzLyR7d29ya3NoZWV0SWR9YCxcbiAgICAgIGRhdGE6IHsgd29ya3NoZWV0SWQgfSxcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIGNyZWF0ZVRoZXJhcGlzdEFwcGxpY2F0aW9uTm90aWZpY2F0aW9uKFxuICAgIHVzZXJJZDogc3RyaW5nLFxuICAgIHN0YXR1czogJ2FwcHJvdmVkJyB8ICdyZWplY3RlZCcsXG4gICkge1xuICAgIGNvbnN0IHRpdGxlID1cbiAgICAgIHN0YXR1cyA9PT0gJ2FwcHJvdmVkJyA/ICdBcHBsaWNhdGlvbiBBcHByb3ZlZCcgOiAnQXBwbGljYXRpb24gVXBkYXRlJztcbiAgICBjb25zdCBtZXNzYWdlID1cbiAgICAgIHN0YXR1cyA9PT0gJ2FwcHJvdmVkJ1xuICAgICAgICA/ICdDb25ncmF0dWxhdGlvbnMhIFlvdXIgdGhlcmFwaXN0IGFwcGxpY2F0aW9uIGhhcyBiZWVuIGFwcHJvdmVkLidcbiAgICAgICAgOiAnWW91ciB0aGVyYXBpc3QgYXBwbGljYXRpb24gaGFzIGJlZW4gcmV2aWV3ZWQuIFBsZWFzZSBjaGVjayB5b3VyIGFwcGxpY2F0aW9uIHN0YXR1cy4nO1xuXG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlKHtcbiAgICAgIHVzZXJJZCxcbiAgICAgIHRpdGxlLFxuICAgICAgbWVzc2FnZSxcbiAgICAgIHR5cGU6XG4gICAgICAgIHN0YXR1cyA9PT0gJ2FwcHJvdmVkJ1xuICAgICAgICAgID8gTm90aWZpY2F0aW9uVHlwZS5USEVSQVBJU1RfQVBQUk9WRURcbiAgICAgICAgICA6IE5vdGlmaWNhdGlvblR5cGUuVEhFUkFQSVNUX1JFSkVDVEVELFxuICAgICAgcHJpb3JpdHk6IE5vdGlmaWNhdGlvblByaW9yaXR5LkhJR0gsXG4gICAgICBhY3Rpb25Vcmw6ICcvdGhlcmFwaXN0L2FwcGxpY2F0aW9uJyxcbiAgICAgIGRhdGE6IHsgc3RhdHVzIH0sXG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBjcmVhdGVSZXZpZXdSZXF1ZXN0Tm90aWZpY2F0aW9uKFxuICAgIHVzZXJJZDogc3RyaW5nLFxuICAgIHRoZXJhcGlzdElkOiBzdHJpbmcsXG4gICAgdGhlcmFwaXN0TmFtZTogc3RyaW5nLFxuICAgIHNlc3Npb25JZDogc3RyaW5nLFxuICApIHtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGUoe1xuICAgICAgdXNlcklkLFxuICAgICAgdGl0bGU6ICdSZXZpZXcgUmVxdWVzdCcsXG4gICAgICBtZXNzYWdlOiBgUGxlYXNlIGxlYXZlIGEgcmV2aWV3IGZvciB5b3VyIHNlc3Npb24gd2l0aCAke3RoZXJhcGlzdE5hbWV9LmAsXG4gICAgICB0eXBlOiBOb3RpZmljYXRpb25UeXBlLlJFVklFV19SRVFVRVNULFxuICAgICAgcHJpb3JpdHk6IE5vdGlmaWNhdGlvblByaW9yaXR5Lk5PUk1BTCxcbiAgICAgIGFjdGlvblVybDogYC90aGVyYXBpc3RzLyR7dGhlcmFwaXN0SWR9L3Jldmlldz9zZXNzaW9uPSR7c2Vzc2lvbklkfWAsXG4gICAgICBkYXRhOiB7IHRoZXJhcGlzdElkLCBzZXNzaW9uSWQgfSxcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIGNyZWF0ZUNvbW11bml0eVBvc3ROb3RpZmljYXRpb24oXG4gICAgdXNlcklkOiBzdHJpbmcsXG4gICAgcG9zdElkOiBzdHJpbmcsXG4gICAgY29tbXVuaXR5TmFtZTogc3RyaW5nLFxuICAgIGF1dGhvck5hbWU6IHN0cmluZyxcbiAgKSB7XG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlKHtcbiAgICAgIHVzZXJJZCxcbiAgICAgIHRpdGxlOiAnTmV3IENvbW11bml0eSBQb3N0JyxcbiAgICAgIG1lc3NhZ2U6IGAke2F1dGhvck5hbWV9IHBvc3RlZCBpbiAke2NvbW11bml0eU5hbWV9LmAsXG4gICAgICB0eXBlOiBOb3RpZmljYXRpb25UeXBlLkNPTU1VTklUWV9QT1NULFxuICAgICAgcHJpb3JpdHk6IE5vdGlmaWNhdGlvblByaW9yaXR5LkxPVyxcbiAgICAgIGFjdGlvblVybDogYC9jb21tdW5pdGllcy9wb3N0cy8ke3Bvc3RJZH1gLFxuICAgICAgZGF0YTogeyBwb3N0SWQsIGNvbW11bml0eU5hbWUgfSxcbiAgICB9KTtcbiAgfVxuXG4gIC8vID09PT09IFRIRVJBUElTVCBNQVRDSElORyBTWVNURU0gTk9USUZJQ0FUSU9OUyA9PT09PVxuXG4gIGFzeW5jIGNyZWF0ZUNsaWVudFJlcXVlc3ROb3RpZmljYXRpb24oXG4gICAgdGhlcmFwaXN0SWQ6IHN0cmluZyxcbiAgICBjbGllbnRJZDogc3RyaW5nLFxuICAgIGNsaWVudE5hbWU6IHN0cmluZyxcbiAgICByZXF1ZXN0TWVzc2FnZT86IHN0cmluZyxcbiAgICBwcmlvcml0eTogJ0xPVycgfCAnTk9STUFMJyB8ICdISUdIJyB8ICdVUkdFTlQnID0gJ05PUk1BTCcsXG4gICkge1xuICAgIGNvbnN0IG5vdGlmaWNhdGlvblByaW9yaXR5ID1cbiAgICAgIHByaW9yaXR5ID09PSAnSElHSCcgfHwgcHJpb3JpdHkgPT09ICdVUkdFTlQnID8gJ0hJR0gnIDogJ05PUk1BTCc7XG5cbiAgICByZXR1cm4gdGhpcy5jcmVhdGUoe1xuICAgICAgdXNlcklkOiB0aGVyYXBpc3RJZCxcbiAgICAgIHRpdGxlOiBgTmV3IENsaWVudCBSZXF1ZXN0ICR7cHJpb3JpdHkgPT09ICdVUkdFTlQnID8gJyhVcmdlbnQpJyA6ICcnfWAsXG4gICAgICBtZXNzYWdlOiBgJHtjbGllbnROYW1lfSBoYXMgc2VudCB5b3UgYSB0aGVyYXB5IHJlcXVlc3QuJHtyZXF1ZXN0TWVzc2FnZSA/IGAgXCIke3JlcXVlc3RNZXNzYWdlLnN1YnN0cmluZygwLCAxMDApfSR7cmVxdWVzdE1lc3NhZ2UubGVuZ3RoID4gMTAwID8gJy4uLicgOiAnJ31cImAgOiAnJ31gLFxuICAgICAgdHlwZTogJ0NMSUVOVF9SRVFVRVNUX1JFQ0VJVkVEJyxcbiAgICAgIHByaW9yaXR5OiBub3RpZmljYXRpb25Qcmlvcml0eSxcbiAgICAgIGFjdGlvblVybDogYC90aGVyYXBpc3QvcmVxdWVzdHNgLFxuICAgICAgZGF0YToge1xuICAgICAgICBjbGllbnRJZCxcbiAgICAgICAgY2xpZW50TmFtZSxcbiAgICAgICAgcmVxdWVzdFR5cGU6ICd0aGVyYXB5X3JlcXVlc3QnLFxuICAgICAgICBwcmlvcml0eSxcbiAgICAgICAgaGFzTWVzc2FnZTogISFyZXF1ZXN0TWVzc2FnZSxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBjcmVhdGVSZXF1ZXN0QWNjZXB0ZWROb3RpZmljYXRpb24oXG4gICAgY2xpZW50SWQ6IHN0cmluZyxcbiAgICB0aGVyYXBpc3RJZDogc3RyaW5nLFxuICAgIHRoZXJhcGlzdE5hbWU6IHN0cmluZyxcbiAgICByZXNwb25zZU1lc3NhZ2U/OiBzdHJpbmcsXG4gICAgc2NoZWR1bGluZ0luZm8/OiBzdHJpbmcsXG4gICkge1xuICAgIHJldHVybiB0aGlzLmNyZWF0ZSh7XG4gICAgICB1c2VySWQ6IGNsaWVudElkLFxuICAgICAgdGl0bGU6ICdUaGVyYXBpc3QgUmVxdWVzdCBBY2NlcHRlZCEg8J+OiScsXG4gICAgICBtZXNzYWdlOiBgR3JlYXQgbmV3cyEgJHt0aGVyYXBpc3ROYW1lfSBoYXMgYWNjZXB0ZWQgeW91ciB0aGVyYXB5IHJlcXVlc3QuJHtyZXNwb25zZU1lc3NhZ2UgPyBgIFwiJHtyZXNwb25zZU1lc3NhZ2V9XCJgIDogJyd9YCxcbiAgICAgIHR5cGU6ICdUSEVSQVBJU1RfUkVRVUVTVF9BQ0NFUFRFRCcsXG4gICAgICBwcmlvcml0eTogJ0hJR0gnLFxuICAgICAgYWN0aW9uVXJsOiBgL2NsaWVudC90aGVyYXBpc3RzLyR7dGhlcmFwaXN0SWR9YCxcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgdGhlcmFwaXN0SWQsXG4gICAgICAgIHRoZXJhcGlzdE5hbWUsXG4gICAgICAgIHJlc3BvbnNlTWVzc2FnZSxcbiAgICAgICAgc2NoZWR1bGluZ0luZm8sXG4gICAgICAgIG5leHRTdGVwOiAnc2NoZWR1bGVfc2Vzc2lvbicsXG4gICAgICB9LFxuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgY3JlYXRlUmVxdWVzdERlY2xpbmVkTm90aWZpY2F0aW9uKFxuICAgIGNsaWVudElkOiBzdHJpbmcsXG4gICAgdGhlcmFwaXN0SWQ6IHN0cmluZyxcbiAgICB0aGVyYXBpc3ROYW1lOiBzdHJpbmcsXG4gICAgcmVzcG9uc2VNZXNzYWdlPzogc3RyaW5nLFxuICApIHtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGUoe1xuICAgICAgdXNlcklkOiBjbGllbnRJZCxcbiAgICAgIHRpdGxlOiAnVGhlcmFwaXN0IFJlcXVlc3QgVXBkYXRlJyxcbiAgICAgIG1lc3NhZ2U6IGAke3RoZXJhcGlzdE5hbWV9IGhhcyByZXNwb25kZWQgdG8geW91ciB0aGVyYXB5IHJlcXVlc3QuJHtyZXNwb25zZU1lc3NhZ2UgPyBgIFwiJHtyZXNwb25zZU1lc3NhZ2V9XCJgIDogJyd9IERvbid0IHdvcnJ5IC0gd2UgY2FuIGhlbHAgeW91IGZpbmQgb3RoZXIgZ3JlYXQgbWF0Y2hlcyFgLFxuICAgICAgdHlwZTogJ1RIRVJBUElTVF9SRVFVRVNUX0RFQ0xJTkVEJyxcbiAgICAgIHByaW9yaXR5OiAnTk9STUFMJyxcbiAgICAgIGFjdGlvblVybDogJy9jbGllbnQvdGhlcmFwaXN0cy9icm93c2UnLFxuICAgICAgZGF0YToge1xuICAgICAgICB0aGVyYXBpc3RJZCxcbiAgICAgICAgdGhlcmFwaXN0TmFtZSxcbiAgICAgICAgcmVzcG9uc2VNZXNzYWdlLFxuICAgICAgICBuZXh0U3RlcDogJ2Jyb3dzZV9hbHRlcm5hdGl2ZXMnLFxuICAgICAgfSxcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIGNyZWF0ZVJlcXVlc3RDYW5jZWxsZWROb3RpZmljYXRpb24oXG4gICAgdGhlcmFwaXN0SWQ6IHN0cmluZyxcbiAgICBjbGllbnROYW1lOiBzdHJpbmcsXG4gICAgcmVhc29uPzogc3RyaW5nLFxuICApIHtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGUoe1xuICAgICAgdXNlcklkOiB0aGVyYXBpc3RJZCxcbiAgICAgIHRpdGxlOiAnQ2xpZW50IFJlcXVlc3QgQ2FuY2VsbGVkJyxcbiAgICAgIG1lc3NhZ2U6IGAke2NsaWVudE5hbWV9IGhhcyBjYW5jZWxsZWQgdGhlaXIgdGhlcmFweSByZXF1ZXN0LiR7cmVhc29uID8gYCBSZWFzb246ICR7cmVhc29ufWAgOiAnJ31gLFxuICAgICAgdHlwZTogJ0NMSUVOVF9SRVFVRVNUX0NBTkNFTExFRCcsXG4gICAgICBwcmlvcml0eTogJ05PUk1BTCcsXG4gICAgICBhY3Rpb25Vcmw6ICcvdGhlcmFwaXN0L3JlcXVlc3RzJyxcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgY2xpZW50TmFtZSxcbiAgICAgICAgcmVhc29uLFxuICAgICAgICBhY3Rpb25UeXBlOiAnY2FuY2VsbGF0aW9uJyxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBjcmVhdGVBZG1pblRoZXJhcGlzdEFwcHJvdmFsTm90aWZpY2F0aW9uKFxuICAgIHRoZXJhcGlzdElkOiBzdHJpbmcsXG4gICAgYXBwcm92YWxNZXNzYWdlPzogc3RyaW5nLFxuICApIHtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGUoe1xuICAgICAgdXNlcklkOiB0aGVyYXBpc3RJZCxcbiAgICAgIHRpdGxlOiAnQXBwbGljYXRpb24gQXBwcm92ZWQhIFdlbGNvbWUgdG8gTWVudGFyYSDwn46JJyxcbiAgICAgIG1lc3NhZ2U6IGBDb25ncmF0dWxhdGlvbnMhIFlvdXIgdGhlcmFwaXN0IGFwcGxpY2F0aW9uIGhhcyBiZWVuIGFwcHJvdmVkLiBZb3UgY2FuIG5vdyBzdGFydCByZWNlaXZpbmcgY2xpZW50IHJlcXVlc3RzLiR7YXBwcm92YWxNZXNzYWdlID8gYCBNZXNzYWdlIGZyb20gb3VyIHRlYW06IFwiJHthcHByb3ZhbE1lc3NhZ2V9XCJgIDogJyd9YCxcbiAgICAgIHR5cGU6ICdUSEVSQVBJU1RfQVBQUk9WRUQnLFxuICAgICAgcHJpb3JpdHk6ICdISUdIJyxcbiAgICAgIGFjdGlvblVybDogJy90aGVyYXBpc3QvZGFzaGJvYXJkJyxcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgYXBwcm92YWxNZXNzYWdlLFxuICAgICAgICBuZXh0U3RlcHM6IFtcbiAgICAgICAgICAnY29tcGxldGVfcHJvZmlsZScsXG4gICAgICAgICAgJ3NldF9hdmFpbGFiaWxpdHknLFxuICAgICAgICAgICdyZXZpZXdfZ3VpZGVsaW5lcycsXG4gICAgICAgIF0sXG4gICAgICAgIHdlbGNvbWVGbG93OiB0cnVlLFxuICAgICAgfSxcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIGNyZWF0ZUFkbWluVGhlcmFwaXN0UmVqZWN0aW9uTm90aWZpY2F0aW9uKFxuICAgIHRoZXJhcGlzdElkOiBzdHJpbmcsXG4gICAgcmVqZWN0aW9uUmVhc29uOiBzdHJpbmcsXG4gICAgcmVqZWN0aW9uTWVzc2FnZTogc3RyaW5nLFxuICAgIGFsbG93UmVhcHBsaWNhdGlvbjogYm9vbGVhbixcbiAgKSB7XG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlKHtcbiAgICAgIHVzZXJJZDogdGhlcmFwaXN0SWQsXG4gICAgICB0aXRsZTogJ0FwcGxpY2F0aW9uIFN0YXR1cyBVcGRhdGUnLFxuICAgICAgbWVzc2FnZTogYFlvdXIgdGhlcmFwaXN0IGFwcGxpY2F0aW9uIGhhcyBiZWVuIHJldmlld2VkLiAke3JlamVjdGlvbk1lc3NhZ2V9YCxcbiAgICAgIHR5cGU6ICdUSEVSQVBJU1RfUkVKRUNURUQnLFxuICAgICAgcHJpb3JpdHk6ICdISUdIJyxcbiAgICAgIGFjdGlvblVybDogYWxsb3dSZWFwcGxpY2F0aW9uXG4gICAgICAgID8gJy90aGVyYXBpc3QvcmVhcHBseSdcbiAgICAgICAgOiAnL3RoZXJhcGlzdC9hcHBsaWNhdGlvbi1zdGF0dXMnLFxuICAgICAgZGF0YToge1xuICAgICAgICByZWplY3Rpb25SZWFzb24sXG4gICAgICAgIHJlamVjdGlvbk1lc3NhZ2UsXG4gICAgICAgIGFsbG93UmVhcHBsaWNhdGlvbixcbiAgICAgICAgbmV4dFN0ZXA6IGFsbG93UmVhcHBsaWNhdGlvbiA/ICdyZWFwcGx5JyA6ICdjb250YWN0X3N1cHBvcnQnLFxuICAgICAgfSxcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIGNyZWF0ZU5ld1JlY29tbWVuZGF0aW9uc05vdGlmaWNhdGlvbihcbiAgICBjbGllbnRJZDogc3RyaW5nLFxuICAgIHRoZXJhcGlzdENvdW50OiBudW1iZXIsXG4gICAgdXBkYXRlUmVhc29uOlxuICAgICAgfCAncHJvZmlsZV91cGRhdGUnXG4gICAgICB8ICduZXdfdGhlcmFwaXN0cydcbiAgICAgIHwgJ2FsZ29yaXRobV9pbXByb3ZlbWVudCcgPSAnbmV3X3RoZXJhcGlzdHMnLFxuICApIHtcbiAgICBjb25zdCByZWFzb25NZXNzYWdlcyA9IHtcbiAgICAgIHByb2ZpbGVfdXBkYXRlOiAnYmFzZWQgb24geW91ciB1cGRhdGVkIHByZWZlcmVuY2VzJyxcbiAgICAgIG5ld190aGVyYXBpc3RzOiAnd2l0aCBuZXdseSBhcHByb3ZlZCB0aGVyYXBpc3RzJyxcbiAgICAgIGFsZ29yaXRobV9pbXByb3ZlbWVudDogJ3dpdGggaW1wcm92ZWQgbWF0Y2hpbmcnLFxuICAgIH07XG5cbiAgICByZXR1cm4gdGhpcy5jcmVhdGUoe1xuICAgICAgdXNlcklkOiBjbGllbnRJZCxcbiAgICAgIHRpdGxlOiAnTmV3IFRoZXJhcGlzdCBSZWNvbW1lbmRhdGlvbnMgQXZhaWxhYmxlJyxcbiAgICAgIG1lc3NhZ2U6IGBXZSd2ZSBmb3VuZCAke3RoZXJhcGlzdENvdW50fSBuZXcgdGhlcmFwaXN0IG1hdGNoZXMgZm9yIHlvdSAke3JlYXNvbk1lc3NhZ2VzW3VwZGF0ZVJlYXNvbl19LiBDaGVjayB0aGVtIG91dCFgLFxuICAgICAgdHlwZTogJ05FV19SRUNPTU1FTkRBVElPTlMnLFxuICAgICAgcHJpb3JpdHk6ICdOT1JNQUwnLFxuICAgICAgYWN0aW9uVXJsOiAnL2NsaWVudC90aGVyYXBpc3RzL3JlY29tbWVuZGF0aW9ucycsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIHRoZXJhcGlzdENvdW50LFxuICAgICAgICB1cGRhdGVSZWFzb24sXG4gICAgICAgIHJlY29tbWVuZGF0aW9uVHlwZTogJ3VwZGF0ZWRfbWF0Y2hlcycsXG4gICAgICB9LFxuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgY3JlYXRlTWF0Y2hpbmdTeXN0ZW1VcGRhdGVOb3RpZmljYXRpb24oXG4gICAgdXNlcklkOiBzdHJpbmcsXG4gICAgdXBkYXRlVHlwZTogJ2FsZ29yaXRobV9pbXByb3ZlbWVudCcgfCAnZmVhdHVyZV9yZWxlYXNlJyB8ICdtYWludGVuYW5jZScsXG4gICAgdXBkYXRlTWVzc2FnZTogc3RyaW5nLFxuICApIHtcbiAgICBjb25zdCB0aXRsZXMgPSB7XG4gICAgICBhbGdvcml0aG1faW1wcm92ZW1lbnQ6ICdCZXR0ZXIgTWF0Y2hpbmcgQXZhaWxhYmxlJyxcbiAgICAgIGZlYXR1cmVfcmVsZWFzZTogJ05ldyBGZWF0dXJlIEF2YWlsYWJsZScsXG4gICAgICBtYWludGVuYW5jZTogJ1N5c3RlbSBVcGRhdGUgQ29tcGxldGUnLFxuICAgIH07XG5cbiAgICBjb25zdCBwcmlvcml0aWVzID0ge1xuICAgICAgYWxnb3JpdGhtX2ltcHJvdmVtZW50OiAnTk9STUFMJyxcbiAgICAgIGZlYXR1cmVfcmVsZWFzZTogJ05PUk1BTCcsXG4gICAgICBtYWludGVuYW5jZTogJ0xPVycsXG4gICAgfSBhcyBjb25zdDtcblxuICAgIHJldHVybiB0aGlzLmNyZWF0ZSh7XG4gICAgICB1c2VySWQsXG4gICAgICB0aXRsZTogdGl0bGVzW3VwZGF0ZVR5cGVdLFxuICAgICAgbWVzc2FnZTogdXBkYXRlTWVzc2FnZSxcbiAgICAgIHR5cGU6ICdTWVNURU1fVVBEQVRFJyxcbiAgICAgIHByaW9yaXR5OiBwcmlvcml0aWVzW3VwZGF0ZVR5cGVdLFxuICAgICAgYWN0aW9uVXJsOiAnL2Rhc2hib2FyZCcsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIHVwZGF0ZVR5cGUsXG4gICAgICAgIHN5c3RlbVVwZGF0ZTogdHJ1ZSxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBjcmVhdGVSZWxhdGlvbnNoaXBFc3RhYmxpc2hlZE5vdGlmaWNhdGlvbihcbiAgICBjbGllbnRJZDogc3RyaW5nLFxuICAgIHRoZXJhcGlzdElkOiBzdHJpbmcsXG4gICAgdGhlcmFwaXN0TmFtZTogc3RyaW5nLFxuICApIHtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGUoe1xuICAgICAgdXNlcklkOiBjbGllbnRJZCxcbiAgICAgIHRpdGxlOiAnV2VsY29tZSB0byBZb3VyIFRoZXJhcHkgSm91cm5leSEg8J+MnycsXG4gICAgICBtZXNzYWdlOiBgWW91J3JlIG5vdyBjb25uZWN0ZWQgd2l0aCAke3RoZXJhcGlzdE5hbWV9LiBZb3VyIHRoZXJhcHkgcmVsYXRpb25zaGlwIGhhcyBvZmZpY2lhbGx5IGJlZ3VuLiBUYWtlIHRoZSBmaXJzdCBzdGVwIGJ5IHNjaGVkdWxpbmcgeW91ciBpbml0aWFsIHNlc3Npb24uYCxcbiAgICAgIHR5cGU6ICdSRUxBVElPTlNISVBfRVNUQUJMSVNIRUQnLFxuICAgICAgcHJpb3JpdHk6ICdISUdIJyxcbiAgICAgIGFjdGlvblVybDogYC9jbGllbnQvdGhlcmFwaXN0cy8ke3RoZXJhcGlzdElkfS9zY2hlZHVsZWAsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIHRoZXJhcGlzdElkLFxuICAgICAgICB0aGVyYXBpc3ROYW1lLFxuICAgICAgICByZWxhdGlvbnNoaXBTdGF0dXM6ICdhY3RpdmUnLFxuICAgICAgICBuZXh0U3RlcDogJ3NjaGVkdWxlX2ZpcnN0X3Nlc3Npb24nLFxuICAgICAgfSxcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIGNyZWF0ZVRoZXJhcGlzdFJlcXVlc3RSZW1pbmRlck5vdGlmaWNhdGlvbihcbiAgICB0aGVyYXBpc3RJZDogc3RyaW5nLFxuICAgIHBlbmRpbmdSZXF1ZXN0Q291bnQ6IG51bWJlcixcbiAgKSB7XG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlKHtcbiAgICAgIHVzZXJJZDogdGhlcmFwaXN0SWQsXG4gICAgICB0aXRsZTogYCR7cGVuZGluZ1JlcXVlc3RDb3VudH0gUGVuZGluZyBDbGllbnQgUmVxdWVzdCR7cGVuZGluZ1JlcXVlc3RDb3VudCA+IDEgPyAncycgOiAnJ31gLFxuICAgICAgbWVzc2FnZTogYFlvdSBoYXZlICR7cGVuZGluZ1JlcXVlc3RDb3VudH0gY2xpZW50IHJlcXVlc3Qke3BlbmRpbmdSZXF1ZXN0Q291bnQgPiAxID8gJ3MnIDogJyd9IHdhaXRpbmcgZm9yIHlvdXIgcmVzcG9uc2UuIENsaWVudHMgYXBwcmVjaWF0ZSB0aW1lbHkgcmVzcG9uc2VzIWAsXG4gICAgICB0eXBlOiAnUkVRVUVTVF9SRU1JTkRFUicsXG4gICAgICBwcmlvcml0eTogcGVuZGluZ1JlcXVlc3RDb3VudCA+IDMgPyAnSElHSCcgOiAnTk9STUFMJyxcbiAgICAgIGFjdGlvblVybDogJy90aGVyYXBpc3QvcmVxdWVzdHMvcGVuZGluZycsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIHBlbmRpbmdSZXF1ZXN0Q291bnQsXG4gICAgICAgIHJlbWluZGVyVHlwZTogJ3BlbmRpbmdfcmVxdWVzdHMnLFxuICAgICAgICB1cmdlbmN5OiBwZW5kaW5nUmVxdWVzdENvdW50ID4gMyA/ICdoaWdoJyA6ICdub3JtYWwnLFxuICAgICAgfSxcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIGNyZWF0ZVByb2ZpbGVDb21wbGV0aW9uUmVtaW5kZXJOb3RpZmljYXRpb24oXG4gICAgdXNlcklkOiBzdHJpbmcsXG4gICAgdXNlclR5cGU6ICdjbGllbnQnIHwgJ3RoZXJhcGlzdCcsXG4gICAgbWlzc2luZ0ZpZWxkczogc3RyaW5nW10sXG4gICkge1xuICAgIGNvbnN0IGFjdGlvblVybHMgPSB7XG4gICAgICBjbGllbnQ6ICcvY2xpZW50L3Byb2ZpbGUnLFxuICAgICAgdGhlcmFwaXN0OiAnL3RoZXJhcGlzdC9wcm9maWxlJyxcbiAgICB9O1xuXG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlKHtcbiAgICAgIHVzZXJJZCxcbiAgICAgIHRpdGxlOiAnQ29tcGxldGUgWW91ciBQcm9maWxlIGZvciBCZXR0ZXIgTWF0Y2hlcycsXG4gICAgICBtZXNzYWdlOiBgQ29tcGxldGUgeW91ciBwcm9maWxlIHRvIGdldCBiZXR0ZXIgdGhlcmFwaXN0IHJlY29tbWVuZGF0aW9ucy4gTWlzc2luZzogJHttaXNzaW5nRmllbGRzLnNsaWNlKDAsIDMpLmpvaW4oJywgJyl9JHttaXNzaW5nRmllbGRzLmxlbmd0aCA+IDMgPyAnLi4uJyA6ICcnfWAsXG4gICAgICB0eXBlOiAnUFJPRklMRV9DT01QTEVUSU9OJyxcbiAgICAgIHByaW9yaXR5OiAnTE9XJyxcbiAgICAgIGFjdGlvblVybDogYWN0aW9uVXJsc1t1c2VyVHlwZV0sXG4gICAgICBkYXRhOiB7XG4gICAgICAgIG1pc3NpbmdGaWVsZHMsXG4gICAgICAgIHVzZXJUeXBlLFxuICAgICAgICBwcm9maWxlQ29tcGxldGVuZXNzOiBNYXRoLm1heCgwLCAxMDAgLSBtaXNzaW5nRmllbGRzLmxlbmd0aCAqIDEwKSxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBzZW5kU2NoZWR1bGVkTm90aWZpY2F0aW9ucygpIHtcbiAgICAvLyBTaW5jZSBzY2hlZHVsZWRGb3IgYW5kIHNlbnRBdCBmaWVsZHMgZG9uJ3QgZXhpc3QgaW4gdGhlIE5vdGlmaWNhdGlvbiBtb2RlbCxcbiAgICAvLyB0aGlzIG1ldGhvZCByZXR1cm5zIGEgc3R1YiByZXNwb25zZS4gSW4gYSByZWFsIGltcGxlbWVudGF0aW9uIHdpdGggdGhlc2UgZmllbGRzLFxuICAgIC8vIHRoaXMgd291bGQgcHJvY2VzcyBhbmQgc2VuZCBzY2hlZHVsZWQgbm90aWZpY2F0aW9ucy5cbiAgICB0aGlzLmxvZ2dlci5sb2coJ1NjaGVkdWxlZCBub3RpZmljYXRpb25zIGNoZWNrIGNvbXBsZXRlZCAobm8gc2NoZWR1bGVkIGZpZWxkcyBhdmFpbGFibGUpJyk7XG4gICAgXG4gICAgcmV0dXJuIHsgc2VudDogMCB9O1xuICB9XG5cbiAgLy8gPT09PT0gQk9PS0lORyAmIEFQUE9JTlRNRU5UIEVWRU5UIExJU1RFTkVSUyA9PT09PVxuXG4gIC8qKlxuICAgKiBIYW5kbGUgYXBwb2ludG1lbnQgYm9va2VkIGV2ZW50c1xuICAgKi9cbiAgQE9uRXZlbnQoJ0FwcG9pbnRtZW50Qm9va2VkRXZlbnQnKVxuICBhc3luYyBoYW5kbGVBcHBvaW50bWVudEJvb2tlZChldmVudDogYW55KSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgZGF0YSB9ID0gZXZlbnQ7XG4gICAgICBcbiAgICAgIC8vIEdldCB0aGVyYXBpc3QgYW5kIGNsaWVudCBkZXRhaWxzXG4gICAgICBjb25zdCBbdGhlcmFwaXN0LCBjbGllbnRdID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgICAgICB0aGlzLnByaXNtYS51c2VyLmZpbmRVbmlxdWUoe1xuICAgICAgICAgIHdoZXJlOiB7IGlkOiBkYXRhLnRoZXJhcGlzdElkIH0sXG4gICAgICAgICAgc2VsZWN0OiB7IGZpcnN0TmFtZTogdHJ1ZSwgbGFzdE5hbWU6IHRydWUgfSxcbiAgICAgICAgfSksXG4gICAgICAgIHRoaXMucHJpc21hLnVzZXIuZmluZFVuaXF1ZSh7XG4gICAgICAgICAgd2hlcmU6IHsgaWQ6IGRhdGEuY2xpZW50SWQgfSxcbiAgICAgICAgICBzZWxlY3Q6IHsgZmlyc3ROYW1lOiB0cnVlLCBsYXN0TmFtZTogdHJ1ZSB9LFxuICAgICAgICB9KSxcbiAgICAgIF0pO1xuXG4gICAgICBpZiAoIXRoZXJhcGlzdCB8fCAhY2xpZW50KSByZXR1cm47XG5cbiAgICAgIC8vIE5vdGlmeSBjbGllbnQgYWJvdXQgc3VjY2Vzc2Z1bCBib29raW5nXG4gICAgICBhd2FpdCB0aGlzLmNyZWF0ZShcbiAgICAgICAge1xuICAgICAgICAgIHVzZXJJZDogZGF0YS5jbGllbnRJZCxcbiAgICAgICAgICB0aXRsZTogJ1Nlc3Npb24gQm9va2VkIFN1Y2Nlc3NmdWxseSEnLFxuICAgICAgICAgIG1lc3NhZ2U6IGBZb3VyICR7ZGF0YS5tZWV0aW5nVHlwZX0gc2Vzc2lvbiB3aXRoICR7dGhlcmFwaXN0LmZpcnN0TmFtZX0gJHt0aGVyYXBpc3QubGFzdE5hbWV9IGhhcyBiZWVuIHNjaGVkdWxlZCBmb3IgJHtuZXcgRGF0ZShkYXRhLnN0YXJ0VGltZSkudG9Mb2NhbGVEYXRlU3RyaW5nKCl9IGF0ICR7bmV3IERhdGUoZGF0YS5zdGFydFRpbWUpLnRvTG9jYWxlVGltZVN0cmluZyhbXSwgeyBob3VyOiAnMi1kaWdpdCcsIG1pbnV0ZTogJzItZGlnaXQnIH0pfS5gLFxuICAgICAgICAgIHR5cGU6IE5vdGlmaWNhdGlvblR5cGUuQVBQT0lOVE1FTlRfQ09ORklSTUVELFxuICAgICAgICAgIHByaW9yaXR5OiBOb3RpZmljYXRpb25Qcmlvcml0eS5ISUdILFxuICAgICAgICAgIGFjdGlvblVybDogYC9jbGllbnQvbWVldGluZ3MvJHtkYXRhLmFwcG9pbnRtZW50SWR9YCxcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBhcHBvaW50bWVudElkOiBkYXRhLmFwcG9pbnRtZW50SWQsXG4gICAgICAgICAgICB0aGVyYXBpc3RJZDogZGF0YS50aGVyYXBpc3RJZCxcbiAgICAgICAgICAgIHN0YXJ0VGltZTogZGF0YS5zdGFydFRpbWUsXG4gICAgICAgICAgICBkdXJhdGlvbjogZGF0YS5kdXJhdGlvbixcbiAgICAgICAgICAgIG1lZXRpbmdUeXBlOiBkYXRhLm1lZXRpbmdUeXBlLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICByZWFsVGltZTogdHJ1ZSxcbiAgICAgICAgICBlbWFpbDogdHJ1ZSxcbiAgICAgICAgICBwdXNoOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgKTtcblxuICAgICAgLy8gTm90aWZ5IHRoZXJhcGlzdCBhYm91dCBuZXcgYm9va2luZ1xuICAgICAgYXdhaXQgdGhpcy5jcmVhdGUoXG4gICAgICAgIHtcbiAgICAgICAgICB1c2VySWQ6IGRhdGEudGhlcmFwaXN0SWQsXG4gICAgICAgICAgdGl0bGU6ICdOZXcgU2Vzc2lvbiBCb29rZWQnLFxuICAgICAgICAgIG1lc3NhZ2U6IGAke2NsaWVudC5maXJzdE5hbWV9ICR7Y2xpZW50Lmxhc3ROYW1lfSBoYXMgYm9va2VkIGEgJHtkYXRhLmR1cmF0aW9ufS1taW51dGUgJHtkYXRhLm1lZXRpbmdUeXBlfSBzZXNzaW9uIHdpdGggeW91IG9uICR7bmV3IERhdGUoZGF0YS5zdGFydFRpbWUpLnRvTG9jYWxlRGF0ZVN0cmluZygpfSBhdCAke25ldyBEYXRlKGRhdGEuc3RhcnRUaW1lKS50b0xvY2FsZVRpbWVTdHJpbmcoW10sIHsgaG91cjogJzItZGlnaXQnLCBtaW51dGU6ICcyLWRpZ2l0JyB9KX0uYCxcbiAgICAgICAgICB0eXBlOiBOb3RpZmljYXRpb25UeXBlLkFQUE9JTlRNRU5UX0NPTkZJUk1FRCxcbiAgICAgICAgICBwcmlvcml0eTogTm90aWZpY2F0aW9uUHJpb3JpdHkuSElHSCxcbiAgICAgICAgICBhY3Rpb25Vcmw6IGAvdGhlcmFwaXN0L21lZXRpbmdzLyR7ZGF0YS5hcHBvaW50bWVudElkfWAsXG4gICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgYXBwb2ludG1lbnRJZDogZGF0YS5hcHBvaW50bWVudElkLFxuICAgICAgICAgICAgY2xpZW50SWQ6IGRhdGEuY2xpZW50SWQsXG4gICAgICAgICAgICBzdGFydFRpbWU6IGRhdGEuc3RhcnRUaW1lLFxuICAgICAgICAgICAgZHVyYXRpb246IGRhdGEuZHVyYXRpb24sXG4gICAgICAgICAgICBtZWV0aW5nVHlwZTogZGF0YS5tZWV0aW5nVHlwZSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgcmVhbFRpbWU6IHRydWUsXG4gICAgICAgICAgZW1haWw6IHRydWUsXG4gICAgICAgICAgcHVzaDogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgICk7XG5cbiAgICAgIHRoaXMubG9nZ2VyLmxvZyhcbiAgICAgICAgYEFwcG9pbnRtZW50IGJvb2tlZCBub3RpZmljYXRpb25zIHNlbnQgZm9yIGFwcG9pbnRtZW50ICR7ZGF0YS5hcHBvaW50bWVudElkfWAsXG4gICAgICApO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aGlzLmxvZ2dlci5lcnJvcihcbiAgICAgICAgYEVycm9yIGhhbmRsaW5nIGFwcG9pbnRtZW50IGJvb2tlZCBldmVudDpgLFxuICAgICAgICBlcnJvcixcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEhhbmRsZSBhcHBvaW50bWVudCBjYW5jZWxsZWQgZXZlbnRzXG4gICAqL1xuICBAT25FdmVudCgnQXBwb2ludG1lbnRDYW5jZWxsZWRFdmVudCcpXG4gIGFzeW5jIGhhbmRsZUFwcG9pbnRtZW50Q2FuY2VsbGVkKGV2ZW50OiBhbnkpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBkYXRhIH0gPSBldmVudDtcbiAgICAgIFxuICAgICAgLy8gR2V0IHRoZXJhcGlzdCBhbmQgY2xpZW50IGRldGFpbHNcbiAgICAgIGNvbnN0IFt0aGVyYXBpc3QsIGNsaWVudF0gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICAgIHRoaXMucHJpc21hLnVzZXIuZmluZFVuaXF1ZSh7XG4gICAgICAgICAgd2hlcmU6IHsgaWQ6IGRhdGEudGhlcmFwaXN0SWQgfSxcbiAgICAgICAgICBzZWxlY3Q6IHsgZmlyc3ROYW1lOiB0cnVlLCBsYXN0TmFtZTogdHJ1ZSB9LFxuICAgICAgICB9KSxcbiAgICAgICAgdGhpcy5wcmlzbWEudXNlci5maW5kVW5pcXVlKHtcbiAgICAgICAgICB3aGVyZTogeyBpZDogZGF0YS5jbGllbnRJZCB9LFxuICAgICAgICAgIHNlbGVjdDogeyBmaXJzdE5hbWU6IHRydWUsIGxhc3ROYW1lOiB0cnVlIH0sXG4gICAgICAgIH0pLFxuICAgICAgXSk7XG5cbiAgICAgIGlmICghdGhlcmFwaXN0IHx8ICFjbGllbnQpIHJldHVybjtcblxuICAgICAgY29uc3QgaXNDYW5jZWxsZWRCeUNsaWVudCA9IGRhdGEuY2FuY2VsbGVkQnkgPT09IGRhdGEuY2xpZW50SWQ7XG5cbiAgICAgIC8vIE5vdGlmeSB0aGUgb3RoZXIgcGFydHkgYWJvdXQgdGhlIGNhbmNlbGxhdGlvblxuICAgICAgY29uc3Qgbm90aWZ5VXNlcklkID0gaXNDYW5jZWxsZWRCeUNsaWVudCA/IGRhdGEudGhlcmFwaXN0SWQgOiBkYXRhLmNsaWVudElkO1xuICAgICAgY29uc3QgY2FuY2VsbGVyTmFtZSA9IGlzQ2FuY2VsbGVkQnlDbGllbnQgXG4gICAgICAgID8gYCR7Y2xpZW50LmZpcnN0TmFtZX0gJHtjbGllbnQubGFzdE5hbWV9YFxuICAgICAgICA6IGAke3RoZXJhcGlzdC5maXJzdE5hbWV9ICR7dGhlcmFwaXN0Lmxhc3ROYW1lfWA7XG4gICAgICBcbiAgICAgIGF3YWl0IHRoaXMuY3JlYXRlKFxuICAgICAgICB7XG4gICAgICAgICAgdXNlcklkOiBub3RpZnlVc2VySWQsXG4gICAgICAgICAgdGl0bGU6ICdTZXNzaW9uIENhbmNlbGxlZCcsXG4gICAgICAgICAgbWVzc2FnZTogYFlvdXIgc2Vzc2lvbiBzY2hlZHVsZWQgZm9yICR7bmV3IERhdGUoZGF0YS5vcmlnaW5hbFN0YXJ0VGltZSkudG9Mb2NhbGVEYXRlU3RyaW5nKCl9IGF0ICR7bmV3IERhdGUoZGF0YS5vcmlnaW5hbFN0YXJ0VGltZSkudG9Mb2NhbGVUaW1lU3RyaW5nKFtdLCB7IGhvdXI6ICcyLWRpZ2l0JywgbWludXRlOiAnMi1kaWdpdCcgfSl9IGhhcyBiZWVuIGNhbmNlbGxlZCBieSAke2NhbmNlbGxlck5hbWV9LiAke2RhdGEuY2FuY2VsbGF0aW9uUmVhc29ufWAsXG4gICAgICAgICAgdHlwZTogTm90aWZpY2F0aW9uVHlwZS5BUFBPSU5UTUVOVF9DQU5DRUxMRUQsXG4gICAgICAgICAgcHJpb3JpdHk6IE5vdGlmaWNhdGlvblByaW9yaXR5LkhJR0gsXG4gICAgICAgICAgYWN0aW9uVXJsOiBpc0NhbmNlbGxlZEJ5Q2xpZW50ID8gJy90aGVyYXBpc3Qvc2NoZWR1bGUnIDogJy9jbGllbnQvYm9va2luZycsXG4gICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgYXBwb2ludG1lbnRJZDogZGF0YS5hcHBvaW50bWVudElkLFxuICAgICAgICAgICAgY2FuY2VsbGVkQnk6IGRhdGEuY2FuY2VsbGVkQnksXG4gICAgICAgICAgICBjYW5jZWxsYXRpb25SZWFzb246IGRhdGEuY2FuY2VsbGF0aW9uUmVhc29uLFxuICAgICAgICAgICAgb3JpZ2luYWxTdGFydFRpbWU6IGRhdGEub3JpZ2luYWxTdGFydFRpbWUsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHJlYWxUaW1lOiB0cnVlLFxuICAgICAgICAgIGVtYWlsOiB0cnVlLFxuICAgICAgICAgIHB1c2g6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICApO1xuXG4gICAgICAvLyBOb3RpZnkgdGhlIGNhbmNlbGxlciB3aXRoIGNvbmZpcm1hdGlvblxuICAgICAgYXdhaXQgdGhpcy5jcmVhdGUoXG4gICAgICAgIHtcbiAgICAgICAgICB1c2VySWQ6IGRhdGEuY2FuY2VsbGVkQnksXG4gICAgICAgICAgdGl0bGU6ICdTZXNzaW9uIENhbmNlbGxhdGlvbiBDb25maXJtZWQnLFxuICAgICAgICAgIG1lc3NhZ2U6IGBZb3VyIHNlc3Npb24gd2l0aCAke2lzQ2FuY2VsbGVkQnlDbGllbnQgPyB0aGVyYXBpc3QuZmlyc3ROYW1lICsgJyAnICsgdGhlcmFwaXN0Lmxhc3ROYW1lIDogY2xpZW50LmZpcnN0TmFtZSArICcgJyArIGNsaWVudC5sYXN0TmFtZX0gc2NoZWR1bGVkIGZvciAke25ldyBEYXRlKGRhdGEub3JpZ2luYWxTdGFydFRpbWUpLnRvTG9jYWxlRGF0ZVN0cmluZygpfSBoYXMgYmVlbiBzdWNjZXNzZnVsbHkgY2FuY2VsbGVkLmAsXG4gICAgICAgICAgdHlwZTogTm90aWZpY2F0aW9uVHlwZS5BUFBPSU5UTUVOVF9DQU5DRUxMRUQsXG4gICAgICAgICAgcHJpb3JpdHk6IE5vdGlmaWNhdGlvblByaW9yaXR5Lk5PUk1BTCxcbiAgICAgICAgICBhY3Rpb25Vcmw6IGlzQ2FuY2VsbGVkQnlDbGllbnQgPyAnL2NsaWVudC9ib29raW5nJyA6ICcvdGhlcmFwaXN0L3NjaGVkdWxlJyxcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBhcHBvaW50bWVudElkOiBkYXRhLmFwcG9pbnRtZW50SWQsXG4gICAgICAgICAgICBvcmlnaW5hbFN0YXJ0VGltZTogZGF0YS5vcmlnaW5hbFN0YXJ0VGltZSxcbiAgICAgICAgICAgIHJlZnVuZFByb2Nlc3NlZDogdHJ1ZSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgcmVhbFRpbWU6IHRydWUsXG4gICAgICAgICAgZW1haWw6IGZhbHNlLFxuICAgICAgICAgIHB1c2g6IGZhbHNlLFxuICAgICAgICB9LFxuICAgICAgKTtcblxuICAgICAgdGhpcy5sb2dnZXIubG9nKFxuICAgICAgICBgQXBwb2ludG1lbnQgY2FuY2VsbGF0aW9uIG5vdGlmaWNhdGlvbnMgc2VudCBmb3IgYXBwb2ludG1lbnQgJHtkYXRhLmFwcG9pbnRtZW50SWR9YCxcbiAgICAgICk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMubG9nZ2VyLmVycm9yKFxuICAgICAgICBgRXJyb3IgaGFuZGxpbmcgYXBwb2ludG1lbnQgY2FuY2VsbGVkIGV2ZW50OmAsXG4gICAgICAgIGVycm9yLFxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogSGFuZGxlIGFwcG9pbnRtZW50IHJlc2NoZWR1bGVkIGV2ZW50c1xuICAgKi9cbiAgQE9uRXZlbnQoJ0FwcG9pbnRtZW50UmVzY2hlZHVsZWRFdmVudCcpXG4gIGFzeW5jIGhhbmRsZUFwcG9pbnRtZW50UmVzY2hlZHVsZWQoZXZlbnQ6IGFueSkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IGRhdGEgfSA9IGV2ZW50O1xuICAgICAgXG4gICAgICAvLyBHZXQgdGhlcmFwaXN0IGFuZCBjbGllbnQgZGV0YWlsc1xuICAgICAgY29uc3QgW3RoZXJhcGlzdCwgY2xpZW50XSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICAgICAgdGhpcy5wcmlzbWEudXNlci5maW5kVW5pcXVlKHtcbiAgICAgICAgICB3aGVyZTogeyBpZDogZGF0YS50aGVyYXBpc3RJZCB9LFxuICAgICAgICAgIHNlbGVjdDogeyBmaXJzdE5hbWU6IHRydWUsIGxhc3ROYW1lOiB0cnVlIH0sXG4gICAgICAgIH0pLFxuICAgICAgICB0aGlzLnByaXNtYS51c2VyLmZpbmRVbmlxdWUoe1xuICAgICAgICAgIHdoZXJlOiB7IGlkOiBkYXRhLmNsaWVudElkIH0sXG4gICAgICAgICAgc2VsZWN0OiB7IGZpcnN0TmFtZTogdHJ1ZSwgbGFzdE5hbWU6IHRydWUgfSxcbiAgICAgICAgfSksXG4gICAgICBdKTtcblxuICAgICAgaWYgKCF0aGVyYXBpc3QgfHwgIWNsaWVudCkgcmV0dXJuO1xuXG4gICAgICBjb25zdCBpc1Jlc2NoZWR1bGVkQnlDbGllbnQgPSBkYXRhLnJlc2NoZWR1bGVkQnkgPT09IGRhdGEuY2xpZW50SWQ7XG4gICAgICBcbiAgICAgIC8vIE5vdGlmeSB0aGUgb3RoZXIgcGFydHkgYWJvdXQgdGhlIHJlc2NoZWR1bGVcbiAgICAgIGNvbnN0IG5vdGlmeVVzZXJJZCA9IGlzUmVzY2hlZHVsZWRCeUNsaWVudCA/IGRhdGEudGhlcmFwaXN0SWQgOiBkYXRhLmNsaWVudElkO1xuICAgICAgY29uc3QgcmVzY2hlZHVsZXJOYW1lID0gaXNSZXNjaGVkdWxlZEJ5Q2xpZW50IFxuICAgICAgICA/IGAke2NsaWVudC5maXJzdE5hbWV9ICR7Y2xpZW50Lmxhc3ROYW1lfWBcbiAgICAgICAgOiBgJHt0aGVyYXBpc3QuZmlyc3ROYW1lfSAke3RoZXJhcGlzdC5sYXN0TmFtZX1gO1xuICAgICAgXG4gICAgICBhd2FpdCB0aGlzLmNyZWF0ZShcbiAgICAgICAge1xuICAgICAgICAgIHVzZXJJZDogbm90aWZ5VXNlcklkLFxuICAgICAgICAgIHRpdGxlOiAnU2Vzc2lvbiBSZXNjaGVkdWxlZCcsXG4gICAgICAgICAgbWVzc2FnZTogYCR7cmVzY2hlZHVsZXJOYW1lfSBoYXMgcmVzY2hlZHVsZWQgeW91ciBzZXNzaW9uLiBOZXcgdGltZTogJHtuZXcgRGF0ZShkYXRhLm5ld1N0YXJ0VGltZSkudG9Mb2NhbGVEYXRlU3RyaW5nKCl9IGF0ICR7bmV3IERhdGUoZGF0YS5uZXdTdGFydFRpbWUpLnRvTG9jYWxlVGltZVN0cmluZyhbXSwgeyBob3VyOiAnMi1kaWdpdCcsIG1pbnV0ZTogJzItZGlnaXQnIH0pfSAocHJldmlvdXNseSAke25ldyBEYXRlKGRhdGEub3JpZ2luYWxTdGFydFRpbWUpLnRvTG9jYWxlRGF0ZVN0cmluZygpfSBhdCAke25ldyBEYXRlKGRhdGEub3JpZ2luYWxTdGFydFRpbWUpLnRvTG9jYWxlVGltZVN0cmluZyhbXSwgeyBob3VyOiAnMi1kaWdpdCcsIG1pbnV0ZTogJzItZGlnaXQnIH0pfSkuYCxcbiAgICAgICAgICB0eXBlOiBOb3RpZmljYXRpb25UeXBlLkFQUE9JTlRNRU5UX1JFU0NIRURVTEVELFxuICAgICAgICAgIHByaW9yaXR5OiBOb3RpZmljYXRpb25Qcmlvcml0eS5ISUdILFxuICAgICAgICAgIGFjdGlvblVybDogYC9jbGllbnQvbWVldGluZ3MvJHtkYXRhLmFwcG9pbnRtZW50SWR9YCxcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBhcHBvaW50bWVudElkOiBkYXRhLmFwcG9pbnRtZW50SWQsXG4gICAgICAgICAgICByZXNjaGVkdWxlZEJ5OiBkYXRhLnJlc2NoZWR1bGVkQnksXG4gICAgICAgICAgICBvcmlnaW5hbFN0YXJ0VGltZTogZGF0YS5vcmlnaW5hbFN0YXJ0VGltZSxcbiAgICAgICAgICAgIG5ld1N0YXJ0VGltZTogZGF0YS5uZXdTdGFydFRpbWUsXG4gICAgICAgICAgICByZXNjaGVkdWxlUmVhc29uOiBkYXRhLnJlc2NoZWR1bGVSZWFzb24sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHJlYWxUaW1lOiB0cnVlLFxuICAgICAgICAgIGVtYWlsOiB0cnVlLFxuICAgICAgICAgIHB1c2g6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICApO1xuXG4gICAgICAvLyBOb3RpZnkgdGhlIHJlc2NoZWR1bGVyIHdpdGggY29uZmlybWF0aW9uXG4gICAgICBhd2FpdCB0aGlzLmNyZWF0ZShcbiAgICAgICAge1xuICAgICAgICAgIHVzZXJJZDogZGF0YS5yZXNjaGVkdWxlZEJ5LFxuICAgICAgICAgIHRpdGxlOiAnU2Vzc2lvbiBSZXNjaGVkdWxlIENvbmZpcm1lZCcsXG4gICAgICAgICAgbWVzc2FnZTogYFlvdXIgc2Vzc2lvbiBoYXMgYmVlbiBzdWNjZXNzZnVsbHkgcmVzY2hlZHVsZWQgdG8gJHtuZXcgRGF0ZShkYXRhLm5ld1N0YXJ0VGltZSkudG9Mb2NhbGVEYXRlU3RyaW5nKCl9IGF0ICR7bmV3IERhdGUoZGF0YS5uZXdTdGFydFRpbWUpLnRvTG9jYWxlVGltZVN0cmluZyhbXSwgeyBob3VyOiAnMi1kaWdpdCcsIG1pbnV0ZTogJzItZGlnaXQnIH0pfS5gLFxuICAgICAgICAgIHR5cGU6IE5vdGlmaWNhdGlvblR5cGUuQVBQT0lOVE1FTlRfUkVTQ0hFRFVMRUQsXG4gICAgICAgICAgcHJpb3JpdHk6IE5vdGlmaWNhdGlvblByaW9yaXR5Lk5PUk1BTCxcbiAgICAgICAgICBhY3Rpb25Vcmw6IGAvY2xpZW50L21lZXRpbmdzLyR7ZGF0YS5hcHBvaW50bWVudElkfWAsXG4gICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgYXBwb2ludG1lbnRJZDogZGF0YS5hcHBvaW50bWVudElkLFxuICAgICAgICAgICAgb3JpZ2luYWxTdGFydFRpbWU6IGRhdGEub3JpZ2luYWxTdGFydFRpbWUsXG4gICAgICAgICAgICBuZXdTdGFydFRpbWU6IGRhdGEubmV3U3RhcnRUaW1lLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICByZWFsVGltZTogdHJ1ZSxcbiAgICAgICAgICBlbWFpbDogZmFsc2UsXG4gICAgICAgICAgcHVzaDogZmFsc2UsXG4gICAgICAgIH0sXG4gICAgICApO1xuXG4gICAgICB0aGlzLmxvZ2dlci5sb2coXG4gICAgICAgIGBBcHBvaW50bWVudCByZXNjaGVkdWxlZCBub3RpZmljYXRpb25zIHNlbnQgZm9yIGFwcG9pbnRtZW50ICR7ZGF0YS5hcHBvaW50bWVudElkfWAsXG4gICAgICApO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aGlzLmxvZ2dlci5lcnJvcihcbiAgICAgICAgYEVycm9yIGhhbmRsaW5nIGFwcG9pbnRtZW50IHJlc2NoZWR1bGVkIGV2ZW50OmAsXG4gICAgICAgIGVycm9yLFxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogSGFuZGxlIGFwcG9pbnRtZW50IGNvbXBsZXRlZCBldmVudHNcbiAgICovXG4gIEBPbkV2ZW50KCdBcHBvaW50bWVudENvbXBsZXRlZEV2ZW50JylcbiAgYXN5bmMgaGFuZGxlQXBwb2ludG1lbnRDb21wbGV0ZWQoZXZlbnQ6IGFueSkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IGRhdGEgfSA9IGV2ZW50O1xuICAgICAgXG4gICAgICAvLyBHZXQgdGhlcmFwaXN0IGFuZCBjbGllbnQgZGV0YWlsc1xuICAgICAgY29uc3QgW3RoZXJhcGlzdCwgY2xpZW50XSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICAgICAgdGhpcy5wcmlzbWEudXNlci5maW5kVW5pcXVlKHtcbiAgICAgICAgICB3aGVyZTogeyBpZDogZGF0YS50aGVyYXBpc3RJZCB9LFxuICAgICAgICAgIHNlbGVjdDogeyBmaXJzdE5hbWU6IHRydWUsIGxhc3ROYW1lOiB0cnVlIH0sXG4gICAgICAgIH0pLFxuICAgICAgICB0aGlzLnByaXNtYS51c2VyLmZpbmRVbmlxdWUoe1xuICAgICAgICAgIHdoZXJlOiB7IGlkOiBkYXRhLmNsaWVudElkIH0sXG4gICAgICAgICAgc2VsZWN0OiB7IGZpcnN0TmFtZTogdHJ1ZSwgbGFzdE5hbWU6IHRydWUgfSxcbiAgICAgICAgfSksXG4gICAgICBdKTtcblxuICAgICAgaWYgKCF0aGVyYXBpc3QgfHwgIWNsaWVudCkgcmV0dXJuO1xuXG4gICAgICAvLyBOb3RpZnkgY2xpZW50IGFib3V0IHNlc3Npb24gY29tcGxldGlvbiBhbmQgcmV2aWV3IHJlcXVlc3RcbiAgICAgIGF3YWl0IHRoaXMuY3JlYXRlKFxuICAgICAgICB7XG4gICAgICAgICAgdXNlcklkOiBkYXRhLmNsaWVudElkLFxuICAgICAgICAgIHRpdGxlOiAnU2Vzc2lvbiBDb21wbGV0ZWQgLSBTaGFyZSBZb3VyIEZlZWRiYWNrJyxcbiAgICAgICAgICBtZXNzYWdlOiBgWW91ciBzZXNzaW9uIHdpdGggJHt0aGVyYXBpc3QuZmlyc3ROYW1lfSAke3RoZXJhcGlzdC5sYXN0TmFtZX0gaGFzIGJlZW4gY29tcGxldGVkLiBIb3cgd2FzIHlvdXIgZXhwZXJpZW5jZT8gWW91ciBmZWVkYmFjayBoZWxwcyB1cyBpbXByb3ZlIG91ciBzZXJ2aWNlcy5gLFxuICAgICAgICAgIHR5cGU6IE5vdGlmaWNhdGlvblR5cGUuUkVWSUVXX1JFUVVFU1QsXG4gICAgICAgICAgcHJpb3JpdHk6IE5vdGlmaWNhdGlvblByaW9yaXR5Lk5PUk1BTCxcbiAgICAgICAgICBhY3Rpb25Vcmw6IGAvY2xpZW50L3RoZXJhcGlzdHMvJHtkYXRhLnRoZXJhcGlzdElkfS9yZXZpZXc/c2Vzc2lvbj0ke2RhdGEuYXBwb2ludG1lbnRJZH1gLFxuICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgIGFwcG9pbnRtZW50SWQ6IGRhdGEuYXBwb2ludG1lbnRJZCxcbiAgICAgICAgICAgIHRoZXJhcGlzdElkOiBkYXRhLnRoZXJhcGlzdElkLFxuICAgICAgICAgICAgY29tcGxldGVkQXQ6IGRhdGEuY29tcGxldGVkQXQsXG4gICAgICAgICAgICBkdXJhdGlvbjogZGF0YS5kdXJhdGlvbixcbiAgICAgICAgICAgIGF0dGVuZGFuY2VTdGF0dXM6IGRhdGEuYXR0ZW5kYW5jZVN0YXR1cyxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgcmVhbFRpbWU6IHRydWUsXG4gICAgICAgICAgZW1haWw6IGZhbHNlLFxuICAgICAgICAgIHB1c2g6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICApO1xuXG4gICAgICAvLyBOb3RpZnkgdGhlcmFwaXN0IGFib3V0IHNlc3Npb24gY29tcGxldGlvblxuICAgICAgYXdhaXQgdGhpcy5jcmVhdGUoXG4gICAgICAgIHtcbiAgICAgICAgICB1c2VySWQ6IGRhdGEudGhlcmFwaXN0SWQsXG4gICAgICAgICAgdGl0bGU6ICdTZXNzaW9uIENvbXBsZXRlZCcsXG4gICAgICAgICAgbWVzc2FnZTogYFlvdXIgc2Vzc2lvbiB3aXRoICR7Y2xpZW50LmZpcnN0TmFtZX0gJHtjbGllbnQubGFzdE5hbWV9IGhhcyBiZWVuIG1hcmtlZCBhcyBjb21wbGV0ZWQuIER1cmF0aW9uOiAke2RhdGEuZHVyYXRpb259IG1pbnV0ZXMuYCxcbiAgICAgICAgICB0eXBlOiBOb3RpZmljYXRpb25UeXBlLkFQUE9JTlRNRU5UX0NPTkZJUk1FRCxcbiAgICAgICAgICBwcmlvcml0eTogTm90aWZpY2F0aW9uUHJpb3JpdHkuTk9STUFMLFxuICAgICAgICAgIGFjdGlvblVybDogYC90aGVyYXBpc3Qvc2Vzc2lvbnMvJHtkYXRhLmFwcG9pbnRtZW50SWR9YCxcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBhcHBvaW50bWVudElkOiBkYXRhLmFwcG9pbnRtZW50SWQsXG4gICAgICAgICAgICBjbGllbnRJZDogZGF0YS5jbGllbnRJZCxcbiAgICAgICAgICAgIGNvbXBsZXRlZEF0OiBkYXRhLmNvbXBsZXRlZEF0LFxuICAgICAgICAgICAgZHVyYXRpb246IGRhdGEuZHVyYXRpb24sXG4gICAgICAgICAgICBhdHRlbmRhbmNlU3RhdHVzOiBkYXRhLmF0dGVuZGFuY2VTdGF0dXMsXG4gICAgICAgICAgICBzZXNzaW9uTm90ZXM6IGRhdGEuc2Vzc2lvbk5vdGVzLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICByZWFsVGltZTogdHJ1ZSxcbiAgICAgICAgICBlbWFpbDogZmFsc2UsXG4gICAgICAgICAgcHVzaDogZmFsc2UsXG4gICAgICAgIH0sXG4gICAgICApO1xuXG4gICAgICB0aGlzLmxvZ2dlci5sb2coXG4gICAgICAgIGBBcHBvaW50bWVudCBjb21wbGV0ZWQgbm90aWZpY2F0aW9ucyBzZW50IGZvciBhcHBvaW50bWVudCAke2RhdGEuYXBwb2ludG1lbnRJZH1gLFxuICAgICAgKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoXG4gICAgICAgIGBFcnJvciBoYW5kbGluZyBhcHBvaW50bWVudCBjb21wbGV0ZWQgZXZlbnQ6YCxcbiAgICAgICAgZXJyb3IsXG4gICAgICApO1xuICAgIH1cbiAgfVxufVxuIl0sInZlcnNpb24iOjN9