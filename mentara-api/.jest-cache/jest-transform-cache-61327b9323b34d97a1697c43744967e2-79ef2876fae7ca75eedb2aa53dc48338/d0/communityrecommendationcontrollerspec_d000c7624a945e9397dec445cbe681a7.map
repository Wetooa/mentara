{"file":"/home/wetooa/Documents/code/projects/mentara/mentara-api/src/communities/controllers/community-recommendation.controller.spec.ts","mappings":"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","names":[],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/communities/controllers/community-recommendation.controller.spec.ts"],"sourcesContent":["/**\n * Comprehensive Test Suite for CommunityRecommendationController\n * Tests community recommendation functionality with role-based access control\n */\n\nimport { Test, TestingModule } from '@nestjs/testing';\nimport { BadRequestException, NotFoundException, ForbiddenException, HttpException, HttpStatus } from '@nestjs/common';\nimport { CommunityRecommendationController } from './community-recommendation.controller';\nimport { CommunityRecommendationService } from '../services/community-recommendation.service';\nimport { JwtAuthGuard } from '../../auth/guards/jwt-auth.guard';\nimport { RoleBasedAccessGuard } from '../../auth/guards/role-based-access.guard';\nimport { SecurityGuardTestUtils, RoleBasedTestUtils } from '../../test-utils/auth-testing-helpers';\nimport { MockBuilder, TestDataGenerator, TestAssertions } from '../../test-utils/enhanced-test-helpers';\nimport { TEST_USER_IDS, TEST_EMAILS } from '../../test-utils/index';\n\ndescribe('CommunityRecommendationController', () => {\n  let controller: CommunityRecommendationController;\n  let communityRecommendationService: CommunityRecommendationService;\n  let module: TestingModule;\n\n  // Mock CommunityRecommendationService\n  const mockCommunityRecommendationService = {\n    generateRecommendationsForUser: jest.fn(),\n    getUserRecommendations: jest.fn(),\n    getRecommendationById: jest.fn(),\n    handleRecommendationInteraction: jest.fn(),\n    getRecommendationStats: jest.fn(),\n  };\n\n  // Mock Guards\n  const mockJwtAuthGuard = {\n    canActivate: jest.fn().mockReturnValue(true),\n  };\n\n  const mockRoleBasedAccessGuard = {\n    canActivate: jest.fn().mockReturnValue(true),\n  };\n\n  // Test data\n  const mockUser = {\n    id: TEST_USER_IDS.CLIENT,\n    email: TEST_EMAILS.CLIENT,\n    role: 'client',\n  };\n\n  const mockCommunity = {\n    id: 'community_123456789',\n    name: 'Anxiety Support Group',\n    slug: 'anxiety-support',\n    description: 'A supportive community for those dealing with anxiety disorders',\n    imageUrl: 'https://example.com/images/anxiety-community.jpg',\n    memberCount: 1247,\n    isPublic: true,\n    moderatorId: TEST_USER_IDS.MODERATOR,\n    createdAt: new Date('2024-01-01T00:00:00Z'),\n    updatedAt: new Date('2024-02-14T10:00:00Z'),\n  };\n\n  const mockRecommendation = {\n    id: 'recommendation_123456789',\n    userId: TEST_USER_IDS.CLIENT,\n    communityId: 'community_123456789',\n    community: mockCommunity,\n    score: 0.87,\n    reasoning: 'Based on your anxiety assessment scores and preference for group support, this community would be highly beneficial for your mental health journey.',\n    assessmentScores: {\n      anxiety: 6.8,\n      depression: 3.2,\n      stress: 7.1,\n      socialAnxiety: 5.9,\n    },\n    status: 'pending',\n    createdAt: new Date('2024-02-14T10:00:00Z'),\n    updatedAt: new Date('2024-02-14T10:00:00Z'),\n    interactionDate: null,\n  };\n\n  const mockRecommendationsList = [\n    mockRecommendation,\n    {\n      ...mockRecommendation,\n      id: 'recommendation_987654321',\n      communityId: 'community_987654321',\n      community: {\n        ...mockCommunity,\n        id: 'community_987654321',\n        name: 'Depression Recovery',\n        slug: 'depression-recovery',\n        description: 'Support for depression recovery and mental wellness',\n        memberCount: 892,\n      },\n      score: 0.74,\n      reasoning: 'Your depression scores indicate this community could provide valuable peer support.',\n      assessmentScores: {\n        anxiety: 4.1,\n        depression: 7.3,\n        stress: 5.8,\n        socialAnxiety: 3.2,\n      },\n      status: 'joined',\n      interactionDate: new Date('2024-02-10T14:30:00Z'),\n    },\n    {\n      ...mockRecommendation,\n      id: 'recommendation_456789123',\n      communityId: 'community_456789123',\n      community: {\n        ...mockCommunity,\n        id: 'community_456789123',\n        name: 'Mindfulness & Meditation',\n        slug: 'mindfulness-meditation',\n        description: 'Practice mindfulness and meditation techniques together',\n        memberCount: 2156,\n      },\n      score: 0.65,\n      reasoning: 'Mindfulness practices can help with stress management based on your assessment.',\n      status: 'dismissed',\n      interactionDate: new Date('2024-02-08T09:15:00Z'),\n    },\n  ];\n\n  const mockRecommendationStats = {\n    totalRecommendations: 156,\n    acceptedRecommendations: 89,\n    rejectedRecommendations: 23,\n    pendingRecommendations: 44,\n    averageCompatibilityScore: 0.76,\n    topCommunities: [\n      {\n        communityId: 'community_123456789',\n        communityName: 'Anxiety Support Group',\n        acceptanceRate: 0.83,\n        totalRecommendations: 67,\n      },\n      {\n        communityId: 'community_987654321',\n        communityName: 'Depression Recovery',\n        acceptanceRate: 0.78,\n        totalRecommendations: 54,\n      },\n    ],\n    weeklyTrends: {\n      generated: 23,\n      accepted: 18,\n      rejected: 3,\n      pending: 2,\n    },\n    categoryPerformance: {\n      anxiety: { averageScore: 0.82, acceptanceRate: 0.85 },\n      depression: { averageScore: 0.79, acceptanceRate: 0.81 },\n      stress: { averageScore: 0.74, acceptanceRate: 0.76 },\n      addiction: { averageScore: 0.71, acceptanceRate: 0.73 },\n    },\n  };\n\n  beforeEach(async () => {\n    module = await Test.createTestingModule({\n      controllers: [CommunityRecommendationController],\n      providers: [\n        {\n          provide: CommunityRecommendationService,\n          useValue: mockCommunityRecommendationService,\n        },\n      ],\n    })\n      .overrideGuard(JwtAuthGuard)\n      .useValue(mockJwtAuthGuard)\n      .overrideGuard(RoleBasedAccessGuard)\n      .useValue(mockRoleBasedAccessGuard)\n      .compile();\n\n    controller = module.get<CommunityRecommendationController>(CommunityRecommendationController);\n    communityRecommendationService = module.get<CommunityRecommendationService>(CommunityRecommendationService);\n  });\n\n  afterEach(() => {\n    jest.clearAllMocks();\n  });\n\n  describe('Controller Initialization', () => {\n    it('should be defined', () => {\n      expect(controller).toBeDefined();\n    });\n\n    it('should have communityRecommendationService injected', () => {\n      expect(communityRecommendationService).toBeDefined();\n    });\n  });\n\n  describe('Security Guards', () => {\n    it('should be protected by JwtAuthGuard and RoleBasedAccessGuard', () => {\n      const guards = Reflect.getMetadata('__guards__', CommunityRecommendationController);\n      expect(guards).toContain(JwtAuthGuard);\n      expect(guards).toContain(RoleBasedAccessGuard);\n    });\n\n    it('should have proper route decorators', () => {\n      const controllerMetadata = Reflect.getMetadata('path', CommunityRecommendationController);\n      expect(controllerMetadata).toBe('communities/recommendations');\n    });\n  });\n\n  describe('POST /communities/recommendations/generate', () => {\n    const generateDto = { force: false };\n\n    beforeEach(() => {\n      mockCommunityRecommendationService.generateRecommendationsForUser.mockResolvedValue(undefined);\n      mockCommunityRecommendationService.getUserRecommendations.mockResolvedValue(mockRecommendationsList);\n    });\n\n    it('should generate recommendations successfully', async () => {\n      const result = await controller.generateRecommendations(mockUser, generateDto);\n\n      expect(result).toEqual({\n        success: true,\n        data: mockRecommendationsList,\n        message: `Generated ${mockRecommendationsList.length} recommendations`,\n      });\n\n      expect(communityRecommendationService.generateRecommendationsForUser).toHaveBeenCalledWith(\n        mockUser.id,\n        generateDto.force,\n      );\n      expect(communityRecommendationService.getUserRecommendations).toHaveBeenCalledWith(mockUser.id);\n    });\n\n    it('should handle forced regeneration', async () => {\n      const forcedDto = { force: true };\n\n      const result = await controller.generateRecommendations(mockUser, forcedDto);\n\n      expect(result.success).toBe(true);\n      expect(communityRecommendationService.generateRecommendationsForUser).toHaveBeenCalledWith(\n        mockUser.id,\n        true,\n      );\n    });\n\n    it('should handle empty recommendations', async () => {\n      mockCommunityRecommendationService.getUserRecommendations.mockResolvedValue([]);\n\n      const result = await controller.generateRecommendations(mockUser, generateDto);\n\n      expect(result).toEqual({\n        success: true,\n        data: [],\n        message: 'Generated 0 recommendations',\n      });\n    });\n\n    it('should handle service errors during generation', async () => {\n      const serviceError = new Error('Failed to generate recommendations');\n      mockCommunityRecommendationService.generateRecommendationsForUser.mockRejectedValue(serviceError);\n\n      await expect(\n        controller.generateRecommendations(mockUser, generateDto)\n      ).rejects.toThrow(serviceError);\n    });\n\n    it('should handle service errors during retrieval', async () => {\n      const retrievalError = new Error('Failed to retrieve recommendations');\n      mockCommunityRecommendationService.getUserRecommendations.mockRejectedValue(retrievalError);\n\n      await expect(\n        controller.generateRecommendations(mockUser, generateDto)\n      ).rejects.toThrow(retrievalError);\n    });\n  });\n\n  describe('GET /communities/recommendations/me', () => {\n    beforeEach(() => {\n      mockCommunityRecommendationService.getUserRecommendations.mockResolvedValue(mockRecommendationsList);\n    });\n\n    it('should get user recommendations successfully', async () => {\n      const query = {};\n\n      const result = await controller.getUserRecommendations(mockUser, query);\n\n      expect(result).toEqual({\n        success: true,\n        data: mockRecommendationsList,\n        message: 'Recommendations retrieved successfully',\n      });\n      expect(communityRecommendationService.getUserRecommendations).toHaveBeenCalledWith(mockUser.id);\n    });\n\n    it('should filter by status - pending', async () => {\n      const query = { status: 'pending' as const };\n\n      const result = await controller.getUserRecommendations(mockUser, query);\n\n      const expectedFiltered = mockRecommendationsList.filter(rec => rec.status === 'pending');\n      expect(result.data).toEqual(expectedFiltered);\n    });\n\n    it('should filter by status - accepted', async () => {\n      const query = { status: 'accepted' as const };\n\n      const result = await controller.getUserRecommendations(mockUser, query);\n\n      const expectedFiltered = mockRecommendationsList.filter(rec => rec.status === 'joined');\n      expect(result.data).toEqual(expectedFiltered);\n    });\n\n    it('should filter by status - rejected', async () => {\n      const query = { status: 'rejected' as const };\n\n      const result = await controller.getUserRecommendations(mockUser, query);\n\n      const expectedFiltered = mockRecommendationsList.filter(rec => rec.status === 'dismissed');\n      expect(result.data).toEqual(expectedFiltered);\n    });\n\n    it('should sort by compatibility score - descending', async () => {\n      const query = { sortBy: 'compatibility' as const, sortOrder: 'desc' as const };\n\n      const result = await controller.getUserRecommendations(mockUser, query);\n\n      const sortedData = result.data as typeof mockRecommendationsList;\n      expect(sortedData[0].score).toBeGreaterThanOrEqual(sortedData[1].score);\n    });\n\n    it('should sort by compatibility score - ascending', async () => {\n      const query = { sortBy: 'compatibility' as const, sortOrder: 'asc' as const };\n\n      const result = await controller.getUserRecommendations(mockUser, query);\n\n      const sortedData = result.data as typeof mockRecommendationsList;\n      expect(sortedData[0].score).toBeLessThanOrEqual(sortedData[sortedData.length - 1].score);\n    });\n\n    it('should sort by created date', async () => {\n      const query = { sortBy: 'created' as const, sortOrder: 'desc' as const };\n\n      const result = await controller.getUserRecommendations(mockUser, query);\n\n      expect(result.success).toBe(true);\n      expect(Array.isArray(result.data)).toBe(true);\n    });\n\n    it('should sort by updated date', async () => {\n      const query = { sortBy: 'updated' as const, sortOrder: 'desc' as const };\n\n      const result = await controller.getUserRecommendations(mockUser, query);\n\n      expect(result.success).toBe(true);\n      expect(Array.isArray(result.data)).toBe(true);\n    });\n\n    it('should handle combined filtering and sorting', async () => {\n      const query = {\n        status: 'pending' as const,\n        sortBy: 'compatibility' as const,\n        sortOrder: 'desc' as const,\n      };\n\n      const result = await controller.getUserRecommendations(mockUser, query);\n\n      const resultData = result.data as typeof mockRecommendationsList;\n      expect(resultData.every(rec => rec.status === 'pending')).toBe(true);\n    });\n\n    it('should handle empty recommendations', async () => {\n      mockCommunityRecommendationService.getUserRecommendations.mockResolvedValue([]);\n\n      const result = await controller.getUserRecommendations(mockUser, {});\n\n      expect(result.data).toEqual([]);\n      expect(result.success).toBe(true);\n    });\n\n    it('should handle service errors', async () => {\n      const serviceError = new Error('Failed to retrieve user recommendations');\n      mockCommunityRecommendationService.getUserRecommendations.mockRejectedValue(serviceError);\n\n      await expect(\n        controller.getUserRecommendations(mockUser, {})\n      ).rejects.toThrow(serviceError);\n    });\n  });\n\n  describe('GET /communities/recommendations/:recommendationId', () => {\n    const recommendationId = 'recommendation_123456789';\n\n    it('should get recommendation details successfully', async () => {\n      mockCommunityRecommendationService.getRecommendationById.mockResolvedValue(mockRecommendation);\n\n      const result = await controller.getRecommendationDetails(mockUser, recommendationId);\n\n      expect(result).toEqual({\n        success: true,\n        data: mockRecommendation,\n        message: 'Recommendation details retrieved successfully',\n      });\n      expect(communityRecommendationService.getRecommendationById).toHaveBeenCalledWith(recommendationId);\n    });\n\n    it('should handle recommendation not found', async () => {\n      const notFoundError = new Error('Recommendation not found');\n      mockCommunityRecommendationService.getRecommendationById.mockRejectedValue(notFoundError);\n\n      await expect(\n        controller.getRecommendationDetails(mockUser, 'non-existent-id')\n      ).rejects.toThrow(notFoundError);\n    });\n\n    it('should handle invalid UUID format', async () => {\n      const invalidId = 'invalid-uuid';\n\n      await expect(\n        controller.getRecommendationDetails(mockUser, invalidId)\n      ).rejects.toThrow();\n    });\n\n    it('should handle service errors', async () => {\n      const serviceError = new Error('Database connection failed');\n      mockCommunityRecommendationService.getRecommendationById.mockRejectedValue(serviceError);\n\n      await expect(\n        controller.getRecommendationDetails(mockUser, recommendationId)\n      ).rejects.toThrow(serviceError);\n    });\n  });\n\n  describe('PUT /communities/recommendations/:recommendationId/interact', () => {\n    const recommendationId = 'recommendation_123456789';\n\n    it('should handle accept interaction successfully', async () => {\n      const interactionDto = { action: 'accept' as const };\n      mockCommunityRecommendationService.handleRecommendationInteraction.mockResolvedValue(undefined);\n\n      const result = await controller.handleRecommendationInteraction(\n        mockUser,\n        recommendationId,\n        interactionDto,\n      );\n\n      expect(result).toEqual({\n        success: true,\n        message: 'Recommendation accepted successfully',\n      });\n      expect(communityRecommendationService.handleRecommendationInteraction).toHaveBeenCalledWith({\n        recommendationId,\n        action: 'accept',\n        userId: mockUser.id,\n      });\n    });\n\n    it('should handle reject interaction successfully', async () => {\n      const interactionDto = { action: 'reject' as const };\n      mockCommunityRecommendationService.handleRecommendationInteraction.mockResolvedValue(undefined);\n\n      const result = await controller.handleRecommendationInteraction(\n        mockUser,\n        recommendationId,\n        interactionDto,\n      );\n\n      expect(result).toEqual({\n        success: true,\n        message: 'Recommendation rejected successfully',\n      });\n      expect(communityRecommendationService.handleRecommendationInteraction).toHaveBeenCalledWith({\n        recommendationId,\n        action: 'reject',\n        userId: mockUser.id,\n      });\n    });\n\n    it('should handle dismiss interaction successfully', async () => {\n      const interactionDto = { action: 'dismiss' as const };\n      mockCommunityRecommendationService.handleRecommendationInteraction.mockResolvedValue(undefined);\n\n      const result = await controller.handleRecommendationInteraction(\n        mockUser,\n        recommendationId,\n        interactionDto,\n      );\n\n      expect(result).toEqual({\n        success: true,\n        message: 'Recommendation dismissed successfully',\n      });\n    });\n\n    it('should handle recommendation not found', async () => {\n      const interactionDto = { action: 'accept' as const };\n      const notFoundError = new Error('Recommendation not found');\n      mockCommunityRecommendationService.handleRecommendationInteraction.mockRejectedValue(notFoundError);\n\n      await expect(\n        controller.handleRecommendationInteraction(mockUser, 'non-existent-id', interactionDto)\n      ).rejects.toThrow(notFoundError);\n    });\n\n    it('should handle already interacted recommendation', async () => {\n      const interactionDto = { action: 'accept' as const };\n      const alreadyInteractedError = new Error('Recommendation already interacted with');\n      mockCommunityRecommendationService.handleRecommendationInteraction.mockRejectedValue(alreadyInteractedError);\n\n      await expect(\n        controller.handleRecommendationInteraction(mockUser, recommendationId, interactionDto)\n      ).rejects.toThrow(alreadyInteractedError);\n    });\n\n    it('should handle service errors', async () => {\n      const interactionDto = { action: 'accept' as const };\n      const serviceError = new Error('Database update failed');\n      mockCommunityRecommendationService.handleRecommendationInteraction.mockRejectedValue(serviceError);\n\n      await expect(\n        controller.handleRecommendationInteraction(mockUser, recommendationId, interactionDto)\n      ).rejects.toThrow(serviceError);\n    });\n  });\n\n  describe('POST /communities/recommendations/refresh', () => {\n    beforeEach(() => {\n      mockCommunityRecommendationService.generateRecommendationsForUser.mockResolvedValue(undefined);\n    });\n\n    it('should refresh recommendations successfully', async () => {\n      const result = await controller.refreshRecommendations(mockUser);\n\n      expect(result).toEqual({\n        success: true,\n        message: 'Recommendations refreshed successfully',\n      });\n      expect(communityRecommendationService.generateRecommendationsForUser).toHaveBeenCalledWith(\n        mockUser.id,\n        true, // force refresh\n      );\n    });\n\n    it('should handle service errors during refresh', async () => {\n      const serviceError = new Error('Failed to refresh recommendations');\n      mockCommunityRecommendationService.generateRecommendationsForUser.mockRejectedValue(serviceError);\n\n      await expect(\n        controller.refreshRecommendations(mockUser)\n      ).rejects.toThrow(serviceError);\n    });\n\n    it('should always force refresh', async () => {\n      await controller.refreshRecommendations(mockUser);\n\n      expect(communityRecommendationService.generateRecommendationsForUser).toHaveBeenCalledWith(\n        mockUser.id,\n        true, // should always be true for refresh\n      );\n    });\n  });\n\n  describe('GET /communities/recommendations/stats/me', () => {\n    beforeEach(() => {\n      mockCommunityRecommendationService.getRecommendationStats.mockResolvedValue(mockRecommendationStats);\n    });\n\n    it('should get user recommendation stats successfully', async () => {\n      const result = await controller.getUserRecommendationStats(mockUser);\n\n      expect(result).toEqual({\n        success: true,\n        data: mockRecommendationStats,\n        message: 'User recommendation statistics retrieved successfully',\n      });\n      expect(communityRecommendationService.getRecommendationStats).toHaveBeenCalledWith();\n    });\n\n    it('should validate stats response structure', async () => {\n      const result = await controller.getUserRecommendationStats(mockUser);\n\n      expect(result.data).toHaveProperty('totalRecommendations');\n      expect(result.data).toHaveProperty('acceptedRecommendations');\n      expect(result.data).toHaveProperty('rejectedRecommendations');\n      expect(result.data).toHaveProperty('pendingRecommendations');\n      expect(result.data).toHaveProperty('averageCompatibilityScore');\n      expect(result.data).toHaveProperty('topCommunities');\n      expect(Array.isArray(result.data.topCommunities)).toBe(true);\n    });\n\n    it('should handle empty stats', async () => {\n      const emptyStats = {\n        totalRecommendations: 0,\n        acceptedRecommendations: 0,\n        rejectedRecommendations: 0,\n        pendingRecommendations: 0,\n        averageCompatibilityScore: 0,\n        topCommunities: [],\n        weeklyTrends: { generated: 0, accepted: 0, rejected: 0, pending: 0 },\n        categoryPerformance: {},\n      };\n      mockCommunityRecommendationService.getRecommendationStats.mockResolvedValue(emptyStats);\n\n      const result = await controller.getUserRecommendationStats(mockUser);\n\n      expect(result.data.totalRecommendations).toBe(0);\n      expect(result.data.topCommunities).toEqual([]);\n    });\n\n    it('should handle service errors', async () => {\n      const serviceError = new Error('Failed to retrieve recommendation stats');\n      mockCommunityRecommendationService.getRecommendationStats.mockRejectedValue(serviceError);\n\n      await expect(\n        controller.getUserRecommendationStats(mockUser)\n      ).rejects.toThrow(serviceError);\n    });\n  });\n\n  describe('GET /communities/recommendations/stats/global', () => {\n    beforeEach(() => {\n      mockCommunityRecommendationService.getRecommendationStats.mockResolvedValue(mockRecommendationStats);\n    });\n\n    it('should get global recommendation stats successfully', async () => {\n      const result = await controller.getGlobalRecommendationStats();\n\n      expect(result).toEqual({\n        success: true,\n        data: mockRecommendationStats,\n        message: 'Global recommendation statistics retrieved successfully',\n      });\n      expect(communityRecommendationService.getRecommendationStats).toHaveBeenCalledWith();\n    });\n\n    it('should validate global stats response structure', async () => {\n      const result = await controller.getGlobalRecommendationStats();\n\n      expect(result.data).toHaveProperty('totalRecommendations');\n      expect(result.data).toHaveProperty('weeklyTrends');\n      expect(result.data).toHaveProperty('categoryPerformance');\n      expect(typeof result.data.totalRecommendations).toBe('number');\n      expect(typeof result.data.averageCompatibilityScore).toBe('number');\n    });\n\n    it('should handle service errors', async () => {\n      const serviceError = new Error('Failed to retrieve global recommendation stats');\n      mockCommunityRecommendationService.getRecommendationStats.mockRejectedValue(serviceError);\n\n      await expect(\n        controller.getGlobalRecommendationStats()\n      ).rejects.toThrow(serviceError);\n    });\n  });\n\n  describe('Role-Based Access Control', () => {\n    it('should allow all authenticated users to access user endpoints', () => {\n      const userEndpoints = [\n        'generateRecommendations',\n        'getUserRecommendations',\n        'getRecommendationDetails',\n        'handleRecommendationInteraction',\n        'refreshRecommendations',\n        'getUserRecommendationStats',\n      ];\n\n      userEndpoints.forEach(endpoint => {\n        const metadata = Reflect.getMetadata('roles', controller[endpoint as keyof CommunityRecommendationController]);\n        expect(metadata).toContain('client');\n        expect(metadata).toContain('therapist');\n        expect(metadata).toContain('moderator');\n        expect(metadata).toContain('admin');\n      });\n    });\n\n    it('should restrict global stats to admin and moderator only', () => {\n      const metadata = Reflect.getMetadata('roles', controller.getGlobalRecommendationStats);\n      expect(metadata).toContain('admin');\n      expect(metadata).toContain('moderator');\n      expect(metadata).not.toContain('client');\n      expect(metadata).not.toContain('therapist');\n    });\n  });\n\n  describe('Response Format Validation', () => {\n    it('should return properly formatted generate response', async () => {\n      mockCommunityRecommendationService.generateRecommendationsForUser.mockResolvedValue(undefined);\n      mockCommunityRecommendationService.getUserRecommendations.mockResolvedValue(mockRecommendationsList);\n\n      const result = await controller.generateRecommendations(mockUser, { force: false });\n\n      expect(result).toHaveProperty('success');\n      expect(result).toHaveProperty('data');\n      expect(result).toHaveProperty('message');\n      expect(result.success).toBe(true);\n      expect(Array.isArray(result.data)).toBe(true);\n      expect(typeof result.message).toBe('string');\n    });\n\n    it('should return properly formatted recommendations list', async () => {\n      mockCommunityRecommendationService.getUserRecommendations.mockResolvedValue(mockRecommendationsList);\n\n      const result = await controller.getUserRecommendations(mockUser, {});\n\n      expect(result.data).toBeInstanceOf(Array);\n      result.data.forEach((recommendation: any) => {\n        TestAssertions.expectValidEntity(recommendation, ['id', 'userId', 'communityId', 'score']);\n        expect(recommendation.score).toBeGreaterThanOrEqual(0);\n        expect(recommendation.score).toBeLessThanOrEqual(1);\n        expect(recommendation.community).toHaveProperty('id');\n        expect(recommendation.community).toHaveProperty('name');\n      });\n    });\n\n    it('should return properly formatted recommendation details', async () => {\n      mockCommunityRecommendationService.getRecommendationById.mockResolvedValue(mockRecommendation);\n\n      const result = await controller.getRecommendationDetails(mockUser, 'recommendation_123456789');\n\n      TestAssertions.expectValidEntity(result.data, ['id', 'userId', 'communityId', 'score', 'reasoning']);\n      expect(result.data.community).toBeDefined();\n      expect(result.data.assessmentScores).toBeDefined();\n      expect(typeof result.data.score).toBe('number');\n      expect(typeof result.data.reasoning).toBe('string');\n    });\n\n    it('should return properly formatted stats response', async () => {\n      mockCommunityRecommendationService.getRecommendationStats.mockResolvedValue(mockRecommendationStats);\n\n      const result = await controller.getUserRecommendationStats(mockUser);\n\n      TestAssertions.expectValidEntity(result.data, [\n        'totalRecommendations',\n        'acceptedRecommendations',\n        'rejectedRecommendations',\n        'pendingRecommendations',\n        'averageCompatibilityScore',\n        'topCommunities',\n      ]);\n      expect(Array.isArray(result.data.topCommunities)).toBe(true);\n      expect(typeof result.data.totalRecommendations).toBe('number');\n      expect(typeof result.data.averageCompatibilityScore).toBe('number');\n    });\n  });\n\n  describe('Error Handling', () => {\n    it('should handle service unavailable scenarios', async () => {\n      const serviceError = new Error('Recommendation service temporarily unavailable');\n      mockCommunityRecommendationService.getUserRecommendations.mockRejectedValue(serviceError);\n\n      await expect(\n        controller.getUserRecommendations(mockUser, {})\n      ).rejects.toThrow(serviceError);\n    });\n\n    it('should handle database connection errors', async () => {\n      const dbError = new Error('Database connection failed');\n      mockCommunityRecommendationService.generateRecommendationsForUser.mockRejectedValue(dbError);\n\n      await expect(\n        controller.generateRecommendations(mockUser, { force: false })\n      ).rejects.toThrow(dbError);\n    });\n\n    it('should handle validation errors', async () => {\n      const validationError = new Error('Invalid recommendation data');\n      mockCommunityRecommendationService.handleRecommendationInteraction.mockRejectedValue(validationError);\n\n      await expect(\n        controller.handleRecommendationInteraction(\n          mockUser,\n          'recommendation_123',\n          { action: 'accept' },\n        )\n      ).rejects.toThrow(validationError);\n    });\n\n    it('should handle concurrent interaction attempts', async () => {\n      const concurrencyError = new Error('Recommendation interaction already in progress');\n      mockCommunityRecommendationService.handleRecommendationInteraction.mockRejectedValue(concurrencyError);\n\n      await expect(\n        controller.handleRecommendationInteraction(\n          mockUser,\n          'recommendation_123',\n          { action: 'accept' },\n        )\n      ).rejects.toThrow(concurrencyError);\n    });\n  });\n\n  describe('Integration Tests', () => {\n    it('should handle complete recommendation workflow', async () => {\n      // Generate recommendations\n      mockCommunityRecommendationService.generateRecommendationsForUser.mockResolvedValue(undefined);\n      mockCommunityRecommendationService.getUserRecommendations.mockResolvedValue(mockRecommendationsList);\n      const generateResult = await controller.generateRecommendations(mockUser, { force: false });\n      expect(generateResult.success).toBe(true);\n\n      // Get user recommendations\n      const userRecommendations = await controller.getUserRecommendations(mockUser, {});\n      expect(userRecommendations.data).toHaveLength(3);\n\n      // Get recommendation details\n      mockCommunityRecommendationService.getRecommendationById.mockResolvedValue(mockRecommendation);\n      const details = await controller.getRecommendationDetails(mockUser, mockRecommendation.id);\n      expect(details.data.id).toBe(mockRecommendation.id);\n\n      // Interact with recommendation\n      mockCommunityRecommendationService.handleRecommendationInteraction.mockResolvedValue(undefined);\n      const interaction = await controller.handleRecommendationInteraction(\n        mockUser,\n        mockRecommendation.id,\n        { action: 'accept' },\n      );\n      expect(interaction.success).toBe(true);\n\n      // Get updated stats\n      mockCommunityRecommendationService.getRecommendationStats.mockResolvedValue(mockRecommendationStats);\n      const stats = await controller.getUserRecommendationStats(mockUser);\n      expect(stats.data.totalRecommendations).toBeGreaterThan(0);\n    });\n\n    it('should handle filtering and sorting workflow', async () => {\n      mockCommunityRecommendationService.getUserRecommendations.mockResolvedValue(mockRecommendationsList);\n\n      // Get pending recommendations\n      const pendingResult = await controller.getUserRecommendations(mockUser, { status: 'pending' });\n      expect(pendingResult.data.every((rec: any) => rec.status === 'pending')).toBe(true);\n\n      // Get recommendations sorted by compatibility\n      const sortedResult = await controller.getUserRecommendations(mockUser, {\n        sortBy: 'compatibility',\n        sortOrder: 'desc',\n      });\n      expect(sortedResult.success).toBe(true);\n\n      // Get accepted recommendations\n      const acceptedResult = await controller.getUserRecommendations(mockUser, { status: 'accepted' });\n      expect(acceptedResult.data.every((rec: any) => rec.status === 'joined')).toBe(true);\n    });\n\n    it('should handle admin analytics workflow', async () => {\n      mockCommunityRecommendationService.getRecommendationStats.mockResolvedValue(mockRecommendationStats);\n\n      // Get global stats\n      const globalStats = await controller.getGlobalRecommendationStats();\n      expect(globalStats.data.totalRecommendations).toBeGreaterThan(0);\n      expect(globalStats.data.categoryPerformance).toBeDefined();\n\n      // Verify detailed metrics\n      expect(globalStats.data.weeklyTrends).toBeDefined();\n      expect(globalStats.data.topCommunities).toBeInstanceOf(Array);\n      expect(globalStats.data.averageCompatibilityScore).toBeGreaterThan(0);\n    });\n  });\n});"],"version":3}