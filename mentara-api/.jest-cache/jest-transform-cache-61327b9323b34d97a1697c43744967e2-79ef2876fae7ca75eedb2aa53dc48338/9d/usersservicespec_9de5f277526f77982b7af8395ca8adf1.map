{"file":"/home/wetooa/Documents/code/projects/mentara/mentara-api/src/users/users.service.spec.ts","mappings":"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","names":[],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/users/users.service.spec.ts"],"sourcesContent":["import { Test, TestingModule } from '@nestjs/testing';\nimport { InternalServerErrorException } from '@nestjs/common';\nimport { UsersService } from './users.service';\nimport { PrismaService } from '../providers/prisma-client.provider';\nimport { EventBusService } from '../common/events/event-bus.service';\nimport {\n  UserRegisteredEvent,\n  UserProfileUpdatedEvent,\n  UserDeactivatedEvent,\n  UserReactivatedEvent,\n} from '../common/events/user-events';\nimport {\n  createMockPrismaService,\n  createMockEventBus,\n  TEST_USER_IDS,\n} from '../test-utils';\nimport {\n  TestDataGenerator,\n  TestAssertions,\n} from '../test-utils/enhanced-test-helpers';\n\ndescribe('UsersService', () => {\n  let service: UsersService;\n  let mockPrisma: any;\n  let mockEventBus: any;\n\n  beforeEach(async () => {\n    mockPrisma = createMockPrismaService();\n    mockEventBus = createMockEventBus();\n\n    const module: TestingModule = await Test.createTestingModule({\n      providers: [\n        UsersService,\n        { provide: PrismaService, useValue: mockPrisma },\n        { provide: EventBusService, useValue: mockEventBus },\n      ],\n    }).compile();\n\n    service = module.get<UsersService>(UsersService);\n  });\n\n  afterEach(() => {\n    jest.clearAllMocks();\n  });\n\n  describe('findById', () => {\n    it('should return a user by id (active only)', async () => {\n      const mockUser = TestDataGenerator.createUser({ isActive: true });\n      mockPrisma.user.findUnique.mockResolvedValue(mockUser);\n\n      const result = await service.findById(TEST_USER_IDS.CLIENT);\n\n      expect(mockPrisma.user.findUnique).toHaveBeenCalledWith({\n        where: {\n          id: TEST_USER_IDS.CLIENT,\n          isActive: true,\n        },\n      });\n      expect(result).toEqual(mockUser);\n    });\n\n    it('should return null if user not found', async () => {\n      mockPrisma.user.findUnique.mockResolvedValue(null);\n\n      const result = await service.findById('non-existent-id');\n\n      expect(result).toBeNull();\n    });\n  });\n\n  describe('findByIdIncludeInactive', () => {\n    it('should return a user by id including inactive users', async () => {\n      const mockUser = TestDataGenerator.createUser({ isActive: false });\n      mockPrisma.user.findUnique.mockResolvedValue(mockUser);\n\n      const result = await service.findByIdIncludeInactive(TEST_USER_IDS.CLIENT);\n\n      expect(mockPrisma.user.findUnique).toHaveBeenCalledWith({\n        where: { id: TEST_USER_IDS.CLIENT },\n      });\n      expect(result).toEqual(mockUser);\n    });\n  });\n\n  describe('findAll', () => {\n    it('should return all active users', async () => {\n      const mockUsers = [\n        TestDataGenerator.createUser({ isActive: true }),\n        TestDataGenerator.createUser({ isActive: true }),\n      ];\n      mockPrisma.user.findMany.mockResolvedValue(mockUsers);\n\n      const result = await service.findAll();\n\n      expect(mockPrisma.user.findMany).toHaveBeenCalledWith({\n        where: { isActive: true },\n      });\n      expect(result).toEqual(mockUsers);\n    });\n\n    it('should handle database errors', async () => {\n      mockPrisma.user.findMany.mockRejectedValue(new Error('Database error'));\n\n      await TestAssertions.expectToThrowNestException(\n        () => service.findAll(),\n        InternalServerErrorException,\n        'Database error',\n      );\n    });\n  });\n\n  describe('findOne', () => {\n    it('should return user with therapist relationship', async () => {\n      const mockUser = {\n        ...TestDataGenerator.createUser({ isActive: true }),\n        therapist: { id: 'therapist-123' },\n      };\n      mockPrisma.user.findUnique.mockResolvedValue(mockUser);\n\n      const result = await service.findOne(TEST_USER_IDS.CLIENT);\n\n      expect(mockPrisma.user.findUnique).toHaveBeenCalledWith({\n        where: {\n          id: TEST_USER_IDS.CLIENT,\n          isActive: true,\n        },\n        include: { therapist: true },\n      });\n      expect(result).toEqual(mockUser);\n    });\n  });\n\n  describe('findOneIncludeInactive', () => {\n    it('should return user with all relationships including inactive', async () => {\n      const mockUser = {\n        ...TestDataGenerator.createUser({ isActive: false }),\n        therapist: { id: 'therapist-123' },\n        client: { id: 'client-123' },\n        admin: { id: 'admin-123' },\n        moderator: { id: 'moderator-123' },\n      };\n      mockPrisma.user.findUnique.mockResolvedValue(mockUser);\n\n      const result = await service.findOneIncludeInactive(TEST_USER_IDS.CLIENT);\n\n      expect(mockPrisma.user.findUnique).toHaveBeenCalledWith({\n        where: { id: TEST_USER_IDS.CLIENT },\n        include: {\n          therapist: true,\n          client: true,\n          admin: true,\n          moderator: true,\n        },\n      });\n      expect(result).toEqual(mockUser);\n    });\n  });\n\n  describe('findByRole', () => {\n    it('should return users by role (active only)', async () => {\n      const mockUsers = [\n        TestDataGenerator.createUser({ role: 'client', isActive: true }),\n        TestDataGenerator.createUser({ role: 'client', isActive: true }),\n      ];\n      mockPrisma.user.findMany.mockResolvedValue(mockUsers);\n\n      const result = await service.findByRole('client');\n\n      expect(mockPrisma.user.findMany).toHaveBeenCalledWith({\n        where: {\n          role: 'client',\n          isActive: true,\n        },\n      });\n      expect(result).toEqual(mockUsers);\n    });\n  });\n\n  describe('update', () => {\n    it('should update user and emit profile updated event', async () => {\n      const previousUser = TestDataGenerator.createUser();\n      const updatedUser = { ...previousUser, firstName: 'Updated Name' };\n      const updateData = { firstName: 'Updated Name' };\n\n      mockPrisma.user.findUnique.mockResolvedValue(previousUser);\n      mockPrisma.user.update.mockResolvedValue(updatedUser);\n\n      const result = await service.update(TEST_USER_IDS.CLIENT, updateData);\n\n      expect(mockPrisma.user.update).toHaveBeenCalledWith({\n        where: { id: TEST_USER_IDS.CLIENT },\n        data: updateData,\n      });\n\n      expect(mockEventBus.emit).toHaveBeenCalledWith(\n        expect.any(UserProfileUpdatedEvent),\n      );\n\n      expect(result).toEqual(updatedUser);\n    });\n\n    it('should throw error if user not found during update', async () => {\n      mockPrisma.user.findUnique.mockResolvedValue(null);\n\n      await TestAssertions.expectToThrowNestException(\n        () => service.update(TEST_USER_IDS.CLIENT, { firstName: 'Test' }),\n        InternalServerErrorException,\n        'User not found',\n      );\n    });\n\n    it('should handle update database errors', async () => {\n      const mockUser = TestDataGenerator.createUser();\n      mockPrisma.user.findUnique.mockResolvedValue(mockUser);\n      mockPrisma.user.update.mockRejectedValue(new Error('Update failed'));\n\n      await TestAssertions.expectToThrowNestException(\n        () => service.update(TEST_USER_IDS.CLIENT, { firstName: 'Test' }),\n        InternalServerErrorException,\n        'Failed to update user',\n      );\n    });\n  });\n\n  describe('remove (soft delete)', () => {\n    it('should soft delete user and emit deactivation event', async () => {\n      const mockUser = TestDataGenerator.createUser({ isActive: true });\n      const deactivatedUser = {\n        ...mockUser,\n        isActive: false,\n        suspendedAt: new Date(),\n        suspensionReason: 'Account deactivated by user',\n      };\n\n      mockPrisma.user.update.mockResolvedValue(deactivatedUser);\n\n      const result = await service.remove(TEST_USER_IDS.CLIENT);\n\n      expect(mockPrisma.user.update).toHaveBeenCalledWith({\n        where: { id: TEST_USER_IDS.CLIENT },\n        data: {\n          isActive: false,\n          suspendedAt: expect.any(Date),\n          suspensionReason: 'Account deactivated by user',\n        },\n      });\n\n      expect(mockEventBus.emit).toHaveBeenCalledWith(\n        expect.any(UserDeactivatedEvent),\n      );\n\n      expect(result).toEqual(deactivatedUser);\n    });\n  });\n\n  describe('deactivate', () => {\n    it('should administratively deactivate user', async () => {\n      const mockUser = TestDataGenerator.createUser({ isActive: true });\n      const deactivatedUser = {\n        ...mockUser,\n        isActive: false,\n        suspendedAt: new Date(),\n        suspendedBy: TEST_USER_IDS.ADMIN,\n        suspensionReason: 'Policy violation',\n      };\n\n      mockPrisma.user.update.mockResolvedValue(deactivatedUser);\n\n      const result = await service.deactivate(\n        TEST_USER_IDS.CLIENT,\n        'Policy violation',\n        TEST_USER_IDS.ADMIN,\n      );\n\n      expect(mockPrisma.user.update).toHaveBeenCalledWith({\n        where: { id: TEST_USER_IDS.CLIENT },\n        data: {\n          isActive: false,\n          suspendedAt: expect.any(Date),\n          suspendedBy: TEST_USER_IDS.ADMIN,\n          suspensionReason: 'Policy violation',\n        },\n      });\n\n      expect(mockEventBus.emit).toHaveBeenCalledWith(\n        expect.any(UserDeactivatedEvent),\n      );\n\n      expect(result).toEqual(deactivatedUser);\n    });\n  });\n\n  describe('reactivate', () => {\n    it('should reactivate user and emit reactivation event', async () => {\n      const suspendedDate = new Date(Date.now() - 5 * 24 * 60 * 60 * 1000); // 5 days ago\n      const mockUser = TestDataGenerator.createUser({\n        isActive: false,\n        suspendedAt: suspendedDate,\n      });\n      const reactivatedUser = {\n        ...mockUser,\n        isActive: true,\n        suspendedAt: null,\n        suspendedBy: null,\n        suspensionReason: null,\n      };\n\n      mockPrisma.user.findUnique.mockResolvedValue(mockUser);\n      mockPrisma.user.update.mockResolvedValue(reactivatedUser);\n\n      const result = await service.reactivate(\n        TEST_USER_IDS.CLIENT,\n        TEST_USER_IDS.ADMIN,\n      );\n\n      expect(mockPrisma.user.update).toHaveBeenCalledWith({\n        where: { id: TEST_USER_IDS.CLIENT },\n        data: {\n          isActive: true,\n          suspendedAt: null,\n          suspendedBy: null,\n          suspensionReason: null,\n        },\n      });\n\n      expect(mockEventBus.emit).toHaveBeenCalledWith(\n        expect.any(UserReactivatedEvent),\n      );\n\n      expect(result).toEqual(reactivatedUser);\n    });\n\n    it('should throw error if user not found during reactivation', async () => {\n      mockPrisma.user.findUnique.mockResolvedValue(null);\n\n      await TestAssertions.expectToThrowNestException(\n        () => service.reactivate(TEST_USER_IDS.CLIENT),\n        InternalServerErrorException,\n        'User not found',\n      );\n    });\n  });\n\n  describe('getUserRole', () => {\n    it('should return user role', async () => {\n      const mockUser = { role: 'client' };\n      mockPrisma.user.findUnique.mockResolvedValue(mockUser);\n\n      const result = await service.getUserRole(TEST_USER_IDS.CLIENT);\n\n      expect(mockPrisma.user.findUnique).toHaveBeenCalledWith({\n        where: { id: TEST_USER_IDS.CLIENT },\n        select: { role: true },\n      });\n      expect(result).toBe('client');\n    });\n\n    it('should return null if user not found', async () => {\n      mockPrisma.user.findUnique.mockResolvedValue(null);\n\n      const result = await service.getUserRole('non-existent-id');\n\n      expect(result).toBeNull();\n    });\n  });\n\n  describe('create', () => {\n    it('should create user and emit registration event', async () => {\n      const userData = TestDataGenerator.createUser();\n      mockPrisma.user.create.mockResolvedValue(userData);\n\n      const result = await service.create(userData);\n\n      expect(mockPrisma.user.create).toHaveBeenCalledWith({\n        data: userData,\n      });\n\n      expect(mockEventBus.emit).toHaveBeenCalledWith(\n        expect.any(UserRegisteredEvent),\n      );\n\n      expect(result).toEqual(userData);\n    });\n\n    it('should handle create database errors', async () => {\n      const userData = TestDataGenerator.createUser();\n      mockPrisma.user.create.mockRejectedValue(new Error('Creation failed'));\n\n      await TestAssertions.expectToThrowNestException(\n        () => service.create(userData),\n        InternalServerErrorException,\n        'Failed to create user',\n      );\n    });\n  });\n\n  describe('permanentDelete', () => {\n    it('should permanently delete user', async () => {\n      const mockUser = TestDataGenerator.createUser();\n      mockPrisma.user.delete.mockResolvedValue(mockUser);\n\n      const result = await service.permanentDelete(TEST_USER_IDS.CLIENT);\n\n      expect(mockPrisma.user.delete).toHaveBeenCalledWith({\n        where: { id: TEST_USER_IDS.CLIENT },\n      });\n      expect(result).toEqual(mockUser);\n    });\n  });\n});\n"],"version":3}