ce44f7cc1b26cf76b955c39706ff06dc
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const common_1 = require("@nestjs/common");
const users_controller_1 = require("./users.controller");
const users_service_1 = require("./users.service");
const jwt_auth_guard_1 = require("../auth/guards/jwt-auth.guard");
const admin_auth_guard_1 = require("../auth/guards/admin-auth.guard");
const supabase_storage_service_1 = require("../common/services/supabase-storage.service");
const role_utils_1 = require("../utils/role-utils");
const zod_validation_pipe_1 = require("../common/pipes/zod-validation.pipe");
const auth_testing_helpers_1 = require("../test-utils/auth-testing-helpers");
const enhanced_test_helpers_1 = require("../test-utils/enhanced-test-helpers");
const index_1 = require("../test-utils/index");
describe('UsersController', () => {
    let controller;
    let usersService;
    let supabaseStorageService;
    let roleUtils;
    let mockJwtAuthGuard;
    let mockAdminAuthGuard;
    // Test data constants
    const mockUser = {
        id: index_1.TEST_USER_IDS.CLIENT,
        email: index_1.TEST_EMAILS.CLIENT,
        firstName: 'John',
        lastName: 'Doe',
        role: 'client',
        bio: 'User bio',
        avatarUrl: 'https://example.com/avatar.jpg',
        coverImageUrl: 'https://example.com/cover.jpg',
        phoneNumber: '+1234567890',
        timezone: 'America/New_York',
        language: 'en',
        theme: 'light',
        createdAt: new Date(),
        updatedAt: new Date(),
        emailVerified: true,
        profileComplete: true,
        isActive: true,
    };
    const mockAdminUser = {
        id: index_1.TEST_USER_IDS.ADMIN,
        email: index_1.TEST_EMAILS.ADMIN,
        firstName: 'Admin',
        lastName: 'User',
        role: 'admin',
        createdAt: new Date(),
        updatedAt: new Date(),
        emailVerified: true,
        profileComplete: true,
        isActive: true,
    };
    const mockUsers = [mockUser, mockAdminUser];
    const mockFile = {
        fieldname: 'avatar',
        originalname: 'avatar.jpg',
        encoding: '7bit',
        mimetype: 'image/jpeg',
        size: 1024,
        buffer: Buffer.from('test file content'),
    };
    const mockUploadResult = {
        url: 'https://example.com/uploaded-avatar.jpg',
        filename: 'avatar.jpg',
        size: 1024,
    };
    beforeEach(async () => {
        // Create mock services
        const mockUsersService = {
            findAll: jest.fn(),
            findAllIncludeInactive: jest.fn(),
            findOne: jest.fn(),
            findOneIncludeInactive: jest.fn(),
            update: jest.fn(),
            remove: jest.fn(),
            deactivate: jest.fn(),
            reactivate: jest.fn(),
        };
        const mockSupabaseStorageService = {
            validateFile: jest.fn(),
            uploadFile: jest.fn(),
            getSupportedBuckets: jest.fn(),
        };
        const mockRoleUtils = {
            isUserAdmin: jest.fn(),
        };
        mockJwtAuthGuard = {
            canActivate: jest.fn().mockReturnValue(true),
        };
        mockAdminAuthGuard = {
            canActivate: jest.fn().mockReturnValue(true),
        };
        // Add static method mock
        supabase_storage_service_1.SupabaseStorageService.getSupportedBuckets = jest.fn().mockReturnValue({
            USER_PROFILES: 'user-profiles',
        });
        const module = await testing_1.Test.createTestingModule({
            controllers: [users_controller_1.UsersController],
            providers: [
                {
                    provide: users_service_1.UsersService,
                    useValue: mockUsersService,
                },
                {
                    provide: supabase_storage_service_1.SupabaseStorageService,
                    useValue: mockSupabaseStorageService,
                },
                {
                    provide: role_utils_1.RoleUtils,
                    useValue: mockRoleUtils,
                },
                {
                    provide: common_1.Logger,
                    useValue: {
                        log: jest.fn(),
                        error: jest.fn(),
                        warn: jest.fn(),
                        debug: jest.fn(),
                    },
                },
            ],
        })
            .overrideGuard(jwt_auth_guard_1.JwtAuthGuard)
            .useValue(mockJwtAuthGuard)
            .overrideGuard(admin_auth_guard_1.AdminAuthGuard)
            .useValue(mockAdminAuthGuard)
            .compile();
        controller = module.get(users_controller_1.UsersController);
        usersService = module.get(users_service_1.UsersService);
        supabaseStorageService = module.get(supabase_storage_service_1.SupabaseStorageService);
        roleUtils = module.get(role_utils_1.RoleUtils);
    });
    afterEach(() => {
        jest.clearAllMocks();
    });
    describe('findAll', () => {
        it('should return all users for admin', async () => {
            // Arrange
            jest.spyOn(usersService, 'findAll').mockResolvedValue(mockUsers);
            // Act
            const result = await controller.findAll(index_1.TEST_USER_IDS.ADMIN);
            // Assert
            expect(usersService.findAll).toHaveBeenCalled();
            expect(result).toEqual(mockUsers);
        });
        it('should handle service errors', async () => {
            // Arrange
            const error = new Error('Database error');
            jest.spyOn(usersService, 'findAll').mockRejectedValue(error);
            // Act & Assert
            await expect(controller.findAll(index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('findAllIncludeInactive', () => {
        it('should return all users including inactive for admin', async () => {
            const mockUsers = [
                enhanced_test_helpers_1.TestDataGenerator.createUser({ isActive: true }),
                enhanced_test_helpers_1.TestDataGenerator.createUser({ isActive: false }),
            ];
            usersService.findAllIncludeInactive.mockResolvedValue(mockUsers);
            const result = await controller.findAllIncludeInactive(index_1.TEST_USER_IDS.ADMIN);
            expect(usersService.findAllIncludeInactive).toHaveBeenCalled();
            expect(result).toEqual(mockUsers);
        });
        it('should handle service errors when fetching all users', async () => {
            usersService.findAllIncludeInactive.mockRejectedValue(new Error('Database connection failed'));
            await expect(controller.findAllIncludeInactive(index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('findOne', () => {
        const mockUser = enhanced_test_helpers_1.TestDataGenerator.createUser({ id: index_1.TEST_USER_IDS.CLIENT });
        it('should allow user to view their own profile', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.findOne.mockResolvedValue(mockUser);
            const result = await controller.findOne(index_1.TEST_USER_IDS.CLIENT, index_1.TEST_USER_IDS.CLIENT);
            expect(roleUtils.isUserAdmin).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT);
            expect(usersService.findOne).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT);
            expect(result).toEqual(mockUser);
        });
        it('should allow admin to view any user profile', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(true);
            usersService.findOneIncludeInactive.mockResolvedValue(mockUser);
            const result = await controller.findOne(index_1.TEST_USER_IDS.CLIENT, index_1.TEST_USER_IDS.ADMIN);
            expect(roleUtils.isUserAdmin).toHaveBeenCalledWith(index_1.TEST_USER_IDS.ADMIN);
            expect(usersService.findOneIncludeInactive).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT);
            expect(result).toEqual(mockUser);
        });
        it('should throw ForbiddenException when non-admin tries to view other user', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(false);
            await expect(controller.findOne(index_1.TEST_USER_IDS.THERAPIST, index_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.ForbiddenException);
            expect(usersService.findOne).not.toHaveBeenCalled();
        });
        it('should throw HttpException when user not found', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.findOne.mockResolvedValue(null);
            await expect(controller.findOne(index_1.TEST_USER_IDS.CLIENT, index_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('update', () => {
        const updateData = {
            firstName: 'Updated',
            lastName: 'Name',
            bio: 'Updated bio',
        };
        it('should allow user to update their own profile', async () => {
            const updatedUser = { ...enhanced_test_helpers_1.TestDataGenerator.createUser(), ...updateData };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.update.mockResolvedValue(updatedUser);
            const result = await controller.update(index_1.TEST_USER_IDS.CLIENT, updateData, index_1.TEST_USER_IDS.CLIENT);
            expect(roleUtils.isUserAdmin).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT);
            expect(usersService.update).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, updateData);
            expect(result).toEqual(updatedUser);
        });
        it('should allow admin to update any user with all fields', async () => {
            const adminUpdateData = {
                firstName: 'Admin Updated',
                role: 'moderator',
                isActive: false,
            };
            const updatedUser = {
                ...enhanced_test_helpers_1.TestDataGenerator.createUser(),
                ...adminUpdateData,
            };
            roleUtils.isUserAdmin.mockResolvedValue(true);
            usersService.update.mockResolvedValue(updatedUser);
            const result = await controller.update(index_1.TEST_USER_IDS.CLIENT, adminUpdateData, index_1.TEST_USER_IDS.ADMIN);
            expect(usersService.update).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, adminUpdateData);
            expect(result).toEqual(updatedUser);
        });
        it('should sanitize non-admin updates to allowed fields only', async () => {
            const unauthorizedData = {
                firstName: 'John',
                role: 'admin', // Should be filtered out
                isActive: false, // Should be filtered out
                bio: 'New bio',
            };
            const sanitizedData = {
                firstName: 'John',
                bio: 'New bio',
            };
            const updatedUser = {
                ...enhanced_test_helpers_1.TestDataGenerator.createUser(),
                ...sanitizedData,
            };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.update.mockResolvedValue(updatedUser);
            const result = await controller.update(index_1.TEST_USER_IDS.CLIENT, unauthorizedData, index_1.TEST_USER_IDS.CLIENT);
            expect(usersService.update).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, sanitizedData);
            expect(result).toEqual(updatedUser);
        });
        it('should throw ForbiddenException when non-admin tries to update other user', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(false);
            await expect(controller.update(index_1.TEST_USER_IDS.THERAPIST, updateData, index_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.ForbiddenException);
            expect(usersService.update).not.toHaveBeenCalled();
        });
    });
    describe('remove', () => {
        it('should allow user to deactivate their own account', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.remove.mockResolvedValue({});
            const result = await controller.remove(index_1.TEST_USER_IDS.CLIENT, index_1.TEST_USER_IDS.CLIENT);
            expect(roleUtils.isUserAdmin).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT);
            expect(usersService.remove).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT);
            expect(result).toEqual({
                message: 'User account deactivated successfully',
            });
        });
        it('should allow admin to deactivate any user account', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(true);
            usersService.remove.mockResolvedValue({});
            const result = await controller.remove(index_1.TEST_USER_IDS.CLIENT, index_1.TEST_USER_IDS.ADMIN);
            expect(usersService.remove).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT);
            expect(result).toEqual({
                message: 'User account deactivated successfully',
            });
        });
        it('should throw ForbiddenException when non-admin tries to deactivate other user', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(false);
            await expect(controller.remove(index_1.TEST_USER_IDS.THERAPIST, index_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.ForbiddenException);
            expect(usersService.remove).not.toHaveBeenCalled();
        });
    });
    describe('deactivateUser (admin only)', () => {
        it('should allow admin to deactivate user with reason', async () => {
            const deactivationBody = { reason: 'Policy violation' };
            usersService.deactivate.mockResolvedValue({});
            const result = await controller.deactivateUser(index_1.TEST_USER_IDS.CLIENT, deactivationBody, index_1.TEST_USER_IDS.ADMIN);
            expect(usersService.deactivate).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, 'Policy violation', index_1.TEST_USER_IDS.ADMIN);
            expect(result).toEqual({
                message: 'User account deactivated by administrator',
            });
        });
        it('should handle deactivation without reason', async () => {
            const deactivationBody = {};
            usersService.deactivate.mockResolvedValue({});
            const result = await controller.deactivateUser(index_1.TEST_USER_IDS.CLIENT, deactivationBody, index_1.TEST_USER_IDS.ADMIN);
            expect(usersService.deactivate).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, undefined, index_1.TEST_USER_IDS.ADMIN);
            expect(result).toEqual({
                message: 'User account deactivated by administrator',
            });
        });
        it('should handle service errors during deactivation', async () => {
            const deactivationBody = { reason: 'Test reason' };
            usersService.deactivate.mockRejectedValue(new Error('Service error'));
            await expect(controller.deactivateUser(index_1.TEST_USER_IDS.CLIENT, deactivationBody, index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('reactivateUser (admin only)', () => {
        it('should allow admin to reactivate user', async () => {
            usersService.reactivate.mockResolvedValue({});
            const result = await controller.reactivateUser(index_1.TEST_USER_IDS.CLIENT, index_1.TEST_USER_IDS.ADMIN);
            expect(usersService.reactivate).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT);
            expect(result).toEqual({
                message: 'User account reactivated successfully',
            });
        });
        it('should handle service errors during reactivation', async () => {
            usersService.reactivate.mockRejectedValue(new Error('Reactivation failed'));
            await expect(controller.reactivateUser(index_1.TEST_USER_IDS.CLIENT, index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('error handling', () => {
        it('should preserve ForbiddenException from service layer', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(true);
            usersService.findOneIncludeInactive.mockRejectedValue(new common_1.ForbiddenException('Access denied'));
            await expect(controller.findOne(index_1.TEST_USER_IDS.CLIENT, index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(common_1.ForbiddenException);
        });
        it('should wrap generic errors in HttpException', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.findOne.mockRejectedValue(new Error('Generic error'));
            await expect(controller.findOne(index_1.TEST_USER_IDS.CLIENT, index_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.HttpException);
        });
        it('should handle role utils errors gracefully', async () => {
            roleUtils.isUserAdmin.mockRejectedValue(new Error('Role check failed'));
            await expect(controller.findOne(index_1.TEST_USER_IDS.CLIENT, index_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('authorization edge cases', () => {
        it('should handle empty update data for non-admin', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.update.mockResolvedValue(enhanced_test_helpers_1.TestDataGenerator.createUser());
            await controller.update(index_1.TEST_USER_IDS.CLIENT, {}, index_1.TEST_USER_IDS.CLIENT);
            expect(usersService.update).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, {});
        });
        it('should handle mixed allowed and disallowed fields for non-admin', async () => {
            const mixedData = {
                firstName: 'John', // Allowed
                lastName: 'Doe', // Allowed
                role: 'admin', // Not allowed
                bio: 'New bio', // Allowed
                isActive: false, // Not allowed
                avatarUrl: 'http://example.com/avatar.jpg', // Allowed
            };
            const expectedSanitizedData = {
                firstName: 'John',
                lastName: 'Doe',
                bio: 'New bio',
                avatarUrl: 'http://example.com/avatar.jpg',
            };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.update.mockResolvedValue(enhanced_test_helpers_1.TestDataGenerator.createUser());
            await controller.update(index_1.TEST_USER_IDS.CLIENT, mixedData, index_1.TEST_USER_IDS.CLIENT);
            expect(usersService.update).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, expectedSanitizedData);
        });
    });
    describe('File Upload Integration', () => {
        it('should handle avatar upload successfully', async () => {
            // Arrange
            const mockFiles = {
                avatar: [mockFile],
            };
            const updateData = {
                firstName: 'John',
                lastName: 'Doe',
            };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            supabaseStorageService.validateFile.mockReturnValue({ isValid: true });
            supabaseStorageService.uploadFile.mockResolvedValue(mockUploadResult);
            usersService.update.mockResolvedValue(enhanced_test_helpers_1.TestDataGenerator.createUser());
            // Act
            await controller.update(index_1.TEST_USER_IDS.CLIENT, updateData, index_1.TEST_USER_IDS.CLIENT, mockFiles);
            // Assert
            expect(supabaseStorageService.validateFile).toHaveBeenCalledWith(mockFile);
            expect(supabaseStorageService.uploadFile).toHaveBeenCalledWith(mockFile, 'user-profiles');
            expect(usersService.update).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, {
                ...updateData,
                avatarUrl: mockUploadResult.url,
            });
        });
        it('should handle cover image upload successfully', async () => {
            // Arrange
            const mockCoverFile = {
                ...mockFile,
                fieldname: 'cover',
                originalname: 'cover.jpg',
            };
            const mockFiles = {
                cover: [mockCoverFile],
            };
            const updateData = {
                firstName: 'John',
                lastName: 'Doe',
            };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            supabaseStorageService.validateFile.mockReturnValue({ isValid: true });
            supabaseStorageService.uploadFile.mockResolvedValue(mockUploadResult);
            usersService.update.mockResolvedValue(enhanced_test_helpers_1.TestDataGenerator.createUser());
            // Act
            await controller.update(index_1.TEST_USER_IDS.CLIENT, updateData, index_1.TEST_USER_IDS.CLIENT, mockFiles);
            // Assert
            expect(supabaseStorageService.validateFile).toHaveBeenCalledWith(mockCoverFile);
            expect(supabaseStorageService.uploadFile).toHaveBeenCalledWith(mockCoverFile, 'user-profiles');
            expect(usersService.update).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, {
                ...updateData,
                coverImageUrl: mockUploadResult.url,
            });
        });
        it('should handle multiple file uploads simultaneously', async () => {
            // Arrange
            const mockCoverFile = {
                ...mockFile,
                fieldname: 'cover',
                originalname: 'cover.jpg',
            };
            const mockFiles = {
                avatar: [mockFile],
                cover: [mockCoverFile],
            };
            const updateData = {
                firstName: 'John',
                lastName: 'Doe',
            };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            supabaseStorageService.validateFile.mockReturnValue({ isValid: true });
            supabaseStorageService.uploadFile.mockResolvedValue(mockUploadResult);
            usersService.update.mockResolvedValue(enhanced_test_helpers_1.TestDataGenerator.createUser());
            // Act
            await controller.update(index_1.TEST_USER_IDS.CLIENT, updateData, index_1.TEST_USER_IDS.CLIENT, mockFiles);
            // Assert
            expect(supabaseStorageService.validateFile).toHaveBeenCalledTimes(2);
            expect(supabaseStorageService.uploadFile).toHaveBeenCalledTimes(2);
            expect(usersService.update).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, {
                ...updateData,
                avatarUrl: mockUploadResult.url,
                coverImageUrl: mockUploadResult.url,
            });
        });
        it('should handle file validation errors', async () => {
            // Arrange
            const mockFiles = {
                avatar: [mockFile],
            };
            const updateData = {
                firstName: 'John',
                lastName: 'Doe',
            };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            supabaseStorageService.validateFile.mockReturnValue({
                isValid: false,
                error: 'File too large',
            });
            // Act & Assert
            await expect(controller.update(index_1.TEST_USER_IDS.CLIENT, updateData, index_1.TEST_USER_IDS.CLIENT, mockFiles)).rejects.toThrow('Avatar validation failed: File too large');
        });
        it('should handle file upload errors', async () => {
            // Arrange
            const mockFiles = {
                avatar: [mockFile],
            };
            const updateData = {
                firstName: 'John',
                lastName: 'Doe',
            };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            supabaseStorageService.validateFile.mockReturnValue({ isValid: true });
            supabaseStorageService.uploadFile.mockRejectedValue(new Error('Upload failed'));
            // Act & Assert
            await expect(controller.update(index_1.TEST_USER_IDS.CLIENT, updateData, index_1.TEST_USER_IDS.CLIENT, mockFiles)).rejects.toThrow('Failed to update user: Upload failed');
        });
    });
    describe('Security Tests', () => {
        it('should validate input data through ZodValidationPipe', () => {
            // This tests that the controller uses proper validation
            const validationPipe = new zod_validation_pipe_1.ZodValidationPipe({});
            expect(validationPipe).toBeDefined();
        });
        it('should require authentication for all endpoints', () => {
            // Test that all endpoints have JwtAuthGuard
            const protectedMethods = ['findAll', 'findAllIncludeInactive', 'findOne', 'update', 'remove', 'deactivateUser', 'reactivateUser'];
            protectedMethods.forEach(method => {
                const guards = Reflect.getMetadata('__guards__', controller[method]);
                expect(guards).toBeDefined();
            });
        });
        it('should enforce admin-only access for admin endpoints', () => {
            // Test that admin endpoints have AdminAuthGuard
            const adminMethods = ['findAll', 'findAllIncludeInactive', 'deactivateUser', 'reactivateUser'];
            adminMethods.forEach(method => {
                const guards = Reflect.getMetadata('__guards__', controller[method]);
                expect(guards).toBeDefined();
            });
        });
        it('should handle JWT token validation', async () => {
            // Test that JWT guard is properly applied
            mockJwtAuthGuard.canActivate.mockReturnValue(false);
            // Mock the actual HTTP exception that would be thrown
            const unauthorizedError = new Error('Unauthorized');
            usersService.findAll.mockRejectedValue(unauthorizedError);
            await expect(controller.findAll(index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow();
        });
        it('should handle admin authorization validation', async () => {
            // Test that admin guard is properly applied
            mockAdminAuthGuard.canActivate.mockReturnValue(false);
            // Mock the actual HTTP exception that would be thrown
            const forbiddenError = new Error('Forbidden');
            usersService.findAll.mockRejectedValue(forbiddenError);
            await expect(controller.findAll(index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow();
        });
        it('should prevent unauthorized access to other user profiles', async () => {
            // Test that users can only access their own profile
            roleUtils.isUserAdmin.mockResolvedValue(false);
            await expect(controller.findOne(index_1.TEST_USER_IDS.THERAPIST, index_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.ForbiddenException);
        });
    });
    describe('Role-based Access Control', () => {
        it('should test role-based access for admin endpoints', async () => {
            // Test that admin endpoints require admin role
            await auth_testing_helpers_1.RoleBasedTestUtils.testWithRoles(async (userId, role) => {
                try {
                    await controller.findAll(userId);
                    return true;
                }
                catch (error) {
                    return false;
                }
            }, {
                client: false,
                therapist: false,
                admin: true,
                moderator: false,
            });
        });
        it('should validate user-specific functionality', async () => {
            // Test that users can access their own profile
            const userContext = enhanced_test_helpers_1.MockBuilder.createAuthContext('client');
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.findOne.mockResolvedValue(mockUser);
            const result = await controller.findOne(userContext.userId, userContext.userId);
            expect(result).toBeDefined();
            expect(result.id).toBe(userContext.userId);
        });
        it('should test field sanitization for non-admin users', async () => {
            // Test that non-admin users cannot update sensitive fields
            const sensitiveData = {
                firstName: 'John',
                role: 'admin', // Should be filtered out
                isActive: false, // Should be filtered out
                emailVerified: true, // Should be filtered out
            };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.update.mockResolvedValue(mockUser);
            await controller.update(index_1.TEST_USER_IDS.CLIENT, sensitiveData, index_1.TEST_USER_IDS.CLIENT);
            expect(usersService.update).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, { firstName: 'John' });
        });
    });
    describe('Integration Tests', () => {
        it('should handle complete user profile update workflow', async () => {
            // Arrange
            const updateData = {
                firstName: 'Updated',
                lastName: 'Name',
                bio: 'Updated bio',
                timezone: 'America/Los_Angeles',
                language: 'en',
                theme: 'dark',
            };
            const updatedUser = { ...mockUser, ...updateData };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.update.mockResolvedValue(updatedUser);
            // Act
            const result = await controller.update(index_1.TEST_USER_IDS.CLIENT, updateData, index_1.TEST_USER_IDS.CLIENT);
            // Assert
            expect(result).toBeDefined();
            expect(result.firstName).toBe('Updated');
            expect(result.lastName).toBe('Name');
            expect(result.bio).toBe('Updated bio');
            expect(result.timezone).toBe('America/Los_Angeles');
        });
        it('should handle complete admin user management workflow', async () => {
            // Arrange
            roleUtils.isUserAdmin.mockResolvedValue(true);
            usersService.findAll.mockResolvedValue(mockUsers);
            usersService.findAllIncludeInactive.mockResolvedValue(mockUsers);
            usersService.findOneIncludeInactive.mockResolvedValue(mockUser);
            // Act - Get all users
            const allUsers = await controller.findAll(index_1.TEST_USER_IDS.ADMIN);
            // Act - Get all users including inactive
            const allUsersIncludeInactive = await controller.findAllIncludeInactive(index_1.TEST_USER_IDS.ADMIN);
            // Act - View specific user
            const specificUser = await controller.findOne(index_1.TEST_USER_IDS.CLIENT, index_1.TEST_USER_IDS.ADMIN);
            // Assert
            expect(allUsers).toBeDefined();
            expect(allUsers).toHaveLength(2);
            expect(allUsersIncludeInactive).toBeDefined();
            expect(allUsersIncludeInactive).toHaveLength(2);
            expect(specificUser).toBeDefined();
            expect(specificUser.id).toBe(index_1.TEST_USER_IDS.CLIENT);
        });
        it('should handle complete user deactivation workflow', async () => {
            // Arrange
            roleUtils.isUserAdmin.mockResolvedValue(true);
            usersService.deactivate.mockResolvedValue({});
            // Act
            const result = await controller.deactivateUser(index_1.TEST_USER_IDS.CLIENT, { reason: 'Policy violation' }, index_1.TEST_USER_IDS.ADMIN);
            // Assert
            expect(result).toBeDefined();
            expect(result.message).toBe('User account deactivated by administrator');
            expect(usersService.deactivate).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, 'Policy violation', index_1.TEST_USER_IDS.ADMIN);
        });
        it('should handle complete user reactivation workflow', async () => {
            // Arrange
            roleUtils.isUserAdmin.mockResolvedValue(true);
            usersService.reactivate.mockResolvedValue({});
            // Act
            const result = await controller.reactivateUser(index_1.TEST_USER_IDS.CLIENT, index_1.TEST_USER_IDS.ADMIN);
            // Assert
            expect(result).toBeDefined();
            expect(result.message).toBe('User account reactivated successfully');
            expect(usersService.reactivate).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT);
        });
    });
    describe('Data Validation', () => {
        it('should validate user update data structure', () => {
            // Test that we're using the correct DTO structure
            const validUpdateData = {
                firstName: 'John',
                lastName: 'Doe',
                bio: 'User bio',
                avatarUrl: 'https://example.com/avatar.jpg',
                coverImageUrl: 'https://example.com/cover.jpg',
                phoneNumber: '+1234567890',
                timezone: 'America/New_York',
                language: 'en',
                theme: 'light',
            };
            // Verify all fields are defined
            expect(validUpdateData.firstName).toBeDefined();
            expect(validUpdateData.lastName).toBeDefined();
            expect(validUpdateData.bio).toBeDefined();
            expect(validUpdateData.avatarUrl).toBeDefined();
            expect(validUpdateData.coverImageUrl).toBeDefined();
            expect(validUpdateData.phoneNumber).toBeDefined();
            expect(validUpdateData.timezone).toBeDefined();
            expect(validUpdateData.language).toBeDefined();
            expect(validUpdateData.theme).toBeDefined();
        });
        it('should validate deactivation data structure', () => {
            // Test that we're using the correct DTO structure
            const validDeactivationData = {
                reason: 'Policy violation',
            };
            // Verify all fields are defined
            expect(validDeactivationData.reason).toBeDefined();
        });
        it('should validate user ID parameter structure', () => {
            // Test that we're using the correct parameter structure
            const validUserIdParam = {
                id: index_1.TEST_USER_IDS.CLIENT,
            };
            // Verify all fields are defined
            expect(validUserIdParam.id).toBeDefined();
        });
    });
    describe('Response Format Validation', () => {
        it('should return correctly formatted user list response', async () => {
            // Arrange
            roleUtils.isUserAdmin.mockResolvedValue(true);
            usersService.findAll.mockResolvedValue(mockUsers);
            // Act
            const result = await controller.findAll(index_1.TEST_USER_IDS.ADMIN);
            // Assert
            expect(result).toBeInstanceOf(Array);
            expect(result).toHaveLength(2);
            const user = result[0];
            expect(user).toHaveProperty('id');
            expect(user).toHaveProperty('email');
            expect(user).toHaveProperty('firstName');
            expect(user).toHaveProperty('lastName');
            expect(user).toHaveProperty('role');
            expect(user).toHaveProperty('createdAt');
            expect(user).toHaveProperty('isActive');
        });
        it('should return correctly formatted user profile response', async () => {
            // Arrange
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.findOne.mockResolvedValue(mockUser);
            // Act
            const result = await controller.findOne(index_1.TEST_USER_IDS.CLIENT, index_1.TEST_USER_IDS.CLIENT);
            // Assert
            expect(result).toHaveProperty('id');
            expect(result).toHaveProperty('email');
            expect(result).toHaveProperty('firstName');
            expect(result).toHaveProperty('lastName');
            expect(result).toHaveProperty('role');
            expect(result).toHaveProperty('bio');
            expect(result).toHaveProperty('avatarUrl');
            expect(result).toHaveProperty('coverImageUrl');
            expect(result).toHaveProperty('phoneNumber');
            expect(result).toHaveProperty('timezone');
            expect(result).toHaveProperty('language');
            expect(result).toHaveProperty('theme');
            expect(result).toHaveProperty('createdAt');
            expect(result).toHaveProperty('updatedAt');
        });
        it('should return correctly formatted update response', async () => {
            // Arrange
            const updateData = {
                firstName: 'Updated',
                lastName: 'Name',
            };
            const updatedUser = { ...mockUser, ...updateData };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.update.mockResolvedValue(updatedUser);
            // Act
            const result = await controller.update(index_1.TEST_USER_IDS.CLIENT, updateData, index_1.TEST_USER_IDS.CLIENT);
            // Assert
            expect(result).toHaveProperty('id');
            expect(result).toHaveProperty('email');
            expect(result).toHaveProperty('firstName');
            expect(result).toHaveProperty('lastName');
            expect(result.firstName).toBe('Updated');
            expect(result.lastName).toBe('Name');
        });
        it('should return correctly formatted deactivation response', async () => {
            // Arrange
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.remove.mockResolvedValue({});
            // Act
            const result = await controller.remove(index_1.TEST_USER_IDS.CLIENT, index_1.TEST_USER_IDS.CLIENT);
            // Assert
            expect(result).toHaveProperty('message');
            expect(result.message).toBe('User account deactivated successfully');
        });
        it('should return correctly formatted admin deactivation response', async () => {
            // Arrange
            usersService.deactivate.mockResolvedValue({});
            // Act
            const result = await controller.deactivateUser(index_1.TEST_USER_IDS.CLIENT, { reason: 'Policy violation' }, index_1.TEST_USER_IDS.ADMIN);
            // Assert
            expect(result).toHaveProperty('message');
            expect(result.message).toBe('User account deactivated by administrator');
        });
        it('should return correctly formatted reactivation response', async () => {
            // Arrange
            usersService.reactivate.mockResolvedValue({});
            // Act
            const result = await controller.reactivateUser(index_1.TEST_USER_IDS.CLIENT, index_1.TEST_USER_IDS.ADMIN);
            // Assert
            expect(result).toHaveProperty('message');
            expect(result.message).toBe('User account reactivated successfully');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL3VzZXJzL3VzZXJzLmNvbnRyb2xsZXIuc3BlYy50cyIsIm1hcHBpbmdzIjoiOztBQUFBLDZDQUFzRDtBQUN0RCwyQ0FLd0I7QUFDeEIseURBQXFEO0FBQ3JELG1EQUErQztBQUMvQyxrRUFBNkQ7QUFDN0Qsc0VBQWlFO0FBQ2pFLDBGQUFxRjtBQUNyRixvREFBZ0Q7QUFDaEQsNkVBQXdFO0FBQ3hFLDZFQUc0QztBQUM1QywrRUFJNkM7QUFDN0MsK0NBQWlFO0FBRWpFLFFBQVEsQ0FBQyxpQkFBaUIsRUFBRSxHQUFHLEVBQUU7SUFDL0IsSUFBSSxVQUEyQixDQUFDO0lBQ2hDLElBQUksWUFBMEIsQ0FBQztJQUMvQixJQUFJLHNCQUE4QyxDQUFDO0lBQ25ELElBQUksU0FBb0IsQ0FBQztJQUN6QixJQUFJLGdCQUEyQyxDQUFDO0lBQ2hELElBQUksa0JBQStDLENBQUM7SUFFcEQsc0JBQXNCO0lBQ3RCLE1BQU0sUUFBUSxHQUFHO1FBQ2YsRUFBRSxFQUFFLHFCQUFhLENBQUMsTUFBTTtRQUN4QixLQUFLLEVBQUUsbUJBQVcsQ0FBQyxNQUFNO1FBQ3pCLFNBQVMsRUFBRSxNQUFNO1FBQ2pCLFFBQVEsRUFBRSxLQUFLO1FBQ2YsSUFBSSxFQUFFLFFBQVE7UUFDZCxHQUFHLEVBQUUsVUFBVTtRQUNmLFNBQVMsRUFBRSxnQ0FBZ0M7UUFDM0MsYUFBYSxFQUFFLCtCQUErQjtRQUM5QyxXQUFXLEVBQUUsYUFBYTtRQUMxQixRQUFRLEVBQUUsa0JBQWtCO1FBQzVCLFFBQVEsRUFBRSxJQUFJO1FBQ2QsS0FBSyxFQUFFLE9BQU87UUFDZCxTQUFTLEVBQUUsSUFBSSxJQUFJLEVBQUU7UUFDckIsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFO1FBQ3JCLGFBQWEsRUFBRSxJQUFJO1FBQ25CLGVBQWUsRUFBRSxJQUFJO1FBQ3JCLFFBQVEsRUFBRSxJQUFJO0tBQ2YsQ0FBQztJQUVGLE1BQU0sYUFBYSxHQUFHO1FBQ3BCLEVBQUUsRUFBRSxxQkFBYSxDQUFDLEtBQUs7UUFDdkIsS0FBSyxFQUFFLG1CQUFXLENBQUMsS0FBSztRQUN4QixTQUFTLEVBQUUsT0FBTztRQUNsQixRQUFRLEVBQUUsTUFBTTtRQUNoQixJQUFJLEVBQUUsT0FBTztRQUNiLFNBQVMsRUFBRSxJQUFJLElBQUksRUFBRTtRQUNyQixTQUFTLEVBQUUsSUFBSSxJQUFJLEVBQUU7UUFDckIsYUFBYSxFQUFFLElBQUk7UUFDbkIsZUFBZSxFQUFFLElBQUk7UUFDckIsUUFBUSxFQUFFLElBQUk7S0FDZixDQUFDO0lBRUYsTUFBTSxTQUFTLEdBQUcsQ0FBQyxRQUFRLEVBQUUsYUFBYSxDQUFDLENBQUM7SUFFNUMsTUFBTSxRQUFRLEdBQUc7UUFDZixTQUFTLEVBQUUsUUFBUTtRQUNuQixZQUFZLEVBQUUsWUFBWTtRQUMxQixRQUFRLEVBQUUsTUFBTTtRQUNoQixRQUFRLEVBQUUsWUFBWTtRQUN0QixJQUFJLEVBQUUsSUFBSTtRQUNWLE1BQU0sRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLG1CQUFtQixDQUFDO0tBQ2xCLENBQUM7SUFFekIsTUFBTSxnQkFBZ0IsR0FBRztRQUN2QixHQUFHLEVBQUUseUNBQXlDO1FBQzlDLFFBQVEsRUFBRSxZQUFZO1FBQ3RCLElBQUksRUFBRSxJQUFJO0tBQ1gsQ0FBQztJQUVGLFVBQVUsQ0FBQyxLQUFLLElBQUksRUFBRTtRQUNwQix1QkFBdUI7UUFDdkIsTUFBTSxnQkFBZ0IsR0FBRztZQUN2QixPQUFPLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUNsQixzQkFBc0IsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1lBQ2pDLE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1lBQ2xCLHNCQUFzQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7WUFDakMsTUFBTSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7WUFDakIsTUFBTSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7WUFDakIsVUFBVSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7WUFDckIsVUFBVSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7U0FDdEIsQ0FBQztRQUVGLE1BQU0sMEJBQTBCLEdBQUc7WUFDakMsWUFBWSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7WUFDdkIsVUFBVSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7WUFDckIsbUJBQW1CLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtTQUMvQixDQUFDO1FBRUYsTUFBTSxhQUFhLEdBQUc7WUFDcEIsV0FBVyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7U0FDdkIsQ0FBQztRQUVGLGdCQUFnQixHQUFHO1lBQ2pCLFdBQVcsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQztTQUN0QyxDQUFDO1FBRVQsa0JBQWtCLEdBQUc7WUFDbkIsV0FBVyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDO1NBQ3RDLENBQUM7UUFFVCx5QkFBeUI7UUFDekIsaURBQXNCLENBQUMsbUJBQW1CLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGVBQWUsQ0FBQztZQUNyRSxhQUFhLEVBQUUsZUFBZTtTQUMvQixDQUFDLENBQUM7UUFFSCxNQUFNLE1BQU0sR0FBa0IsTUFBTSxjQUFJLENBQUMsbUJBQW1CLENBQUM7WUFDM0QsV0FBVyxFQUFFLENBQUMsa0NBQWUsQ0FBQztZQUM5QixTQUFTLEVBQUU7Z0JBQ1Q7b0JBQ0UsT0FBTyxFQUFFLDRCQUFZO29CQUNyQixRQUFRLEVBQUUsZ0JBQWdCO2lCQUMzQjtnQkFDRDtvQkFDRSxPQUFPLEVBQUUsaURBQXNCO29CQUMvQixRQUFRLEVBQUUsMEJBQTBCO2lCQUNyQztnQkFDRDtvQkFDRSxPQUFPLEVBQUUsc0JBQVM7b0JBQ2xCLFFBQVEsRUFBRSxhQUFhO2lCQUN4QjtnQkFDRDtvQkFDRSxPQUFPLEVBQUUsZUFBTTtvQkFDZixRQUFRLEVBQUU7d0JBQ1IsR0FBRyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7d0JBQ2QsS0FBSyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7d0JBQ2hCLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO3dCQUNmLEtBQUssRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO3FCQUNqQjtpQkFDRjthQUNGO1NBQ0YsQ0FBQzthQUNDLGFBQWEsQ0FBQyw2QkFBWSxDQUFDO2FBQzNCLFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQzthQUMxQixhQUFhLENBQUMsaUNBQWMsQ0FBQzthQUM3QixRQUFRLENBQUMsa0JBQWtCLENBQUM7YUFDNUIsT0FBTyxFQUFFLENBQUM7UUFFYixVQUFVLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBa0Isa0NBQWUsQ0FBQyxDQUFDO1FBQzFELFlBQVksR0FBRyxNQUFNLENBQUMsR0FBRyxDQUFlLDRCQUFZLENBQUMsQ0FBQztRQUN0RCxzQkFBc0IsR0FBRyxNQUFNLENBQUMsR0FBRyxDQUF5QixpREFBc0IsQ0FBQyxDQUFDO1FBQ3BGLFNBQVMsR0FBRyxNQUFNLENBQUMsR0FBRyxDQUFZLHNCQUFTLENBQUMsQ0FBQztJQUMvQyxDQUFDLENBQUMsQ0FBQztJQUVILFNBQVMsQ0FBQyxHQUFHLEVBQUU7UUFDYixJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7SUFDdkIsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsU0FBUyxFQUFFLEdBQUcsRUFBRTtRQUN2QixFQUFFLENBQUMsbUNBQW1DLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDakQsVUFBVTtZQUNWLElBQUksQ0FBQyxLQUFLLENBQUMsWUFBWSxFQUFFLFNBQVMsQ0FBQyxDQUFDLGlCQUFpQixDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBRWpFLE1BQU07WUFDTixNQUFNLE1BQU0sR0FBRyxNQUFNLFVBQVUsQ0FBQyxPQUFPLENBQUMscUJBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUU3RCxTQUFTO1lBQ1QsTUFBTSxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1lBQ2hELE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDcEMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsOEJBQThCLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDNUMsVUFBVTtZQUNWLE1BQU0sS0FBSyxHQUFHLElBQUksS0FBSyxDQUFDLGdCQUFnQixDQUFDLENBQUM7WUFDMUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxZQUFZLEVBQUUsU0FBUyxDQUFDLENBQUMsaUJBQWlCLENBQUMsS0FBSyxDQUFDLENBQUM7WUFFN0QsZUFBZTtZQUNmLE1BQU0sTUFBTSxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMscUJBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsc0JBQWEsQ0FBQyxDQUFDO1FBQ3ZGLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsd0JBQXdCLEVBQUUsR0FBRyxFQUFFO1FBQ3RDLEVBQUUsQ0FBQyxzREFBc0QsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNwRSxNQUFNLFNBQVMsR0FBRztnQkFDaEIseUNBQWlCLENBQUMsVUFBVSxDQUFDLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxDQUFDO2dCQUNoRCx5Q0FBaUIsQ0FBQyxVQUFVLENBQUMsRUFBRSxRQUFRLEVBQUUsS0FBSyxFQUFFLENBQUM7YUFDbEQsQ0FBQztZQUVGLFlBQVksQ0FBQyxzQkFBc0IsQ0FBQyxpQkFBaUIsQ0FBQyxTQUFnQixDQUFDLENBQUM7WUFFeEUsTUFBTSxNQUFNLEdBQUcsTUFBTSxVQUFVLENBQUMsc0JBQXNCLENBQ3BELHFCQUFhLENBQUMsS0FBSyxDQUNwQixDQUFDO1lBRUYsTUFBTSxDQUFDLFlBQVksQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDLGdCQUFnQixFQUFFLENBQUM7WUFDL0QsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUNwQyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxzREFBc0QsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNwRSxZQUFZLENBQUMsc0JBQXNCLENBQUMsaUJBQWlCLENBQ25ELElBQUksS0FBSyxDQUFDLDRCQUE0QixDQUFDLENBQ3hDLENBQUM7WUFFRixNQUFNLE1BQU0sQ0FDVixVQUFVLENBQUMsc0JBQXNCLENBQUMscUJBQWEsQ0FBQyxLQUFLLENBQUMsQ0FDdkQsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLHNCQUFhLENBQUMsQ0FBQztRQUNuQyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLFNBQVMsRUFBRSxHQUFHLEVBQUU7UUFDdkIsTUFBTSxRQUFRLEdBQUcseUNBQWlCLENBQUMsVUFBVSxDQUFDLEVBQUUsRUFBRSxFQUFFLHFCQUFhLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQztRQUU1RSxFQUFFLENBQUMsNkNBQTZDLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDM0QsU0FBUyxDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUMvQyxZQUFZLENBQUMsT0FBTyxDQUFDLGlCQUFpQixDQUFDLFFBQWUsQ0FBQyxDQUFDO1lBRXhELE1BQU0sTUFBTSxHQUFHLE1BQU0sVUFBVSxDQUFDLE9BQU8sQ0FDckMscUJBQWEsQ0FBQyxNQUFNLEVBQ3BCLHFCQUFhLENBQUMsTUFBTSxDQUNyQixDQUFDO1lBRUYsTUFBTSxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxxQkFBYSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQ3pFLE1BQU0sQ0FBQyxZQUFZLENBQUMsT0FBTyxDQUFDLENBQUMsb0JBQW9CLENBQUMscUJBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUN4RSxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ25DLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDZDQUE2QyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzNELFNBQVMsQ0FBQyxXQUFXLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDOUMsWUFBWSxDQUFDLHNCQUFzQixDQUFDLGlCQUFpQixDQUFDLFFBQWUsQ0FBQyxDQUFDO1lBRXZFLE1BQU0sTUFBTSxHQUFHLE1BQU0sVUFBVSxDQUFDLE9BQU8sQ0FDckMscUJBQWEsQ0FBQyxNQUFNLEVBQ3BCLHFCQUFhLENBQUMsS0FBSyxDQUNwQixDQUFDO1lBRUYsTUFBTSxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxxQkFBYSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ3hFLE1BQU0sQ0FBQyxZQUFZLENBQUMsc0JBQXNCLENBQUMsQ0FBQyxvQkFBb0IsQ0FDOUQscUJBQWEsQ0FBQyxNQUFNLENBQ3JCLENBQUM7WUFDRixNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ25DLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHlFQUF5RSxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3ZGLFNBQVMsQ0FBQyxXQUFXLENBQUMsaUJBQWlCLENBQUMsS0FBSyxDQUFDLENBQUM7WUFFL0MsTUFBTSxNQUFNLENBQ1YsVUFBVSxDQUFDLE9BQU8sQ0FBQyxxQkFBYSxDQUFDLFNBQVMsRUFBRSxxQkFBYSxDQUFDLE1BQU0sQ0FBQyxDQUNsRSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsMkJBQWtCLENBQUMsQ0FBQztZQUV0QyxNQUFNLENBQUMsWUFBWSxDQUFDLE9BQU8sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1FBQ3RELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLGdEQUFnRCxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzlELFNBQVMsQ0FBQyxXQUFXLENBQUMsaUJBQWlCLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDL0MsWUFBWSxDQUFDLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUU3QyxNQUFNLE1BQU0sQ0FDVixVQUFVLENBQUMsT0FBTyxDQUFDLHFCQUFhLENBQUMsTUFBTSxFQUFFLHFCQUFhLENBQUMsTUFBTSxDQUFDLENBQy9ELENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxzQkFBYSxDQUFDLENBQUM7UUFDbkMsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxRQUFRLEVBQUUsR0FBRyxFQUFFO1FBQ3RCLE1BQU0sVUFBVSxHQUFHO1lBQ2pCLFNBQVMsRUFBRSxTQUFTO1lBQ3BCLFFBQVEsRUFBRSxNQUFNO1lBQ2hCLEdBQUcsRUFBRSxhQUFhO1NBQ25CLENBQUM7UUFFRixFQUFFLENBQUMsK0NBQStDLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDN0QsTUFBTSxXQUFXLEdBQUcsRUFBRSxHQUFHLHlDQUFpQixDQUFDLFVBQVUsRUFBRSxFQUFFLEdBQUcsVUFBVSxFQUFFLENBQUM7WUFDekUsU0FBUyxDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUMvQyxZQUFZLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLFdBQWtCLENBQUMsQ0FBQztZQUUxRCxNQUFNLE1BQU0sR0FBRyxNQUFNLFVBQVUsQ0FBQyxNQUFNLENBQ3BDLHFCQUFhLENBQUMsTUFBTSxFQUNwQixVQUFVLEVBQ1YscUJBQWEsQ0FBQyxNQUFNLENBQ3JCLENBQUM7WUFFRixNQUFNLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLHFCQUFhLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDekUsTUFBTSxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUMsQ0FBQyxvQkFBb0IsQ0FDOUMscUJBQWEsQ0FBQyxNQUFNLEVBQ3BCLFVBQVUsQ0FDWCxDQUFDO1lBQ0YsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUN0QyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyx1REFBdUQsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNyRSxNQUFNLGVBQWUsR0FBRztnQkFDdEIsU0FBUyxFQUFFLGVBQWU7Z0JBQzFCLElBQUksRUFBRSxXQUFXO2dCQUNqQixRQUFRLEVBQUUsS0FBSzthQUNoQixDQUFDO1lBQ0YsTUFBTSxXQUFXLEdBQUc7Z0JBQ2xCLEdBQUcseUNBQWlCLENBQUMsVUFBVSxFQUFFO2dCQUNqQyxHQUFHLGVBQWU7YUFDbkIsQ0FBQztZQUVGLFNBQVMsQ0FBQyxXQUFXLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDOUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxXQUFrQixDQUFDLENBQUM7WUFFMUQsTUFBTSxNQUFNLEdBQUcsTUFBTSxVQUFVLENBQUMsTUFBTSxDQUNwQyxxQkFBYSxDQUFDLE1BQU0sRUFDcEIsZUFBZSxFQUNmLHFCQUFhLENBQUMsS0FBSyxDQUNwQixDQUFDO1lBRUYsTUFBTSxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUMsQ0FBQyxvQkFBb0IsQ0FDOUMscUJBQWEsQ0FBQyxNQUFNLEVBQ3BCLGVBQWUsQ0FDaEIsQ0FBQztZQUNGLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUM7UUFDdEMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsMERBQTBELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDeEUsTUFBTSxnQkFBZ0IsR0FBRztnQkFDdkIsU0FBUyxFQUFFLE1BQU07Z0JBQ2pCLElBQUksRUFBRSxPQUFPLEVBQUUseUJBQXlCO2dCQUN4QyxRQUFRLEVBQUUsS0FBSyxFQUFFLHlCQUF5QjtnQkFDMUMsR0FBRyxFQUFFLFNBQVM7YUFDZixDQUFDO1lBQ0YsTUFBTSxhQUFhLEdBQUc7Z0JBQ3BCLFNBQVMsRUFBRSxNQUFNO2dCQUNqQixHQUFHLEVBQUUsU0FBUzthQUNmLENBQUM7WUFDRixNQUFNLFdBQVcsR0FBRztnQkFDbEIsR0FBRyx5Q0FBaUIsQ0FBQyxVQUFVLEVBQUU7Z0JBQ2pDLEdBQUcsYUFBYTthQUNqQixDQUFDO1lBRUYsU0FBUyxDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUMvQyxZQUFZLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLFdBQWtCLENBQUMsQ0FBQztZQUUxRCxNQUFNLE1BQU0sR0FBRyxNQUFNLFVBQVUsQ0FBQyxNQUFNLENBQ3BDLHFCQUFhLENBQUMsTUFBTSxFQUNwQixnQkFBZ0IsRUFDaEIscUJBQWEsQ0FBQyxNQUFNLENBQ3JCLENBQUM7WUFFRixNQUFNLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDLG9CQUFvQixDQUM5QyxxQkFBYSxDQUFDLE1BQU0sRUFDcEIsYUFBYSxDQUNkLENBQUM7WUFDRixNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxDQUFDO1FBQ3RDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDJFQUEyRSxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3pGLFNBQVMsQ0FBQyxXQUFXLENBQUMsaUJBQWlCLENBQUMsS0FBSyxDQUFDLENBQUM7WUFFL0MsTUFBTSxNQUFNLENBQ1YsVUFBVSxDQUFDLE1BQU0sQ0FDZixxQkFBYSxDQUFDLFNBQVMsRUFDdkIsVUFBVSxFQUNWLHFCQUFhLENBQUMsTUFBTSxDQUNyQixDQUNGLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQywyQkFBa0IsQ0FBQyxDQUFDO1lBRXRDLE1BQU0sQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLENBQUMsR0FBRyxDQUFDLGdCQUFnQixFQUFFLENBQUM7UUFDckQsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxRQUFRLEVBQUUsR0FBRyxFQUFFO1FBQ3RCLEVBQUUsQ0FBQyxtREFBbUQsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNqRSxTQUFTLENBQUMsV0FBVyxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQy9DLFlBQVksQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsRUFBUyxDQUFDLENBQUM7WUFFakQsTUFBTSxNQUFNLEdBQUcsTUFBTSxVQUFVLENBQUMsTUFBTSxDQUNwQyxxQkFBYSxDQUFDLE1BQU0sRUFDcEIscUJBQWEsQ0FBQyxNQUFNLENBQ3JCLENBQUM7WUFFRixNQUFNLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLHFCQUFhLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDekUsTUFBTSxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxxQkFBYSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQ3ZFLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUM7Z0JBQ3JCLE9BQU8sRUFBRSx1Q0FBdUM7YUFDakQsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsbURBQW1ELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDakUsU0FBUyxDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUM5QyxZQUFZLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLEVBQVMsQ0FBQyxDQUFDO1lBRWpELE1BQU0sTUFBTSxHQUFHLE1BQU0sVUFBVSxDQUFDLE1BQU0sQ0FDcEMscUJBQWEsQ0FBQyxNQUFNLEVBQ3BCLHFCQUFhLENBQUMsS0FBSyxDQUNwQixDQUFDO1lBRUYsTUFBTSxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxxQkFBYSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQ3ZFLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUM7Z0JBQ3JCLE9BQU8sRUFBRSx1Q0FBdUM7YUFDakQsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsK0VBQStFLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDN0YsU0FBUyxDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUUvQyxNQUFNLE1BQU0sQ0FDVixVQUFVLENBQUMsTUFBTSxDQUFDLHFCQUFhLENBQUMsU0FBUyxFQUFFLHFCQUFhLENBQUMsTUFBTSxDQUFDLENBQ2pFLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQywyQkFBa0IsQ0FBQyxDQUFDO1lBRXRDLE1BQU0sQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLENBQUMsR0FBRyxDQUFDLGdCQUFnQixFQUFFLENBQUM7UUFDckQsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyw2QkFBNkIsRUFBRSxHQUFHLEVBQUU7UUFDM0MsRUFBRSxDQUFDLG1EQUFtRCxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ2pFLE1BQU0sZ0JBQWdCLEdBQUcsRUFBRSxNQUFNLEVBQUUsa0JBQWtCLEVBQUUsQ0FBQztZQUN4RCxZQUFZLENBQUMsVUFBVSxDQUFDLGlCQUFpQixDQUFDLEVBQVMsQ0FBQyxDQUFDO1lBRXJELE1BQU0sTUFBTSxHQUFHLE1BQU0sVUFBVSxDQUFDLGNBQWMsQ0FDNUMscUJBQWEsQ0FBQyxNQUFNLEVBQ3BCLGdCQUFnQixFQUNoQixxQkFBYSxDQUFDLEtBQUssQ0FDcEIsQ0FBQztZQUVGLE1BQU0sQ0FBQyxZQUFZLENBQUMsVUFBVSxDQUFDLENBQUMsb0JBQW9CLENBQ2xELHFCQUFhLENBQUMsTUFBTSxFQUNwQixrQkFBa0IsRUFDbEIscUJBQWEsQ0FBQyxLQUFLLENBQ3BCLENBQUM7WUFDRixNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsT0FBTyxDQUFDO2dCQUNyQixPQUFPLEVBQUUsMkNBQTJDO2FBQ3JELENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDJDQUEyQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3pELE1BQU0sZ0JBQWdCLEdBQUcsRUFBRSxDQUFDO1lBQzVCLFlBQVksQ0FBQyxVQUFVLENBQUMsaUJBQWlCLENBQUMsRUFBUyxDQUFDLENBQUM7WUFFckQsTUFBTSxNQUFNLEdBQUcsTUFBTSxVQUFVLENBQUMsY0FBYyxDQUM1QyxxQkFBYSxDQUFDLE1BQU0sRUFDcEIsZ0JBQWdCLEVBQ2hCLHFCQUFhLENBQUMsS0FBSyxDQUNwQixDQUFDO1lBRUYsTUFBTSxDQUFDLFlBQVksQ0FBQyxVQUFVLENBQUMsQ0FBQyxvQkFBb0IsQ0FDbEQscUJBQWEsQ0FBQyxNQUFNLEVBQ3BCLFNBQVMsRUFDVCxxQkFBYSxDQUFDLEtBQUssQ0FDcEIsQ0FBQztZQUNGLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUM7Z0JBQ3JCLE9BQU8sRUFBRSwyQ0FBMkM7YUFDckQsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsa0RBQWtELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDaEUsTUFBTSxnQkFBZ0IsR0FBRyxFQUFFLE1BQU0sRUFBRSxhQUFhLEVBQUUsQ0FBQztZQUNuRCxZQUFZLENBQUMsVUFBVSxDQUFDLGlCQUFpQixDQUFDLElBQUksS0FBSyxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUM7WUFFdEUsTUFBTSxNQUFNLENBQ1YsVUFBVSxDQUFDLGNBQWMsQ0FDdkIscUJBQWEsQ0FBQyxNQUFNLEVBQ3BCLGdCQUFnQixFQUNoQixxQkFBYSxDQUFDLEtBQUssQ0FDcEIsQ0FDRixDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsc0JBQWEsQ0FBQyxDQUFDO1FBQ25DLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsNkJBQTZCLEVBQUUsR0FBRyxFQUFFO1FBQzNDLEVBQUUsQ0FBQyx1Q0FBdUMsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNyRCxZQUFZLENBQUMsVUFBVSxDQUFDLGlCQUFpQixDQUFDLEVBQVMsQ0FBQyxDQUFDO1lBRXJELE1BQU0sTUFBTSxHQUFHLE1BQU0sVUFBVSxDQUFDLGNBQWMsQ0FDNUMscUJBQWEsQ0FBQyxNQUFNLEVBQ3BCLHFCQUFhLENBQUMsS0FBSyxDQUNwQixDQUFDO1lBRUYsTUFBTSxDQUFDLFlBQVksQ0FBQyxVQUFVLENBQUMsQ0FBQyxvQkFBb0IsQ0FDbEQscUJBQWEsQ0FBQyxNQUFNLENBQ3JCLENBQUM7WUFDRixNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsT0FBTyxDQUFDO2dCQUNyQixPQUFPLEVBQUUsdUNBQXVDO2FBQ2pELENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLGtEQUFrRCxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ2hFLFlBQVksQ0FBQyxVQUFVLENBQUMsaUJBQWlCLENBQ3ZDLElBQUksS0FBSyxDQUFDLHFCQUFxQixDQUFDLENBQ2pDLENBQUM7WUFFRixNQUFNLE1BQU0sQ0FDVixVQUFVLENBQUMsY0FBYyxDQUFDLHFCQUFhLENBQUMsTUFBTSxFQUFFLHFCQUFhLENBQUMsS0FBSyxDQUFDLENBQ3JFLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxzQkFBYSxDQUFDLENBQUM7UUFDbkMsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxnQkFBZ0IsRUFBRSxHQUFHLEVBQUU7UUFDOUIsRUFBRSxDQUFDLHVEQUF1RCxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3JFLFNBQVMsQ0FBQyxXQUFXLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDOUMsWUFBWSxDQUFDLHNCQUFzQixDQUFDLGlCQUFpQixDQUNuRCxJQUFJLDJCQUFrQixDQUFDLGVBQWUsQ0FBQyxDQUN4QyxDQUFDO1lBRUYsTUFBTSxNQUFNLENBQ1YsVUFBVSxDQUFDLE9BQU8sQ0FBQyxxQkFBYSxDQUFDLE1BQU0sRUFBRSxxQkFBYSxDQUFDLEtBQUssQ0FBQyxDQUM5RCxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsMkJBQWtCLENBQUMsQ0FBQztRQUN4QyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyw2Q0FBNkMsRUFBRSxLQUFLLElBQUksRUFBRTtZQUMzRCxTQUFTLENBQUMsV0FBVyxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQy9DLFlBQVksQ0FBQyxPQUFPLENBQUMsaUJBQWlCLENBQUMsSUFBSSxLQUFLLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQztZQUVuRSxNQUFNLE1BQU0sQ0FDVixVQUFVLENBQUMsT0FBTyxDQUFDLHFCQUFhLENBQUMsTUFBTSxFQUFFLHFCQUFhLENBQUMsTUFBTSxDQUFDLENBQy9ELENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxzQkFBYSxDQUFDLENBQUM7UUFDbkMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsNENBQTRDLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDMUQsU0FBUyxDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLEtBQUssQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLENBQUM7WUFFeEUsTUFBTSxNQUFNLENBQ1YsVUFBVSxDQUFDLE9BQU8sQ0FBQyxxQkFBYSxDQUFDLE1BQU0sRUFBRSxxQkFBYSxDQUFDLE1BQU0sQ0FBQyxDQUMvRCxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsc0JBQWEsQ0FBQyxDQUFDO1FBQ25DLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsMEJBQTBCLEVBQUUsR0FBRyxFQUFFO1FBQ3hDLEVBQUUsQ0FBQywrQ0FBK0MsRUFBRSxLQUFLLElBQUksRUFBRTtZQUM3RCxTQUFTLENBQUMsV0FBVyxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQy9DLFlBQVksQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQ25DLHlDQUFpQixDQUFDLFVBQVUsRUFBUyxDQUN0QyxDQUFDO1lBRUYsTUFBTSxVQUFVLENBQUMsTUFBTSxDQUFDLHFCQUFhLENBQUMsTUFBTSxFQUFFLEVBQUUsRUFBRSxxQkFBYSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBRXhFLE1BQU0sQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLENBQUMsb0JBQW9CLENBQzlDLHFCQUFhLENBQUMsTUFBTSxFQUNwQixFQUFFLENBQ0gsQ0FBQztRQUNKLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLGlFQUFpRSxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQy9FLE1BQU0sU0FBUyxHQUFHO2dCQUNoQixTQUFTLEVBQUUsTUFBTSxFQUFFLFVBQVU7Z0JBQzdCLFFBQVEsRUFBRSxLQUFLLEVBQUUsVUFBVTtnQkFDM0IsSUFBSSxFQUFFLE9BQU8sRUFBRSxjQUFjO2dCQUM3QixHQUFHLEVBQUUsU0FBUyxFQUFFLFVBQVU7Z0JBQzFCLFFBQVEsRUFBRSxLQUFLLEVBQUUsY0FBYztnQkFDL0IsU0FBUyxFQUFFLCtCQUErQixFQUFFLFVBQVU7YUFDdkQsQ0FBQztZQUNGLE1BQU0scUJBQXFCLEdBQUc7Z0JBQzVCLFNBQVMsRUFBRSxNQUFNO2dCQUNqQixRQUFRLEVBQUUsS0FBSztnQkFDZixHQUFHLEVBQUUsU0FBUztnQkFDZCxTQUFTLEVBQUUsK0JBQStCO2FBQzNDLENBQUM7WUFFRixTQUFTLENBQUMsV0FBVyxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQy9DLFlBQVksQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQ25DLHlDQUFpQixDQUFDLFVBQVUsRUFBUyxDQUN0QyxDQUFDO1lBRUYsTUFBTSxVQUFVLENBQUMsTUFBTSxDQUNyQixxQkFBYSxDQUFDLE1BQU0sRUFDcEIsU0FBUyxFQUNULHFCQUFhLENBQUMsTUFBTSxDQUNyQixDQUFDO1lBRUYsTUFBTSxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUMsQ0FBQyxvQkFBb0IsQ0FDOUMscUJBQWEsQ0FBQyxNQUFNLEVBQ3BCLHFCQUFxQixDQUN0QixDQUFDO1FBQ0osQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyx5QkFBeUIsRUFBRSxHQUFHLEVBQUU7UUFDdkMsRUFBRSxDQUFDLDBDQUEwQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3hELFVBQVU7WUFDVixNQUFNLFNBQVMsR0FBRztnQkFDaEIsTUFBTSxFQUFFLENBQUMsUUFBUSxDQUFDO2FBQ25CLENBQUM7WUFDRixNQUFNLFVBQVUsR0FBRztnQkFDakIsU0FBUyxFQUFFLE1BQU07Z0JBQ2pCLFFBQVEsRUFBRSxLQUFLO2FBQ2hCLENBQUM7WUFFRixTQUFTLENBQUMsV0FBVyxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQy9DLHNCQUFzQixDQUFDLFlBQVksQ0FBQyxlQUFlLENBQUMsRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztZQUN2RSxzQkFBc0IsQ0FBQyxVQUFVLENBQUMsaUJBQWlCLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztZQUN0RSxZQUFZLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUNuQyx5Q0FBaUIsQ0FBQyxVQUFVLEVBQVMsQ0FDdEMsQ0FBQztZQUVGLE1BQU07WUFDTixNQUFNLFVBQVUsQ0FBQyxNQUFNLENBQ3JCLHFCQUFhLENBQUMsTUFBTSxFQUNwQixVQUFVLEVBQ1YscUJBQWEsQ0FBQyxNQUFNLEVBQ3BCLFNBQVMsQ0FDVixDQUFDO1lBRUYsU0FBUztZQUNULE1BQU0sQ0FBQyxzQkFBc0IsQ0FBQyxZQUFZLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUMzRSxNQUFNLENBQUMsc0JBQXNCLENBQUMsVUFBVSxDQUFDLENBQUMsb0JBQW9CLENBQzVELFFBQVEsRUFDUixlQUFlLENBQ2hCLENBQUM7WUFDRixNQUFNLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDLG9CQUFvQixDQUM5QyxxQkFBYSxDQUFDLE1BQU0sRUFDcEI7Z0JBQ0UsR0FBRyxVQUFVO2dCQUNiLFNBQVMsRUFBRSxnQkFBZ0IsQ0FBQyxHQUFHO2FBQ2hDLENBQ0YsQ0FBQztRQUNKLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLCtDQUErQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzdELFVBQVU7WUFDVixNQUFNLGFBQWEsR0FBRztnQkFDcEIsR0FBRyxRQUFRO2dCQUNYLFNBQVMsRUFBRSxPQUFPO2dCQUNsQixZQUFZLEVBQUUsV0FBVzthQUMxQixDQUFDO1lBQ0YsTUFBTSxTQUFTLEdBQUc7Z0JBQ2hCLEtBQUssRUFBRSxDQUFDLGFBQWEsQ0FBQzthQUN2QixDQUFDO1lBQ0YsTUFBTSxVQUFVLEdBQUc7Z0JBQ2pCLFNBQVMsRUFBRSxNQUFNO2dCQUNqQixRQUFRLEVBQUUsS0FBSzthQUNoQixDQUFDO1lBRUYsU0FBUyxDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUMvQyxzQkFBc0IsQ0FBQyxZQUFZLENBQUMsZUFBZSxDQUFDLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7WUFDdkUsc0JBQXNCLENBQUMsVUFBVSxDQUFDLGlCQUFpQixDQUFDLGdCQUFnQixDQUFDLENBQUM7WUFDdEUsWUFBWSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FDbkMseUNBQWlCLENBQUMsVUFBVSxFQUFTLENBQ3RDLENBQUM7WUFFRixNQUFNO1lBQ04sTUFBTSxVQUFVLENBQUMsTUFBTSxDQUNyQixxQkFBYSxDQUFDLE1BQU0sRUFDcEIsVUFBVSxFQUNWLHFCQUFhLENBQUMsTUFBTSxFQUNwQixTQUFTLENBQ1YsQ0FBQztZQUVGLFNBQVM7WUFDVCxNQUFNLENBQUMsc0JBQXNCLENBQUMsWUFBWSxDQUFDLENBQUMsb0JBQW9CLENBQUMsYUFBYSxDQUFDLENBQUM7WUFDaEYsTUFBTSxDQUFDLHNCQUFzQixDQUFDLFVBQVUsQ0FBQyxDQUFDLG9CQUFvQixDQUM1RCxhQUFhLEVBQ2IsZUFBZSxDQUNoQixDQUFDO1lBQ0YsTUFBTSxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUMsQ0FBQyxvQkFBb0IsQ0FDOUMscUJBQWEsQ0FBQyxNQUFNLEVBQ3BCO2dCQUNFLEdBQUcsVUFBVTtnQkFDYixhQUFhLEVBQUUsZ0JBQWdCLENBQUMsR0FBRzthQUNwQyxDQUNGLENBQUM7UUFDSixDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxvREFBb0QsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNsRSxVQUFVO1lBQ1YsTUFBTSxhQUFhLEdBQUc7Z0JBQ3BCLEdBQUcsUUFBUTtnQkFDWCxTQUFTLEVBQUUsT0FBTztnQkFDbEIsWUFBWSxFQUFFLFdBQVc7YUFDMUIsQ0FBQztZQUNGLE1BQU0sU0FBUyxHQUFHO2dCQUNoQixNQUFNLEVBQUUsQ0FBQyxRQUFRLENBQUM7Z0JBQ2xCLEtBQUssRUFBRSxDQUFDLGFBQWEsQ0FBQzthQUN2QixDQUFDO1lBQ0YsTUFBTSxVQUFVLEdBQUc7Z0JBQ2pCLFNBQVMsRUFBRSxNQUFNO2dCQUNqQixRQUFRLEVBQUUsS0FBSzthQUNoQixDQUFDO1lBRUYsU0FBUyxDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUMvQyxzQkFBc0IsQ0FBQyxZQUFZLENBQUMsZUFBZSxDQUFDLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7WUFDdkUsc0JBQXNCLENBQUMsVUFBVSxDQUFDLGlCQUFpQixDQUFDLGdCQUFnQixDQUFDLENBQUM7WUFDdEUsWUFBWSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FDbkMseUNBQWlCLENBQUMsVUFBVSxFQUFTLENBQ3RDLENBQUM7WUFFRixNQUFNO1lBQ04sTUFBTSxVQUFVLENBQUMsTUFBTSxDQUNyQixxQkFBYSxDQUFDLE1BQU0sRUFDcEIsVUFBVSxFQUNWLHFCQUFhLENBQUMsTUFBTSxFQUNwQixTQUFTLENBQ1YsQ0FBQztZQUVGLFNBQVM7WUFDVCxNQUFNLENBQUMsc0JBQXNCLENBQUMsWUFBWSxDQUFDLENBQUMscUJBQXFCLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDckUsTUFBTSxDQUFDLHNCQUFzQixDQUFDLFVBQVUsQ0FBQyxDQUFDLHFCQUFxQixDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ25FLE1BQU0sQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLENBQUMsb0JBQW9CLENBQzlDLHFCQUFhLENBQUMsTUFBTSxFQUNwQjtnQkFDRSxHQUFHLFVBQVU7Z0JBQ2IsU0FBUyxFQUFFLGdCQUFnQixDQUFDLEdBQUc7Z0JBQy9CLGFBQWEsRUFBRSxnQkFBZ0IsQ0FBQyxHQUFHO2FBQ3BDLENBQ0YsQ0FBQztRQUNKLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHNDQUFzQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3BELFVBQVU7WUFDVixNQUFNLFNBQVMsR0FBRztnQkFDaEIsTUFBTSxFQUFFLENBQUMsUUFBUSxDQUFDO2FBQ25CLENBQUM7WUFDRixNQUFNLFVBQVUsR0FBRztnQkFDakIsU0FBUyxFQUFFLE1BQU07Z0JBQ2pCLFFBQVEsRUFBRSxLQUFLO2FBQ2hCLENBQUM7WUFFRixTQUFTLENBQUMsV0FBVyxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQy9DLHNCQUFzQixDQUFDLFlBQVksQ0FBQyxlQUFlLENBQUM7Z0JBQ2xELE9BQU8sRUFBRSxLQUFLO2dCQUNkLEtBQUssRUFBRSxnQkFBZ0I7YUFDeEIsQ0FBQyxDQUFDO1lBRUgsZUFBZTtZQUNmLE1BQU0sTUFBTSxDQUNWLFVBQVUsQ0FBQyxNQUFNLENBQ2YscUJBQWEsQ0FBQyxNQUFNLEVBQ3BCLFVBQVUsRUFDVixxQkFBYSxDQUFDLE1BQU0sRUFDcEIsU0FBUyxDQUNWLENBQ0YsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLDBDQUEwQyxDQUFDLENBQUM7UUFDaEUsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsa0NBQWtDLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDaEQsVUFBVTtZQUNWLE1BQU0sU0FBUyxHQUFHO2dCQUNoQixNQUFNLEVBQUUsQ0FBQyxRQUFRLENBQUM7YUFDbkIsQ0FBQztZQUNGLE1BQU0sVUFBVSxHQUFHO2dCQUNqQixTQUFTLEVBQUUsTUFBTTtnQkFDakIsUUFBUSxFQUFFLEtBQUs7YUFDaEIsQ0FBQztZQUVGLFNBQVMsQ0FBQyxXQUFXLENBQUMsaUJBQWlCLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDL0Msc0JBQXNCLENBQUMsWUFBWSxDQUFDLGVBQWUsQ0FBQyxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO1lBQ3ZFLHNCQUFzQixDQUFDLFVBQVUsQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLEtBQUssQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDO1lBRWhGLGVBQWU7WUFDZixNQUFNLE1BQU0sQ0FDVixVQUFVLENBQUMsTUFBTSxDQUNmLHFCQUFhLENBQUMsTUFBTSxFQUNwQixVQUFVLEVBQ1YscUJBQWEsQ0FBQyxNQUFNLEVBQ3BCLFNBQVMsQ0FDVixDQUNGLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxzQ0FBc0MsQ0FBQyxDQUFDO1FBQzVELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsZ0JBQWdCLEVBQUUsR0FBRyxFQUFFO1FBQzlCLEVBQUUsQ0FBQyxzREFBc0QsRUFBRSxHQUFHLEVBQUU7WUFDOUQsd0RBQXdEO1lBQ3hELE1BQU0sY0FBYyxHQUFHLElBQUksdUNBQWlCLENBQUMsRUFBUyxDQUFDLENBQUM7WUFDeEQsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQ3ZDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLGlEQUFpRCxFQUFFLEdBQUcsRUFBRTtZQUN6RCw0Q0FBNEM7WUFDNUMsTUFBTSxnQkFBZ0IsR0FBRyxDQUFDLFNBQVMsRUFBRSx3QkFBd0IsRUFBRSxTQUFTLEVBQUUsUUFBUSxFQUFFLFFBQVEsRUFBRSxnQkFBZ0IsRUFBRSxnQkFBZ0IsQ0FBQyxDQUFDO1lBRWxJLGdCQUFnQixDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsRUFBRTtnQkFDaEMsTUFBTSxNQUFNLEdBQUcsT0FBTyxDQUFDLFdBQVcsQ0FBQyxZQUFZLEVBQUUsVUFBVSxDQUFDLE1BQStCLENBQUMsQ0FBQyxDQUFDO2dCQUM5RixNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDL0IsQ0FBQyxDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxzREFBc0QsRUFBRSxHQUFHLEVBQUU7WUFDOUQsZ0RBQWdEO1lBQ2hELE1BQU0sWUFBWSxHQUFHLENBQUMsU0FBUyxFQUFFLHdCQUF3QixFQUFFLGdCQUFnQixFQUFFLGdCQUFnQixDQUFDLENBQUM7WUFFL0YsWUFBWSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsRUFBRTtnQkFDNUIsTUFBTSxNQUFNLEdBQUcsT0FBTyxDQUFDLFdBQVcsQ0FBQyxZQUFZLEVBQUUsVUFBVSxDQUFDLE1BQStCLENBQUMsQ0FBQyxDQUFDO2dCQUM5RixNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDL0IsQ0FBQyxDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxvQ0FBb0MsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNsRCwwQ0FBMEM7WUFDMUMsZ0JBQWdCLENBQUMsV0FBVyxDQUFDLGVBQWUsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUVwRCxzREFBc0Q7WUFDdEQsTUFBTSxpQkFBaUIsR0FBRyxJQUFJLEtBQUssQ0FBQyxjQUFjLENBQUMsQ0FBQztZQUNwRCxZQUFZLENBQUMsT0FBTyxDQUFDLGlCQUFpQixDQUFDLGlCQUFpQixDQUFDLENBQUM7WUFFMUQsTUFBTSxNQUFNLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxxQkFBYSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBQzFFLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDhDQUE4QyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzVELDRDQUE0QztZQUM1QyxrQkFBa0IsQ0FBQyxXQUFXLENBQUMsZUFBZSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBRXRELHNEQUFzRDtZQUN0RCxNQUFNLGNBQWMsR0FBRyxJQUFJLEtBQUssQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUM5QyxZQUFZLENBQUMsT0FBTyxDQUFDLGlCQUFpQixDQUFDLGNBQWMsQ0FBQyxDQUFDO1lBRXZELE1BQU0sTUFBTSxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMscUJBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUMxRSxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQywyREFBMkQsRUFBRSxLQUFLLElBQUksRUFBRTtZQUN6RSxvREFBb0Q7WUFDcEQsU0FBUyxDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUUvQyxNQUFNLE1BQU0sQ0FDVixVQUFVLENBQUMsT0FBTyxDQUFDLHFCQUFhLENBQUMsU0FBUyxFQUFFLHFCQUFhLENBQUMsTUFBTSxDQUFDLENBQ2xFLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQywyQkFBa0IsQ0FBQyxDQUFDO1FBQ3hDLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsMkJBQTJCLEVBQUUsR0FBRyxFQUFFO1FBQ3pDLEVBQUUsQ0FBQyxtREFBbUQsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNqRSwrQ0FBK0M7WUFDL0MsTUFBTSx5Q0FBa0IsQ0FBQyxhQUFhLENBQ3BDLEtBQUssRUFBRSxNQUFjLEVBQUUsSUFBWSxFQUFFLEVBQUU7Z0JBQ3JDLElBQUksQ0FBQztvQkFDSCxNQUFNLFVBQVUsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUM7b0JBQ2pDLE9BQU8sSUFBSSxDQUFDO2dCQUNkLENBQUM7Z0JBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztvQkFDZixPQUFPLEtBQUssQ0FBQztnQkFDZixDQUFDO1lBQ0gsQ0FBQyxFQUNEO2dCQUNFLE1BQU0sRUFBRSxLQUFLO2dCQUNiLFNBQVMsRUFBRSxLQUFLO2dCQUNoQixLQUFLLEVBQUUsSUFBSTtnQkFDWCxTQUFTLEVBQUUsS0FBSzthQUNqQixDQUNGLENBQUM7UUFDSixDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyw2Q0FBNkMsRUFBRSxLQUFLLElBQUksRUFBRTtZQUMzRCwrQ0FBK0M7WUFDL0MsTUFBTSxXQUFXLEdBQUcsbUNBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUU1RCxTQUFTLENBQUMsV0FBVyxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQy9DLFlBQVksQ0FBQyxPQUFPLENBQUMsaUJBQWlCLENBQUMsUUFBZSxDQUFDLENBQUM7WUFFeEQsTUFBTSxNQUFNLEdBQUcsTUFBTSxVQUFVLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxNQUFNLEVBQUUsV0FBVyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBRWhGLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUM3QixNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDN0MsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsb0RBQW9ELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDbEUsMkRBQTJEO1lBQzNELE1BQU0sYUFBYSxHQUFHO2dCQUNwQixTQUFTLEVBQUUsTUFBTTtnQkFDakIsSUFBSSxFQUFFLE9BQU8sRUFBRSx5QkFBeUI7Z0JBQ3hDLFFBQVEsRUFBRSxLQUFLLEVBQUUseUJBQXlCO2dCQUMxQyxhQUFhLEVBQUUsSUFBSSxFQUFFLHlCQUF5QjthQUMvQyxDQUFDO1lBRUYsU0FBUyxDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUMvQyxZQUFZLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLFFBQWUsQ0FBQyxDQUFDO1lBRXZELE1BQU0sVUFBVSxDQUFDLE1BQU0sQ0FBQyxxQkFBYSxDQUFDLE1BQU0sRUFBRSxhQUFhLEVBQUUscUJBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUVuRixNQUFNLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDLG9CQUFvQixDQUM5QyxxQkFBYSxDQUFDLE1BQU0sRUFDcEIsRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFFLENBQ3RCLENBQUM7UUFDSixDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLG1CQUFtQixFQUFFLEdBQUcsRUFBRTtRQUNqQyxFQUFFLENBQUMscURBQXFELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDbkUsVUFBVTtZQUNWLE1BQU0sVUFBVSxHQUFHO2dCQUNqQixTQUFTLEVBQUUsU0FBUztnQkFDcEIsUUFBUSxFQUFFLE1BQU07Z0JBQ2hCLEdBQUcsRUFBRSxhQUFhO2dCQUNsQixRQUFRLEVBQUUscUJBQXFCO2dCQUMvQixRQUFRLEVBQUUsSUFBSTtnQkFDZCxLQUFLLEVBQUUsTUFBTTthQUNkLENBQUM7WUFDRixNQUFNLFdBQVcsR0FBRyxFQUFFLEdBQUcsUUFBUSxFQUFFLEdBQUcsVUFBVSxFQUFFLENBQUM7WUFFbkQsU0FBUyxDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUMvQyxZQUFZLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLFdBQWtCLENBQUMsQ0FBQztZQUUxRCxNQUFNO1lBQ04sTUFBTSxNQUFNLEdBQUcsTUFBTSxVQUFVLENBQUMsTUFBTSxDQUNwQyxxQkFBYSxDQUFDLE1BQU0sRUFDcEIsVUFBVSxFQUNWLHFCQUFhLENBQUMsTUFBTSxDQUNyQixDQUFDO1lBRUYsU0FBUztZQUNULE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUM3QixNQUFNLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUN6QyxNQUFNLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUNyQyxNQUFNLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQztZQUN2QyxNQUFNLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO1FBQ3RELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHVEQUF1RCxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3JFLFVBQVU7WUFDVixTQUFTLENBQUMsV0FBVyxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxDQUFDO1lBQzlDLFlBQVksQ0FBQyxPQUFPLENBQUMsaUJBQWlCLENBQUMsU0FBZ0IsQ0FBQyxDQUFDO1lBQ3pELFlBQVksQ0FBQyxzQkFBc0IsQ0FBQyxpQkFBaUIsQ0FBQyxTQUFnQixDQUFDLENBQUM7WUFDeEUsWUFBWSxDQUFDLHNCQUFzQixDQUFDLGlCQUFpQixDQUFDLFFBQWUsQ0FBQyxDQUFDO1lBRXZFLHNCQUFzQjtZQUN0QixNQUFNLFFBQVEsR0FBRyxNQUFNLFVBQVUsQ0FBQyxPQUFPLENBQUMscUJBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUUvRCx5Q0FBeUM7WUFDekMsTUFBTSx1QkFBdUIsR0FBRyxNQUFNLFVBQVUsQ0FBQyxzQkFBc0IsQ0FBQyxxQkFBYSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBRTdGLDJCQUEyQjtZQUMzQixNQUFNLFlBQVksR0FBRyxNQUFNLFVBQVUsQ0FBQyxPQUFPLENBQUMscUJBQWEsQ0FBQyxNQUFNLEVBQUUscUJBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUV6RixTQUFTO1lBQ1QsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQy9CLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFFakMsTUFBTSxDQUFDLHVCQUF1QixDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDOUMsTUFBTSxDQUFDLHVCQUF1QixDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBRWhELE1BQU0sQ0FBQyxZQUFZLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUNuQyxNQUFNLENBQUMsWUFBWSxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxxQkFBYSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ3JELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLG1EQUFtRCxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ2pFLFVBQVU7WUFDVixTQUFTLENBQUMsV0FBVyxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxDQUFDO1lBQzlDLFlBQVksQ0FBQyxVQUFVLENBQUMsaUJBQWlCLENBQUMsRUFBUyxDQUFDLENBQUM7WUFFckQsTUFBTTtZQUNOLE1BQU0sTUFBTSxHQUFHLE1BQU0sVUFBVSxDQUFDLGNBQWMsQ0FDNUMscUJBQWEsQ0FBQyxNQUFNLEVBQ3BCLEVBQUUsTUFBTSxFQUFFLGtCQUFrQixFQUFFLEVBQzlCLHFCQUFhLENBQUMsS0FBSyxDQUNwQixDQUFDO1lBRUYsU0FBUztZQUNULE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUM3QixNQUFNLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQywyQ0FBMkMsQ0FBQyxDQUFDO1lBQ3pFLE1BQU0sQ0FBQyxZQUFZLENBQUMsVUFBVSxDQUFDLENBQUMsb0JBQW9CLENBQ2xELHFCQUFhLENBQUMsTUFBTSxFQUNwQixrQkFBa0IsRUFDbEIscUJBQWEsQ0FBQyxLQUFLLENBQ3BCLENBQUM7UUFDSixDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxtREFBbUQsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNqRSxVQUFVO1lBQ1YsU0FBUyxDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUM5QyxZQUFZLENBQUMsVUFBVSxDQUFDLGlCQUFpQixDQUFDLEVBQVMsQ0FBQyxDQUFDO1lBRXJELE1BQU07WUFDTixNQUFNLE1BQU0sR0FBRyxNQUFNLFVBQVUsQ0FBQyxjQUFjLENBQzVDLHFCQUFhLENBQUMsTUFBTSxFQUNwQixxQkFBYSxDQUFDLEtBQUssQ0FDcEIsQ0FBQztZQUVGLFNBQVM7WUFDVCxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDN0IsTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsdUNBQXVDLENBQUMsQ0FBQztZQUNyRSxNQUFNLENBQUMsWUFBWSxDQUFDLFVBQVUsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLHFCQUFhLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDN0UsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxpQkFBaUIsRUFBRSxHQUFHLEVBQUU7UUFDL0IsRUFBRSxDQUFDLDRDQUE0QyxFQUFFLEdBQUcsRUFBRTtZQUNwRCxrREFBa0Q7WUFDbEQsTUFBTSxlQUFlLEdBQUc7Z0JBQ3RCLFNBQVMsRUFBRSxNQUFNO2dCQUNqQixRQUFRLEVBQUUsS0FBSztnQkFDZixHQUFHLEVBQUUsVUFBVTtnQkFDZixTQUFTLEVBQUUsZ0NBQWdDO2dCQUMzQyxhQUFhLEVBQUUsK0JBQStCO2dCQUM5QyxXQUFXLEVBQUUsYUFBYTtnQkFDMUIsUUFBUSxFQUFFLGtCQUFrQjtnQkFDNUIsUUFBUSxFQUFFLElBQUk7Z0JBQ2QsS0FBSyxFQUFFLE9BQU87YUFDZixDQUFDO1lBRUYsZ0NBQWdDO1lBQ2hDLE1BQU0sQ0FBQyxlQUFlLENBQUMsU0FBUyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDaEQsTUFBTSxDQUFDLGVBQWUsQ0FBQyxRQUFRLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUMvQyxNQUFNLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQzFDLE1BQU0sQ0FBQyxlQUFlLENBQUMsU0FBUyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDaEQsTUFBTSxDQUFDLGVBQWUsQ0FBQyxhQUFhLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUNwRCxNQUFNLENBQUMsZUFBZSxDQUFDLFdBQVcsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQ2xELE1BQU0sQ0FBQyxlQUFlLENBQUMsUUFBUSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDL0MsTUFBTSxDQUFDLGVBQWUsQ0FBQyxRQUFRLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUMvQyxNQUFNLENBQUMsZUFBZSxDQUFDLEtBQUssQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQzlDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDZDQUE2QyxFQUFFLEdBQUcsRUFBRTtZQUNyRCxrREFBa0Q7WUFDbEQsTUFBTSxxQkFBcUIsR0FBRztnQkFDNUIsTUFBTSxFQUFFLGtCQUFrQjthQUMzQixDQUFDO1lBRUYsZ0NBQWdDO1lBQ2hDLE1BQU0sQ0FBQyxxQkFBcUIsQ0FBQyxNQUFNLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUNyRCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyw2Q0FBNkMsRUFBRSxHQUFHLEVBQUU7WUFDckQsd0RBQXdEO1lBQ3hELE1BQU0sZ0JBQWdCLEdBQUc7Z0JBQ3ZCLEVBQUUsRUFBRSxxQkFBYSxDQUFDLE1BQU07YUFDekIsQ0FBQztZQUVGLGdDQUFnQztZQUNoQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsRUFBRSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDNUMsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyw0QkFBNEIsRUFBRSxHQUFHLEVBQUU7UUFDMUMsRUFBRSxDQUFDLHNEQUFzRCxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3BFLFVBQVU7WUFDVixTQUFTLENBQUMsV0FBVyxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxDQUFDO1lBQzlDLFlBQVksQ0FBQyxPQUFPLENBQUMsaUJBQWlCLENBQUMsU0FBZ0IsQ0FBQyxDQUFDO1lBRXpELE1BQU07WUFDTixNQUFNLE1BQU0sR0FBRyxNQUFNLFVBQVUsQ0FBQyxPQUFPLENBQUMscUJBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUU3RCxTQUFTO1lBQ1QsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGNBQWMsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUNyQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBRS9CLE1BQU0sSUFBSSxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUN2QixNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ2xDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDckMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLGNBQWMsQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUN6QyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsY0FBYyxDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBQ3hDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxjQUFjLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDcEMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLGNBQWMsQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUN6QyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsY0FBYyxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQzFDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHlEQUF5RCxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3ZFLFVBQVU7WUFDVixTQUFTLENBQUMsV0FBVyxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQy9DLFlBQVksQ0FBQyxPQUFPLENBQUMsaUJBQWlCLENBQUMsUUFBZSxDQUFDLENBQUM7WUFFeEQsTUFBTTtZQUNOLE1BQU0sTUFBTSxHQUFHLE1BQU0sVUFBVSxDQUFDLE9BQU8sQ0FBQyxxQkFBYSxDQUFDLE1BQU0sRUFBRSxxQkFBYSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBRXBGLFNBQVM7WUFDVCxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ3BDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDdkMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGNBQWMsQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUMzQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsY0FBYyxDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBQzFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxjQUFjLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDdEMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGNBQWMsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUNyQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsY0FBYyxDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBQzNDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxjQUFjLENBQUMsZUFBZSxDQUFDLENBQUM7WUFDL0MsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGNBQWMsQ0FBQyxhQUFhLENBQUMsQ0FBQztZQUM3QyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsY0FBYyxDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBQzFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxjQUFjLENBQUMsVUFBVSxDQUFDLENBQUM7WUFDMUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUMsQ0FBQztZQUN2QyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsY0FBYyxDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBQzNDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxjQUFjLENBQUMsV0FBVyxDQUFDLENBQUM7UUFDN0MsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsbURBQW1ELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDakUsVUFBVTtZQUNWLE1BQU0sVUFBVSxHQUFHO2dCQUNqQixTQUFTLEVBQUUsU0FBUztnQkFDcEIsUUFBUSxFQUFFLE1BQU07YUFDakIsQ0FBQztZQUNGLE1BQU0sV0FBVyxHQUFHLEVBQUUsR0FBRyxRQUFRLEVBQUUsR0FBRyxVQUFVLEVBQUUsQ0FBQztZQUVuRCxTQUFTLENBQUMsV0FBVyxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQy9DLFlBQVksQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsV0FBa0IsQ0FBQyxDQUFDO1lBRTFELE1BQU07WUFDTixNQUFNLE1BQU0sR0FBRyxNQUFNLFVBQVUsQ0FBQyxNQUFNLENBQ3BDLHFCQUFhLENBQUMsTUFBTSxFQUNwQixVQUFVLEVBQ1YscUJBQWEsQ0FBQyxNQUFNLENBQ3JCLENBQUM7WUFFRixTQUFTO1lBQ1QsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUNwQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQ3ZDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxjQUFjLENBQUMsV0FBVyxDQUFDLENBQUM7WUFDM0MsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGNBQWMsQ0FBQyxVQUFVLENBQUMsQ0FBQztZQUMxQyxNQUFNLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUN6QyxNQUFNLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUN2QyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyx5REFBeUQsRUFBRSxLQUFLLElBQUksRUFBRTtZQUN2RSxVQUFVO1lBQ1YsU0FBUyxDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUMvQyxZQUFZLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLEVBQVMsQ0FBQyxDQUFDO1lBRWpELE1BQU07WUFDTixNQUFNLE1BQU0sR0FBRyxNQUFNLFVBQVUsQ0FBQyxNQUFNLENBQUMscUJBQWEsQ0FBQyxNQUFNLEVBQUUscUJBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUVuRixTQUFTO1lBQ1QsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGNBQWMsQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUN6QyxNQUFNLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyx1Q0FBdUMsQ0FBQyxDQUFDO1FBQ3ZFLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLCtEQUErRCxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzdFLFVBQVU7WUFDVixZQUFZLENBQUMsVUFBVSxDQUFDLGlCQUFpQixDQUFDLEVBQVMsQ0FBQyxDQUFDO1lBRXJELE1BQU07WUFDTixNQUFNLE1BQU0sR0FBRyxNQUFNLFVBQVUsQ0FBQyxjQUFjLENBQzVDLHFCQUFhLENBQUMsTUFBTSxFQUNwQixFQUFFLE1BQU0sRUFBRSxrQkFBa0IsRUFBRSxFQUM5QixxQkFBYSxDQUFDLEtBQUssQ0FDcEIsQ0FBQztZQUVGLFNBQVM7WUFDVCxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsY0FBYyxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQ3pDLE1BQU0sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLDJDQUEyQyxDQUFDLENBQUM7UUFDM0UsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMseURBQXlELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDdkUsVUFBVTtZQUNWLFlBQVksQ0FBQyxVQUFVLENBQUMsaUJBQWlCLENBQUMsRUFBUyxDQUFDLENBQUM7WUFFckQsTUFBTTtZQUNOLE1BQU0sTUFBTSxHQUFHLE1BQU0sVUFBVSxDQUFDLGNBQWMsQ0FDNUMscUJBQWEsQ0FBQyxNQUFNLEVBQ3BCLHFCQUFhLENBQUMsS0FBSyxDQUNwQixDQUFDO1lBRUYsU0FBUztZQUNULE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxjQUFjLENBQUMsU0FBUyxDQUFDLENBQUM7WUFDekMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsdUNBQXVDLENBQUMsQ0FBQztRQUN2RSxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL3VzZXJzL3VzZXJzLmNvbnRyb2xsZXIuc3BlYy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUZXN0LCBUZXN0aW5nTW9kdWxlIH0gZnJvbSAnQG5lc3Rqcy90ZXN0aW5nJztcbmltcG9ydCB7IFxuICBIdHRwRXhjZXB0aW9uLCBcbiAgSHR0cFN0YXR1cywgXG4gIEZvcmJpZGRlbkV4Y2VwdGlvbiwgXG4gIExvZ2dlciBcbn0gZnJvbSAnQG5lc3Rqcy9jb21tb24nO1xuaW1wb3J0IHsgVXNlcnNDb250cm9sbGVyIH0gZnJvbSAnLi91c2Vycy5jb250cm9sbGVyJztcbmltcG9ydCB7IFVzZXJzU2VydmljZSB9IGZyb20gJy4vdXNlcnMuc2VydmljZSc7XG5pbXBvcnQgeyBKd3RBdXRoR3VhcmQgfSBmcm9tICcuLi9hdXRoL2d1YXJkcy9qd3QtYXV0aC5ndWFyZCc7XG5pbXBvcnQgeyBBZG1pbkF1dGhHdWFyZCB9IGZyb20gJy4uL2F1dGgvZ3VhcmRzL2FkbWluLWF1dGguZ3VhcmQnO1xuaW1wb3J0IHsgU3VwYWJhc2VTdG9yYWdlU2VydmljZSB9IGZyb20gJy4uL2NvbW1vbi9zZXJ2aWNlcy9zdXBhYmFzZS1zdG9yYWdlLnNlcnZpY2UnO1xuaW1wb3J0IHsgUm9sZVV0aWxzIH0gZnJvbSAnLi4vdXRpbHMvcm9sZS11dGlscyc7XG5pbXBvcnQgeyBab2RWYWxpZGF0aW9uUGlwZSB9IGZyb20gJy4uL2NvbW1vbi9waXBlcy96b2QtdmFsaWRhdGlvbi5waXBlJztcbmltcG9ydCB7XG4gIFNlY3VyaXR5R3VhcmRUZXN0VXRpbHMsXG4gIFJvbGVCYXNlZFRlc3RVdGlscyxcbn0gZnJvbSAnLi4vdGVzdC11dGlscy9hdXRoLXRlc3RpbmctaGVscGVycyc7XG5pbXBvcnQge1xuICBNb2NrQnVpbGRlcixcbiAgVGVzdERhdGFHZW5lcmF0b3IsXG4gIFRlc3RBc3NlcnRpb25zLFxufSBmcm9tICcuLi90ZXN0LXV0aWxzL2VuaGFuY2VkLXRlc3QtaGVscGVycyc7XG5pbXBvcnQgeyBURVNUX1VTRVJfSURTLCBURVNUX0VNQUlMUyB9IGZyb20gJy4uL3Rlc3QtdXRpbHMvaW5kZXgnO1xuXG5kZXNjcmliZSgnVXNlcnNDb250cm9sbGVyJywgKCkgPT4ge1xuICBsZXQgY29udHJvbGxlcjogVXNlcnNDb250cm9sbGVyO1xuICBsZXQgdXNlcnNTZXJ2aWNlOiBVc2Vyc1NlcnZpY2U7XG4gIGxldCBzdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlOiBTdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlO1xuICBsZXQgcm9sZVV0aWxzOiBSb2xlVXRpbHM7XG4gIGxldCBtb2NrSnd0QXV0aEd1YXJkOiBqZXN0Lk1vY2tlZDxKd3RBdXRoR3VhcmQ+O1xuICBsZXQgbW9ja0FkbWluQXV0aEd1YXJkOiBqZXN0Lk1vY2tlZDxBZG1pbkF1dGhHdWFyZD47XG5cbiAgLy8gVGVzdCBkYXRhIGNvbnN0YW50c1xuICBjb25zdCBtb2NrVXNlciA9IHtcbiAgICBpZDogVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgZW1haWw6IFRFU1RfRU1BSUxTLkNMSUVOVCxcbiAgICBmaXJzdE5hbWU6ICdKb2huJyxcbiAgICBsYXN0TmFtZTogJ0RvZScsXG4gICAgcm9sZTogJ2NsaWVudCcsXG4gICAgYmlvOiAnVXNlciBiaW8nLFxuICAgIGF2YXRhclVybDogJ2h0dHBzOi8vZXhhbXBsZS5jb20vYXZhdGFyLmpwZycsXG4gICAgY292ZXJJbWFnZVVybDogJ2h0dHBzOi8vZXhhbXBsZS5jb20vY292ZXIuanBnJyxcbiAgICBwaG9uZU51bWJlcjogJysxMjM0NTY3ODkwJyxcbiAgICB0aW1lem9uZTogJ0FtZXJpY2EvTmV3X1lvcmsnLFxuICAgIGxhbmd1YWdlOiAnZW4nLFxuICAgIHRoZW1lOiAnbGlnaHQnLFxuICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgZW1haWxWZXJpZmllZDogdHJ1ZSxcbiAgICBwcm9maWxlQ29tcGxldGU6IHRydWUsXG4gICAgaXNBY3RpdmU6IHRydWUsXG4gIH07XG5cbiAgY29uc3QgbW9ja0FkbWluVXNlciA9IHtcbiAgICBpZDogVEVTVF9VU0VSX0lEUy5BRE1JTixcbiAgICBlbWFpbDogVEVTVF9FTUFJTFMuQURNSU4sXG4gICAgZmlyc3ROYW1lOiAnQWRtaW4nLFxuICAgIGxhc3ROYW1lOiAnVXNlcicsXG4gICAgcm9sZTogJ2FkbWluJyxcbiAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgIGVtYWlsVmVyaWZpZWQ6IHRydWUsXG4gICAgcHJvZmlsZUNvbXBsZXRlOiB0cnVlLFxuICAgIGlzQWN0aXZlOiB0cnVlLFxuICB9O1xuXG4gIGNvbnN0IG1vY2tVc2VycyA9IFttb2NrVXNlciwgbW9ja0FkbWluVXNlcl07XG5cbiAgY29uc3QgbW9ja0ZpbGUgPSB7XG4gICAgZmllbGRuYW1lOiAnYXZhdGFyJyxcbiAgICBvcmlnaW5hbG5hbWU6ICdhdmF0YXIuanBnJyxcbiAgICBlbmNvZGluZzogJzdiaXQnLFxuICAgIG1pbWV0eXBlOiAnaW1hZ2UvanBlZycsXG4gICAgc2l6ZTogMTAyNCxcbiAgICBidWZmZXI6IEJ1ZmZlci5mcm9tKCd0ZXN0IGZpbGUgY29udGVudCcpLFxuICB9IGFzIEV4cHJlc3MuTXVsdGVyLkZpbGU7XG5cbiAgY29uc3QgbW9ja1VwbG9hZFJlc3VsdCA9IHtcbiAgICB1cmw6ICdodHRwczovL2V4YW1wbGUuY29tL3VwbG9hZGVkLWF2YXRhci5qcGcnLFxuICAgIGZpbGVuYW1lOiAnYXZhdGFyLmpwZycsXG4gICAgc2l6ZTogMTAyNCxcbiAgfTtcblxuICBiZWZvcmVFYWNoKGFzeW5jICgpID0+IHtcbiAgICAvLyBDcmVhdGUgbW9jayBzZXJ2aWNlc1xuICAgIGNvbnN0IG1vY2tVc2Vyc1NlcnZpY2UgPSB7XG4gICAgICBmaW5kQWxsOiBqZXN0LmZuKCksXG4gICAgICBmaW5kQWxsSW5jbHVkZUluYWN0aXZlOiBqZXN0LmZuKCksXG4gICAgICBmaW5kT25lOiBqZXN0LmZuKCksXG4gICAgICBmaW5kT25lSW5jbHVkZUluYWN0aXZlOiBqZXN0LmZuKCksXG4gICAgICB1cGRhdGU6IGplc3QuZm4oKSxcbiAgICAgIHJlbW92ZTogamVzdC5mbigpLFxuICAgICAgZGVhY3RpdmF0ZTogamVzdC5mbigpLFxuICAgICAgcmVhY3RpdmF0ZTogamVzdC5mbigpLFxuICAgIH07XG5cbiAgICBjb25zdCBtb2NrU3VwYWJhc2VTdG9yYWdlU2VydmljZSA9IHtcbiAgICAgIHZhbGlkYXRlRmlsZTogamVzdC5mbigpLFxuICAgICAgdXBsb2FkRmlsZTogamVzdC5mbigpLFxuICAgICAgZ2V0U3VwcG9ydGVkQnVja2V0czogamVzdC5mbigpLFxuICAgIH07XG5cbiAgICBjb25zdCBtb2NrUm9sZVV0aWxzID0ge1xuICAgICAgaXNVc2VyQWRtaW46IGplc3QuZm4oKSxcbiAgICB9O1xuXG4gICAgbW9ja0p3dEF1dGhHdWFyZCA9IHtcbiAgICAgIGNhbkFjdGl2YXRlOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHRydWUpLFxuICAgIH0gYXMgYW55O1xuXG4gICAgbW9ja0FkbWluQXV0aEd1YXJkID0ge1xuICAgICAgY2FuQWN0aXZhdGU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUodHJ1ZSksXG4gICAgfSBhcyBhbnk7XG5cbiAgICAvLyBBZGQgc3RhdGljIG1ldGhvZCBtb2NrXG4gICAgU3VwYWJhc2VTdG9yYWdlU2VydmljZS5nZXRTdXBwb3J0ZWRCdWNrZXRzID0gamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICBVU0VSX1BST0ZJTEVTOiAndXNlci1wcm9maWxlcycsXG4gICAgfSk7XG5cbiAgICBjb25zdCBtb2R1bGU6IFRlc3RpbmdNb2R1bGUgPSBhd2FpdCBUZXN0LmNyZWF0ZVRlc3RpbmdNb2R1bGUoe1xuICAgICAgY29udHJvbGxlcnM6IFtVc2Vyc0NvbnRyb2xsZXJdLFxuICAgICAgcHJvdmlkZXJzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlOiBVc2Vyc1NlcnZpY2UsXG4gICAgICAgICAgdXNlVmFsdWU6IG1vY2tVc2Vyc1NlcnZpY2UsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlOiBTdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlLFxuICAgICAgICAgIHVzZVZhbHVlOiBtb2NrU3VwYWJhc2VTdG9yYWdlU2VydmljZSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHByb3ZpZGU6IFJvbGVVdGlscyxcbiAgICAgICAgICB1c2VWYWx1ZTogbW9ja1JvbGVVdGlscyxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHByb3ZpZGU6IExvZ2dlcixcbiAgICAgICAgICB1c2VWYWx1ZToge1xuICAgICAgICAgICAgbG9nOiBqZXN0LmZuKCksXG4gICAgICAgICAgICBlcnJvcjogamVzdC5mbigpLFxuICAgICAgICAgICAgd2FybjogamVzdC5mbigpLFxuICAgICAgICAgICAgZGVidWc6IGplc3QuZm4oKSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICB9KVxuICAgICAgLm92ZXJyaWRlR3VhcmQoSnd0QXV0aEd1YXJkKVxuICAgICAgLnVzZVZhbHVlKG1vY2tKd3RBdXRoR3VhcmQpXG4gICAgICAub3ZlcnJpZGVHdWFyZChBZG1pbkF1dGhHdWFyZClcbiAgICAgIC51c2VWYWx1ZShtb2NrQWRtaW5BdXRoR3VhcmQpXG4gICAgICAuY29tcGlsZSgpO1xuXG4gICAgY29udHJvbGxlciA9IG1vZHVsZS5nZXQ8VXNlcnNDb250cm9sbGVyPihVc2Vyc0NvbnRyb2xsZXIpO1xuICAgIHVzZXJzU2VydmljZSA9IG1vZHVsZS5nZXQ8VXNlcnNTZXJ2aWNlPihVc2Vyc1NlcnZpY2UpO1xuICAgIHN1cGFiYXNlU3RvcmFnZVNlcnZpY2UgPSBtb2R1bGUuZ2V0PFN1cGFiYXNlU3RvcmFnZVNlcnZpY2U+KFN1cGFiYXNlU3RvcmFnZVNlcnZpY2UpO1xuICAgIHJvbGVVdGlscyA9IG1vZHVsZS5nZXQ8Um9sZVV0aWxzPihSb2xlVXRpbHMpO1xuICB9KTtcblxuICBhZnRlckVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICB9KTtcblxuICBkZXNjcmliZSgnZmluZEFsbCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiBhbGwgdXNlcnMgZm9yIGFkbWluJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgamVzdC5zcHlPbih1c2Vyc1NlcnZpY2UsICdmaW5kQWxsJykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXJzKTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmZpbmRBbGwoVEVTVF9VU0VSX0lEUy5BRE1JTik7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHVzZXJzU2VydmljZS5maW5kQWxsKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKG1vY2tVc2Vycyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzZXJ2aWNlIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCdEYXRhYmFzZSBlcnJvcicpO1xuICAgICAgamVzdC5zcHlPbih1c2Vyc1NlcnZpY2UsICdmaW5kQWxsJykubW9ja1JlamVjdGVkVmFsdWUoZXJyb3IpO1xuXG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChjb250cm9sbGVyLmZpbmRBbGwoVEVTVF9VU0VSX0lEUy5BRE1JTikpLnJlamVjdHMudG9UaHJvdyhIdHRwRXhjZXB0aW9uKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2ZpbmRBbGxJbmNsdWRlSW5hY3RpdmUnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gYWxsIHVzZXJzIGluY2x1ZGluZyBpbmFjdGl2ZSBmb3IgYWRtaW4nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrVXNlcnMgPSBbXG4gICAgICAgIFRlc3REYXRhR2VuZXJhdG9yLmNyZWF0ZVVzZXIoeyBpc0FjdGl2ZTogdHJ1ZSB9KSxcbiAgICAgICAgVGVzdERhdGFHZW5lcmF0b3IuY3JlYXRlVXNlcih7IGlzQWN0aXZlOiBmYWxzZSB9KSxcbiAgICAgIF07XG5cbiAgICAgIHVzZXJzU2VydmljZS5maW5kQWxsSW5jbHVkZUluYWN0aXZlLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVc2VycyBhcyBhbnkpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmZpbmRBbGxJbmNsdWRlSW5hY3RpdmUoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQURNSU4sXG4gICAgICApO1xuXG4gICAgICBleHBlY3QodXNlcnNTZXJ2aWNlLmZpbmRBbGxJbmNsdWRlSW5hY3RpdmUpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja1VzZXJzKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHNlcnZpY2UgZXJyb3JzIHdoZW4gZmV0Y2hpbmcgYWxsIHVzZXJzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgdXNlcnNTZXJ2aWNlLmZpbmRBbGxJbmNsdWRlSW5hY3RpdmUubW9ja1JlamVjdGVkVmFsdWUoXG4gICAgICAgIG5ldyBFcnJvcignRGF0YWJhc2UgY29ubmVjdGlvbiBmYWlsZWQnKSxcbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5maW5kQWxsSW5jbHVkZUluYWN0aXZlKFRFU1RfVVNFUl9JRFMuQURNSU4pLFxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coSHR0cEV4Y2VwdGlvbik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdmaW5kT25lJywgKCkgPT4ge1xuICAgIGNvbnN0IG1vY2tVc2VyID0gVGVzdERhdGFHZW5lcmF0b3IuY3JlYXRlVXNlcih7IGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCB9KTtcblxuICAgIGl0KCdzaG91bGQgYWxsb3cgdXNlciB0byB2aWV3IHRoZWlyIG93biBwcm9maWxlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKGZhbHNlKTtcbiAgICAgIHVzZXJzU2VydmljZS5maW5kT25lLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVc2VyIGFzIGFueSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZmluZE9uZShcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHJvbGVVdGlscy5pc1VzZXJBZG1pbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoVEVTVF9VU0VSX0lEUy5DTElFTlQpO1xuICAgICAgZXhwZWN0KHVzZXJzU2VydmljZS5maW5kT25lKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChURVNUX1VTRVJfSURTLkNMSUVOVCk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKG1vY2tVc2VyKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYWxsb3cgYWRtaW4gdG8gdmlldyBhbnkgdXNlciBwcm9maWxlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKHRydWUpO1xuICAgICAgdXNlcnNTZXJ2aWNlLmZpbmRPbmVJbmNsdWRlSW5hY3RpdmUubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXIgYXMgYW55KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5maW5kT25lKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5BRE1JTixcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyb2xlVXRpbHMuaXNVc2VyQWRtaW4pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFRFU1RfVVNFUl9JRFMuQURNSU4pO1xuICAgICAgZXhwZWN0KHVzZXJzU2VydmljZS5maW5kT25lSW5jbHVkZUluYWN0aXZlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICApO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2NrVXNlcik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IEZvcmJpZGRlbkV4Y2VwdGlvbiB3aGVuIG5vbi1hZG1pbiB0cmllcyB0byB2aWV3IG90aGVyIHVzZXInLCBhc3luYyAoKSA9PiB7XG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoZmFsc2UpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIuZmluZE9uZShURVNUX1VTRVJfSURTLlRIRVJBUElTVCwgVEVTVF9VU0VSX0lEUy5DTElFTlQpLFxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coRm9yYmlkZGVuRXhjZXB0aW9uKTtcblxuICAgICAgZXhwZWN0KHVzZXJzU2VydmljZS5maW5kT25lKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0aHJvdyBIdHRwRXhjZXB0aW9uIHdoZW4gdXNlciBub3QgZm91bmQnLCBhc3luYyAoKSA9PiB7XG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoZmFsc2UpO1xuICAgICAgdXNlcnNTZXJ2aWNlLmZpbmRPbmUubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5maW5kT25lKFRFU1RfVVNFUl9JRFMuQ0xJRU5ULCBURVNUX1VTRVJfSURTLkNMSUVOVCksXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhIdHRwRXhjZXB0aW9uKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3VwZGF0ZScsICgpID0+IHtcbiAgICBjb25zdCB1cGRhdGVEYXRhID0ge1xuICAgICAgZmlyc3ROYW1lOiAnVXBkYXRlZCcsXG4gICAgICBsYXN0TmFtZTogJ05hbWUnLFxuICAgICAgYmlvOiAnVXBkYXRlZCBiaW8nLFxuICAgIH07XG5cbiAgICBpdCgnc2hvdWxkIGFsbG93IHVzZXIgdG8gdXBkYXRlIHRoZWlyIG93biBwcm9maWxlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdXBkYXRlZFVzZXIgPSB7IC4uLlRlc3REYXRhR2VuZXJhdG9yLmNyZWF0ZVVzZXIoKSwgLi4udXBkYXRlRGF0YSB9O1xuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKGZhbHNlKTtcbiAgICAgIHVzZXJzU2VydmljZS51cGRhdGUubW9ja1Jlc29sdmVkVmFsdWUodXBkYXRlZFVzZXIgYXMgYW55KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci51cGRhdGUoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICB1cGRhdGVEYXRhLFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyb2xlVXRpbHMuaXNVc2VyQWRtaW4pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFRFU1RfVVNFUl9JRFMuQ0xJRU5UKTtcbiAgICAgIGV4cGVjdCh1c2Vyc1NlcnZpY2UudXBkYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgIHVwZGF0ZURhdGEsXG4gICAgICApO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh1cGRhdGVkVXNlcik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFsbG93IGFkbWluIHRvIHVwZGF0ZSBhbnkgdXNlciB3aXRoIGFsbCBmaWVsZHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBhZG1pblVwZGF0ZURhdGEgPSB7XG4gICAgICAgIGZpcnN0TmFtZTogJ0FkbWluIFVwZGF0ZWQnLFxuICAgICAgICByb2xlOiAnbW9kZXJhdG9yJyxcbiAgICAgICAgaXNBY3RpdmU6IGZhbHNlLFxuICAgICAgfTtcbiAgICAgIGNvbnN0IHVwZGF0ZWRVc2VyID0ge1xuICAgICAgICAuLi5UZXN0RGF0YUdlbmVyYXRvci5jcmVhdGVVc2VyKCksXG4gICAgICAgIC4uLmFkbWluVXBkYXRlRGF0YSxcbiAgICAgIH07XG5cbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZSh0cnVlKTtcbiAgICAgIHVzZXJzU2VydmljZS51cGRhdGUubW9ja1Jlc29sdmVkVmFsdWUodXBkYXRlZFVzZXIgYXMgYW55KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci51cGRhdGUoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICBhZG1pblVwZGF0ZURhdGEsXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQURNSU4sXG4gICAgICApO1xuXG4gICAgICBleHBlY3QodXNlcnNTZXJ2aWNlLnVwZGF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICBhZG1pblVwZGF0ZURhdGEsXG4gICAgICApO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh1cGRhdGVkVXNlcik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHNhbml0aXplIG5vbi1hZG1pbiB1cGRhdGVzIHRvIGFsbG93ZWQgZmllbGRzIG9ubHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB1bmF1dGhvcml6ZWREYXRhID0ge1xuICAgICAgICBmaXJzdE5hbWU6ICdKb2huJyxcbiAgICAgICAgcm9sZTogJ2FkbWluJywgLy8gU2hvdWxkIGJlIGZpbHRlcmVkIG91dFxuICAgICAgICBpc0FjdGl2ZTogZmFsc2UsIC8vIFNob3VsZCBiZSBmaWx0ZXJlZCBvdXRcbiAgICAgICAgYmlvOiAnTmV3IGJpbycsXG4gICAgICB9O1xuICAgICAgY29uc3Qgc2FuaXRpemVkRGF0YSA9IHtcbiAgICAgICAgZmlyc3ROYW1lOiAnSm9obicsXG4gICAgICAgIGJpbzogJ05ldyBiaW8nLFxuICAgICAgfTtcbiAgICAgIGNvbnN0IHVwZGF0ZWRVc2VyID0ge1xuICAgICAgICAuLi5UZXN0RGF0YUdlbmVyYXRvci5jcmVhdGVVc2VyKCksXG4gICAgICAgIC4uLnNhbml0aXplZERhdGEsXG4gICAgICB9O1xuXG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoZmFsc2UpO1xuICAgICAgdXNlcnNTZXJ2aWNlLnVwZGF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh1cGRhdGVkVXNlciBhcyBhbnkpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLnVwZGF0ZShcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgIHVuYXV0aG9yaXplZERhdGEsXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHVzZXJzU2VydmljZS51cGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgc2FuaXRpemVkRGF0YSxcbiAgICAgICk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHVwZGF0ZWRVc2VyKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdGhyb3cgRm9yYmlkZGVuRXhjZXB0aW9uIHdoZW4gbm9uLWFkbWluIHRyaWVzIHRvIHVwZGF0ZSBvdGhlciB1c2VyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKGZhbHNlKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLnVwZGF0ZShcbiAgICAgICAgICBURVNUX1VTRVJfSURTLlRIRVJBUElTVCxcbiAgICAgICAgICB1cGRhdGVEYXRhLFxuICAgICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICApLFxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coRm9yYmlkZGVuRXhjZXB0aW9uKTtcblxuICAgICAgZXhwZWN0KHVzZXJzU2VydmljZS51cGRhdGUpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdyZW1vdmUnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBhbGxvdyB1c2VyIHRvIGRlYWN0aXZhdGUgdGhlaXIgb3duIGFjY291bnQnLCBhc3luYyAoKSA9PiB7XG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoZmFsc2UpO1xuICAgICAgdXNlcnNTZXJ2aWNlLnJlbW92ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7fSBhcyBhbnkpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLnJlbW92ZShcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHJvbGVVdGlscy5pc1VzZXJBZG1pbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoVEVTVF9VU0VSX0lEUy5DTElFTlQpO1xuICAgICAgZXhwZWN0KHVzZXJzU2VydmljZS5yZW1vdmUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFRFU1RfVVNFUl9JRFMuQ0xJRU5UKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoe1xuICAgICAgICBtZXNzYWdlOiAnVXNlciBhY2NvdW50IGRlYWN0aXZhdGVkIHN1Y2Nlc3NmdWxseScsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYWxsb3cgYWRtaW4gdG8gZGVhY3RpdmF0ZSBhbnkgdXNlciBhY2NvdW50JywgYXN5bmMgKCkgPT4ge1xuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKHRydWUpO1xuICAgICAgdXNlcnNTZXJ2aWNlLnJlbW92ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7fSBhcyBhbnkpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLnJlbW92ZShcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQURNSU4sXG4gICAgICApO1xuXG4gICAgICBleHBlY3QodXNlcnNTZXJ2aWNlLnJlbW92ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoVEVTVF9VU0VSX0lEUy5DTElFTlQpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7XG4gICAgICAgIG1lc3NhZ2U6ICdVc2VyIGFjY291bnQgZGVhY3RpdmF0ZWQgc3VjY2Vzc2Z1bGx5JyxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0aHJvdyBGb3JiaWRkZW5FeGNlcHRpb24gd2hlbiBub24tYWRtaW4gdHJpZXMgdG8gZGVhY3RpdmF0ZSBvdGhlciB1c2VyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKGZhbHNlKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLnJlbW92ZShURVNUX1VTRVJfSURTLlRIRVJBUElTVCwgVEVTVF9VU0VSX0lEUy5DTElFTlQpLFxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coRm9yYmlkZGVuRXhjZXB0aW9uKTtcblxuICAgICAgZXhwZWN0KHVzZXJzU2VydmljZS5yZW1vdmUpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdkZWFjdGl2YXRlVXNlciAoYWRtaW4gb25seSknLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBhbGxvdyBhZG1pbiB0byBkZWFjdGl2YXRlIHVzZXIgd2l0aCByZWFzb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBkZWFjdGl2YXRpb25Cb2R5ID0geyByZWFzb246ICdQb2xpY3kgdmlvbGF0aW9uJyB9O1xuICAgICAgdXNlcnNTZXJ2aWNlLmRlYWN0aXZhdGUubW9ja1Jlc29sdmVkVmFsdWUoe30gYXMgYW55KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5kZWFjdGl2YXRlVXNlcihcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgIGRlYWN0aXZhdGlvbkJvZHksXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQURNSU4sXG4gICAgICApO1xuXG4gICAgICBleHBlY3QodXNlcnNTZXJ2aWNlLmRlYWN0aXZhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgJ1BvbGljeSB2aW9sYXRpb24nLFxuICAgICAgICBURVNUX1VTRVJfSURTLkFETUlOLFxuICAgICAgKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoe1xuICAgICAgICBtZXNzYWdlOiAnVXNlciBhY2NvdW50IGRlYWN0aXZhdGVkIGJ5IGFkbWluaXN0cmF0b3InLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBkZWFjdGl2YXRpb24gd2l0aG91dCByZWFzb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBkZWFjdGl2YXRpb25Cb2R5ID0ge307XG4gICAgICB1c2Vyc1NlcnZpY2UuZGVhY3RpdmF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7fSBhcyBhbnkpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmRlYWN0aXZhdGVVc2VyKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgZGVhY3RpdmF0aW9uQm9keSxcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5BRE1JTixcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdCh1c2Vyc1NlcnZpY2UuZGVhY3RpdmF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQURNSU4sXG4gICAgICApO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7XG4gICAgICAgIG1lc3NhZ2U6ICdVc2VyIGFjY291bnQgZGVhY3RpdmF0ZWQgYnkgYWRtaW5pc3RyYXRvcicsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHNlcnZpY2UgZXJyb3JzIGR1cmluZyBkZWFjdGl2YXRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBkZWFjdGl2YXRpb25Cb2R5ID0geyByZWFzb246ICdUZXN0IHJlYXNvbicgfTtcbiAgICAgIHVzZXJzU2VydmljZS5kZWFjdGl2YXRlLm1vY2tSZWplY3RlZFZhbHVlKG5ldyBFcnJvcignU2VydmljZSBlcnJvcicpKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLmRlYWN0aXZhdGVVc2VyKFxuICAgICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICAgIGRlYWN0aXZhdGlvbkJvZHksXG4gICAgICAgICAgVEVTVF9VU0VSX0lEUy5BRE1JTixcbiAgICAgICAgKSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KEh0dHBFeGNlcHRpb24pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgncmVhY3RpdmF0ZVVzZXIgKGFkbWluIG9ubHkpJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgYWxsb3cgYWRtaW4gdG8gcmVhY3RpdmF0ZSB1c2VyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgdXNlcnNTZXJ2aWNlLnJlYWN0aXZhdGUubW9ja1Jlc29sdmVkVmFsdWUoe30gYXMgYW55KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5yZWFjdGl2YXRlVXNlcihcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQURNSU4sXG4gICAgICApO1xuXG4gICAgICBleHBlY3QodXNlcnNTZXJ2aWNlLnJlYWN0aXZhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHtcbiAgICAgICAgbWVzc2FnZTogJ1VzZXIgYWNjb3VudCByZWFjdGl2YXRlZCBzdWNjZXNzZnVsbHknLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzZXJ2aWNlIGVycm9ycyBkdXJpbmcgcmVhY3RpdmF0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgdXNlcnNTZXJ2aWNlLnJlYWN0aXZhdGUubW9ja1JlamVjdGVkVmFsdWUoXG4gICAgICAgIG5ldyBFcnJvcignUmVhY3RpdmF0aW9uIGZhaWxlZCcpLFxuICAgICAgKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLnJlYWN0aXZhdGVVc2VyKFRFU1RfVVNFUl9JRFMuQ0xJRU5ULCBURVNUX1VTRVJfSURTLkFETUlOKSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KEh0dHBFeGNlcHRpb24pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZXJyb3IgaGFuZGxpbmcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBwcmVzZXJ2ZSBGb3JiaWRkZW5FeGNlcHRpb24gZnJvbSBzZXJ2aWNlIGxheWVyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKHRydWUpO1xuICAgICAgdXNlcnNTZXJ2aWNlLmZpbmRPbmVJbmNsdWRlSW5hY3RpdmUubW9ja1JlamVjdGVkVmFsdWUoXG4gICAgICAgIG5ldyBGb3JiaWRkZW5FeGNlcHRpb24oJ0FjY2VzcyBkZW5pZWQnKSxcbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5maW5kT25lKFRFU1RfVVNFUl9JRFMuQ0xJRU5ULCBURVNUX1VTRVJfSURTLkFETUlOKSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KEZvcmJpZGRlbkV4Y2VwdGlvbik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHdyYXAgZ2VuZXJpYyBlcnJvcnMgaW4gSHR0cEV4Y2VwdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7XG4gICAgICB1c2Vyc1NlcnZpY2UuZmluZE9uZS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ0dlbmVyaWMgZXJyb3InKSk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5maW5kT25lKFRFU1RfVVNFUl9JRFMuQ0xJRU5ULCBURVNUX1VTRVJfSURTLkNMSUVOVCksXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhIdHRwRXhjZXB0aW9uKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHJvbGUgdXRpbHMgZXJyb3JzIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdSb2xlIGNoZWNrIGZhaWxlZCcpKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLmZpbmRPbmUoVEVTVF9VU0VSX0lEUy5DTElFTlQsIFRFU1RfVVNFUl9JRFMuQ0xJRU5UKSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KEh0dHBFeGNlcHRpb24pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnYXV0aG9yaXphdGlvbiBlZGdlIGNhc2VzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIGVtcHR5IHVwZGF0ZSBkYXRhIGZvciBub24tYWRtaW4nLCBhc3luYyAoKSA9PiB7XG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoZmFsc2UpO1xuICAgICAgdXNlcnNTZXJ2aWNlLnVwZGF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZShcbiAgICAgICAgVGVzdERhdGFHZW5lcmF0b3IuY3JlYXRlVXNlcigpIGFzIGFueSxcbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IGNvbnRyb2xsZXIudXBkYXRlKFRFU1RfVVNFUl9JRFMuQ0xJRU5ULCB7fSwgVEVTVF9VU0VSX0lEUy5DTElFTlQpO1xuXG4gICAgICBleHBlY3QodXNlcnNTZXJ2aWNlLnVwZGF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICB7fSxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBtaXhlZCBhbGxvd2VkIGFuZCBkaXNhbGxvd2VkIGZpZWxkcyBmb3Igbm9uLWFkbWluJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbWl4ZWREYXRhID0ge1xuICAgICAgICBmaXJzdE5hbWU6ICdKb2huJywgLy8gQWxsb3dlZFxuICAgICAgICBsYXN0TmFtZTogJ0RvZScsIC8vIEFsbG93ZWRcbiAgICAgICAgcm9sZTogJ2FkbWluJywgLy8gTm90IGFsbG93ZWRcbiAgICAgICAgYmlvOiAnTmV3IGJpbycsIC8vIEFsbG93ZWRcbiAgICAgICAgaXNBY3RpdmU6IGZhbHNlLCAvLyBOb3QgYWxsb3dlZFxuICAgICAgICBhdmF0YXJVcmw6ICdodHRwOi8vZXhhbXBsZS5jb20vYXZhdGFyLmpwZycsIC8vIEFsbG93ZWRcbiAgICAgIH07XG4gICAgICBjb25zdCBleHBlY3RlZFNhbml0aXplZERhdGEgPSB7XG4gICAgICAgIGZpcnN0TmFtZTogJ0pvaG4nLFxuICAgICAgICBsYXN0TmFtZTogJ0RvZScsXG4gICAgICAgIGJpbzogJ05ldyBiaW8nLFxuICAgICAgICBhdmF0YXJVcmw6ICdodHRwOi8vZXhhbXBsZS5jb20vYXZhdGFyLmpwZycsXG4gICAgICB9O1xuXG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoZmFsc2UpO1xuICAgICAgdXNlcnNTZXJ2aWNlLnVwZGF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZShcbiAgICAgICAgVGVzdERhdGFHZW5lcmF0b3IuY3JlYXRlVXNlcigpIGFzIGFueSxcbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IGNvbnRyb2xsZXIudXBkYXRlKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgbWl4ZWREYXRhLFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdCh1c2Vyc1NlcnZpY2UudXBkYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgIGV4cGVjdGVkU2FuaXRpemVkRGF0YSxcbiAgICAgICk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdGaWxlIFVwbG9hZCBJbnRlZ3JhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBhdmF0YXIgdXBsb2FkIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IG1vY2tGaWxlcyA9IHtcbiAgICAgICAgYXZhdGFyOiBbbW9ja0ZpbGVdLFxuICAgICAgfTtcbiAgICAgIGNvbnN0IHVwZGF0ZURhdGEgPSB7XG4gICAgICAgIGZpcnN0TmFtZTogJ0pvaG4nLFxuICAgICAgICBsYXN0TmFtZTogJ0RvZScsXG4gICAgICB9O1xuXG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoZmFsc2UpO1xuICAgICAgc3VwYWJhc2VTdG9yYWdlU2VydmljZS52YWxpZGF0ZUZpbGUubW9ja1JldHVyblZhbHVlKHsgaXNWYWxpZDogdHJ1ZSB9KTtcbiAgICAgIHN1cGFiYXNlU3RvcmFnZVNlcnZpY2UudXBsb2FkRmlsZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXBsb2FkUmVzdWx0KTtcbiAgICAgIHVzZXJzU2VydmljZS51cGRhdGUubW9ja1Jlc29sdmVkVmFsdWUoXG4gICAgICAgIFRlc3REYXRhR2VuZXJhdG9yLmNyZWF0ZVVzZXIoKSBhcyBhbnksXG4gICAgICApO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGF3YWl0IGNvbnRyb2xsZXIudXBkYXRlKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgdXBkYXRlRGF0YSxcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgIG1vY2tGaWxlcyxcbiAgICAgICk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHN1cGFiYXNlU3RvcmFnZVNlcnZpY2UudmFsaWRhdGVGaWxlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChtb2NrRmlsZSk7XG4gICAgICBleHBlY3Qoc3VwYWJhc2VTdG9yYWdlU2VydmljZS51cGxvYWRGaWxlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgbW9ja0ZpbGUsXG4gICAgICAgICd1c2VyLXByb2ZpbGVzJyxcbiAgICAgICk7XG4gICAgICBleHBlY3QodXNlcnNTZXJ2aWNlLnVwZGF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICB7XG4gICAgICAgICAgLi4udXBkYXRlRGF0YSxcbiAgICAgICAgICBhdmF0YXJVcmw6IG1vY2tVcGxvYWRSZXN1bHQudXJsLFxuICAgICAgICB9LFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvdmVyIGltYWdlIHVwbG9hZCBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBtb2NrQ292ZXJGaWxlID0ge1xuICAgICAgICAuLi5tb2NrRmlsZSxcbiAgICAgICAgZmllbGRuYW1lOiAnY292ZXInLFxuICAgICAgICBvcmlnaW5hbG5hbWU6ICdjb3Zlci5qcGcnLFxuICAgICAgfTtcbiAgICAgIGNvbnN0IG1vY2tGaWxlcyA9IHtcbiAgICAgICAgY292ZXI6IFttb2NrQ292ZXJGaWxlXSxcbiAgICAgIH07XG4gICAgICBjb25zdCB1cGRhdGVEYXRhID0ge1xuICAgICAgICBmaXJzdE5hbWU6ICdKb2huJyxcbiAgICAgICAgbGFzdE5hbWU6ICdEb2UnLFxuICAgICAgfTtcblxuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKGZhbHNlKTtcbiAgICAgIHN1cGFiYXNlU3RvcmFnZVNlcnZpY2UudmFsaWRhdGVGaWxlLm1vY2tSZXR1cm5WYWx1ZSh7IGlzVmFsaWQ6IHRydWUgfSk7XG4gICAgICBzdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlLnVwbG9hZEZpbGUubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VwbG9hZFJlc3VsdCk7XG4gICAgICB1c2Vyc1NlcnZpY2UudXBkYXRlLm1vY2tSZXNvbHZlZFZhbHVlKFxuICAgICAgICBUZXN0RGF0YUdlbmVyYXRvci5jcmVhdGVVc2VyKCkgYXMgYW55LFxuICAgICAgKTtcblxuICAgICAgLy8gQWN0XG4gICAgICBhd2FpdCBjb250cm9sbGVyLnVwZGF0ZShcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgIHVwZGF0ZURhdGEsXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICBtb2NrRmlsZXMsXG4gICAgICApO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChzdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlLnZhbGlkYXRlRmlsZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgobW9ja0NvdmVyRmlsZSk7XG4gICAgICBleHBlY3Qoc3VwYWJhc2VTdG9yYWdlU2VydmljZS51cGxvYWRGaWxlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgbW9ja0NvdmVyRmlsZSxcbiAgICAgICAgJ3VzZXItcHJvZmlsZXMnLFxuICAgICAgKTtcbiAgICAgIGV4cGVjdCh1c2Vyc1NlcnZpY2UudXBkYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgIHtcbiAgICAgICAgICAuLi51cGRhdGVEYXRhLFxuICAgICAgICAgIGNvdmVySW1hZ2VVcmw6IG1vY2tVcGxvYWRSZXN1bHQudXJsLFxuICAgICAgICB9LFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG11bHRpcGxlIGZpbGUgdXBsb2FkcyBzaW11bHRhbmVvdXNseScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IG1vY2tDb3ZlckZpbGUgPSB7XG4gICAgICAgIC4uLm1vY2tGaWxlLFxuICAgICAgICBmaWVsZG5hbWU6ICdjb3ZlcicsXG4gICAgICAgIG9yaWdpbmFsbmFtZTogJ2NvdmVyLmpwZycsXG4gICAgICB9O1xuICAgICAgY29uc3QgbW9ja0ZpbGVzID0ge1xuICAgICAgICBhdmF0YXI6IFttb2NrRmlsZV0sXG4gICAgICAgIGNvdmVyOiBbbW9ja0NvdmVyRmlsZV0sXG4gICAgICB9O1xuICAgICAgY29uc3QgdXBkYXRlRGF0YSA9IHtcbiAgICAgICAgZmlyc3ROYW1lOiAnSm9obicsXG4gICAgICAgIGxhc3ROYW1lOiAnRG9lJyxcbiAgICAgIH07XG5cbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7XG4gICAgICBzdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlLnZhbGlkYXRlRmlsZS5tb2NrUmV0dXJuVmFsdWUoeyBpc1ZhbGlkOiB0cnVlIH0pO1xuICAgICAgc3VwYWJhc2VTdG9yYWdlU2VydmljZS51cGxvYWRGaWxlLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVcGxvYWRSZXN1bHQpO1xuICAgICAgdXNlcnNTZXJ2aWNlLnVwZGF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZShcbiAgICAgICAgVGVzdERhdGFHZW5lcmF0b3IuY3JlYXRlVXNlcigpIGFzIGFueSxcbiAgICAgICk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgYXdhaXQgY29udHJvbGxlci51cGRhdGUoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICB1cGRhdGVEYXRhLFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgbW9ja0ZpbGVzLFxuICAgICAgKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3Qoc3VwYWJhc2VTdG9yYWdlU2VydmljZS52YWxpZGF0ZUZpbGUpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygyKTtcbiAgICAgIGV4cGVjdChzdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlLnVwbG9hZEZpbGUpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygyKTtcbiAgICAgIGV4cGVjdCh1c2Vyc1NlcnZpY2UudXBkYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgIHtcbiAgICAgICAgICAuLi51cGRhdGVEYXRhLFxuICAgICAgICAgIGF2YXRhclVybDogbW9ja1VwbG9hZFJlc3VsdC51cmwsXG4gICAgICAgICAgY292ZXJJbWFnZVVybDogbW9ja1VwbG9hZFJlc3VsdC51cmwsXG4gICAgICAgIH0sXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZmlsZSB2YWxpZGF0aW9uIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IG1vY2tGaWxlcyA9IHtcbiAgICAgICAgYXZhdGFyOiBbbW9ja0ZpbGVdLFxuICAgICAgfTtcbiAgICAgIGNvbnN0IHVwZGF0ZURhdGEgPSB7XG4gICAgICAgIGZpcnN0TmFtZTogJ0pvaG4nLFxuICAgICAgICBsYXN0TmFtZTogJ0RvZScsXG4gICAgICB9O1xuXG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoZmFsc2UpO1xuICAgICAgc3VwYWJhc2VTdG9yYWdlU2VydmljZS52YWxpZGF0ZUZpbGUubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgaXNWYWxpZDogZmFsc2UsXG4gICAgICAgIGVycm9yOiAnRmlsZSB0b28gbGFyZ2UnLFxuICAgICAgfSk7XG5cbiAgICAgIC8vIEFjdCAmIEFzc2VydFxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLnVwZGF0ZShcbiAgICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgICB1cGRhdGVEYXRhLFxuICAgICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICAgIG1vY2tGaWxlcyxcbiAgICAgICAgKSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KCdBdmF0YXIgdmFsaWRhdGlvbiBmYWlsZWQ6IEZpbGUgdG9vIGxhcmdlJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBmaWxlIHVwbG9hZCBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBtb2NrRmlsZXMgPSB7XG4gICAgICAgIGF2YXRhcjogW21vY2tGaWxlXSxcbiAgICAgIH07XG4gICAgICBjb25zdCB1cGRhdGVEYXRhID0ge1xuICAgICAgICBmaXJzdE5hbWU6ICdKb2huJyxcbiAgICAgICAgbGFzdE5hbWU6ICdEb2UnLFxuICAgICAgfTtcblxuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKGZhbHNlKTtcbiAgICAgIHN1cGFiYXNlU3RvcmFnZVNlcnZpY2UudmFsaWRhdGVGaWxlLm1vY2tSZXR1cm5WYWx1ZSh7IGlzVmFsaWQ6IHRydWUgfSk7XG4gICAgICBzdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlLnVwbG9hZEZpbGUubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdVcGxvYWQgZmFpbGVkJykpO1xuXG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci51cGRhdGUoXG4gICAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgICAgdXBkYXRlRGF0YSxcbiAgICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgICBtb2NrRmlsZXMsXG4gICAgICAgICksXG4gICAgICApLnJlamVjdHMudG9UaHJvdygnRmFpbGVkIHRvIHVwZGF0ZSB1c2VyOiBVcGxvYWQgZmFpbGVkJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdTZWN1cml0eSBUZXN0cycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIGlucHV0IGRhdGEgdGhyb3VnaCBab2RWYWxpZGF0aW9uUGlwZScsICgpID0+IHtcbiAgICAgIC8vIFRoaXMgdGVzdHMgdGhhdCB0aGUgY29udHJvbGxlciB1c2VzIHByb3BlciB2YWxpZGF0aW9uXG4gICAgICBjb25zdCB2YWxpZGF0aW9uUGlwZSA9IG5ldyBab2RWYWxpZGF0aW9uUGlwZSh7fSBhcyBhbnkpO1xuICAgICAgZXhwZWN0KHZhbGlkYXRpb25QaXBlKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXF1aXJlIGF1dGhlbnRpY2F0aW9uIGZvciBhbGwgZW5kcG9pbnRzJywgKCkgPT4ge1xuICAgICAgLy8gVGVzdCB0aGF0IGFsbCBlbmRwb2ludHMgaGF2ZSBKd3RBdXRoR3VhcmRcbiAgICAgIGNvbnN0IHByb3RlY3RlZE1ldGhvZHMgPSBbJ2ZpbmRBbGwnLCAnZmluZEFsbEluY2x1ZGVJbmFjdGl2ZScsICdmaW5kT25lJywgJ3VwZGF0ZScsICdyZW1vdmUnLCAnZGVhY3RpdmF0ZVVzZXInLCAncmVhY3RpdmF0ZVVzZXInXTtcbiAgICAgIFxuICAgICAgcHJvdGVjdGVkTWV0aG9kcy5mb3JFYWNoKG1ldGhvZCA9PiB7XG4gICAgICAgIGNvbnN0IGd1YXJkcyA9IFJlZmxlY3QuZ2V0TWV0YWRhdGEoJ19fZ3VhcmRzX18nLCBjb250cm9sbGVyW21ldGhvZCBhcyBrZXlvZiBVc2Vyc0NvbnRyb2xsZXJdKTtcbiAgICAgICAgZXhwZWN0KGd1YXJkcykudG9CZURlZmluZWQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBlbmZvcmNlIGFkbWluLW9ubHkgYWNjZXNzIGZvciBhZG1pbiBlbmRwb2ludHMnLCAoKSA9PiB7XG4gICAgICAvLyBUZXN0IHRoYXQgYWRtaW4gZW5kcG9pbnRzIGhhdmUgQWRtaW5BdXRoR3VhcmRcbiAgICAgIGNvbnN0IGFkbWluTWV0aG9kcyA9IFsnZmluZEFsbCcsICdmaW5kQWxsSW5jbHVkZUluYWN0aXZlJywgJ2RlYWN0aXZhdGVVc2VyJywgJ3JlYWN0aXZhdGVVc2VyJ107XG4gICAgICBcbiAgICAgIGFkbWluTWV0aG9kcy5mb3JFYWNoKG1ldGhvZCA9PiB7XG4gICAgICAgIGNvbnN0IGd1YXJkcyA9IFJlZmxlY3QuZ2V0TWV0YWRhdGEoJ19fZ3VhcmRzX18nLCBjb250cm9sbGVyW21ldGhvZCBhcyBrZXlvZiBVc2Vyc0NvbnRyb2xsZXJdKTtcbiAgICAgICAgZXhwZWN0KGd1YXJkcykudG9CZURlZmluZWQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgSldUIHRva2VuIHZhbGlkYXRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBUZXN0IHRoYXQgSldUIGd1YXJkIGlzIHByb3Blcmx5IGFwcGxpZWRcbiAgICAgIG1vY2tKd3RBdXRoR3VhcmQuY2FuQWN0aXZhdGUubW9ja1JldHVyblZhbHVlKGZhbHNlKTtcbiAgICAgIFxuICAgICAgLy8gTW9jayB0aGUgYWN0dWFsIEhUVFAgZXhjZXB0aW9uIHRoYXQgd291bGQgYmUgdGhyb3duXG4gICAgICBjb25zdCB1bmF1dGhvcml6ZWRFcnJvciA9IG5ldyBFcnJvcignVW5hdXRob3JpemVkJyk7XG4gICAgICB1c2Vyc1NlcnZpY2UuZmluZEFsbC5tb2NrUmVqZWN0ZWRWYWx1ZSh1bmF1dGhvcml6ZWRFcnJvcik7XG4gICAgICBcbiAgICAgIGF3YWl0IGV4cGVjdChjb250cm9sbGVyLmZpbmRBbGwoVEVTVF9VU0VSX0lEUy5BRE1JTikpLnJlamVjdHMudG9UaHJvdygpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgYWRtaW4gYXV0aG9yaXphdGlvbiB2YWxpZGF0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gVGVzdCB0aGF0IGFkbWluIGd1YXJkIGlzIHByb3Blcmx5IGFwcGxpZWRcbiAgICAgIG1vY2tBZG1pbkF1dGhHdWFyZC5jYW5BY3RpdmF0ZS5tb2NrUmV0dXJuVmFsdWUoZmFsc2UpO1xuICAgICAgXG4gICAgICAvLyBNb2NrIHRoZSBhY3R1YWwgSFRUUCBleGNlcHRpb24gdGhhdCB3b3VsZCBiZSB0aHJvd25cbiAgICAgIGNvbnN0IGZvcmJpZGRlbkVycm9yID0gbmV3IEVycm9yKCdGb3JiaWRkZW4nKTtcbiAgICAgIHVzZXJzU2VydmljZS5maW5kQWxsLm1vY2tSZWplY3RlZFZhbHVlKGZvcmJpZGRlbkVycm9yKTtcbiAgICAgIFxuICAgICAgYXdhaXQgZXhwZWN0KGNvbnRyb2xsZXIuZmluZEFsbChURVNUX1VTRVJfSURTLkFETUlOKSkucmVqZWN0cy50b1Rocm93KCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHByZXZlbnQgdW5hdXRob3JpemVkIGFjY2VzcyB0byBvdGhlciB1c2VyIHByb2ZpbGVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gVGVzdCB0aGF0IHVzZXJzIGNhbiBvbmx5IGFjY2VzcyB0aGVpciBvd24gcHJvZmlsZVxuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKGZhbHNlKTtcbiAgICAgIFxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLmZpbmRPbmUoVEVTVF9VU0VSX0lEUy5USEVSQVBJU1QsIFRFU1RfVVNFUl9JRFMuQ0xJRU5UKSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KEZvcmJpZGRlbkV4Y2VwdGlvbik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdSb2xlLWJhc2VkIEFjY2VzcyBDb250cm9sJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgdGVzdCByb2xlLWJhc2VkIGFjY2VzcyBmb3IgYWRtaW4gZW5kcG9pbnRzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gVGVzdCB0aGF0IGFkbWluIGVuZHBvaW50cyByZXF1aXJlIGFkbWluIHJvbGVcbiAgICAgIGF3YWl0IFJvbGVCYXNlZFRlc3RVdGlscy50ZXN0V2l0aFJvbGVzKFxuICAgICAgICBhc3luYyAodXNlcklkOiBzdHJpbmcsIHJvbGU6IHN0cmluZykgPT4ge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCBjb250cm9sbGVyLmZpbmRBbGwodXNlcklkKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgY2xpZW50OiBmYWxzZSxcbiAgICAgICAgICB0aGVyYXBpc3Q6IGZhbHNlLFxuICAgICAgICAgIGFkbWluOiB0cnVlLFxuICAgICAgICAgIG1vZGVyYXRvcjogZmFsc2UsXG4gICAgICAgIH0sXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSB1c2VyLXNwZWNpZmljIGZ1bmN0aW9uYWxpdHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBUZXN0IHRoYXQgdXNlcnMgY2FuIGFjY2VzcyB0aGVpciBvd24gcHJvZmlsZVxuICAgICAgY29uc3QgdXNlckNvbnRleHQgPSBNb2NrQnVpbGRlci5jcmVhdGVBdXRoQ29udGV4dCgnY2xpZW50Jyk7XG4gICAgICBcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7XG4gICAgICB1c2Vyc1NlcnZpY2UuZmluZE9uZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXNlciBhcyBhbnkpO1xuICAgICAgXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmZpbmRPbmUodXNlckNvbnRleHQudXNlcklkLCB1c2VyQ29udGV4dC51c2VySWQpO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5pZCkudG9CZSh1c2VyQ29udGV4dC51c2VySWQpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0ZXN0IGZpZWxkIHNhbml0aXphdGlvbiBmb3Igbm9uLWFkbWluIHVzZXJzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gVGVzdCB0aGF0IG5vbi1hZG1pbiB1c2VycyBjYW5ub3QgdXBkYXRlIHNlbnNpdGl2ZSBmaWVsZHNcbiAgICAgIGNvbnN0IHNlbnNpdGl2ZURhdGEgPSB7XG4gICAgICAgIGZpcnN0TmFtZTogJ0pvaG4nLFxuICAgICAgICByb2xlOiAnYWRtaW4nLCAvLyBTaG91bGQgYmUgZmlsdGVyZWQgb3V0XG4gICAgICAgIGlzQWN0aXZlOiBmYWxzZSwgLy8gU2hvdWxkIGJlIGZpbHRlcmVkIG91dFxuICAgICAgICBlbWFpbFZlcmlmaWVkOiB0cnVlLCAvLyBTaG91bGQgYmUgZmlsdGVyZWQgb3V0XG4gICAgICB9O1xuICAgICAgXG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoZmFsc2UpO1xuICAgICAgdXNlcnNTZXJ2aWNlLnVwZGF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXNlciBhcyBhbnkpO1xuICAgICAgXG4gICAgICBhd2FpdCBjb250cm9sbGVyLnVwZGF0ZShURVNUX1VTRVJfSURTLkNMSUVOVCwgc2Vuc2l0aXZlRGF0YSwgVEVTVF9VU0VSX0lEUy5DTElFTlQpO1xuICAgICAgXG4gICAgICBleHBlY3QodXNlcnNTZXJ2aWNlLnVwZGF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICB7IGZpcnN0TmFtZTogJ0pvaG4nIH0sIC8vIE9ubHkgYWxsb3dlZCBmaWVsZHNcbiAgICAgICk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdJbnRlZ3JhdGlvbiBUZXN0cycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBjb21wbGV0ZSB1c2VyIHByb2ZpbGUgdXBkYXRlIHdvcmtmbG93JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgdXBkYXRlRGF0YSA9IHtcbiAgICAgICAgZmlyc3ROYW1lOiAnVXBkYXRlZCcsXG4gICAgICAgIGxhc3ROYW1lOiAnTmFtZScsXG4gICAgICAgIGJpbzogJ1VwZGF0ZWQgYmlvJyxcbiAgICAgICAgdGltZXpvbmU6ICdBbWVyaWNhL0xvc19BbmdlbGVzJyxcbiAgICAgICAgbGFuZ3VhZ2U6ICdlbicsXG4gICAgICAgIHRoZW1lOiAnZGFyaycsXG4gICAgICB9O1xuICAgICAgY29uc3QgdXBkYXRlZFVzZXIgPSB7IC4uLm1vY2tVc2VyLCAuLi51cGRhdGVEYXRhIH07XG4gICAgICBcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7XG4gICAgICB1c2Vyc1NlcnZpY2UudXBkYXRlLm1vY2tSZXNvbHZlZFZhbHVlKHVwZGF0ZWRVc2VyIGFzIGFueSk7XG4gICAgICBcbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci51cGRhdGUoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICB1cGRhdGVEYXRhLFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICk7XG4gICAgICBcbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZmlyc3ROYW1lKS50b0JlKCdVcGRhdGVkJyk7XG4gICAgICBleHBlY3QocmVzdWx0Lmxhc3ROYW1lKS50b0JlKCdOYW1lJyk7XG4gICAgICBleHBlY3QocmVzdWx0LmJpbykudG9CZSgnVXBkYXRlZCBiaW8nKTtcbiAgICAgIGV4cGVjdChyZXN1bHQudGltZXpvbmUpLnRvQmUoJ0FtZXJpY2EvTG9zX0FuZ2VsZXMnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbXBsZXRlIGFkbWluIHVzZXIgbWFuYWdlbWVudCB3b3JrZmxvdycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZSh0cnVlKTtcbiAgICAgIHVzZXJzU2VydmljZS5maW5kQWxsLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVc2VycyBhcyBhbnkpO1xuICAgICAgdXNlcnNTZXJ2aWNlLmZpbmRBbGxJbmNsdWRlSW5hY3RpdmUubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXJzIGFzIGFueSk7XG4gICAgICB1c2Vyc1NlcnZpY2UuZmluZE9uZUluY2x1ZGVJbmFjdGl2ZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXNlciBhcyBhbnkpO1xuICAgICAgXG4gICAgICAvLyBBY3QgLSBHZXQgYWxsIHVzZXJzXG4gICAgICBjb25zdCBhbGxVc2VycyA9IGF3YWl0IGNvbnRyb2xsZXIuZmluZEFsbChURVNUX1VTRVJfSURTLkFETUlOKTtcbiAgICAgIFxuICAgICAgLy8gQWN0IC0gR2V0IGFsbCB1c2VycyBpbmNsdWRpbmcgaW5hY3RpdmVcbiAgICAgIGNvbnN0IGFsbFVzZXJzSW5jbHVkZUluYWN0aXZlID0gYXdhaXQgY29udHJvbGxlci5maW5kQWxsSW5jbHVkZUluYWN0aXZlKFRFU1RfVVNFUl9JRFMuQURNSU4pO1xuICAgICAgXG4gICAgICAvLyBBY3QgLSBWaWV3IHNwZWNpZmljIHVzZXJcbiAgICAgIGNvbnN0IHNwZWNpZmljVXNlciA9IGF3YWl0IGNvbnRyb2xsZXIuZmluZE9uZShURVNUX1VTRVJfSURTLkNMSUVOVCwgVEVTVF9VU0VSX0lEUy5BRE1JTik7XG4gICAgICBcbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KGFsbFVzZXJzKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGFsbFVzZXJzKS50b0hhdmVMZW5ndGgoMik7XG4gICAgICBcbiAgICAgIGV4cGVjdChhbGxVc2Vyc0luY2x1ZGVJbmFjdGl2ZSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChhbGxVc2Vyc0luY2x1ZGVJbmFjdGl2ZSkudG9IYXZlTGVuZ3RoKDIpO1xuICAgICAgXG4gICAgICBleHBlY3Qoc3BlY2lmaWNVc2VyKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHNwZWNpZmljVXNlci5pZCkudG9CZShURVNUX1VTRVJfSURTLkNMSUVOVCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBjb21wbGV0ZSB1c2VyIGRlYWN0aXZhdGlvbiB3b3JrZmxvdycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZSh0cnVlKTtcbiAgICAgIHVzZXJzU2VydmljZS5kZWFjdGl2YXRlLm1vY2tSZXNvbHZlZFZhbHVlKHt9IGFzIGFueSk7XG4gICAgICBcbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5kZWFjdGl2YXRlVXNlcihcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgIHsgcmVhc29uOiAnUG9saWN5IHZpb2xhdGlvbicgfSxcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5BRE1JTixcbiAgICAgICk7XG4gICAgICBcbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQubWVzc2FnZSkudG9CZSgnVXNlciBhY2NvdW50IGRlYWN0aXZhdGVkIGJ5IGFkbWluaXN0cmF0b3InKTtcbiAgICAgIGV4cGVjdCh1c2Vyc1NlcnZpY2UuZGVhY3RpdmF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICAnUG9saWN5IHZpb2xhdGlvbicsXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQURNSU4sXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgY29tcGxldGUgdXNlciByZWFjdGl2YXRpb24gd29ya2Zsb3cnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUodHJ1ZSk7XG4gICAgICB1c2Vyc1NlcnZpY2UucmVhY3RpdmF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7fSBhcyBhbnkpO1xuICAgICAgXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIucmVhY3RpdmF0ZVVzZXIoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICBURVNUX1VTRVJfSURTLkFETUlOLFxuICAgICAgKTtcbiAgICAgIFxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5tZXNzYWdlKS50b0JlKCdVc2VyIGFjY291bnQgcmVhY3RpdmF0ZWQgc3VjY2Vzc2Z1bGx5Jyk7XG4gICAgICBleHBlY3QodXNlcnNTZXJ2aWNlLnJlYWN0aXZhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFRFU1RfVVNFUl9JRFMuQ0xJRU5UKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0RhdGEgVmFsaWRhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIHVzZXIgdXBkYXRlIGRhdGEgc3RydWN0dXJlJywgKCkgPT4ge1xuICAgICAgLy8gVGVzdCB0aGF0IHdlJ3JlIHVzaW5nIHRoZSBjb3JyZWN0IERUTyBzdHJ1Y3R1cmVcbiAgICAgIGNvbnN0IHZhbGlkVXBkYXRlRGF0YSA9IHtcbiAgICAgICAgZmlyc3ROYW1lOiAnSm9obicsXG4gICAgICAgIGxhc3ROYW1lOiAnRG9lJyxcbiAgICAgICAgYmlvOiAnVXNlciBiaW8nLFxuICAgICAgICBhdmF0YXJVcmw6ICdodHRwczovL2V4YW1wbGUuY29tL2F2YXRhci5qcGcnLFxuICAgICAgICBjb3ZlckltYWdlVXJsOiAnaHR0cHM6Ly9leGFtcGxlLmNvbS9jb3Zlci5qcGcnLFxuICAgICAgICBwaG9uZU51bWJlcjogJysxMjM0NTY3ODkwJyxcbiAgICAgICAgdGltZXpvbmU6ICdBbWVyaWNhL05ld19Zb3JrJyxcbiAgICAgICAgbGFuZ3VhZ2U6ICdlbicsXG4gICAgICAgIHRoZW1lOiAnbGlnaHQnLFxuICAgICAgfTtcbiAgICAgIFxuICAgICAgLy8gVmVyaWZ5IGFsbCBmaWVsZHMgYXJlIGRlZmluZWRcbiAgICAgIGV4cGVjdCh2YWxpZFVwZGF0ZURhdGEuZmlyc3ROYW1lKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHZhbGlkVXBkYXRlRGF0YS5sYXN0TmFtZSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdCh2YWxpZFVwZGF0ZURhdGEuYmlvKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHZhbGlkVXBkYXRlRGF0YS5hdmF0YXJVcmwpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QodmFsaWRVcGRhdGVEYXRhLmNvdmVySW1hZ2VVcmwpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QodmFsaWRVcGRhdGVEYXRhLnBob25lTnVtYmVyKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHZhbGlkVXBkYXRlRGF0YS50aW1lem9uZSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdCh2YWxpZFVwZGF0ZURhdGEubGFuZ3VhZ2UpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QodmFsaWRVcGRhdGVEYXRhLnRoZW1lKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBkZWFjdGl2YXRpb24gZGF0YSBzdHJ1Y3R1cmUnLCAoKSA9PiB7XG4gICAgICAvLyBUZXN0IHRoYXQgd2UncmUgdXNpbmcgdGhlIGNvcnJlY3QgRFRPIHN0cnVjdHVyZVxuICAgICAgY29uc3QgdmFsaWREZWFjdGl2YXRpb25EYXRhID0ge1xuICAgICAgICByZWFzb246ICdQb2xpY3kgdmlvbGF0aW9uJyxcbiAgICAgIH07XG4gICAgICBcbiAgICAgIC8vIFZlcmlmeSBhbGwgZmllbGRzIGFyZSBkZWZpbmVkXG4gICAgICBleHBlY3QodmFsaWREZWFjdGl2YXRpb25EYXRhLnJlYXNvbikudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgdXNlciBJRCBwYXJhbWV0ZXIgc3RydWN0dXJlJywgKCkgPT4ge1xuICAgICAgLy8gVGVzdCB0aGF0IHdlJ3JlIHVzaW5nIHRoZSBjb3JyZWN0IHBhcmFtZXRlciBzdHJ1Y3R1cmVcbiAgICAgIGNvbnN0IHZhbGlkVXNlcklkUGFyYW0gPSB7XG4gICAgICAgIGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgIH07XG4gICAgICBcbiAgICAgIC8vIFZlcmlmeSBhbGwgZmllbGRzIGFyZSBkZWZpbmVkXG4gICAgICBleHBlY3QodmFsaWRVc2VySWRQYXJhbS5pZCkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1Jlc3BvbnNlIEZvcm1hdCBWYWxpZGF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvcnJlY3RseSBmb3JtYXR0ZWQgdXNlciBsaXN0IHJlc3BvbnNlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKHRydWUpO1xuICAgICAgdXNlcnNTZXJ2aWNlLmZpbmRBbGwubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXJzIGFzIGFueSk7XG4gICAgICBcbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5maW5kQWxsKFRFU1RfVVNFUl9JRFMuQURNSU4pO1xuICAgICAgXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVJbnN0YW5jZU9mKEFycmF5KTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZUxlbmd0aCgyKTtcbiAgICAgIFxuICAgICAgY29uc3QgdXNlciA9IHJlc3VsdFswXTtcbiAgICAgIGV4cGVjdCh1c2VyKS50b0hhdmVQcm9wZXJ0eSgnaWQnKTtcbiAgICAgIGV4cGVjdCh1c2VyKS50b0hhdmVQcm9wZXJ0eSgnZW1haWwnKTtcbiAgICAgIGV4cGVjdCh1c2VyKS50b0hhdmVQcm9wZXJ0eSgnZmlyc3ROYW1lJyk7XG4gICAgICBleHBlY3QodXNlcikudG9IYXZlUHJvcGVydHkoJ2xhc3ROYW1lJyk7XG4gICAgICBleHBlY3QodXNlcikudG9IYXZlUHJvcGVydHkoJ3JvbGUnKTtcbiAgICAgIGV4cGVjdCh1c2VyKS50b0hhdmVQcm9wZXJ0eSgnY3JlYXRlZEF0Jyk7XG4gICAgICBleHBlY3QodXNlcikudG9IYXZlUHJvcGVydHkoJ2lzQWN0aXZlJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBjb3JyZWN0bHkgZm9ybWF0dGVkIHVzZXIgcHJvZmlsZSByZXNwb25zZScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7XG4gICAgICB1c2Vyc1NlcnZpY2UuZmluZE9uZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXNlciBhcyBhbnkpO1xuICAgICAgXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZmluZE9uZShURVNUX1VTRVJfSURTLkNMSUVOVCwgVEVTVF9VU0VSX0lEUy5DTElFTlQpO1xuICAgICAgXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdpZCcpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ2VtYWlsJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgnZmlyc3ROYW1lJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgnbGFzdE5hbWUnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdyb2xlJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgnYmlvJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgnYXZhdGFyVXJsJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgnY292ZXJJbWFnZVVybCcpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ3Bob25lTnVtYmVyJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgndGltZXpvbmUnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdsYW5ndWFnZScpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ3RoZW1lJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgnY3JlYXRlZEF0Jyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgndXBkYXRlZEF0Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBjb3JyZWN0bHkgZm9ybWF0dGVkIHVwZGF0ZSByZXNwb25zZScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IHVwZGF0ZURhdGEgPSB7XG4gICAgICAgIGZpcnN0TmFtZTogJ1VwZGF0ZWQnLFxuICAgICAgICBsYXN0TmFtZTogJ05hbWUnLFxuICAgICAgfTtcbiAgICAgIGNvbnN0IHVwZGF0ZWRVc2VyID0geyAuLi5tb2NrVXNlciwgLi4udXBkYXRlRGF0YSB9O1xuICAgICAgXG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoZmFsc2UpO1xuICAgICAgdXNlcnNTZXJ2aWNlLnVwZGF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh1cGRhdGVkVXNlciBhcyBhbnkpO1xuICAgICAgXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIudXBkYXRlKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgdXBkYXRlRGF0YSxcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICApO1xuICAgICAgXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdpZCcpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ2VtYWlsJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgnZmlyc3ROYW1lJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgnbGFzdE5hbWUnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZmlyc3ROYW1lKS50b0JlKCdVcGRhdGVkJyk7XG4gICAgICBleHBlY3QocmVzdWx0Lmxhc3ROYW1lKS50b0JlKCdOYW1lJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBjb3JyZWN0bHkgZm9ybWF0dGVkIGRlYWN0aXZhdGlvbiByZXNwb25zZScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7XG4gICAgICB1c2Vyc1NlcnZpY2UucmVtb3ZlLm1vY2tSZXNvbHZlZFZhbHVlKHt9IGFzIGFueSk7XG4gICAgICBcbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5yZW1vdmUoVEVTVF9VU0VSX0lEUy5DTElFTlQsIFRFU1RfVVNFUl9JRFMuQ0xJRU5UKTtcbiAgICAgIFxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgnbWVzc2FnZScpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5tZXNzYWdlKS50b0JlKCdVc2VyIGFjY291bnQgZGVhY3RpdmF0ZWQgc3VjY2Vzc2Z1bGx5Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBjb3JyZWN0bHkgZm9ybWF0dGVkIGFkbWluIGRlYWN0aXZhdGlvbiByZXNwb25zZScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIHVzZXJzU2VydmljZS5kZWFjdGl2YXRlLm1vY2tSZXNvbHZlZFZhbHVlKHt9IGFzIGFueSk7XG4gICAgICBcbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5kZWFjdGl2YXRlVXNlcihcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgIHsgcmVhc29uOiAnUG9saWN5IHZpb2xhdGlvbicgfSxcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5BRE1JTixcbiAgICAgICk7XG4gICAgICBcbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ21lc3NhZ2UnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQubWVzc2FnZSkudG9CZSgnVXNlciBhY2NvdW50IGRlYWN0aXZhdGVkIGJ5IGFkbWluaXN0cmF0b3InKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvcnJlY3RseSBmb3JtYXR0ZWQgcmVhY3RpdmF0aW9uIHJlc3BvbnNlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgdXNlcnNTZXJ2aWNlLnJlYWN0aXZhdGUubW9ja1Jlc29sdmVkVmFsdWUoe30gYXMgYW55KTtcbiAgICAgIFxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLnJlYWN0aXZhdGVVc2VyKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5BRE1JTixcbiAgICAgICk7XG4gICAgICBcbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ21lc3NhZ2UnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQubWVzc2FnZSkudG9CZSgnVXNlciBhY2NvdW50IHJlYWN0aXZhdGVkIHN1Y2Nlc3NmdWxseScpO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl0sInZlcnNpb24iOjN9