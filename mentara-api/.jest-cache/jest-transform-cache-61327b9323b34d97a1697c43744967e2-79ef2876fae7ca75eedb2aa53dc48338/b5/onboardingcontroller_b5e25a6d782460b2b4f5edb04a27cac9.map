{"version":3,"names":["common_1","cov_xpwzr2iw8","s","require","onboarding_service_1","jwt_auth_guard_1","current_user_id_decorator_1","current_user_role_decorator_1","OnboardingController","OnboardingController_1","onboardingService","logger","Logger","name","constructor","f","getMyOnboardingStatus","userId","getOnboardingStatus","error","HttpException","HttpStatus","INTERNAL_SERVER_ERROR","getUserOnboardingStatus","currentUserId","role","b","ForbiddenException","completeStep","stepName","markStepCompleted","validateOnboarding","validateOnboardingCompleteness","getOnboardingInsights","exports","__decorate","Get","__param","CurrentUserId","Promise","_b","Object","Param","CurrentUserRole","_c","Post","_d","Controller","UseGuards","JwtAuthGuard","OnboardingService","_a"],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/onboarding/onboarding.controller.ts"],"sourcesContent":["import {\n  Controller,\n  Get,\n  Post,\n  Param,\n  UseGuards,\n  HttpException,\n  HttpStatus,\n  Logger,\n  ForbiddenException,\n} from '@nestjs/common';\nimport { OnboardingService, OnboardingStatus } from './onboarding.service';\nimport { JwtAuthGuard } from '../auth/guards/jwt-auth.guard';\nimport { CurrentUserId } from '../auth/decorators/current-user-id.decorator';\nimport { CurrentUserRole } from '../auth/decorators/current-user-role.decorator';\n\n@Controller('onboarding')\n@UseGuards(JwtAuthGuard)\nexport class OnboardingController {\n  private readonly logger = new Logger(OnboardingController.name);\n\n  constructor(private readonly onboardingService: OnboardingService) {}\n\n  @Get('status')\n  async getMyOnboardingStatus(\n    @CurrentUserId() userId: string,\n  ): Promise<OnboardingStatus> {\n    try {\n      return await this.onboardingService.getOnboardingStatus(userId);\n    } catch (error) {\n      this.logger.error(\n        `Failed to get onboarding status for user ${userId}:`,\n        error,\n      );\n      throw new HttpException(\n        'Failed to retrieve onboarding status',\n        HttpStatus.INTERNAL_SERVER_ERROR,\n      );\n    }\n  }\n\n  @Get('status/:userId')\n  async getUserOnboardingStatus(\n    @Param('userId') userId: string,\n    @CurrentUserId() currentUserId: string,\n    @CurrentUserRole() role: string,\n  ): Promise<OnboardingStatus> {\n    if (role !== 'admin') {\n      throw new ForbiddenException('Admin access required');\n    }\n    try {\n      return await this.onboardingService.getOnboardingStatus(userId);\n    } catch (error) {\n      this.logger.error(\n        `Failed to get onboarding status for user ${userId}:`,\n        error,\n      );\n      if (error instanceof HttpException) {\n        throw error;\n      }\n      throw new HttpException(\n        'Failed to retrieve onboarding status',\n        HttpStatus.INTERNAL_SERVER_ERROR,\n      );\n    }\n  }\n\n  @Post('complete-step/:stepName')\n  async completeStep(\n    @CurrentUserId() userId: string,\n    @Param('stepName') stepName: string,\n  ): Promise<OnboardingStatus> {\n    try {\n      return await this.onboardingService.markStepCompleted(userId, stepName);\n    } catch (error) {\n      this.logger.error(\n        `Failed to complete step ${stepName} for user ${userId}:`,\n        error,\n      );\n      throw new HttpException(\n        'Failed to complete onboarding step',\n        HttpStatus.INTERNAL_SERVER_ERROR,\n      );\n    }\n  }\n\n  @Get('validate')\n  async validateOnboarding(@CurrentUserId() userId: string) {\n    try {\n      return await this.onboardingService.validateOnboardingCompleteness(\n        userId,\n      );\n    } catch (error) {\n      this.logger.error(\n        `Failed to validate onboarding for user ${userId}:`,\n        error,\n      );\n      throw new HttpException(\n        'Failed to validate onboarding completeness',\n        HttpStatus.INTERNAL_SERVER_ERROR,\n      );\n    }\n  }\n\n  @Get('insights')\n  async getOnboardingInsights(\n    @CurrentUserId() currentUserId: string,\n    @CurrentUserRole() role: string,\n  ) {\n    if (role !== 'admin') {\n      throw new ForbiddenException('Admin access required');\n    }\n    try {\n      return await this.onboardingService.getOnboardingInsights();\n    } catch (error) {\n      this.logger.error('Failed to get onboarding insights:', error);\n      throw new HttpException(\n        'Failed to retrieve onboarding insights',\n        HttpStatus.INTERNAL_SERVER_ERROR,\n      );\n    }\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}