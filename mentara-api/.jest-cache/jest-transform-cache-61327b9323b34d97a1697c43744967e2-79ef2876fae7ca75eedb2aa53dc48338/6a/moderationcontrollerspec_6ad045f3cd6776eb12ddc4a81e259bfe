b570f056a636836d5b14b3ea60c17b54
"use strict";
/**
 * Comprehensive Test Suite for ModerationController
 * Tests disabled join requests functionality and API compatibility
 */
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const common_1 = require("@nestjs/common");
const moderation_controller_1 = require("./moderation.controller");
const jwt_auth_guard_1 = require("../../auth/guards/jwt-auth.guard");
const role_based_access_guard_1 = require("../../auth/guards/role-based-access.guard");
const enhanced_test_helpers_1 = require("../../test-utils/enhanced-test-helpers");
const index_1 = require("../../test-utils/index");
describe('ModerationController', () => {
    let controller;
    let module;
    // Mock Guards
    const mockJwtAuthGuard = {
        canActivate: jest.fn().mockReturnValue(true),
    };
    const mockRoleBasedAccessGuard = {
        canActivate: jest.fn().mockReturnValue(true),
    };
    // Test data
    const mockUser = {
        id: index_1.TEST_USER_IDS.MODERATOR,
        email: index_1.TEST_EMAILS.MODERATOR,
        role: 'moderator',
    };
    const mockJoinRequestDto = {
        communityId: 'community_123456789',
        reason: 'I would like to join this community for support',
    };
    const mockProcessDto = {
        action: 'approve',
        reason: 'User meets community guidelines',
    };
    beforeEach(async () => {
        module = await testing_1.Test.createTestingModule({
            controllers: [moderation_controller_1.ModerationController],
            providers: [],
        })
            .overrideGuard(jwt_auth_guard_1.JwtAuthGuard)
            .useValue(mockJwtAuthGuard)
            .overrideGuard(role_based_access_guard_1.RoleBasedAccessGuard)
            .useValue(mockRoleBasedAccessGuard)
            .compile();
        controller = module.get(moderation_controller_1.ModerationController);
    });
    afterEach(() => {
        jest.clearAllMocks();
    });
    describe('Controller Initialization', () => {
        it('should be defined', () => {
            expect(controller).toBeDefined();
        });
    });
    describe('Security Guards', () => {
        it('should be protected by JwtAuthGuard and RoleBasedAccessGuard', () => {
            const guards = Reflect.getMetadata('__guards__', moderation_controller_1.ModerationController);
            expect(guards).toContain(jwt_auth_guard_1.JwtAuthGuard);
            expect(guards).toContain(role_based_access_guard_1.RoleBasedAccessGuard);
        });
        it('should have proper route decorators', () => {
            const controllerMetadata = Reflect.getMetadata('path', moderation_controller_1.ModerationController);
            expect(controllerMetadata).toBe('communities/moderation');
        });
        it('should require moderator or admin role', () => {
            const expectedRoles = ['moderator', 'admin'];
            const metadata = Reflect.getMetadata('roles', moderation_controller_1.ModerationController);
            expect(metadata).toEqual(expectedRoles);
        });
    });
    describe('POST /communities/moderation/join-requests (Disabled)', () => {
        it('should throw BadRequestException when creating join request', async () => {
            await expect(controller.createJoinRequest(mockJoinRequestDto)).rejects.toThrow(common_1.BadRequestException);
            try {
                await controller.createJoinRequest(mockJoinRequestDto);
            }
            catch (error) {
                expect(error).toBeInstanceOf(common_1.BadRequestException);
                expect(error.message).toContain('Join requests feature has been disabled');
            }
        });
        it('should handle any DTO input gracefully', async () => {
            const invalidDto = { invalid: 'data' };
            await expect(controller.createJoinRequest(invalidDto)).rejects.toThrow(common_1.BadRequestException);
        });
        it('should always throw the same error message', async () => {
            const dto1 = { communityId: 'test1' };
            const dto2 = { communityId: 'test2', reason: 'different reason' };
            const error1 = await controller.createJoinRequest(dto1).catch(e => e);
            const error2 = await controller.createJoinRequest(dto2).catch(e => e);
            expect(error1.message).toBe(error2.message);
            expect(error1.message).toContain('disabled');
        });
    });
    describe('GET /communities/moderation/join-requests (Disabled)', () => {
        it('should return empty list for join requests', async () => {
            const result = await controller.getJoinRequests({});
            expect(result).toEqual({
                requests: [],
                pagination: { page: 1, limit: 20, total: 0, totalPages: 0 },
                filters: {},
            });
        });
        it('should handle query parameters gracefully', async () => {
            const query = {
                status: 'pending',
                communityId: 'community_123',
                page: 2,
                limit: 50,
            };
            const result = await controller.getJoinRequests(query);
            expect(result.requests).toEqual([]);
            expect(result.pagination.total).toBe(0);
            expect(result.pagination.totalPages).toBe(0);
        });
        it('should always return consistent empty structure', async () => {
            const result1 = await controller.getJoinRequests({});
            const result2 = await controller.getJoinRequests({ any: 'parameter' });
            expect(result1).toEqual(result2);
            expect(result1.requests).toHaveLength(0);
            expect(result2.requests).toHaveLength(0);
        });
    });
    describe('GET /communities/moderation/join-requests/user/:userId (Disabled)', () => {
        it('should return empty array for user join requests', async () => {
            const result = await controller.getUserJoinRequests(index_1.TEST_USER_IDS.CLIENT);
            expect(result).toEqual([]);
            expect(Array.isArray(result)).toBe(true);
        });
        it('should handle any userId input', async () => {
            const userIds = [
                index_1.TEST_USER_IDS.CLIENT,
                index_1.TEST_USER_IDS.THERAPIST,
                'nonexistent_user',
                'invalid-format',
                '',
            ];
            for (const userId of userIds) {
                const result = await controller.getUserJoinRequests(userId);
                expect(result).toEqual([]);
            }
        });
        it('should be consistent across multiple calls', async () => {
            const result1 = await controller.getUserJoinRequests(index_1.TEST_USER_IDS.CLIENT);
            const result2 = await controller.getUserJoinRequests(index_1.TEST_USER_IDS.CLIENT);
            expect(result1).toEqual(result2);
            expect(result1).toEqual([]);
        });
    });
    describe('GET /communities/moderation/join-requests/pending (Disabled)', () => {
        it('should return empty array for pending requests', async () => {
            const result = await controller.getPendingRequests(mockUser);
            expect(result).toEqual([]);
            expect(Array.isArray(result)).toBe(true);
        });
        it('should handle different user contexts', async () => {
            const users = [
                { id: index_1.TEST_USER_IDS.MODERATOR, role: 'moderator' },
                { id: index_1.TEST_USER_IDS.ADMIN, role: 'admin' },
                { id: index_1.TEST_USER_IDS.CLIENT, role: 'client' },
            ];
            for (const user of users) {
                const result = await controller.getPendingRequests(user);
                expect(result).toEqual([]);
            }
        });
    });
    describe('PUT /communities/moderation/join-requests/:requestId/process (Disabled)', () => {
        it('should throw BadRequestException when processing request', async () => {
            await expect(controller.processJoinRequest('request_123', mockProcessDto, mockUser)).rejects.toThrow(common_1.BadRequestException);
            try {
                await controller.processJoinRequest('request_123', mockProcessDto, mockUser);
            }
            catch (error) {
                expect(error).toBeInstanceOf(common_1.BadRequestException);
                expect(error.message).toContain('Join requests feature has been disabled');
            }
        });
        it('should handle any request ID format', async () => {
            const requestIds = [
                'valid_uuid_format',
                'invalid-format',
                '',
                '123',
                'very-long-request-id-that-might-cause-issues',
            ];
            for (const requestId of requestIds) {
                await expect(controller.processJoinRequest(requestId, mockProcessDto, mockUser)).rejects.toThrow(common_1.BadRequestException);
            }
        });
        it('should handle different process actions', async () => {
            const processDtos = [
                { action: 'approve', reason: 'Good fit' },
                { action: 'reject', reason: 'Does not meet criteria' },
                { action: 'pending', reason: 'Need more information' },
                { invalid: 'data' },
            ];
            for (const dto of processDtos) {
                await expect(controller.processJoinRequest('request_123', dto, mockUser)).rejects.toThrow(common_1.BadRequestException);
            }
        });
    });
    describe('DELETE /communities/moderation/join-requests/:requestId (Disabled)', () => {
        it('should throw BadRequestException when canceling request', async () => {
            await expect(controller.cancelJoinRequest('request_123', mockUser)).rejects.toThrow(common_1.BadRequestException);
            try {
                await controller.cancelJoinRequest('request_123', mockUser);
            }
            catch (error) {
                expect(error).toBeInstanceOf(common_1.BadRequestException);
                expect(error.message).toContain('Join requests feature has been disabled');
            }
        });
        it('should handle any request ID for cancellation', async () => {
            const requestIds = ['request_1', 'request_2', 'invalid_id', ''];
            for (const requestId of requestIds) {
                await expect(controller.cancelJoinRequest(requestId, mockUser)).rejects.toThrow(common_1.BadRequestException);
            }
        });
        it('should handle different user contexts for cancellation', async () => {
            const users = [
                { id: index_1.TEST_USER_IDS.CLIENT, role: 'client' },
                { id: index_1.TEST_USER_IDS.MODERATOR, role: 'moderator' },
                { id: index_1.TEST_USER_IDS.ADMIN, role: 'admin' },
            ];
            for (const user of users) {
                await expect(controller.cancelJoinRequest('request_123', user)).rejects.toThrow(common_1.BadRequestException);
            }
        });
    });
    describe('GET /communities/moderation/stats/join-requests (Disabled)', () => {
        it('should return empty stats for join requests', async () => {
            const result = await controller.getJoinRequestStats({});
            expect(result).toEqual({
                totalRequests: 0,
                pendingRequests: 0,
                approvedRequests: 0,
                rejectedRequests: 0,
                avgProcessingTime: 0,
                requestsByStatus: {},
                recentActivity: [],
            });
        });
        it('should handle query parameters for stats', async () => {
            const query = {
                startDate: '2024-01-01',
                endDate: '2024-02-14',
                communityId: 'community_123',
            };
            const result = await controller.getJoinRequestStats(query);
            expect(result.totalRequests).toBe(0);
            expect(result.pendingRequests).toBe(0);
            expect(result.avgProcessingTime).toBe(0);
            expect(Array.isArray(result.recentActivity)).toBe(true);
            expect(result.recentActivity).toHaveLength(0);
        });
        it('should validate stats structure', async () => {
            const result = await controller.getJoinRequestStats({});
            expect(result).toHaveProperty('totalRequests');
            expect(result).toHaveProperty('pendingRequests');
            expect(result).toHaveProperty('approvedRequests');
            expect(result).toHaveProperty('rejectedRequests');
            expect(result).toHaveProperty('avgProcessingTime');
            expect(result).toHaveProperty('requestsByStatus');
            expect(result).toHaveProperty('recentActivity');
            expect(typeof result.totalRequests).toBe('number');
            expect(typeof result.avgProcessingTime).toBe('number');
            expect(typeof result.requestsByStatus).toBe('object');
            expect(Array.isArray(result.recentActivity)).toBe(true);
        });
    });
    describe('POST /communities/moderation/join-requests/bulk-process (Disabled)', () => {
        it('should throw BadRequestException for bulk processing', async () => {
            const bulkDto = {
                requestIds: ['request_1', 'request_2', 'request_3'],
                action: 'approve',
                reason: 'Bulk approval',
            };
            await expect(controller.bulkProcessJoinRequests(bulkDto, mockUser)).rejects.toThrow(common_1.BadRequestException);
            try {
                await controller.bulkProcessJoinRequests(bulkDto, mockUser);
            }
            catch (error) {
                expect(error).toBeInstanceOf(common_1.BadRequestException);
                expect(error.message).toContain('Join requests feature has been disabled');
            }
        });
        it('should handle empty bulk requests', async () => {
            const emptyDto = { requestIds: [], action: 'approve' };
            await expect(controller.bulkProcessJoinRequests(emptyDto, mockUser)).rejects.toThrow(common_1.BadRequestException);
        });
        it('should handle invalid bulk data', async () => {
            const invalidDtos = [
                { invalid: 'data' },
                { requestIds: null, action: 'approve' },
                { requestIds: ['valid'], action: null },
                {},
            ];
            for (const dto of invalidDtos) {
                await expect(controller.bulkProcessJoinRequests(dto, mockUser)).rejects.toThrow(common_1.BadRequestException);
            }
        });
    });
    describe('Response Format Validation', () => {
        it('should return properly formatted empty list responses', async () => {
            const listResponse = await controller.getJoinRequests({});
            const userResponse = await controller.getUserJoinRequests(index_1.TEST_USER_IDS.CLIENT);
            const pendingResponse = await controller.getPendingRequests(mockUser);
            // Validate list response structure
            enhanced_test_helpers_1.TestAssertions.expectValidEntity(listResponse, ['requests', 'pagination', 'filters']);
            expect(Array.isArray(listResponse.requests)).toBe(true);
            expect(listResponse.pagination).toHaveProperty('page');
            expect(listResponse.pagination).toHaveProperty('limit');
            expect(listResponse.pagination).toHaveProperty('total');
            expect(listResponse.pagination).toHaveProperty('totalPages');
            // Validate user response
            expect(Array.isArray(userResponse)).toBe(true);
            // Validate pending response
            expect(Array.isArray(pendingResponse)).toBe(true);
        });
        it('should return properly formatted stats response', async () => {
            const statsResponse = await controller.getJoinRequestStats({});
            enhanced_test_helpers_1.TestAssertions.expectValidEntity(statsResponse, [
                'totalRequests',
                'pendingRequests',
                'approvedRequests',
                'rejectedRequests',
                'avgProcessingTime',
                'requestsByStatus',
                'recentActivity',
            ]);
            expect(typeof statsResponse.totalRequests).toBe('number');
            expect(typeof statsResponse.avgProcessingTime).toBe('number');
            expect(Array.isArray(statsResponse.recentActivity)).toBe(true);
        });
        it('should return consistent error format for disabled features', async () => {
            const errorMethods = [
                () => controller.createJoinRequest({}),
                () => controller.processJoinRequest('id', {}, mockUser),
                () => controller.cancelJoinRequest('id', mockUser),
                () => controller.bulkProcessJoinRequests({}, mockUser),
            ];
            for (const method of errorMethods) {
                try {
                    await method();
                }
                catch (error) {
                    expect(error).toBeInstanceOf(common_1.BadRequestException);
                    expect(error.message).toContain('disabled');
                }
            }
        });
    });
    describe('Error Handling', () => {
        it('should handle malformed input gracefully', async () => {
            const malformedInputs = [null, undefined, '', 0, false, []];
            for (const input of malformedInputs) {
                // Test endpoints that accept any input
                const listResult = await controller.getJoinRequests(input);
                expect(listResult.requests).toEqual([]);
                const statsResult = await controller.getJoinRequestStats(input);
                expect(statsResult.totalRequests).toBe(0);
            }
        });
        it('should maintain consistent behavior under stress', async () => {
            // Test rapid successive calls
            const promises = Array.from({ length: 10 }, async (_, i) => {
                const listResult = await controller.getJoinRequests({ index: i });
                const statsResult = await controller.getJoinRequestStats({ index: i });
                return { list: listResult, stats: statsResult };
            });
            const results = await Promise.all(promises);
            results.forEach(result => {
                expect(result.list.requests).toEqual([]);
                expect(result.stats.totalRequests).toBe(0);
            });
        });
        it('should handle edge case user inputs', async () => {
            const edgeCaseUsers = [
                null,
                undefined,
                { id: null },
                { id: '' },
                { role: 'invalid' },
                {},
            ];
            for (const user of edgeCaseUsers) {
                const pendingResult = await controller.getPendingRequests(user);
                expect(pendingResult).toEqual([]);
            }
        });
    });
    describe('Integration Tests', () => {
        it('should handle complete disabled workflow consistently', async () => {
            // Test that all endpoints maintain consistent disabled state
            const listResult = await controller.getJoinRequests({});
            expect(listResult.requests).toHaveLength(0);
            const userResult = await controller.getUserJoinRequests(index_1.TEST_USER_IDS.CLIENT);
            expect(userResult).toHaveLength(0);
            const pendingResult = await controller.getPendingRequests(mockUser);
            expect(pendingResult).toHaveLength(0);
            const statsResult = await controller.getJoinRequestStats({});
            expect(statsResult.totalRequests).toBe(0);
            // Test that action endpoints consistently throw errors
            const actionMethods = [
                () => controller.createJoinRequest({}),
                () => controller.processJoinRequest('id', {}, mockUser),
                () => controller.cancelJoinRequest('id', mockUser),
                () => controller.bulkProcessJoinRequests({}, mockUser),
            ];
            for (const method of actionMethods) {
                await expect(method()).rejects.toThrow(common_1.BadRequestException);
            }
        });
        it('should validate API compatibility for future enablement', async () => {
            // Ensure response structures are compatible with potential future enablement
            const listResponse = await controller.getJoinRequests({});
            expect(listResponse).toHaveProperty('requests');
            expect(listResponse).toHaveProperty('pagination');
            expect(listResponse.pagination).toHaveProperty('page');
            expect(listResponse.pagination).toHaveProperty('limit');
            const statsResponse = await controller.getJoinRequestStats({});
            expect(statsResponse).toHaveProperty('totalRequests');
            expect(statsResponse).toHaveProperty('requestsByStatus');
            expect(statsResponse).toHaveProperty('recentActivity');
            // Ensure all required properties exist for API contracts
            const requiredStatsProperties = [
                'totalRequests', 'pendingRequests', 'approvedRequests',
                'rejectedRequests', 'avgProcessingTime', 'requestsByStatus', 'recentActivity'
            ];
            requiredStatsProperties.forEach(prop => {
                expect(statsResponse).toHaveProperty(prop);
            });
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL2NvbW11bml0aWVzL2NvbnRyb2xsZXJzL21vZGVyYXRpb24uY29udHJvbGxlci5zcGVjLnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7O0dBR0c7O0FBRUgsNkNBQXNEO0FBQ3RELDJDQUFxRDtBQUNyRCxtRUFBK0Q7QUFDL0QscUVBQWdFO0FBQ2hFLHVGQUFpRjtBQUVqRixrRkFBd0c7QUFDeEcsa0RBQW9FO0FBRXBFLFFBQVEsQ0FBQyxzQkFBc0IsRUFBRSxHQUFHLEVBQUU7SUFDcEMsSUFBSSxVQUFnQyxDQUFDO0lBQ3JDLElBQUksTUFBcUIsQ0FBQztJQUUxQixjQUFjO0lBQ2QsTUFBTSxnQkFBZ0IsR0FBRztRQUN2QixXQUFXLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUM7S0FDN0MsQ0FBQztJQUVGLE1BQU0sd0JBQXdCLEdBQUc7UUFDL0IsV0FBVyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDO0tBQzdDLENBQUM7SUFFRixZQUFZO0lBQ1osTUFBTSxRQUFRLEdBQUc7UUFDZixFQUFFLEVBQUUscUJBQWEsQ0FBQyxTQUFTO1FBQzNCLEtBQUssRUFBRSxtQkFBVyxDQUFDLFNBQVM7UUFDNUIsSUFBSSxFQUFFLFdBQVc7S0FDbEIsQ0FBQztJQUVGLE1BQU0sa0JBQWtCLEdBQUc7UUFDekIsV0FBVyxFQUFFLHFCQUFxQjtRQUNsQyxNQUFNLEVBQUUsaURBQWlEO0tBQzFELENBQUM7SUFFRixNQUFNLGNBQWMsR0FBRztRQUNyQixNQUFNLEVBQUUsU0FBUztRQUNqQixNQUFNLEVBQUUsaUNBQWlDO0tBQzFDLENBQUM7SUFFRixVQUFVLENBQUMsS0FBSyxJQUFJLEVBQUU7UUFDcEIsTUFBTSxHQUFHLE1BQU0sY0FBSSxDQUFDLG1CQUFtQixDQUFDO1lBQ3RDLFdBQVcsRUFBRSxDQUFDLDRDQUFv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QUFtQixDQUFDLEVBQUUsQ0FBQyxDQUFDO1lBQy9ELE1BQU0sQ0FBQyxhQUFhLENBQUMsQ0FBQyxjQUFjLENBQUMsZUFBZSxDQUFDLENBQUM7WUFDdEQsTUFBTSxDQUFDLGFBQWEsQ0FBQyxDQUFDLGNBQWMsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO1lBQ3pELE1BQU0sQ0FBQyxhQUFhLENBQUMsQ0FBQyxjQUFjLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztZQUV2RCx5REFBeUQ7WUFDekQsTUFBTSx1QkFBdUIsR0FBRztnQkFDOUIsZUFBZSxFQUFFLGlCQUFpQixFQUFFLGtCQUFrQjtnQkFDdEQsa0JBQWtCLEVBQUUsbUJBQW1CLEVBQUUsa0JBQWtCLEVBQUUsZ0JBQWdCO2FBQzlFLENBQUM7WUFFRix1QkFBdUIsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUU7Z0JBQ3JDLE1BQU0sQ0FBQyxhQUFhLENBQUMsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDN0MsQ0FBQyxDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL2NvbW11bml0aWVzL2NvbnRyb2xsZXJzL21vZGVyYXRpb24uY29udHJvbGxlci5zcGVjLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ29tcHJlaGVuc2l2ZSBUZXN0IFN1aXRlIGZvciBNb2RlcmF0aW9uQ29udHJvbGxlclxuICogVGVzdHMgZGlzYWJsZWQgam9pbiByZXF1ZXN0cyBmdW5jdGlvbmFsaXR5IGFuZCBBUEkgY29tcGF0aWJpbGl0eVxuICovXG5cbmltcG9ydCB7IFRlc3QsIFRlc3RpbmdNb2R1bGUgfSBmcm9tICdAbmVzdGpzL3Rlc3RpbmcnO1xuaW1wb3J0IHsgQmFkUmVxdWVzdEV4Y2VwdGlvbiB9IGZyb20gJ0BuZXN0anMvY29tbW9uJztcbmltcG9ydCB7IE1vZGVyYXRpb25Db250cm9sbGVyIH0gZnJvbSAnLi9tb2RlcmF0aW9uLmNvbnRyb2xsZXInO1xuaW1wb3J0IHsgSnd0QXV0aEd1YXJkIH0gZnJvbSAnLi4vLi4vYXV0aC9ndWFyZHMvand0LWF1dGguZ3VhcmQnO1xuaW1wb3J0IHsgUm9sZUJhc2VkQWNjZXNzR3VhcmQgfSBmcm9tICcuLi8uLi9hdXRoL2d1YXJkcy9yb2xlLWJhc2VkLWFjY2Vzcy5ndWFyZCc7XG5pbXBvcnQgeyBTZWN1cml0eUd1YXJkVGVzdFV0aWxzLCBSb2xlQmFzZWRUZXN0VXRpbHMgfSBmcm9tICcuLi8uLi90ZXN0LXV0aWxzL2F1dGgtdGVzdGluZy1oZWxwZXJzJztcbmltcG9ydCB7IE1vY2tCdWlsZGVyLCBUZXN0RGF0YUdlbmVyYXRvciwgVGVzdEFzc2VydGlvbnMgfSBmcm9tICcuLi8uLi90ZXN0LXV0aWxzL2VuaGFuY2VkLXRlc3QtaGVscGVycyc7XG5pbXBvcnQgeyBURVNUX1VTRVJfSURTLCBURVNUX0VNQUlMUyB9IGZyb20gJy4uLy4uL3Rlc3QtdXRpbHMvaW5kZXgnO1xuXG5kZXNjcmliZSgnTW9kZXJhdGlvbkNvbnRyb2xsZXInLCAoKSA9PiB7XG4gIGxldCBjb250cm9sbGVyOiBNb2RlcmF0aW9uQ29udHJvbGxlcjtcbiAgbGV0IG1vZHVsZTogVGVzdGluZ01vZHVsZTtcblxuICAvLyBNb2NrIEd1YXJkc1xuICBjb25zdCBtb2NrSnd0QXV0aEd1YXJkID0ge1xuICAgIGNhbkFjdGl2YXRlOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHRydWUpLFxuICB9O1xuXG4gIGNvbnN0IG1vY2tSb2xlQmFzZWRBY2Nlc3NHdWFyZCA9IHtcbiAgICBjYW5BY3RpdmF0ZTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh0cnVlKSxcbiAgfTtcblxuICAvLyBUZXN0IGRhdGFcbiAgY29uc3QgbW9ja1VzZXIgPSB7XG4gICAgaWQ6IFRFU1RfVVNFUl9JRFMuTU9ERVJBVE9SLFxuICAgIGVtYWlsOiBURVNUX0VNQUlMUy5NT0RFUkFUT1IsXG4gICAgcm9sZTogJ21vZGVyYXRvcicsXG4gIH07XG5cbiAgY29uc3QgbW9ja0pvaW5SZXF1ZXN0RHRvID0ge1xuICAgIGNvbW11bml0eUlkOiAnY29tbXVuaXR5XzEyMzQ1Njc4OScsXG4gICAgcmVhc29uOiAnSSB3b3VsZCBsaWtlIHRvIGpvaW4gdGhpcyBjb21tdW5pdHkgZm9yIHN1cHBvcnQnLFxuICB9O1xuXG4gIGNvbnN0IG1vY2tQcm9jZXNzRHRvID0ge1xuICAgIGFjdGlvbjogJ2FwcHJvdmUnLFxuICAgIHJlYXNvbjogJ1VzZXIgbWVldHMgY29tbXVuaXR5IGd1aWRlbGluZXMnLFxuICB9O1xuXG4gIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xuICAgIG1vZHVsZSA9IGF3YWl0IFRlc3QuY3JlYXRlVGVzdGluZ01vZHVsZSh7XG4gICAgICBjb250cm9sbGVyczogW01vZGVyYXRpb25Db250cm9sbGVyXSxcbiAgICAgIHByb3ZpZGVyczogW10sXG4gICAgfSlcbiAgICAgIC5vdmVycmlkZUd1YXJkKEp3dEF1dGhHdWFyZClcbiAgICAgIC51c2VWYWx1ZShtb2NrSnd0QXV0aEd1YXJkKVxuICAgICAgLm92ZXJyaWRlR3VhcmQoUm9sZUJhc2VkQWNjZXNzR3VhcmQpXG4gICAgICAudXNlVmFsdWUobW9ja1JvbGVCYXNlZEFjY2Vzc0d1YXJkKVxuICAgICAgLmNvbXBpbGUoKTtcblxuICAgIGNvbnRyb2xsZXIgPSBtb2R1bGUuZ2V0PE1vZGVyYXRpb25Db250cm9sbGVyPihNb2RlcmF0aW9uQ29udHJvbGxlcik7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdDb250cm9sbGVyIEluaXRpYWxpemF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgYmUgZGVmaW5lZCcsICgpID0+IHtcbiAgICAgIGV4cGVjdChjb250cm9sbGVyKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnU2VjdXJpdHkgR3VhcmRzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgYmUgcHJvdGVjdGVkIGJ5IEp3dEF1dGhHdWFyZCBhbmQgUm9sZUJhc2VkQWNjZXNzR3VhcmQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBndWFyZHMgPSBSZWZsZWN0LmdldE1ldGFkYXRhKCdfX2d1YXJkc19fJywgTW9kZXJhdGlvbkNvbnRyb2xsZXIpO1xuICAgICAgZXhwZWN0KGd1YXJkcykudG9Db250YWluKEp3dEF1dGhHdWFyZCk7XG4gICAgICBleHBlY3QoZ3VhcmRzKS50b0NvbnRhaW4oUm9sZUJhc2VkQWNjZXNzR3VhcmQpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYXZlIHByb3BlciByb3V0ZSBkZWNvcmF0b3JzJywgKCkgPT4ge1xuICAgICAgY29uc3QgY29udHJvbGxlck1ldGFkYXRhID0gUmVmbGVjdC5nZXRNZXRhZGF0YSgncGF0aCcsIE1vZGVyYXRpb25Db250cm9sbGVyKTtcbiAgICAgIGV4cGVjdChjb250cm9sbGVyTWV0YWRhdGEpLnRvQmUoJ2NvbW11bml0aWVzL21vZGVyYXRpb24nKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVxdWlyZSBtb2RlcmF0b3Igb3IgYWRtaW4gcm9sZScsICgpID0+IHtcbiAgICAgIGNvbnN0IGV4cGVjdGVkUm9sZXMgPSBbJ21vZGVyYXRvcicsICdhZG1pbiddO1xuICAgICAgY29uc3QgbWV0YWRhdGEgPSBSZWZsZWN0LmdldE1ldGFkYXRhKCdyb2xlcycsIE1vZGVyYXRpb25Db250cm9sbGVyKTtcbiAgICAgIGV4cGVjdChtZXRhZGF0YSkudG9FcXVhbChleHBlY3RlZFJvbGVzKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1BPU1QgL2NvbW11bml0aWVzL21vZGVyYXRpb24vam9pbi1yZXF1ZXN0cyAoRGlzYWJsZWQpJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgdGhyb3cgQmFkUmVxdWVzdEV4Y2VwdGlvbiB3aGVuIGNyZWF0aW5nIGpvaW4gcmVxdWVzdCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5jcmVhdGVKb2luUmVxdWVzdChtb2NrSm9pblJlcXVlc3REdG8pXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhCYWRSZXF1ZXN0RXhjZXB0aW9uKTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgY29udHJvbGxlci5jcmVhdGVKb2luUmVxdWVzdChtb2NrSm9pblJlcXVlc3REdG8pO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgZXhwZWN0KGVycm9yKS50b0JlSW5zdGFuY2VPZihCYWRSZXF1ZXN0RXhjZXB0aW9uKTtcbiAgICAgICAgZXhwZWN0KGVycm9yLm1lc3NhZ2UpLnRvQ29udGFpbignSm9pbiByZXF1ZXN0cyBmZWF0dXJlIGhhcyBiZWVuIGRpc2FibGVkJyk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBhbnkgRFRPIGlucHV0IGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBpbnZhbGlkRHRvID0geyBpbnZhbGlkOiAnZGF0YScgfTtcbiAgICAgIFxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLmNyZWF0ZUpvaW5SZXF1ZXN0KGludmFsaWREdG8pXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhCYWRSZXF1ZXN0RXhjZXB0aW9uKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYWx3YXlzIHRocm93IHRoZSBzYW1lIGVycm9yIG1lc3NhZ2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBkdG8xID0geyBjb21tdW5pdHlJZDogJ3Rlc3QxJyB9O1xuICAgICAgY29uc3QgZHRvMiA9IHsgY29tbXVuaXR5SWQ6ICd0ZXN0MicsIHJlYXNvbjogJ2RpZmZlcmVudCByZWFzb24nIH07XG5cbiAgICAgIGNvbnN0IGVycm9yMSA9IGF3YWl0IGNvbnRyb2xsZXIuY3JlYXRlSm9pblJlcXVlc3QoZHRvMSkuY2F0Y2goZSA9PiBlKTtcbiAgICAgIGNvbnN0IGVycm9yMiA9IGF3YWl0IGNvbnRyb2xsZXIuY3JlYXRlSm9pblJlcXVlc3QoZHRvMikuY2F0Y2goZSA9PiBlKTtcblxuICAgICAgZXhwZWN0KGVycm9yMS5tZXNzYWdlKS50b0JlKGVycm9yMi5tZXNzYWdlKTtcbiAgICAgIGV4cGVjdChlcnJvcjEubWVzc2FnZSkudG9Db250YWluKCdkaXNhYmxlZCcpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnR0VUIC9jb21tdW5pdGllcy9tb2RlcmF0aW9uL2pvaW4tcmVxdWVzdHMgKERpc2FibGVkKScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiBlbXB0eSBsaXN0IGZvciBqb2luIHJlcXVlc3RzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRKb2luUmVxdWVzdHMoe30pO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHtcbiAgICAgICAgcmVxdWVzdHM6IFtdLFxuICAgICAgICBwYWdpbmF0aW9uOiB7IHBhZ2U6IDEsIGxpbWl0OiAyMCwgdG90YWw6IDAsIHRvdGFsUGFnZXM6IDAgfSxcbiAgICAgICAgZmlsdGVyczoge30sXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHF1ZXJ5IHBhcmFtZXRlcnMgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHF1ZXJ5ID0ge1xuICAgICAgICBzdGF0dXM6ICdwZW5kaW5nJyxcbiAgICAgICAgY29tbXVuaXR5SWQ6ICdjb21tdW5pdHlfMTIzJyxcbiAgICAgICAgcGFnZTogMixcbiAgICAgICAgbGltaXQ6IDUwLFxuICAgICAgfTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRKb2luUmVxdWVzdHMocXVlcnkpO1xuXG4gICAgICBleHBlY3QocmVzdWx0LnJlcXVlc3RzKS50b0VxdWFsKFtdKTtcbiAgICAgIGV4cGVjdChyZXN1bHQucGFnaW5hdGlvbi50b3RhbCkudG9CZSgwKTtcbiAgICAgIGV4cGVjdChyZXN1bHQucGFnaW5hdGlvbi50b3RhbFBhZ2VzKS50b0JlKDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhbHdheXMgcmV0dXJuIGNvbnNpc3RlbnQgZW1wdHkgc3RydWN0dXJlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0MSA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0Sm9pblJlcXVlc3RzKHt9KTtcbiAgICAgIGNvbnN0IHJlc3VsdDIgPSBhd2FpdCBjb250cm9sbGVyLmdldEpvaW5SZXF1ZXN0cyh7IGFueTogJ3BhcmFtZXRlcicgfSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQxKS50b0VxdWFsKHJlc3VsdDIpO1xuICAgICAgZXhwZWN0KHJlc3VsdDEucmVxdWVzdHMpLnRvSGF2ZUxlbmd0aCgwKTtcbiAgICAgIGV4cGVjdChyZXN1bHQyLnJlcXVlc3RzKS50b0hhdmVMZW5ndGgoMCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdHRVQgL2NvbW11bml0aWVzL21vZGVyYXRpb24vam9pbi1yZXF1ZXN0cy91c2VyLzp1c2VySWQgKERpc2FibGVkKScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiBlbXB0eSBhcnJheSBmb3IgdXNlciBqb2luIHJlcXVlc3RzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRVc2VySm9pblJlcXVlc3RzKFRFU1RfVVNFUl9JRFMuQ0xJRU5UKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChbXSk7XG4gICAgICBleHBlY3QoQXJyYXkuaXNBcnJheShyZXN1bHQpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgYW55IHVzZXJJZCBpbnB1dCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHVzZXJJZHMgPSBbXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICBURVNUX1VTRVJfSURTLlRIRVJBUElTVCxcbiAgICAgICAgJ25vbmV4aXN0ZW50X3VzZXInLFxuICAgICAgICAnaW52YWxpZC1mb3JtYXQnLFxuICAgICAgICAnJyxcbiAgICAgIF07XG5cbiAgICAgIGZvciAoY29uc3QgdXNlcklkIG9mIHVzZXJJZHMpIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRVc2VySm9pblJlcXVlc3RzKHVzZXJJZCk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoW10pO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBiZSBjb25zaXN0ZW50IGFjcm9zcyBtdWx0aXBsZSBjYWxscycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdDEgPSBhd2FpdCBjb250cm9sbGVyLmdldFVzZXJKb2luUmVxdWVzdHMoVEVTVF9VU0VSX0lEUy5DTElFTlQpO1xuICAgICAgY29uc3QgcmVzdWx0MiA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0VXNlckpvaW5SZXF1ZXN0cyhURVNUX1VTRVJfSURTLkNMSUVOVCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQxKS50b0VxdWFsKHJlc3VsdDIpO1xuICAgICAgZXhwZWN0KHJlc3VsdDEpLnRvRXF1YWwoW10pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnR0VUIC9jb21tdW5pdGllcy9tb2RlcmF0aW9uL2pvaW4tcmVxdWVzdHMvcGVuZGluZyAoRGlzYWJsZWQpJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIGVtcHR5IGFycmF5IGZvciBwZW5kaW5nIHJlcXVlc3RzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRQZW5kaW5nUmVxdWVzdHMobW9ja1VzZXIpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKFtdKTtcbiAgICAgIGV4cGVjdChBcnJheS5pc0FycmF5KHJlc3VsdCkpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBkaWZmZXJlbnQgdXNlciBjb250ZXh0cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHVzZXJzID0gW1xuICAgICAgICB7IGlkOiBURVNUX1VTRVJfSURTLk1PREVSQVRPUiwgcm9sZTogJ21vZGVyYXRvcicgfSxcbiAgICAgICAgeyBpZDogVEVTVF9VU0VSX0lEUy5BRE1JTiwgcm9sZTogJ2FkbWluJyB9LFxuICAgICAgICB7IGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCwgcm9sZTogJ2NsaWVudCcgfSxcbiAgICAgIF07XG5cbiAgICAgIGZvciAoY29uc3QgdXNlciBvZiB1c2Vycykge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldFBlbmRpbmdSZXF1ZXN0cyh1c2VyKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChbXSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdQVVQgL2NvbW11bml0aWVzL21vZGVyYXRpb24vam9pbi1yZXF1ZXN0cy86cmVxdWVzdElkL3Byb2Nlc3MgKERpc2FibGVkKScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHRocm93IEJhZFJlcXVlc3RFeGNlcHRpb24gd2hlbiBwcm9jZXNzaW5nIHJlcXVlc3QnLCBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIucHJvY2Vzc0pvaW5SZXF1ZXN0KCdyZXF1ZXN0XzEyMycsIG1vY2tQcm9jZXNzRHRvLCBtb2NrVXNlcilcbiAgICAgICkucmVqZWN0cy50b1Rocm93KEJhZFJlcXVlc3RFeGNlcHRpb24pO1xuXG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCBjb250cm9sbGVyLnByb2Nlc3NKb2luUmVxdWVzdCgncmVxdWVzdF8xMjMnLCBtb2NrUHJvY2Vzc0R0bywgbW9ja1VzZXIpO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgZXhwZWN0KGVycm9yKS50b0JlSW5zdGFuY2VPZihCYWRSZXF1ZXN0RXhjZXB0aW9uKTtcbiAgICAgICAgZXhwZWN0KGVycm9yLm1lc3NhZ2UpLnRvQ29udGFpbignSm9pbiByZXF1ZXN0cyBmZWF0dXJlIGhhcyBiZWVuIGRpc2FibGVkJyk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBhbnkgcmVxdWVzdCBJRCBmb3JtYXQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXF1ZXN0SWRzID0gW1xuICAgICAgICAndmFsaWRfdXVpZF9mb3JtYXQnLFxuICAgICAgICAnaW52YWxpZC1mb3JtYXQnLFxuICAgICAgICAnJyxcbiAgICAgICAgJzEyMycsXG4gICAgICAgICd2ZXJ5LWxvbmctcmVxdWVzdC1pZC10aGF0LW1pZ2h0LWNhdXNlLWlzc3VlcycsXG4gICAgICBdO1xuXG4gICAgICBmb3IgKGNvbnN0IHJlcXVlc3RJZCBvZiByZXF1ZXN0SWRzKSB7XG4gICAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgICBjb250cm9sbGVyLnByb2Nlc3NKb2luUmVxdWVzdChyZXF1ZXN0SWQsIG1vY2tQcm9jZXNzRHRvLCBtb2NrVXNlcilcbiAgICAgICAgKS5yZWplY3RzLnRvVGhyb3coQmFkUmVxdWVzdEV4Y2VwdGlvbik7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBkaWZmZXJlbnQgcHJvY2VzcyBhY3Rpb25zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcHJvY2Vzc0R0b3MgPSBbXG4gICAgICAgIHsgYWN0aW9uOiAnYXBwcm92ZScsIHJlYXNvbjogJ0dvb2QgZml0JyB9LFxuICAgICAgICB7IGFjdGlvbjogJ3JlamVjdCcsIHJlYXNvbjogJ0RvZXMgbm90IG1lZXQgY3JpdGVyaWEnIH0sXG4gICAgICAgIHsgYWN0aW9uOiAncGVuZGluZycsIHJlYXNvbjogJ05lZWQgbW9yZSBpbmZvcm1hdGlvbicgfSxcbiAgICAgICAgeyBpbnZhbGlkOiAnZGF0YScgfSxcbiAgICAgIF07XG5cbiAgICAgIGZvciAoY29uc3QgZHRvIG9mIHByb2Nlc3NEdG9zKSB7XG4gICAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgICBjb250cm9sbGVyLnByb2Nlc3NKb2luUmVxdWVzdCgncmVxdWVzdF8xMjMnLCBkdG8sIG1vY2tVc2VyKVxuICAgICAgICApLnJlamVjdHMudG9UaHJvdyhCYWRSZXF1ZXN0RXhjZXB0aW9uKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0RFTEVURSAvY29tbXVuaXRpZXMvbW9kZXJhdGlvbi9qb2luLXJlcXVlc3RzLzpyZXF1ZXN0SWQgKERpc2FibGVkKScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHRocm93IEJhZFJlcXVlc3RFeGNlcHRpb24gd2hlbiBjYW5jZWxpbmcgcmVxdWVzdCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5jYW5jZWxKb2luUmVxdWVzdCgncmVxdWVzdF8xMjMnLCBtb2NrVXNlcilcbiAgICAgICkucmVqZWN0cy50b1Rocm93KEJhZFJlcXVlc3RFeGNlcHRpb24pO1xuXG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCBjb250cm9sbGVyLmNhbmNlbEpvaW5SZXF1ZXN0KCdyZXF1ZXN0XzEyMycsIG1vY2tVc2VyKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGV4cGVjdChlcnJvcikudG9CZUluc3RhbmNlT2YoQmFkUmVxdWVzdEV4Y2VwdGlvbik7XG4gICAgICAgIGV4cGVjdChlcnJvci5tZXNzYWdlKS50b0NvbnRhaW4oJ0pvaW4gcmVxdWVzdHMgZmVhdHVyZSBoYXMgYmVlbiBkaXNhYmxlZCcpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgYW55IHJlcXVlc3QgSUQgZm9yIGNhbmNlbGxhdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlcXVlc3RJZHMgPSBbJ3JlcXVlc3RfMScsICdyZXF1ZXN0XzInLCAnaW52YWxpZF9pZCcsICcnXTtcblxuICAgICAgZm9yIChjb25zdCByZXF1ZXN0SWQgb2YgcmVxdWVzdElkcykge1xuICAgICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgICAgY29udHJvbGxlci5jYW5jZWxKb2luUmVxdWVzdChyZXF1ZXN0SWQsIG1vY2tVc2VyKVxuICAgICAgICApLnJlamVjdHMudG9UaHJvdyhCYWRSZXF1ZXN0RXhjZXB0aW9uKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGRpZmZlcmVudCB1c2VyIGNvbnRleHRzIGZvciBjYW5jZWxsYXRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB1c2VycyA9IFtcbiAgICAgICAgeyBpZDogVEVTVF9VU0VSX0lEUy5DTElFTlQsIHJvbGU6ICdjbGllbnQnIH0sXG4gICAgICAgIHsgaWQ6IFRFU1RfVVNFUl9JRFMuTU9ERVJBVE9SLCByb2xlOiAnbW9kZXJhdG9yJyB9LFxuICAgICAgICB7IGlkOiBURVNUX1VTRVJfSURTLkFETUlOLCByb2xlOiAnYWRtaW4nIH0sXG4gICAgICBdO1xuXG4gICAgICBmb3IgKGNvbnN0IHVzZXIgb2YgdXNlcnMpIHtcbiAgICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICAgIGNvbnRyb2xsZXIuY2FuY2VsSm9pblJlcXVlc3QoJ3JlcXVlc3RfMTIzJywgdXNlcilcbiAgICAgICAgKS5yZWplY3RzLnRvVGhyb3coQmFkUmVxdWVzdEV4Y2VwdGlvbik7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdHRVQgL2NvbW11bml0aWVzL21vZGVyYXRpb24vc3RhdHMvam9pbi1yZXF1ZXN0cyAoRGlzYWJsZWQpJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIGVtcHR5IHN0YXRzIGZvciBqb2luIHJlcXVlc3RzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRKb2luUmVxdWVzdFN0YXRzKHt9KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7XG4gICAgICAgIHRvdGFsUmVxdWVzdHM6IDAsXG4gICAgICAgIHBlbmRpbmdSZXF1ZXN0czogMCxcbiAgICAgICAgYXBwcm92ZWRSZXF1ZXN0czogMCxcbiAgICAgICAgcmVqZWN0ZWRSZXF1ZXN0czogMCxcbiAgICAgICAgYXZnUHJvY2Vzc2luZ1RpbWU6IDAsXG4gICAgICAgIHJlcXVlc3RzQnlTdGF0dXM6IHt9LFxuICAgICAgICByZWNlbnRBY3Rpdml0eTogW10sXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHF1ZXJ5IHBhcmFtZXRlcnMgZm9yIHN0YXRzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcXVlcnkgPSB7XG4gICAgICAgIHN0YXJ0RGF0ZTogJzIwMjQtMDEtMDEnLFxuICAgICAgICBlbmREYXRlOiAnMjAyNC0wMi0xNCcsXG4gICAgICAgIGNvbW11bml0eUlkOiAnY29tbXVuaXR5XzEyMycsXG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldEpvaW5SZXF1ZXN0U3RhdHMocXVlcnkpO1xuXG4gICAgICBleHBlY3QocmVzdWx0LnRvdGFsUmVxdWVzdHMpLnRvQmUoMCk7XG4gICAgICBleHBlY3QocmVzdWx0LnBlbmRpbmdSZXF1ZXN0cykudG9CZSgwKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuYXZnUHJvY2Vzc2luZ1RpbWUpLnRvQmUoMCk7XG4gICAgICBleHBlY3QoQXJyYXkuaXNBcnJheShyZXN1bHQucmVjZW50QWN0aXZpdHkpKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5yZWNlbnRBY3Rpdml0eSkudG9IYXZlTGVuZ3RoKDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBzdGF0cyBzdHJ1Y3R1cmUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldEpvaW5SZXF1ZXN0U3RhdHMoe30pO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgndG90YWxSZXF1ZXN0cycpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ3BlbmRpbmdSZXF1ZXN0cycpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ2FwcHJvdmVkUmVxdWVzdHMnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdyZWplY3RlZFJlcXVlc3RzJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgnYXZnUHJvY2Vzc2luZ1RpbWUnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdyZXF1ZXN0c0J5U3RhdHVzJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgncmVjZW50QWN0aXZpdHknKTtcblxuICAgICAgZXhwZWN0KHR5cGVvZiByZXN1bHQudG90YWxSZXF1ZXN0cykudG9CZSgnbnVtYmVyJyk7XG4gICAgICBleHBlY3QodHlwZW9mIHJlc3VsdC5hdmdQcm9jZXNzaW5nVGltZSkudG9CZSgnbnVtYmVyJyk7XG4gICAgICBleHBlY3QodHlwZW9mIHJlc3VsdC5yZXF1ZXN0c0J5U3RhdHVzKS50b0JlKCdvYmplY3QnKTtcbiAgICAgIGV4cGVjdChBcnJheS5pc0FycmF5KHJlc3VsdC5yZWNlbnRBY3Rpdml0eSkpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdQT1NUIC9jb21tdW5pdGllcy9tb2RlcmF0aW9uL2pvaW4tcmVxdWVzdHMvYnVsay1wcm9jZXNzIChEaXNhYmxlZCknLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCB0aHJvdyBCYWRSZXF1ZXN0RXhjZXB0aW9uIGZvciBidWxrIHByb2Nlc3NpbmcnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBidWxrRHRvID0ge1xuICAgICAgICByZXF1ZXN0SWRzOiBbJ3JlcXVlc3RfMScsICdyZXF1ZXN0XzInLCAncmVxdWVzdF8zJ10sXG4gICAgICAgIGFjdGlvbjogJ2FwcHJvdmUnLFxuICAgICAgICByZWFzb246ICdCdWxrIGFwcHJvdmFsJyxcbiAgICAgIH07XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5idWxrUHJvY2Vzc0pvaW5SZXF1ZXN0cyhidWxrRHRvLCBtb2NrVXNlcilcbiAgICAgICkucmVqZWN0cy50b1Rocm93KEJhZFJlcXVlc3RFeGNlcHRpb24pO1xuXG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCBjb250cm9sbGVyLmJ1bGtQcm9jZXNzSm9pblJlcXVlc3RzKGJ1bGtEdG8sIG1vY2tVc2VyKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGV4cGVjdChlcnJvcikudG9CZUluc3RhbmNlT2YoQmFkUmVxdWVzdEV4Y2VwdGlvbik7XG4gICAgICAgIGV4cGVjdChlcnJvci5tZXNzYWdlKS50b0NvbnRhaW4oJ0pvaW4gcmVxdWVzdHMgZmVhdHVyZSBoYXMgYmVlbiBkaXNhYmxlZCcpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgYnVsayByZXF1ZXN0cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGVtcHR5RHRvID0geyByZXF1ZXN0SWRzOiBbXSwgYWN0aW9uOiAnYXBwcm92ZScgfTtcblxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLmJ1bGtQcm9jZXNzSm9pblJlcXVlc3RzKGVtcHR5RHRvLCBtb2NrVXNlcilcbiAgICAgICkucmVqZWN0cy50b1Rocm93KEJhZFJlcXVlc3RFeGNlcHRpb24pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgaW52YWxpZCBidWxrIGRhdGEnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBpbnZhbGlkRHRvcyA9IFtcbiAgICAgICAgeyBpbnZhbGlkOiAnZGF0YScgfSxcbiAgICAgICAgeyByZXF1ZXN0SWRzOiBudWxsLCBhY3Rpb246ICdhcHByb3ZlJyB9LFxuICAgICAgICB7IHJlcXVlc3RJZHM6IFsndmFsaWQnXSwgYWN0aW9uOiBudWxsIH0sXG4gICAgICAgIHt9LFxuICAgICAgXTtcblxuICAgICAgZm9yIChjb25zdCBkdG8gb2YgaW52YWxpZER0b3MpIHtcbiAgICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICAgIGNvbnRyb2xsZXIuYnVsa1Byb2Nlc3NKb2luUmVxdWVzdHMoZHRvLCBtb2NrVXNlcilcbiAgICAgICAgKS5yZWplY3RzLnRvVGhyb3coQmFkUmVxdWVzdEV4Y2VwdGlvbik7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdSZXNwb25zZSBGb3JtYXQgVmFsaWRhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiBwcm9wZXJseSBmb3JtYXR0ZWQgZW1wdHkgbGlzdCByZXNwb25zZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBsaXN0UmVzcG9uc2UgPSBhd2FpdCBjb250cm9sbGVyLmdldEpvaW5SZXF1ZXN0cyh7fSk7XG4gICAgICBjb25zdCB1c2VyUmVzcG9uc2UgPSBhd2FpdCBjb250cm9sbGVyLmdldFVzZXJKb2luUmVxdWVzdHMoVEVTVF9VU0VSX0lEUy5DTElFTlQpO1xuICAgICAgY29uc3QgcGVuZGluZ1Jlc3BvbnNlID0gYXdhaXQgY29udHJvbGxlci5nZXRQZW5kaW5nUmVxdWVzdHMobW9ja1VzZXIpO1xuXG4gICAgICAvLyBWYWxpZGF0ZSBsaXN0IHJlc3BvbnNlIHN0cnVjdHVyZVxuICAgICAgVGVzdEFzc2VydGlvbnMuZXhwZWN0VmFsaWRFbnRpdHkobGlzdFJlc3BvbnNlLCBbJ3JlcXVlc3RzJywgJ3BhZ2luYXRpb24nLCAnZmlsdGVycyddKTtcbiAgICAgIGV4cGVjdChBcnJheS5pc0FycmF5KGxpc3RSZXNwb25zZS5yZXF1ZXN0cykpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QobGlzdFJlc3BvbnNlLnBhZ2luYXRpb24pLnRvSGF2ZVByb3BlcnR5KCdwYWdlJyk7XG4gICAgICBleHBlY3QobGlzdFJlc3BvbnNlLnBhZ2luYXRpb24pLnRvSGF2ZVByb3BlcnR5KCdsaW1pdCcpO1xuICAgICAgZXhwZWN0KGxpc3RSZXNwb25zZS5wYWdpbmF0aW9uKS50b0hhdmVQcm9wZXJ0eSgndG90YWwnKTtcbiAgICAgIGV4cGVjdChsaXN0UmVzcG9uc2UucGFnaW5hdGlvbikudG9IYXZlUHJvcGVydHkoJ3RvdGFsUGFnZXMnKTtcblxuICAgICAgLy8gVmFsaWRhdGUgdXNlciByZXNwb25zZVxuICAgICAgZXhwZWN0KEFycmF5LmlzQXJyYXkodXNlclJlc3BvbnNlKSkudG9CZSh0cnVlKTtcblxuICAgICAgLy8gVmFsaWRhdGUgcGVuZGluZyByZXNwb25zZVxuICAgICAgZXhwZWN0KEFycmF5LmlzQXJyYXkocGVuZGluZ1Jlc3BvbnNlKSkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIHByb3Blcmx5IGZvcm1hdHRlZCBzdGF0cyByZXNwb25zZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHN0YXRzUmVzcG9uc2UgPSBhd2FpdCBjb250cm9sbGVyLmdldEpvaW5SZXF1ZXN0U3RhdHMoe30pO1xuXG4gICAgICBUZXN0QXNzZXJ0aW9ucy5leHBlY3RWYWxpZEVudGl0eShzdGF0c1Jlc3BvbnNlLCBbXG4gICAgICAgICd0b3RhbFJlcXVlc3RzJyxcbiAgICAgICAgJ3BlbmRpbmdSZXF1ZXN0cycsXG4gICAgICAgICdhcHByb3ZlZFJlcXVlc3RzJyxcbiAgICAgICAgJ3JlamVjdGVkUmVxdWVzdHMnLFxuICAgICAgICAnYXZnUHJvY2Vzc2luZ1RpbWUnLFxuICAgICAgICAncmVxdWVzdHNCeVN0YXR1cycsXG4gICAgICAgICdyZWNlbnRBY3Rpdml0eScsXG4gICAgICBdKTtcblxuICAgICAgZXhwZWN0KHR5cGVvZiBzdGF0c1Jlc3BvbnNlLnRvdGFsUmVxdWVzdHMpLnRvQmUoJ251bWJlcicpO1xuICAgICAgZXhwZWN0KHR5cGVvZiBzdGF0c1Jlc3BvbnNlLmF2Z1Byb2Nlc3NpbmdUaW1lKS50b0JlKCdudW1iZXInKTtcbiAgICAgIGV4cGVjdChBcnJheS5pc0FycmF5KHN0YXRzUmVzcG9uc2UucmVjZW50QWN0aXZpdHkpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gY29uc2lzdGVudCBlcnJvciBmb3JtYXQgZm9yIGRpc2FibGVkIGZlYXR1cmVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZXJyb3JNZXRob2RzID0gW1xuICAgICAgICAoKSA9PiBjb250cm9sbGVyLmNyZWF0ZUpvaW5SZXF1ZXN0KHt9KSxcbiAgICAgICAgKCkgPT4gY29udHJvbGxlci5wcm9jZXNzSm9pblJlcXVlc3QoJ2lkJywge30sIG1vY2tVc2VyKSxcbiAgICAgICAgKCkgPT4gY29udHJvbGxlci5jYW5jZWxKb2luUmVxdWVzdCgnaWQnLCBtb2NrVXNlciksXG4gICAgICAgICgpID0+IGNvbnRyb2xsZXIuYnVsa1Byb2Nlc3NKb2luUmVxdWVzdHMoe30sIG1vY2tVc2VyKSxcbiAgICAgIF07XG5cbiAgICAgIGZvciAoY29uc3QgbWV0aG9kIG9mIGVycm9yTWV0aG9kcykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGF3YWl0IG1ldGhvZCgpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGV4cGVjdChlcnJvcikudG9CZUluc3RhbmNlT2YoQmFkUmVxdWVzdEV4Y2VwdGlvbik7XG4gICAgICAgICAgZXhwZWN0KGVycm9yLm1lc3NhZ2UpLnRvQ29udGFpbignZGlzYWJsZWQnKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRXJyb3IgSGFuZGxpbmcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbWFsZm9ybWVkIGlucHV0IGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtYWxmb3JtZWRJbnB1dHMgPSBbbnVsbCwgdW5kZWZpbmVkLCAnJywgMCwgZmFsc2UsIFtdXTtcblxuICAgICAgZm9yIChjb25zdCBpbnB1dCBvZiBtYWxmb3JtZWRJbnB1dHMpIHtcbiAgICAgICAgLy8gVGVzdCBlbmRwb2ludHMgdGhhdCBhY2NlcHQgYW55IGlucHV0XG4gICAgICAgIGNvbnN0IGxpc3RSZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldEpvaW5SZXF1ZXN0cyhpbnB1dCk7XG4gICAgICAgIGV4cGVjdChsaXN0UmVzdWx0LnJlcXVlc3RzKS50b0VxdWFsKFtdKTtcblxuICAgICAgICBjb25zdCBzdGF0c1Jlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0Sm9pblJlcXVlc3RTdGF0cyhpbnB1dCk7XG4gICAgICAgIGV4cGVjdChzdGF0c1Jlc3VsdC50b3RhbFJlcXVlc3RzKS50b0JlKDApO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBtYWludGFpbiBjb25zaXN0ZW50IGJlaGF2aW9yIHVuZGVyIHN0cmVzcycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFRlc3QgcmFwaWQgc3VjY2Vzc2l2ZSBjYWxsc1xuICAgICAgY29uc3QgcHJvbWlzZXMgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiAxMCB9LCBhc3luYyAoXywgaSkgPT4ge1xuICAgICAgICBjb25zdCBsaXN0UmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRKb2luUmVxdWVzdHMoeyBpbmRleDogaSB9KTtcbiAgICAgICAgY29uc3Qgc3RhdHNSZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldEpvaW5SZXF1ZXN0U3RhdHMoeyBpbmRleDogaSB9KTtcbiAgICAgICAgcmV0dXJuIHsgbGlzdDogbGlzdFJlc3VsdCwgc3RhdHM6IHN0YXRzUmVzdWx0IH07XG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IFByb21pc2UuYWxsKHByb21pc2VzKTtcbiAgICAgIFxuICAgICAgcmVzdWx0cy5mb3JFYWNoKHJlc3VsdCA9PiB7XG4gICAgICAgIGV4cGVjdChyZXN1bHQubGlzdC5yZXF1ZXN0cykudG9FcXVhbChbXSk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuc3RhdHMudG90YWxSZXF1ZXN0cykudG9CZSgwKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZWRnZSBjYXNlIHVzZXIgaW5wdXRzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZWRnZUNhc2VVc2VycyA9IFtcbiAgICAgICAgbnVsbCxcbiAgICAgICAgdW5kZWZpbmVkLFxuICAgICAgICB7IGlkOiBudWxsIH0sXG4gICAgICAgIHsgaWQ6ICcnIH0sXG4gICAgICAgIHsgcm9sZTogJ2ludmFsaWQnIH0sXG4gICAgICAgIHt9LFxuICAgICAgXTtcblxuICAgICAgZm9yIChjb25zdCB1c2VyIG9mIGVkZ2VDYXNlVXNlcnMpIHtcbiAgICAgICAgY29uc3QgcGVuZGluZ1Jlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0UGVuZGluZ1JlcXVlc3RzKHVzZXIpO1xuICAgICAgICBleHBlY3QocGVuZGluZ1Jlc3VsdCkudG9FcXVhbChbXSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdJbnRlZ3JhdGlvbiBUZXN0cycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBjb21wbGV0ZSBkaXNhYmxlZCB3b3JrZmxvdyBjb25zaXN0ZW50bHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBUZXN0IHRoYXQgYWxsIGVuZHBvaW50cyBtYWludGFpbiBjb25zaXN0ZW50IGRpc2FibGVkIHN0YXRlXG4gICAgICBjb25zdCBsaXN0UmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRKb2luUmVxdWVzdHMoe30pO1xuICAgICAgZXhwZWN0KGxpc3RSZXN1bHQucmVxdWVzdHMpLnRvSGF2ZUxlbmd0aCgwKTtcblxuICAgICAgY29uc3QgdXNlclJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0VXNlckpvaW5SZXF1ZXN0cyhURVNUX1VTRVJfSURTLkNMSUVOVCk7XG4gICAgICBleHBlY3QodXNlclJlc3VsdCkudG9IYXZlTGVuZ3RoKDApO1xuXG4gICAgICBjb25zdCBwZW5kaW5nUmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRQZW5kaW5nUmVxdWVzdHMobW9ja1VzZXIpO1xuICAgICAgZXhwZWN0KHBlbmRpbmdSZXN1bHQpLnRvSGF2ZUxlbmd0aCgwKTtcblxuICAgICAgY29uc3Qgc3RhdHNSZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldEpvaW5SZXF1ZXN0U3RhdHMoe30pO1xuICAgICAgZXhwZWN0KHN0YXRzUmVzdWx0LnRvdGFsUmVxdWVzdHMpLnRvQmUoMCk7XG5cbiAgICAgIC8vIFRlc3QgdGhhdCBhY3Rpb24gZW5kcG9pbnRzIGNvbnNpc3RlbnRseSB0aHJvdyBlcnJvcnNcbiAgICAgIGNvbnN0IGFjdGlvbk1ldGhvZHMgPSBbXG4gICAgICAgICgpID0+IGNvbnRyb2xsZXIuY3JlYXRlSm9pblJlcXVlc3Qoe30pLFxuICAgICAgICAoKSA9PiBjb250cm9sbGVyLnByb2Nlc3NKb2luUmVxdWVzdCgnaWQnLCB7fSwgbW9ja1VzZXIpLFxuICAgICAgICAoKSA9PiBjb250cm9sbGVyLmNhbmNlbEpvaW5SZXF1ZXN0KCdpZCcsIG1vY2tVc2VyKSxcbiAgICAgICAgKCkgPT4gY29udHJvbGxlci5idWxrUHJvY2Vzc0pvaW5SZXF1ZXN0cyh7fSwgbW9ja1VzZXIpLFxuICAgICAgXTtcblxuICAgICAgZm9yIChjb25zdCBtZXRob2Qgb2YgYWN0aW9uTWV0aG9kcykge1xuICAgICAgICBhd2FpdCBleHBlY3QobWV0aG9kKCkpLnJlamVjdHMudG9UaHJvdyhCYWRSZXF1ZXN0RXhjZXB0aW9uKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgQVBJIGNvbXBhdGliaWxpdHkgZm9yIGZ1dHVyZSBlbmFibGVtZW50JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gRW5zdXJlIHJlc3BvbnNlIHN0cnVjdHVyZXMgYXJlIGNvbXBhdGlibGUgd2l0aCBwb3RlbnRpYWwgZnV0dXJlIGVuYWJsZW1lbnRcbiAgICAgIGNvbnN0IGxpc3RSZXNwb25zZSA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0Sm9pblJlcXVlc3RzKHt9KTtcbiAgICAgIGV4cGVjdChsaXN0UmVzcG9uc2UpLnRvSGF2ZVByb3BlcnR5KCdyZXF1ZXN0cycpO1xuICAgICAgZXhwZWN0KGxpc3RSZXNwb25zZSkudG9IYXZlUHJvcGVydHkoJ3BhZ2luYXRpb24nKTtcbiAgICAgIGV4cGVjdChsaXN0UmVzcG9uc2UucGFnaW5hdGlvbikudG9IYXZlUHJvcGVydHkoJ3BhZ2UnKTtcbiAgICAgIGV4cGVjdChsaXN0UmVzcG9uc2UucGFnaW5hdGlvbikudG9IYXZlUHJvcGVydHkoJ2xpbWl0Jyk7XG5cbiAgICAgIGNvbnN0IHN0YXRzUmVzcG9uc2UgPSBhd2FpdCBjb250cm9sbGVyLmdldEpvaW5SZXF1ZXN0U3RhdHMoe30pO1xuICAgICAgZXhwZWN0KHN0YXRzUmVzcG9uc2UpLnRvSGF2ZVByb3BlcnR5KCd0b3RhbFJlcXVlc3RzJyk7XG4gICAgICBleHBlY3Qoc3RhdHNSZXNwb25zZSkudG9IYXZlUHJvcGVydHkoJ3JlcXVlc3RzQnlTdGF0dXMnKTtcbiAgICAgIGV4cGVjdChzdGF0c1Jlc3BvbnNlKS50b0hhdmVQcm9wZXJ0eSgncmVjZW50QWN0aXZpdHknKTtcblxuICAgICAgLy8gRW5zdXJlIGFsbCByZXF1aXJlZCBwcm9wZXJ0aWVzIGV4aXN0IGZvciBBUEkgY29udHJhY3RzXG4gICAgICBjb25zdCByZXF1aXJlZFN0YXRzUHJvcGVydGllcyA9IFtcbiAgICAgICAgJ3RvdGFsUmVxdWVzdHMnLCAncGVuZGluZ1JlcXVlc3RzJywgJ2FwcHJvdmVkUmVxdWVzdHMnLCBcbiAgICAgICAgJ3JlamVjdGVkUmVxdWVzdHMnLCAnYXZnUHJvY2Vzc2luZ1RpbWUnLCAncmVxdWVzdHNCeVN0YXR1cycsICdyZWNlbnRBY3Rpdml0eSdcbiAgICAgIF07XG4gICAgICBcbiAgICAgIHJlcXVpcmVkU3RhdHNQcm9wZXJ0aWVzLmZvckVhY2gocHJvcCA9PiB7XG4gICAgICAgIGV4cGVjdChzdGF0c1Jlc3BvbnNlKS50b0hhdmVQcm9wZXJ0eShwcm9wKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcbn0pOyJdLCJ2ZXJzaW9uIjozfQ==