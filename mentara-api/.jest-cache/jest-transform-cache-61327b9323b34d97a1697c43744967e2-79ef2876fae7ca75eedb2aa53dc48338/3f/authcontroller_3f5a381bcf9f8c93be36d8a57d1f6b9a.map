{"file":"/home/wetooa/Documents/code/projects/mentara/mentara-api/src/auth/auth.controller.ts","mappings":"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","names":[],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/auth/auth.controller.ts"],"sourcesContent":["import {\n  Body,\n  Controller,\n  Get,\n  HttpCode,\n  HttpStatus,\n  Post,\n  Query,\n  UseGuards,\n  Req,\n  UnauthorizedException,\n} from '@nestjs/common';\nimport { AuthGuard } from '@nestjs/passport';\nimport { Throttle } from '@nestjs/throttler';\nimport {\n  ApiTags,\n  ApiOperation,\n  ApiResponse,\n  ApiBody,\n  ApiBearerAuth,\n  ApiQuery,\n  ApiParam,\n  ApiSecurity,\n} from '@nestjs/swagger';\nimport { JwtAuthGuard } from 'src/auth/guards/jwt-auth.guard';\nimport { CurrentUserId } from 'src/auth/decorators/current-user-id.decorator';\nimport { Public } from 'src/auth/decorators/public.decorator';\nimport { ZodValidationPipe } from 'src/common/pipes/zod-validation.pipe';\nimport {\n  LoginDtoSchema,\n  RefreshTokenDtoSchema,\n  RegisterUserDtoSchema,\n  LogoutDtoSchema,\n  RequestPasswordResetDtoSchema,\n  ResetPasswordDtoSchema,\n  VerifyEmailDtoSchema,\n  ResendVerificationEmailDtoSchema,\n  type LoginDto,\n  type RefreshTokenDto,\n  type RegisterUserDto,\n  type LogoutDto,\n  type RequestPasswordResetDto,\n  type ResetPasswordDto,\n  type VerifyEmailDto,\n  type ResendVerificationEmailDto,\n} from 'mentara-commons';\nimport { AuthService } from './auth.service';\nimport { EmailVerificationService } from './services/email-verification.service';\nimport { PasswordResetService } from './services/password-reset.service';\nimport { Request } from 'express';\n\n@ApiTags('auth')\n@Controller('auth')\nexport class AuthController {\n  constructor(\n    private readonly authService: AuthService,\n    private readonly emailVerificationService: EmailVerificationService,\n    private readonly passwordResetService: PasswordResetService,\n  ) {}\n\n  // Role-specific registration endpoints moved to dedicated controllers:\n  // - /auth/client/register\n  // - /auth/therapist/register\n  // - /auth/admin/create-account\n  // - /auth/moderator/create-account\n\n  @UseGuards(JwtAuthGuard)\n  @ApiBearerAuth('JWT-auth')\n  @ApiOperation({ \n    summary: 'Get current user profile',\n    description: 'Retrieve the authenticated user\\'s profile information'\n  })\n  @ApiResponse({ \n    status: 200, \n    description: 'User profile retrieved successfully' \n  })\n  @ApiResponse({ \n    status: 401, \n    description: 'Unauthorized - Invalid or missing JWT token' \n  })\n  @Get('me')\n  async getMe(@CurrentUserId() id: string) {\n    return await this.authService.getUser(id);\n  }\n\n  @UseGuards(JwtAuthGuard)\n  @Get('users')\n  async getAllUsers() {\n    return await this.authService.getUsers();\n  }\n\n  @UseGuards(JwtAuthGuard)\n  @Throttle({ default: { limit: 20, ttl: 300000 } }) // 20 logout attempts per 5 minutes\n  @Post('force-logout')\n  @HttpCode(HttpStatus.OK)\n  async forceLogout(@CurrentUserId() id: string) {\n    return await this.authService.forceLogout(id);\n  }\n\n  // Local Authentication Endpoints\n  @Public()\n  @ApiOperation({ \n    summary: 'Register new user',\n    description: 'Register a new user account with email and password. Supports client and therapist roles only.' \n  })\n  @ApiBody({ \n    description: 'User registration details',\n    schema: {\n      type: 'object',\n      properties: {\n        email: { type: 'string', format: 'email', example: 'user@example.com' },\n        password: { type: 'string', minLength: 8, example: 'SecurePassword123!' },\n        firstName: { type: 'string', example: 'John' },\n        lastName: { type: 'string', example: 'Doe' },\n        role: { type: 'string', enum: ['client', 'therapist'], example: 'client' }\n      },\n      required: ['email', 'password', 'firstName', 'lastName', 'role']\n    }\n  })\n  @ApiResponse({ \n    status: 201, \n    description: 'User registered successfully',\n    schema: {\n      type: 'object',\n      properties: {\n        user: {\n          type: 'object',\n          properties: {\n            id: { type: 'string' },\n            email: { type: 'string' },\n            firstName: { type: 'string' },\n            lastName: { type: 'string' },\n            role: { type: 'string' }\n          }\n        },\n        accessToken: { type: 'string' },\n        refreshToken: { type: 'string' }\n      }\n    }\n  })\n  @ApiResponse({ \n    status: 400, \n    description: 'Bad request - Invalid input data' \n  })\n  @ApiResponse({ \n    status: 409, \n    description: 'Conflict - Email already exists' \n  })\n  @Throttle({ default: { limit: 5, ttl: 300000 } }) // 5 registration attempts per 5 minutes\n  @Post('register')\n  @HttpCode(HttpStatus.CREATED)\n  async register(\n    @Body(new ZodValidationPipe(RegisterUserDtoSchema))\n    registerDto: RegisterUserDto,\n  ) {\n    // Only allow client and therapist roles for general registration\n    const allowedRole =\n      registerDto.role === 'therapist' ? 'therapist' : 'client';\n\n    return await this.authService.registerUserWithEmail(\n      registerDto.email,\n      registerDto.password,\n      registerDto.firstName,\n      registerDto.lastName,\n      allowedRole,\n    );\n  }\n\n  @Public()\n  @ApiOperation({ \n    summary: 'User login',\n    description: 'Authenticate user with email and password, returning JWT tokens' \n  })\n  @ApiBody({ \n    description: 'Login credentials',\n    schema: {\n      type: 'object',\n      properties: {\n        email: { type: 'string', format: 'email', example: 'user@example.com' },\n        password: { type: 'string', example: 'SecurePassword123!' }\n      },\n      required: ['email', 'password']\n    }\n  })\n  @ApiResponse({ \n    status: 200, \n    description: 'Login successful',\n    schema: {\n      type: 'object',\n      properties: {\n        user: {\n          type: 'object',\n          properties: {\n            id: { type: 'string' },\n            email: { type: 'string' },\n            firstName: { type: 'string' },\n            lastName: { type: 'string' },\n            role: { type: 'string' },\n            emailVerified: { type: 'boolean' }\n          }\n        },\n        accessToken: { type: 'string' },\n        refreshToken: { type: 'string' },\n        expiresIn: { type: 'number' }\n      }\n    }\n  })\n  @ApiResponse({ \n    status: 401, \n    description: 'Unauthorized - Invalid credentials' \n  })\n  @ApiResponse({ \n    status: 429, \n    description: 'Too many login attempts' \n  })\n  @Throttle({ default: { limit: 10, ttl: 300000 } }) // 10 login attempts per 5 minutes\n  @Post('login')\n  @HttpCode(HttpStatus.OK)\n  async login(\n    @Body(new ZodValidationPipe(LoginDtoSchema)) loginDto: LoginDto,\n    @Req() req: Request,\n  ) {\n    const ipAddress = req.ip;\n    const userAgent = req.get('User-Agent');\n\n    const result = await this.authService.loginWithEmail(\n      loginDto.email,\n      loginDto.password,\n      ipAddress,\n      userAgent,\n    );\n\n    return {\n      user: {\n        id: result.user.id,\n        email: result.user.email,\n        firstName: result.user.firstName,\n        lastName: result.user.lastName,\n        role: result.user.role,\n        emailVerified: result.user.emailVerified,\n      },\n      accessToken: result.tokens.accessToken,\n      refreshToken: result.tokens.refreshToken,\n      expiresIn: result.tokens.expiresIn,\n    };\n  }\n\n  @Public()\n  @Throttle({ default: { limit: 20, ttl: 300000 } }) // 20 refresh attempts per 5 minutes\n  @Post('refresh')\n  @HttpCode(HttpStatus.OK)\n  async refreshTokens(\n    @Body(new ZodValidationPipe(RefreshTokenDtoSchema))\n    refreshDto: RefreshTokenDto,\n    @Req() req: Request,\n  ) {\n    if (!refreshDto.refreshToken) {\n      throw new UnauthorizedException('Refresh token required');\n    }\n\n    const ipAddress = req.ip;\n    const userAgent = req.get('User-Agent');\n\n    const tokens = await this.authService.refreshTokens(\n      refreshDto.refreshToken,\n      ipAddress,\n      userAgent,\n    );\n\n    return tokens;\n  }\n\n  @UseGuards(JwtAuthGuard)\n  @Post('logout')\n  @HttpCode(HttpStatus.OK)\n  async logout(\n    @Body(new ZodValidationPipe(LogoutDtoSchema)) logoutDto: LogoutDto,\n  ) {\n    if (logoutDto.refreshToken) {\n      await this.authService.logout(logoutDto.refreshToken);\n    }\n    return { message: 'Logged out successfully' };\n  }\n\n  @UseGuards(JwtAuthGuard)\n  @Get('profile')\n  async getProfile(@CurrentUserId() userId: string) {\n    const user = await this.authService.validateUser(userId);\n    if (!user) {\n      throw new UnauthorizedException('User not found');\n    }\n    return user;\n  }\n\n  // Role-specific profile endpoints moved to dedicated controllers:\n  // - /auth/client/profile\n  // - /auth/therapist/profile\n  // - /auth/admin/profile\n  // - /auth/moderator/profile\n\n  // ===== PASSWORD RESET ENDPOINTS =====\n\n  @Public()\n  @Throttle({ default: { limit: 5, ttl: 300000 } }) // 5 reset requests per 5 minutes\n  @Post('request-password-reset')\n  @HttpCode(HttpStatus.OK)\n  async requestPasswordReset(\n    @Body(new ZodValidationPipe(RequestPasswordResetDtoSchema))\n    requestResetDto: RequestPasswordResetDto,\n  ) {\n    await this.passwordResetService.requestPasswordReset(requestResetDto.email);\n    return {\n      message: 'If an account with that email exists, we will send a password reset link.',\n    };\n  }\n\n  @Public()\n  @Throttle({ default: { limit: 10, ttl: 300000 } }) // 10 reset attempts per 5 minutes\n  @Post('reset-password')\n  @HttpCode(HttpStatus.OK)\n  async resetPassword(\n    @Body(new ZodValidationPipe(ResetPasswordDtoSchema))\n    resetDto: ResetPasswordDto,\n  ) {\n    // Validate that passwords match\n    if (resetDto.newPassword !== resetDto.confirmPassword) {\n      throw new UnauthorizedException('Passwords do not match');\n    }\n\n    const result = await this.passwordResetService.resetPassword(\n      resetDto.token,\n      resetDto.newPassword,\n    );\n    return result;\n  }\n\n  @Public()\n  @Get('validate-reset-token')\n  async validateResetToken(@Query('token') token: string) {\n    const result = await this.passwordResetService.validateResetToken(token);\n    return result;\n  }\n\n  // ===== EMAIL VERIFICATION ENDPOINTS =====\n\n  @UseGuards(JwtAuthGuard)\n  @Throttle({ default: { limit: 3, ttl: 300000 } }) // 3 verification emails per 5 minutes\n  @Post('send-verification-email')\n  @HttpCode(HttpStatus.OK)\n  async sendVerificationEmail(@CurrentUserId() userId: string) {\n    await this.emailVerificationService.sendVerificationEmail(userId);\n    return {\n      message: 'Verification email sent successfully',\n    };\n  }\n\n  @Public()\n  @Throttle({ default: { limit: 5, ttl: 300000 } }) // 5 resend attempts per 5 minutes\n  @Post('resend-verification-email')\n  @HttpCode(HttpStatus.OK)\n  async resendVerificationEmail(\n    @Body(new ZodValidationPipe(ResendVerificationEmailDtoSchema))\n    resendDto: ResendVerificationEmailDto,\n  ) {\n    await this.emailVerificationService.resendVerificationEmail(resendDto.email);\n    return {\n      message: 'If an account with that email exists, we will send a verification link.',\n    };\n  }\n\n  @Public()\n  @Post('verify-email')\n  @HttpCode(HttpStatus.OK)\n  async verifyEmail(\n    @Body(new ZodValidationPipe(VerifyEmailDtoSchema))\n    verifyDto: VerifyEmailDto,\n  ) {\n    const result = await this.emailVerificationService.verifyEmail(verifyDto.token);\n    return result;\n  }\n\n  // Google OAuth Routes\n  @Public()\n  @Get('google')\n  @UseGuards(AuthGuard('google'))\n  async googleAuth(@Req() _req) {\n    // Initiates Google OAuth flow\n  }\n\n  @Public()\n  @Get('google/callback')\n  @UseGuards(AuthGuard('google'))\n  async googleAuthRedirect(@Req() req) {\n    // Handle Google OAuth callback\n    return this.authService.handleOAuthLogin(req.user, 'google');\n  }\n\n  // Microsoft OAuth Routes\n  @Public()\n  @Get('microsoft')\n  @UseGuards(AuthGuard('microsoft'))\n  async microsoftAuth(@Req() _req) {\n    // Initiates Microsoft OAuth flow\n  }\n\n  @Public()\n  @Get('microsoft/callback')\n  @UseGuards(AuthGuard('microsoft'))\n  async microsoftAuthRedirect(@Req() req) {\n    // Handle Microsoft OAuth callback\n    return this.authService.handleOAuthLogin(req.user, 'microsoft');\n  }\n}\n"],"version":3}