1baf4c1d7219a29c60ba94f58cc0599e
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
var _a, _b, _c, _d, _e;
Object.defineProperty(exports, "__esModule", { value: true });
exports.AuthController = void 0;
const common_1 = require("@nestjs/common");
const passport_1 = require("@nestjs/passport");
const throttler_1 = require("@nestjs/throttler");
const swagger_1 = require("@nestjs/swagger");
const jwt_auth_guard_1 = require("src/auth/guards/jwt-auth.guard");
const current_user_id_decorator_1 = require("src/auth/decorators/current-user-id.decorator");
const public_decorator_1 = require("src/auth/decorators/public.decorator");
const zod_validation_pipe_1 = require("src/common/pipes/zod-validation.pipe");
const mentara_commons_1 = require("mentara-commons");
const auth_service_1 = require("./auth.service");
const email_verification_service_1 = require("./services/email-verification.service");
const password_reset_service_1 = require("./services/password-reset.service");
const express_1 = require("express");
let AuthController = class AuthController {
    authService;
    emailVerificationService;
    passwordResetService;
    constructor(authService, emailVerificationService, passwordResetService) {
        this.authService = authService;
        this.emailVerificationService = emailVerificationService;
        this.passwordResetService = passwordResetService;
    }
    // Role-specific registration endpoints moved to dedicated controllers:
    // - /auth/client/register
    // - /auth/therapist/register
    // - /auth/admin/create-account
    // - /auth/moderator/create-account
    async getMe(id) {
        return await this.authService.getUser(id);
    }
    async getAllUsers() {
        return await this.authService.getUsers();
    }
    async forceLogout(id) {
        return await this.authService.forceLogout(id);
    }
    // Local Authentication Endpoints
    async register(registerDto) {
        // Only allow client and therapist roles for general registration
        const allowedRole = registerDto.role === 'therapist' ? 'therapist' : 'client';
        return await this.authService.registerUserWithEmail(registerDto.email, registerDto.password, registerDto.firstName, registerDto.lastName, allowedRole);
    }
    async login(loginDto, req) {
        const ipAddress = req.ip;
        const userAgent = req.get('User-Agent');
        const result = await this.authService.loginWithEmail(loginDto.email, loginDto.password, ipAddress, userAgent);
        return {
            user: {
                id: result.user.id,
                email: result.user.email,
                firstName: result.user.firstName,
                lastName: result.user.lastName,
                role: result.user.role,
                emailVerified: result.user.emailVerified,
            },
            accessToken: result.tokens.accessToken,
            refreshToken: result.tokens.refreshToken,
            expiresIn: result.tokens.expiresIn,
        };
    }
    async refreshTokens(refreshDto, req) {
        if (!refreshDto.refreshToken) {
            throw new common_1.UnauthorizedException('Refresh token required');
        }
        const ipAddress = req.ip;
        const userAgent = req.get('User-Agent');
        const tokens = await this.authService.refreshTokens(refreshDto.refreshToken, ipAddress, userAgent);
        return tokens;
    }
    async logout(logoutDto) {
        if (logoutDto.refreshToken) {
            await this.authService.logout(logoutDto.refreshToken);
        }
        return { message: 'Logged out successfully' };
    }
    async getProfile(userId) {
        const user = await this.authService.validateUser(userId);
        if (!user) {
            throw new common_1.UnauthorizedException('User not found');
        }
        return user;
    }
    // Role-specific profile endpoints moved to dedicated controllers:
    // - /auth/client/profile
    // - /auth/therapist/profile
    // - /auth/admin/profile
    // - /auth/moderator/profile
    // ===== PASSWORD RESET ENDPOINTS =====
    async requestPasswordReset(requestResetDto) {
        await this.passwordResetService.requestPasswordReset(requestResetDto.email);
        return {
            message: 'If an account with that email exists, we will send a password reset link.',
        };
    }
    async resetPassword(resetDto) {
        // Validate that passwords match
        if (resetDto.newPassword !== resetDto.confirmPassword) {
            throw new common_1.UnauthorizedException('Passwords do not match');
        }
        const result = await this.passwordResetService.resetPassword(resetDto.token, resetDto.newPassword);
        return result;
    }
    async validateResetToken(token) {
        const result = await this.passwordResetService.validateResetToken(token);
        return result;
    }
    // ===== EMAIL VERIFICATION ENDPOINTS =====
    async sendVerificationEmail(userId) {
        await this.emailVerificationService.sendVerificationEmail(userId);
        return {
            message: 'Verification email sent successfully',
        };
    }
    async resendVerificationEmail(resendDto) {
        await this.emailVerificationService.resendVerificationEmail(resendDto.email);
        return {
            message: 'If an account with that email exists, we will send a verification link.',
        };
    }
    async verifyEmail(verifyDto) {
        const result = await this.emailVerificationService.verifyEmail(verifyDto.token);
        return result;
    }
    // Google OAuth Routes
    async googleAuth(_req) {
        // Initiates Google OAuth flow
    }
    async googleAuthRedirect(req) {
        // Handle Google OAuth callback
        return this.authService.handleOAuthLogin(req.user, 'google');
    }
    // Microsoft OAuth Routes
    async microsoftAuth(_req) {
        // Initiates Microsoft OAuth flow
    }
    async microsoftAuthRedirect(req) {
        // Handle Microsoft OAuth callback
        return this.authService.handleOAuthLogin(req.user, 'microsoft');
    }
};
exports.AuthController = AuthController;
__decorate([
    (0, common_1.UseGuards)(jwt_auth_guard_1.JwtAuthGuard),
    (0, swagger_1.ApiBearerAuth)('JWT-auth'),
    (0, swagger_1.ApiOperation)({
        summary: 'Get current user profile',
        description: 'Retrieve the authenticated user\'s profile information'
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'User profile retrieved successfully'
    }),
    (0, swagger_1.ApiResponse)({
        status: 401,
        description: 'Unauthorized - Invalid or missing JWT token'
    }),
    (0, common_1.Get)('me'),
    __param(0, (0, current_user_id_decorator_1.CurrentUserId)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "getMe", null);
__decorate([
    (0, common_1.UseGuards)(jwt_auth_guard_1.JwtAuthGuard),
    (0, common_1.Get)('users'),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", []),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "getAllUsers", null);
__decorate([
    (0, common_1.UseGuards)(jwt_auth_guard_1.JwtAuthGuard),
    (0, throttler_1.Throttle)({ default: { limit: 20, ttl: 300000 } }) // 20 logout attempts per 5 minutes
    ,
    (0, common_1.Post)('force-logout'),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, current_user_id_decorator_1.CurrentUserId)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "forceLogout", null);
__decorate([
    (0, public_decorator_1.Public)(),
    (0, swagger_1.ApiOperation)({
        summary: 'Register new user',
        description: 'Register a new user account with email and password. Supports client and therapist roles only.'
    }),
    (0, swagger_1.ApiBody)({
        description: 'User registration details',
        schema: {
            type: 'object',
            properties: {
                email: { type: 'string', format: 'email', example: 'user@example.com' },
                password: { type: 'string', minLength: 8, example: 'SecurePassword123!' },
                firstName: { type: 'string', example: 'John' },
                lastName: { type: 'string', example: 'Doe' },
                role: { type: 'string', enum: ['client', 'therapist'], example: 'client' }
            },
            required: ['email', 'password', 'firstName', 'lastName', 'role']
        }
    }),
    (0, swagger_1.ApiResponse)({
        status: 201,
        description: 'User registered successfully',
        schema: {
            type: 'object',
            properties: {
                user: {
                    type: 'object',
                    properties: {
                        id: { type: 'string' },
                        email: { type: 'string' },
                        firstName: { type: 'string' },
                        lastName: { type: 'string' },
                        role: { type: 'string' }
                    }
                },
                accessToken: { type: 'string' },
                refreshToken: { type: 'string' }
            }
        }
    }),
    (0, swagger_1.ApiResponse)({
        status: 400,
        description: 'Bad request - Invalid input data'
    }),
    (0, swagger_1.ApiResponse)({
        status: 409,
        description: 'Conflict - Email already exists'
    }),
    (0, throttler_1.Throttle)({ default: { limit: 5, ttl: 300000 } }) // 5 registration attempts per 5 minutes
    ,
    (0, common_1.Post)('register'),
    (0, common_1.HttpCode)(common_1.HttpStatus.CREATED),
    __param(0, (0, common_1.Body)(new zod_validation_pipe_1.ZodValidationPipe(mentara_commons_1.RegisterUserDtoSchema))),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "register", null);
__decorate([
    (0, public_decorator_1.Public)(),
    (0, swagger_1.ApiOperation)({
        summary: 'User login',
        description: 'Authenticate user with email and password, returning JWT tokens'
    }),
    (0, swagger_1.ApiBody)({
        description: 'Login credentials',
        schema: {
            type: 'object',
            properties: {
                email: { type: 'string', format: 'email', example: 'user@example.com' },
                password: { type: 'string', example: 'SecurePassword123!' }
            },
            required: ['email', 'password']
        }
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Login successful',
        schema: {
            type: 'object',
            properties: {
                user: {
                    type: 'object',
                    properties: {
                        id: { type: 'string' },
                        email: { type: 'string' },
                        firstName: { type: 'string' },
                        lastName: { type: 'string' },
                        role: { type: 'string' },
                        emailVerified: { type: 'boolean' }
                    }
                },
                accessToken: { type: 'string' },
                refreshToken: { type: 'string' },
                expiresIn: { type: 'number' }
            }
        }
    }),
    (0, swagger_1.ApiResponse)({
        status: 401,
        description: 'Unauthorized - Invalid credentials'
    }),
    (0, swagger_1.ApiResponse)({
        status: 429,
        description: 'Too many login attempts'
    }),
    (0, throttler_1.Throttle)({ default: { limit: 10, ttl: 300000 } }) // 10 login attempts per 5 minutes
    ,
    (0, common_1.Post)('login'),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, common_1.Body)(new zod_validation_pipe_1.ZodValidationPipe(mentara_commons_1.LoginDtoSchema))),
    __param(1, (0, common_1.Req)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object, typeof (_d = typeof express_1.Request !== "undefined" && express_1.Request) === "function" ? _d : Object]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "login", null);
__decorate([
    (0, public_decorator_1.Public)(),
    (0, throttler_1.Throttle)({ default: { limit: 20, ttl: 300000 } }) // 20 refresh attempts per 5 minutes
    ,
    (0, common_1.Post)('refresh'),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, common_1.Body)(new zod_validation_pipe_1.ZodValidationPipe(mentara_commons_1.RefreshTokenDtoSchema))),
    __param(1, (0, common_1.Req)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object, typeof (_e = typeof express_1.Request !== "undefined" && express_1.Request) === "function" ? _e : Object]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "refreshTokens", null);
__decorate([
    (0, common_1.UseGuards)(jwt_auth_guard_1.JwtAuthGuard),
    (0, common_1.Post)('logout'),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, common_1.Body)(new zod_validation_pipe_1.ZodValidationPipe(mentara_commons_1.LogoutDtoSchema))),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "logout", null);
__decorate([
    (0, common_1.UseGuards)(jwt_auth_guard_1.JwtAuthGuard),
    (0, common_1.Get)('profile'),
    __param(0, (0, current_user_id_decorator_1.CurrentUserId)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "getProfile", null);
__decorate([
    (0, public_decorator_1.Public)(),
    (0, throttler_1.Throttle)({ default: { limit: 5, ttl: 300000 } }) // 5 reset requests per 5 minutes
    ,
    (0, common_1.Post)('request-password-reset'),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, common_1.Body)(new zod_validation_pipe_1.ZodValidationPipe(mentara_commons_1.RequestPasswordResetDtoSchema))),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "requestPasswordReset", null);
__decorate([
    (0, public_decorator_1.Public)(),
    (0, throttler_1.Throttle)({ default: { limit: 10, ttl: 300000 } }) // 10 reset attempts per 5 minutes
    ,
    (0, common_1.Post)('reset-password'),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, common_1.Body)(new zod_validation_pipe_1.ZodValidationPipe(mentara_commons_1.ResetPasswordDtoSchema))),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "resetPassword", null);
__decorate([
    (0, public_decorator_1.Public)(),
    (0, common_1.Get)('validate-reset-token'),
    __param(0, (0, common_1.Query)('token')),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "validateResetToken", null);
__decorate([
    (0, common_1.UseGuards)(jwt_auth_guard_1.JwtAuthGuard),
    (0, throttler_1.Throttle)({ default: { limit: 3, ttl: 300000 } }) // 3 verification emails per 5 minutes
    ,
    (0, common_1.Post)('send-verification-email'),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, current_user_id_decorator_1.CurrentUserId)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "sendVerificationEmail", null);
__decorate([
    (0, public_decorator_1.Public)(),
    (0, throttler_1.Throttle)({ default: { limit: 5, ttl: 300000 } }) // 5 resend attempts per 5 minutes
    ,
    (0, common_1.Post)('resend-verification-email'),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, common_1.Body)(new zod_validation_pipe_1.ZodValidationPipe(mentara_commons_1.ResendVerificationEmailDtoSchema))),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "resendVerificationEmail", null);
__decorate([
    (0, public_decorator_1.Public)(),
    (0, common_1.Post)('verify-email'),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, common_1.Body)(new zod_validation_pipe_1.ZodValidationPipe(mentara_commons_1.VerifyEmailDtoSchema))),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "verifyEmail", null);
__decorate([
    (0, public_decorator_1.Public)(),
    (0, common_1.Get)('google'),
    (0, common_1.UseGuards)((0, passport_1.AuthGuard)('google')),
    __param(0, (0, common_1.Req)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "googleAuth", null);
__decorate([
    (0, public_decorator_1.Public)(),
    (0, common_1.Get)('google/callback'),
    (0, common_1.UseGuards)((0, passport_1.AuthGuard)('google')),
    __param(0, (0, common_1.Req)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "googleAuthRedirect", null);
__decorate([
    (0, public_decorator_1.Public)(),
    (0, common_1.Get)('microsoft'),
    (0, common_1.UseGuards)((0, passport_1.AuthGuard)('microsoft')),
    __param(0, (0, common_1.Req)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "microsoftAuth", null);
__decorate([
    (0, public_decorator_1.Public)(),
    (0, common_1.Get)('microsoft/callback'),
    (0, common_1.UseGuards)((0, passport_1.AuthGuard)('microsoft')),
    __param(0, (0, common_1.Req)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "microsoftAuthRedirect", null);
exports.AuthController = AuthController = __decorate([
    (0, swagger_1.ApiTags)('auth'),
    (0, common_1.Controller)('auth'),
    __metadata("design:paramtypes", [typeof (_a = typeof auth_service_1.AuthService !== "undefined" && auth_service_1.AuthService) === "function" ? _a : Object, typeof (_b = typeof email_verification_service_1.EmailVerificationService !== "undefined" && email_verification_service_1.EmailVerificationService) === "function" ? _b : Object, typeof (_c = typeof password_reset_service_1.PasswordResetService !== "undefined" && password_reset_service_1.PasswordResetService) === "function" ? _c : Object])
], AuthController);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL2F1dGgvYXV0aC5jb250cm9sbGVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSwyQ0FXd0I7QUFDeEIsK0NBQTZDO0FBQzdDLGlEQUE2QztBQUM3Qyw2Q0FTeUI7QUFDekIsbUVBQThEO0FBQzlELDZGQUE4RTtBQUM5RSwyRUFBOEQ7QUFDOUQsOEVBQXlFO0FBQ3pFLHFEQWlCeUI7QUFDekIsaURBQTZDO0FBQzdDLHNGQUFpRjtBQUNqRiw4RUFBeUU7QUFDekUscUNBQWtDO0FBSTNCLElBQU0sY0FBYyxHQUFwQixNQUFNLGNBQWM7SUFFTjtJQUNBO0lBQ0E7SUFIbkIsWUFDbUIsV0FBd0IsRUFDeEIsd0JBQWtELEVBQ2xELG9CQUEwQztRQUYxQyxnQkFBVyxHQUFYLFdBQVcsQ0FBYTtRQUN4Qiw2QkFBd0IsR0FBeEIsd0JBQXdCLENBQTBCO1FBQ2xELHlCQUFvQixHQUFwQixvQkFBb0IsQ0FBc0I7SUFDMUQsQ0FBQztJQUVKLHVFQUF1RTtJQUN2RSwwQkFBMEI7SUFDMUIsNkJBQTZCO0lBQzdCLCtCQUErQjtJQUMvQixtQ0FBbUM7SUFpQjdCLEFBQU4sS0FBSyxDQUFDLEtBQUssQ0FBa0IsRUFBVTtRQUNyQyxPQUFPLE1BQU0sSUFBSSxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLENBQUM7SUFDNUMsQ0FBQztJQUlLLEFBQU4sS0FBSyxDQUFDLFdBQVc7UUFDZixPQUFPLE1BQU0sSUFBSSxDQUFDLFdBQVcsQ0FBQyxRQUFRLEVBQUUsQ0FBQztJQUMzQyxDQUFDO0lBTUssQUFBTixLQUFLLENBQUMsV0FBVyxDQUFrQixFQUFVO1FBQzNDLE9BQU8sTUFBTSxJQUFJLENBQUMsV0FBVyxDQUFDLFdBQVcsQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUNoRCxDQUFDO0lBRUQsaUNBQWlDO0lBb0QzQixBQUFOLEtBQUssQ0FBQyxRQUFRLENBRVosV0FB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L0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL2F1dGgvYXV0aC5jb250cm9sbGVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIEJvZHksXG4gIENvbnRyb2xsZXIsXG4gIEdldCxcbiAgSHR0cENvZGUsXG4gIEh0dHBTdGF0dXMsXG4gIFBvc3QsXG4gIFF1ZXJ5LFxuICBVc2VHdWFyZHMsXG4gIFJlcSxcbiAgVW5hdXRob3JpemVkRXhjZXB0aW9uLFxufSBmcm9tICdAbmVzdGpzL2NvbW1vbic7XG5pbXBvcnQgeyBBdXRoR3VhcmQgfSBmcm9tICdAbmVzdGpzL3Bhc3Nwb3J0JztcbmltcG9ydCB7IFRocm90dGxlIH0gZnJvbSAnQG5lc3Rqcy90aHJvdHRsZXInO1xuaW1wb3J0IHtcbiAgQXBpVGFncyxcbiAgQXBpT3BlcmF0aW9uLFxuICBBcGlSZXNwb25zZSxcbiAgQXBpQm9keSxcbiAgQXBpQmVhcmVyQXV0aCxcbiAgQXBpUXVlcnksXG4gIEFwaVBhcmFtLFxuICBBcGlTZWN1cml0eSxcbn0gZnJvbSAnQG5lc3Rqcy9zd2FnZ2VyJztcbmltcG9ydCB7IEp3dEF1dGhHdWFyZCB9IGZyb20gJ3NyYy9hdXRoL2d1YXJkcy9qd3QtYXV0aC5ndWFyZCc7XG5pbXBvcnQgeyBDdXJyZW50VXNlcklkIH0gZnJvbSAnc3JjL2F1dGgvZGVjb3JhdG9ycy9jdXJyZW50LXVzZXItaWQuZGVjb3JhdG9yJztcbmltcG9ydCB7IFB1YmxpYyB9IGZyb20gJ3NyYy9hdXRoL2RlY29yYXRvcnMvcHVibGljLmRlY29yYXRvcic7XG5pbXBvcnQgeyBab2RWYWxpZGF0aW9uUGlwZSB9IGZyb20gJ3NyYy9jb21tb24vcGlwZXMvem9kLXZhbGlkYXRpb24ucGlwZSc7XG5pbXBvcnQge1xuICBMb2dpbkR0b1NjaGVtYSxcbiAgUmVmcmVzaFRva2VuRHRvU2NoZW1hLFxuICBSZWdpc3RlclVzZXJEdG9TY2hlbWEsXG4gIExvZ291dER0b1NjaGVtYSxcbiAgUmVxdWVzdFBhc3N3b3JkUmVzZXREdG9TY2hlbWEsXG4gIFJlc2V0UGFzc3dvcmREdG9TY2hlbWEsXG4gIFZlcmlmeUVtYWlsRHRvU2NoZW1hLFxuICBSZXNlbmRWZXJpZmljYXRpb25FbWFpbER0b1NjaGVtYSxcbiAgdHlwZSBMb2dpbkR0byxcbiAgdHlwZSBSZWZyZXNoVG9rZW5EdG8sXG4gIHR5cGUgUmVnaXN0ZXJVc2VyRHRvLFxuICB0eXBlIExvZ291dER0byxcbiAgdHlwZSBSZXF1ZXN0UGFzc3dvcmRSZXNldER0byxcbiAgdHlwZSBSZXNldFBhc3N3b3JkRHRvLFxuICB0eXBlIFZlcmlmeUVtYWlsRHRvLFxuICB0eXBlIFJlc2VuZFZlcmlmaWNhdGlvbkVtYWlsRHRvLFxufSBmcm9tICdtZW50YXJhLWNvbW1vbnMnO1xuaW1wb3J0IHsgQXV0aFNlcnZpY2UgfSBmcm9tICcuL2F1dGguc2VydmljZSc7XG5pbXBvcnQgeyBFbWFpbFZlcmlmaWNhdGlvblNlcnZpY2UgfSBmcm9tICcuL3NlcnZpY2VzL2VtYWlsLXZlcmlmaWNhdGlvbi5zZXJ2aWNlJztcbmltcG9ydCB7IFBhc3N3b3JkUmVzZXRTZXJ2aWNlIH0gZnJvbSAnLi9zZXJ2aWNlcy9wYXNzd29yZC1yZXNldC5zZXJ2aWNlJztcbmltcG9ydCB7IFJlcXVlc3QgfSBmcm9tICdleHByZXNzJztcblxuQEFwaVRhZ3MoJ2F1dGgnKVxuQENvbnRyb2xsZXIoJ2F1dGgnKVxuZXhwb3J0IGNsYXNzIEF1dGhDb250cm9sbGVyIHtcbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSByZWFkb25seSBhdXRoU2VydmljZTogQXV0aFNlcnZpY2UsXG4gICAgcHJpdmF0ZSByZWFkb25seSBlbWFpbFZlcmlmaWNhdGlvblNlcnZpY2U6IEVtYWlsVmVyaWZpY2F0aW9uU2VydmljZSxcbiAgICBwcml2YXRlIHJlYWRvbmx5IHBhc3N3b3JkUmVzZXRTZXJ2aWNlOiBQYXNzd29yZFJlc2V0U2VydmljZSxcbiAgKSB7fVxuXG4gIC8vIFJvbGUtc3BlY2lmaWMgcmVnaXN0cmF0aW9uIGVuZHBvaW50cyBtb3ZlZCB0byBkZWRpY2F0ZWQgY29udHJvbGxlcnM6XG4gIC8vIC0gL2F1dGgvY2xpZW50L3JlZ2lzdGVyXG4gIC8vIC0gL2F1dGgvdGhlcmFwaXN0L3JlZ2lzdGVyXG4gIC8vIC0gL2F1dGgvYWRtaW4vY3JlYXRlLWFjY291bnRcbiAgLy8gLSAvYXV0aC9tb2RlcmF0b3IvY3JlYXRlLWFjY291bnRcblxuICBAVXNlR3VhcmRzKEp3dEF1dGhHdWFyZClcbiAgQEFwaUJlYXJlckF1dGgoJ0pXVC1hdXRoJylcbiAgQEFwaU9wZXJhdGlvbih7IFxuICAgIHN1bW1hcnk6ICdHZXQgY3VycmVudCB1c2VyIHByb2ZpbGUnLFxuICAgIGRlc2NyaXB0aW9uOiAnUmV0cmlldmUgdGhlIGF1dGhlbnRpY2F0ZWQgdXNlclxcJ3MgcHJvZmlsZSBpbmZvcm1hdGlvbidcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHsgXG4gICAgc3RhdHVzOiAyMDAsIFxuICAgIGRlc2NyaXB0aW9uOiAnVXNlciBwcm9maWxlIHJldHJpZXZlZCBzdWNjZXNzZnVsbHknIFxuICB9KVxuICBAQXBpUmVzcG9uc2UoeyBcbiAgICBzdGF0dXM6IDQwMSwgXG4gICAgZGVzY3JpcHRpb246ICdVbmF1dGhvcml6ZWQgLSBJbnZhbGlkIG9yIG1pc3NpbmcgSldUIHRva2VuJyBcbiAgfSlcbiAgQEdldCgnbWUnKVxuICBhc3luYyBnZXRNZShAQ3VycmVudFVzZXJJZCgpIGlkOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5hdXRoU2VydmljZS5nZXRVc2VyKGlkKTtcbiAgfVxuXG4gIEBVc2VHdWFyZHMoSnd0QXV0aEd1YXJkKVxuICBAR2V0KCd1c2VycycpXG4gIGFzeW5jIGdldEFsbFVzZXJzKCkge1xuICAgIHJldHVybiBhd2FpdCB0aGlzLmF1dGhTZXJ2aWNlLmdldFVzZXJzKCk7XG4gIH1cblxuICBAVXNlR3VhcmRzKEp3dEF1dGhHdWFyZClcbiAgQFRocm90dGxlKHsgZGVmYXVsdDogeyBsaW1pdDogMjAsIHR0bDogMzAwMDAwIH0gfSkgLy8gMjAgbG9nb3V0IGF0dGVtcHRzIHBlciA1IG1pbnV0ZXNcbiAgQFBvc3QoJ2ZvcmNlLWxvZ291dCcpXG4gIEBIdHRwQ29kZShIdHRwU3RhdHVzLk9LKVxuICBhc3luYyBmb3JjZUxvZ291dChAQ3VycmVudFVzZXJJZCgpIGlkOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5hdXRoU2VydmljZS5mb3JjZUxvZ291dChpZCk7XG4gIH1cblxuICAvLyBMb2NhbCBBdXRoZW50aWNhdGlvbiBFbmRwb2ludHNcbiAgQFB1YmxpYygpXG4gIEBBcGlPcGVyYXRpb24oeyBcbiAgICBzdW1tYXJ5OiAnUmVnaXN0ZXIgbmV3IHVzZXInLFxuICAgIGRlc2NyaXB0aW9uOiAnUmVnaXN0ZXIgYSBuZXcgdXNlciBhY2NvdW50IHdpdGggZW1haWwgYW5kIHBhc3N3b3JkLiBTdXBwb3J0cyBjbGllbnQgYW5kIHRoZXJhcGlzdCByb2xlcyBvbmx5LicgXG4gIH0pXG4gIEBBcGlCb2R5KHsgXG4gICAgZGVzY3JpcHRpb246ICdVc2VyIHJlZ2lzdHJhdGlvbiBkZXRhaWxzJyxcbiAgICBzY2hlbWE6IHtcbiAgICAgIHR5cGU6ICdvYmplY3QnLFxuICAgICAgcHJvcGVydGllczoge1xuICAgICAgICBlbWFpbDogeyB0eXBlOiAnc3RyaW5nJywgZm9ybWF0OiAnZW1haWwnLCBleGFtcGxlOiAndXNlckBleGFtcGxlLmNvbScgfSxcbiAgICAgICAgcGFzc3dvcmQ6IHsgdHlwZTogJ3N0cmluZycsIG1pbkxlbmd0aDogOCwgZXhhbXBsZTogJ1NlY3VyZVBhc3N3b3JkMTIzIScgfSxcbiAgICAgICAgZmlyc3ROYW1lOiB7IHR5cGU6ICdzdHJpbmcnLCBleGFtcGxlOiAnSm9obicgfSxcbiAgICAgICAgbGFzdE5hbWU6IHsgdHlwZTogJ3N0cmluZycsIGV4YW1wbGU6ICdEb2UnIH0sXG4gICAgICAgIHJvbGU6IHsgdHlwZTogJ3N0cmluZycsIGVudW06IFsnY2xpZW50JywgJ3RoZXJhcGlzdCddLCBleGFtcGxlOiAnY2xpZW50JyB9XG4gICAgICB9LFxuICAgICAgcmVxdWlyZWQ6IFsnZW1haWwnLCAncGFzc3dvcmQnLCAnZmlyc3ROYW1lJywgJ2xhc3ROYW1lJywgJ3JvbGUnXVxuICAgIH1cbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHsgXG4gICAgc3RhdHVzOiAyMDEsIFxuICAgIGRlc2NyaXB0aW9uOiAnVXNlciByZWdpc3RlcmVkIHN1Y2Nlc3NmdWxseScsXG4gICAgc2NoZW1hOiB7XG4gICAgICB0eXBlOiAnb2JqZWN0JyxcbiAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIHR5cGU6ICdvYmplY3QnLFxuICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgIGlkOiB7IHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICAgICAgICBlbWFpbDogeyB0eXBlOiAnc3RyaW5nJyB9LFxuICAgICAgICAgICAgZmlyc3ROYW1lOiB7IHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICAgICAgICBsYXN0TmFtZTogeyB0eXBlOiAnc3RyaW5nJyB9LFxuICAgICAgICAgICAgcm9sZTogeyB0eXBlOiAnc3RyaW5nJyB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBhY2Nlc3NUb2tlbjogeyB0eXBlOiAnc3RyaW5nJyB9LFxuICAgICAgICByZWZyZXNoVG9rZW46IHsgdHlwZTogJ3N0cmluZycgfVxuICAgICAgfVxuICAgIH1cbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHsgXG4gICAgc3RhdHVzOiA0MDAsIFxuICAgIGRlc2NyaXB0aW9uOiAnQmFkIHJlcXVlc3QgLSBJbnZhbGlkIGlucHV0IGRhdGEnIFxuICB9KVxuICBAQXBpUmVzcG9uc2UoeyBcbiAgICBzdGF0dXM6IDQwOSwgXG4gICAgZGVzY3JpcHRpb246ICdDb25mbGljdCAtIEVtYWlsIGFscmVhZHkgZXhpc3RzJyBcbiAgfSlcbiAgQFRocm90dGxlKHsgZGVmYXVsdDogeyBsaW1pdDogNSwgdHRsOiAzMDAwMDAgfSB9KSAvLyA1IHJlZ2lzdHJhdGlvbiBhdHRlbXB0cyBwZXIgNSBtaW51dGVzXG4gIEBQb3N0KCdyZWdpc3RlcicpXG4gIEBIdHRwQ29kZShIdHRwU3RhdHVzLkNSRUFURUQpXG4gIGFzeW5jIHJlZ2lzdGVyKFxuICAgIEBCb2R5KG5ldyBab2RWYWxpZGF0aW9uUGlwZShSZWdpc3RlclVzZXJEdG9TY2hlbWEpKVxuICAgIHJlZ2lzdGVyRHRvOiBSZWdpc3RlclVzZXJEdG8sXG4gICkge1xuICAgIC8vIE9ubHkgYWxsb3cgY2xpZW50IGFuZCB0aGVyYXBpc3Qgcm9sZXMgZm9yIGdlbmVyYWwgcmVnaXN0cmF0aW9uXG4gICAgY29uc3QgYWxsb3dlZFJvbGUgPVxuICAgICAgcmVnaXN0ZXJEdG8ucm9sZSA9PT0gJ3RoZXJhcGlzdCcgPyAndGhlcmFwaXN0JyA6ICdjbGllbnQnO1xuXG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuYXV0aFNlcnZpY2UucmVnaXN0ZXJVc2VyV2l0aEVtYWlsKFxuICAgICAgcmVnaXN0ZXJEdG8uZW1haWwsXG4gICAgICByZWdpc3RlckR0by5wYXNzd29yZCxcbiAgICAgIHJlZ2lzdGVyRHRvLmZpcnN0TmFtZSxcbiAgICAgIHJlZ2lzdGVyRHRvLmxhc3ROYW1lLFxuICAgICAgYWxsb3dlZFJvbGUsXG4gICAgKTtcbiAgfVxuXG4gIEBQdWJsaWMoKVxuICBAQXBpT3BlcmF0aW9uKHsgXG4gICAgc3VtbWFyeTogJ1VzZXIgbG9naW4nLFxuICAgIGRlc2NyaXB0aW9uOiAnQXV0aGVudGljYXRlIHVzZXIgd2l0aCBlbWFpbCBhbmQgcGFzc3dvcmQsIHJldHVybmluZyBKV1QgdG9rZW5zJyBcbiAgfSlcbiAgQEFwaUJvZHkoeyBcbiAgICBkZXNjcmlwdGlvbjogJ0xvZ2luIGNyZWRlbnRpYWxzJyxcbiAgICBzY2hlbWE6IHtcbiAgICAgIHR5cGU6ICdvYmplY3QnLFxuICAgICAgcHJvcGVydGllczoge1xuICAgICAgICBlbWFpbDogeyB0eXBlOiAnc3RyaW5nJywgZm9ybWF0OiAnZW1haWwnLCBleGFtcGxlOiAndXNlckBleGFtcGxlLmNvbScgfSxcbiAgICAgICAgcGFzc3dvcmQ6IHsgdHlwZTogJ3N0cmluZycsIGV4YW1wbGU6ICdTZWN1cmVQYXNzd29yZDEyMyEnIH1cbiAgICAgIH0sXG4gICAgICByZXF1aXJlZDogWydlbWFpbCcsICdwYXNzd29yZCddXG4gICAgfVxuICB9KVxuICBAQXBpUmVzcG9uc2UoeyBcbiAgICBzdGF0dXM6IDIwMCwgXG4gICAgZGVzY3JpcHRpb246ICdMb2dpbiBzdWNjZXNzZnVsJyxcbiAgICBzY2hlbWE6IHtcbiAgICAgIHR5cGU6ICdvYmplY3QnLFxuICAgICAgcHJvcGVydGllczoge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgdHlwZTogJ29iamVjdCcsXG4gICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgaWQ6IHsgdHlwZTogJ3N0cmluZycgfSxcbiAgICAgICAgICAgIGVtYWlsOiB7IHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICAgICAgICBmaXJzdE5hbWU6IHsgdHlwZTogJ3N0cmluZycgfSxcbiAgICAgICAgICAgIGxhc3ROYW1lOiB7IHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICAgICAgICByb2xlOiB7IHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB7IHR5cGU6ICdib29sZWFuJyB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBhY2Nlc3NUb2tlbjogeyB0eXBlOiAnc3RyaW5nJyB9LFxuICAgICAgICByZWZyZXNoVG9rZW46IHsgdHlwZTogJ3N0cmluZycgfSxcbiAgICAgICAgZXhwaXJlc0luOiB7IHR5cGU6ICdudW1iZXInIH1cbiAgICAgIH1cbiAgICB9XG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7IFxuICAgIHN0YXR1czogNDAxLCBcbiAgICBkZXNjcmlwdGlvbjogJ1VuYXV0aG9yaXplZCAtIEludmFsaWQgY3JlZGVudGlhbHMnIFxuICB9KVxuICBAQXBpUmVzcG9uc2UoeyBcbiAgICBzdGF0dXM6IDQyOSwgXG4gICAgZGVzY3JpcHRpb246ICdUb28gbWFueSBsb2dpbiBhdHRlbXB0cycgXG4gIH0pXG4gIEBUaHJvdHRsZSh7IGRlZmF1bHQ6IHsgbGltaXQ6IDEwLCB0dGw6IDMwMDAwMCB9IH0pIC8vIDEwIGxvZ2luIGF0dGVtcHRzIHBlciA1IG1pbnV0ZXNcbiAgQFBvc3QoJ2xvZ2luJylcbiAgQEh0dHBDb2RlKEh0dHBTdGF0dXMuT0spXG4gIGFzeW5jIGxvZ2luKFxuICAgIEBCb2R5KG5ldyBab2RWYWxpZGF0aW9uUGlwZShMb2dpbkR0b1NjaGVtYSkpIGxvZ2luRHRvOiBMb2dpbkR0byxcbiAgICBAUmVxKCkgcmVxOiBSZXF1ZXN0LFxuICApIHtcbiAgICBjb25zdCBpcEFkZHJlc3MgPSByZXEuaXA7XG4gICAgY29uc3QgdXNlckFnZW50ID0gcmVxLmdldCgnVXNlci1BZ2VudCcpO1xuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5hdXRoU2VydmljZS5sb2dpbldpdGhFbWFpbChcbiAgICAgIGxvZ2luRHRvLmVtYWlsLFxuICAgICAgbG9naW5EdG8ucGFzc3dvcmQsXG4gICAgICBpcEFkZHJlc3MsXG4gICAgICB1c2VyQWdlbnQsXG4gICAgKTtcblxuICAgIHJldHVybiB7XG4gICAgICB1c2VyOiB7XG4gICAgICAgIGlkOiByZXN1bHQudXNlci5pZCxcbiAgICAgICAgZW1haWw6IHJlc3VsdC51c2VyLmVtYWlsLFxuICAgICAgICBmaXJzdE5hbWU6IHJlc3VsdC51c2VyLmZpcnN0TmFtZSxcbiAgICAgICAgbGFzdE5hbWU6IHJlc3VsdC51c2VyLmxhc3ROYW1lLFxuICAgICAgICByb2xlOiByZXN1bHQudXNlci5yb2xlLFxuICAgICAgICBlbWFpbFZlcmlmaWVkOiByZXN1bHQudXNlci5lbWFpbFZlcmlmaWVkLFxuICAgICAgfSxcbiAgICAgIGFjY2Vzc1Rva2VuOiByZXN1bHQudG9rZW5zLmFjY2Vzc1Rva2VuLFxuICAgICAgcmVmcmVzaFRva2VuOiByZXN1bHQudG9rZW5zLnJlZnJlc2hUb2tlbixcbiAgICAgIGV4cGlyZXNJbjogcmVzdWx0LnRva2Vucy5leHBpcmVzSW4sXG4gICAgfTtcbiAgfVxuXG4gIEBQdWJsaWMoKVxuICBAVGhyb3R0bGUoeyBkZWZhdWx0OiB7IGxpbWl0OiAyMCwgdHRsOiAzMDAwMDAgfSB9KSAvLyAyMCByZWZyZXNoIGF0dGVtcHRzIHBlciA1IG1pbnV0ZXNcbiAgQFBvc3QoJ3JlZnJlc2gnKVxuICBASHR0cENvZGUoSHR0cFN0YXR1cy5PSylcbiAgYXN5bmMgcmVmcmVzaFRva2VucyhcbiAgICBAQm9keShuZXcgWm9kVmFsaWRhdGlvblBpcGUoUmVmcmVzaFRva2VuRHRvU2NoZW1hKSlcbiAgICByZWZyZXNoRHRvOiBSZWZyZXNoVG9rZW5EdG8sXG4gICAgQFJlcSgpIHJlcTogUmVxdWVzdCxcbiAgKSB7XG4gICAgaWYgKCFyZWZyZXNoRHRvLnJlZnJlc2hUb2tlbikge1xuICAgICAgdGhyb3cgbmV3IFVuYXV0aG9yaXplZEV4Y2VwdGlvbignUmVmcmVzaCB0b2tlbiByZXF1aXJlZCcpO1xuICAgIH1cblxuICAgIGNvbnN0IGlwQWRkcmVzcyA9IHJlcS5pcDtcbiAgICBjb25zdCB1c2VyQWdlbnQgPSByZXEuZ2V0KCdVc2VyLUFnZW50Jyk7XG5cbiAgICBjb25zdCB0b2tlbnMgPSBhd2FpdCB0aGlzLmF1dGhTZXJ2aWNlLnJlZnJlc2hUb2tlbnMoXG4gICAgICByZWZyZXNoRHRvLnJlZnJlc2hUb2tlbixcbiAgICAgIGlwQWRkcmVzcyxcbiAgICAgIHVzZXJBZ2VudCxcbiAgICApO1xuXG4gICAgcmV0dXJuIHRva2VucztcbiAgfVxuXG4gIEBVc2VHdWFyZHMoSnd0QXV0aEd1YXJkKVxuICBAUG9zdCgnbG9nb3V0JylcbiAgQEh0dHBDb2RlKEh0dHBTdGF0dXMuT0spXG4gIGFzeW5jIGxvZ291dChcbiAgICBAQm9keShuZXcgWm9kVmFsaWRhdGlvblBpcGUoTG9nb3V0RHRvU2NoZW1hKSkgbG9nb3V0RHRvOiBMb2dvdXREdG8sXG4gICkge1xuICAgIGlmIChsb2dvdXREdG8ucmVmcmVzaFRva2VuKSB7XG4gICAgICBhd2FpdCB0aGlzLmF1dGhTZXJ2aWNlLmxvZ291dChsb2dvdXREdG8ucmVmcmVzaFRva2VuKTtcbiAgICB9XG4gICAgcmV0dXJuIHsgbWVzc2FnZTogJ0xvZ2dlZCBvdXQgc3VjY2Vzc2Z1bGx5JyB9O1xuICB9XG5cbiAgQFVzZUd1YXJkcyhKd3RBdXRoR3VhcmQpXG4gIEBHZXQoJ3Byb2ZpbGUnKVxuICBhc3luYyBnZXRQcm9maWxlKEBDdXJyZW50VXNlcklkKCkgdXNlcklkOiBzdHJpbmcpIHtcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgdGhpcy5hdXRoU2VydmljZS52YWxpZGF0ZVVzZXIodXNlcklkKTtcbiAgICBpZiAoIXVzZXIpIHtcbiAgICAgIHRocm93IG5ldyBVbmF1dGhvcml6ZWRFeGNlcHRpb24oJ1VzZXIgbm90IGZvdW5kJyk7XG4gICAgfVxuICAgIHJldHVybiB1c2VyO1xuICB9XG5cbiAgLy8gUm9sZS1zcGVjaWZpYyBwcm9maWxlIGVuZHBvaW50cyBtb3ZlZCB0byBkZWRpY2F0ZWQgY29udHJvbGxlcnM6XG4gIC8vIC0gL2F1dGgvY2xpZW50L3Byb2ZpbGVcbiAgLy8gLSAvYXV0aC90aGVyYXBpc3QvcHJvZmlsZVxuICAvLyAtIC9hdXRoL2FkbWluL3Byb2ZpbGVcbiAgLy8gLSAvYXV0aC9tb2RlcmF0b3IvcHJvZmlsZVxuXG4gIC8vID09PT09IFBBU1NXT1JEIFJFU0VUIEVORFBPSU5UUyA9PT09PVxuXG4gIEBQdWJsaWMoKVxuICBAVGhyb3R0bGUoeyBkZWZhdWx0OiB7IGxpbWl0OiA1LCB0dGw6IDMwMDAwMCB9IH0pIC8vIDUgcmVzZXQgcmVxdWVzdHMgcGVyIDUgbWludXRlc1xuICBAUG9zdCgncmVxdWVzdC1wYXNzd29yZC1yZXNldCcpXG4gIEBIdHRwQ29kZShIdHRwU3RhdHVzLk9LKVxuICBhc3luYyByZXF1ZXN0UGFzc3dvcmRSZXNldChcbiAgICBAQm9keShuZXcgWm9kVmFsaWRhdGlvblBpcGUoUmVxdWVzdFBhc3N3b3JkUmVzZXREdG9TY2hlbWEpKVxuICAgIHJlcXVlc3RSZXNldER0bzogUmVxdWVzdFBhc3N3b3JkUmVzZXREdG8sXG4gICkge1xuICAgIGF3YWl0IHRoaXMucGFzc3dvcmRSZXNldFNlcnZpY2UucmVxdWVzdFBhc3N3b3JkUmVzZXQocmVxdWVzdFJlc2V0RHRvLmVtYWlsKTtcbiAgICByZXR1cm4ge1xuICAgICAgbWVzc2FnZTogJ0lmIGFuIGFjY291bnQgd2l0aCB0aGF0IGVtYWlsIGV4aXN0cywgd2Ugd2lsbCBzZW5kIGEgcGFzc3dvcmQgcmVzZXQgbGluay4nLFxuICAgIH07XG4gIH1cblxuICBAUHVibGljKClcbiAgQFRocm90dGxlKHsgZGVmYXVsdDogeyBsaW1pdDogMTAsIHR0bDogMzAwMDAwIH0gfSkgLy8gMTAgcmVzZXQgYXR0ZW1wdHMgcGVyIDUgbWludXRlc1xuICBAUG9zdCgncmVzZXQtcGFzc3dvcmQnKVxuICBASHR0cENvZGUoSHR0cFN0YXR1cy5PSylcbiAgYXN5bmMgcmVzZXRQYXNzd29yZChcbiAgICBAQm9keShuZXcgWm9kVmFsaWRhdGlvblBpcGUoUmVzZXRQYXNzd29yZER0b1NjaGVtYSkpXG4gICAgcmVzZXREdG86IFJlc2V0UGFzc3dvcmREdG8sXG4gICkge1xuICAgIC8vIFZhbGlkYXRlIHRoYXQgcGFzc3dvcmRzIG1hdGNoXG4gICAgaWYgKHJlc2V0RHRvLm5ld1Bhc3N3b3JkICE9PSByZXNldER0by5jb25maXJtUGFzc3dvcmQpIHtcbiAgICAgIHRocm93IG5ldyBVbmF1dGhvcml6ZWRFeGNlcHRpb24oJ1Bhc3N3b3JkcyBkbyBub3QgbWF0Y2gnKTtcbiAgICB9XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnBhc3N3b3JkUmVzZXRTZXJ2aWNlLnJlc2V0UGFzc3dvcmQoXG4gICAgICByZXNldER0by50b2tlbixcbiAgICAgIHJlc2V0RHRvLm5ld1Bhc3N3b3JkLFxuICAgICk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIEBQdWJsaWMoKVxuICBAR2V0KCd2YWxpZGF0ZS1yZXNldC10b2tlbicpXG4gIGFzeW5jIHZhbGlkYXRlUmVzZXRUb2tlbihAUXVlcnkoJ3Rva2VuJykgdG9rZW46IHN0cmluZykge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucGFzc3dvcmRSZXNldFNlcnZpY2UudmFsaWRhdGVSZXNldFRva2VuKHRva2VuKTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLy8gPT09PT0gRU1BSUwgVkVSSUZJQ0FUSU9OIEVORFBPSU5UUyA9PT09PVxuXG4gIEBVc2VHdWFyZHMoSnd0QXV0aEd1YXJkKVxuICBAVGhyb3R0bGUoeyBkZWZhdWx0OiB7IGxpbWl0OiAzLCB0dGw6IDMwMDAwMCB9IH0pIC8vIDMgdmVyaWZpY2F0aW9uIGVtYWlscyBwZXIgNSBtaW51dGVzXG4gIEBQb3N0KCdzZW5kLXZlcmlmaWNhdGlvbi1lbWFpbCcpXG4gIEBIdHRwQ29kZShIdHRwU3RhdHVzLk9LKVxuICBhc3luYyBzZW5kVmVyaWZpY2F0aW9uRW1haWwoQEN1cnJlbnRVc2VySWQoKSB1c2VySWQ6IHN0cmluZykge1xuICAgIGF3YWl0IHRoaXMuZW1haWxWZXJpZmljYXRpb25TZXJ2aWNlLnNlbmRWZXJpZmljYXRpb25FbWFpbCh1c2VySWQpO1xuICAgIHJldHVybiB7XG4gICAgICBtZXNzYWdlOiAnVmVyaWZpY2F0aW9uIGVtYWlsIHNlbnQgc3VjY2Vzc2Z1bGx5JyxcbiAgICB9O1xuICB9XG5cbiAgQFB1YmxpYygpXG4gIEBUaHJvdHRsZSh7IGRlZmF1bHQ6IHsgbGltaXQ6IDUsIHR0bDogMzAwMDAwIH0gfSkgLy8gNSByZXNlbmQgYXR0ZW1wdHMgcGVyIDUgbWludXRlc1xuICBAUG9zdCgncmVzZW5kLXZlcmlmaWNhdGlvbi1lbWFpbCcpXG4gIEBIdHRwQ29kZShIdHRwU3RhdHVzLk9LKVxuICBhc3luYyByZXNlbmRWZXJpZmljYXRpb25FbWFpbChcbiAgICBAQm9keShuZXcgWm9kVmFsaWRhdGlvblBpcGUoUmVzZW5kVmVyaWZpY2F0aW9uRW1haWxEdG9TY2hlbWEpKVxuICAgIHJlc2VuZER0bzogUmVzZW5kVmVyaWZpY2F0aW9uRW1haWxEdG8sXG4gICkge1xuICAgIGF3YWl0IHRoaXMuZW1haWxWZXJpZmljYXRpb25TZXJ2aWNlLnJlc2VuZFZlcmlmaWNhdGlvbkVtYWlsKHJlc2VuZER0by5lbWFpbCk7XG4gICAgcmV0dXJuIHtcbiAgICAgIG1lc3NhZ2U6ICdJZiBhbiBhY2NvdW50IHdpdGggdGhhdCBlbWFpbCBleGlzdHMsIHdlIHdpbGwgc2VuZCBhIHZlcmlmaWNhdGlvbiBsaW5rLicsXG4gICAgfTtcbiAgfVxuXG4gIEBQdWJsaWMoKVxuICBAUG9zdCgndmVyaWZ5LWVtYWlsJylcbiAgQEh0dHBDb2RlKEh0dHBTdGF0dXMuT0spXG4gIGFzeW5jIHZlcmlmeUVtYWlsKFxuICAgIEBCb2R5KG5ldyBab2RWYWxpZGF0aW9uUGlwZShWZXJpZnlFbWFpbER0b1NjaGVtYSkpXG4gICAgdmVyaWZ5RHRvOiBWZXJpZnlFbWFpbER0byxcbiAgKSB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5lbWFpbFZlcmlmaWNhdGlvblNlcnZpY2UudmVyaWZ5RW1haWwodmVyaWZ5RHRvLnRva2VuKTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLy8gR29vZ2xlIE9BdXRoIFJvdXRlc1xuICBAUHVibGljKClcbiAgQEdldCgnZ29vZ2xlJylcbiAgQFVzZUd1YXJkcyhBdXRoR3VhcmQoJ2dvb2dsZScpKVxuICBhc3luYyBnb29nbGVBdXRoKEBSZXEoKSBfcmVxKSB7XG4gICAgLy8gSW5pdGlhdGVzIEdvb2dsZSBPQXV0aCBmbG93XG4gIH1cblxuICBAUHVibGljKClcbiAgQEdldCgnZ29vZ2xlL2NhbGxiYWNrJylcbiAgQFVzZUd1YXJkcyhBdXRoR3VhcmQoJ2dvb2dsZScpKVxuICBhc3luYyBnb29nbGVBdXRoUmVkaXJlY3QoQFJlcSgpIHJlcSkge1xuICAgIC8vIEhhbmRsZSBHb29nbGUgT0F1dGggY2FsbGJhY2tcbiAgICByZXR1cm4gdGhpcy5hdXRoU2VydmljZS5oYW5kbGVPQXV0aExvZ2luKHJlcS51c2VyLCAnZ29vZ2xlJyk7XG4gIH1cblxuICAvLyBNaWNyb3NvZnQgT0F1dGggUm91dGVzXG4gIEBQdWJsaWMoKVxuICBAR2V0KCdtaWNyb3NvZnQnKVxuICBAVXNlR3VhcmRzKEF1dGhHdWFyZCgnbWljcm9zb2Z0JykpXG4gIGFzeW5jIG1pY3Jvc29mdEF1dGgoQFJlcSgpIF9yZXEpIHtcbiAgICAvLyBJbml0aWF0ZXMgTWljcm9zb2Z0IE9BdXRoIGZsb3dcbiAgfVxuXG4gIEBQdWJsaWMoKVxuICBAR2V0KCdtaWNyb3NvZnQvY2FsbGJhY2snKVxuICBAVXNlR3VhcmRzKEF1dGhHdWFyZCgnbWljcm9zb2Z0JykpXG4gIGFzeW5jIG1pY3Jvc29mdEF1dGhSZWRpcmVjdChAUmVxKCkgcmVxKSB7XG4gICAgLy8gSGFuZGxlIE1pY3Jvc29mdCBPQXV0aCBjYWxsYmFja1xuICAgIHJldHVybiB0aGlzLmF1dGhTZXJ2aWNlLmhhbmRsZU9BdXRoTG9naW4ocmVxLnVzZXIsICdtaWNyb3NvZnQnKTtcbiAgfVxufVxuIl0sInZlcnNpb24iOjN9