{"file":"/home/wetooa/Documents/code/projects/mentara/mentara-api/src/reviews/reviews.controller.spec.ts","mappings":"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","names":[],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/reviews/reviews.controller.spec.ts"],"sourcesContent":["/**\n * Comprehensive Test Suite for ReviewsController\n * Tests review and rating functionality with role-based access control\n */\n\nimport { Test, TestingModule } from '@nestjs/testing';\nimport { BadRequestException, NotFoundException, ForbiddenException, HttpException, HttpStatus } from '@nestjs/common';\nimport { ReviewsController } from './reviews.controller';\nimport { ReviewsService } from './reviews.service';\nimport { JwtAuthGuard } from '../auth/guards/jwt-auth.guard';\nimport { ZodValidationPipe } from '../common/pipes/zod-validation.pipe';\nimport { SecurityGuardTestUtils, RoleBasedTestUtils } from '../test-utils/auth-testing-helpers';\nimport { MockBuilder, TestDataGenerator, TestAssertions } from '../test-utils/enhanced-test-helpers';\nimport { TEST_USER_IDS, TEST_EMAILS } from '../test-utils/index';\n\ndescribe('ReviewsController', () => {\n  let controller: ReviewsController;\n  let reviewsService: ReviewsService;\n  let module: TestingModule;\n\n  // Mock ReviewsService\n  const mockReviewsService = {\n    createReview: jest.fn(),\n    updateReview: jest.fn(),\n    deleteReview: jest.fn(),\n    getReviews: jest.fn(),\n    getTherapistReviews: jest.fn(),\n    getReviewStats: jest.fn(),\n    markReviewHelpful: jest.fn(),\n    moderateReview: jest.fn(),\n  };\n\n  // Mock JwtAuthGuard\n  const mockJwtAuthGuard = {\n    canActivate: jest.fn().mockReturnValue(true),\n  };\n\n  // Test data\n  const mockReview = {\n    id: 'review_123456789',\n    meetingId: 'meeting_123456789',\n    clientId: TEST_USER_IDS.CLIENT,\n    therapistId: TEST_USER_IDS.THERAPIST,\n    rating: 5,\n    comment: 'Dr. Smith was incredibly helpful and professional. I felt heard and understood throughout our session.',\n    categories: {\n      communication: 5,\n      professionalism: 5,\n      effectiveness: 4,\n      environment: 5,\n    },\n    isAnonymous: false,\n    helpfulCount: 3,\n    status: 'APPROVED',\n    createdAt: new Date('2024-02-14T10:00:00Z'),\n    updatedAt: new Date('2024-02-14T10:00:00Z'),\n    client: {\n      id: TEST_USER_IDS.CLIENT,\n      firstName: 'John',\n      lastName: 'D.',\n      avatar: null,\n    },\n    therapist: {\n      id: TEST_USER_IDS.THERAPIST,\n      firstName: 'Dr. Sarah',\n      lastName: 'Smith',\n      specializations: ['anxiety', 'depression'],\n    },\n  };\n\n  const mockReviewsList = {\n    reviews: [\n      mockReview,\n      {\n        ...mockReview,\n        id: 'review_987654321',\n        rating: 4,\n        comment: 'Good session, very helpful.',\n        categories: { communication: 4, professionalism: 5, effectiveness: 4, environment: 4 },\n        helpfulCount: 1,\n      },\n    ],\n    pagination: {\n      page: 1,\n      limit: 10,\n      total: 2,\n      totalPages: 1,\n      hasNext: false,\n      hasPrev: false,\n    },\n    summary: {\n      totalReviews: 2,\n      averageRating: 4.5,\n      ratingDistribution: {\n        5: 1,\n        4: 1,\n        3: 0,\n        2: 0,\n        1: 0,\n      },\n    },\n  };\n\n  const mockReviewStats = {\n    totalReviews: 47,\n    averageRating: 4.7,\n    ratingDistribution: {\n      5: 28,\n      4: 15,\n      3: 3,\n      2: 1,\n      1: 0,\n    },\n    categoryAverages: {\n      communication: 4.8,\n      professionalism: 4.9,\n      effectiveness: 4.6,\n      environment: 4.7,\n    },\n    recentTrend: 'improving',\n    lastThirtyDays: {\n      reviews: 8,\n      averageRating: 4.9,\n    },\n    helpfulnessMetrics: {\n      totalHelpfulVotes: 156,\n      averageHelpfulVotes: 3.3,\n    },\n  };\n\n  const createReviewDto = {\n    rating: 5,\n    comment: 'Excellent session with great insights.',\n    categories: {\n      communication: 5,\n      professionalism: 5,\n      effectiveness: 5,\n      environment: 4,\n    },\n    isAnonymous: false,\n  };\n\n  const updateReviewDto = {\n    rating: 4,\n    comment: 'Updated: Very good session with helpful guidance.',\n    categories: {\n      communication: 4,\n      professionalism: 5,\n      effectiveness: 4,\n      environment: 4,\n    },\n  };\n\n  const moderateReviewDto = {\n    action: 'approve' as const,\n    reason: 'Review meets community guidelines',\n    moderatorNotes: 'Content is appropriate and helpful',\n  };\n\n  beforeEach(async () => {\n    module = await Test.createTestingModule({\n      controllers: [ReviewsController],\n      providers: [\n        {\n          provide: ReviewsService,\n          useValue: mockReviewsService,\n        },\n      ],\n    })\n      .overrideGuard(JwtAuthGuard)\n      .useValue(mockJwtAuthGuard)\n      .compile();\n\n    controller = module.get<ReviewsController>(ReviewsController);\n    reviewsService = module.get<ReviewsService>(ReviewsService);\n  });\n\n  afterEach(() => {\n    jest.clearAllMocks();\n  });\n\n  describe('Controller Initialization', () => {\n    it('should be defined', () => {\n      expect(controller).toBeDefined();\n    });\n\n    it('should have reviewsService injected', () => {\n      expect(reviewsService).toBeDefined();\n    });\n  });\n\n  describe('Security Guards', () => {\n    it('should be protected by JwtAuthGuard', () => {\n      const guards = Reflect.getMetadata('__guards__', ReviewsController);\n      expect(guards).toContain(JwtAuthGuard);\n    });\n\n    it('should have proper route decorators', () => {\n      const controllerMetadata = Reflect.getMetadata('path', ReviewsController);\n      expect(controllerMetadata).toBe('reviews');\n    });\n  });\n\n  describe('POST /reviews/:meetingId/:therapistId', () => {\n    const meetingId = 'meeting_123456789';\n    const therapistId = TEST_USER_IDS.THERAPIST;\n\n    it('should create review successfully', async () => {\n      mockReviewsService.createReview.mockResolvedValue(mockReview);\n\n      const result = await controller.createReview(\n        meetingId,\n        TEST_USER_IDS.CLIENT,\n        therapistId,\n        createReviewDto,\n      );\n\n      expect(result).toEqual(mockReview);\n      expect(reviewsService.createReview).toHaveBeenCalledWith(\n        meetingId,\n        TEST_USER_IDS.CLIENT,\n        therapistId,\n        createReviewDto,\n      );\n    });\n\n    it('should handle different rating values', async () => {\n      const ratings = [1, 2, 3, 4, 5];\n\n      for (const rating of ratings) {\n        const dto = { ...createReviewDto, rating };\n        const reviewWithRating = { ...mockReview, rating };\n        mockReviewsService.createReview.mockResolvedValue(reviewWithRating);\n\n        const result = await controller.createReview(\n          meetingId,\n          TEST_USER_IDS.CLIENT,\n          therapistId,\n          dto,\n        );\n\n        expect(result.rating).toBe(rating);\n      }\n    });\n\n    it('should handle anonymous reviews', async () => {\n      const anonymousDto = { ...createReviewDto, isAnonymous: true };\n      const anonymousReview = { ...mockReview, isAnonymous: true };\n      mockReviewsService.createReview.mockResolvedValue(anonymousReview);\n\n      const result = await controller.createReview(\n        meetingId,\n        TEST_USER_IDS.CLIENT,\n        therapistId,\n        anonymousDto,\n      );\n\n      expect(result.isAnonymous).toBe(true);\n    });\n\n    it('should handle reviews with different category ratings', async () => {\n      const categoryVariations = [\n        { communication: 5, professionalism: 4, effectiveness: 3, environment: 5 },\n        { communication: 3, professionalism: 3, effectiveness: 4, environment: 3 },\n        { communication: 5, professionalism: 5, effectiveness: 5, environment: 5 },\n      ];\n\n      for (const categories of categoryVariations) {\n        const dto = { ...createReviewDto, categories };\n        const reviewWithCategories = { ...mockReview, categories };\n        mockReviewsService.createReview.mockResolvedValue(reviewWithCategories);\n\n        const result = await controller.createReview(\n          meetingId,\n          TEST_USER_IDS.CLIENT,\n          therapistId,\n          dto,\n        );\n\n        expect(result.categories).toEqual(categories);\n      }\n    });\n\n    it('should handle reviews without comments', async () => {\n      const dtoWithoutComment = { ...createReviewDto, comment: undefined };\n      const reviewWithoutComment = { ...mockReview, comment: null };\n      mockReviewsService.createReview.mockResolvedValue(reviewWithoutComment);\n\n      const result = await controller.createReview(\n        meetingId,\n        TEST_USER_IDS.CLIENT,\n        therapistId,\n        dtoWithoutComment,\n      );\n\n      expect(result.comment).toBeNull();\n    });\n\n    it('should handle service errors', async () => {\n      const serviceError = new Error('Meeting not found or already reviewed');\n      mockReviewsService.createReview.mockRejectedValue(serviceError);\n\n      await expect(\n        controller.createReview(meetingId, TEST_USER_IDS.CLIENT, therapistId, createReviewDto)\n      ).rejects.toThrow(serviceError);\n    });\n  });\n\n  describe('PUT /reviews/:id', () => {\n    const reviewId = 'review_123456789';\n\n    it('should update review successfully', async () => {\n      const updatedReview = { ...mockReview, ...updateReviewDto, updatedAt: new Date() };\n      mockReviewsService.updateReview.mockResolvedValue(updatedReview);\n\n      const result = await controller.updateReview(\n        reviewId,\n        TEST_USER_IDS.CLIENT,\n        updateReviewDto,\n      );\n\n      expect(result).toEqual(updatedReview);\n      expect(reviewsService.updateReview).toHaveBeenCalledWith(\n        reviewId,\n        TEST_USER_IDS.CLIENT,\n        updateReviewDto,\n      );\n    });\n\n    it('should handle partial updates', async () => {\n      const partialUpdate = { rating: 3 };\n      const partiallyUpdatedReview = { ...mockReview, rating: 3, updatedAt: new Date() };\n      mockReviewsService.updateReview.mockResolvedValue(partiallyUpdatedReview);\n\n      const result = await controller.updateReview(\n        reviewId,\n        TEST_USER_IDS.CLIENT,\n        partialUpdate,\n      );\n\n      expect(result.rating).toBe(3);\n      expect(result.comment).toBe(mockReview.comment); // unchanged\n    });\n\n    it('should handle rating changes', async () => {\n      const ratingChanges = [1, 2, 3, 4, 5];\n\n      for (const newRating of ratingChanges) {\n        const updateDto = { rating: newRating };\n        const updatedReview = { ...mockReview, rating: newRating };\n        mockReviewsService.updateReview.mockResolvedValue(updatedReview);\n\n        const result = await controller.updateReview(\n          reviewId,\n          TEST_USER_IDS.CLIENT,\n          updateDto,\n        );\n\n        expect(result.rating).toBe(newRating);\n      }\n    });\n\n    it('should handle comment updates', async () => {\n      const commentUpdate = { comment: 'Updated review comment with more details.' };\n      const updatedReview = { ...mockReview, comment: commentUpdate.comment };\n      mockReviewsService.updateReview.mockResolvedValue(updatedReview);\n\n      const result = await controller.updateReview(\n        reviewId,\n        TEST_USER_IDS.CLIENT,\n        commentUpdate,\n      );\n\n      expect(result.comment).toBe(commentUpdate.comment);\n    });\n\n    it('should handle review not found', async () => {\n      const notFoundError = new Error('Review not found');\n      mockReviewsService.updateReview.mockRejectedValue(notFoundError);\n\n      await expect(\n        controller.updateReview('non-existent-id', TEST_USER_IDS.CLIENT, updateReviewDto)\n      ).rejects.toThrow(notFoundError);\n    });\n\n    it('should handle unauthorized update attempts', async () => {\n      const unauthorizedError = new Error('Not authorized to update this review');\n      mockReviewsService.updateReview.mockRejectedValue(unauthorizedError);\n\n      await expect(\n        controller.updateReview(reviewId, 'different_user_id', updateReviewDto)\n      ).rejects.toThrow(unauthorizedError);\n    });\n  });\n\n  describe('DELETE /reviews/:id', () => {\n    const reviewId = 'review_123456789';\n\n    it('should delete review successfully', async () => {\n      mockReviewsService.deleteReview.mockResolvedValue({ message: 'Review deleted successfully' });\n\n      const result = await controller.deleteReview(reviewId, TEST_USER_IDS.CLIENT);\n\n      expect(result).toEqual({ message: 'Review deleted successfully' });\n      expect(reviewsService.deleteReview).toHaveBeenCalledWith(reviewId, TEST_USER_IDS.CLIENT);\n    });\n\n    it('should handle review not found', async () => {\n      const notFoundError = new Error('Review not found');\n      mockReviewsService.deleteReview.mockRejectedValue(notFoundError);\n\n      await expect(\n        controller.deleteReview('non-existent-id', TEST_USER_IDS.CLIENT)\n      ).rejects.toThrow(notFoundError);\n    });\n\n    it('should handle unauthorized deletion attempts', async () => {\n      const unauthorizedError = new Error('Not authorized to delete this review');\n      mockReviewsService.deleteReview.mockRejectedValue(unauthorizedError);\n\n      await expect(\n        controller.deleteReview(reviewId, 'different_user_id')\n      ).rejects.toThrow(unauthorizedError);\n    });\n\n    it('should handle service errors', async () => {\n      const serviceError = new Error('Database error during deletion');\n      mockReviewsService.deleteReview.mockRejectedValue(serviceError);\n\n      await expect(\n        controller.deleteReview(reviewId, TEST_USER_IDS.CLIENT)\n      ).rejects.toThrow(serviceError);\n    });\n  });\n\n  describe('GET /reviews', () => {\n    const mockQuery = {\n      page: 1,\n      limit: 10,\n      sortBy: 'createdAt' as const,\n      sortOrder: 'desc' as const,\n      rating: 5,\n      therapistId: TEST_USER_IDS.THERAPIST,\n    };\n\n    it('should get reviews successfully', async () => {\n      mockReviewsService.getReviews.mockResolvedValue(mockReviewsList);\n\n      const result = await controller.getReviews(mockQuery);\n\n      expect(result).toEqual(mockReviewsList);\n      expect(reviewsService.getReviews).toHaveBeenCalledWith(mockQuery);\n    });\n\n    it('should handle empty query', async () => {\n      const emptyQuery = {};\n      mockReviewsService.getReviews.mockResolvedValue(mockReviewsList);\n\n      const result = await controller.getReviews(emptyQuery);\n\n      expect(result).toEqual(mockReviewsList);\n      expect(reviewsService.getReviews).toHaveBeenCalledWith(emptyQuery);\n    });\n\n    it('should handle pagination parameters', async () => {\n      const paginationQueries = [\n        { page: 1, limit: 5 },\n        { page: 2, limit: 20 },\n        { page: 3, limit: 50 },\n      ];\n\n      for (const query of paginationQueries) {\n        mockReviewsService.getReviews.mockResolvedValue({\n          ...mockReviewsList,\n          pagination: { ...mockReviewsList.pagination, ...query },\n        });\n\n        const result = await controller.getReviews(query);\n\n        expect(result.pagination.page).toBe(query.page);\n        expect(result.pagination.limit).toBe(query.limit);\n      }\n    });\n\n    it('should handle rating filters', async () => {\n      const ratingFilters = [1, 2, 3, 4, 5];\n\n      for (const rating of ratingFilters) {\n        const query = { rating };\n        const filteredResults = {\n          ...mockReviewsList,\n          reviews: mockReviewsList.reviews.filter(review => review.rating === rating),\n        };\n        mockReviewsService.getReviews.mockResolvedValue(filteredResults);\n\n        const result = await controller.getReviews(query);\n\n        expect(reviewsService.getReviews).toHaveBeenCalledWith(query);\n      }\n    });\n\n    it('should handle sorting options', async () => {\n      const sortOptions = [\n        { sortBy: 'createdAt', sortOrder: 'desc' },\n        { sortBy: 'rating', sortOrder: 'asc' },\n        { sortBy: 'helpfulCount', sortOrder: 'desc' },\n      ] as const;\n\n      for (const sortOption of sortOptions) {\n        mockReviewsService.getReviews.mockResolvedValue(mockReviewsList);\n\n        const result = await controller.getReviews(sortOption);\n\n        expect(reviewsService.getReviews).toHaveBeenCalledWith(sortOption);\n      }\n    });\n\n    it('should handle empty results', async () => {\n      const emptyResults = {\n        reviews: [],\n        pagination: { page: 1, limit: 10, total: 0, totalPages: 0, hasNext: false, hasPrev: false },\n        summary: { totalReviews: 0, averageRating: 0, ratingDistribution: { 5: 0, 4: 0, 3: 0, 2: 0, 1: 0 } },\n      };\n      mockReviewsService.getReviews.mockResolvedValue(emptyResults);\n\n      const result = await controller.getReviews({});\n\n      expect(result.reviews).toEqual([]);\n      expect(result.summary.totalReviews).toBe(0);\n    });\n  });\n\n  describe('GET /reviews/therapist/:therapistId', () => {\n    const therapistId = TEST_USER_IDS.THERAPIST;\n    const mockQuery = { page: 1, limit: 10, sortBy: 'createdAt' as const };\n\n    it('should get therapist reviews successfully', async () => {\n      mockReviewsService.getTherapistReviews.mockResolvedValue(mockReviewsList);\n\n      const result = await controller.getTherapistReviews(therapistId, mockQuery);\n\n      expect(result).toEqual(mockReviewsList);\n      expect(reviewsService.getTherapistReviews).toHaveBeenCalledWith(therapistId, mockQuery);\n    });\n\n    it('should handle different therapist IDs', async () => {\n      const therapistIds = ['therapist_1', 'therapist_2', 'therapist_3'];\n\n      for (const id of therapistIds) {\n        const therapistReviews = {\n          ...mockReviewsList,\n          reviews: mockReviewsList.reviews.map(review => ({ ...review, therapistId: id })),\n        };\n        mockReviewsService.getTherapistReviews.mockResolvedValue(therapistReviews);\n\n        const result = await controller.getTherapistReviews(id, mockQuery);\n\n        expect(result.reviews.every(review => review.therapistId === id)).toBe(true);\n      }\n    });\n\n    it('should handle therapist with no reviews', async () => {\n      const emptyResults = {\n        reviews: [],\n        pagination: { page: 1, limit: 10, total: 0, totalPages: 0, hasNext: false, hasPrev: false },\n        summary: { totalReviews: 0, averageRating: 0, ratingDistribution: { 5: 0, 4: 0, 3: 0, 2: 0, 1: 0 } },\n      };\n      mockReviewsService.getTherapistReviews.mockResolvedValue(emptyResults);\n\n      const result = await controller.getTherapistReviews('therapist_no_reviews', mockQuery);\n\n      expect(result.reviews).toEqual([]);\n      expect(result.summary.totalReviews).toBe(0);\n    });\n\n    it('should handle service errors', async () => {\n      const serviceError = new Error('Therapist not found');\n      mockReviewsService.getTherapistReviews.mockRejectedValue(serviceError);\n\n      await expect(\n        controller.getTherapistReviews('non-existent-therapist', mockQuery)\n      ).rejects.toThrow(serviceError);\n    });\n  });\n\n  describe('GET /reviews/therapist/:therapistId/stats', () => {\n    const therapistId = TEST_USER_IDS.THERAPIST;\n\n    it('should get therapist review stats successfully', async () => {\n      mockReviewsService.getReviewStats.mockResolvedValue(mockReviewStats);\n\n      const result = await controller.getTherapistReviewStats(therapistId);\n\n      expect(result).toEqual(mockReviewStats);\n      expect(reviewsService.getReviewStats).toHaveBeenCalledWith(therapistId);\n    });\n\n    it('should validate stats response structure', async () => {\n      mockReviewsService.getReviewStats.mockResolvedValue(mockReviewStats);\n\n      const result = await controller.getTherapistReviewStats(therapistId);\n\n      expect(result).toHaveProperty('totalReviews');\n      expect(result).toHaveProperty('averageRating');\n      expect(result).toHaveProperty('ratingDistribution');\n      expect(result).toHaveProperty('categoryAverages');\n      expect(typeof result.totalReviews).toBe('number');\n      expect(typeof result.averageRating).toBe('number');\n      expect(typeof result.ratingDistribution).toBe('object');\n    });\n\n    it('should handle therapist with no reviews', async () => {\n      const emptyStats = {\n        totalReviews: 0,\n        averageRating: 0,\n        ratingDistribution: { 5: 0, 4: 0, 3: 0, 2: 0, 1: 0 },\n        categoryAverages: { communication: 0, professionalism: 0, effectiveness: 0, environment: 0 },\n        recentTrend: 'stable',\n        lastThirtyDays: { reviews: 0, averageRating: 0 },\n        helpfulnessMetrics: { totalHelpfulVotes: 0, averageHelpfulVotes: 0 },\n      };\n      mockReviewsService.getReviewStats.mockResolvedValue(emptyStats);\n\n      const result = await controller.getTherapistReviewStats('therapist_no_reviews');\n\n      expect(result.totalReviews).toBe(0);\n      expect(result.averageRating).toBe(0);\n    });\n\n    it('should handle service errors', async () => {\n      const serviceError = new Error('Stats calculation failed');\n      mockReviewsService.getReviewStats.mockRejectedValue(serviceError);\n\n      await expect(\n        controller.getTherapistReviewStats(therapistId)\n      ).rejects.toThrow(serviceError);\n    });\n  });\n\n  describe('POST /reviews/:id/helpful', () => {\n    const reviewId = 'review_123456789';\n\n    it('should mark review as helpful successfully', async () => {\n      const helpfulResult = { message: 'Review marked as helpful', helpfulCount: 4 };\n      mockReviewsService.markReviewHelpful.mockResolvedValue(helpfulResult);\n\n      const result = await controller.markReviewHelpful(reviewId, TEST_USER_IDS.CLIENT);\n\n      expect(result).toEqual(helpfulResult);\n      expect(reviewsService.markReviewHelpful).toHaveBeenCalledWith(reviewId, TEST_USER_IDS.CLIENT);\n    });\n\n    it('should handle duplicate helpful marking', async () => {\n      const duplicateError = new Error('Already marked as helpful');\n      mockReviewsService.markReviewHelpful.mockRejectedValue(duplicateError);\n\n      await expect(\n        controller.markReviewHelpful(reviewId, TEST_USER_IDS.CLIENT)\n      ).rejects.toThrow(duplicateError);\n    });\n\n    it('should handle review not found', async () => {\n      const notFoundError = new Error('Review not found');\n      mockReviewsService.markReviewHelpful.mockRejectedValue(notFoundError);\n\n      await expect(\n        controller.markReviewHelpful('non-existent-review', TEST_USER_IDS.CLIENT)\n      ).rejects.toThrow(notFoundError);\n    });\n\n    it('should handle service errors', async () => {\n      const serviceError = new Error('Database error');\n      mockReviewsService.markReviewHelpful.mockRejectedValue(serviceError);\n\n      await expect(\n        controller.markReviewHelpful(reviewId, TEST_USER_IDS.CLIENT)\n      ).rejects.toThrow(serviceError);\n    });\n  });\n\n  describe('POST /reviews/:id/moderate', () => {\n    const reviewId = 'review_123456789';\n\n    it('should moderate review successfully as moderator', async () => {\n      const moderatedReview = { ...mockReview, status: 'APPROVED' };\n      mockReviewsService.moderateReview.mockResolvedValue(moderatedReview);\n\n      const result = await controller.moderateReview(\n        reviewId,\n        TEST_USER_IDS.MODERATOR,\n        'moderator',\n        moderateReviewDto,\n      );\n\n      expect(result).toEqual(moderatedReview);\n      expect(reviewsService.moderateReview).toHaveBeenCalledWith(\n        reviewId,\n        TEST_USER_IDS.MODERATOR,\n        moderateReviewDto,\n      );\n    });\n\n    it('should moderate review successfully as admin', async () => {\n      const moderatedReview = { ...mockReview, status: 'APPROVED' };\n      mockReviewsService.moderateReview.mockResolvedValue(moderatedReview);\n\n      const result = await controller.moderateReview(\n        reviewId,\n        TEST_USER_IDS.ADMIN,\n        'admin',\n        moderateReviewDto,\n      );\n\n      expect(result).toEqual(moderatedReview);\n      expect(reviewsService.moderateReview).toHaveBeenCalledWith(\n        reviewId,\n        TEST_USER_IDS.ADMIN,\n        moderateReviewDto,\n      );\n    });\n\n    it('should deny access to non-moderator/non-admin users', async () => {\n      const unauthorizedRoles = ['client', 'therapist'];\n\n      for (const role of unauthorizedRoles) {\n        await expect(\n          controller.moderateReview(reviewId, TEST_USER_IDS.CLIENT, role, moderateReviewDto)\n        ).rejects.toThrow(ForbiddenException);\n        await expect(\n          controller.moderateReview(reviewId, TEST_USER_IDS.CLIENT, role, moderateReviewDto)\n        ).rejects.toThrow('Insufficient permissions');\n      }\n    });\n\n    it('should handle different moderation actions', async () => {\n      const moderationActions = [\n        { action: 'approve', status: 'APPROVED' },\n        { action: 'reject', status: 'REJECTED' },\n        { action: 'flag', status: 'FLAGGED' },\n      ] as const;\n\n      for (const { action, status } of moderationActions) {\n        const actionDto = { ...moderateReviewDto, action };\n        const moderatedReview = { ...mockReview, status };\n        mockReviewsService.moderateReview.mockResolvedValue(moderatedReview);\n\n        const result = await controller.moderateReview(\n          reviewId,\n          TEST_USER_IDS.MODERATOR,\n          'moderator',\n          actionDto,\n        );\n\n        expect(result.status).toBe(status);\n      }\n    });\n\n    it('should handle review not found', async () => {\n      const notFoundError = new Error('Review not found');\n      mockReviewsService.moderateReview.mockRejectedValue(notFoundError);\n\n      await expect(\n        controller.moderateReview(\n          'non-existent-review',\n          TEST_USER_IDS.MODERATOR,\n          'moderator',\n          moderateReviewDto,\n        )\n      ).rejects.toThrow(notFoundError);\n    });\n\n    it('should handle service errors', async () => {\n      const serviceError = new Error('Moderation failed');\n      mockReviewsService.moderateReview.mockRejectedValue(serviceError);\n\n      await expect(\n        controller.moderateReview(\n          reviewId,\n          TEST_USER_IDS.MODERATOR,\n          'moderator',\n          moderateReviewDto,\n        )\n      ).rejects.toThrow(serviceError);\n    });\n  });\n\n  describe('GET /reviews/pending', () => {\n    const mockQuery = { page: 1, limit: 10 };\n\n    it('should get pending reviews as moderator', async () => {\n      const pendingReviews = {\n        ...mockReviewsList,\n        reviews: mockReviewsList.reviews.map(review => ({ ...review, status: 'PENDING' })),\n      };\n      mockReviewsService.getReviews.mockResolvedValue(pendingReviews);\n\n      const result = await controller.getPendingReviews('moderator', mockQuery);\n\n      expect(result).toEqual(pendingReviews);\n      expect(reviewsService.getReviews).toHaveBeenCalledWith({\n        ...mockQuery,\n        status: 'PENDING',\n      });\n    });\n\n    it('should get pending reviews as admin', async () => {\n      const pendingReviews = {\n        ...mockReviewsList,\n        reviews: mockReviewsList.reviews.map(review => ({ ...review, status: 'PENDING' })),\n      };\n      mockReviewsService.getReviews.mockResolvedValue(pendingReviews);\n\n      const result = await controller.getPendingReviews('admin', mockQuery);\n\n      expect(result).toEqual(pendingReviews);\n      expect(reviewsService.getReviews).toHaveBeenCalledWith({\n        ...mockQuery,\n        status: 'PENDING',\n      });\n    });\n\n    it('should deny access to non-moderator/non-admin users', async () => {\n      const unauthorizedRoles = ['client', 'therapist'];\n\n      for (const role of unauthorizedRoles) {\n        await expect(\n          controller.getPendingReviews(role, mockQuery)\n        ).rejects.toThrow(ForbiddenException);\n        await expect(\n          controller.getPendingReviews(role, mockQuery)\n        ).rejects.toThrow('Insufficient permissions');\n      }\n    });\n\n    it('should handle empty pending reviews', async () => {\n      const emptyResults = {\n        reviews: [],\n        pagination: { page: 1, limit: 10, total: 0, totalPages: 0, hasNext: false, hasPrev: false },\n        summary: { totalReviews: 0, averageRating: 0, ratingDistribution: { 5: 0, 4: 0, 3: 0, 2: 0, 1: 0 } },\n      };\n      mockReviewsService.getReviews.mockResolvedValue(emptyResults);\n\n      const result = await controller.getPendingReviews('moderator', mockQuery);\n\n      expect(result.reviews).toEqual([]);\n      expect(result.summary.totalReviews).toBe(0);\n    });\n\n    it('should handle service errors', async () => {\n      const serviceError = new Error('Failed to fetch pending reviews');\n      mockReviewsService.getReviews.mockRejectedValue(serviceError);\n\n      await expect(\n        controller.getPendingReviews('moderator', mockQuery)\n      ).rejects.toThrow(serviceError);\n    });\n  });\n\n  describe('Response Format Validation', () => {\n    it('should return properly formatted review response', async () => {\n      mockReviewsService.createReview.mockResolvedValue(mockReview);\n\n      const result = await controller.createReview(\n        'meeting_123',\n        TEST_USER_IDS.CLIENT,\n        TEST_USER_IDS.THERAPIST,\n        createReviewDto,\n      );\n\n      TestAssertions.expectValidEntity(result, ['id', 'meetingId', 'clientId', 'therapistId', 'rating']);\n      expect(result.rating).toBeGreaterThanOrEqual(1);\n      expect(result.rating).toBeLessThanOrEqual(5);\n      expect(result.createdAt).toBeInstanceOf(Date);\n      expect(result.updatedAt).toBeInstanceOf(Date);\n    });\n\n    it('should return properly formatted reviews list', async () => {\n      mockReviewsService.getReviews.mockResolvedValue(mockReviewsList);\n\n      const result = await controller.getReviews({});\n\n      expect(result).toHaveProperty('reviews');\n      expect(result).toHaveProperty('pagination');\n      expect(result).toHaveProperty('summary');\n      expect(Array.isArray(result.reviews)).toBe(true);\n      result.reviews.forEach((review) => {\n        TestAssertions.expectValidEntity(review, ['id', 'rating', 'status']);\n        expect(review.rating).toBeGreaterThanOrEqual(1);\n        expect(review.rating).toBeLessThanOrEqual(5);\n      });\n    });\n\n    it('should return properly formatted review stats', async () => {\n      mockReviewsService.getReviewStats.mockResolvedValue(mockReviewStats);\n\n      const result = await controller.getTherapistReviewStats(TEST_USER_IDS.THERAPIST);\n\n      expect(result).toHaveProperty('totalReviews');\n      expect(result).toHaveProperty('averageRating');\n      expect(result).toHaveProperty('ratingDistribution');\n      expect(result).toHaveProperty('categoryAverages');\n      expect(typeof result.totalReviews).toBe('number');\n      expect(typeof result.averageRating).toBe('number');\n      expect(result.totalReviews).toBeGreaterThanOrEqual(0);\n      expect(result.averageRating).toBeGreaterThanOrEqual(0);\n      expect(result.averageRating).toBeLessThanOrEqual(5);\n    });\n  });\n\n  describe('Error Handling', () => {\n    it('should handle service unavailable scenarios', async () => {\n      const serviceError = new Error('Review service temporarily unavailable');\n      mockReviewsService.getReviews.mockRejectedValue(serviceError);\n\n      await expect(controller.getReviews({})).rejects.toThrow(serviceError);\n    });\n\n    it('should handle database connection errors', async () => {\n      const dbError = new Error('Database connection failed');\n      mockReviewsService.createReview.mockRejectedValue(dbError);\n\n      await expect(\n        controller.createReview(\n          'meeting_123',\n          TEST_USER_IDS.CLIENT,\n          TEST_USER_IDS.THERAPIST,\n          createReviewDto,\n        )\n      ).rejects.toThrow(dbError);\n    });\n\n    it('should handle validation errors', async () => {\n      const validationError = new Error('Invalid review data');\n      mockReviewsService.updateReview.mockRejectedValue(validationError);\n\n      await expect(\n        controller.updateReview('review_123', TEST_USER_IDS.CLIENT, updateReviewDto)\n      ).rejects.toThrow(validationError);\n    });\n  });\n\n  describe('Integration Tests', () => {\n    it('should handle complete review lifecycle', async () => {\n      // Create review\n      mockReviewsService.createReview.mockResolvedValue(mockReview);\n      const createResult = await controller.createReview(\n        'meeting_123',\n        TEST_USER_IDS.CLIENT,\n        TEST_USER_IDS.THERAPIST,\n        createReviewDto,\n      );\n      expect(createResult.id).toBeDefined();\n\n      // Update review\n      const updatedReview = { ...mockReview, rating: 4, comment: 'Updated comment' };\n      mockReviewsService.updateReview.mockResolvedValue(updatedReview);\n      const updateResult = await controller.updateReview(\n        createResult.id,\n        TEST_USER_IDS.CLIENT,\n        { rating: 4, comment: 'Updated comment' },\n      );\n      expect(updateResult.rating).toBe(4);\n\n      // Mark as helpful\n      const helpfulResult = { message: 'Review marked as helpful', helpfulCount: 1 };\n      mockReviewsService.markReviewHelpful.mockResolvedValue(helpfulResult);\n      const helpfulResponse = await controller.markReviewHelpful(\n        createResult.id,\n        'another_user_id',\n      );\n      expect(helpfulResponse.helpfulCount).toBe(1);\n\n      // Delete review\n      mockReviewsService.deleteReview.mockResolvedValue({ message: 'Review deleted successfully' });\n      const deleteResult = await controller.deleteReview(createResult.id, TEST_USER_IDS.CLIENT);\n      expect(deleteResult.message).toContain('deleted');\n    });\n\n    it('should handle moderation workflow', async () => {\n      // Get pending reviews\n      const pendingReviews = {\n        ...mockReviewsList,\n        reviews: [{ ...mockReview, status: 'PENDING' }],\n      };\n      mockReviewsService.getReviews.mockResolvedValue(pendingReviews);\n      const pendingResult = await controller.getPendingReviews('moderator', { page: 1, limit: 10 });\n      expect(pendingResult.reviews).toHaveLength(1);\n\n      // Moderate review\n      const moderatedReview = { ...mockReview, status: 'APPROVED' };\n      mockReviewsService.moderateReview.mockResolvedValue(moderatedReview);\n      const moderationResult = await controller.moderateReview(\n        mockReview.id,\n        TEST_USER_IDS.MODERATOR,\n        'moderator',\n        moderateReviewDto,\n      );\n      expect(moderationResult.status).toBe('APPROVED');\n    });\n\n    it('should handle therapist analytics workflow', async () => {\n      // Get therapist reviews\n      mockReviewsService.getTherapistReviews.mockResolvedValue(mockReviewsList);\n      const reviewsResult = await controller.getTherapistReviews(\n        TEST_USER_IDS.THERAPIST,\n        { page: 1, limit: 10 },\n      );\n      expect(reviewsResult.reviews).toHaveLength(2);\n\n      // Get therapist stats\n      mockReviewsService.getReviewStats.mockResolvedValue(mockReviewStats);\n      const statsResult = await controller.getTherapistReviewStats(TEST_USER_IDS.THERAPIST);\n      expect(statsResult.totalReviews).toBeGreaterThan(0);\n      expect(statsResult.averageRating).toBeGreaterThan(0);\n    });\n  });\n});"],"version":3}