{"file":"/home/wetooa/Documents/code/projects/mentara/mentara-api/src/common/events/interfaces/domain-event.interface.ts","mappings":";;;AAAA,mCAAqC;AAwBrC,MAAsB,eAAe;IACnB,OAAO,CAAS;IAChB,SAAS,CAAS;IAClB,WAAW,CAAS;IACpB,aAAa,CAAS;IACtB,SAAS,CAAI;IACb,QAAQ,CAAgB;IACxB,SAAS,CAAO;IAChB,OAAO,CAAS;IAEhC,YACE,WAAmB,EACnB,aAAqB,EACrB,SAAY,EACZ,WAA0B,EAAE,EAC5B,UAAkB,CAAC;QAEnB,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,eAAe,EAAE,CAAC;QACtC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC;QACvC,IAAI,CAAC,WAAW,GAAG,WAAW,CAAC;QAC/B,IAAI,CAAC,aAAa,GAAG,aAAa,CAAC;QACnC,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;QAC3B,IAAI,CAAC,QAAQ,GAAG;YACd,aAAa,EAAE,IAAI,CAAC,qBAAqB,EAAE;YAC3C,GAAG,QAAQ;SACZ,CAAC;QACF,IAAI,CAAC,SAAS,GAAG,IAAI,IAAI,EAAE,CAAC;QAC5B,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;IACzB,CAAC;IAEO,eAAe;QACrB,OAAO,SAAS,IAAI,CAAC,GAAG,EAAE,IAAI,IAAA,oBAAW,EAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,CAAC;IACjE,CAAC;IAEO,qBAAqB;QAC3B,OAAO,QAAQ,IAAI,CAAC,GAAG,EAAE,IAAI,IAAA,oBAAW,EAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,CAAC;IAChE,CAAC;CACF;AArCD,0CAqCC","names":[],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/common/events/interfaces/domain-event.interface.ts"],"sourcesContent":["import { randomBytes } from 'crypto';\n\nexport interface EventMetadata {\n  userId?: string;\n  sessionId?: string;\n  correlationId?: string;\n  causationId?: string;\n  userRole?: string;\n  ipAddress?: string;\n  userAgent?: string;\n  requestId?: string;\n}\n\nexport interface DomainEvent<T = any> {\n  eventId: string;\n  eventType: string;\n  aggregateId: string;\n  aggregateType: string;\n  eventData: T;\n  metadata: EventMetadata;\n  timestamp: Date;\n  version: number;\n}\n\nexport abstract class BaseDomainEvent<T = any> implements DomainEvent<T> {\n  public readonly eventId: string;\n  public readonly eventType: string;\n  public readonly aggregateId: string;\n  public readonly aggregateType: string;\n  public readonly eventData: T;\n  public readonly metadata: EventMetadata;\n  public readonly timestamp: Date;\n  public readonly version: number;\n\n  constructor(\n    aggregateId: string,\n    aggregateType: string,\n    eventData: T,\n    metadata: EventMetadata = {},\n    version: number = 1,\n  ) {\n    this.eventId = this.generateEventId();\n    this.eventType = this.constructor.name;\n    this.aggregateId = aggregateId;\n    this.aggregateType = aggregateType;\n    this.eventData = eventData;\n    this.metadata = {\n      correlationId: this.generateCorrelationId(),\n      ...metadata,\n    };\n    this.timestamp = new Date();\n    this.version = version;\n  }\n\n  private generateEventId(): string {\n    return `event_${Date.now()}_${randomBytes(8).toString('hex')}`;\n  }\n\n  private generateCorrelationId(): string {\n    return `corr_${Date.now()}_${randomBytes(8).toString('hex')}`;\n  }\n}\n\n// Event Handler Decorator Interface\nexport interface EventHandlerOptions {\n  async?: boolean;\n  parallel?: boolean;\n  scope?: 'user' | 'global';\n}\n\n// Event Bus Interface\nexport interface IEventBus {\n  emit<T = any>(event: DomainEvent<T>): Promise<void>;\n  subscribe<T = any>(\n    eventType: string,\n    handler: (event: DomainEvent<T>) => Promise<void>,\n    options?: EventHandlerOptions,\n  ): void;\n  unsubscribe(eventType: string, handler: (...args: any[]) => any): void;\n}\n"],"version":3}