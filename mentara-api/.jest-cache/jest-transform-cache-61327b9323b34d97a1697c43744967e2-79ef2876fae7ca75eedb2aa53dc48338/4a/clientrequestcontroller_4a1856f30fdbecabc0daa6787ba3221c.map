{"file":"/home/wetooa/Documents/code/projects/mentara/mentara-api/src/client/controllers/client-request.controller.ts","mappings":"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","names":[],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/client/controllers/client-request.controller.ts"],"sourcesContent":["import {\n  Controller,\n  Get,\n  Post,\n  Put,\n  Param,\n  Body,\n  Query,\n  UseGuards,\n  HttpCode,\n  HttpStatus,\n  Logger,\n  NotFoundException,\n  BadRequestException,\n} from '@nestjs/common';\nimport { JwtAuthGuard } from '../../auth/guards/jwt-auth.guard';\nimport { CurrentUserId } from '../../auth/decorators/current-user-id.decorator';\nimport { ZodValidationPipe } from '../../common/pipes/zod-validation.pipe';\nimport {\n  SendTherapistRequestDtoSchema,\n  SendMultipleTherapistRequestsDtoSchema,\n  ClientRequestFiltersDtoSchema,\n  CancelClientRequestDtoSchema,\n  type SendTherapistRequestDto,\n  type SendMultipleTherapistRequestsDto,\n  type ClientRequestFiltersDto,\n  type CancelClientRequestDto,\n} from 'mentara-commons';\nimport { ClientRequestService } from '../services/client-request.service';\nimport {\n  ApiTags,\n  ApiOperation,\n  ApiResponse,\n  ApiBody,\n  ApiBearerAuth,\n  ApiParam,\n  ApiQuery,\n} from '@nestjs/swagger';\n\n@ApiTags('client-request')\n@ApiBearerAuth('JWT-auth')\n@Controller('client/requests')\n@UseGuards(JwtAuthGuard)\nexport class ClientRequestController {\n  private readonly logger = new Logger(ClientRequestController.name);\n\n  constructor(private readonly clientRequestService: ClientRequestService) {}\n\n  @Post('therapist/:therapistId')\n  @ApiOperation({\n    summary: 'Create send therapist request',\n\n    description: 'Create send therapist request',\n  })\n  @ApiResponse({\n    status: 201,\n\n    description: 'Created successfully',\n  })\n  @ApiResponse({ status: 401, description: 'Unauthorized' })\n  @HttpCode(HttpStatus.CREATED)\n  async sendTherapistRequest(\n    @Param('therapistId') therapistId: string,\n    @Body(new ZodValidationPipe(SendTherapistRequestDtoSchema))\n    requestDto: SendTherapistRequestDto,\n    @CurrentUserId() clientId: string,\n  ) {\n    this.logger.log(\n      `Client ${clientId} sending request to therapist ${therapistId}`,\n    );\n\n    // Validate therapist ID format\n    if (!therapistId || therapistId.length !== 36) {\n      throw new BadRequestException('Invalid therapist ID format');\n    }\n\n    return this.clientRequestService.sendTherapistRequest(\n      clientId,\n      therapistId,\n      requestDto,\n    );\n  }\n\n  @Post('therapists/bulk')\n  @ApiOperation({\n    summary: 'Create send multiple therapist requests',\n\n    description: 'Create send multiple therapist requests',\n  })\n  @ApiResponse({\n    status: 201,\n\n    description: 'Created successfully',\n  })\n  @ApiResponse({ status: 401, description: 'Unauthorized' })\n  @HttpCode(HttpStatus.CREATED)\n  async sendMultipleTherapistRequests(\n    @Body(new ZodValidationPipe(SendMultipleTherapistRequestsDtoSchema))\n    requestData: SendMultipleTherapistRequestsDto,\n    @CurrentUserId() clientId: string,\n  ) {\n    this.logger.log(\n      `Client ${clientId} sending requests to ${requestData.therapistIds.length} therapists`,\n    );\n    return this.clientRequestService.sendMultipleTherapistRequests(\n      clientId,\n      requestData,\n    );\n  }\n\n  @Get()\n  @ApiOperation({\n    summary: 'Retrieve get my requests',\n\n    description: 'Retrieve get my requests',\n  })\n  @ApiResponse({\n    status: 200,\n\n    description: 'Retrieved successfully',\n  })\n  @ApiResponse({ status: 401, description: 'Unauthorized' })\n  @HttpCode(HttpStatus.OK)\n  async getMyRequests(\n    @Query(new ZodValidationPipe(ClientRequestFiltersDtoSchema))\n    filters: ClientRequestFiltersDto,\n    @CurrentUserId() clientId: string,\n  ) {\n    this.logger.log(`Client ${clientId} fetching their therapist requests`);\n    return this.clientRequestService.getClientRequests(clientId, filters);\n  }\n\n  @Get(':id')\n  @ApiOperation({\n    summary: 'Retrieve get request details',\n\n    description: 'Retrieve get request details',\n  })\n  @ApiResponse({\n    status: 200,\n\n    description: 'Retrieved successfully',\n  })\n  @ApiResponse({ status: 401, description: 'Unauthorized' })\n  @HttpCode(HttpStatus.OK)\n  async getRequestDetails(\n    @Param('id') requestId: string,\n    @CurrentUserId() clientId: string,\n  ) {\n    this.logger.log(\n      `Client ${clientId} fetching request details for ${requestId}`,\n    );\n\n    // Validate request ID format\n    if (!requestId || requestId.length !== 36) {\n      throw new BadRequestException('Invalid request ID format');\n    }\n\n    const requests = await this.clientRequestService.getClientRequests(\n      clientId,\n      {\n        page: 1,\n        limit: 1,\n        sortBy: 'requestedAt',\n        sortOrder: 'desc',\n      },\n    );\n\n    const request = requests.requests.find((r) => r.id === requestId);\n\n    if (!request) {\n      throw new NotFoundException(\n        `Request with ID ${requestId} not found or not accessible`,\n      );\n    }\n\n    return {\n      success: true,\n      request,\n    };\n  }\n\n  @Put(':id/cancel')\n  @ApiOperation({\n    summary: 'Update cancel request',\n\n    description: 'Update cancel request',\n  })\n  @ApiResponse({\n    status: 200,\n\n    description: 'Updated successfully',\n  })\n  @ApiResponse({ status: 401, description: 'Unauthorized' })\n  @HttpCode(HttpStatus.OK)\n  async cancelRequest(\n    @Param('id') requestId: string,\n    @Body(new ZodValidationPipe(CancelClientRequestDtoSchema))\n    cancelDto: CancelClientRequestDto,\n    @CurrentUserId() clientId: string,\n  ) {\n    this.logger.log(`Client ${clientId} cancelling request ${requestId}`);\n\n    // Validate request ID format\n    if (!requestId || requestId.length !== 36) {\n      throw new BadRequestException('Invalid request ID format');\n    }\n\n    return this.clientRequestService.cancelRequest(\n      requestId,\n      clientId,\n      cancelDto.reason,\n    );\n  }\n\n  @Get('statistics')\n  @ApiOperation({\n    summary: 'Retrieve get request statistics',\n\n    description: 'Retrieve get request statistics',\n  })\n  @ApiResponse({\n    status: 200,\n\n    description: 'Retrieved successfully',\n  })\n  @ApiResponse({ status: 401, description: 'Unauthorized' })\n  @HttpCode(HttpStatus.OK)\n  async getRequestStatistics(@CurrentUserId() clientId: string) {\n    this.logger.log(`Client ${clientId} fetching request statistics`);\n    return this.clientRequestService.getClientRequestStatistics(clientId);\n  }\n\n  @Get('pending/count')\n  @ApiOperation({\n    summary: 'Retrieve get pending requests count',\n\n    description: 'Retrieve get pending requests count',\n  })\n  @ApiResponse({\n    status: 200,\n\n    description: 'Retrieved successfully',\n  })\n  @ApiResponse({ status: 401, description: 'Unauthorized' })\n  @HttpCode(HttpStatus.OK)\n  async getPendingRequestsCount(@CurrentUserId() clientId: string) {\n    this.logger.log(`Client ${clientId} fetching pending requests count`);\n\n    const statistics =\n      await this.clientRequestService.getClientRequestStatistics(clientId);\n\n    return {\n      success: true,\n      pendingCount: statistics.pending,\n      totalSent: statistics.totalSent,\n    };\n  }\n\n  @Get('recent')\n  @ApiOperation({\n    summary: 'Retrieve get recent requests',\n\n    description: 'Retrieve get recent requests',\n  })\n  @ApiResponse({\n    status: 200,\n\n    description: 'Retrieved successfully',\n  })\n  @ApiResponse({ status: 401, description: 'Unauthorized' })\n  @HttpCode(HttpStatus.OK)\n  async getRecentRequests(@CurrentUserId() clientId: string) {\n    this.logger.log(`Client ${clientId} fetching recent requests`);\n\n    const recentRequests = await this.clientRequestService.getClientRequests(\n      clientId,\n      {\n        page: 1,\n        limit: 5,\n        sortBy: 'requestedAt',\n        sortOrder: 'desc',\n      },\n    );\n\n    return {\n      success: true,\n      recentRequests: recentRequests.requests,\n      hasMore: recentRequests.pagination.totalCount > 5,\n    };\n  }\n\n  @Put('expire-stale')\n  @ApiOperation({\n    summary: 'Update expire stale requests',\n\n    description: 'Update expire stale requests',\n  })\n  @ApiResponse({\n    status: 200,\n\n    description: 'Updated successfully',\n  })\n  @ApiResponse({ status: 401, description: 'Unauthorized' })\n  @HttpCode(HttpStatus.OK)\n  async expireStaleRequests(@CurrentUserId() clientId: string) {\n    this.logger.log(`Client ${clientId} triggering stale request expiration`);\n\n    // This endpoint allows clients to manually trigger expiration check\n    // In production, this would typically be a scheduled job\n    return this.clientRequestService.expireStaleRequests();\n  }\n\n  @Get('therapist/:therapistId/status')\n  @ApiOperation({\n    summary: 'Retrieve get request status with therapist',\n\n    description: 'Retrieve get request status with therapist',\n  })\n  @ApiResponse({\n    status: 200,\n\n    description: 'Retrieved successfully',\n  })\n  @ApiResponse({ status: 401, description: 'Unauthorized' })\n  @HttpCode(HttpStatus.OK)\n  async getRequestStatusWithTherapist(\n    @Param('therapistId') therapistId: string,\n    @CurrentUserId() clientId: string,\n  ) {\n    this.logger.log(\n      `Client ${clientId} checking request status with therapist ${therapistId}`,\n    );\n\n    // Validate therapist ID format\n    if (!therapistId || therapistId.length !== 36) {\n      throw new BadRequestException('Invalid therapist ID format');\n    }\n\n    const requests = await this.clientRequestService.getClientRequests(\n      clientId,\n      {\n        therapistId,\n        page: 1,\n        limit: 1,\n        sortBy: 'requestedAt',\n        sortOrder: 'desc',\n      },\n    );\n\n    const hasActiveRequest = requests.requests.length > 0;\n    const latestRequest = hasActiveRequest ? requests.requests[0] : null;\n\n    return {\n      success: true,\n      hasActiveRequest,\n      latestRequest: latestRequest\n        ? {\n            id: latestRequest.id,\n            status: latestRequest.status,\n            requestedAt: latestRequest.requestedAt,\n            respondedAt: latestRequest.respondedAt,\n            expiresAt: latestRequest.expiresAt,\n          }\n        : null,\n      canSendNewRequest:\n        !hasActiveRequest ||\n        (latestRequest &&\n          !['PENDING', 'ACCEPTED'].includes(latestRequest.status)),\n    };\n  }\n\n  @Get('filters/options')\n  @ApiOperation({\n    summary: 'Retrieve get filter options',\n\n    description: 'Retrieve get filter options',\n  })\n  @ApiResponse({\n    status: 200,\n\n    description: 'Retrieved successfully',\n  })\n  @ApiResponse({ status: 401, description: 'Unauthorized' })\n  @HttpCode(HttpStatus.OK)\n  async getFilterOptions(@CurrentUserId() clientId: string) {\n    this.logger.log(`Client ${clientId} fetching filter options`);\n\n    // Return available filter options for the frontend\n    return {\n      success: true,\n      filterOptions: {\n        statuses: [\n          'PENDING',\n          'ACCEPTED',\n          'DECLINED',\n          'EXPIRED',\n          'CANCELLED',\n          'WITHDRAWN',\n        ],\n        priorities: ['LOW', 'NORMAL', 'HIGH', 'URGENT'],\n        sortOptions: [\n          { value: 'requestedAt', label: 'Request Date' },\n          { value: 'respondedAt', label: 'Response Date' },\n          { value: 'priority', label: 'Priority' },\n          { value: 'status', label: 'Status' },\n        ],\n        sortOrders: [\n          { value: 'desc', label: 'Newest First' },\n          { value: 'asc', label: 'Oldest First' },\n        ],\n      },\n    };\n  }\n}\n"],"version":3}