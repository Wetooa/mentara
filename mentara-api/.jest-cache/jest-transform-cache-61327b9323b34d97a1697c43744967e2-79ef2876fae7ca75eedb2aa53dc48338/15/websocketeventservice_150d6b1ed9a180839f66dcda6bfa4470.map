{"version":3,"names":["cov_8c2itgt7h","actualCoverage","common_1","s","require","event_bus_service_1","messaging_gateway_1","WebSocketEventService","WebSocketEventService_1","eventBus","messagingGateway","logger","Logger","name","constructor","f","onModuleInit","subscribeToEvents","log","subscribeToMessagingEvents","subscribeToBookingEvents","subscribeToUserEvents","subscribeToSocialEvents","subscribe","event","messageEvent","conversationId","messageId","senderId","content","messageType","sentAt","recipientIds","eventData","broadcastMessage","id","eventType","recipientId","server","to","getUserSocketRoom","emit","deliveredAt","Date","debug","readEvent","readBy","broadcastReadReceipt","conversationEvent","createdBy","participantIds","conversationType","title","participantId","timestamp","joinEvent","addedBy","joinedAt","role","leftEvent","leftAt","leftReason","typingEvent","userId","isTyping","appointmentEvent","appointmentId","clientId","therapistId","startTime","meetingType","isInitialConsultation","appointmentNotification","message","cancelEvent","cancelledBy","cancellationReason","cancelledAt","cancellationNotification","clientMessage","b","therapistMessage","registrationEvent","firstName","lastName","profileEvent","updatedFields","newValues","profileData","postEvent","postId","authorId","communityId","tags","postType","isAnonymous","commentEvent","commentId","interactionType","subscribeUserToPersonalRoom","socketId","userRoom","in","socketsJoin","unsubscribeUserFromPersonalRoom","socketsLeave","subscribeUserToCommunityRoom","communityRoom","subscribeUserToPostRoom","postRoom","getConnectionStats","totalConnections","sockets","size","eventSubscriptions","getEventStats","totalListeners","broadcastSystemAnnouncement","priority","sendTargetedNotification","userIds","notification","length","exports","__decorate","Injectable","EventBusService","_a","Object","_b","MessagingGateway"],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/messaging/services/websocket-event.service.ts"],"sourcesContent":["import { Injectable, Logger, OnModuleInit } from '@nestjs/common';\nimport { EventBusService } from '../../common/events/event-bus.service';\nimport { DomainEvent } from '../../common/events/interfaces/domain-event.interface';\nimport {\n  MessageSentEvent,\n  MessageReadEvent,\n  ConversationCreatedEvent,\n  ParticipantJoinedEvent,\n  ParticipantLeftEvent,\n  TypingIndicatorEvent,\n} from '../../common/events/messaging-events';\nimport {\n  AppointmentBookedEvent,\n  AppointmentCancelledEvent,\n} from '../../common/events/booking-events';\nimport {\n  UserRegisteredEvent,\n  UserProfileUpdatedEvent,\n} from '../../common/events/user-events';\nimport {\n  PostCreatedEvent,\n  CommentAddedEvent,\n} from '../../common/events/social-events';\nimport { MessagingGateway } from '../messaging.gateway';\n\n@Injectable()\nexport class WebSocketEventService implements OnModuleInit {\n  private readonly logger = new Logger(WebSocketEventService.name);\n\n  constructor(\n    private readonly eventBus: EventBusService,\n    private readonly messagingGateway: MessagingGateway,\n  ) {}\n\n  onModuleInit() {\n    this.subscribeToEvents();\n    this.logger.log('WebSocket event handlers initialized successfully');\n  }\n\n  private subscribeToEvents(): void {\n    // Subscribe to messaging events\n    this.subscribeToMessagingEvents();\n\n    // Subscribe to booking events\n    this.subscribeToBookingEvents();\n\n    // Subscribe to user events\n    this.subscribeToUserEvents();\n\n    // Subscribe to social events\n    this.subscribeToSocialEvents();\n\n    this.logger.log('Subscribed to all WebSocket event handlers');\n  }\n\n  private subscribeToMessagingEvents(): void {\n    // Message sent event - broadcast to conversation participants\n    this.eventBus.subscribe(\n      'MessageSentEvent',\n      async (event: DomainEvent<any>) => {\n        const messageEvent = event as MessageSentEvent;\n        const {\n          conversationId,\n          messageId,\n          senderId,\n          content,\n          messageType,\n          sentAt,\n          recipientIds,\n        } = messageEvent.eventData;\n\n        // Broadcast message to conversation participants via WebSocket\n        this.messagingGateway.broadcastMessage(conversationId, {\n          id: messageId,\n          conversationId,\n          senderId,\n          content,\n          messageType,\n          sentAt,\n          eventType: 'message_sent',\n        });\n\n        // Send delivery confirmations\n        for (const recipientId of recipientIds) {\n          this.messagingGateway.server\n            .to(this.getUserSocketRoom(recipientId))\n            .emit('message_delivered', {\n              messageId,\n              conversationId,\n              deliveredAt: new Date(),\n              eventType: 'message_delivered',\n            });\n        }\n\n        this.logger.debug(`Broadcasted message sent event: ${messageId}`);\n      },\n    );\n\n    // Message read event - broadcast read receipt\n    this.eventBus.subscribe(\n      'MessageReadEvent',\n      async (event: DomainEvent<any>) => {\n        const readEvent = event as MessageReadEvent;\n        const { messageId, conversationId, readBy } = readEvent.eventData;\n\n        this.messagingGateway.broadcastReadReceipt(\n          conversationId,\n          messageId,\n          readBy,\n        );\n\n        this.logger.debug(\n          `Broadcasted message read event: ${messageId} by ${readBy}`,\n        );\n      },\n    );\n\n    // Conversation created event - notify participants\n    this.eventBus.subscribe(\n      'ConversationCreatedEvent',\n      async (event: DomainEvent<any>) => {\n        const conversationEvent = event as ConversationCreatedEvent;\n        const {\n          conversationId,\n          createdBy,\n          participantIds,\n          conversationType,\n          title,\n        } = conversationEvent.eventData;\n\n        // Notify all participants about new conversation\n        for (const participantId of participantIds) {\n          this.messagingGateway.server\n            .to(this.getUserSocketRoom(participantId))\n            .emit('conversation_created', {\n              conversationId,\n              createdBy,\n              conversationType,\n              title,\n              participantIds,\n              eventType: 'conversation_created',\n              timestamp: new Date(),\n            });\n        }\n\n        this.logger.debug(\n          `Broadcasted conversation created event: ${conversationId}`,\n        );\n      },\n    );\n\n    // Participant joined event - notify conversation\n    this.eventBus.subscribe(\n      'ParticipantJoinedEvent',\n      async (event: DomainEvent<any>) => {\n        const joinEvent = event as ParticipantJoinedEvent;\n        const { conversationId, participantId, addedBy, joinedAt, role } =\n          joinEvent.eventData;\n\n        this.messagingGateway.server\n          .to(conversationId)\n          .emit('participant_joined', {\n            conversationId,\n            participantId,\n            addedBy,\n            joinedAt,\n            role,\n            eventType: 'participant_joined',\n          });\n\n        this.logger.debug(\n          `Broadcasted participant joined event: ${participantId} to ${conversationId}`,\n        );\n      },\n    );\n\n    // Participant left event - notify conversation\n    this.eventBus.subscribe(\n      'ParticipantLeftEvent',\n      async (event: DomainEvent<any>) => {\n        const leftEvent = event as ParticipantLeftEvent;\n        const { conversationId, participantId, leftAt, leftReason } =\n          leftEvent.eventData;\n\n        this.messagingGateway.server\n          .to(conversationId)\n          .emit('participant_left', {\n            conversationId,\n            participantId,\n            leftAt,\n            leftReason,\n            eventType: 'participant_left',\n          });\n\n        this.logger.debug(\n          `Broadcasted participant left event: ${participantId} from ${conversationId}`,\n        );\n      },\n    );\n\n    // Typing indicator event - relay to conversation\n    this.eventBus.subscribe(\n      'TypingIndicatorEvent',\n      async (event: DomainEvent<any>) => {\n        const typingEvent = event as TypingIndicatorEvent;\n        const { conversationId, userId, isTyping, timestamp } =\n          typingEvent.eventData;\n\n        this.messagingGateway.server\n          .to(conversationId)\n          .emit('typing_indicator', {\n            conversationId,\n            userId,\n            isTyping,\n            timestamp,\n            eventType: 'typing_indicator',\n          });\n\n        this.logger.debug(\n          `Relayed typing indicator: ${userId} in ${conversationId} - ${isTyping}`,\n        );\n      },\n    );\n  }\n\n  private subscribeToBookingEvents(): void {\n    // Appointment booked event - notify therapist and client\n    this.eventBus.subscribe(\n      'AppointmentBookedEvent',\n      async (event: DomainEvent<any>) => {\n        const appointmentEvent = event as AppointmentBookedEvent;\n        const {\n          appointmentId,\n          clientId,\n          therapistId,\n          startTime,\n          meetingType,\n          isInitialConsultation,\n        } = appointmentEvent.eventData;\n\n        const appointmentNotification = {\n          appointmentId,\n          clientId,\n          therapistId,\n          startTime,\n          meetingType,\n          isInitialConsultation,\n          eventType: 'appointment_booked',\n          timestamp: new Date(),\n        };\n\n        // Notify client\n        this.messagingGateway.server\n          .to(this.getUserSocketRoom(clientId))\n          .emit('appointment_notification', {\n            ...appointmentNotification,\n            message:\n              'Your appointment has been booked and is pending confirmation.',\n          });\n\n        // Notify therapist\n        this.messagingGateway.server\n          .to(this.getUserSocketRoom(therapistId))\n          .emit('appointment_notification', {\n            ...appointmentNotification,\n            message:\n              'You have a new appointment request that requires confirmation.',\n          });\n\n        this.logger.debug(\n          `Broadcasted appointment booked event: ${appointmentId}`,\n        );\n      },\n    );\n\n    // Appointment cancelled event - notify both parties\n    this.eventBus.subscribe(\n      'AppointmentCancelledEvent',\n      async (event: DomainEvent<any>) => {\n        const cancelEvent = event as AppointmentCancelledEvent;\n        const {\n          appointmentId,\n          clientId,\n          therapistId,\n          cancelledBy,\n          cancellationReason,\n          cancelledAt,\n        } = cancelEvent.eventData;\n\n        const cancellationNotification = {\n          appointmentId,\n          clientId,\n          therapistId,\n          cancelledBy,\n          cancellationReason,\n          cancelledAt,\n          eventType: 'appointment_cancelled',\n          timestamp: new Date(),\n        };\n\n        // Determine message based on who cancelled\n        const clientMessage =\n          cancelledBy === clientId\n            ? 'You have cancelled your appointment.'\n            : 'Your appointment has been cancelled by the therapist.';\n\n        const therapistMessage =\n          cancelledBy === therapistId\n            ? 'You have cancelled the appointment.'\n            : 'The client has cancelled their appointment.';\n\n        // Notify client\n        this.messagingGateway.server\n          .to(this.getUserSocketRoom(clientId))\n          .emit('appointment_notification', {\n            ...cancellationNotification,\n            message: clientMessage,\n          });\n\n        // Notify therapist\n        this.messagingGateway.server\n          .to(this.getUserSocketRoom(therapistId))\n          .emit('appointment_notification', {\n            ...cancellationNotification,\n            message: therapistMessage,\n          });\n\n        this.logger.debug(\n          `Broadcasted appointment cancelled event: ${appointmentId}`,\n        );\n      },\n    );\n  }\n\n  private subscribeToUserEvents(): void {\n    // User registered event - welcome notification\n    this.eventBus.subscribe(\n      'UserRegisteredEvent',\n      async (event: DomainEvent<any>) => {\n        const registrationEvent = event as UserRegisteredEvent;\n        const { userId, firstName, lastName, role } =\n          registrationEvent.eventData;\n\n        // Send welcome notification to the new user\n        this.messagingGateway.server\n          .to(this.getUserSocketRoom(userId))\n          .emit('welcome_notification', {\n            userId,\n            firstName,\n            lastName,\n            role,\n            eventType: 'user_registered',\n            message: `Welcome to Mentara, ${firstName}! Your account has been successfully created.`,\n            timestamp: new Date(),\n          });\n\n        this.logger.debug(`Sent welcome notification to new user: ${userId}`);\n      },\n    );\n\n    // User profile updated event - notify relevant connections\n    this.eventBus.subscribe(\n      'UserProfileUpdatedEvent',\n      async (event: DomainEvent<any>) => {\n        const profileEvent = event as UserProfileUpdatedEvent;\n        const { userId, updatedFields, newValues } = profileEvent.eventData;\n\n        // Notify conversations where profile info might be displayed\n        this.messagingGateway.server.emit('user_profile_updated', {\n          userId,\n          updatedFields,\n          profileData: newValues,\n          eventType: 'user_profile_updated',\n          timestamp: new Date(),\n        });\n\n        this.logger.debug(`Broadcasted user profile update: ${userId}`);\n      },\n    );\n  }\n\n  private subscribeToSocialEvents(): void {\n    // Post created event - notify community members\n    this.eventBus.subscribe(\n      'PostCreatedEvent',\n      async (event: DomainEvent<any>) => {\n        const postEvent = event as PostCreatedEvent;\n        const {\n          postId,\n          authorId,\n          communityId,\n          title,\n          content,\n          tags,\n          postType,\n          isAnonymous,\n        } = postEvent.eventData;\n\n        // Broadcast to community room\n        if (communityId) {\n          this.messagingGateway.server\n            .to(`community_${communityId}`)\n            .emit('new_post', {\n              postId,\n              authorId: isAnonymous ? null : authorId, // Hide author if anonymous\n              communityId,\n              title,\n              content,\n              tags,\n              postType,\n              isAnonymous,\n              eventType: 'post_created',\n              timestamp: new Date(),\n            });\n        }\n\n        this.logger.debug(`Broadcasted post created event: ${postId}`);\n      },\n    );\n\n    // Comment added event - notify post author and participants\n    this.eventBus.subscribe(\n      'CommentAddedEvent',\n      async (event: DomainEvent<any>) => {\n        const commentEvent = event as CommentAddedEvent;\n        const { commentId, postId, authorId, content } = commentEvent.eventData;\n\n        // Broadcast to post room\n        this.messagingGateway.server\n          .to(`post_${postId}`)\n          .emit('post_interaction', {\n            commentId,\n            postId,\n            authorId,\n            content,\n            interactionType: 'comment',\n            eventType: 'comment_created',\n            message: 'Someone commented on your post',\n            timestamp: new Date(),\n          });\n\n        // Broadcast to post viewers\n        this.messagingGateway.server.to(`post_${postId}`).emit('new_comment', {\n          commentId,\n          postId,\n          authorId,\n          content,\n          eventType: 'comment_created',\n          timestamp: new Date(),\n        });\n\n        this.logger.debug(\n          `Broadcasted comment created event: ${commentId} on post ${postId}`,\n        );\n      },\n    );\n  }\n\n  /**\n   * Helper method to get user socket room name\n   */\n  private getUserSocketRoom(userId: string): string {\n    return `user_${userId}`;\n  }\n\n  /**\n   * Subscribe users to their personal notification rooms\n   */\n  subscribeUserToPersonalRoom(userId: string, socketId: string): void {\n    const userRoom = this.getUserSocketRoom(userId);\n    this.messagingGateway.server.in(socketId).socketsJoin(userRoom);\n    this.logger.debug(\n      `User ${userId} subscribed to personal room: ${userRoom}`,\n    );\n  }\n\n  /**\n   * Unsubscribe users from their personal notification rooms\n   */\n  unsubscribeUserFromPersonalRoom(userId: string, socketId: string): void {\n    const userRoom = this.getUserSocketRoom(userId);\n    this.messagingGateway.server.in(socketId).socketsLeave(userRoom);\n    this.logger.debug(\n      `User ${userId} unsubscribed from personal room: ${userRoom}`,\n    );\n  }\n\n  /**\n   * Subscribe user to community room for post notifications\n   */\n  subscribeUserToCommunityRoom(\n    userId: string,\n    communityId: string,\n    socketId: string,\n  ): void {\n    const communityRoom = `community_${communityId}`;\n    this.messagingGateway.server.in(socketId).socketsJoin(communityRoom);\n    this.logger.debug(\n      `User ${userId} subscribed to community room: ${communityRoom}`,\n    );\n  }\n\n  /**\n   * Subscribe user to post room for comment notifications\n   */\n  subscribeUserToPostRoom(\n    userId: string,\n    postId: string,\n    socketId: string,\n  ): void {\n    const postRoom = `post_${postId}`;\n    this.messagingGateway.server.in(socketId).socketsJoin(postRoom);\n    this.logger.debug(`User ${userId} subscribed to post room: ${postRoom}`);\n  }\n\n  /**\n   * Get connection statistics\n   */\n  getConnectionStats(): {\n    totalConnections: number;\n    eventSubscriptions: number;\n  } {\n    return {\n      totalConnections: this.messagingGateway.server.sockets.sockets.size,\n      eventSubscriptions: this.eventBus.getEventStats().totalListeners,\n    };\n  }\n\n  /**\n   * Broadcast system-wide announcement\n   */\n  broadcastSystemAnnouncement(\n    message: string,\n    priority: 'low' | 'medium' | 'high' = 'medium',\n  ): void {\n    this.messagingGateway.server.emit('system_announcement', {\n      message,\n      priority,\n      eventType: 'system_announcement',\n      timestamp: new Date(),\n    });\n\n    this.logger.log(\n      `Broadcasted system announcement: ${message} (priority: ${priority})`,\n    );\n  }\n\n  /**\n   * Send targeted notification to specific users\n   */\n  sendTargetedNotification(userIds: string[], notification: any): void {\n    for (const userId of userIds) {\n      this.messagingGateway.server\n        .to(this.getUserSocketRoom(userId))\n        .emit('targeted_notification', {\n          ...notification,\n          eventType: 'targeted_notification',\n          timestamp: new Date(),\n        });\n    }\n\n    this.logger.debug(`Sent targeted notification to ${userIds.length} users`);\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}