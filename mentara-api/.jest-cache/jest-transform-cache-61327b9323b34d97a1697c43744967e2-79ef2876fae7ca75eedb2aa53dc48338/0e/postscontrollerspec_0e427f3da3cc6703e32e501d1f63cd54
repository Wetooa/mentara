b1521459173e22b99bb4eb717c6c124f
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const common_1 = require("@nestjs/common");
const posts_controller_1 = require("./posts.controller");
const posts_service_1 = require("./posts.service");
const jwt_auth_guard_1 = require("../auth/guards/jwt-auth.guard");
const community_access_guard_1 = require("../auth/guards/community-access.guard");
const supabase_storage_service_1 = require("../common/services/supabase-storage.service");
const auth_testing_helpers_1 = require("../test-utils/auth-testing-helpers");
describe('PostsController', () => {
    let controller;
    let postsService;
    let supabaseStorageService;
    let mockJwtAuthGuard;
    let mockCommunityAccessGuard;
    // Mock data
    const mockUser = auth_testing_helpers_1.TestDataGenerator.createUser({
        id: auth_testing_helpers_1.TEST_USER_IDS.CLIENT,
        role: 'client',
    });
    const mockPost = {
        id: auth_testing_helpers_1.TEST_POST_IDS.ANXIETY_POST,
        title: 'Test Post',
        content: 'This is a test post content',
        userId: auth_testing_helpers_1.TEST_USER_IDS.CLIENT,
        roomId: auth_testing_helpers_1.TEST_ROOM_IDS.ANXIETY_CHAT,
        attachmentUrls: [],
        attachmentNames: [],
        attachmentSizes: [],
        createdAt: new Date(),
        updatedAt: new Date(),
    };
    const mockPosts = [mockPost];
    const mockCreatePostDto = {
        title: 'New Test Post',
        content: 'This is a new test post',
        roomId: auth_testing_helpers_1.TEST_ROOM_IDS.ANXIETY_CHAT,
    };
    const mockUpdatePostDto = {
        title: 'Updated Test Post',
        content: 'This is an updated test post',
    };
    const mockFiles = [
        {
            fieldname: 'files',
            originalname: 'test.jpg',
            encoding: '7bit',
            mimetype: 'image/jpeg',
            size: 1024,
            buffer: Buffer.from('test file content'),
        },
    ];
    const mockFileResults = [
        {
            url: 'https://example.com/test.jpg',
            filename: 'test.jpg',
            size: 1024,
        },
    ];
    beforeEach(async () => {
        // Create mock services
        const mockPostsService = {
            findUserById: jest.fn(),
            findAll: jest.fn(),
            findOne: jest.fn(),
            create: jest.fn(),
            update: jest.fn(),
            remove: jest.fn(),
            findByUserId: jest.fn(),
            findByRoomId: jest.fn(),
            heartPost: jest.fn(),
            isPostHeartedByUser: jest.fn(),
            reportPost: jest.fn(),
        };
        const mockSupabaseStorageService = {
            validateFile: jest.fn(),
            uploadFiles: jest.fn(),
            getSupportedBuckets: jest.fn(),
        };
        mockJwtAuthGuard = {
            canActivate: jest.fn().mockReturnValue(true),
        };
        mockCommunityAccessGuard = {
            canActivate: jest.fn().mockReturnValue(true),
        };
        // Add static method mock
        supabase_storage_service_1.SupabaseStorageService.getSupportedBuckets = jest.fn().mockReturnValue({
            POST_ATTACHMENTS: 'post-attachments',
        });
        const module = await testing_1.Test.createTestingModule({
            controllers: [posts_controller_1.PostsController],
            providers: [
                {
                    provide: posts_service_1.PostsService,
                    useValue: mockPostsService,
                },
                {
                    provide: supabase_storage_service_1.SupabaseStorageService,
                    useValue: mockSupabaseStorageService,
                },
            ],
        })
            .overrideGuard(jwt_auth_guard_1.JwtAuthGuard)
            .useValue(mockJwtAuthGuard)
            .overrideGuard(community_access_guard_1.CommunityAccessGuard)
            .useValue(mockCommunityAccessGuard)
            .compile();
        controller = module.get(posts_controller_1.PostsController);
        postsService = module.get(posts_service_1.PostsService);
        supabaseStorageService = module.get(supabase_storage_service_1.SupabaseStorageService);
    });
    afterEach(() => {
        jest.clearAllMocks();
    });
    describe('findAll', () => {
        it('should return all posts for authenticated user', async () => {
            // Arrange
            jest.spyOn(postsService, 'findUserById').mockResolvedValue(mockUser);
            jest.spyOn(postsService, 'findAll').mockResolvedValue(mockPosts);
            // Act
            const result = await controller.findAll(auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            // Assert
            expect(postsService.findUserById).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            expect(postsService.findAll).toHaveBeenCalledWith(mockUser.id);
            expect(result).toEqual(mockPosts);
        });
        it('should handle user not found', async () => {
            // Arrange
            jest.spyOn(postsService, 'findUserById').mockResolvedValue(null);
            jest.spyOn(postsService, 'findAll').mockResolvedValue([]);
            // Act
            const result = await controller.findAll(auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            // Assert
            expect(postsService.findAll).toHaveBeenCalledWith(undefined);
            expect(result).toEqual([]);
        });
        it('should handle service errors', async () => {
            // Arrange
            const error = new Error('Database error');
            jest.spyOn(postsService, 'findUserById').mockRejectedValue(error);
            // Act & Assert
            await expect(controller.findAll(auth_testing_helpers_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('findOne', () => {
        it('should return a specific post when found', async () => {
            // Arrange
            jest.spyOn(postsService, 'findOne').mockResolvedValue(mockPost);
            // Act
            const result = await controller.findOne(auth_testing_helpers_1.TEST_POST_IDS.ANXIETY_POST, auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            // Assert
            expect(postsService.findOne).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_POST_IDS.ANXIETY_POST, auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            expect(result).toEqual(mockPost);
        });
        it('should throw HttpException when post not found', async () => {
            // Arrange
            jest.spyOn(postsService, 'findOne').mockResolvedValue(null);
            // Act & Assert
            await expect(controller.findOne(auth_testing_helpers_1.TEST_POST_IDS.ANXIETY_POST, auth_testing_helpers_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(new common_1.HttpException('Post not found', common_1.HttpStatus.NOT_FOUND));
        });
        it('should handle service errors', async () => {
            // Arrange
            const error = new Error('Database error');
            jest.spyOn(postsService, 'findOne').mockRejectedValue(error);
            // Act & Assert
            await expect(controller.findOne(auth_testing_helpers_1.TEST_POST_IDS.ANXIETY_POST, auth_testing_helpers_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('create', () => {
        it('should create post successfully without files', async () => {
            // Arrange
            jest.spyOn(postsService, 'findUserById').mockResolvedValue(mockUser);
            jest.spyOn(postsService, 'create').mockResolvedValue(mockPost);
            // Act
            const result = await controller.create(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, mockCreatePostDto);
            // Assert
            expect(postsService.findUserById).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            expect(postsService.create).toHaveBeenCalledWith({
                title: mockCreatePostDto.title,
                content: mockCreatePostDto.content,
                user: { connect: { id: mockUser.id } },
                room: { connect: { id: mockCreatePostDto.roomId } },
                attachmentUrls: [],
                attachmentNames: [],
                attachmentSizes: [],
            });
            expect(result).toEqual(mockPost);
        });
        it('should create post successfully with files', async () => {
            // Arrange
            jest.spyOn(postsService, 'findUserById').mockResolvedValue(mockUser);
            jest.spyOn(postsService, 'create').mockResolvedValue(mockPost);
            jest.spyOn(supabaseStorageService, 'validateFile').mockReturnValue({ isValid: true });
            jest.spyOn(supabaseStorageService, 'uploadFiles').mockResolvedValue(mockFileResults);
            // Act
            const result = await controller.create(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, mockCreatePostDto, mockFiles);
            // Assert
            expect(supabaseStorageService.validateFile).toHaveBeenCalledWith(mockFiles[0]);
            expect(supabaseStorageService.uploadFiles).toHaveBeenCalledWith(mockFiles, 'post-attachments');
            expect(postsService.create).toHaveBeenCalledWith({
                title: mockCreatePostDto.title,
                content: mockCreatePostDto.content,
                user: { connect: { id: mockUser.id } },
                room: { connect: { id: mockCreatePostDto.roomId } },
                attachmentUrls: ['https://example.com/test.jpg'],
                attachmentNames: ['test.jpg'],
                attachmentSizes: [1024],
            });
            expect(result).toEqual(mockPost);
        });
        it('should handle file validation errors', async () => {
            // Arrange
            jest.spyOn(postsService, 'findUserById').mockResolvedValue(mockUser);
            jest.spyOn(supabaseStorageService, 'validateFile').mockReturnValue({
                isValid: false,
                error: 'Invalid file type',
            });
            // Act & Assert
            await expect(controller.create(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, mockCreatePostDto, mockFiles)).rejects.toThrow(common_1.HttpException);
        });
        it('should handle user not found', async () => {
            // Arrange
            jest.spyOn(postsService, 'findUserById').mockResolvedValue(null);
            // Act & Assert
            await expect(controller.create(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, mockCreatePostDto)).rejects.toThrow(new common_1.HttpException('User not found', common_1.HttpStatus.NOT_FOUND));
        });
    });
    describe('update', () => {
        it('should update post successfully', async () => {
            // Arrange
            const updatedPost = { ...mockPost, ...mockUpdatePostDto };
            jest.spyOn(postsService, 'update').mockResolvedValue(updatedPost);
            // Act
            const result = await controller.update(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, auth_testing_helpers_1.TEST_POST_IDS.ANXIETY_POST, mockUpdatePostDto);
            // Assert
            expect(postsService.update).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_POST_IDS.ANXIETY_POST, mockUpdatePostDto, auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            expect(result).toEqual(updatedPost);
        });
        it('should handle service errors', async () => {
            // Arrange
            const error = new Error('Post not found');
            jest.spyOn(postsService, 'update').mockRejectedValue(error);
            // Act & Assert
            await expect(controller.update(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, auth_testing_helpers_1.TEST_POST_IDS.ANXIETY_POST, mockUpdatePostDto)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('remove', () => {
        it('should delete post successfully', async () => {
            // Arrange
            jest.spyOn(postsService, 'remove').mockResolvedValue(mockPost);
            // Act
            const result = await controller.remove(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, auth_testing_helpers_1.TEST_POST_IDS.ANXIETY_POST);
            // Assert
            expect(postsService.remove).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_POST_IDS.ANXIETY_POST, auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            expect(result).toEqual(mockPost);
        });
        it('should handle service errors', async () => {
            // Arrange
            const error = new Error('Post not found');
            jest.spyOn(postsService, 'remove').mockRejectedValue(error);
            // Act & Assert
            await expect(controller.remove(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, auth_testing_helpers_1.TEST_POST_IDS.ANXIETY_POST)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('findByUserId', () => {
        it('should return posts by user ID', async () => {
            // Arrange
            jest.spyOn(postsService, 'findByUserId').mockResolvedValue(mockPosts);
            // Act
            const result = await controller.findByUserId(auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            // Assert
            expect(postsService.findByUserId).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            expect(result).toEqual(mockPosts);
        });
        it('should handle service errors', async () => {
            // Arrange
            const error = new Error('Database error');
            jest.spyOn(postsService, 'findByUserId').mockRejectedValue(error);
            // Act & Assert
            await expect(controller.findByUserId(auth_testing_helpers_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('findByRoomId', () => {
        it('should return posts by room ID', async () => {
            // Arrange
            jest.spyOn(postsService, 'findByRoomId').mockResolvedValue(mockPosts);
            // Act
            const result = await controller.findByRoomId(auth_testing_helpers_1.TEST_ROOM_IDS.ANXIETY_CHAT, auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            // Assert
            expect(postsService.findByRoomId).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_ROOM_IDS.ANXIETY_CHAT, auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            expect(result).toEqual(mockPosts);
        });
        it('should handle service errors', async () => {
            // Arrange
            const error = new Error('Database error');
            jest.spyOn(postsService, 'findByRoomId').mockRejectedValue(error);
            // Act & Assert
            await expect(controller.findByRoomId(auth_testing_helpers_1.TEST_ROOM_IDS.ANXIETY_CHAT, auth_testing_helpers_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('heartPost', () => {
        it('should heart post successfully', async () => {
            // Arrange
            const heartResult = { hearted: true };
            jest.spyOn(postsService, 'heartPost').mockResolvedValue(heartResult);
            // Act
            const result = await controller.heartPost(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, auth_testing_helpers_1.TEST_POST_IDS.ANXIETY_POST);
            // Assert
            expect(postsService.heartPost).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_POST_IDS.ANXIETY_POST, auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            expect(result).toEqual(heartResult);
        });
        it('should handle service errors', async () => {
            // Arrange
            const error = new Error('Post not found');
            jest.spyOn(postsService, 'heartPost').mockRejectedValue(error);
            // Act & Assert
            await expect(controller.heartPost(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, auth_testing_helpers_1.TEST_POST_IDS.ANXIETY_POST)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('isPostHearted', () => {
        it('should check if post is hearted successfully', async () => {
            // Arrange
            jest.spyOn(postsService, 'isPostHeartedByUser').mockResolvedValue(true);
            // Act
            const result = await controller.isPostHearted(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, auth_testing_helpers_1.TEST_POST_IDS.ANXIETY_POST);
            // Assert
            expect(postsService.isPostHeartedByUser).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_POST_IDS.ANXIETY_POST, auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            expect(result).toEqual({ hearted: true });
        });
        it('should handle service errors', async () => {
            // Arrange
            const error = new Error('Database error');
            jest.spyOn(postsService, 'isPostHeartedByUser').mockRejectedValue(error);
            // Act & Assert
            await expect(controller.isPostHearted(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, auth_testing_helpers_1.TEST_POST_IDS.ANXIETY_POST)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('reportPost', () => {
        const reportData = {
            reason: 'spam',
            content: 'This post is spam',
        };
        it('should report post successfully', async () => {
            // Arrange
            const reportId = 'report-123';
            jest.spyOn(postsService, 'reportPost').mockResolvedValue(reportId);
            // Act
            const result = await controller.reportPost(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, auth_testing_helpers_1.TEST_POST_IDS.ANXIETY_POST, reportData);
            // Assert
            expect(postsService.reportPost).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_POST_IDS.ANXIETY_POST, auth_testing_helpers_1.TEST_USER_IDS.CLIENT, reportData.reason, reportData.content);
            expect(result).toEqual({ success: true, reportId });
        });
        it('should handle service errors', async () => {
            // Arrange
            const error = new Error('Post not found');
            jest.spyOn(postsService, 'reportPost').mockRejectedValue(error);
            // Act & Assert
            await expect(controller.reportPost(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, auth_testing_helpers_1.TEST_POST_IDS.ANXIETY_POST, reportData)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('Security Integration', () => {
        it('should have proper guards applied', () => {
            // Test that guards are applied at controller level
            const guards = Reflect.getMetadata('__guards__', posts_controller_1.PostsController);
            expect(guards).toBeDefined();
            expect(guards).toContain(jwt_auth_guard_1.JwtAuthGuard);
            expect(guards).toContain(community_access_guard_1.CommunityAccessGuard);
        });
        it('should apply RequirePostingRole decorator to create endpoint', () => {
            // Test that the create endpoint has the RequirePostingRole decorator
            const metadata = Reflect.getMetadata('require_posting_role', controller.create);
            expect(metadata).toBeTruthy();
        });
        it('should apply RequireRoomAccess decorator to protected endpoints', () => {
            // Test that protected endpoints have the RequireRoomAccess decorator
            const protectedMethods = ['findOne', 'update', 'remove', 'findByRoomId', 'heartPost', 'reportPost'];
            protectedMethods.forEach(method => {
                const metadata = Reflect.getMetadata('require_room_access', controller[method]);
                expect(metadata).toBeTruthy();
            });
        });
        it('should test community access guard integration', async () => {
            // Arrange
            const testScenarios = auth_testing_helpers_1.SecurityGuardTestUtils.createAccessControlTestScenarios();
            // Test that CommunityAccessGuard is called for protected endpoints
            mockCommunityAccessGuard.canActivate.mockReturnValue(true);
            jest.spyOn(postsService, 'findOne').mockResolvedValue(mockPost);
            // Act
            await controller.findOne(auth_testing_helpers_1.TEST_POST_IDS.ANXIETY_POST, auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            // Assert
            expect(mockCommunityAccessGuard.canActivate).toHaveBeenCalled();
        });
        it('should handle community access denied', async () => {
            // Arrange
            mockCommunityAccessGuard.canActivate.mockReturnValue(false);
            // This would be handled by the guard before reaching the controller
            // In a real scenario, the guard would throw an exception
            expect(mockCommunityAccessGuard.canActivate).toBeDefined();
        });
    });
    describe('Error Handling', () => {
        it('should handle HttpException properly', async () => {
            // Arrange
            const httpException = new common_1.HttpException('Custom error', common_1.HttpStatus.BAD_REQUEST);
            jest.spyOn(postsService, 'findOne').mockRejectedValue(httpException);
            // Act & Assert
            await expect(controller.findOne(auth_testing_helpers_1.TEST_POST_IDS.ANXIETY_POST, auth_testing_helpers_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(httpException);
        });
        it('should wrap unknown errors in HttpException', async () => {
            // Arrange
            const unknownError = new Error('Unknown error');
            jest.spyOn(postsService, 'findAll').mockRejectedValue(unknownError);
            // Act & Assert
            await expect(controller.findAll(auth_testing_helpers_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('File Upload Integration', () => {
        it('should handle multiple file uploads', async () => {
            // Arrange
            const multipleFiles = [
                { ...mockFiles[0], originalname: 'test1.jpg' },
                { ...mockFiles[0], originalname: 'test2.jpg' },
            ];
            const multipleFileResults = [
                { url: 'https://example.com/test1.jpg', filename: 'test1.jpg', size: 1024 },
                { url: 'https://example.com/test2.jpg', filename: 'test2.jpg', size: 1024 },
            ];
            jest.spyOn(postsService, 'findUserById').mockResolvedValue(mockUser);
            jest.spyOn(postsService, 'create').mockResolvedValue(mockPost);
            jest.spyOn(supabaseStorageService, 'validateFile').mockReturnValue({ isValid: true });
            jest.spyOn(supabaseStorageService, 'uploadFiles').mockResolvedValue(multipleFileResults);
            // Act
            const result = await controller.create(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, mockCreatePostDto, multipleFiles);
            // Assert
            expect(supabaseStorageService.validateFile).toHaveBeenCalledTimes(2);
            expect(supabaseStorageService.uploadFiles).toHaveBeenCalledWith(multipleFiles, 'post-attachments');
            expect(postsService.create).toHaveBeenCalledWith({
                title: mockCreatePostDto.title,
                content: mockCreatePostDto.content,
                user: { connect: { id: mockUser.id } },
                room: { connect: { id: mockCreatePostDto.roomId } },
                attachmentUrls: ['https://example.com/test1.jpg', 'https://example.com/test2.jpg'],
                attachmentNames: ['test1.jpg', 'test2.jpg'],
                attachmentSizes: [1024, 1024],
            });
            expect(result).toEqual(mockPost);
        });
        it('should handle file upload service errors', async () => {
            // Arrange
            jest.spyOn(postsService, 'findUserById').mockResolvedValue(mockUser);
            jest.spyOn(supabaseStorageService, 'validateFile').mockReturnValue({ isValid: true });
            jest.spyOn(supabaseStorageService, 'uploadFiles').mockRejectedValue(new Error('Upload failed'));
            // Act & Assert
            await expect(controller.create(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, mockCreatePostDto, mockFiles)).rejects.toThrow(common_1.HttpException);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL3Bvc3RzL3Bvc3RzLmNvbnRyb2xsZXIuc3BlYy50cyIsIm1hcHBpbmdzIjoiOztBQUFBLDZDQUFzRDtBQUN0RCwyQ0FBMkQ7QUFDM0QseURBQXFEO0FBQ3JELG1EQUErQztBQUMvQyxrRUFBNkQ7QUFDN0Qsa0ZBQTZFO0FBQzdFLDBGQUFxRjtBQUVyRiw2RUFTNEM7QUFHNUMsUUFBUSxDQUFDLGlCQUFpQixFQUFFLEdBQUcsRUFBRTtJQUMvQixJQUFJLFVBQTJCLENBQUM7SUFDaEMsSUFBSSxZQUEwQixDQUFDO0lBQy9CLElBQUksc0JBQThDLENBQUM7SUFDbkQsSUFBSSxnQkFBMkMsQ0FBQztJQUNoRCxJQUFJLHdCQUEyRCxDQUFDO0lBRWhFLFlBQVk7SUFDWixNQUFNLFFBQVEsR0FBRyx3Q0FBaUIsQ0FBQyxVQUFVLENBQUM7UUFDNUMsRUFBRSxFQUFFLG9DQUFhLENBQUMsTUFBTTtRQUN4QixJQUFJLEVBQUUsUUFBUTtLQUNmLENBQUMsQ0FBQztJQUVILE1BQU0sUUFBUSxHQUFlO1FBQzNCLEVBQUUsRUFBRSxvQ0FBYSxDQUFDLFlBQVk7UUFDOUIsS0FBSyxFQUFFLFdBQVc7UUFDbEIsT0FBTyxFQUFFLDZCQUE2QjtRQUN0QyxNQUFNLEVBQUUsb0NBQWEsQ0FBQyxNQUFNO1FBQzVCLE1BQU0sRUFBRSxvQ0FBYSxDQUFDLFlBQVk7UUFDbEMsY0FBYyxFQUFFLEVBQUU7UUFDbEIsZUFBZSxFQUFFLEVBQUU7UUFDbkIsZUFBZSxFQUFFLEVBQUU7UUFDbkIsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFO1FBQ3JCLFNBQVMsRUFBRSxJQUFJLElBQUksRUFBRTtLQUN0QixDQUFDO0lBRUYsTUFBTSxTQUFTLEdBQWlCLENBQUMsUUFBUSxDQUFDLENBQUM7SUFFM0MsTUFBTSxpQkFBaUIsR0FBRztRQUN4QixLQUFLLEVBQUUsZUFBZTtRQUN0QixPQUFPLEVBQUUseUJBQXlCO1FBQ2xD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WUFDVixJQUFJLENBQUMsS0FBSyxDQUFDLFlBQVksRUFBRSxjQUFjLENBQUMsQ0FBQyxpQkFBaUIsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUNyRSxJQUFJLENBQUMsS0FBSyxDQUFDLHNCQUFzQixFQUFFLGNBQWMsQ0FBQyxDQUFDLGVBQWUsQ0FBQyxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO1lBQ3RGLElBQUksQ0FBQyxLQUFLLENBQUMsc0JBQXNCLEVBQUUsYUFBYSxDQUFDLENBQUMsaUJBQWlCLENBQUMsSUFBSSxLQUFLLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQztZQUVoRyxlQUFlO1lBQ2YsTUFBTSxNQUFNLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxvQ0FBYSxDQUFDLE1BQU0sRUFBRSxpQkFBaUIsRUFBRSxTQUFTLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQ2pHLHNCQUFhLENBQ2QsQ0FBQztRQUNKLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS93ZXRvb2EvRG9jdW1lbnRzL2NvZGUvcHJvamVjdHMvbWVudGFyYS9tZW50YXJhLWFwaS9zcmMvcG9zdHMvcG9zdHMuY29udHJvbGxlci5zcGVjLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFRlc3QsIFRlc3RpbmdNb2R1bGUgfSBmcm9tICdAbmVzdGpzL3Rlc3RpbmcnO1xuaW1wb3J0IHsgSHR0cEV4Y2VwdGlvbiwgSHR0cFN0YXR1cyB9IGZyb20gJ0BuZXN0anMvY29tbW9uJztcbmltcG9ydCB7IFBvc3RzQ29udHJvbGxlciB9IGZyb20gJy4vcG9zdHMuY29udHJvbGxlcic7XG5pbXBvcnQgeyBQb3N0c1NlcnZpY2UgfSBmcm9tICcuL3Bvc3RzLnNlcnZpY2UnO1xuaW1wb3J0IHsgSnd0QXV0aEd1YXJkIH0gZnJvbSAnLi4vYXV0aC9ndWFyZHMvand0LWF1dGguZ3VhcmQnO1xuaW1wb3J0IHsgQ29tbXVuaXR5QWNjZXNzR3VhcmQgfSBmcm9tICcuLi9hdXRoL2d1YXJkcy9jb21tdW5pdHktYWNjZXNzLmd1YXJkJztcbmltcG9ydCB7IFN1cGFiYXNlU3RvcmFnZVNlcnZpY2UgfSBmcm9tICcuLi9jb21tb24vc2VydmljZXMvc3VwYWJhc2Utc3RvcmFnZS5zZXJ2aWNlJztcbmltcG9ydCB7IFBvc3QgYXMgUG9zdEVudGl0eSB9IGZyb20gJ0BwcmlzbWEvY2xpZW50JztcbmltcG9ydCB7XG4gIE1vY2tCdWlsZGVyLFxuICBUZXN0RGF0YUdlbmVyYXRvcixcbiAgVGVzdEFzc2VydGlvbnMsXG4gIFNlY3VyaXR5R3VhcmRUZXN0VXRpbHMsXG4gIFRFU1RfVVNFUl9JRFMsXG4gIFRFU1RfUE9TVF9JRFMsXG4gIFRFU1RfUk9PTV9JRFMsXG4gIFRFU1RfQ09NTVVOSVRZX0lEUyxcbn0gZnJvbSAnLi4vdGVzdC11dGlscy9hdXRoLXRlc3RpbmctaGVscGVycyc7XG5pbXBvcnQgeyBjcmVhdGVNb2NrUHJpc21hU2VydmljZSB9IGZyb20gJy4uL3Rlc3QtdXRpbHMnO1xuXG5kZXNjcmliZSgnUG9zdHNDb250cm9sbGVyJywgKCkgPT4ge1xuICBsZXQgY29udHJvbGxlcjogUG9zdHNDb250cm9sbGVyO1xuICBsZXQgcG9zdHNTZXJ2aWNlOiBQb3N0c1NlcnZpY2U7XG4gIGxldCBzdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlOiBTdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlO1xuICBsZXQgbW9ja0p3dEF1dGhHdWFyZDogamVzdC5Nb2NrZWQ8Snd0QXV0aEd1YXJkPjtcbiAgbGV0IG1vY2tDb21tdW5pdHlBY2Nlc3NHdWFyZDogamVzdC5Nb2NrZWQ8Q29tbXVuaXR5QWNjZXNzR3VhcmQ+O1xuXG4gIC8vIE1vY2sgZGF0YVxuICBjb25zdCBtb2NrVXNlciA9IFRlc3REYXRhR2VuZXJhdG9yLmNyZWF0ZVVzZXIoe1xuICAgIGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICByb2xlOiAnY2xpZW50JyxcbiAgfSk7XG5cbiAgY29uc3QgbW9ja1Bvc3Q6IFBvc3RFbnRpdHkgPSB7XG4gICAgaWQ6IFRFU1RfUE9TVF9JRFMuQU5YSUVUWV9QT1NULFxuICAgIHRpdGxlOiAnVGVzdCBQb3N0JyxcbiAgICBjb250ZW50OiAnVGhpcyBpcyBhIHRlc3QgcG9zdCBjb250ZW50JyxcbiAgICB1c2VySWQ6IFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgIHJvb21JZDogVEVTVF9ST09NX0lEUy5BTlhJRVRZX0NIQVQsXG4gICAgYXR0YWNobWVudFVybHM6IFtdLFxuICAgIGF0dGFjaG1lbnROYW1lczogW10sXG4gICAgYXR0YWNobWVudFNpemVzOiBbXSxcbiAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICB9O1xuXG4gIGNvbnN0IG1vY2tQb3N0czogUG9zdEVudGl0eVtdID0gW21vY2tQb3N0XTtcblxuICBjb25zdCBtb2NrQ3JlYXRlUG9zdER0byA9IHtcbiAgICB0aXRsZTogJ05ldyBUZXN0IFBvc3QnLFxuICAgIGNvbnRlbnQ6ICdUaGlzIGlzIGEgbmV3IHRlc3QgcG9zdCcsXG4gICAgcm9vbUlkOiBURVNUX1JPT01fSURTLkFOWElFVFlfQ0hBVCxcbiAgfTtcblxuICBjb25zdCBtb2NrVXBkYXRlUG9zdER0byA9IHtcbiAgICB0aXRsZTogJ1VwZGF0ZWQgVGVzdCBQb3N0JyxcbiAgICBjb250ZW50OiAnVGhpcyBpcyBhbiB1cGRhdGVkIHRlc3QgcG9zdCcsXG4gIH07XG5cbiAgY29uc3QgbW9ja0ZpbGVzID0gW1xuICAgIHtcbiAgICAgIGZpZWxkbmFtZTogJ2ZpbGVzJyxcbiAgICAgIG9yaWdpbmFsbmFtZTogJ3Rlc3QuanBnJyxcbiAgICAgIGVuY29kaW5nOiAnN2JpdCcsXG4gICAgICBtaW1ldHlwZTogJ2ltYWdlL2pwZWcnLFxuICAgICAgc2l6ZTogMTAyNCxcbiAgICAgIGJ1ZmZlcjogQnVmZmVyLmZyb20oJ3Rlc3QgZmlsZSBjb250ZW50JyksXG4gICAgfSxcbiAgXSBhcyBFeHByZXNzLk11bHRlci5GaWxlW107XG5cbiAgY29uc3QgbW9ja0ZpbGVSZXN1bHRzID0gW1xuICAgIHtcbiAgICAgIHVybDogJ2h0dHBzOi8vZXhhbXBsZS5jb20vdGVzdC5qcGcnLFxuICAgICAgZmlsZW5hbWU6ICd0ZXN0LmpwZycsXG4gICAgICBzaXplOiAxMDI0LFxuICAgIH0sXG4gIF07XG5cbiAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7XG4gICAgLy8gQ3JlYXRlIG1vY2sgc2VydmljZXNcbiAgICBjb25zdCBtb2NrUG9zdHNTZXJ2aWNlID0ge1xuICAgICAgZmluZFVzZXJCeUlkOiBqZXN0LmZuKCksXG4gICAgICBmaW5kQWxsOiBqZXN0LmZuKCksXG4gICAgICBmaW5kT25lOiBqZXN0LmZuKCksXG4gICAgICBjcmVhdGU6IGplc3QuZm4oKSxcbiAgICAgIHVwZGF0ZTogamVzdC5mbigpLFxuICAgICAgcmVtb3ZlOiBqZXN0LmZuKCksXG4gICAgICBmaW5kQnlVc2VySWQ6IGplc3QuZm4oKSxcbiAgICAgIGZpbmRCeVJvb21JZDogamVzdC5mbigpLFxuICAgICAgaGVhcnRQb3N0OiBqZXN0LmZuKCksXG4gICAgICBpc1Bvc3RIZWFydGVkQnlVc2VyOiBqZXN0LmZuKCksXG4gICAgICByZXBvcnRQb3N0OiBqZXN0LmZuKCksXG4gICAgfTtcblxuICAgIGNvbnN0IG1vY2tTdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlID0ge1xuICAgICAgdmFsaWRhdGVGaWxlOiBqZXN0LmZuKCksXG4gICAgICB1cGxvYWRGaWxlczogamVzdC5mbigpLFxuICAgICAgZ2V0U3VwcG9ydGVkQnVja2V0czogamVzdC5mbigpLFxuICAgIH07XG5cbiAgICBtb2NrSnd0QXV0aEd1YXJkID0ge1xuICAgICAgY2FuQWN0aXZhdGU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUodHJ1ZSksXG4gICAgfSBhcyBhbnk7XG5cbiAgICBtb2NrQ29tbXVuaXR5QWNjZXNzR3VhcmQgPSB7XG4gICAgICBjYW5BY3RpdmF0ZTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh0cnVlKSxcbiAgICB9IGFzIGFueTtcblxuICAgIC8vIEFkZCBzdGF0aWMgbWV0aG9kIG1vY2tcbiAgICBTdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlLmdldFN1cHBvcnRlZEJ1Y2tldHMgPSBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgIFBPU1RfQVRUQUNITUVOVFM6ICdwb3N0LWF0dGFjaG1lbnRzJyxcbiAgICB9KTtcblxuICAgIGNvbnN0IG1vZHVsZTogVGVzdGluZ01vZHVsZSA9IGF3YWl0IFRlc3QuY3JlYXRlVGVzdGluZ01vZHVsZSh7XG4gICAgICBjb250cm9sbGVyczogW1Bvc3RzQ29udHJvbGxlcl0sXG4gICAgICBwcm92aWRlcnM6IFtcbiAgICAgICAge1xuICAgICAgICAgIHByb3ZpZGU6IFBvc3RzU2VydmljZSxcbiAgICAgICAgICB1c2VWYWx1ZTogbW9ja1Bvc3RzU2VydmljZSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHByb3ZpZGU6IFN1cGFiYXNlU3RvcmFnZVNlcnZpY2UsXG4gICAgICAgICAgdXNlVmFsdWU6IG1vY2tTdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlLFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICB9KVxuICAgICAgLm92ZXJyaWRlR3VhcmQoSnd0QXV0aEd1YXJkKVxuICAgICAgLnVzZVZhbHVlKG1vY2tKd3RBdXRoR3VhcmQpXG4gICAgICAub3ZlcnJpZGVHdWFyZChDb21tdW5pdHlBY2Nlc3NHdWFyZClcbiAgICAgIC51c2VWYWx1ZShtb2NrQ29tbXVuaXR5QWNjZXNzR3VhcmQpXG4gICAgICAuY29tcGlsZSgpO1xuXG4gICAgY29udHJvbGxlciA9IG1vZHVsZS5nZXQ8UG9zdHNDb250cm9sbGVyPihQb3N0c0NvbnRyb2xsZXIpO1xuICAgIHBvc3RzU2VydmljZSA9IG1vZHVsZS5nZXQ8UG9zdHNTZXJ2aWNlPihQb3N0c1NlcnZpY2UpO1xuICAgIHN1cGFiYXNlU3RvcmFnZVNlcnZpY2UgPSBtb2R1bGUuZ2V0PFN1cGFiYXNlU3RvcmFnZVNlcnZpY2U+KFN1cGFiYXNlU3RvcmFnZVNlcnZpY2UpO1xuICB9KTtcblxuICBhZnRlckVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICB9KTtcblxuICBkZXNjcmliZSgnZmluZEFsbCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiBhbGwgcG9zdHMgZm9yIGF1dGhlbnRpY2F0ZWQgdXNlcicsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGplc3Quc3B5T24ocG9zdHNTZXJ2aWNlLCAnZmluZFVzZXJCeUlkJykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXIpO1xuICAgICAgamVzdC5zcHlPbihwb3N0c1NlcnZpY2UsICdmaW5kQWxsJykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1Bvc3RzKTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmZpbmRBbGwoVEVTVF9VU0VSX0lEUy5DTElFTlQpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChwb3N0c1NlcnZpY2UuZmluZFVzZXJCeUlkKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChURVNUX1VTRVJfSURTLkNMSUVOVCk7XG4gICAgICBleHBlY3QocG9zdHNTZXJ2aWNlLmZpbmRBbGwpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKG1vY2tVc2VyLmlkKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja1Bvc3RzKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHVzZXIgbm90IGZvdW5kJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgamVzdC5zcHlPbihwb3N0c1NlcnZpY2UsICdmaW5kVXNlckJ5SWQnKS5tb2NrUmVzb2x2ZWRWYWx1ZShudWxsKTtcbiAgICAgIGplc3Quc3B5T24ocG9zdHNTZXJ2aWNlLCAnZmluZEFsbCcpLm1vY2tSZXNvbHZlZFZhbHVlKFtdKTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmZpbmRBbGwoVEVTVF9VU0VSX0lEUy5DTElFTlQpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChwb3N0c1NlcnZpY2UuZmluZEFsbCkudG9IYXZlQmVlbkNhbGxlZFdpdGgodW5kZWZpbmVkKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoW10pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2VydmljZSBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcignRGF0YWJhc2UgZXJyb3InKTtcbiAgICAgIGplc3Quc3B5T24ocG9zdHNTZXJ2aWNlLCAnZmluZFVzZXJCeUlkJykubW9ja1JlamVjdGVkVmFsdWUoZXJyb3IpO1xuXG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChjb250cm9sbGVyLmZpbmRBbGwoVEVTVF9VU0VSX0lEUy5DTElFTlQpKS5yZWplY3RzLnRvVGhyb3coSHR0cEV4Y2VwdGlvbik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdmaW5kT25lJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIGEgc3BlY2lmaWMgcG9zdCB3aGVuIGZvdW5kJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgamVzdC5zcHlPbihwb3N0c1NlcnZpY2UsICdmaW5kT25lJykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1Bvc3QpO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZmluZE9uZShURVNUX1BPU1RfSURTLkFOWElFVFlfUE9TVCwgVEVTVF9VU0VSX0lEUy5DTElFTlQpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChwb3N0c1NlcnZpY2UuZmluZE9uZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoVEVTVF9QT1NUX0lEUy5BTlhJRVRZX1BPU1QsIFRFU1RfVVNFUl9JRFMuQ0xJRU5UKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja1Bvc3QpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0aHJvdyBIdHRwRXhjZXB0aW9uIHdoZW4gcG9zdCBub3QgZm91bmQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBqZXN0LnNweU9uKHBvc3RzU2VydmljZSwgJ2ZpbmRPbmUnKS5tb2NrUmVzb2x2ZWRWYWx1ZShudWxsKTtcblxuICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICBhd2FpdCBleHBlY3QoY29udHJvbGxlci5maW5kT25lKFRFU1RfUE9TVF9JRFMuQU5YSUVUWV9QT1NULCBURVNUX1VTRVJfSURTLkNMSUVOVCkpLnJlamVjdHMudG9UaHJvdyhcbiAgICAgICAgbmV3IEh0dHBFeGNlcHRpb24oJ1Bvc3Qgbm90IGZvdW5kJywgSHR0cFN0YXR1cy5OT1RfRk9VTkQpLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHNlcnZpY2UgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ0RhdGFiYXNlIGVycm9yJyk7XG4gICAgICBqZXN0LnNweU9uKHBvc3RzU2VydmljZSwgJ2ZpbmRPbmUnKS5tb2NrUmVqZWN0ZWRWYWx1ZShlcnJvcik7XG5cbiAgICAgIC8vIEFjdCAmIEFzc2VydFxuICAgICAgYXdhaXQgZXhwZWN0KGNvbnRyb2xsZXIuZmluZE9uZShURVNUX1BPU1RfSURTLkFOWElFVFlfUE9TVCwgVEVTVF9VU0VSX0lEUy5DTElFTlQpKS5yZWplY3RzLnRvVGhyb3coSHR0cEV4Y2VwdGlvbik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdjcmVhdGUnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgcG9zdCBzdWNjZXNzZnVsbHkgd2l0aG91dCBmaWxlcycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGplc3Quc3B5T24ocG9zdHNTZXJ2aWNlLCAnZmluZFVzZXJCeUlkJykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXIpO1xuICAgICAgamVzdC5zcHlPbihwb3N0c1NlcnZpY2UsICdjcmVhdGUnKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUG9zdCk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5jcmVhdGUoVEVTVF9VU0VSX0lEUy5DTElFTlQsIG1vY2tDcmVhdGVQb3N0RHRvKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QocG9zdHNTZXJ2aWNlLmZpbmRVc2VyQnlJZCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoVEVTVF9VU0VSX0lEUy5DTElFTlQpO1xuICAgICAgZXhwZWN0KHBvc3RzU2VydmljZS5jcmVhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgdGl0bGU6IG1vY2tDcmVhdGVQb3N0RHRvLnRpdGxlLFxuICAgICAgICBjb250ZW50OiBtb2NrQ3JlYXRlUG9zdER0by5jb250ZW50LFxuICAgICAgICB1c2VyOiB7IGNvbm5lY3Q6IHsgaWQ6IG1vY2tVc2VyLmlkIH0gfSxcbiAgICAgICAgcm9vbTogeyBjb25uZWN0OiB7IGlkOiBtb2NrQ3JlYXRlUG9zdER0by5yb29tSWQgfSB9LFxuICAgICAgICBhdHRhY2htZW50VXJsczogW10sXG4gICAgICAgIGF0dGFjaG1lbnROYW1lczogW10sXG4gICAgICAgIGF0dGFjaG1lbnRTaXplczogW10sXG4gICAgICB9KTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja1Bvc3QpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgcG9zdCBzdWNjZXNzZnVsbHkgd2l0aCBmaWxlcycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGplc3Quc3B5T24ocG9zdHNTZXJ2aWNlLCAnZmluZFVzZXJCeUlkJykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXIpO1xuICAgICAgamVzdC5zcHlPbihwb3N0c1NlcnZpY2UsICdjcmVhdGUnKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUG9zdCk7XG4gICAgICBqZXN0LnNweU9uKHN1cGFiYXNlU3RvcmFnZVNlcnZpY2UsICd2YWxpZGF0ZUZpbGUnKS5tb2NrUmV0dXJuVmFsdWUoeyBpc1ZhbGlkOiB0cnVlIH0pO1xuICAgICAgamVzdC5zcHlPbihzdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlLCAndXBsb2FkRmlsZXMnKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrRmlsZVJlc3VsdHMpO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuY3JlYXRlKFRFU1RfVVNFUl9JRFMuQ0xJRU5ULCBtb2NrQ3JlYXRlUG9zdER0bywgbW9ja0ZpbGVzKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3Qoc3VwYWJhc2VTdG9yYWdlU2VydmljZS52YWxpZGF0ZUZpbGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKG1vY2tGaWxlc1swXSk7XG4gICAgICBleHBlY3Qoc3VwYWJhc2VTdG9yYWdlU2VydmljZS51cGxvYWRGaWxlcykudG9IYXZlQmVlbkNhbGxlZFdpdGgobW9ja0ZpbGVzLCAncG9zdC1hdHRhY2htZW50cycpO1xuICAgICAgZXhwZWN0KHBvc3RzU2VydmljZS5jcmVhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgdGl0bGU6IG1vY2tDcmVhdGVQb3N0RHRvLnRpdGxlLFxuICAgICAgICBjb250ZW50OiBtb2NrQ3JlYXRlUG9zdER0by5jb250ZW50LFxuICAgICAgICB1c2VyOiB7IGNvbm5lY3Q6IHsgaWQ6IG1vY2tVc2VyLmlkIH0gfSxcbiAgICAgICAgcm9vbTogeyBjb25uZWN0OiB7IGlkOiBtb2NrQ3JlYXRlUG9zdER0by5yb29tSWQgfSB9LFxuICAgICAgICBhdHRhY2htZW50VXJsczogWydodHRwczovL2V4YW1wbGUuY29tL3Rlc3QuanBnJ10sXG4gICAgICAgIGF0dGFjaG1lbnROYW1lczogWyd0ZXN0LmpwZyddLFxuICAgICAgICBhdHRhY2htZW50U2l6ZXM6IFsxMDI0XSxcbiAgICAgIH0pO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2NrUG9zdCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBmaWxlIHZhbGlkYXRpb24gZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgamVzdC5zcHlPbihwb3N0c1NlcnZpY2UsICdmaW5kVXNlckJ5SWQnKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXNlcik7XG4gICAgICBqZXN0LnNweU9uKHN1cGFiYXNlU3RvcmFnZVNlcnZpY2UsICd2YWxpZGF0ZUZpbGUnKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICBpc1ZhbGlkOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6ICdJbnZhbGlkIGZpbGUgdHlwZScsXG4gICAgICB9KTtcblxuICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICBhd2FpdCBleHBlY3QoY29udHJvbGxlci5jcmVhdGUoVEVTVF9VU0VSX0lEUy5DTElFTlQsIG1vY2tDcmVhdGVQb3N0RHRvLCBtb2NrRmlsZXMpKS5yZWplY3RzLnRvVGhyb3coXG4gICAgICAgIEh0dHBFeGNlcHRpb24sXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgdXNlciBub3QgZm91bmQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBqZXN0LnNweU9uKHBvc3RzU2VydmljZSwgJ2ZpbmRVc2VyQnlJZCcpLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpO1xuXG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChjb250cm9sbGVyLmNyZWF0ZShURVNUX1VTRVJfSURTLkNMSUVOVCwgbW9ja0NyZWF0ZVBvc3REdG8pKS5yZWplY3RzLnRvVGhyb3coXG4gICAgICAgIG5ldyBIdHRwRXhjZXB0aW9uKCdVc2VyIG5vdCBmb3VuZCcsIEh0dHBTdGF0dXMuTk9UX0ZPVU5EKSxcbiAgICAgICk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCd1cGRhdGUnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCB1cGRhdGUgcG9zdCBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCB1cGRhdGVkUG9zdCA9IHsgLi4ubW9ja1Bvc3QsIC4uLm1vY2tVcGRhdGVQb3N0RHRvIH07XG4gICAgICBqZXN0LnNweU9uKHBvc3RzU2VydmljZSwgJ3VwZGF0ZScpLm1vY2tSZXNvbHZlZFZhbHVlKHVwZGF0ZWRQb3N0KTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLnVwZGF0ZShURVNUX1VTRVJfSURTLkNMSUVOVCwgVEVTVF9QT1NUX0lEUy5BTlhJRVRZX1BPU1QsIG1vY2tVcGRhdGVQb3N0RHRvKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QocG9zdHNTZXJ2aWNlLnVwZGF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIFRFU1RfUE9TVF9JRFMuQU5YSUVUWV9QT1NULFxuICAgICAgICBtb2NrVXBkYXRlUG9zdER0byxcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICApO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh1cGRhdGVkUG9zdCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzZXJ2aWNlIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCdQb3N0IG5vdCBmb3VuZCcpO1xuICAgICAgamVzdC5zcHlPbihwb3N0c1NlcnZpY2UsICd1cGRhdGUnKS5tb2NrUmVqZWN0ZWRWYWx1ZShlcnJvcik7XG5cbiAgICAgIC8vIEFjdCAmIEFzc2VydFxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLnVwZGF0ZShURVNUX1VTRVJfSURTLkNMSUVOVCwgVEVTVF9QT1NUX0lEUy5BTlhJRVRZX1BPU1QsIG1vY2tVcGRhdGVQb3N0RHRvKSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KEh0dHBFeGNlcHRpb24pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgncmVtb3ZlJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZGVsZXRlIHBvc3Qgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgamVzdC5zcHlPbihwb3N0c1NlcnZpY2UsICdyZW1vdmUnKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUG9zdCk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5yZW1vdmUoVEVTVF9VU0VSX0lEUy5DTElFTlQsIFRFU1RfUE9TVF9JRFMuQU5YSUVUWV9QT1NUKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QocG9zdHNTZXJ2aWNlLnJlbW92ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoVEVTVF9QT1NUX0lEUy5BTlhJRVRZX1BPU1QsIFRFU1RfVVNFUl9JRFMuQ0xJRU5UKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja1Bvc3QpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2VydmljZSBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcignUG9zdCBub3QgZm91bmQnKTtcbiAgICAgIGplc3Quc3B5T24ocG9zdHNTZXJ2aWNlLCAncmVtb3ZlJykubW9ja1JlamVjdGVkVmFsdWUoZXJyb3IpO1xuXG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChjb250cm9sbGVyLnJlbW92ZShURVNUX1VTRVJfSURTLkNMSUVOVCwgVEVTVF9QT1NUX0lEUy5BTlhJRVRZX1BPU1QpKS5yZWplY3RzLnRvVGhyb3coSHR0cEV4Y2VwdGlvbik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdmaW5kQnlVc2VySWQnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gcG9zdHMgYnkgdXNlciBJRCcsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGplc3Quc3B5T24ocG9zdHNTZXJ2aWNlLCAnZmluZEJ5VXNlcklkJykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1Bvc3RzKTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmZpbmRCeVVzZXJJZChURVNUX1VTRVJfSURTLkNMSUVOVCk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHBvc3RzU2VydmljZS5maW5kQnlVc2VySWQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFRFU1RfVVNFUl9JRFMuQ0xJRU5UKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja1Bvc3RzKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHNlcnZpY2UgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ0RhdGFiYXNlIGVycm9yJyk7XG4gICAgICBqZXN0LnNweU9uKHBvc3RzU2VydmljZSwgJ2ZpbmRCeVVzZXJJZCcpLm1vY2tSZWplY3RlZFZhbHVlKGVycm9yKTtcblxuICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICBhd2FpdCBleHBlY3QoY29udHJvbGxlci5maW5kQnlVc2VySWQoVEVTVF9VU0VSX0lEUy5DTElFTlQpKS5yZWplY3RzLnRvVGhyb3coSHR0cEV4Y2VwdGlvbik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdmaW5kQnlSb29tSWQnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gcG9zdHMgYnkgcm9vbSBJRCcsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGplc3Quc3B5T24ocG9zdHNTZXJ2aWNlLCAnZmluZEJ5Um9vbUlkJykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1Bvc3RzKTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmZpbmRCeVJvb21JZChURVNUX1JPT01fSURTLkFOWElFVFlfQ0hBVCwgVEVTVF9VU0VSX0lEUy5DTElFTlQpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChwb3N0c1NlcnZpY2UuZmluZEJ5Um9vbUlkKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChURVNUX1JPT01fSURTLkFOWElFVFlfQ0hBVCwgVEVTVF9VU0VSX0lEUy5DTElFTlQpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2NrUG9zdHMpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2VydmljZSBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcignRGF0YWJhc2UgZXJyb3InKTtcbiAgICAgIGplc3Quc3B5T24ocG9zdHNTZXJ2aWNlLCAnZmluZEJ5Um9vbUlkJykubW9ja1JlamVjdGVkVmFsdWUoZXJyb3IpO1xuXG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChjb250cm9sbGVyLmZpbmRCeVJvb21JZChURVNUX1JPT01fSURTLkFOWElFVFlfQ0hBVCwgVEVTVF9VU0VSX0lEUy5DTElFTlQpKS5yZWplY3RzLnRvVGhyb3coXG4gICAgICAgIEh0dHBFeGNlcHRpb24sXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnaGVhcnRQb3N0JywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGVhcnQgcG9zdCBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBoZWFydFJlc3VsdCA9IHsgaGVhcnRlZDogdHJ1ZSB9O1xuICAgICAgamVzdC5zcHlPbihwb3N0c1NlcnZpY2UsICdoZWFydFBvc3QnKS5tb2NrUmVzb2x2ZWRWYWx1ZShoZWFydFJlc3VsdCk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5oZWFydFBvc3QoVEVTVF9VU0VSX0lEUy5DTElFTlQsIFRFU1RfUE9TVF9JRFMuQU5YSUVUWV9QT1NUKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QocG9zdHNTZXJ2aWNlLmhlYXJ0UG9zdCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoVEVTVF9QT1NUX0lEUy5BTlhJRVRZX1BPU1QsIFRFU1RfVVNFUl9JRFMuQ0xJRU5UKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoaGVhcnRSZXN1bHQpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2VydmljZSBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcignUG9zdCBub3QgZm91bmQnKTtcbiAgICAgIGplc3Quc3B5T24ocG9zdHNTZXJ2aWNlLCAnaGVhcnRQb3N0JykubW9ja1JlamVjdGVkVmFsdWUoZXJyb3IpO1xuXG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChjb250cm9sbGVyLmhlYXJ0UG9zdChURVNUX1VTRVJfSURTLkNMSUVOVCwgVEVTVF9QT1NUX0lEUy5BTlhJRVRZX1BPU1QpKS5yZWplY3RzLnRvVGhyb3coXG4gICAgICAgIEh0dHBFeGNlcHRpb24sXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnaXNQb3N0SGVhcnRlZCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGNoZWNrIGlmIHBvc3QgaXMgaGVhcnRlZCBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBqZXN0LnNweU9uKHBvc3RzU2VydmljZSwgJ2lzUG9zdEhlYXJ0ZWRCeVVzZXInKS5tb2NrUmVzb2x2ZWRWYWx1ZSh0cnVlKTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmlzUG9zdEhlYXJ0ZWQoVEVTVF9VU0VSX0lEUy5DTElFTlQsIFRFU1RfUE9TVF9JRFMuQU5YSUVUWV9QT1NUKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QocG9zdHNTZXJ2aWNlLmlzUG9zdEhlYXJ0ZWRCeVVzZXIpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFRFU1RfUE9TVF9JRFMuQU5YSUVUWV9QT1NULCBURVNUX1VTRVJfSURTLkNMSUVOVCk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHsgaGVhcnRlZDogdHJ1ZSB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHNlcnZpY2UgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ0RhdGFiYXNlIGVycm9yJyk7XG4gICAgICBqZXN0LnNweU9uKHBvc3RzU2VydmljZSwgJ2lzUG9zdEhlYXJ0ZWRCeVVzZXInKS5tb2NrUmVqZWN0ZWRWYWx1ZShlcnJvcik7XG5cbiAgICAgIC8vIEFjdCAmIEFzc2VydFxuICAgICAgYXdhaXQgZXhwZWN0KGNvbnRyb2xsZXIuaXNQb3N0SGVhcnRlZChURVNUX1VTRVJfSURTLkNMSUVOVCwgVEVTVF9QT1NUX0lEUy5BTlhJRVRZX1BPU1QpKS5yZWplY3RzLnRvVGhyb3coXG4gICAgICAgIEh0dHBFeGNlcHRpb24sXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgncmVwb3J0UG9zdCcsICgpID0+IHtcbiAgICBjb25zdCByZXBvcnREYXRhID0ge1xuICAgICAgcmVhc29uOiAnc3BhbScsXG4gICAgICBjb250ZW50OiAnVGhpcyBwb3N0IGlzIHNwYW0nLFxuICAgIH07XG5cbiAgICBpdCgnc2hvdWxkIHJlcG9ydCBwb3N0IHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IHJlcG9ydElkID0gJ3JlcG9ydC0xMjMnO1xuICAgICAgamVzdC5zcHlPbihwb3N0c1NlcnZpY2UsICdyZXBvcnRQb3N0JykubW9ja1Jlc29sdmVkVmFsdWUocmVwb3J0SWQpO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIucmVwb3J0UG9zdChURVNUX1VTRVJfSURTLkNMSUVOVCwgVEVTVF9QT1NUX0lEUy5BTlhJRVRZX1BPU1QsIHJlcG9ydERhdGEpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChwb3N0c1NlcnZpY2UucmVwb3J0UG9zdCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIFRFU1RfUE9TVF9JRFMuQU5YSUVUWV9QT1NULFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgcmVwb3J0RGF0YS5yZWFzb24sXG4gICAgICAgIHJlcG9ydERhdGEuY29udGVudCxcbiAgICAgICk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHsgc3VjY2VzczogdHJ1ZSwgcmVwb3J0SWQgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzZXJ2aWNlIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCdQb3N0IG5vdCBmb3VuZCcpO1xuICAgICAgamVzdC5zcHlPbihwb3N0c1NlcnZpY2UsICdyZXBvcnRQb3N0JykubW9ja1JlamVjdGVkVmFsdWUoZXJyb3IpO1xuXG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5yZXBvcnRQb3N0KFRFU1RfVVNFUl9JRFMuQ0xJRU5ULCBURVNUX1BPU1RfSURTLkFOWElFVFlfUE9TVCwgcmVwb3J0RGF0YSksXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhIdHRwRXhjZXB0aW9uKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1NlY3VyaXR5IEludGVncmF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGF2ZSBwcm9wZXIgZ3VhcmRzIGFwcGxpZWQnLCAoKSA9PiB7XG4gICAgICAvLyBUZXN0IHRoYXQgZ3VhcmRzIGFyZSBhcHBsaWVkIGF0IGNvbnRyb2xsZXIgbGV2ZWxcbiAgICAgIGNvbnN0IGd1YXJkcyA9IFJlZmxlY3QuZ2V0TWV0YWRhdGEoJ19fZ3VhcmRzX18nLCBQb3N0c0NvbnRyb2xsZXIpO1xuICAgICAgZXhwZWN0KGd1YXJkcykudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChndWFyZHMpLnRvQ29udGFpbihKd3RBdXRoR3VhcmQpO1xuICAgICAgZXhwZWN0KGd1YXJkcykudG9Db250YWluKENvbW11bml0eUFjY2Vzc0d1YXJkKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYXBwbHkgUmVxdWlyZVBvc3RpbmdSb2xlIGRlY29yYXRvciB0byBjcmVhdGUgZW5kcG9pbnQnLCAoKSA9PiB7XG4gICAgICAvLyBUZXN0IHRoYXQgdGhlIGNyZWF0ZSBlbmRwb2ludCBoYXMgdGhlIFJlcXVpcmVQb3N0aW5nUm9sZSBkZWNvcmF0b3JcbiAgICAgIGNvbnN0IG1ldGFkYXRhID0gUmVmbGVjdC5nZXRNZXRhZGF0YSgncmVxdWlyZV9wb3N0aW5nX3JvbGUnLCBjb250cm9sbGVyLmNyZWF0ZSk7XG4gICAgICBleHBlY3QobWV0YWRhdGEpLnRvQmVUcnV0aHkoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYXBwbHkgUmVxdWlyZVJvb21BY2Nlc3MgZGVjb3JhdG9yIHRvIHByb3RlY3RlZCBlbmRwb2ludHMnLCAoKSA9PiB7XG4gICAgICAvLyBUZXN0IHRoYXQgcHJvdGVjdGVkIGVuZHBvaW50cyBoYXZlIHRoZSBSZXF1aXJlUm9vbUFjY2VzcyBkZWNvcmF0b3JcbiAgICAgIGNvbnN0IHByb3RlY3RlZE1ldGhvZHMgPSBbJ2ZpbmRPbmUnLCAndXBkYXRlJywgJ3JlbW92ZScsICdmaW5kQnlSb29tSWQnLCAnaGVhcnRQb3N0JywgJ3JlcG9ydFBvc3QnXTtcbiAgICAgIFxuICAgICAgcHJvdGVjdGVkTWV0aG9kcy5mb3JFYWNoKG1ldGhvZCA9PiB7XG4gICAgICAgIGNvbnN0IG1ldGFkYXRhID0gUmVmbGVjdC5nZXRNZXRhZGF0YSgncmVxdWlyZV9yb29tX2FjY2VzcycsIGNvbnRyb2xsZXJbbWV0aG9kIGFzIGtleW9mIFBvc3RzQ29udHJvbGxlcl0pO1xuICAgICAgICBleHBlY3QobWV0YWRhdGEpLnRvQmVUcnV0aHkoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0ZXN0IGNvbW11bml0eSBhY2Nlc3MgZ3VhcmQgaW50ZWdyYXRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCB0ZXN0U2NlbmFyaW9zID0gU2VjdXJpdHlHdWFyZFRlc3RVdGlscy5jcmVhdGVBY2Nlc3NDb250cm9sVGVzdFNjZW5hcmlvcygpO1xuICAgICAgXG4gICAgICAvLyBUZXN0IHRoYXQgQ29tbXVuaXR5QWNjZXNzR3VhcmQgaXMgY2FsbGVkIGZvciBwcm90ZWN0ZWQgZW5kcG9pbnRzXG4gICAgICBtb2NrQ29tbXVuaXR5QWNjZXNzR3VhcmQuY2FuQWN0aXZhdGUubW9ja1JldHVyblZhbHVlKHRydWUpO1xuICAgICAgamVzdC5zcHlPbihwb3N0c1NlcnZpY2UsICdmaW5kT25lJykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1Bvc3QpO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGF3YWl0IGNvbnRyb2xsZXIuZmluZE9uZShURVNUX1BPU1RfSURTLkFOWElFVFlfUE9TVCwgVEVTVF9VU0VSX0lEUy5DTElFTlQpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChtb2NrQ29tbXVuaXR5QWNjZXNzR3VhcmQuY2FuQWN0aXZhdGUpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbW11bml0eSBhY2Nlc3MgZGVuaWVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgbW9ja0NvbW11bml0eUFjY2Vzc0d1YXJkLmNhbkFjdGl2YXRlLm1vY2tSZXR1cm5WYWx1ZShmYWxzZSk7XG5cbiAgICAgIC8vIFRoaXMgd291bGQgYmUgaGFuZGxlZCBieSB0aGUgZ3VhcmQgYmVmb3JlIHJlYWNoaW5nIHRoZSBjb250cm9sbGVyXG4gICAgICAvLyBJbiBhIHJlYWwgc2NlbmFyaW8sIHRoZSBndWFyZCB3b3VsZCB0aHJvdyBhbiBleGNlcHRpb25cbiAgICAgIGV4cGVjdChtb2NrQ29tbXVuaXR5QWNjZXNzR3VhcmQuY2FuQWN0aXZhdGUpLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdFcnJvciBIYW5kbGluZycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBIdHRwRXhjZXB0aW9uIHByb3Blcmx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgaHR0cEV4Y2VwdGlvbiA9IG5ldyBIdHRwRXhjZXB0aW9uKCdDdXN0b20gZXJyb3InLCBIdHRwU3RhdHVzLkJBRF9SRVFVRVNUKTtcbiAgICAgIGplc3Quc3B5T24ocG9zdHNTZXJ2aWNlLCAnZmluZE9uZScpLm1vY2tSZWplY3RlZFZhbHVlKGh0dHBFeGNlcHRpb24pO1xuXG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChjb250cm9sbGVyLmZpbmRPbmUoVEVTVF9QT1NUX0lEUy5BTlhJRVRZX1BPU1QsIFRFU1RfVVNFUl9JRFMuQ0xJRU5UKSkucmVqZWN0cy50b1Rocm93KGh0dHBFeGNlcHRpb24pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB3cmFwIHVua25vd24gZXJyb3JzIGluIEh0dHBFeGNlcHRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCB1bmtub3duRXJyb3IgPSBuZXcgRXJyb3IoJ1Vua25vd24gZXJyb3InKTtcbiAgICAgIGplc3Quc3B5T24ocG9zdHNTZXJ2aWNlLCAnZmluZEFsbCcpLm1vY2tSZWplY3RlZFZhbHVlKHVua25vd25FcnJvcik7XG5cbiAgICAgIC8vIEFjdCAmIEFzc2VydFxuICAgICAgYXdhaXQgZXhwZWN0KGNvbnRyb2xsZXIuZmluZEFsbChURVNUX1VTRVJfSURTLkNMSUVOVCkpLnJlamVjdHMudG9UaHJvdyhIdHRwRXhjZXB0aW9uKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0ZpbGUgVXBsb2FkIEludGVncmF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIG11bHRpcGxlIGZpbGUgdXBsb2FkcycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IG11bHRpcGxlRmlsZXMgPSBbXG4gICAgICAgIHsgLi4ubW9ja0ZpbGVzWzBdLCBvcmlnaW5hbG5hbWU6ICd0ZXN0MS5qcGcnIH0sXG4gICAgICAgIHsgLi4ubW9ja0ZpbGVzWzBdLCBvcmlnaW5hbG5hbWU6ICd0ZXN0Mi5qcGcnIH0sXG4gICAgICBdO1xuICAgICAgY29uc3QgbXVsdGlwbGVGaWxlUmVzdWx0cyA9IFtcbiAgICAgICAgeyB1cmw6ICdodHRwczovL2V4YW1wbGUuY29tL3Rlc3QxLmpwZycsIGZpbGVuYW1lOiAndGVzdDEuanBnJywgc2l6ZTogMTAyNCB9LFxuICAgICAgICB7IHVybDogJ2h0dHBzOi8vZXhhbXBsZS5jb20vdGVzdDIuanBnJywgZmlsZW5hbWU6ICd0ZXN0Mi5qcGcnLCBzaXplOiAxMDI0IH0sXG4gICAgICBdO1xuXG4gICAgICBqZXN0LnNweU9uKHBvc3RzU2VydmljZSwgJ2ZpbmRVc2VyQnlJZCcpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVc2VyKTtcbiAgICAgIGplc3Quc3B5T24ocG9zdHNTZXJ2aWNlLCAnY3JlYXRlJykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1Bvc3QpO1xuICAgICAgamVzdC5zcHlPbihzdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlLCAndmFsaWRhdGVGaWxlJykubW9ja1JldHVyblZhbHVlKHsgaXNWYWxpZDogdHJ1ZSB9KTtcbiAgICAgIGplc3Quc3B5T24oc3VwYWJhc2VTdG9yYWdlU2VydmljZSwgJ3VwbG9hZEZpbGVzJykubW9ja1Jlc29sdmVkVmFsdWUobXVsdGlwbGVGaWxlUmVzdWx0cyk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5jcmVhdGUoVEVTVF9VU0VSX0lEUy5DTElFTlQsIG1vY2tDcmVhdGVQb3N0RHRvLCBtdWx0aXBsZUZpbGVzKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3Qoc3VwYWJhc2VTdG9yYWdlU2VydmljZS52YWxpZGF0ZUZpbGUpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygyKTtcbiAgICAgIGV4cGVjdChzdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlLnVwbG9hZEZpbGVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChtdWx0aXBsZUZpbGVzLCAncG9zdC1hdHRhY2htZW50cycpO1xuICAgICAgZXhwZWN0KHBvc3RzU2VydmljZS5jcmVhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgdGl0bGU6IG1vY2tDcmVhdGVQb3N0RHRvLnRpdGxlLFxuICAgICAgICBjb250ZW50OiBtb2NrQ3JlYXRlUG9zdER0by5jb250ZW50LFxuICAgICAgICB1c2VyOiB7IGNvbm5lY3Q6IHsgaWQ6IG1vY2tVc2VyLmlkIH0gfSxcbiAgICAgICAgcm9vbTogeyBjb25uZWN0OiB7IGlkOiBtb2NrQ3JlYXRlUG9zdER0by5yb29tSWQgfSB9LFxuICAgICAgICBhdHRhY2htZW50VXJsczogWydodHRwczovL2V4YW1wbGUuY29tL3Rlc3QxLmpwZycsICdodHRwczovL2V4YW1wbGUuY29tL3Rlc3QyLmpwZyddLFxuICAgICAgICBhdHRhY2htZW50TmFtZXM6IFsndGVzdDEuanBnJywgJ3Rlc3QyLmpwZyddLFxuICAgICAgICBhdHRhY2htZW50U2l6ZXM6IFsxMDI0LCAxMDI0XSxcbiAgICAgIH0pO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2NrUG9zdCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBmaWxlIHVwbG9hZCBzZXJ2aWNlIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGplc3Quc3B5T24ocG9zdHNTZXJ2aWNlLCAnZmluZFVzZXJCeUlkJykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXIpO1xuICAgICAgamVzdC5zcHlPbihzdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlLCAndmFsaWRhdGVGaWxlJykubW9ja1JldHVyblZhbHVlKHsgaXNWYWxpZDogdHJ1ZSB9KTtcbiAgICAgIGplc3Quc3B5T24oc3VwYWJhc2VTdG9yYWdlU2VydmljZSwgJ3VwbG9hZEZpbGVzJykubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdVcGxvYWQgZmFpbGVkJykpO1xuXG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChjb250cm9sbGVyLmNyZWF0ZShURVNUX1VTRVJfSURTLkNMSUVOVCwgbW9ja0NyZWF0ZVBvc3REdG8sIG1vY2tGaWxlcykpLnJlamVjdHMudG9UaHJvdyhcbiAgICAgICAgSHR0cEV4Y2VwdGlvbixcbiAgICAgICk7XG4gICAgfSk7XG4gIH0pO1xufSk7Il0sInZlcnNpb24iOjN9