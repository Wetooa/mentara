27f81bde704ada0555b014eaeb191063
"use strict";
/**
 * Comprehensive Test Suite for TherapistRequestController
 * Tests all therapist request management endpoints with security, validation, and error handling
 */
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const common_1 = require("@nestjs/common");
const jwt_auth_guard_1 = require("../../auth/guards/jwt-auth.guard");
const therapist_request_controller_1 = require("./therapist-request.controller");
const therapist_request_service_1 = require("../services/therapist-request.service");
const enhanced_test_helpers_1 = require("../../test-utils/enhanced-test-helpers");
const index_1 = require("../../test-utils/index");
describe('TherapistRequestController', () => {
    let controller;
    let therapistRequestService;
    let module;
    // Mock TherapistRequestService
    const mockTherapistRequestService = {
        getTherapistRequests: jest.fn(),
        acceptClientRequest: jest.fn(),
        declineClientRequest: jest.fn(),
        performBulkAction: jest.fn(),
        getTherapistRequestStatistics: jest.fn(),
    };
    // Mock JwtAuthGuard
    const mockJwtAuthGuard = {
        canActivate: jest.fn().mockReturnValue(true),
    };
    // Test IDs
    const validRequestId = '87654321-4321-4321-4321-210987654321'; // 36 chars UUID format
    const validClientId = '12345678-1234-1234-1234-123456789012'; // 36 chars UUID format
    // Test data
    const mockRequest = {
        id: validRequestId,
        clientId: validClientId,
        therapistId: index_1.TEST_USER_IDS.THERAPIST,
        status: 'PENDING',
        priority: 'NORMAL',
        message: 'I would like to schedule a session',
        requestedAt: new Date(),
        respondedAt: null,
        expiresAt: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000), // 7 days from now
        createdAt: new Date(),
        updatedAt: new Date(),
        client: {
            id: validClientId,
            firstName: 'John',
            lastName: 'Doe',
            email: 'john@example.com',
        },
    };
    const mockPaginatedRequests = {
        requests: [mockRequest],
        pagination: {
            page: 1,
            limit: 10,
            totalCount: 1,
            totalPages: 1,
            hasNext: false,
            hasPrev: false,
        },
        summary: {
            totalRequests: 1,
            pendingRequests: 1,
            acceptedRequests: 0,
            declinedRequests: 0,
            expiredRequests: 0,
        },
    };
    const mockStatistics = {
        totalReceived: 10,
        pending: 3,
        accepted: 5,
        declined: 2,
        expired: 0,
        cancelled: 0,
        withdrawn: 0,
        averageResponseTime: 4.5,
        acceptanceRate: 71.4,
    };
    beforeEach(async () => {
        module = await testing_1.Test.createTestingModule({
            controllers: [therapist_request_controller_1.TherapistRequestController],
            providers: [
                {
                    provide: therapist_request_service_1.TherapistRequestService,
                    useValue: mockTherapistRequestService,
                },
            ],
        })
            .overrideGuard(jwt_auth_guard_1.JwtAuthGuard)
            .useValue(mockJwtAuthGuard)
            .compile();
        controller = module.get(therapist_request_controller_1.TherapistRequestController);
        therapistRequestService = module.get(therapist_request_service_1.TherapistRequestService);
    });
    afterEach(() => {
        jest.clearAllMocks();
    });
    describe('Controller Initialization', () => {
        it('should be defined', () => {
            expect(controller).toBeDefined();
        });
        it('should have therapistRequestService injected', () => {
            expect(therapistRequestService).toBeDefined();
        });
    });
    describe('Security Guards', () => {
        it('should be protected by JwtAuthGuard', () => {
            const guards = Reflect.getMetadata('__guards__', therapist_request_controller_1.TherapistRequestController);
            expect(guards).toContain(jwt_auth_guard_1.JwtAuthGuard);
        });
        it('should have proper route decorators', () => {
            const controllerMetadata = Reflect.getMetadata('path', therapist_request_controller_1.TherapistRequestController);
            expect(controllerMetadata).toBe('therapist/requests');
        });
    });
    describe('GET /therapist/requests', () => {
        const filters = {
            page: 1,
            limit: 10,
            sortBy: 'requestedAt',
            sortOrder: 'desc',
            status: 'PENDING',
        };
        it('should get client requests with filters', async () => {
            mockTherapistRequestService.getTherapistRequests.mockResolvedValue(mockPaginatedRequests);
            const result = await controller.getClientRequests(filters, index_1.TEST_USER_IDS.THERAPIST);
            expect(result).toEqual(mockPaginatedRequests);
            expect(therapistRequestService.getTherapistRequests).toHaveBeenCalledWith(index_1.TEST_USER_IDS.THERAPIST, filters);
        });
        it('should handle empty filters', async () => {
            const emptyFilters = {};
            mockTherapistRequestService.getTherapistRequests.mockResolvedValue(mockPaginatedRequests);
            const result = await controller.getClientRequests(emptyFilters, index_1.TEST_USER_IDS.THERAPIST);
            expect(result).toEqual(mockPaginatedRequests);
            expect(therapistRequestService.getTherapistRequests).toHaveBeenCalledWith(index_1.TEST_USER_IDS.THERAPIST, emptyFilters);
        });
        it('should handle service errors', async () => {
            const serviceError = new Error('Database connection failed');
            mockTherapistRequestService.getTherapistRequests.mockRejectedValue(serviceError);
            await expect(controller.getClientRequests(filters, index_1.TEST_USER_IDS.THERAPIST)).rejects.toThrow(serviceError);
        });
    });
    describe('GET /therapist/requests/pending', () => {
        it('should get pending requests successfully', async () => {
            mockTherapistRequestService.getTherapistRequests.mockResolvedValue(mockPaginatedRequests);
            const result = await controller.getPendingRequests(index_1.TEST_USER_IDS.THERAPIST);
            expect(result).toEqual({
                success: true,
                pendingRequests: [mockRequest],
                totalPending: 1,
                summary: mockPaginatedRequests.summary,
            });
            expect(therapistRequestService.getTherapistRequests).toHaveBeenCalledWith(index_1.TEST_USER_IDS.THERAPIST, {
                status: 'PENDING',
                page: 1,
                limit: 50,
                sortBy: 'requestedAt',
                sortOrder: 'asc',
                includeExpired: false,
            });
        });
        it('should handle no pending requests', async () => {
            const emptyResult = {
                ...mockPaginatedRequests,
                requests: [],
                pagination: { ...mockPaginatedRequests.pagination, totalCount: 0 },
            };
            mockTherapistRequestService.getTherapistRequests.mockResolvedValue(emptyResult);
            const result = await controller.getPendingRequests(index_1.TEST_USER_IDS.THERAPIST);
            expect(result.pendingRequests).toEqual([]);
            expect(result.totalPending).toBe(0);
        });
        it('should handle service errors', async () => {
            const serviceError = new Error('Database query failed');
            mockTherapistRequestService.getTherapistRequests.mockRejectedValue(serviceError);
            await expect(controller.getPendingRequests(index_1.TEST_USER_IDS.THERAPIST)).rejects.toThrow(serviceError);
        });
    });
    describe('GET /therapist/requests/priority', () => {
        it('should get high priority requests successfully', async () => {
            const highPriorityResult = {
                ...mockPaginatedRequests,
                requests: [{ ...mockRequest, priority: 'HIGH' }],
            };
            const urgentResult = {
                ...mockPaginatedRequests,
                requests: [{ ...mockRequest, priority: 'URGENT' }],
            };
            mockTherapistRequestService.getTherapistRequests
                .mockResolvedValueOnce(highPriorityResult)
                .mockResolvedValueOnce(urgentResult);
            const result = await controller.getHighPriorityRequests(index_1.TEST_USER_IDS.THERAPIST);
            expect(result).toEqual({
                success: true,
                highPriorityRequests: [{ ...mockRequest, priority: 'HIGH' }],
                urgentRequests: [{ ...mockRequest, priority: 'URGENT' }],
                totalHighPriority: 1,
                totalUrgent: 1,
            });
            expect(therapistRequestService.getTherapistRequests).toHaveBeenCalledTimes(2);
        });
        it('should handle no high priority requests', async () => {
            const emptyResult = {
                ...mockPaginatedRequests,
                requests: [],
                pagination: { ...mockPaginatedRequests.pagination, totalCount: 0 },
            };
            mockTherapistRequestService.getTherapistRequests
                .mockResolvedValueOnce(emptyResult)
                .mockResolvedValueOnce(emptyResult);
            const result = await controller.getHighPriorityRequests(index_1.TEST_USER_IDS.THERAPIST);
            expect(result.highPriorityRequests).toEqual([]);
            expect(result.urgentRequests).toEqual([]);
            expect(result.totalHighPriority).toBe(0);
            expect(result.totalUrgent).toBe(0);
        });
        it('should handle service errors', async () => {
            const serviceError = new Error('Database query failed');
            mockTherapistRequestService.getTherapistRequests.mockRejectedValue(serviceError);
            await expect(controller.getHighPriorityRequests(index_1.TEST_USER_IDS.THERAPIST)).rejects.toThrow(serviceError);
        });
    });
    describe('GET /therapist/requests/:id', () => {
        it('should get request details successfully', async () => {
            mockTherapistRequestService.getTherapistRequests.mockResolvedValue(mockPaginatedRequests);
            const result = await controller.getRequestDetails(validRequestId, index_1.TEST_USER_IDS.THERAPIST);
            expect(result).toEqual({
                success: true,
                request: mockRequest,
            });
            expect(therapistRequestService.getTherapistRequests).toHaveBeenCalledWith(index_1.TEST_USER_IDS.THERAPIST, {
                page: 1,
                limit: 1,
                sortBy: 'requestedAt',
                sortOrder: 'desc',
                includeExpired: false,
            });
        });
        it('should validate request ID format', async () => {
            const invalidRequestId = 'invalid-id';
            await enhanced_test_helpers_1.TestAssertions.expectToThrowNestException(() => controller.getRequestDetails(invalidRequestId, index_1.TEST_USER_IDS.THERAPIST), common_1.BadRequestException, 'Invalid request ID format');
        });
        it('should handle request not found', async () => {
            mockTherapistRequestService.getTherapistRequests.mockResolvedValue({
                requests: [],
                pagination: { page: 1, limit: 1, totalCount: 0, totalPages: 0, hasNext: false, hasPrev: false },
            });
            await enhanced_test_helpers_1.TestAssertions.expectToThrowNestException(() => controller.getRequestDetails(validRequestId, index_1.TEST_USER_IDS.THERAPIST), common_1.NotFoundException, 'Request with ID 87654321-4321-4321-4321-210987654321 not found or not accessible');
        });
        it('should handle empty request ID', async () => {
            await enhanced_test_helpers_1.TestAssertions.expectToThrowNestException(() => controller.getRequestDetails('', index_1.TEST_USER_IDS.THERAPIST), common_1.BadRequestException, 'Invalid request ID format');
        });
    });
    describe('PUT /therapist/requests/:id/accept', () => {
        const responseDto = {
            message: 'I would be happy to work with you',
            availableSlots: ['2024-01-15T10:00:00Z', '2024-01-16T14:00:00Z'],
        };
        it('should accept request successfully', async () => {
            const acceptResult = {
                success: true,
                message: 'Request accepted successfully',
                request: { ...mockRequest, status: 'ACCEPTED' },
            };
            mockTherapistRequestService.acceptClientRequest.mockResolvedValue(acceptResult);
            const result = await controller.acceptRequest(validRequestId, responseDto, index_1.TEST_USER_IDS.THERAPIST);
            expect(result).toEqual(acceptResult);
            expect(therapistRequestService.acceptClientRequest).toHaveBeenCalledWith(validRequestId, index_1.TEST_USER_IDS.THERAPIST, responseDto);
        });
        it('should validate request ID format', async () => {
            const invalidRequestId = 'invalid-id';
            await enhanced_test_helpers_1.TestAssertions.expectToThrowNestException(() => controller.acceptRequest(invalidRequestId, responseDto, index_1.TEST_USER_IDS.THERAPIST), common_1.BadRequestException, 'Invalid request ID format');
        });
        it('should handle service errors', async () => {
            const serviceError = new Error('Request cannot be accepted');
            mockTherapistRequestService.acceptClientRequest.mockRejectedValue(serviceError);
            await expect(controller.acceptRequest(validRequestId, responseDto, index_1.TEST_USER_IDS.THERAPIST)).rejects.toThrow(serviceError);
        });
    });
    describe('PUT /therapist/requests/:id/decline', () => {
        const responseDto = {
            message: 'Unfortunately, I am not available at this time',
            reason: 'AVAILABILITY_CONFLICT',
        };
        it('should decline request successfully', async () => {
            const declineResult = {
                success: true,
                message: 'Request declined successfully',
                request: { ...mockRequest, status: 'DECLINED' },
            };
            mockTherapistRequestService.declineClientRequest.mockResolvedValue(declineResult);
            const result = await controller.declineRequest(validRequestId, responseDto, index_1.TEST_USER_IDS.THERAPIST);
            expect(result).toEqual(declineResult);
            expect(therapistRequestService.declineClientRequest).toHaveBeenCalledWith(validRequestId, index_1.TEST_USER_IDS.THERAPIST, responseDto);
        });
        it('should validate request ID format', async () => {
            const invalidRequestId = 'invalid-id';
            await enhanced_test_helpers_1.TestAssertions.expectToThrowNestException(() => controller.declineRequest(invalidRequestId, responseDto, index_1.TEST_USER_IDS.THERAPIST), common_1.BadRequestException, 'Invalid request ID format');
        });
        it('should handle service errors', async () => {
            const serviceError = new Error('Request cannot be declined');
            mockTherapistRequestService.declineClientRequest.mockRejectedValue(serviceError);
            await expect(controller.declineRequest(validRequestId, responseDto, index_1.TEST_USER_IDS.THERAPIST)).rejects.toThrow(serviceError);
        });
    });
    describe('POST /therapist/requests/bulk-action', () => {
        const bulkActionDto = {
            action: 'accept',
            requestIds: [validRequestId, '11111111-2222-3333-4444-555555555555'],
            message: 'Bulk acceptance message',
        };
        it('should perform bulk action successfully', async () => {
            const bulkResult = {
                success: true,
                processedCount: 2,
                failedCount: 0,
                results: [
                    { requestId: validRequestId, status: 'ACCEPTED' },
                    { requestId: '11111111-2222-3333-4444-555555555555', status: 'ACCEPTED' },
                ],
            };
            mockTherapistRequestService.performBulkAction.mockResolvedValue(bulkResult);
            const result = await controller.performBulkAction(bulkActionDto, index_1.TEST_USER_IDS.THERAPIST);
            expect(result).toEqual(bulkResult);
            expect(therapistRequestService.performBulkAction).toHaveBeenCalledWith(index_1.TEST_USER_IDS.THERAPIST, bulkActionDto);
        });
        it('should handle service errors', async () => {
            const serviceError = new Error('Bulk action failed');
            mockTherapistRequestService.performBulkAction.mockRejectedValue(serviceError);
            await expect(controller.performBulkAction(bulkActionDto, index_1.TEST_USER_IDS.THERAPIST)).rejects.toThrow(serviceError);
        });
    });
    describe('GET /therapist/requests/statistics', () => {
        it('should get request statistics successfully', async () => {
            mockTherapistRequestService.getTherapistRequestStatistics.mockResolvedValue(mockStatistics);
            const result = await controller.getRequestStatistics(index_1.TEST_USER_IDS.THERAPIST);
            expect(result).toEqual(mockStatistics);
            expect(therapistRequestService.getTherapistRequestStatistics).toHaveBeenCalledWith(index_1.TEST_USER_IDS.THERAPIST);
        });
        it('should handle service errors', async () => {
            const serviceError = new Error('Statistics calculation failed');
            mockTherapistRequestService.getTherapistRequestStatistics.mockRejectedValue(serviceError);
            await expect(controller.getRequestStatistics(index_1.TEST_USER_IDS.THERAPIST)).rejects.toThrow(serviceError);
        });
    });
    describe('GET /therapist/requests/recent', () => {
        it('should get recent requests successfully', async () => {
            mockTherapistRequestService.getTherapistRequests.mockResolvedValue(mockPaginatedRequests);
            const result = await controller.getRecentRequests(index_1.TEST_USER_IDS.THERAPIST);
            expect(result).toEqual({
                success: true,
                recentRequests: [mockRequest],
                hasMore: false,
                summary: mockPaginatedRequests.summary,
            });
            expect(therapistRequestService.getTherapistRequests).toHaveBeenCalledWith(index_1.TEST_USER_IDS.THERAPIST, {
                page: 1,
                limit: 10,
                sortBy: 'requestedAt',
                sortOrder: 'desc',
                includeExpired: false,
            });
        });
        it('should indicate when there are more requests', async () => {
            const moreRequestsResult = {
                ...mockPaginatedRequests,
                pagination: { ...mockPaginatedRequests.pagination, totalCount: 20 },
            };
            mockTherapistRequestService.getTherapistRequests.mockResolvedValue(moreRequestsResult);
            const result = await controller.getRecentRequests(index_1.TEST_USER_IDS.THERAPIST);
            expect(result.hasMore).toBe(true);
        });
        it('should handle service errors', async () => {
            const serviceError = new Error('Database query failed');
            mockTherapistRequestService.getTherapistRequests.mockRejectedValue(serviceError);
            await expect(controller.getRecentRequests(index_1.TEST_USER_IDS.THERAPIST)).rejects.toThrow(serviceError);
        });
    });
    describe('GET /therapist/requests/dashboard/summary', () => {
        it('should get dashboard summary successfully', async () => {
            mockTherapistRequestService.getTherapistRequestStatistics.mockResolvedValue(mockStatistics);
            mockTherapistRequestService.getTherapistRequests
                .mockResolvedValueOnce(mockPaginatedRequests) // pending requests
                .mockResolvedValueOnce(mockPaginatedRequests); // high priority requests
            const result = await controller.getDashboardSummary(index_1.TEST_USER_IDS.THERAPIST);
            expect(result).toEqual({
                success: true,
                statistics: mockStatistics,
                recentPendingRequests: [mockRequest],
                highPriorityRequests: [mockRequest],
                actionRequired: true,
                hasUrgentRequests: false,
            });
            expect(therapistRequestService.getTherapistRequestStatistics).toHaveBeenCalledWith(index_1.TEST_USER_IDS.THERAPIST);
            expect(therapistRequestService.getTherapistRequests).toHaveBeenCalledTimes(2);
        });
        it('should handle no pending requests', async () => {
            const emptyResult = {
                ...mockPaginatedRequests,
                requests: [],
                pagination: { ...mockPaginatedRequests.pagination, totalCount: 0 },
            };
            mockTherapistRequestService.getTherapistRequestStatistics.mockResolvedValue(mockStatistics);
            mockTherapistRequestService.getTherapistRequests
                .mockResolvedValueOnce(emptyResult)
                .mockResolvedValueOnce(emptyResult);
            const result = await controller.getDashboardSummary(index_1.TEST_USER_IDS.THERAPIST);
            expect(result.actionRequired).toBe(false);
            expect(result.hasUrgentRequests).toBe(false);
        });
        it('should detect urgent requests', async () => {
            const urgentRequest = { ...mockRequest, priority: 'URGENT' };
            const urgentResult = {
                ...mockPaginatedRequests,
                requests: [urgentRequest],
            };
            mockTherapistRequestService.getTherapistRequestStatistics.mockResolvedValue(mockStatistics);
            mockTherapistRequestService.getTherapistRequests
                .mockResolvedValueOnce(mockPaginatedRequests)
                .mockResolvedValueOnce(urgentResult);
            const result = await controller.getDashboardSummary(index_1.TEST_USER_IDS.THERAPIST);
            expect(result.hasUrgentRequests).toBe(true);
        });
        it('should handle service errors', async () => {
            const serviceError = new Error('Dashboard query failed');
            mockTherapistRequestService.getTherapistRequestStatistics.mockRejectedValue(serviceError);
            await expect(controller.getDashboardSummary(index_1.TEST_USER_IDS.THERAPIST)).rejects.toThrow(serviceError);
        });
    });
    describe('GET /therapist/requests/client/:clientId/history', () => {
        it('should get client request history successfully', async () => {
            const historyResult = {
                ...mockPaginatedRequests,
                requests: [mockRequest, { ...mockRequest, status: 'ACCEPTED' }],
                pagination: { ...mockPaginatedRequests.pagination, totalCount: 2 },
            };
            mockTherapistRequestService.getTherapistRequests.mockResolvedValue(historyResult);
            const result = await controller.getClientRequestHistory(validClientId, index_1.TEST_USER_IDS.THERAPIST);
            expect(result).toEqual({
                success: true,
                clientId: validClientId,
                requestHistory: [mockRequest, { ...mockRequest, status: 'ACCEPTED' }],
                totalRequests: 2,
                hasActiveRelationship: true,
            });
            expect(therapistRequestService.getTherapistRequests).toHaveBeenCalledWith(index_1.TEST_USER_IDS.THERAPIST, {
                clientId: validClientId,
                page: 1,
                limit: 50,
                sortBy: 'requestedAt',
                sortOrder: 'desc',
                includeExpired: true,
            });
        });
        it('should validate client ID format', async () => {
            const invalidClientId = 'invalid-id';
            await enhanced_test_helpers_1.TestAssertions.expectToThrowNestException(() => controller.getClientRequestHistory(invalidClientId, index_1.TEST_USER_IDS.THERAPIST), common_1.BadRequestException, 'Invalid client ID format');
        });
        it('should handle no request history', async () => {
            const emptyResult = {
                ...mockPaginatedRequests,
                requests: [],
                pagination: { ...mockPaginatedRequests.pagination, totalCount: 0 },
            };
            mockTherapistRequestService.getTherapistRequests.mockResolvedValue(emptyResult);
            const result = await controller.getClientRequestHistory(validClientId, index_1.TEST_USER_IDS.THERAPIST);
            expect(result.requestHistory).toEqual([]);
            expect(result.totalRequests).toBe(0);
            expect(result.hasActiveRelationship).toBe(false);
        });
        it('should handle service errors', async () => {
            const serviceError = new Error('History query failed');
            mockTherapistRequestService.getTherapistRequests.mockRejectedValue(serviceError);
            await expect(controller.getClientRequestHistory(validClientId, index_1.TEST_USER_IDS.THERAPIST)).rejects.toThrow(serviceError);
        });
    });
    describe('GET /therapist/requests/filters/options', () => {
        it('should get filter options successfully', async () => {
            const result = await controller.getFilterOptions(index_1.TEST_USER_IDS.THERAPIST);
            expect(result).toEqual({
                success: true,
                filterOptions: {
                    statuses: ['PENDING', 'ACCEPTED', 'DECLINED', 'EXPIRED', 'CANCELLED', 'WITHDRAWN'],
                    priorities: ['LOW', 'NORMAL', 'HIGH', 'URGENT'],
                    sortOptions: [
                        { value: 'requestedAt', label: 'Request Date' },
                        { value: 'respondedAt', label: 'Response Date' },
                        { value: 'priority', label: 'Priority' },
                        { value: 'status', label: 'Status' },
                    ],
                    sortOrders: [
                        { value: 'desc', label: 'Newest First' },
                        { value: 'asc', label: 'Oldest First' },
                    ],
                    bulkActions: [
                        { value: 'accept', label: 'Accept Selected' },
                        { value: 'decline', label: 'Decline Selected' },
                        { value: 'mark_reviewed', label: 'Mark as Reviewed' },
                    ],
                },
            });
        });
        it('should return consistent filter options', async () => {
            const result1 = await controller.getFilterOptions(index_1.TEST_USER_IDS.THERAPIST);
            const result2 = await controller.getFilterOptions('another-therapist-id');
            expect(result1).toEqual(result2);
        });
    });
    describe('GET /therapist/requests/count/pending', () => {
        it('should get pending count successfully', async () => {
            mockTherapistRequestService.getTherapistRequestStatistics.mockResolvedValue(mockStatistics);
            const result = await controller.getPendingCount(index_1.TEST_USER_IDS.THERAPIST);
            expect(result).toEqual({
                success: true,
                pendingCount: 3,
                totalReceived: 10,
                needsAttention: true,
            });
            expect(therapistRequestService.getTherapistRequestStatistics).toHaveBeenCalledWith(index_1.TEST_USER_IDS.THERAPIST);
        });
        it('should handle no pending requests', async () => {
            const noPendingStats = { ...mockStatistics, pending: 0 };
            mockTherapistRequestService.getTherapistRequestStatistics.mockResolvedValue(noPendingStats);
            const result = await controller.getPendingCount(index_1.TEST_USER_IDS.THERAPIST);
            expect(result.pendingCount).toBe(0);
            expect(result.needsAttention).toBe(false);
        });
        it('should handle service errors', async () => {
            const serviceError = new Error('Statistics calculation failed');
            mockTherapistRequestService.getTherapistRequestStatistics.mockRejectedValue(serviceError);
            await expect(controller.getPendingCount(index_1.TEST_USER_IDS.THERAPIST)).rejects.toThrow(serviceError);
        });
    });
    describe('GET /therapist/requests/analytics/response-time', () => {
        it('should get response time analytics successfully', async () => {
            mockTherapistRequestService.getTherapistRequestStatistics.mockResolvedValue(mockStatistics);
            const result = await controller.getResponseTimeAnalytics(index_1.TEST_USER_IDS.THERAPIST);
            expect(result).toEqual({
                success: true,
                responseTimeAnalytics: {
                    averageHours: 4.5,
                    performance: 'good',
                    acceptanceRate: 71.4,
                    totalResponded: 7,
                },
                recommendations: [
                    "You're doing great with both response time and acceptance rate!",
                ],
            });
            expect(therapistRequestService.getTherapistRequestStatistics).toHaveBeenCalledWith(index_1.TEST_USER_IDS.THERAPIST);
        });
        it('should categorize response time as excellent', async () => {
            const excellentStats = { ...mockStatistics, averageResponseTime: 1.5 };
            mockTherapistRequestService.getTherapistRequestStatistics.mockResolvedValue(excellentStats);
            const result = await controller.getResponseTimeAnalytics(index_1.TEST_USER_IDS.THERAPIST);
            expect(result.responseTimeAnalytics.performance).toBe('excellent');
        });
        it('should categorize response time as needs improvement', async () => {
            const poorStats = { ...mockStatistics, averageResponseTime: 48, acceptanceRate: 20 };
            mockTherapistRequestService.getTherapistRequestStatistics.mockResolvedValue(poorStats);
            const result = await controller.getResponseTimeAnalytics(index_1.TEST_USER_IDS.THERAPIST);
            expect(result.responseTimeAnalytics.performance).toBe('needs_improvement');
            expect(result.recommendations).toContain('Consider responding to client requests within 24 hours for better client experience');
            expect(result.recommendations).toContain('Your acceptance rate is low. Consider reviewing your availability and client preferences');
        });
        it('should handle service errors', async () => {
            const serviceError = new Error('Analytics calculation failed');
            mockTherapistRequestService.getTherapistRequestStatistics.mockRejectedValue(serviceError);
            await expect(controller.getResponseTimeAnalytics(index_1.TEST_USER_IDS.THERAPIST)).rejects.toThrow(serviceError);
        });
    });
    describe('Helper Methods', () => {
        it('should categorize response time correctly', () => {
            expect(controller.categorizeResponseTime(1)).toBe('excellent');
            expect(controller.categorizeResponseTime(4)).toBe('good');
            expect(controller.categorizeResponseTime(12)).toBe('fair');
            expect(controller.categorizeResponseTime(48)).toBe('needs_improvement');
        });
        it('should generate appropriate recommendations', () => {
            const recommendations1 = controller.getResponseTimeRecommendations(2, 85);
            expect(recommendations1).toContain("Excellent acceptance rate! You're providing great accessibility to clients");
            expect(recommendations1).toContain("You're doing great with both response time and acceptance rate!");
            const recommendations2 = controller.getResponseTimeRecommendations(48, 20);
            expect(recommendations2).toContain('Consider responding to client requests within 24 hours for better client experience');
            expect(recommendations2).toContain('Your acceptance rate is low. Consider reviewing your availability and client preferences');
        });
    });
    describe('Integration Testing', () => {
        it('should handle complete request management workflow', async () => {
            // Step 1: Get pending requests
            mockTherapistRequestService.getTherapistRequests.mockResolvedValue(mockPaginatedRequests);
            const pendingResult = await controller.getPendingRequests(index_1.TEST_USER_IDS.THERAPIST);
            expect(pendingResult.totalPending).toBe(1);
            // Step 2: Get request details
            const detailsResult = await controller.getRequestDetails(validRequestId, index_1.TEST_USER_IDS.THERAPIST);
            expect(detailsResult.success).toBe(true);
            // Step 3: Accept request
            const acceptResult = {
                success: true,
                message: 'Request accepted successfully',
                request: { ...mockRequest, status: 'ACCEPTED' },
            };
            mockTherapistRequestService.acceptClientRequest.mockResolvedValue(acceptResult);
            const acceptedResult = await controller.acceptRequest(validRequestId, { message: 'I would be happy to work with you' }, index_1.TEST_USER_IDS.THERAPIST);
            expect(acceptedResult).toEqual(acceptResult);
            // Step 4: Check statistics
            mockTherapistRequestService.getTherapistRequestStatistics.mockResolvedValue(mockStatistics);
            const statsResult = await controller.getRequestStatistics(index_1.TEST_USER_IDS.THERAPIST);
            expect(statsResult).toEqual(mockStatistics);
        });
        it('should handle bulk action workflow', async () => {
            // Step 1: Get pending requests
            mockTherapistRequestService.getTherapistRequests.mockResolvedValue(mockPaginatedRequests);
            const pendingResult = await controller.getPendingRequests(index_1.TEST_USER_IDS.THERAPIST);
            expect(pendingResult.totalPending).toBe(1);
            // Step 2: Perform bulk action
            const bulkResult = {
                success: true,
                processedCount: 2,
                failedCount: 0,
                results: [
                    { requestId: validRequestId, status: 'ACCEPTED' },
                    { requestId: '11111111-2222-3333-4444-555555555555', status: 'ACCEPTED' },
                ],
            };
            mockTherapistRequestService.performBulkAction.mockResolvedValue(bulkResult);
            const bulkActionResult = await controller.performBulkAction({
                action: 'accept',
                requestIds: [validRequestId, '11111111-2222-3333-4444-555555555555'],
                message: 'Bulk acceptance',
            }, index_1.TEST_USER_IDS.THERAPIST);
            expect(bulkActionResult).toEqual(bulkResult);
            // Step 3: Check updated statistics
            mockTherapistRequestService.getTherapistRequestStatistics.mockResolvedValue(mockStatistics);
            const statsResult = await controller.getRequestStatistics(index_1.TEST_USER_IDS.THERAPIST);
            expect(statsResult).toEqual(mockStatistics);
        });
    });
    describe('Error Handling', () => {
        it('should handle service unavailable scenarios', async () => {
            const serviceError = new Error('Service temporarily unavailable');
            mockTherapistRequestService.getTherapistRequests.mockRejectedValue(serviceError);
            await expect(controller.getClientRequests({ page: 1, limit: 10 }, index_1.TEST_USER_IDS.THERAPIST)).rejects.toThrow(serviceError);
        });
        it('should handle concurrent access issues', async () => {
            const concurrencyError = new Error('Resource is locked');
            mockTherapistRequestService.acceptClientRequest.mockRejectedValue(concurrencyError);
            await expect(controller.acceptRequest(validRequestId, { message: 'Accept message' }, index_1.TEST_USER_IDS.THERAPIST)).rejects.toThrow(concurrencyError);
        });
        it('should handle malformed request data', async () => {
            const malformedFilters = { invalid: 'data' };
            mockTherapistRequestService.getTherapistRequests.mockResolvedValue(mockPaginatedRequests);
            const result = await controller.getClientRequests(malformedFilters, index_1.TEST_USER_IDS.THERAPIST);
            expect(therapistRequestService.getTherapistRequests).toHaveBeenCalledWith(index_1.TEST_USER_IDS.THERAPIST, malformedFilters);
        });
    });
    describe('Response Format Validation', () => {
        it('should return properly formatted request response', async () => {
            mockTherapistRequestService.getTherapistRequests.mockResolvedValue(mockPaginatedRequests);
            const result = await controller.getClientRequests({ page: 1, limit: 10 }, index_1.TEST_USER_IDS.THERAPIST);
            expect(result).toHaveProperty('requests');
            expect(result).toHaveProperty('pagination');
            expect(result).toHaveProperty('summary');
            expect(Array.isArray(result.requests)).toBe(true);
            expect(typeof result.pagination.totalCount).toBe('number');
        });
        it('should return properly formatted statistics response', async () => {
            mockTherapistRequestService.getTherapistRequestStatistics.mockResolvedValue(mockStatistics);
            const result = await controller.getRequestStatistics(index_1.TEST_USER_IDS.THERAPIST);
            expect(result).toHaveProperty('totalReceived');
            expect(result).toHaveProperty('pending');
            expect(result).toHaveProperty('accepted');
            expect(result).toHaveProperty('declined');
            expect(result).toHaveProperty('averageResponseTime');
            expect(result).toHaveProperty('acceptanceRate');
            expect(typeof result.totalReceived).toBe('number');
            expect(typeof result.averageResponseTime).toBe('number');
        });
        it('should return properly formatted success responses', async () => {
            mockTherapistRequestService.getTherapistRequests.mockResolvedValue(mockPaginatedRequests);
            const result = await controller.getRecentRequests(index_1.TEST_USER_IDS.THERAPIST);
            expect(result).toHaveProperty('success');
            expect(result).toHaveProperty('recentRequests');
            expect(result).toHaveProperty('hasMore');
            expect(result.success).toBe(true);
            expect(Array.isArray(result.recentRequests)).toBe(true);
            expect(typeof result.hasMore).toBe('boolean');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL3RoZXJhcGlzdC9jb250cm9sbGVycy90aGVyYXBpc3QtcmVxdWVzdC5jb250cm9sbGVyLnNwZWMudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7R0FHRzs7QUFFSCw2Q0FBc0Q7QUFDdEQsMkNBQXdFO0FBQ3hFLHFFQUFnRTtBQUNoRSxpRkFBNEU7QUFDNUUscUZBQWdGO0FBRWhGLGtGQUF3RztBQUN4RyxrREFBb0U7QUFFcEUsUUFBUSxDQUFDLDRCQUE0QixFQUFFLEdBQUcsRUFBRTtJQUMxQyxJQUFJLFVBQXNDLENBQUM7SUFDM0MsSUFBSSx1QkFBZ0QsQ0FBQztJQUNyRCxJQUFJLE1BQXFCLENBQUM7SUFFMUIsK0JBQStCO0lBQy9CLE1BQU0sMkJBQTJCLEdBQUc7UUFDbEMsb0JBQW9CLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUMvQixtQkFBbUIsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQzlCLG9CQUFvQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDL0IsaUJBQWlCLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUM1Qiw2QkFBNkIsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0tBQ3pDLENBQUM7SUFFRixvQkFBb0I7SUFDcEIsTUFBTSxnQkFBZ0IsR0FBRztRQUN2QixXQUFXLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUM7S0FDN0MsQ0FBQztJQUVGLFdBQVc7SUFDWCxNQUFNLGNBQWMsR0FBRyxzQ0FBc0MsQ0FBQyxDQUFDLHVCQUF1QjtJQUN0RixNQUFNLGFBQWEsR0FBRyxzQ0FBc0MsQ0FBQyxDQUFDLHVCQUF1QjtJQUVyRixZQUFZO0lBQ1osTUFBTSxXQUFXLEdBQUc7UUFDbEIsRUFBRSxFQUFFLGNBQWM7UUFDbEIsUUFBUSxFQUFFLGFBQWE7UUFDdkIsV0FBVyxFQUFFLHFCQUFhLENBQUMsU0FBUztR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QUUzRSxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsY0FBYyxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQ3pDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxjQUFjLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztZQUNoRCxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsY0FBYyxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQ3pDLE1BQU0sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ2xDLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUN4RCxNQUFNLENBQUMsT0FBTyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQ2hELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS93ZXRvb2EvRG9jdW1lbnRzL2NvZGUvcHJvamVjdHMvbWVudGFyYS9tZW50YXJhLWFwaS9zcmMvdGhlcmFwaXN0L2NvbnRyb2xsZXJzL3RoZXJhcGlzdC1yZXF1ZXN0LmNvbnRyb2xsZXIuc3BlYy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvbXByZWhlbnNpdmUgVGVzdCBTdWl0ZSBmb3IgVGhlcmFwaXN0UmVxdWVzdENvbnRyb2xsZXJcbiAqIFRlc3RzIGFsbCB0aGVyYXBpc3QgcmVxdWVzdCBtYW5hZ2VtZW50IGVuZHBvaW50cyB3aXRoIHNlY3VyaXR5LCB2YWxpZGF0aW9uLCBhbmQgZXJyb3IgaGFuZGxpbmdcbiAqL1xuXG5pbXBvcnQgeyBUZXN0LCBUZXN0aW5nTW9kdWxlIH0gZnJvbSAnQG5lc3Rqcy90ZXN0aW5nJztcbmltcG9ydCB7IEJhZFJlcXVlc3RFeGNlcHRpb24sIE5vdEZvdW5kRXhjZXB0aW9uIH0gZnJvbSAnQG5lc3Rqcy9jb21tb24nO1xuaW1wb3J0IHsgSnd0QXV0aEd1YXJkIH0gZnJvbSAnLi4vLi4vYXV0aC9ndWFyZHMvand0LWF1dGguZ3VhcmQnO1xuaW1wb3J0IHsgVGhlcmFwaXN0UmVxdWVzdENvbnRyb2xsZXIgfSBmcm9tICcuL3RoZXJhcGlzdC1yZXF1ZXN0LmNvbnRyb2xsZXInO1xuaW1wb3J0IHsgVGhlcmFwaXN0UmVxdWVzdFNlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy90aGVyYXBpc3QtcmVxdWVzdC5zZXJ2aWNlJztcbmltcG9ydCB7IFNlY3VyaXR5R3VhcmRUZXN0VXRpbHMsIFJvbGVCYXNlZFRlc3RVdGlscyB9IGZyb20gJy4uLy4uL3Rlc3QtdXRpbHMvYXV0aC10ZXN0aW5nLWhlbHBlcnMnO1xuaW1wb3J0IHsgTW9ja0J1aWxkZXIsIFRlc3REYXRhR2VuZXJhdG9yLCBUZXN0QXNzZXJ0aW9ucyB9IGZyb20gJy4uLy4uL3Rlc3QtdXRpbHMvZW5oYW5jZWQtdGVzdC1oZWxwZXJzJztcbmltcG9ydCB7IFRFU1RfVVNFUl9JRFMsIFRFU1RfRU1BSUxTIH0gZnJvbSAnLi4vLi4vdGVzdC11dGlscy9pbmRleCc7XG5cbmRlc2NyaWJlKCdUaGVyYXBpc3RSZXF1ZXN0Q29udHJvbGxlcicsICgpID0+IHtcbiAgbGV0IGNvbnRyb2xsZXI6IFRoZXJhcGlzdFJlcXVlc3RDb250cm9sbGVyO1xuICBsZXQgdGhlcmFwaXN0UmVxdWVzdFNlcnZpY2U6IFRoZXJhcGlzdFJlcXVlc3RTZXJ2aWNlO1xuICBsZXQgbW9kdWxlOiBUZXN0aW5nTW9kdWxlO1xuXG4gIC8vIE1vY2sgVGhlcmFwaXN0UmVxdWVzdFNlcnZpY2VcbiAgY29uc3QgbW9ja1RoZXJhcGlzdFJlcXVlc3RTZXJ2aWNlID0ge1xuICAgIGdldFRoZXJhcGlzdFJlcXVlc3RzOiBqZXN0LmZuKCksXG4gICAgYWNjZXB0Q2xpZW50UmVxdWVzdDogamVzdC5mbigpLFxuICAgIGRlY2xpbmVDbGllbnRSZXF1ZXN0OiBqZXN0LmZuKCksXG4gICAgcGVyZm9ybUJ1bGtBY3Rpb246IGplc3QuZm4oKSxcbiAgICBnZXRUaGVyYXBpc3RSZXF1ZXN0U3RhdGlzdGljczogamVzdC5mbigpLFxuICB9O1xuXG4gIC8vIE1vY2sgSnd0QXV0aEd1YXJkXG4gIGNvbnN0IG1vY2tKd3RBdXRoR3VhcmQgPSB7XG4gICAgY2FuQWN0aXZhdGU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUodHJ1ZSksXG4gIH07XG5cbiAgLy8gVGVzdCBJRHNcbiAgY29uc3QgdmFsaWRSZXF1ZXN0SWQgPSAnODc2NTQzMjEtNDMyMS00MzIxLTQzMjEtMjEwOTg3NjU0MzIxJzsgLy8gMzYgY2hhcnMgVVVJRCBmb3JtYXRcbiAgY29uc3QgdmFsaWRDbGllbnRJZCA9ICcxMjM0NTY3OC0xMjM0LTEyMzQtMTIzNC0xMjM0NTY3ODkwMTInOyAvLyAzNiBjaGFycyBVVUlEIGZvcm1hdFxuXG4gIC8vIFRlc3QgZGF0YVxuICBjb25zdCBtb2NrUmVxdWVzdCA9IHtcbiAgICBpZDogdmFsaWRSZXF1ZXN0SWQsXG4gICAgY2xpZW50SWQ6IHZhbGlkQ2xpZW50SWQsXG4gICAgdGhlcmFwaXN0SWQ6IFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNULFxuICAgIHN0YXR1czogJ1BFTkRJTkcnLFxuICAgIHByaW9yaXR5OiAnTk9STUFMJyxcbiAgICBtZXNzYWdlOiAnSSB3b3VsZCBsaWtlIHRvIHNjaGVkdWxlIGEgc2Vzc2lvbicsXG4gICAgcmVxdWVzdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgcmVzcG9uZGVkQXQ6IG51bGwsXG4gICAgZXhwaXJlc0F0OiBuZXcgRGF0ZShEYXRlLm5vdygpICsgNyAqIDI0ICogNjAgKiA2MCAqIDEwMDApLCAvLyA3IGRheXMgZnJvbSBub3dcbiAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgIGNsaWVudDoge1xuICAgICAgaWQ6IHZhbGlkQ2xpZW50SWQsXG4gICAgICBmaXJzdE5hbWU6ICdKb2huJyxcbiAgICAgIGxhc3ROYW1lOiAnRG9lJyxcbiAgICAgIGVtYWlsOiAnam9obkBleGFtcGxlLmNvbScsXG4gICAgfSxcbiAgfTtcblxuICBjb25zdCBtb2NrUGFnaW5hdGVkUmVxdWVzdHMgPSB7XG4gICAgcmVxdWVzdHM6IFttb2NrUmVxdWVzdF0sXG4gICAgcGFnaW5hdGlvbjoge1xuICAgICAgcGFnZTogMSxcbiAgICAgIGxpbWl0OiAxMCxcbiAgICAgIHRvdGFsQ291bnQ6IDEsXG4gICAgICB0b3RhbFBhZ2VzOiAxLFxuICAgICAgaGFzTmV4dDogZmFsc2UsXG4gICAgICBoYXNQcmV2OiBmYWxzZSxcbiAgICB9LFxuICAgIHN1bW1hcnk6IHtcbiAgICAgIHRvdGFsUmVxdWVzdHM6IDEsXG4gICAgICBwZW5kaW5nUmVxdWVzdHM6IDEsXG4gICAgICBhY2NlcHRlZFJlcXVlc3RzOiAwLFxuICAgICAgZGVjbGluZWRSZXF1ZXN0czogMCxcbiAgICAgIGV4cGlyZWRSZXF1ZXN0czogMCxcbiAgICB9LFxuICB9O1xuXG4gIGNvbnN0IG1vY2tTdGF0aXN0aWNzID0ge1xuICAgIHRvdGFsUmVjZWl2ZWQ6IDEwLFxuICAgIHBlbmRpbmc6IDMsXG4gICAgYWNjZXB0ZWQ6IDUsXG4gICAgZGVjbGluZWQ6IDIsXG4gICAgZXhwaXJlZDogMCxcbiAgICBjYW5jZWxsZWQ6IDAsXG4gICAgd2l0aGRyYXduOiAwLFxuICAgIGF2ZXJhZ2VSZXNwb25zZVRpbWU6IDQuNSxcbiAgICBhY2NlcHRhbmNlUmF0ZTogNzEuNCxcbiAgfTtcblxuICBiZWZvcmVFYWNoKGFzeW5jICgpID0+IHtcbiAgICBtb2R1bGUgPSBhd2FpdCBUZXN0LmNyZWF0ZVRlc3RpbmdNb2R1bGUoe1xuICAgICAgY29udHJvbGxlcnM6IFtUaGVyYXBpc3RSZXF1ZXN0Q29udHJvbGxlcl0sXG4gICAgICBwcm92aWRlcnM6IFtcbiAgICAgICAge1xuICAgICAgICAgIHByb3ZpZGU6IFRoZXJhcGlzdFJlcXVlc3RTZXJ2aWNlLFxuICAgICAgICAgIHVzZVZhbHVlOiBtb2NrVGhlcmFwaXN0UmVxdWVzdFNlcnZpY2UsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgIH0pXG4gICAgICAub3ZlcnJpZGVHdWFyZChKd3RBdXRoR3VhcmQpXG4gICAgICAudXNlVmFsdWUobW9ja0p3dEF1dGhHdWFyZClcbiAgICAgIC5jb21waWxlKCk7XG5cbiAgICBjb250cm9sbGVyID0gbW9kdWxlLmdldDxUaGVyYXBpc3RSZXF1ZXN0Q29udHJvbGxlcj4oVGhlcmFwaXN0UmVxdWVzdENvbnRyb2xsZXIpO1xuICAgIHRoZXJhcGlzdFJlcXVlc3RTZXJ2aWNlID0gbW9kdWxlLmdldDxUaGVyYXBpc3RSZXF1ZXN0U2VydmljZT4oVGhlcmFwaXN0UmVxdWVzdFNlcnZpY2UpO1xuICB9KTtcblxuICBhZnRlckVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICB9KTtcblxuICBkZXNjcmliZSgnQ29udHJvbGxlciBJbml0aWFsaXphdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGJlIGRlZmluZWQnLCAoKSA9PiB7XG4gICAgICBleHBlY3QoY29udHJvbGxlcikudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGF2ZSB0aGVyYXBpc3RSZXF1ZXN0U2VydmljZSBpbmplY3RlZCcsICgpID0+IHtcbiAgICAgIGV4cGVjdCh0aGVyYXBpc3RSZXF1ZXN0U2VydmljZSkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1NlY3VyaXR5IEd1YXJkcycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGJlIHByb3RlY3RlZCBieSBKd3RBdXRoR3VhcmQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBndWFyZHMgPSBSZWZsZWN0LmdldE1ldGFkYXRhKCdfX2d1YXJkc19fJywgVGhlcmFwaXN0UmVxdWVzdENvbnRyb2xsZXIpO1xuICAgICAgZXhwZWN0KGd1YXJkcykudG9Db250YWluKEp3dEF1dGhHdWFyZCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhdmUgcHJvcGVyIHJvdXRlIGRlY29yYXRvcnMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBjb250cm9sbGVyTWV0YWRhdGEgPSBSZWZsZWN0LmdldE1ldGFkYXRhKCdwYXRoJywgVGhlcmFwaXN0UmVxdWVzdENvbnRyb2xsZXIpO1xuICAgICAgZXhwZWN0KGNvbnRyb2xsZXJNZXRhZGF0YSkudG9CZSgndGhlcmFwaXN0L3JlcXVlc3RzJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdHRVQgL3RoZXJhcGlzdC9yZXF1ZXN0cycsICgpID0+IHtcbiAgICBjb25zdCBmaWx0ZXJzID0ge1xuICAgICAgcGFnZTogMSxcbiAgICAgIGxpbWl0OiAxMCxcbiAgICAgIHNvcnRCeTogJ3JlcXVlc3RlZEF0JyxcbiAgICAgIHNvcnRPcmRlcjogJ2Rlc2MnLFxuICAgICAgc3RhdHVzOiAnUEVORElORycsXG4gICAgfTtcblxuICAgIGl0KCdzaG91bGQgZ2V0IGNsaWVudCByZXF1ZXN0cyB3aXRoIGZpbHRlcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrVGhlcmFwaXN0UmVxdWVzdFNlcnZpY2UuZ2V0VGhlcmFwaXN0UmVxdWVzdHMubW9ja1Jlc29sdmVkVmFsdWUobW9ja1BhZ2luYXRlZFJlcXVlc3RzKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRDbGllbnRSZXF1ZXN0cyhmaWx0ZXJzLCBURVNUX1VTRVJfSURTLlRIRVJBUElTVCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja1BhZ2luYXRlZFJlcXVlc3RzKTtcbiAgICAgIGV4cGVjdCh0aGVyYXBpc3RSZXF1ZXN0U2VydmljZS5nZXRUaGVyYXBpc3RSZXF1ZXN0cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNULFxuICAgICAgICBmaWx0ZXJzLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGVtcHR5IGZpbHRlcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBlbXB0eUZpbHRlcnMgPSB7fTtcbiAgICAgIG1vY2tUaGVyYXBpc3RSZXF1ZXN0U2VydmljZS5nZXRUaGVyYXBpc3RSZXF1ZXN0cy5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUGFnaW5hdGVkUmVxdWVzdHMpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldENsaWVudFJlcXVlc3RzKGVtcHR5RmlsdGVycywgVEVTVF9VU0VSX0lEUy5USEVSQVBJU1QpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKG1vY2tQYWdpbmF0ZWRSZXF1ZXN0cyk7XG4gICAgICBleHBlY3QodGhlcmFwaXN0UmVxdWVzdFNlcnZpY2UuZ2V0VGhlcmFwaXN0UmVxdWVzdHMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBURVNUX1VTRVJfSURTLlRIRVJBUElTVCxcbiAgICAgICAgZW1wdHlGaWx0ZXJzLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHNlcnZpY2UgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgc2VydmljZUVycm9yID0gbmV3IEVycm9yKCdEYXRhYmFzZSBjb25uZWN0aW9uIGZhaWxlZCcpO1xuICAgICAgbW9ja1RoZXJhcGlzdFJlcXVlc3RTZXJ2aWNlLmdldFRoZXJhcGlzdFJlcXVlc3RzLm1vY2tSZWplY3RlZFZhbHVlKHNlcnZpY2VFcnJvcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5nZXRDbGllbnRSZXF1ZXN0cyhmaWx0ZXJzLCBURVNUX1VTRVJfSURTLlRIRVJBUElTVCksXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhzZXJ2aWNlRXJyb3IpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnR0VUIC90aGVyYXBpc3QvcmVxdWVzdHMvcGVuZGluZycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGdldCBwZW5kaW5nIHJlcXVlc3RzIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tUaGVyYXBpc3RSZXF1ZXN0U2VydmljZS5nZXRUaGVyYXBpc3RSZXF1ZXN0cy5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUGFnaW5hdGVkUmVxdWVzdHMpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldFBlbmRpbmdSZXF1ZXN0cyhURVNUX1VTRVJfSURTLlRIRVJBUElTVCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoe1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBwZW5kaW5nUmVxdWVzdHM6IFttb2NrUmVxdWVzdF0sXG4gICAgICAgIHRvdGFsUGVuZGluZzogMSxcbiAgICAgICAgc3VtbWFyeTogbW9ja1BhZ2luYXRlZFJlcXVlc3RzLnN1bW1hcnksXG4gICAgICB9KTtcbiAgICAgIGV4cGVjdCh0aGVyYXBpc3RSZXF1ZXN0U2VydmljZS5nZXRUaGVyYXBpc3RSZXF1ZXN0cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNULFxuICAgICAgICB7XG4gICAgICAgICAgc3RhdHVzOiAnUEVORElORycsXG4gICAgICAgICAgcGFnZTogMSxcbiAgICAgICAgICBsaW1pdDogNTAsXG4gICAgICAgICAgc29ydEJ5OiAncmVxdWVzdGVkQXQnLFxuICAgICAgICAgIHNvcnRPcmRlcjogJ2FzYycsXG4gICAgICAgICAgaW5jbHVkZUV4cGlyZWQ6IGZhbHNlLFxuICAgICAgICB9LFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG5vIHBlbmRpbmcgcmVxdWVzdHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBlbXB0eVJlc3VsdCA9IHtcbiAgICAgICAgLi4ubW9ja1BhZ2luYXRlZFJlcXVlc3RzLFxuICAgICAgICByZXF1ZXN0czogW10sXG4gICAgICAgIHBhZ2luYXRpb246IHsgLi4ubW9ja1BhZ2luYXRlZFJlcXVlc3RzLnBhZ2luYXRpb24sIHRvdGFsQ291bnQ6IDAgfSxcbiAgICAgIH07XG4gICAgICBtb2NrVGhlcmFwaXN0UmVxdWVzdFNlcnZpY2UuZ2V0VGhlcmFwaXN0UmVxdWVzdHMubW9ja1Jlc29sdmVkVmFsdWUoZW1wdHlSZXN1bHQpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldFBlbmRpbmdSZXF1ZXN0cyhURVNUX1VTRVJfSURTLlRIRVJBUElTVCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQucGVuZGluZ1JlcXVlc3RzKS50b0VxdWFsKFtdKTtcbiAgICAgIGV4cGVjdChyZXN1bHQudG90YWxQZW5kaW5nKS50b0JlKDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2VydmljZSBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBzZXJ2aWNlRXJyb3IgPSBuZXcgRXJyb3IoJ0RhdGFiYXNlIHF1ZXJ5IGZhaWxlZCcpO1xuICAgICAgbW9ja1RoZXJhcGlzdFJlcXVlc3RTZXJ2aWNlLmdldFRoZXJhcGlzdFJlcXVlc3RzLm1vY2tSZWplY3RlZFZhbHVlKHNlcnZpY2VFcnJvcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5nZXRQZW5kaW5nUmVxdWVzdHMoVEVTVF9VU0VSX0lEUy5USEVSQVBJU1QpLFxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coc2VydmljZUVycm9yKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0dFVCAvdGhlcmFwaXN0L3JlcXVlc3RzL3ByaW9yaXR5JywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZ2V0IGhpZ2ggcHJpb3JpdHkgcmVxdWVzdHMgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgaGlnaFByaW9yaXR5UmVzdWx0ID0ge1xuICAgICAgICAuLi5tb2NrUGFnaW5hdGVkUmVxdWVzdHMsXG4gICAgICAgIHJlcXVlc3RzOiBbeyAuLi5tb2NrUmVxdWVzdCwgcHJpb3JpdHk6ICdISUdIJyB9XSxcbiAgICAgIH07XG4gICAgICBjb25zdCB1cmdlbnRSZXN1bHQgPSB7XG4gICAgICAgIC4uLm1vY2tQYWdpbmF0ZWRSZXF1ZXN0cyxcbiAgICAgICAgcmVxdWVzdHM6IFt7IC4uLm1vY2tSZXF1ZXN0LCBwcmlvcml0eTogJ1VSR0VOVCcgfV0sXG4gICAgICB9O1xuICAgICAgbW9ja1RoZXJhcGlzdFJlcXVlc3RTZXJ2aWNlLmdldFRoZXJhcGlzdFJlcXVlc3RzXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UoaGlnaFByaW9yaXR5UmVzdWx0KVxuICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHVyZ2VudFJlc3VsdCk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0SGlnaFByaW9yaXR5UmVxdWVzdHMoVEVTVF9VU0VSX0lEUy5USEVSQVBJU1QpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgaGlnaFByaW9yaXR5UmVxdWVzdHM6IFt7IC4uLm1vY2tSZXF1ZXN0LCBwcmlvcml0eTogJ0hJR0gnIH1dLFxuICAgICAgICB1cmdlbnRSZXF1ZXN0czogW3sgLi4ubW9ja1JlcXVlc3QsIHByaW9yaXR5OiAnVVJHRU5UJyB9XSxcbiAgICAgICAgdG90YWxIaWdoUHJpb3JpdHk6IDEsXG4gICAgICAgIHRvdGFsVXJnZW50OiAxLFxuICAgICAgfSk7XG4gICAgICBleHBlY3QodGhlcmFwaXN0UmVxdWVzdFNlcnZpY2UuZ2V0VGhlcmFwaXN0UmVxdWVzdHMpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygyKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG5vIGhpZ2ggcHJpb3JpdHkgcmVxdWVzdHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBlbXB0eVJlc3VsdCA9IHtcbiAgICAgICAgLi4ubW9ja1BhZ2luYXRlZFJlcXVlc3RzLFxuICAgICAgICByZXF1ZXN0czogW10sXG4gICAgICAgIHBhZ2luYXRpb246IHsgLi4ubW9ja1BhZ2luYXRlZFJlcXVlc3RzLnBhZ2luYXRpb24sIHRvdGFsQ291bnQ6IDAgfSxcbiAgICAgIH07XG4gICAgICBtb2NrVGhlcmFwaXN0UmVxdWVzdFNlcnZpY2UuZ2V0VGhlcmFwaXN0UmVxdWVzdHNcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShlbXB0eVJlc3VsdClcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShlbXB0eVJlc3VsdCk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0SGlnaFByaW9yaXR5UmVxdWVzdHMoVEVTVF9VU0VSX0lEUy5USEVSQVBJU1QpO1xuXG4gICAgICBleHBlY3QocmVzdWx0LmhpZ2hQcmlvcml0eVJlcXVlc3RzKS50b0VxdWFsKFtdKTtcbiAgICAgIGV4cGVjdChyZXN1bHQudXJnZW50UmVxdWVzdHMpLnRvRXF1YWwoW10pO1xuICAgICAgZXhwZWN0KHJlc3VsdC50b3RhbEhpZ2hQcmlvcml0eSkudG9CZSgwKTtcbiAgICAgIGV4cGVjdChyZXN1bHQudG90YWxVcmdlbnQpLnRvQmUoMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzZXJ2aWNlIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHNlcnZpY2VFcnJvciA9IG5ldyBFcnJvcignRGF0YWJhc2UgcXVlcnkgZmFpbGVkJyk7XG4gICAgICBtb2NrVGhlcmFwaXN0UmVxdWVzdFNlcnZpY2UuZ2V0VGhlcmFwaXN0UmVxdWVzdHMubW9ja1JlamVjdGVkVmFsdWUoc2VydmljZUVycm9yKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLmdldEhpZ2hQcmlvcml0eVJlcXVlc3RzKFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNUKSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KHNlcnZpY2VFcnJvcik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdHRVQgL3RoZXJhcGlzdC9yZXF1ZXN0cy86aWQnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBnZXQgcmVxdWVzdCBkZXRhaWxzIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tUaGVyYXBpc3RSZXF1ZXN0U2VydmljZS5nZXRUaGVyYXBpc3RSZXF1ZXN0cy5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUGFnaW5hdGVkUmVxdWVzdHMpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldFJlcXVlc3REZXRhaWxzKHZhbGlkUmVxdWVzdElkLCBURVNUX1VTRVJfSURTLlRIRVJBUElTVCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoe1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICByZXF1ZXN0OiBtb2NrUmVxdWVzdCxcbiAgICAgIH0pO1xuICAgICAgZXhwZWN0KHRoZXJhcGlzdFJlcXVlc3RTZXJ2aWNlLmdldFRoZXJhcGlzdFJlcXVlc3RzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5USEVSQVBJU1QsXG4gICAgICAgIHtcbiAgICAgICAgICBwYWdlOiAxLFxuICAgICAgICAgIGxpbWl0OiAxLFxuICAgICAgICAgIHNvcnRCeTogJ3JlcXVlc3RlZEF0JyxcbiAgICAgICAgICBzb3J0T3JkZXI6ICdkZXNjJyxcbiAgICAgICAgICBpbmNsdWRlRXhwaXJlZDogZmFsc2UsXG4gICAgICAgIH0sXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSByZXF1ZXN0IElEIGZvcm1hdCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGludmFsaWRSZXF1ZXN0SWQgPSAnaW52YWxpZC1pZCc7XG5cbiAgICAgIGF3YWl0IFRlc3RBc3NlcnRpb25zLmV4cGVjdFRvVGhyb3dOZXN0RXhjZXB0aW9uKFxuICAgICAgICAoKSA9PiBjb250cm9sbGVyLmdldFJlcXVlc3REZXRhaWxzKGludmFsaWRSZXF1ZXN0SWQsIFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNUKSxcbiAgICAgICAgQmFkUmVxdWVzdEV4Y2VwdGlvbixcbiAgICAgICAgJ0ludmFsaWQgcmVxdWVzdCBJRCBmb3JtYXQnLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHJlcXVlc3Qgbm90IGZvdW5kJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1RoZXJhcGlzdFJlcXVlc3RTZXJ2aWNlLmdldFRoZXJhcGlzdFJlcXVlc3RzLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgcmVxdWVzdHM6IFtdLFxuICAgICAgICBwYWdpbmF0aW9uOiB7IHBhZ2U6IDEsIGxpbWl0OiAxLCB0b3RhbENvdW50OiAwLCB0b3RhbFBhZ2VzOiAwLCBoYXNOZXh0OiBmYWxzZSwgaGFzUHJldjogZmFsc2UgfSxcbiAgICAgIH0pO1xuXG4gICAgICBhd2FpdCBUZXN0QXNzZXJ0aW9ucy5leHBlY3RUb1Rocm93TmVzdEV4Y2VwdGlvbihcbiAgICAgICAgKCkgPT4gY29udHJvbGxlci5nZXRSZXF1ZXN0RGV0YWlscyh2YWxpZFJlcXVlc3RJZCwgVEVTVF9VU0VSX0lEUy5USEVSQVBJU1QpLFxuICAgICAgICBOb3RGb3VuZEV4Y2VwdGlvbixcbiAgICAgICAgJ1JlcXVlc3Qgd2l0aCBJRCA4NzY1NDMyMS00MzIxLTQzMjEtNDMyMS0yMTA5ODc2NTQzMjEgbm90IGZvdW5kIG9yIG5vdCBhY2Nlc3NpYmxlJyxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBlbXB0eSByZXF1ZXN0IElEJywgYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgVGVzdEFzc2VydGlvbnMuZXhwZWN0VG9UaHJvd05lc3RFeGNlcHRpb24oXG4gICAgICAgICgpID0+IGNvbnRyb2xsZXIuZ2V0UmVxdWVzdERldGFpbHMoJycsIFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNUKSxcbiAgICAgICAgQmFkUmVxdWVzdEV4Y2VwdGlvbixcbiAgICAgICAgJ0ludmFsaWQgcmVxdWVzdCBJRCBmb3JtYXQnLFxuICAgICAgKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1BVVCAvdGhlcmFwaXN0L3JlcXVlc3RzLzppZC9hY2NlcHQnLCAoKSA9PiB7XG4gICAgY29uc3QgcmVzcG9uc2VEdG8gPSB7XG4gICAgICBtZXNzYWdlOiAnSSB3b3VsZCBiZSBoYXBweSB0byB3b3JrIHdpdGggeW91JyxcbiAgICAgIGF2YWlsYWJsZVNsb3RzOiBbJzIwMjQtMDEtMTVUMTA6MDA6MDBaJywgJzIwMjQtMDEtMTZUMTQ6MDA6MDBaJ10sXG4gICAgfTtcblxuICAgIGl0KCdzaG91bGQgYWNjZXB0IHJlcXVlc3Qgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgYWNjZXB0UmVzdWx0ID0ge1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBtZXNzYWdlOiAnUmVxdWVzdCBhY2NlcHRlZCBzdWNjZXNzZnVsbHknLFxuICAgICAgICByZXF1ZXN0OiB7IC4uLm1vY2tSZXF1ZXN0LCBzdGF0dXM6ICdBQ0NFUFRFRCcgfSxcbiAgICAgIH07XG4gICAgICBtb2NrVGhlcmFwaXN0UmVxdWVzdFNlcnZpY2UuYWNjZXB0Q2xpZW50UmVxdWVzdC5tb2NrUmVzb2x2ZWRWYWx1ZShhY2NlcHRSZXN1bHQpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmFjY2VwdFJlcXVlc3QoXG4gICAgICAgIHZhbGlkUmVxdWVzdElkLFxuICAgICAgICByZXNwb25zZUR0byxcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5USEVSQVBJU1QsXG4gICAgICApO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKGFjY2VwdFJlc3VsdCk7XG4gICAgICBleHBlY3QodGhlcmFwaXN0UmVxdWVzdFNlcnZpY2UuYWNjZXB0Q2xpZW50UmVxdWVzdCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIHZhbGlkUmVxdWVzdElkLFxuICAgICAgICBURVNUX1VTRVJfSURTLlRIRVJBUElTVCxcbiAgICAgICAgcmVzcG9uc2VEdG8sXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSByZXF1ZXN0IElEIGZvcm1hdCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGludmFsaWRSZXF1ZXN0SWQgPSAnaW52YWxpZC1pZCc7XG5cbiAgICAgIGF3YWl0IFRlc3RBc3NlcnRpb25zLmV4cGVjdFRvVGhyb3dOZXN0RXhjZXB0aW9uKFxuICAgICAgICAoKSA9PiBjb250cm9sbGVyLmFjY2VwdFJlcXVlc3QoaW52YWxpZFJlcXVlc3RJZCwgcmVzcG9uc2VEdG8sIFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNUKSxcbiAgICAgICAgQmFkUmVxdWVzdEV4Y2VwdGlvbixcbiAgICAgICAgJ0ludmFsaWQgcmVxdWVzdCBJRCBmb3JtYXQnLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHNlcnZpY2UgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgc2VydmljZUVycm9yID0gbmV3IEVycm9yKCdSZXF1ZXN0IGNhbm5vdCBiZSBhY2NlcHRlZCcpO1xuICAgICAgbW9ja1RoZXJhcGlzdFJlcXVlc3RTZXJ2aWNlLmFjY2VwdENsaWVudFJlcXVlc3QubW9ja1JlamVjdGVkVmFsdWUoc2VydmljZUVycm9yKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLmFjY2VwdFJlcXVlc3QodmFsaWRSZXF1ZXN0SWQsIHJlc3BvbnNlRHRvLCBURVNUX1VTRVJfSURTLlRIRVJBUElTVCksXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhzZXJ2aWNlRXJyb3IpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUFVUIC90aGVyYXBpc3QvcmVxdWVzdHMvOmlkL2RlY2xpbmUnLCAoKSA9PiB7XG4gICAgY29uc3QgcmVzcG9uc2VEdG8gPSB7XG4gICAgICBtZXNzYWdlOiAnVW5mb3J0dW5hdGVseSwgSSBhbSBub3QgYXZhaWxhYmxlIGF0IHRoaXMgdGltZScsXG4gICAgICByZWFzb246ICdBVkFJTEFCSUxJVFlfQ09ORkxJQ1QnLFxuICAgIH07XG5cbiAgICBpdCgnc2hvdWxkIGRlY2xpbmUgcmVxdWVzdCBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBkZWNsaW5lUmVzdWx0ID0ge1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBtZXNzYWdlOiAnUmVxdWVzdCBkZWNsaW5lZCBzdWNjZXNzZnVsbHknLFxuICAgICAgICByZXF1ZXN0OiB7IC4uLm1vY2tSZXF1ZXN0LCBzdGF0dXM6ICdERUNMSU5FRCcgfSxcbiAgICAgIH07XG4gICAgICBtb2NrVGhlcmFwaXN0UmVxdWVzdFNlcnZpY2UuZGVjbGluZUNsaWVudFJlcXVlc3QubW9ja1Jlc29sdmVkVmFsdWUoZGVjbGluZVJlc3VsdCk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZGVjbGluZVJlcXVlc3QoXG4gICAgICAgIHZhbGlkUmVxdWVzdElkLFxuICAgICAgICByZXNwb25zZUR0byxcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5USEVSQVBJU1QsXG4gICAgICApO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKGRlY2xpbmVSZXN1bHQpO1xuICAgICAgZXhwZWN0KHRoZXJhcGlzdFJlcXVlc3RTZXJ2aWNlLmRlY2xpbmVDbGllbnRSZXF1ZXN0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgdmFsaWRSZXF1ZXN0SWQsXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNULFxuICAgICAgICByZXNwb25zZUR0byxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIHJlcXVlc3QgSUQgZm9ybWF0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgaW52YWxpZFJlcXVlc3RJZCA9ICdpbnZhbGlkLWlkJztcblxuICAgICAgYXdhaXQgVGVzdEFzc2VydGlvbnMuZXhwZWN0VG9UaHJvd05lc3RFeGNlcHRpb24oXG4gICAgICAgICgpID0+IGNvbnRyb2xsZXIuZGVjbGluZVJlcXVlc3QoaW52YWxpZFJlcXVlc3RJZCwgcmVzcG9uc2VEdG8sIFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNUKSxcbiAgICAgICAgQmFkUmVxdWVzdEV4Y2VwdGlvbixcbiAgICAgICAgJ0ludmFsaWQgcmVxdWVzdCBJRCBmb3JtYXQnLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHNlcnZpY2UgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgc2VydmljZUVycm9yID0gbmV3IEVycm9yKCdSZXF1ZXN0IGNhbm5vdCBiZSBkZWNsaW5lZCcpO1xuICAgICAgbW9ja1RoZXJhcGlzdFJlcXVlc3RTZXJ2aWNlLmRlY2xpbmVDbGllbnRSZXF1ZXN0Lm1vY2tSZWplY3RlZFZhbHVlKHNlcnZpY2VFcnJvcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5kZWNsaW5lUmVxdWVzdCh2YWxpZFJlcXVlc3RJZCwgcmVzcG9uc2VEdG8sIFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNUKSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KHNlcnZpY2VFcnJvcik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdQT1NUIC90aGVyYXBpc3QvcmVxdWVzdHMvYnVsay1hY3Rpb24nLCAoKSA9PiB7XG4gICAgY29uc3QgYnVsa0FjdGlvbkR0byA9IHtcbiAgICAgIGFjdGlvbjogJ2FjY2VwdCcsXG4gICAgICByZXF1ZXN0SWRzOiBbdmFsaWRSZXF1ZXN0SWQsICcxMTExMTExMS0yMjIyLTMzMzMtNDQ0NC01NTU1NTU1NTU1NTUnXSxcbiAgICAgIG1lc3NhZ2U6ICdCdWxrIGFjY2VwdGFuY2UgbWVzc2FnZScsXG4gICAgfTtcblxuICAgIGl0KCdzaG91bGQgcGVyZm9ybSBidWxrIGFjdGlvbiBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBidWxrUmVzdWx0ID0ge1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBwcm9jZXNzZWRDb3VudDogMixcbiAgICAgICAgZmFpbGVkQ291bnQ6IDAsXG4gICAgICAgIHJlc3VsdHM6IFtcbiAgICAgICAgICB7IHJlcXVlc3RJZDogdmFsaWRSZXF1ZXN0SWQsIHN0YXR1czogJ0FDQ0VQVEVEJyB9LFxuICAgICAgICAgIHsgcmVxdWVzdElkOiAnMTExMTExMTEtMjIyMi0zMzMzLTQ0NDQtNTU1NTU1NTU1NTU1Jywgc3RhdHVzOiAnQUNDRVBURUQnIH0sXG4gICAgICAgIF0sXG4gICAgICB9O1xuICAgICAgbW9ja1RoZXJhcGlzdFJlcXVlc3RTZXJ2aWNlLnBlcmZvcm1CdWxrQWN0aW9uLm1vY2tSZXNvbHZlZFZhbHVlKGJ1bGtSZXN1bHQpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLnBlcmZvcm1CdWxrQWN0aW9uKGJ1bGtBY3Rpb25EdG8sIFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNUKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChidWxrUmVzdWx0KTtcbiAgICAgIGV4cGVjdCh0aGVyYXBpc3RSZXF1ZXN0U2VydmljZS5wZXJmb3JtQnVsa0FjdGlvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNULFxuICAgICAgICBidWxrQWN0aW9uRHRvLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHNlcnZpY2UgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgc2VydmljZUVycm9yID0gbmV3IEVycm9yKCdCdWxrIGFjdGlvbiBmYWlsZWQnKTtcbiAgICAgIG1vY2tUaGVyYXBpc3RSZXF1ZXN0U2VydmljZS5wZXJmb3JtQnVsa0FjdGlvbi5tb2NrUmVqZWN0ZWRWYWx1ZShzZXJ2aWNlRXJyb3IpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIucGVyZm9ybUJ1bGtBY3Rpb24oYnVsa0FjdGlvbkR0bywgVEVTVF9VU0VSX0lEUy5USEVSQVBJU1QpLFxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coc2VydmljZUVycm9yKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0dFVCAvdGhlcmFwaXN0L3JlcXVlc3RzL3N0YXRpc3RpY3MnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBnZXQgcmVxdWVzdCBzdGF0aXN0aWNzIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tUaGVyYXBpc3RSZXF1ZXN0U2VydmljZS5nZXRUaGVyYXBpc3RSZXF1ZXN0U3RhdGlzdGljcy5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrU3RhdGlzdGljcyk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0UmVxdWVzdFN0YXRpc3RpY3MoVEVTVF9VU0VSX0lEUy5USEVSQVBJU1QpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKG1vY2tTdGF0aXN0aWNzKTtcbiAgICAgIGV4cGVjdCh0aGVyYXBpc3RSZXF1ZXN0U2VydmljZS5nZXRUaGVyYXBpc3RSZXF1ZXN0U3RhdGlzdGljcykudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNULFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHNlcnZpY2UgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgc2VydmljZUVycm9yID0gbmV3IEVycm9yKCdTdGF0aXN0aWNzIGNhbGN1bGF0aW9uIGZhaWxlZCcpO1xuICAgICAgbW9ja1RoZXJhcGlzdFJlcXVlc3RTZXJ2aWNlLmdldFRoZXJhcGlzdFJlcXVlc3RTdGF0aXN0aWNzLm1vY2tSZWplY3RlZFZhbHVlKHNlcnZpY2VFcnJvcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5nZXRSZXF1ZXN0U3RhdGlzdGljcyhURVNUX1VTRVJfSURTLlRIRVJBUElTVCksXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhzZXJ2aWNlRXJyb3IpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnR0VUIC90aGVyYXBpc3QvcmVxdWVzdHMvcmVjZW50JywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZ2V0IHJlY2VudCByZXF1ZXN0cyBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrVGhlcmFwaXN0UmVxdWVzdFNlcnZpY2UuZ2V0VGhlcmFwaXN0UmVxdWVzdHMubW9ja1Jlc29sdmVkVmFsdWUobW9ja1BhZ2luYXRlZFJlcXVlc3RzKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRSZWNlbnRSZXF1ZXN0cyhURVNUX1VTRVJfSURTLlRIRVJBUElTVCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoe1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICByZWNlbnRSZXF1ZXN0czogW21vY2tSZXF1ZXN0XSxcbiAgICAgICAgaGFzTW9yZTogZmFsc2UsXG4gICAgICAgIHN1bW1hcnk6IG1vY2tQYWdpbmF0ZWRSZXF1ZXN0cy5zdW1tYXJ5LFxuICAgICAgfSk7XG4gICAgICBleHBlY3QodGhlcmFwaXN0UmVxdWVzdFNlcnZpY2UuZ2V0VGhlcmFwaXN0UmVxdWVzdHMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBURVNUX1VTRVJfSURTLlRIRVJBUElTVCxcbiAgICAgICAge1xuICAgICAgICAgIHBhZ2U6IDEsXG4gICAgICAgICAgbGltaXQ6IDEwLFxuICAgICAgICAgIHNvcnRCeTogJ3JlcXVlc3RlZEF0JyxcbiAgICAgICAgICBzb3J0T3JkZXI6ICdkZXNjJyxcbiAgICAgICAgICBpbmNsdWRlRXhwaXJlZDogZmFsc2UsXG4gICAgICAgIH0sXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBpbmRpY2F0ZSB3aGVuIHRoZXJlIGFyZSBtb3JlIHJlcXVlc3RzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9yZVJlcXVlc3RzUmVzdWx0ID0ge1xuICAgICAgICAuLi5tb2NrUGFnaW5hdGVkUmVxdWVzdHMsXG4gICAgICAgIHBhZ2luYXRpb246IHsgLi4ubW9ja1BhZ2luYXRlZFJlcXVlc3RzLnBhZ2luYXRpb24sIHRvdGFsQ291bnQ6IDIwIH0sXG4gICAgICB9O1xuICAgICAgbW9ja1RoZXJhcGlzdFJlcXVlc3RTZXJ2aWNlLmdldFRoZXJhcGlzdFJlcXVlc3RzLm1vY2tSZXNvbHZlZFZhbHVlKG1vcmVSZXF1ZXN0c1Jlc3VsdCk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0UmVjZW50UmVxdWVzdHMoVEVTVF9VU0VSX0lEUy5USEVSQVBJU1QpO1xuXG4gICAgICBleHBlY3QocmVzdWx0Lmhhc01vcmUpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzZXJ2aWNlIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHNlcnZpY2VFcnJvciA9IG5ldyBFcnJvcignRGF0YWJhc2UgcXVlcnkgZmFpbGVkJyk7XG4gICAgICBtb2NrVGhlcmFwaXN0UmVxdWVzdFNlcnZpY2UuZ2V0VGhlcmFwaXN0UmVxdWVzdHMubW9ja1JlamVjdGVkVmFsdWUoc2VydmljZUVycm9yKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLmdldFJlY2VudFJlcXVlc3RzKFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNUKSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KHNlcnZpY2VFcnJvcik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdHRVQgL3RoZXJhcGlzdC9yZXF1ZXN0cy9kYXNoYm9hcmQvc3VtbWFyeScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGdldCBkYXNoYm9hcmQgc3VtbWFyeSBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrVGhlcmFwaXN0UmVxdWVzdFNlcnZpY2UuZ2V0VGhlcmFwaXN0UmVxdWVzdFN0YXRpc3RpY3MubW9ja1Jlc29sdmVkVmFsdWUobW9ja1N0YXRpc3RpY3MpO1xuICAgICAgbW9ja1RoZXJhcGlzdFJlcXVlc3RTZXJ2aWNlLmdldFRoZXJhcGlzdFJlcXVlc3RzXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UobW9ja1BhZ2luYXRlZFJlcXVlc3RzKSAvLyBwZW5kaW5nIHJlcXVlc3RzXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UobW9ja1BhZ2luYXRlZFJlcXVlc3RzKTsgLy8gaGlnaCBwcmlvcml0eSByZXF1ZXN0c1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldERhc2hib2FyZFN1bW1hcnkoVEVTVF9VU0VSX0lEUy5USEVSQVBJU1QpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgc3RhdGlzdGljczogbW9ja1N0YXRpc3RpY3MsXG4gICAgICAgIHJlY2VudFBlbmRpbmdSZXF1ZXN0czogW21vY2tSZXF1ZXN0XSxcbiAgICAgICAgaGlnaFByaW9yaXR5UmVxdWVzdHM6IFttb2NrUmVxdWVzdF0sXG4gICAgICAgIGFjdGlvblJlcXVpcmVkOiB0cnVlLFxuICAgICAgICBoYXNVcmdlbnRSZXF1ZXN0czogZmFsc2UsXG4gICAgICB9KTtcbiAgICAgIGV4cGVjdCh0aGVyYXBpc3RSZXF1ZXN0U2VydmljZS5nZXRUaGVyYXBpc3RSZXF1ZXN0U3RhdGlzdGljcykudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNULFxuICAgICAgKTtcbiAgICAgIGV4cGVjdCh0aGVyYXBpc3RSZXF1ZXN0U2VydmljZS5nZXRUaGVyYXBpc3RSZXF1ZXN0cykudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDIpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbm8gcGVuZGluZyByZXF1ZXN0cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGVtcHR5UmVzdWx0ID0ge1xuICAgICAgICAuLi5tb2NrUGFnaW5hdGVkUmVxdWVzdHMsXG4gICAgICAgIHJlcXVlc3RzOiBbXSxcbiAgICAgICAgcGFnaW5hdGlvbjogeyAuLi5tb2NrUGFnaW5hdGVkUmVxdWVzdHMucGFnaW5hdGlvbiwgdG90YWxDb3VudDogMCB9LFxuICAgICAgfTtcbiAgICAgIG1vY2tUaGVyYXBpc3RSZXF1ZXN0U2VydmljZS5nZXRUaGVyYXBpc3RSZXF1ZXN0U3RhdGlzdGljcy5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrU3RhdGlzdGljcyk7XG4gICAgICBtb2NrVGhlcmFwaXN0UmVxdWVzdFNlcnZpY2UuZ2V0VGhlcmFwaXN0UmVxdWVzdHNcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShlbXB0eVJlc3VsdClcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShlbXB0eVJlc3VsdCk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0RGFzaGJvYXJkU3VtbWFyeShURVNUX1VTRVJfSURTLlRIRVJBUElTVCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuYWN0aW9uUmVxdWlyZWQpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5oYXNVcmdlbnRSZXF1ZXN0cykudG9CZShmYWxzZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGRldGVjdCB1cmdlbnQgcmVxdWVzdHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB1cmdlbnRSZXF1ZXN0ID0geyAuLi5tb2NrUmVxdWVzdCwgcHJpb3JpdHk6ICdVUkdFTlQnIH07XG4gICAgICBjb25zdCB1cmdlbnRSZXN1bHQgPSB7XG4gICAgICAgIC4uLm1vY2tQYWdpbmF0ZWRSZXF1ZXN0cyxcbiAgICAgICAgcmVxdWVzdHM6IFt1cmdlbnRSZXF1ZXN0XSxcbiAgICAgIH07XG4gICAgICBtb2NrVGhlcmFwaXN0UmVxdWVzdFNlcnZpY2UuZ2V0VGhlcmFwaXN0UmVxdWVzdFN0YXRpc3RpY3MubW9ja1Jlc29sdmVkVmFsdWUobW9ja1N0YXRpc3RpY3MpO1xuICAgICAgbW9ja1RoZXJhcGlzdFJlcXVlc3RTZXJ2aWNlLmdldFRoZXJhcGlzdFJlcXVlc3RzXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UobW9ja1BhZ2luYXRlZFJlcXVlc3RzKVxuICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHVyZ2VudFJlc3VsdCk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0RGFzaGJvYXJkU3VtbWFyeShURVNUX1VTRVJfSURTLlRIRVJBUElTVCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuaGFzVXJnZW50UmVxdWVzdHMpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzZXJ2aWNlIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHNlcnZpY2VFcnJvciA9IG5ldyBFcnJvcignRGFzaGJvYXJkIHF1ZXJ5IGZhaWxlZCcpO1xuICAgICAgbW9ja1RoZXJhcGlzdFJlcXVlc3RTZXJ2aWNlLmdldFRoZXJhcGlzdFJlcXVlc3RTdGF0aXN0aWNzLm1vY2tSZWplY3RlZFZhbHVlKHNlcnZpY2VFcnJvcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5nZXREYXNoYm9hcmRTdW1tYXJ5KFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNUKSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KHNlcnZpY2VFcnJvcik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdHRVQgL3RoZXJhcGlzdC9yZXF1ZXN0cy9jbGllbnQvOmNsaWVudElkL2hpc3RvcnknLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBnZXQgY2xpZW50IHJlcXVlc3QgaGlzdG9yeSBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBoaXN0b3J5UmVzdWx0ID0ge1xuICAgICAgICAuLi5tb2NrUGFnaW5hdGVkUmVxdWVzdHMsXG4gICAgICAgIHJlcXVlc3RzOiBbbW9ja1JlcXVlc3QsIHsgLi4ubW9ja1JlcXVlc3QsIHN0YXR1czogJ0FDQ0VQVEVEJyB9XSxcbiAgICAgICAgcGFnaW5hdGlvbjogeyAuLi5tb2NrUGFnaW5hdGVkUmVxdWVzdHMucGFnaW5hdGlvbiwgdG90YWxDb3VudDogMiB9LFxuICAgICAgfTtcbiAgICAgIG1vY2tUaGVyYXBpc3RSZXF1ZXN0U2VydmljZS5nZXRUaGVyYXBpc3RSZXF1ZXN0cy5tb2NrUmVzb2x2ZWRWYWx1ZShoaXN0b3J5UmVzdWx0KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRDbGllbnRSZXF1ZXN0SGlzdG9yeShcbiAgICAgICAgdmFsaWRDbGllbnRJZCxcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5USEVSQVBJU1QsXG4gICAgICApO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgY2xpZW50SWQ6IHZhbGlkQ2xpZW50SWQsXG4gICAgICAgIHJlcXVlc3RIaXN0b3J5OiBbbW9ja1JlcXVlc3QsIHsgLi4ubW9ja1JlcXVlc3QsIHN0YXR1czogJ0FDQ0VQVEVEJyB9XSxcbiAgICAgICAgdG90YWxSZXF1ZXN0czogMixcbiAgICAgICAgaGFzQWN0aXZlUmVsYXRpb25zaGlwOiB0cnVlLFxuICAgICAgfSk7XG4gICAgICBleHBlY3QodGhlcmFwaXN0UmVxdWVzdFNlcnZpY2UuZ2V0VGhlcmFwaXN0UmVxdWVzdHMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBURVNUX1VTRVJfSURTLlRIRVJBUElTVCxcbiAgICAgICAge1xuICAgICAgICAgIGNsaWVudElkOiB2YWxpZENsaWVudElkLFxuICAgICAgICAgIHBhZ2U6IDEsXG4gICAgICAgICAgbGltaXQ6IDUwLFxuICAgICAgICAgIHNvcnRCeTogJ3JlcXVlc3RlZEF0JyxcbiAgICAgICAgICBzb3J0T3JkZXI6ICdkZXNjJyxcbiAgICAgICAgICBpbmNsdWRlRXhwaXJlZDogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIGNsaWVudCBJRCBmb3JtYXQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBpbnZhbGlkQ2xpZW50SWQgPSAnaW52YWxpZC1pZCc7XG5cbiAgICAgIGF3YWl0IFRlc3RBc3NlcnRpb25zLmV4cGVjdFRvVGhyb3dOZXN0RXhjZXB0aW9uKFxuICAgICAgICAoKSA9PiBjb250cm9sbGVyLmdldENsaWVudFJlcXVlc3RIaXN0b3J5KGludmFsaWRDbGllbnRJZCwgVEVTVF9VU0VSX0lEUy5USEVSQVBJU1QpLFxuICAgICAgICBCYWRSZXF1ZXN0RXhjZXB0aW9uLFxuICAgICAgICAnSW52YWxpZCBjbGllbnQgSUQgZm9ybWF0JyxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBubyByZXF1ZXN0IGhpc3RvcnknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBlbXB0eVJlc3VsdCA9IHtcbiAgICAgICAgLi4ubW9ja1BhZ2luYXRlZFJlcXVlc3RzLFxuICAgICAgICByZXF1ZXN0czogW10sXG4gICAgICAgIHBhZ2luYXRpb246IHsgLi4ubW9ja1BhZ2luYXRlZFJlcXVlc3RzLnBhZ2luYXRpb24sIHRvdGFsQ291bnQ6IDAgfSxcbiAgICAgIH07XG4gICAgICBtb2NrVGhlcmFwaXN0UmVxdWVzdFNlcnZpY2UuZ2V0VGhlcmFwaXN0UmVxdWVzdHMubW9ja1Jlc29sdmVkVmFsdWUoZW1wdHlSZXN1bHQpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldENsaWVudFJlcXVlc3RIaXN0b3J5KFxuICAgICAgICB2YWxpZENsaWVudElkLFxuICAgICAgICBURVNUX1VTRVJfSURTLlRIRVJBUElTVCxcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQucmVxdWVzdEhpc3RvcnkpLnRvRXF1YWwoW10pO1xuICAgICAgZXhwZWN0KHJlc3VsdC50b3RhbFJlcXVlc3RzKS50b0JlKDApO1xuICAgICAgZXhwZWN0KHJlc3VsdC5oYXNBY3RpdmVSZWxhdGlvbnNoaXApLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2VydmljZSBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBzZXJ2aWNlRXJyb3IgPSBuZXcgRXJyb3IoJ0hpc3RvcnkgcXVlcnkgZmFpbGVkJyk7XG4gICAgICBtb2NrVGhlcmFwaXN0UmVxdWVzdFNlcnZpY2UuZ2V0VGhlcmFwaXN0UmVxdWVzdHMubW9ja1JlamVjdGVkVmFsdWUoc2VydmljZUVycm9yKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLmdldENsaWVudFJlcXVlc3RIaXN0b3J5KHZhbGlkQ2xpZW50SWQsIFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNUKSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KHNlcnZpY2VFcnJvcik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdHRVQgL3RoZXJhcGlzdC9yZXF1ZXN0cy9maWx0ZXJzL29wdGlvbnMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBnZXQgZmlsdGVyIG9wdGlvbnMgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRGaWx0ZXJPcHRpb25zKFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNUKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIGZpbHRlck9wdGlvbnM6IHtcbiAgICAgICAgICBzdGF0dXNlczogWydQRU5ESU5HJywgJ0FDQ0VQVEVEJywgJ0RFQ0xJTkVEJywgJ0VYUElSRUQnLCAnQ0FOQ0VMTEVEJywgJ1dJVEhEUkFXTiddLFxuICAgICAgICAgIHByaW9yaXRpZXM6IFsnTE9XJywgJ05PUk1BTCcsICdISUdIJywgJ1VSR0VOVCddLFxuICAgICAgICAgIHNvcnRPcHRpb25zOiBbXG4gICAgICAgICAgICB7IHZhbHVlOiAncmVxdWVzdGVkQXQnLCBsYWJlbDogJ1JlcXVlc3QgRGF0ZScgfSxcbiAgICAgICAgICAgIHsgdmFsdWU6ICdyZXNwb25kZWRBdCcsIGxhYmVsOiAnUmVzcG9uc2UgRGF0ZScgfSxcbiAgICAgICAgICAgIHsgdmFsdWU6ICdwcmlvcml0eScsIGxhYmVsOiAnUHJpb3JpdHknIH0sXG4gICAgICAgICAgICB7IHZhbHVlOiAnc3RhdHVzJywgbGFiZWw6ICdTdGF0dXMnIH0sXG4gICAgICAgICAgXSxcbiAgICAgICAgICBzb3J0T3JkZXJzOiBbXG4gICAgICAgICAgICB7IHZhbHVlOiAnZGVzYycsIGxhYmVsOiAnTmV3ZXN0IEZpcnN0JyB9LFxuICAgICAgICAgICAgeyB2YWx1ZTogJ2FzYycsIGxhYmVsOiAnT2xkZXN0IEZpcnN0JyB9LFxuICAgICAgICAgIF0sXG4gICAgICAgICAgYnVsa0FjdGlvbnM6IFtcbiAgICAgICAgICAgIHsgdmFsdWU6ICdhY2NlcHQnLCBsYWJlbDogJ0FjY2VwdCBTZWxlY3RlZCcgfSxcbiAgICAgICAgICAgIHsgdmFsdWU6ICdkZWNsaW5lJywgbGFiZWw6ICdEZWNsaW5lIFNlbGVjdGVkJyB9LFxuICAgICAgICAgICAgeyB2YWx1ZTogJ21hcmtfcmV2aWV3ZWQnLCBsYWJlbDogJ01hcmsgYXMgUmV2aWV3ZWQnIH0sXG4gICAgICAgICAgXSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gY29uc2lzdGVudCBmaWx0ZXIgb3B0aW9ucycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdDEgPSBhd2FpdCBjb250cm9sbGVyLmdldEZpbHRlck9wdGlvbnMoVEVTVF9VU0VSX0lEUy5USEVSQVBJU1QpO1xuICAgICAgY29uc3QgcmVzdWx0MiA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0RmlsdGVyT3B0aW9ucygnYW5vdGhlci10aGVyYXBpc3QtaWQnKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdDEpLnRvRXF1YWwocmVzdWx0Mik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdHRVQgL3RoZXJhcGlzdC9yZXF1ZXN0cy9jb3VudC9wZW5kaW5nJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZ2V0IHBlbmRpbmcgY291bnQgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1RoZXJhcGlzdFJlcXVlc3RTZXJ2aWNlLmdldFRoZXJhcGlzdFJlcXVlc3RTdGF0aXN0aWNzLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tTdGF0aXN0aWNzKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRQZW5kaW5nQ291bnQoVEVTVF9VU0VSX0lEUy5USEVSQVBJU1QpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgcGVuZGluZ0NvdW50OiAzLFxuICAgICAgICB0b3RhbFJlY2VpdmVkOiAxMCxcbiAgICAgICAgbmVlZHNBdHRlbnRpb246IHRydWUsXG4gICAgICB9KTtcbiAgICAgIGV4cGVjdCh0aGVyYXBpc3RSZXF1ZXN0U2VydmljZS5nZXRUaGVyYXBpc3RSZXF1ZXN0U3RhdGlzdGljcykudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNULFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG5vIHBlbmRpbmcgcmVxdWVzdHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBub1BlbmRpbmdTdGF0cyA9IHsgLi4ubW9ja1N0YXRpc3RpY3MsIHBlbmRpbmc6IDAgfTtcbiAgICAgIG1vY2tUaGVyYXBpc3RSZXF1ZXN0U2VydmljZS5nZXRUaGVyYXBpc3RSZXF1ZXN0U3RhdGlzdGljcy5tb2NrUmVzb2x2ZWRWYWx1ZShub1BlbmRpbmdTdGF0cyk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0UGVuZGluZ0NvdW50KFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNUKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5wZW5kaW5nQ291bnQpLnRvQmUoMCk7XG4gICAgICBleHBlY3QocmVzdWx0Lm5lZWRzQXR0ZW50aW9uKS50b0JlKGZhbHNlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHNlcnZpY2UgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgc2VydmljZUVycm9yID0gbmV3IEVycm9yKCdTdGF0aXN0aWNzIGNhbGN1bGF0aW9uIGZhaWxlZCcpO1xuICAgICAgbW9ja1RoZXJhcGlzdFJlcXVlc3RTZXJ2aWNlLmdldFRoZXJhcGlzdFJlcXVlc3RTdGF0aXN0aWNzLm1vY2tSZWplY3RlZFZhbHVlKHNlcnZpY2VFcnJvcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5nZXRQZW5kaW5nQ291bnQoVEVTVF9VU0VSX0lEUy5USEVSQVBJU1QpLFxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coc2VydmljZUVycm9yKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0dFVCAvdGhlcmFwaXN0L3JlcXVlc3RzL2FuYWx5dGljcy9yZXNwb25zZS10aW1lJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZ2V0IHJlc3BvbnNlIHRpbWUgYW5hbHl0aWNzIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tUaGVyYXBpc3RSZXF1ZXN0U2VydmljZS5nZXRUaGVyYXBpc3RSZXF1ZXN0U3RhdGlzdGljcy5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrU3RhdGlzdGljcyk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0UmVzcG9uc2VUaW1lQW5hbHl0aWNzKFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNUKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIHJlc3BvbnNlVGltZUFuYWx5dGljczoge1xuICAgICAgICAgIGF2ZXJhZ2VIb3VyczogNC41LFxuICAgICAgICAgIHBlcmZvcm1hbmNlOiAnZ29vZCcsXG4gICAgICAgICAgYWNjZXB0YW5jZVJhdGU6IDcxLjQsXG4gICAgICAgICAgdG90YWxSZXNwb25kZWQ6IDcsXG4gICAgICAgIH0sXG4gICAgICAgIHJlY29tbWVuZGF0aW9uczogW1xuICAgICAgICAgIFwiWW91J3JlIGRvaW5nIGdyZWF0IHdpdGggYm90aCByZXNwb25zZSB0aW1lIGFuZCBhY2NlcHRhbmNlIHJhdGUhXCIsXG4gICAgICAgIF0sXG4gICAgICB9KTtcbiAgICAgIGV4cGVjdCh0aGVyYXBpc3RSZXF1ZXN0U2VydmljZS5nZXRUaGVyYXBpc3RSZXF1ZXN0U3RhdGlzdGljcykudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNULFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY2F0ZWdvcml6ZSByZXNwb25zZSB0aW1lIGFzIGV4Y2VsbGVudCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGV4Y2VsbGVudFN0YXRzID0geyAuLi5tb2NrU3RhdGlzdGljcywgYXZlcmFnZVJlc3BvbnNlVGltZTogMS41IH07XG4gICAgICBtb2NrVGhlcmFwaXN0UmVxdWVzdFNlcnZpY2UuZ2V0VGhlcmFwaXN0UmVxdWVzdFN0YXRpc3RpY3MubW9ja1Jlc29sdmVkVmFsdWUoZXhjZWxsZW50U3RhdHMpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldFJlc3BvbnNlVGltZUFuYWx5dGljcyhURVNUX1VTRVJfSURTLlRIRVJBUElTVCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQucmVzcG9uc2VUaW1lQW5hbHl0aWNzLnBlcmZvcm1hbmNlKS50b0JlKCdleGNlbGxlbnQnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY2F0ZWdvcml6ZSByZXNwb25zZSB0aW1lIGFzIG5lZWRzIGltcHJvdmVtZW50JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcG9vclN0YXRzID0geyAuLi5tb2NrU3RhdGlzdGljcywgYXZlcmFnZVJlc3BvbnNlVGltZTogNDgsIGFjY2VwdGFuY2VSYXRlOiAyMCB9O1xuICAgICAgbW9ja1RoZXJhcGlzdFJlcXVlc3RTZXJ2aWNlLmdldFRoZXJhcGlzdFJlcXVlc3RTdGF0aXN0aWNzLm1vY2tSZXNvbHZlZFZhbHVlKHBvb3JTdGF0cyk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0UmVzcG9uc2VUaW1lQW5hbHl0aWNzKFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNUKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5yZXNwb25zZVRpbWVBbmFseXRpY3MucGVyZm9ybWFuY2UpLnRvQmUoJ25lZWRzX2ltcHJvdmVtZW50Jyk7XG4gICAgICBleHBlY3QocmVzdWx0LnJlY29tbWVuZGF0aW9ucykudG9Db250YWluKFxuICAgICAgICAnQ29uc2lkZXIgcmVzcG9uZGluZyB0byBjbGllbnQgcmVxdWVzdHMgd2l0aGluIDI0IGhvdXJzIGZvciBiZXR0ZXIgY2xpZW50IGV4cGVyaWVuY2UnLFxuICAgICAgKTtcbiAgICAgIGV4cGVjdChyZXN1bHQucmVjb21tZW5kYXRpb25zKS50b0NvbnRhaW4oXG4gICAgICAgICdZb3VyIGFjY2VwdGFuY2UgcmF0ZSBpcyBsb3cuIENvbnNpZGVyIHJldmlld2luZyB5b3VyIGF2YWlsYWJpbGl0eSBhbmQgY2xpZW50IHByZWZlcmVuY2VzJyxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzZXJ2aWNlIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHNlcnZpY2VFcnJvciA9IG5ldyBFcnJvcignQW5hbHl0aWNzIGNhbGN1bGF0aW9uIGZhaWxlZCcpO1xuICAgICAgbW9ja1RoZXJhcGlzdFJlcXVlc3RTZXJ2aWNlLmdldFRoZXJhcGlzdFJlcXVlc3RTdGF0aXN0aWNzLm1vY2tSZWplY3RlZFZhbHVlKHNlcnZpY2VFcnJvcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5nZXRSZXNwb25zZVRpbWVBbmFseXRpY3MoVEVTVF9VU0VSX0lEUy5USEVSQVBJU1QpLFxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coc2VydmljZUVycm9yKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0hlbHBlciBNZXRob2RzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgY2F0ZWdvcml6ZSByZXNwb25zZSB0aW1lIGNvcnJlY3RseScsICgpID0+IHtcbiAgICAgIGV4cGVjdCgoY29udHJvbGxlciBhcyBhbnkpLmNhdGVnb3JpemVSZXNwb25zZVRpbWUoMSkpLnRvQmUoJ2V4Y2VsbGVudCcpO1xuICAgICAgZXhwZWN0KChjb250cm9sbGVyIGFzIGFueSkuY2F0ZWdvcml6ZVJlc3BvbnNlVGltZSg0KSkudG9CZSgnZ29vZCcpO1xuICAgICAgZXhwZWN0KChjb250cm9sbGVyIGFzIGFueSkuY2F0ZWdvcml6ZVJlc3BvbnNlVGltZSgxMikpLnRvQmUoJ2ZhaXInKTtcbiAgICAgIGV4cGVjdCgoY29udHJvbGxlciBhcyBhbnkpLmNhdGVnb3JpemVSZXNwb25zZVRpbWUoNDgpKS50b0JlKCduZWVkc19pbXByb3ZlbWVudCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBnZW5lcmF0ZSBhcHByb3ByaWF0ZSByZWNvbW1lbmRhdGlvbnMnLCAoKSA9PiB7XG4gICAgICBjb25zdCByZWNvbW1lbmRhdGlvbnMxID0gKGNvbnRyb2xsZXIgYXMgYW55KS5nZXRSZXNwb25zZVRpbWVSZWNvbW1lbmRhdGlvbnMoMiwgODUpO1xuICAgICAgZXhwZWN0KHJlY29tbWVuZGF0aW9uczEpLnRvQ29udGFpbihcIkV4Y2VsbGVudCBhY2NlcHRhbmNlIHJhdGUhIFlvdSdyZSBwcm92aWRpbmcgZ3JlYXQgYWNjZXNzaWJpbGl0eSB0byBjbGllbnRzXCIpO1xuICAgICAgZXhwZWN0KHJlY29tbWVuZGF0aW9uczEpLnRvQ29udGFpbihcIllvdSdyZSBkb2luZyBncmVhdCB3aXRoIGJvdGggcmVzcG9uc2UgdGltZSBhbmQgYWNjZXB0YW5jZSByYXRlIVwiKTtcblxuICAgICAgY29uc3QgcmVjb21tZW5kYXRpb25zMiA9IChjb250cm9sbGVyIGFzIGFueSkuZ2V0UmVzcG9uc2VUaW1lUmVjb21tZW5kYXRpb25zKDQ4LCAyMCk7XG4gICAgICBleHBlY3QocmVjb21tZW5kYXRpb25zMikudG9Db250YWluKCdDb25zaWRlciByZXNwb25kaW5nIHRvIGNsaWVudCByZXF1ZXN0cyB3aXRoaW4gMjQgaG91cnMgZm9yIGJldHRlciBjbGllbnQgZXhwZXJpZW5jZScpO1xuICAgICAgZXhwZWN0KHJlY29tbWVuZGF0aW9uczIpLnRvQ29udGFpbignWW91ciBhY2NlcHRhbmNlIHJhdGUgaXMgbG93LiBDb25zaWRlciByZXZpZXdpbmcgeW91ciBhdmFpbGFiaWxpdHkgYW5kIGNsaWVudCBwcmVmZXJlbmNlcycpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnSW50ZWdyYXRpb24gVGVzdGluZycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBjb21wbGV0ZSByZXF1ZXN0IG1hbmFnZW1lbnQgd29ya2Zsb3cnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBTdGVwIDE6IEdldCBwZW5kaW5nIHJlcXVlc3RzXG4gICAgICBtb2NrVGhlcmFwaXN0UmVxdWVzdFNlcnZpY2UuZ2V0VGhlcmFwaXN0UmVxdWVzdHMubW9ja1Jlc29sdmVkVmFsdWUobW9ja1BhZ2luYXRlZFJlcXVlc3RzKTtcbiAgICAgIGNvbnN0IHBlbmRpbmdSZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldFBlbmRpbmdSZXF1ZXN0cyhURVNUX1VTRVJfSURTLlRIRVJBUElTVCk7XG4gICAgICBleHBlY3QocGVuZGluZ1Jlc3VsdC50b3RhbFBlbmRpbmcpLnRvQmUoMSk7XG5cbiAgICAgIC8vIFN0ZXAgMjogR2V0IHJlcXVlc3QgZGV0YWlsc1xuICAgICAgY29uc3QgZGV0YWlsc1Jlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0UmVxdWVzdERldGFpbHModmFsaWRSZXF1ZXN0SWQsIFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNUKTtcbiAgICAgIGV4cGVjdChkZXRhaWxzUmVzdWx0LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG5cbiAgICAgIC8vIFN0ZXAgMzogQWNjZXB0IHJlcXVlc3RcbiAgICAgIGNvbnN0IGFjY2VwdFJlc3VsdCA9IHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgbWVzc2FnZTogJ1JlcXVlc3QgYWNjZXB0ZWQgc3VjY2Vzc2Z1bGx5JyxcbiAgICAgICAgcmVxdWVzdDogeyAuLi5tb2NrUmVxdWVzdCwgc3RhdHVzOiAnQUNDRVBURUQnIH0sXG4gICAgICB9O1xuICAgICAgbW9ja1RoZXJhcGlzdFJlcXVlc3RTZXJ2aWNlLmFjY2VwdENsaWVudFJlcXVlc3QubW9ja1Jlc29sdmVkVmFsdWUoYWNjZXB0UmVzdWx0KTtcbiAgICAgIGNvbnN0IGFjY2VwdGVkUmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5hY2NlcHRSZXF1ZXN0KFxuICAgICAgICB2YWxpZFJlcXVlc3RJZCxcbiAgICAgICAgeyBtZXNzYWdlOiAnSSB3b3VsZCBiZSBoYXBweSB0byB3b3JrIHdpdGggeW91JyB9LFxuICAgICAgICBURVNUX1VTRVJfSURTLlRIRVJBUElTVCxcbiAgICAgICk7XG4gICAgICBleHBlY3QoYWNjZXB0ZWRSZXN1bHQpLnRvRXF1YWwoYWNjZXB0UmVzdWx0KTtcblxuICAgICAgLy8gU3RlcCA0OiBDaGVjayBzdGF0aXN0aWNzXG4gICAgICBtb2NrVGhlcmFwaXN0UmVxdWVzdFNlcnZpY2UuZ2V0VGhlcmFwaXN0UmVxdWVzdFN0YXRpc3RpY3MubW9ja1Jlc29sdmVkVmFsdWUobW9ja1N0YXRpc3RpY3MpO1xuICAgICAgY29uc3Qgc3RhdHNSZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldFJlcXVlc3RTdGF0aXN0aWNzKFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNUKTtcbiAgICAgIGV4cGVjdChzdGF0c1Jlc3VsdCkudG9FcXVhbChtb2NrU3RhdGlzdGljcyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBidWxrIGFjdGlvbiB3b3JrZmxvdycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFN0ZXAgMTogR2V0IHBlbmRpbmcgcmVxdWVzdHNcbiAgICAgIG1vY2tUaGVyYXBpc3RSZXF1ZXN0U2VydmljZS5nZXRUaGVyYXBpc3RSZXF1ZXN0cy5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUGFnaW5hdGVkUmVxdWVzdHMpO1xuICAgICAgY29uc3QgcGVuZGluZ1Jlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0UGVuZGluZ1JlcXVlc3RzKFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNUKTtcbiAgICAgIGV4cGVjdChwZW5kaW5nUmVzdWx0LnRvdGFsUGVuZGluZykudG9CZSgxKTtcblxuICAgICAgLy8gU3RlcCAyOiBQZXJmb3JtIGJ1bGsgYWN0aW9uXG4gICAgICBjb25zdCBidWxrUmVzdWx0ID0ge1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBwcm9jZXNzZWRDb3VudDogMixcbiAgICAgICAgZmFpbGVkQ291bnQ6IDAsXG4gICAgICAgIHJlc3VsdHM6IFtcbiAgICAgICAgICB7IHJlcXVlc3RJZDogdmFsaWRSZXF1ZXN0SWQsIHN0YXR1czogJ0FDQ0VQVEVEJyB9LFxuICAgICAgICAgIHsgcmVxdWVzdElkOiAnMTExMTExMTEtMjIyMi0zMzMzLTQ0NDQtNTU1NTU1NTU1NTU1Jywgc3RhdHVzOiAnQUNDRVBURUQnIH0sXG4gICAgICAgIF0sXG4gICAgICB9O1xuICAgICAgbW9ja1RoZXJhcGlzdFJlcXVlc3RTZXJ2aWNlLnBlcmZvcm1CdWxrQWN0aW9uLm1vY2tSZXNvbHZlZFZhbHVlKGJ1bGtSZXN1bHQpO1xuICAgICAgY29uc3QgYnVsa0FjdGlvblJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIucGVyZm9ybUJ1bGtBY3Rpb24oXG4gICAgICAgIHtcbiAgICAgICAgICBhY3Rpb246ICdhY2NlcHQnLFxuICAgICAgICAgIHJlcXVlc3RJZHM6IFt2YWxpZFJlcXVlc3RJZCwgJzExMTExMTExLTIyMjItMzMzMy00NDQ0LTU1NTU1NTU1NTU1NSddLFxuICAgICAgICAgIG1lc3NhZ2U6ICdCdWxrIGFjY2VwdGFuY2UnLFxuICAgICAgICB9LFxuICAgICAgICBURVNUX1VTRVJfSURTLlRIRVJBUElTVCxcbiAgICAgICk7XG4gICAgICBleHBlY3QoYnVsa0FjdGlvblJlc3VsdCkudG9FcXVhbChidWxrUmVzdWx0KTtcblxuICAgICAgLy8gU3RlcCAzOiBDaGVjayB1cGRhdGVkIHN0YXRpc3RpY3NcbiAgICAgIG1vY2tUaGVyYXBpc3RSZXF1ZXN0U2VydmljZS5nZXRUaGVyYXBpc3RSZXF1ZXN0U3RhdGlzdGljcy5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrU3RhdGlzdGljcyk7XG4gICAgICBjb25zdCBzdGF0c1Jlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0UmVxdWVzdFN0YXRpc3RpY3MoVEVTVF9VU0VSX0lEUy5USEVSQVBJU1QpO1xuICAgICAgZXhwZWN0KHN0YXRzUmVzdWx0KS50b0VxdWFsKG1vY2tTdGF0aXN0aWNzKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0Vycm9yIEhhbmRsaW5nJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIHNlcnZpY2UgdW5hdmFpbGFibGUgc2NlbmFyaW9zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgc2VydmljZUVycm9yID0gbmV3IEVycm9yKCdTZXJ2aWNlIHRlbXBvcmFyaWx5IHVuYXZhaWxhYmxlJyk7XG4gICAgICBtb2NrVGhlcmFwaXN0UmVxdWVzdFNlcnZpY2UuZ2V0VGhlcmFwaXN0UmVxdWVzdHMubW9ja1JlamVjdGVkVmFsdWUoc2VydmljZUVycm9yKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLmdldENsaWVudFJlcXVlc3RzKHsgcGFnZTogMSwgbGltaXQ6IDEwIH0sIFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNUKSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KHNlcnZpY2VFcnJvcik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBjb25jdXJyZW50IGFjY2VzcyBpc3N1ZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBjb25jdXJyZW5jeUVycm9yID0gbmV3IEVycm9yKCdSZXNvdXJjZSBpcyBsb2NrZWQnKTtcbiAgICAgIG1vY2tUaGVyYXBpc3RSZXF1ZXN0U2VydmljZS5hY2NlcHRDbGllbnRSZXF1ZXN0Lm1vY2tSZWplY3RlZFZhbHVlKGNvbmN1cnJlbmN5RXJyb3IpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIuYWNjZXB0UmVxdWVzdChcbiAgICAgICAgICB2YWxpZFJlcXVlc3RJZCxcbiAgICAgICAgICB7IG1lc3NhZ2U6ICdBY2NlcHQgbWVzc2FnZScgfSxcbiAgICAgICAgICBURVNUX1VTRVJfSURTLlRIRVJBUElTVCxcbiAgICAgICAgKSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KGNvbmN1cnJlbmN5RXJyb3IpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbWFsZm9ybWVkIHJlcXVlc3QgZGF0YScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1hbGZvcm1lZEZpbHRlcnMgPSB7IGludmFsaWQ6ICdkYXRhJyB9O1xuICAgICAgbW9ja1RoZXJhcGlzdFJlcXVlc3RTZXJ2aWNlLmdldFRoZXJhcGlzdFJlcXVlc3RzLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tQYWdpbmF0ZWRSZXF1ZXN0cyk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0Q2xpZW50UmVxdWVzdHMobWFsZm9ybWVkRmlsdGVycyBhcyBhbnksIFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNUKTtcblxuICAgICAgZXhwZWN0KHRoZXJhcGlzdFJlcXVlc3RTZXJ2aWNlLmdldFRoZXJhcGlzdFJlcXVlc3RzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5USEVSQVBJU1QsXG4gICAgICAgIG1hbGZvcm1lZEZpbHRlcnMsXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUmVzcG9uc2UgRm9ybWF0IFZhbGlkYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gcHJvcGVybHkgZm9ybWF0dGVkIHJlcXVlc3QgcmVzcG9uc2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrVGhlcmFwaXN0UmVxdWVzdFNlcnZpY2UuZ2V0VGhlcmFwaXN0UmVxdWVzdHMubW9ja1Jlc29sdmVkVmFsdWUobW9ja1BhZ2luYXRlZFJlcXVlc3RzKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRDbGllbnRSZXF1ZXN0cyh7IHBhZ2U6IDEsIGxpbWl0OiAxMCB9LCBURVNUX1VTRVJfSURTLlRIRVJBUElTVCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdyZXF1ZXN0cycpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ3BhZ2luYXRpb24nKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdzdW1tYXJ5Jyk7XG4gICAgICBleHBlY3QoQXJyYXkuaXNBcnJheShyZXN1bHQucmVxdWVzdHMpKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHR5cGVvZiByZXN1bHQucGFnaW5hdGlvbi50b3RhbENvdW50KS50b0JlKCdudW1iZXInKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIHByb3Blcmx5IGZvcm1hdHRlZCBzdGF0aXN0aWNzIHJlc3BvbnNlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1RoZXJhcGlzdFJlcXVlc3RTZXJ2aWNlLmdldFRoZXJhcGlzdFJlcXVlc3RTdGF0aXN0aWNzLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tTdGF0aXN0aWNzKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRSZXF1ZXN0U3RhdGlzdGljcyhURVNUX1VTRVJfSURTLlRIRVJBUElTVCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCd0b3RhbFJlY2VpdmVkJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgncGVuZGluZycpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ2FjY2VwdGVkJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgnZGVjbGluZWQnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdhdmVyYWdlUmVzcG9uc2VUaW1lJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgnYWNjZXB0YW5jZVJhdGUnKTtcbiAgICAgIGV4cGVjdCh0eXBlb2YgcmVzdWx0LnRvdGFsUmVjZWl2ZWQpLnRvQmUoJ251bWJlcicpO1xuICAgICAgZXhwZWN0KHR5cGVvZiByZXN1bHQuYXZlcmFnZVJlc3BvbnNlVGltZSkudG9CZSgnbnVtYmVyJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBwcm9wZXJseSBmb3JtYXR0ZWQgc3VjY2VzcyByZXNwb25zZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrVGhlcmFwaXN0UmVxdWVzdFNlcnZpY2UuZ2V0VGhlcmFwaXN0UmVxdWVzdHMubW9ja1Jlc29sdmVkVmFsdWUobW9ja1BhZ2luYXRlZFJlcXVlc3RzKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRSZWNlbnRSZXF1ZXN0cyhURVNUX1VTRVJfSURTLlRIRVJBUElTVCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdzdWNjZXNzJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgncmVjZW50UmVxdWVzdHMnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdoYXNNb3JlJyk7XG4gICAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QoQXJyYXkuaXNBcnJheShyZXN1bHQucmVjZW50UmVxdWVzdHMpKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHR5cGVvZiByZXN1bHQuaGFzTW9yZSkudG9CZSgnYm9vbGVhbicpO1xuICAgIH0pO1xuICB9KTtcbn0pOyJdLCJ2ZXJzaW9uIjozfQ==