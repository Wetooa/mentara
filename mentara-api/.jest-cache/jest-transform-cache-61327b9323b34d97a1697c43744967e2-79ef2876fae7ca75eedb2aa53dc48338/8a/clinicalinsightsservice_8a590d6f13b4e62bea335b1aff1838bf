a7eac2dbe0647e70f49d4c890cacf729
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var ClinicalInsightsService_1;
Object.defineProperty(exports, "__esModule", { value: true });
exports.ClinicalInsightsService = void 0;
const common_1 = require("@nestjs/common");
const pre_assessment_utils_1 = require("../pre-assessment.utils");
let ClinicalInsightsService = ClinicalInsightsService_1 = class ClinicalInsightsService {
    logger = new common_1.Logger(ClinicalInsightsService_1.name);
    /**
     * Generate comprehensive clinical insights from pre-assessment data
     * This is the main analysis function that combines traditional scoring with AI predictions
     */
    async generateClinicalProfile(preAssessment, questionnaires, scores) {
        this.logger.log('Generating comprehensive clinical profile');
        try {
            // Extract and validate core data
            const severityLevels = this.extractSeverityLevels(preAssessment);
            const aiPredictions = this.extractAiPredictions(preAssessment);
            // Generate detailed insights for each condition
            const clinicalInsights = this.generateConditionInsights(questionnaires, scores, severityLevels, aiPredictions);
            // Categorize conditions by clinical priority
            const { primaryConditions, secondaryConditions } = this.categorizeConditions(clinicalInsights);
            // Assess risk factors for immediate intervention needs
            const riskFactors = this.assessRiskFactors(clinicalInsights, scores);
            // Determine overall risk level and treatment urgency
            const overallRiskLevel = this.calculateOverallRiskLevel(riskFactors, primaryConditions);
            // Generate therapeutic priorities and treatment plan
            const therapeuticPriorities = this.generateTherapeuticPriorities(primaryConditions);
            const treatmentRecommendations = this.generateTreatmentRecommendations(primaryConditions, secondaryConditions, riskFactors);
            // Create clinical summary
            const summary = this.generateClinicalSummary(primaryConditions, secondaryConditions, overallRiskLevel);
            return {
                primaryConditions,
                secondaryConditions,
                riskFactors,
                overallRiskLevel,
                therapeuticPriorities,
                treatmentRecommendations,
                summary,
            };
        }
        catch (error) {
            this.logger.error('Error generating clinical profile:', error);
            throw new Error('Failed to generate clinical insights');
        }
    }
    /**
     * Extract and validate severity levels from pre-assessment
     */
    extractSeverityLevels(preAssessment) {
        try {
            // Access severityLevels from the dedicated field
            const severityLevels = preAssessment.severityLevels;
            if (severityLevels && typeof severityLevels === 'object') {
                return severityLevels;
            }
            // Fallback: If severityLevels is empty, calculate from answers array
            const answers = preAssessment.answers;
            if (Array.isArray(answers) && answers.length === 201) {
                const { severityLevels: calculatedLevels } = this.processAnswersArray(answers);
                return calculatedLevels;
            }
            this.logger.warn('No severity levels data available, using empty object');
            return {};
        }
        catch (error) {
            this.logger.error('Error extracting severity levels:', error);
            return {};
        }
    }
    /**
     * Extract and validate AI predictions from pre-assessment
     */
    extractAiPredictions(preAssessment) {
        try {
            // Access aiEstimate from the dedicated field
            const aiEstimate = preAssessment.aiEstimate;
            if (aiEstimate && typeof aiEstimate === 'object') {
                return aiEstimate;
            }
            this.logger.warn('No valid AI predictions available');
            return {};
        }
        catch (error) {
            this.logger.error('Error extracting AI predictions:', error);
            return {};
        }
    }
    /**
     * Process flat answers array using utility functions
     */
    processAnswersArray(answers) {
        try {
            return (0, pre_assessment_utils_1.processPreAssessmentAnswers)(answers);
        }
        catch (error) {
            this.logger.error('Error processing answers array:', error);
            return { scores: {}, severityLevels: {} };
        }
    }
    /**
     * Generate detailed clinical insights for each assessed condition
     */
    generateConditionInsights(questionnaires, scores, severityLevels, aiPredictions) {
        const insights = [];
        for (const questionnaire of questionnaires) {
            const scoreData = scores[questionnaire];
            if (!scoreData) {
                this.logger.debug(`No score data available for questionnaire: ${questionnaire}`);
                continue;
            }
            // Validate score data structure
            if (typeof scoreData.score !== 'number' || !scoreData.severity) {
                this.logger.warn(`Invalid score data for ${questionnaire}:`, scoreData);
                continue;
            }
            const insight = this.createConditionInsight(questionnaire, scoreData, severityLevels[questionnaire], aiPredictions);
            if (insight) {
                insights.push(insight);
                this.logger.debug(`Generated insight for ${questionnaire} with priority ${insight.priority}`);
            }
            else {
                this.logger.warn(`Failed to create insight for questionnaire: ${questionnaire}`);
            }
        }
        return insights.sort((a, b) => b.priority - a.priority);
    }
    /**
     * Create detailed clinical insight for a specific condition
     */
    createConditionInsight(condition, scoreData, severityLevel, aiPredictions) {
        try {
            const clinicalLevel = this.mapToClinicalLevel(severityLevel);
            const confidence = this.calculateConfidence(scoreData.score, condition, aiPredictions);
            const riskLevel = this.assessConditionRisk(condition, clinicalLevel, scoreData.score);
            const priority = this.calculatePriority(condition, clinicalLevel, riskLevel);
            const keyIndicators = this.getKeyIndicators(condition, scoreData.score, clinicalLevel);
            const therapeuticFocus = this.getTherapeuticFocus(condition, clinicalLevel);
            const recommendations = this.getConditionRecommendations(condition, clinicalLevel, riskLevel);
            return {
                condition,
                severity: severityLevel || 'Unknown',
                score: scoreData.score,
                clinicalLevel,
                confidence,
                riskLevel,
                priority,
                keyIndicators,
                therapeuticFocus,
                recommendations,
            };
        }
        catch (error) {
            this.logger.error(`Error creating insight for ${condition}:`, error);
            return null;
        }
    }
    /**
     * Map severity labels to standardized clinical levels
     */
    mapToClinicalLevel(severity) {
        if (!severity)
            return 'subclinical';
        const lowerSeverity = severity.toLowerCase();
        if (lowerSeverity.includes('extreme') ||
            lowerSeverity.includes('very severe')) {
            return 'extreme';
        }
        if (lowerSeverity.includes('severe')) {
            return 'severe';
        }
        if (lowerSeverity.includes('moderate')) {
            return 'moderate';
        }
        if (lowerSeverity.includes('mild')) {
            return 'mild';
        }
        return 'subclinical';
    }
    /**
     * Calculate confidence level based on score consistency and AI validation
     */
    calculateConfidence(score, condition, aiPredictions) {
        let confidence = 70; // Base confidence
        // Adjust based on score magnitude (higher scores = higher confidence)
        if (score > 20)
            confidence += 20;
        else if (score > 10)
            confidence += 10;
        else if (score < 5)
            confidence -= 20;
        // Validate against AI predictions if available
        const aiKey = this.mapConditionToAiKey(condition);
        if (aiKey && aiPredictions[aiKey] !== undefined) {
            const aiPositive = aiPredictions[aiKey];
            const scorePositive = score > 10; // Threshold varies by condition
            if (aiPositive === scorePositive) {
                confidence += 15; // AI and traditional scoring agree
            }
            else {
                confidence -= 10; // Disagreement between methods
            }
        }
        return Math.max(10, Math.min(100, confidence));
    }
    /**
     * Map condition names to AI prediction keys
     */
    mapConditionToAiKey(condition) {
        const mappings = {
            Depression: 'Has_Depression',
            Anxiety: 'Has_Anxiety',
            PTSD: 'Has_PTSD',
            'Post-traumatic stress disorder (PTSD)': 'Has_PTSD',
            'Bipolar disorder (BD)': 'Has_Bipolar',
            'Obsessive compulsive disorder (OCD)': 'Has_OCD',
            'ADD / ADHD': 'Has_ADHD',
            'Social anxiety': 'Has_Social_Anxiety',
            Panic: 'Has_Panic_Disorder',
            Phobia: 'Has_Phobias',
            'Substance or Alcohol Use Issues': 'Has_Substance_Use',
            'Binge eating / Eating disorders': 'Has_Eating_Disorder',
        };
        return mappings[condition] || null;
    }
    /**
     * Assess risk level for a specific condition
     */
    assessConditionRisk(condition, clinicalLevel, score) {
        // High-risk conditions that require immediate attention
        const highRiskConditions = [
            'Depression',
            'Bipolar disorder (BD)',
            'Post-traumatic stress disorder (PTSD)',
            'Substance or Alcohol Use Issues',
        ];
        if (clinicalLevel === 'extreme')
            return 'critical';
        if (clinicalLevel === 'severe') {
            return highRiskConditions.includes(condition) ? 'critical' : 'high';
        }
        if (clinicalLevel === 'moderate')
            return 'moderate';
        return 'low';
    }
    /**
     * Calculate treatment priority (1-10 scale)
     */
    calculatePriority(condition, clinicalLevel, riskLevel) {
        let priority = 1;
        // Base priority by clinical level
        const levelPriorities = {
            extreme: 10,
            severe: 8,
            moderate: 6,
            mild: 4,
            subclinical: 2,
        };
        priority = levelPriorities[clinicalLevel] || 1;
        // Adjust for condition-specific factors
        const highPriorityConditions = [
            'Depression',
            'Bipolar disorder (BD)',
            'Post-traumatic stress disorder (PTSD)',
            'Substance or Alcohol Use Issues',
        ];
        if (highPriorityConditions.includes(condition)) {
            priority += 1;
        }
        // Risk level adjustments
        if (riskLevel === 'critical')
            priority = 10;
        else if (riskLevel === 'high')
            priority = Math.max(priority, 8);
        return Math.max(1, Math.min(10, priority));
    }
    /**
     * Get key clinical indicators for a condition
     */
    getKeyIndicators(condition, score, clinicalLevel) {
        const indicators = {
            Depression: [
                'Persistent low mood and sadness',
                'Loss of interest in previously enjoyed activities',
                'Fatigue and decreased energy',
                'Sleep disturbances',
                'Appetite changes',
                'Feelings of worthlessness or guilt',
                'Difficulty concentrating',
                'Psychomotor agitation or retardation',
            ],
            Anxiety: [
                'Excessive worry and apprehension',
                'Restlessness and feeling on edge',
                'Difficulty concentrating',
                'Irritability',
                'Muscle tension',
                'Sleep difficulties',
                'Fatigue from worry',
            ],
            'Post-traumatic stress disorder (PTSD)': [
                'Re-experiencing traumatic events',
                'Avoidance of trauma-related stimuli',
                'Negative alterations in mood and cognition',
                'Hypervigilance and exaggerated startle response',
                'Sleep disturbances and nightmares',
                'Emotional numbing',
                'Intrusive thoughts and flashbacks',
            ],
            'Bipolar disorder (BD)': [
                'Mood episodes (manic or depressive)',
                'Elevated or irritable mood',
                'Decreased need for sleep during episodes',
                'Racing thoughts and pressured speech',
                'Grandiosity or inflated self-esteem',
                'Distractibility',
                'Increased goal-directed activity',
            ],
        };
        const baseIndicators = indicators[condition] || [
            `Elevated ${condition.toLowerCase()} symptoms`,
            'Functional impairment in daily activities',
            'Distress related to symptoms',
        ];
        // Filter indicators based on severity
        if (clinicalLevel === 'mild')
            return baseIndicators.slice(0, 3);
        if (clinicalLevel === 'moderate')
            return baseIndicators.slice(0, 5);
        return baseIndicators;
    }
    /**
     * Get therapeutic focus areas for a condition
     */
    getTherapeuticFocus(condition, clinicalLevel) {
        const focusAreas = {
            Depression: [
                'Cognitive restructuring and thought challenging',
                'Behavioral activation and activity scheduling',
                'Mood monitoring and regulation',
                'Social support and interpersonal skills',
            ],
            Anxiety: [
                'Anxiety management techniques',
                'Exposure therapy for specific fears',
                'Relaxation and mindfulness training',
                'Cognitive restructuring for worry',
            ],
            'Post-traumatic stress disorder (PTSD)': [
                'Trauma processing and integration',
                'EMDR or trauma-focused therapy',
                'Coping skills for triggers',
                'Safety and stabilization',
            ],
            'Bipolar disorder (BD)': [
                'Mood stabilization techniques',
                'Medication adherence support',
                'Trigger identification and management',
                'Psychoeducation about bipolar disorder',
            ],
        };
        return (focusAreas[condition] || [
            'Symptom management',
            'Coping strategies development',
            'Functional improvement',
        ]);
    }
    /**
     * Get specific recommendations for a condition
     */
    getConditionRecommendations(condition, clinicalLevel, riskLevel) {
        const recommendations = [];
        // Urgency-based recommendations
        if (riskLevel === 'critical' || clinicalLevel === 'extreme') {
            recommendations.push('Immediate psychiatric evaluation recommended');
            recommendations.push('Consider crisis intervention services');
        }
        // Condition-specific recommendations
        const conditionRecs = {
            Depression: [
                'Cognitive Behavioral Therapy (CBT) strongly recommended',
                'Consider medication evaluation with psychiatrist',
                'Regular mood monitoring and safety planning',
            ],
            Anxiety: [
                'CBT or Acceptance and Commitment Therapy (ACT)',
                'Mindfulness and relaxation training',
                'Gradual exposure to anxiety triggers',
            ],
            'Post-traumatic stress disorder (PTSD)': [
                'Trauma-focused therapy (EMDR, CPT, or PE)',
                'Specialized PTSD treatment program',
                'Safety planning and stabilization first',
            ],
        };
        recommendations.push(...(conditionRecs[condition] || [
            'Evidence-based psychotherapy',
            'Regular monitoring of symptoms',
            'Psychoeducation about the condition',
        ]));
        return recommendations;
    }
    /**
     * Categorize conditions into primary and secondary based on severity and risk
     */
    categorizeConditions(insights) {
        const primaryConditions = insights.filter((insight) => insight.priority >= 7 ||
            insight.riskLevel === 'critical' ||
            insight.riskLevel === 'high');
        const secondaryConditions = insights.filter((insight) => insight.priority < 7 &&
            insight.riskLevel !== 'critical' &&
            insight.riskLevel !== 'high');
        return { primaryConditions, secondaryConditions };
    }
    /**
     * Assess overall risk factors requiring immediate attention
     */
    assessRiskFactors(insights, scores) {
        const riskFactors = [];
        // Check for suicide/self-harm risk
        const depressionInsight = insights.find((i) => i.condition === 'Depression');
        if (depressionInsight &&
            (depressionInsight.clinicalLevel === 'severe' ||
                depressionInsight.clinicalLevel === 'extreme')) {
            riskFactors.push({
                type: 'suicide',
                level: depressionInsight.clinicalLevel === 'extreme' ? 'critical' : 'high',
                indicators: [
                    'Severe depression symptoms',
                    'High risk for suicidal ideation',
                ],
                urgency: depressionInsight.clinicalLevel === 'extreme'
                    ? 'immediate'
                    : 'within_week',
            });
        }
        // Check for substance abuse risk
        const substanceInsight = insights.find((i) => i.condition.includes('Substance') || i.condition.includes('Alcohol'));
        if (substanceInsight && substanceInsight.clinicalLevel !== 'subclinical') {
            riskFactors.push({
                type: 'substance_abuse',
                level: substanceInsight.riskLevel,
                indicators: [
                    'Problematic substance use patterns',
                    'Risk for dependence',
                ],
                urgency: substanceInsight.riskLevel === 'critical'
                    ? 'immediate'
                    : 'within_month',
            });
        }
        // Check for mania risk (bipolar)
        const bipolarInsight = insights.find((i) => i.condition.includes('Bipolar'));
        if (bipolarInsight &&
            (bipolarInsight.clinicalLevel === 'severe' ||
                bipolarInsight.clinicalLevel === 'extreme')) {
            riskFactors.push({
                type: 'mania',
                level: 'high',
                indicators: ['Manic episode indicators', 'Mood instability'],
                urgency: 'within_week',
            });
        }
        return riskFactors;
    }
    /**
     * Calculate overall risk level based on all factors
     */
    calculateOverallRiskLevel(riskFactors, primaryConditions) {
        // Check for critical risk factors
        if (riskFactors.some((rf) => rf.level === 'critical') ||
            primaryConditions.some((pc) => pc.riskLevel === 'critical')) {
            return 'critical';
        }
        // Check for high risk
        if (riskFactors.some((rf) => rf.level === 'high') ||
            primaryConditions.some((pc) => pc.riskLevel === 'high')) {
            return 'high';
        }
        // Check for moderate risk
        if (primaryConditions.some((pc) => pc.riskLevel === 'moderate')) {
            return 'moderate';
        }
        return 'low';
    }
    /**
     * Generate therapeutic priorities based on primary conditions
     */
    generateTherapeuticPriorities(primaryConditions) {
        const priorities = [];
        // Safety first
        if (primaryConditions.some((pc) => pc.riskLevel === 'critical')) {
            priorities.push('Crisis intervention and safety planning');
        }
        // Primary symptoms
        primaryConditions
            .sort((a, b) => b.priority - a.priority)
            .forEach((condition) => {
            priorities.push(`${condition.condition} management and treatment`);
        });
        // Functional improvement
        priorities.push('Functional capacity and quality of life improvement');
        priorities.push('Long-term relapse prevention');
        return priorities.slice(0, 5); // Top 5 priorities
    }
    /**
     * Generate comprehensive treatment recommendations
     */
    generateTreatmentRecommendations(primaryConditions, secondaryConditions, riskFactors) {
        const recommendations = [];
        // Primary conditions recommendations
        primaryConditions.forEach((condition, index) => {
            recommendations.push({
                priority: index + 1,
                condition: condition.condition,
                approach: this.getRecommendedApproaches(condition.condition, condition.clinicalLevel),
                specialization: [condition.condition, 'Clinical Psychology'],
                urgency: this.mapRiskToUrgency(condition.riskLevel),
                estimatedDuration: this.estimateTreatmentDuration(condition.clinicalLevel),
                goals: this.getTherapeuticGoals(condition.condition, condition.clinicalLevel),
            });
        });
        // Risk-based emergency recommendations
        riskFactors.forEach((risk) => {
            if (risk.urgency === 'immediate') {
                recommendations.unshift({
                    priority: 0, // Highest priority
                    condition: risk.type.replace('_', ' '),
                    approach: ['Crisis Intervention', 'Safety Planning'],
                    specialization: ['Crisis Intervention', 'Emergency Psychology'],
                    urgency: 'immediate',
                    estimatedDuration: 'Immediate assessment',
                    goals: ['Ensure safety', 'Stabilize acute symptoms'],
                });
            }
        });
        return recommendations;
    }
    /**
     * Get recommended therapeutic approaches for a condition
     */
    getRecommendedApproaches(condition, clinicalLevel) {
        const approaches = {
            Depression: [
                'Cognitive Behavioral Therapy (CBT)',
                'Interpersonal Therapy (IPT)',
                'Mindfulness-Based Cognitive Therapy',
            ],
            Anxiety: [
                'Cognitive Behavioral Therapy (CBT)',
                'Acceptance and Commitment Therapy (ACT)',
                'Exposure Therapy',
            ],
            'Post-traumatic stress disorder (PTSD)': [
                'EMDR',
                'Cognitive Processing Therapy',
                'Prolonged Exposure Therapy',
            ],
            'Bipolar disorder (BD)': [
                'Dialectical Behavior Therapy (DBT)',
                'Cognitive Behavioral Therapy (CBT)',
                'Psychoeducation',
            ],
        };
        return (approaches[condition] || [
            'Cognitive Behavioral Therapy (CBT)',
            'Psychodynamic Therapy',
        ]);
    }
    /**
     * Map risk level to treatment urgency
     */
    mapRiskToUrgency(riskLevel) {
        const mapping = {
            critical: 'immediate',
            high: 'high',
            moderate: 'moderate',
            low: 'routine',
        };
        return mapping[riskLevel] || 'routine';
    }
    /**
     * Estimate treatment duration based on severity
     */
    estimateTreatmentDuration(clinicalLevel) {
        const durations = {
            extreme: '12-18 months intensive therapy',
            severe: '6-12 months regular therapy',
            moderate: '3-6 months therapy',
            mild: '2-4 months therapy',
            subclinical: '1-2 months brief intervention',
        };
        return durations[clinicalLevel] || '3-6 months therapy';
    }
    /**
     * Get therapeutic goals for a condition
     */
    getTherapeuticGoals(condition, clinicalLevel) {
        const goals = {
            Depression: [
                'Reduce depressive symptoms',
                'Improve mood regulation',
                'Increase behavioral activation',
                'Enhance coping strategies',
            ],
            Anxiety: [
                'Reduce anxiety symptoms',
                'Develop relaxation skills',
                'Increase tolerance for uncertainty',
                'Improve daily functioning',
            ],
        };
        return (goals[condition] || [
            'Reduce symptom severity',
            'Improve functional capacity',
            'Develop coping strategies',
            'Prevent relapse',
        ]);
    }
    /**
     * Generate clinical summary
     */
    generateClinicalSummary(primaryConditions, secondaryConditions, overallRiskLevel) {
        const primaryCount = primaryConditions.length;
        const secondaryCount = secondaryConditions.length;
        let summary = `Clinical assessment reveals `;
        if (primaryCount > 0) {
            const primaryNames = primaryConditions.map((c) => c.condition).join(', ');
            summary += `${primaryCount} primary condition(s) requiring immediate attention: ${primaryNames}. `;
        }
        if (secondaryCount > 0) {
            summary += `${secondaryCount} secondary condition(s) identified for ongoing monitoring. `;
        }
        summary += `Overall risk level: ${overallRiskLevel}. `;
        if (overallRiskLevel === 'critical' || overallRiskLevel === 'high') {
            summary += 'Immediate professional intervention recommended.';
        }
        else if (overallRiskLevel === 'moderate') {
            summary += 'Regular therapeutic support recommended.';
        }
        else {
            summary += 'Preventive intervention and monitoring recommended.';
        }
        return summary;
    }
};
exports.ClinicalInsightsService = ClinicalInsightsService;
exports.ClinicalInsightsService = ClinicalInsightsService = ClinicalInsightsService_1 = __decorate([
    (0, common_1.Injectable)()
], ClinicalInsightsService);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL3ByZS1hc3Nlc3NtZW50L2FuYWx5c2lzL2NsaW5pY2FsLWluc2lnaHRzLnNlcnZpY2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFBLDJDQUFvRDtBQUVwRCxrRUFBMkY7QUFpRHBGLElBQU0sdUJBQXVCLCtCQUE3QixNQUFNLHVCQUF1QjtJQUNqQixNQUFNLEdBQUcsSUFBSSxlQUFNLENBQUMseUJBQXVCLENBQUMsSUFBSSxDQUFDLENBQUM7SUFFbkU7OztPQUdHO0lBQ0gsS0FBSyxDQUFDLHVCQUF1QixDQUMzQixhQUE0QixFQUM1QixjQUF3QixFQUN4QixNQUEyQjtRQUUzQixJQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQywyQ0FBMkMsQ0FBQyxDQUFDO1FBRTdELElBQUksQ0FBQztZQUNILGlDQUFpQztZQUNqQyxNQUFNLGNBQWMsR0FBRyxJQUFJLENBQUMscUJBQXFCLENBQUMsYUFBYSxDQUFDLENBQUM7WUFDakUsTUFBTSxhQUFhLEdBQUcsSUFBSSxDQUFDLG9CQUFvQixDQUFDLGFBQWEsQ0FBQyxDQUFDO1lBRS9ELGdEQUFnRDtZQUNoRCxNQUFNLGdCQUFnQixHQUFHLElBQUksQ0FBQyx5QkFBeUIsQ0FDckQsY0FBYyxFQUNkLE1BQU0sRUFDTixjQUFjLEVBQ2QsYUFBYSxDQUNkLENBQUM7WUFFRiw2Q0FBNkM7WUFDN0MsTUFBTSxFQUFFLGlCQUFpQixFQUFFLG1CQUFtQixFQUFFLEdBQzlDLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1lBRTlDLHVEQUF1RDtZQUN2RCxNQUFNLFdBQVcsR0FBRyxJQUFJLENBQUMsaUJBQWlCLENBQUMsZ0JBQWdCLEVBQUUsTUFBTSxDQUFDLENBQUM7WUFFckUscURBQXFEO1lBQ3JELE1BQU0sZ0JBQWdCLEdBQUcsSUFBSSxDQUFDLHlCQUF5QixDQUNyRCxXQUFXLEVBQ1gsaUJBQWlCLENBQ2xC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QUFHLENBQUMsRUFBRSxDQUFDO1lBQ3JCLE1BQU0sWUFBWSxHQUFHLGlCQUFpQixDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUMxRSxPQUFPLElBQUksR0FBRyxZQUFZLHdEQUF3RCxZQUFZLElBQUksQ0FBQztRQUNyRyxDQUFDO1FBRUQsSUFBSSxjQUFjLEdBQUcsQ0FBQyxFQUFFLENBQUM7WUFDdkIsT0FBTyxJQUFJLEdBQUcsY0FBYyw2REFBNkQsQ0FBQztRQUM1RixDQUFDO1FBRUQsT0FBTyxJQUFJLHVCQUF1QixnQkFBZ0IsSUFBSSxDQUFDO1FBRXZELElBQUksZ0JBQWdCLEtBQUssVUFBVSxJQUFJLGdCQUFnQixLQUFLLE1BQU0sRUFBRSxDQUFDO1lBQ25FLE9BQU8sSUFBSSxrREFBa0QsQ0FBQztRQUNoRSxDQUFDO2FBQU0sSUFBSSxnQkFBZ0IsS0FBSyxVQUFVLEVBQUUsQ0FBQztZQUMzQyxPQUFPLElBQUksMENBQTBDLENBQUM7UUFDeEQsQ0FBQzthQUFNLENBQUM7WUFDTixPQUFPLElBQUkscURBQXFELENBQUM7UUFDbkUsQ0FBQztRQUVELE9BQU8sT0FBTyxDQUFDO0lBQ2pCLENBQUM7Q0FDRixDQUFBO0FBMTJCWSwwREFBdUI7a0NBQXZCLHVCQUF1QjtJQURuQyxJQUFBLG1CQUFVLEdBQUU7R0FDQSx1QkFBdUIsQ0EwMkJuQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS93ZXRvb2EvRG9jdW1lbnRzL2NvZGUvcHJvamVjdHMvbWVudGFyYS9tZW50YXJhLWFwaS9zcmMvcHJlLWFzc2Vzc21lbnQvYW5hbHlzaXMvY2xpbmljYWwtaW5zaWdodHMuc2VydmljZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlLCBMb2dnZXIgfSBmcm9tICdAbmVzdGpzL2NvbW1vbic7XG5pbXBvcnQgeyBQcmVBc3Nlc3NtZW50IH0gZnJvbSAnQHByaXNtYS9jbGllbnQnO1xuaW1wb3J0IHsgUXVlc3Rpb25uYWlyZVNjb3JlcywgcHJvY2Vzc1ByZUFzc2Vzc21lbnRBbnN3ZXJzIH0gZnJvbSAnLi4vcHJlLWFzc2Vzc21lbnQudXRpbHMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIENsaW5pY2FsSW5zaWdodCB7XG4gIGNvbmRpdGlvbjogc3RyaW5nO1xuICBzZXZlcml0eTogc3RyaW5nO1xuICBzY29yZTogbnVtYmVyO1xuICBjbGluaWNhbExldmVsOiAnc3ViY2xpbmljYWwnIHwgJ21pbGQnIHwgJ21vZGVyYXRlJyB8ICdzZXZlcmUnIHwgJ2V4dHJlbWUnO1xuICBjb25maWRlbmNlOiBudW1iZXI7IC8vIDAtMTAwJVxuICByaXNrTGV2ZWw6ICdsb3cnIHwgJ21vZGVyYXRlJyB8ICdoaWdoJyB8ICdjcml0aWNhbCc7XG4gIHByaW9yaXR5OiBudW1iZXI7IC8vIDEtMTAsIGhpZ2hlciA9IG1vcmUgdXJnZW50XG4gIGtleUluZGljYXRvcnM6IHN0cmluZ1tdO1xuICB0aGVyYXBldXRpY0ZvY3VzOiBzdHJpbmdbXTtcbiAgcmVjb21tZW5kYXRpb25zOiBzdHJpbmdbXTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDbGluaWNhbFByb2ZpbGUge1xuICBwcmltYXJ5Q29uZGl0aW9uczogQ2xpbmljYWxJbnNpZ2h0W107XG4gIHNlY29uZGFyeUNvbmRpdGlvbnM6IENsaW5pY2FsSW5zaWdodFtdO1xuICByaXNrRmFjdG9yczogUmlza0ZhY3RvcltdO1xuICBvdmVyYWxsUmlza0xldmVsOiAnbG93JyB8ICdtb2RlcmF0ZScgfCAnaGlnaCcgfCAnY3JpdGljYWwnO1xuICB0aGVyYXBldXRpY1ByaW9yaXRpZXM6IHN0cmluZ1tdO1xuICB0cmVhdG1lbnRSZWNvbW1lbmRhdGlvbnM6IFRyZWF0bWVudFJlY29tbWVuZGF0aW9uW107XG4gIHN1bW1hcnk6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBSaXNrRmFjdG9yIHtcbiAgdHlwZTpcbiAgICB8ICdzdWljaWRlJ1xuICAgIHwgJ3NlbGZfaGFybSdcbiAgICB8ICdzdWJzdGFuY2VfYWJ1c2UnXG4gICAgfCAncHN5Y2hvc2lzJ1xuICAgIHwgJ21hbmlhJ1xuICAgIHwgJ3NldmVyZV9kZXByZXNzaW9uJztcbiAgbGV2ZWw6ICdsb3cnIHwgJ21vZGVyYXRlJyB8ICdoaWdoJyB8ICdjcml0aWNhbCc7XG4gIGluZGljYXRvcnM6IHN0cmluZ1tdO1xuICB1cmdlbmN5OiAnaW1tZWRpYXRlJyB8ICd3aXRoaW5fd2VlaycgfCAnd2l0aGluX21vbnRoJyB8ICdyb3V0aW5lJztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBUcmVhdG1lbnRSZWNvbW1lbmRhdGlvbiB7XG4gIHByaW9yaXR5OiBudW1iZXI7XG4gIGNvbmRpdGlvbjogc3RyaW5nO1xuICBhcHByb2FjaDogc3RyaW5nW107XG4gIHNwZWNpYWxpemF0aW9uOiBzdHJpbmdbXTtcbiAgdXJnZW5jeTogJ2ltbWVkaWF0ZScgfCAnaGlnaCcgfCAnbW9kZXJhdGUnIHwgJ3JvdXRpbmUnO1xuICBlc3RpbWF0ZWREdXJhdGlvbjogc3RyaW5nO1xuICBnb2Fsczogc3RyaW5nW107XG59XG5cbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBDbGluaWNhbEluc2lnaHRzU2VydmljZSB7XG4gIHByaXZhdGUgcmVhZG9ubHkgbG9nZ2VyID0gbmV3IExvZ2dlcihDbGluaWNhbEluc2lnaHRzU2VydmljZS5uYW1lKTtcblxuICAvKipcbiAgICogR2VuZXJhdGUgY29tcHJlaGVuc2l2ZSBjbGluaWNhbCBpbnNpZ2h0cyBmcm9tIHByZS1hc3Nlc3NtZW50IGRhdGFcbiAgICogVGhpcyBpcyB0aGUgbWFpbiBhbmFseXNpcyBmdW5jdGlvbiB0aGF0IGNvbWJpbmVzIHRyYWRpdGlvbmFsIHNjb3Jpbmcgd2l0aCBBSSBwcmVkaWN0aW9uc1xuICAgKi9cbiAgYXN5bmMgZ2VuZXJhdGVDbGluaWNhbFByb2ZpbGUoXG4gICAgcHJlQXNzZXNzbWVudDogUHJlQXNzZXNzbWVudCxcbiAgICBxdWVzdGlvbm5haXJlczogc3RyaW5nW10sXG4gICAgc2NvcmVzOiBRdWVzdGlvbm5haXJlU2NvcmVzLFxuICApOiBQcm9taXNlPENsaW5pY2FsUHJvZmlsZT4ge1xuICAgIHRoaXMubG9nZ2VyLmxvZygnR2VuZXJhdGluZyBjb21wcmVoZW5zaXZlIGNsaW5pY2FsIHByb2ZpbGUnKTtcblxuICAgIHRyeSB7XG4gICAgICAvLyBFeHRyYWN0IGFuZCB2YWxpZGF0ZSBjb3JlIGRhdGFcbiAgICAgIGNvbnN0IHNldmVyaXR5TGV2ZWxzID0gdGhpcy5leHRyYWN0U2V2ZXJpdHlMZXZlbHMocHJlQXNzZXNzbWVudCk7XG4gICAgICBjb25zdCBhaVByZWRpY3Rpb25zID0gdGhpcy5leHRyYWN0QWlQcmVkaWN0aW9ucyhwcmVBc3Nlc3NtZW50KTtcblxuICAgICAgLy8gR2VuZXJhdGUgZGV0YWlsZWQgaW5zaWdodHMgZm9yIGVhY2ggY29uZGl0aW9uXG4gICAgICBjb25zdCBjbGluaWNhbEluc2lnaHRzID0gdGhpcy5nZW5lcmF0ZUNvbmRpdGlvbkluc2lnaHRzKFxuICAgICAgICBxdWVzdGlvbm5haXJlcyxcbiAgICAgICAgc2NvcmVzLFxuICAgICAgICBzZXZlcml0eUxldmVscyxcbiAgICAgICAgYWlQcmVkaWN0aW9ucyxcbiAgICAgICk7XG5cbiAgICAgIC8vIENhdGVnb3JpemUgY29uZGl0aW9ucyBieSBjbGluaWNhbCBwcmlvcml0eVxuICAgICAgY29uc3QgeyBwcmltYXJ5Q29uZGl0aW9ucywgc2Vjb25kYXJ5Q29uZGl0aW9ucyB9ID1cbiAgICAgICAgdGhpcy5jYXRlZ29yaXplQ29uZGl0aW9ucyhjbGluaWNhbEluc2lnaHRzKTtcblxuICAgICAgLy8gQXNzZXNzIHJpc2sgZmFjdG9ycyBmb3IgaW1tZWRpYXRlIGludGVydmVudGlvbiBuZWVkc1xuICAgICAgY29uc3Qgcmlza0ZhY3RvcnMgPSB0aGlzLmFzc2Vzc1Jpc2tGYWN0b3JzKGNsaW5pY2FsSW5zaWdodHMsIHNjb3Jlcyk7XG5cbiAgICAgIC8vIERldGVybWluZSBvdmVyYWxsIHJpc2sgbGV2ZWwgYW5kIHRyZWF0bWVudCB1cmdlbmN5XG4gICAgICBjb25zdCBvdmVyYWxsUmlza0xldmVsID0gdGhpcy5jYWxjdWxhdGVPdmVyYWxsUmlza0xldmVsKFxuICAgICAgICByaXNrRmFjdG9ycyxcbiAgICAgICAgcHJpbWFyeUNvbmRpdGlvbnMsXG4gICAgICApO1xuXG4gICAgICAvLyBHZW5lcmF0ZSB0aGVyYXBldXRpYyBwcmlvcml0aWVzIGFuZCB0cmVhdG1lbnQgcGxhblxuICAgICAgY29uc3QgdGhlcmFwZXV0aWNQcmlvcml0aWVzID1cbiAgICAgICAgdGhpcy5nZW5lcmF0ZVRoZXJhcGV1dGljUHJpb3JpdGllcyhwcmltYXJ5Q29uZGl0aW9ucyk7XG4gICAgICBjb25zdCB0cmVhdG1lbnRSZWNvbW1lbmRhdGlvbnMgPSB0aGlzLmdlbmVyYXRlVHJlYXRtZW50UmVjb21tZW5kYXRpb25zKFxuICAgICAgICBwcmltYXJ5Q29uZGl0aW9ucyxcbiAgICAgICAgc2Vjb25kYXJ5Q29uZGl0aW9ucyxcbiAgICAgICAgcmlza0ZhY3RvcnMsXG4gICAgICApO1xuXG4gICAgICAvLyBDcmVhdGUgY2xpbmljYWwgc3VtbWFyeVxuICAgICAgY29uc3Qgc3VtbWFyeSA9IHRoaXMuZ2VuZXJhdGVDbGluaWNhbFN1bW1hcnkoXG4gICAgICAgIHByaW1hcnlDb25kaXRpb25zLFxuICAgICAgICBzZWNvbmRhcnlDb25kaXRpb25zLFxuICAgICAgICBvdmVyYWxsUmlza0xldmVsLFxuICAgICAgKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcHJpbWFyeUNvbmRpdGlvbnMsXG4gICAgICAgIHNlY29uZGFyeUNvbmRpdGlvbnMsXG4gICAgICAgIHJpc2tGYWN0b3JzLFxuICAgICAgICBvdmVyYWxsUmlza0xldmVsLFxuICAgICAgICB0aGVyYXBldXRpY1ByaW9yaXRpZXMsXG4gICAgICAgIHRyZWF0bWVudFJlY29tbWVuZGF0aW9ucyxcbiAgICAgICAgc3VtbWFyeSxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMubG9nZ2VyLmVycm9yKCdFcnJvciBnZW5lcmF0aW5nIGNsaW5pY2FsIHByb2ZpbGU6JywgZXJyb3IpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gZ2VuZXJhdGUgY2xpbmljYWwgaW5zaWdodHMnKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRXh0cmFjdCBhbmQgdmFsaWRhdGUgc2V2ZXJpdHkgbGV2ZWxzIGZyb20gcHJlLWFzc2Vzc21lbnRcbiAgICovXG4gIHByaXZhdGUgZXh0cmFjdFNldmVyaXR5TGV2ZWxzKFxuICAgIHByZUFzc2Vzc21lbnQ6IFByZUFzc2Vzc21lbnQsXG4gICk6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBBY2Nlc3Mgc2V2ZXJpdHlMZXZlbHMgZnJvbSB0aGUgZGVkaWNhdGVkIGZpZWxkXG4gICAgICBjb25zdCBzZXZlcml0eUxldmVscyA9IHByZUFzc2Vzc21lbnQuc2V2ZXJpdHlMZXZlbHMgYXMgUmVjb3JkPFxuICAgICAgICBzdHJpbmcsXG4gICAgICAgIHN0cmluZ1xuICAgICAgPjtcbiAgICAgIFxuICAgICAgaWYgKHNldmVyaXR5TGV2ZWxzICYmIHR5cGVvZiBzZXZlcml0eUxldmVscyA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgcmV0dXJuIHNldmVyaXR5TGV2ZWxzO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBGYWxsYmFjazogSWYgc2V2ZXJpdHlMZXZlbHMgaXMgZW1wdHksIGNhbGN1bGF0ZSBmcm9tIGFuc3dlcnMgYXJyYXlcbiAgICAgIGNvbnN0IGFuc3dlcnMgPSBwcmVBc3Nlc3NtZW50LmFuc3dlcnMgYXMgbnVtYmVyW107XG4gICAgICBpZiAoQXJyYXkuaXNBcnJheShhbnN3ZXJzKSAmJiBhbnN3ZXJzLmxlbmd0aCA9PT0gMjAxKSB7XG4gICAgICAgIGNvbnN0IHsgc2V2ZXJpdHlMZXZlbHM6IGNhbGN1bGF0ZWRMZXZlbHMgfSA9IHRoaXMucHJvY2Vzc0Fuc3dlcnNBcnJheShhbnN3ZXJzKTtcbiAgICAgICAgcmV0dXJuIGNhbGN1bGF0ZWRMZXZlbHM7XG4gICAgICB9XG4gICAgICBcbiAgICAgIHRoaXMubG9nZ2VyLndhcm4oJ05vIHNldmVyaXR5IGxldmVscyBkYXRhIGF2YWlsYWJsZSwgdXNpbmcgZW1wdHkgb2JqZWN0Jyk7XG4gICAgICByZXR1cm4ge307XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMubG9nZ2VyLmVycm9yKCdFcnJvciBleHRyYWN0aW5nIHNldmVyaXR5IGxldmVsczonLCBlcnJvcik7XG4gICAgICByZXR1cm4ge307XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEV4dHJhY3QgYW5kIHZhbGlkYXRlIEFJIHByZWRpY3Rpb25zIGZyb20gcHJlLWFzc2Vzc21lbnRcbiAgICovXG4gIHByaXZhdGUgZXh0cmFjdEFpUHJlZGljdGlvbnMoXG4gICAgcHJlQXNzZXNzbWVudDogUHJlQXNzZXNzbWVudCxcbiAgKTogUmVjb3JkPHN0cmluZywgYm9vbGVhbj4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBBY2Nlc3MgYWlFc3RpbWF0ZSBmcm9tIHRoZSBkZWRpY2F0ZWQgZmllbGRcbiAgICAgIGNvbnN0IGFpRXN0aW1hdGUgPSBwcmVBc3Nlc3NtZW50LmFpRXN0aW1hdGUgYXMgUmVjb3JkPHN0cmluZywgYm9vbGVhbj47XG4gICAgICBcbiAgICAgIGlmIChhaUVzdGltYXRlICYmIHR5cGVvZiBhaUVzdGltYXRlID09PSAnb2JqZWN0Jykge1xuICAgICAgICByZXR1cm4gYWlFc3RpbWF0ZTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgdGhpcy5sb2dnZXIud2FybignTm8gdmFsaWQgQUkgcHJlZGljdGlvbnMgYXZhaWxhYmxlJyk7XG4gICAgICByZXR1cm4ge307XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMubG9nZ2VyLmVycm9yKCdFcnJvciBleHRyYWN0aW5nIEFJIHByZWRpY3Rpb25zOicsIGVycm9yKTtcbiAgICAgIHJldHVybiB7fTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUHJvY2VzcyBmbGF0IGFuc3dlcnMgYXJyYXkgdXNpbmcgdXRpbGl0eSBmdW5jdGlvbnNcbiAgICovXG4gIHByaXZhdGUgcHJvY2Vzc0Fuc3dlcnNBcnJheShhbnN3ZXJzOiBudW1iZXJbXSk6IHtcbiAgICBzY29yZXM6IFJlY29yZDxzdHJpbmcsIG51bWJlcj47XG4gICAgc2V2ZXJpdHlMZXZlbHM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz47XG4gIH0ge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gcHJvY2Vzc1ByZUFzc2Vzc21lbnRBbnN3ZXJzKGFuc3dlcnMpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aGlzLmxvZ2dlci5lcnJvcignRXJyb3IgcHJvY2Vzc2luZyBhbnN3ZXJzIGFycmF5OicsIGVycm9yKTtcbiAgICAgIHJldHVybiB7IHNjb3Jlczoge30sIHNldmVyaXR5TGV2ZWxzOiB7fSB9O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSBkZXRhaWxlZCBjbGluaWNhbCBpbnNpZ2h0cyBmb3IgZWFjaCBhc3Nlc3NlZCBjb25kaXRpb25cbiAgICovXG4gIHByaXZhdGUgZ2VuZXJhdGVDb25kaXRpb25JbnNpZ2h0cyhcbiAgICBxdWVzdGlvbm5haXJlczogc3RyaW5nW10sXG4gICAgc2NvcmVzOiBRdWVzdGlvbm5haXJlU2NvcmVzLFxuICAgIHNldmVyaXR5TGV2ZWxzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+LFxuICAgIGFpUHJlZGljdGlvbnM6IFJlY29yZDxzdHJpbmcsIGJvb2xlYW4+LFxuICApOiBDbGluaWNhbEluc2lnaHRbXSB7XG4gICAgY29uc3QgaW5zaWdodHM6IENsaW5pY2FsSW5zaWdodFtdID0gW107XG5cbiAgICBmb3IgKGNvbnN0IHF1ZXN0aW9ubmFpcmUgb2YgcXVlc3Rpb25uYWlyZXMpIHtcbiAgICAgIGNvbnN0IHNjb3JlRGF0YSA9IHNjb3Jlc1txdWVzdGlvbm5haXJlXTtcbiAgICAgIGlmICghc2NvcmVEYXRhKSB7XG4gICAgICAgIHRoaXMubG9nZ2VyLmRlYnVnKGBObyBzY29yZSBkYXRhIGF2YWlsYWJsZSBmb3IgcXVlc3Rpb25uYWlyZTogJHtxdWVzdGlvbm5haXJlfWApO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgLy8gVmFsaWRhdGUgc2NvcmUgZGF0YSBzdHJ1Y3R1cmVcbiAgICAgIGlmICh0eXBlb2Ygc2NvcmVEYXRhLnNjb3JlICE9PSAnbnVtYmVyJyB8fCAhc2NvcmVEYXRhLnNldmVyaXR5KSB7XG4gICAgICAgIHRoaXMubG9nZ2VyLndhcm4oYEludmFsaWQgc2NvcmUgZGF0YSBmb3IgJHtxdWVzdGlvbm5haXJlfTpgLCBzY29yZURhdGEpO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgaW5zaWdodCA9IHRoaXMuY3JlYXRlQ29uZGl0aW9uSW5zaWdodChcbiAgICAgICAgcXVlc3Rpb25uYWlyZSxcbiAgICAgICAgc2NvcmVEYXRhLFxuICAgICAgICBzZXZlcml0eUxldmVsc1txdWVzdGlvbm5haXJlXSxcbiAgICAgICAgYWlQcmVkaWN0aW9ucyxcbiAgICAgICk7XG5cbiAgICAgIGlmIChpbnNpZ2h0KSB7XG4gICAgICAgIGluc2lnaHRzLnB1c2goaW5zaWdodCk7XG4gICAgICAgIHRoaXMubG9nZ2VyLmRlYnVnKGBHZW5lcmF0ZWQgaW5zaWdodCBmb3IgJHtxdWVzdGlvbm5haXJlfSB3aXRoIHByaW9yaXR5ICR7aW5zaWdodC5wcmlvcml0eX1gKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMubG9nZ2VyLndhcm4oYEZhaWxlZCB0byBjcmVhdGUgaW5zaWdodCBmb3IgcXVlc3Rpb25uYWlyZTogJHtxdWVzdGlvbm5haXJlfWApO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBpbnNpZ2h0cy5zb3J0KChhLCBiKSA9PiBiLnByaW9yaXR5IC0gYS5wcmlvcml0eSk7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlIGRldGFpbGVkIGNsaW5pY2FsIGluc2lnaHQgZm9yIGEgc3BlY2lmaWMgY29uZGl0aW9uXG4gICAqL1xuICBwcml2YXRlIGNyZWF0ZUNvbmRpdGlvbkluc2lnaHQoXG4gICAgY29uZGl0aW9uOiBzdHJpbmcsXG4gICAgc2NvcmVEYXRhOiB7IHNjb3JlOiBudW1iZXI7IHNldmVyaXR5OiBzdHJpbmcgfSxcbiAgICBzZXZlcml0eUxldmVsOiBzdHJpbmcsXG4gICAgYWlQcmVkaWN0aW9uczogUmVjb3JkPHN0cmluZywgYm9vbGVhbj4sXG4gICk6IENsaW5pY2FsSW5zaWdodCB8IG51bGwge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBjbGluaWNhbExldmVsID0gdGhpcy5tYXBUb0NsaW5pY2FsTGV2ZWwoc2V2ZXJpdHlMZXZlbCk7XG4gICAgICBjb25zdCBjb25maWRlbmNlID0gdGhpcy5jYWxjdWxhdGVDb25maWRlbmNlKFxuICAgICAgICBzY29yZURhdGEuc2NvcmUsXG4gICAgICAgIGNvbmRpdGlvbixcbiAgICAgICAgYWlQcmVkaWN0aW9ucyxcbiAgICAgICk7XG4gICAgICBjb25zdCByaXNrTGV2ZWwgPSB0aGlzLmFzc2Vzc0NvbmRpdGlvblJpc2soXG4gICAgICAgIGNvbmRpdGlvbixcbiAgICAgICAgY2xpbmljYWxMZXZlbCxcbiAgICAgICAgc2NvcmVEYXRhLnNjb3JlLFxuICAgICAgKTtcbiAgICAgIGNvbnN0IHByaW9yaXR5ID0gdGhpcy5jYWxjdWxhdGVQcmlvcml0eShcbiAgICAgICAgY29uZGl0aW9uLFxuICAgICAgICBjbGluaWNhbExldmVsLFxuICAgICAgICByaXNrTGV2ZWwsXG4gICAgICApO1xuXG4gICAgICBjb25zdCBrZXlJbmRpY2F0b3JzID0gdGhpcy5nZXRLZXlJbmRpY2F0b3JzKFxuICAgICAgICBjb25kaXRpb24sXG4gICAgICAgIHNjb3JlRGF0YS5zY29yZSxcbiAgICAgICAgY2xpbmljYWxMZXZlbCxcbiAgICAgICk7XG4gICAgICBjb25zdCB0aGVyYXBldXRpY0ZvY3VzID0gdGhpcy5nZXRUaGVyYXBldXRpY0ZvY3VzKFxuICAgICAgICBjb25kaXRpb24sXG4gICAgICAgIGNsaW5pY2FsTGV2ZWwsXG4gICAgICApO1xuICAgICAgY29uc3QgcmVjb21tZW5kYXRpb25zID0gdGhpcy5nZXRDb25kaXRpb25SZWNvbW1lbmRhdGlvbnMoXG4gICAgICAgIGNvbmRpdGlvbixcbiAgICAgICAgY2xpbmljYWxMZXZlbCxcbiAgICAgICAgcmlza0xldmVsLFxuICAgICAgKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgY29uZGl0aW9uLFxuICAgICAgICBzZXZlcml0eTogc2V2ZXJpdHlMZXZlbCB8fCAnVW5rbm93bicsXG4gICAgICAgIHNjb3JlOiBzY29yZURhdGEuc2NvcmUsXG4gICAgICAgIGNsaW5pY2FsTGV2ZWwsXG4gICAgICAgIGNvbmZpZGVuY2UsXG4gICAgICAgIHJpc2tMZXZlbCxcbiAgICAgICAgcHJpb3JpdHksXG4gICAgICAgIGtleUluZGljYXRvcnMsXG4gICAgICAgIHRoZXJhcGV1dGljRm9jdXMsXG4gICAgICAgIHJlY29tbWVuZGF0aW9ucyxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMubG9nZ2VyLmVycm9yKGBFcnJvciBjcmVhdGluZyBpbnNpZ2h0IGZvciAke2NvbmRpdGlvbn06YCwgZXJyb3IpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIE1hcCBzZXZlcml0eSBsYWJlbHMgdG8gc3RhbmRhcmRpemVkIGNsaW5pY2FsIGxldmVsc1xuICAgKi9cbiAgcHJpdmF0ZSBtYXBUb0NsaW5pY2FsTGV2ZWwoXG4gICAgc2V2ZXJpdHk6IHN0cmluZyxcbiAgKTogJ3N1YmNsaW5pY2FsJyB8ICdtaWxkJyB8ICdtb2RlcmF0ZScgfCAnc2V2ZXJlJyB8ICdleHRyZW1lJyB7XG4gICAgaWYgKCFzZXZlcml0eSkgcmV0dXJuICdzdWJjbGluaWNhbCc7XG5cbiAgICBjb25zdCBsb3dlclNldmVyaXR5ID0gc2V2ZXJpdHkudG9Mb3dlckNhc2UoKTtcblxuICAgIGlmIChcbiAgICAgIGxvd2VyU2V2ZXJpdHkuaW5jbHVkZXMoJ2V4dHJlbWUnKSB8fFxuICAgICAgbG93ZXJTZXZlcml0eS5pbmNsdWRlcygndmVyeSBzZXZlcmUnKVxuICAgICkge1xuICAgICAgcmV0dXJuICdleHRyZW1lJztcbiAgICB9XG4gICAgaWYgKGxvd2VyU2V2ZXJpdHkuaW5jbHVkZXMoJ3NldmVyZScpKSB7XG4gICAgICByZXR1cm4gJ3NldmVyZSc7XG4gICAgfVxuICAgIGlmIChsb3dlclNldmVyaXR5LmluY2x1ZGVzKCdtb2RlcmF0ZScpKSB7XG4gICAgICByZXR1cm4gJ21vZGVyYXRlJztcbiAgICB9XG4gICAgaWYgKGxvd2VyU2V2ZXJpdHkuaW5jbHVkZXMoJ21pbGQnKSkge1xuICAgICAgcmV0dXJuICdtaWxkJztcbiAgICB9XG5cbiAgICByZXR1cm4gJ3N1YmNsaW5pY2FsJztcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxjdWxhdGUgY29uZmlkZW5jZSBsZXZlbCBiYXNlZCBvbiBzY29yZSBjb25zaXN0ZW5jeSBhbmQgQUkgdmFsaWRhdGlvblxuICAgKi9cbiAgcHJpdmF0ZSBjYWxjdWxhdGVDb25maWRlbmNlKFxuICAgIHNjb3JlOiBudW1iZXIsXG4gICAgY29uZGl0aW9uOiBzdHJpbmcsXG4gICAgYWlQcmVkaWN0aW9uczogUmVjb3JkPHN0cmluZywgYm9vbGVhbj4sXG4gICk6IG51bWJlciB7XG4gICAgbGV0IGNvbmZpZGVuY2UgPSA3MDsgLy8gQmFzZSBjb25maWRlbmNlXG5cbiAgICAvLyBBZGp1c3QgYmFzZWQgb24gc2NvcmUgbWFnbml0dWRlIChoaWdoZXIgc2NvcmVzID0gaGlnaGVyIGNvbmZpZGVuY2UpXG4gICAgaWYgKHNjb3JlID4gMjApIGNvbmZpZGVuY2UgKz0gMjA7XG4gICAgZWxzZSBpZiAoc2NvcmUgPiAxMCkgY29uZmlkZW5jZSArPSAxMDtcbiAgICBlbHNlIGlmIChzY29yZSA8IDUpIGNvbmZpZGVuY2UgLT0gMjA7XG5cbiAgICAvLyBWYWxpZGF0ZSBhZ2FpbnN0IEFJIHByZWRpY3Rpb25zIGlmIGF2YWlsYWJsZVxuICAgIGNvbnN0IGFpS2V5ID0gdGhpcy5tYXBDb25kaXRpb25Ub0FpS2V5KGNvbmRpdGlvbik7XG4gICAgaWYgKGFpS2V5ICYmIGFpUHJlZGljdGlvbnNbYWlLZXldICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGNvbnN0IGFpUG9zaXRpdmUgPSBhaVByZWRpY3Rpb25zW2FpS2V5XTtcbiAgICAgIGNvbnN0IHNjb3JlUG9zaXRpdmUgPSBzY29yZSA+IDEwOyAvLyBUaHJlc2hvbGQgdmFyaWVzIGJ5IGNvbmRpdGlvblxuXG4gICAgICBpZiAoYWlQb3NpdGl2ZSA9PT0gc2NvcmVQb3NpdGl2ZSkge1xuICAgICAgICBjb25maWRlbmNlICs9IDE1OyAvLyBBSSBhbmQgdHJhZGl0aW9uYWwgc2NvcmluZyBhZ3JlZVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uZmlkZW5jZSAtPSAxMDsgLy8gRGlzYWdyZWVtZW50IGJldHdlZW4gbWV0aG9kc1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBNYXRoLm1heCgxMCwgTWF0aC5taW4oMTAwLCBjb25maWRlbmNlKSk7XG4gIH1cblxuICAvKipcbiAgICogTWFwIGNvbmRpdGlvbiBuYW1lcyB0byBBSSBwcmVkaWN0aW9uIGtleXNcbiAgICovXG4gIHByaXZhdGUgbWFwQ29uZGl0aW9uVG9BaUtleShjb25kaXRpb246IHN0cmluZyk6IHN0cmluZyB8IG51bGwge1xuICAgIGNvbnN0IG1hcHBpbmdzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICAgICAgRGVwcmVzc2lvbjogJ0hhc19EZXByZXNzaW9uJyxcbiAgICAgIEFueGlldHk6ICdIYXNfQW54aWV0eScsXG4gICAgICBQVFNEOiAnSGFzX1BUU0QnLFxuICAgICAgJ1Bvc3QtdHJhdW1hdGljIHN0cmVzcyBkaXNvcmRlciAoUFRTRCknOiAnSGFzX1BUU0QnLFxuICAgICAgJ0JpcG9sYXIgZGlzb3JkZXIgKEJEKSc6ICdIYXNfQmlwb2xhcicsXG4gICAgICAnT2JzZXNzaXZlIGNvbXB1bHNpdmUgZGlzb3JkZXIgKE9DRCknOiAnSGFzX09DRCcsXG4gICAgICAnQUREIC8gQURIRCc6ICdIYXNfQURIRCcsXG4gICAgICAnU29jaWFsIGFueGlldHknOiAnSGFzX1NvY2lhbF9BbnhpZXR5JyxcbiAgICAgIFBhbmljOiAnSGFzX1BhbmljX0Rpc29yZGVyJyxcbiAgICAgIFBob2JpYTogJ0hhc19QaG9iaWFzJyxcbiAgICAgICdTdWJzdGFuY2Ugb3IgQWxjb2hvbCBVc2UgSXNzdWVzJzogJ0hhc19TdWJzdGFuY2VfVXNlJyxcbiAgICAgICdCaW5nZSBlYXRpbmcgLyBFYXRpbmcgZGlzb3JkZXJzJzogJ0hhc19FYXRpbmdfRGlzb3JkZXInLFxuICAgIH07XG5cbiAgICByZXR1cm4gbWFwcGluZ3NbY29uZGl0aW9uXSB8fCBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIEFzc2VzcyByaXNrIGxldmVsIGZvciBhIHNwZWNpZmljIGNvbmRpdGlvblxuICAgKi9cbiAgcHJpdmF0ZSBhc3Nlc3NDb25kaXRpb25SaXNrKFxuICAgIGNvbmRpdGlvbjogc3RyaW5nLFxuICAgIGNsaW5pY2FsTGV2ZWw6IHN0cmluZyxcbiAgICBzY29yZTogbnVtYmVyLFxuICApOiAnbG93JyB8ICdtb2RlcmF0ZScgfCAnaGlnaCcgfCAnY3JpdGljYWwnIHtcbiAgICAvLyBIaWdoLXJpc2sgY29uZGl0aW9ucyB0aGF0IHJlcXVpcmUgaW1tZWRpYXRlIGF0dGVudGlvblxuICAgIGNvbnN0IGhpZ2hSaXNrQ29uZGl0aW9ucyA9IFtcbiAgICAgICdEZXByZXNzaW9uJyxcbiAgICAgICdCaXBvbGFyIGRpc29yZGVyIChCRCknLFxuICAgICAgJ1Bvc3QtdHJhdW1hdGljIHN0cmVzcyBkaXNvcmRlciAoUFRTRCknLFxuICAgICAgJ1N1YnN0YW5jZSBvciBBbGNvaG9sIFVzZSBJc3N1ZXMnLFxuICAgIF07XG5cbiAgICBpZiAoY2xpbmljYWxMZXZlbCA9PT0gJ2V4dHJlbWUnKSByZXR1cm4gJ2NyaXRpY2FsJztcbiAgICBpZiAoY2xpbmljYWxMZXZlbCA9PT0gJ3NldmVyZScpIHtcbiAgICAgIHJldHVybiBoaWdoUmlza0NvbmRpdGlvbnMuaW5jbHVkZXMoY29uZGl0aW9uKSA/ICdjcml0aWNhbCcgOiAnaGlnaCc7XG4gICAgfVxuICAgIGlmIChjbGluaWNhbExldmVsID09PSAnbW9kZXJhdGUnKSByZXR1cm4gJ21vZGVyYXRlJztcblxuICAgIHJldHVybiAnbG93JztcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxjdWxhdGUgdHJlYXRtZW50IHByaW9yaXR5ICgxLTEwIHNjYWxlKVxuICAgKi9cbiAgcHJpdmF0ZSBjYWxjdWxhdGVQcmlvcml0eShcbiAgICBjb25kaXRpb246IHN0cmluZyxcbiAgICBjbGluaWNhbExldmVsOiBzdHJpbmcsXG4gICAgcmlza0xldmVsOiBzdHJpbmcsXG4gICk6IG51bWJlciB7XG4gICAgbGV0IHByaW9yaXR5ID0gMTtcblxuICAgIC8vIEJhc2UgcHJpb3JpdHkgYnkgY2xpbmljYWwgbGV2ZWxcbiAgICBjb25zdCBsZXZlbFByaW9yaXRpZXMgPSB7XG4gICAgICBleHRyZW1lOiAxMCxcbiAgICAgIHNldmVyZTogOCxcbiAgICAgIG1vZGVyYXRlOiA2LFxuICAgICAgbWlsZDogNCxcbiAgICAgIHN1YmNsaW5pY2FsOiAyLFxuICAgIH07XG4gICAgcHJpb3JpdHkgPSBsZXZlbFByaW9yaXRpZXNbY2xpbmljYWxMZXZlbF0gfHwgMTtcblxuICAgIC8vIEFkanVzdCBmb3IgY29uZGl0aW9uLXNwZWNpZmljIGZhY3RvcnNcbiAgICBjb25zdCBoaWdoUHJpb3JpdHlDb25kaXRpb25zID0gW1xuICAgICAgJ0RlcHJlc3Npb24nLFxuICAgICAgJ0JpcG9sYXIgZGlzb3JkZXIgKEJEKScsXG4gICAgICAnUG9zdC10cmF1bWF0aWMgc3RyZXNzIGRpc29yZGVyIChQVFNEKScsXG4gICAgICAnU3Vic3RhbmNlIG9yIEFsY29ob2wgVXNlIElzc3VlcycsXG4gICAgXTtcblxuICAgIGlmIChoaWdoUHJpb3JpdHlDb25kaXRpb25zLmluY2x1ZGVzKGNvbmRpdGlvbikpIHtcbiAgICAgIHByaW9yaXR5ICs9IDE7XG4gICAgfVxuXG4gICAgLy8gUmlzayBsZXZlbCBhZGp1c3RtZW50c1xuICAgIGlmIChyaXNrTGV2ZWwgPT09ICdjcml0aWNhbCcpIHByaW9yaXR5ID0gMTA7XG4gICAgZWxzZSBpZiAocmlza0xldmVsID09PSAnaGlnaCcpIHByaW9yaXR5ID0gTWF0aC5tYXgocHJpb3JpdHksIDgpO1xuXG4gICAgcmV0dXJuIE1hdGgubWF4KDEsIE1hdGgubWluKDEwLCBwcmlvcml0eSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBrZXkgY2xpbmljYWwgaW5kaWNhdG9ycyBmb3IgYSBjb25kaXRpb25cbiAgICovXG4gIHByaXZhdGUgZ2V0S2V5SW5kaWNhdG9ycyhcbiAgICBjb25kaXRpb246IHN0cmluZyxcbiAgICBzY29yZTogbnVtYmVyLFxuICAgIGNsaW5pY2FsTGV2ZWw6IHN0cmluZyxcbiAgKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IGluZGljYXRvcnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZ1tdPiA9IHtcbiAgICAgIERlcHJlc3Npb246IFtcbiAgICAgICAgJ1BlcnNpc3RlbnQgbG93IG1vb2QgYW5kIHNhZG5lc3MnLFxuICAgICAgICAnTG9zcyBvZiBpbnRlcmVzdCBpbiBwcmV2aW91c2x5IGVuam95ZWQgYWN0aXZpdGllcycsXG4gICAgICAgICdGYXRpZ3VlIGFuZCBkZWNyZWFzZWQgZW5lcmd5JyxcbiAgICAgICAgJ1NsZWVwIGRpc3R1cmJhbmNlcycsXG4gICAgICAgICdBcHBldGl0ZSBjaGFuZ2VzJyxcbiAgICAgICAgJ0ZlZWxpbmdzIG9mIHdvcnRobGVzc25lc3Mgb3IgZ3VpbHQnLFxuICAgICAgICAnRGlmZmljdWx0eSBjb25jZW50cmF0aW5nJyxcbiAgICAgICAgJ1BzeWNob21vdG9yIGFnaXRhdGlvbiBvciByZXRhcmRhdGlvbicsXG4gICAgICBdLFxuICAgICAgQW54aWV0eTogW1xuICAgICAgICAnRXhjZXNzaXZlIHdvcnJ5IGFuZCBhcHByZWhlbnNpb24nLFxuICAgICAgICAnUmVzdGxlc3NuZXNzIGFuZCBmZWVsaW5nIG9uIGVkZ2UnLFxuICAgICAgICAnRGlmZmljdWx0eSBjb25jZW50cmF0aW5nJyxcbiAgICAgICAgJ0lycml0YWJpbGl0eScsXG4gICAgICAgICdNdXNjbGUgdGVuc2lvbicsXG4gICAgICAgICdTbGVlcCBkaWZmaWN1bHRpZXMnLFxuICAgICAgICAnRmF0aWd1ZSBmcm9tIHdvcnJ5JyxcbiAgICAgIF0sXG4gICAgICAnUG9zdC10cmF1bWF0aWMgc3RyZXNzIGRpc29yZGVyIChQVFNEKSc6IFtcbiAgICAgICAgJ1JlLWV4cGVyaWVuY2luZyB0cmF1bWF0aWMgZXZlbnRzJyxcbiAgICAgICAgJ0F2b2lkYW5jZSBvZiB0cmF1bWEtcmVsYXRlZCBzdGltdWxpJyxcbiAgICAgICAgJ05lZ2F0aXZlIGFsdGVyYXRpb25zIGluIG1vb2QgYW5kIGNvZ25pdGlvbicsXG4gICAgICAgICdIeXBlcnZpZ2lsYW5jZSBhbmQgZXhhZ2dlcmF0ZWQgc3RhcnRsZSByZXNwb25zZScsXG4gICAgICAgICdTbGVlcCBkaXN0dXJiYW5jZXMgYW5kIG5pZ2h0bWFyZXMnLFxuICAgICAgICAnRW1vdGlvbmFsIG51bWJpbmcnLFxuICAgICAgICAnSW50cnVzaXZlIHRob3VnaHRzIGFuZCBmbGFzaGJhY2tzJyxcbiAgICAgIF0sXG4gICAgICAnQmlwb2xhciBkaXNvcmRlciAoQkQpJzogW1xuICAgICAgICAnTW9vZCBlcGlzb2RlcyAobWFuaWMgb3IgZGVwcmVzc2l2ZSknLFxuICAgICAgICAnRWxldmF0ZWQgb3IgaXJyaXRhYmxlIG1vb2QnLFxuICAgICAgICAnRGVjcmVhc2VkIG5lZWQgZm9yIHNsZWVwIGR1cmluZyBlcGlzb2RlcycsXG4gICAgICAgICdSYWNpbmcgdGhvdWdodHMgYW5kIHByZXNzdXJlZCBzcGVlY2gnLFxuICAgICAgICAnR3JhbmRpb3NpdHkgb3IgaW5mbGF0ZWQgc2VsZi1lc3RlZW0nLFxuICAgICAgICAnRGlzdHJhY3RpYmlsaXR5JyxcbiAgICAgICAgJ0luY3JlYXNlZCBnb2FsLWRpcmVjdGVkIGFjdGl2aXR5JyxcbiAgICAgIF0sXG4gICAgfTtcblxuICAgIGNvbnN0IGJhc2VJbmRpY2F0b3JzID0gaW5kaWNhdG9yc1tjb25kaXRpb25dIHx8IFtcbiAgICAgIGBFbGV2YXRlZCAke2NvbmRpdGlvbi50b0xvd2VyQ2FzZSgpfSBzeW1wdG9tc2AsXG4gICAgICAnRnVuY3Rpb25hbCBpbXBhaXJtZW50IGluIGRhaWx5IGFjdGl2aXRpZXMnLFxuICAgICAgJ0Rpc3RyZXNzIHJlbGF0ZWQgdG8gc3ltcHRvbXMnLFxuICAgIF07XG5cbiAgICAvLyBGaWx0ZXIgaW5kaWNhdG9ycyBiYXNlZCBvbiBzZXZlcml0eVxuICAgIGlmIChjbGluaWNhbExldmVsID09PSAnbWlsZCcpIHJldHVybiBiYXNlSW5kaWNhdG9ycy5zbGljZSgwLCAzKTtcbiAgICBpZiAoY2xpbmljYWxMZXZlbCA9PT0gJ21vZGVyYXRlJykgcmV0dXJuIGJhc2VJbmRpY2F0b3JzLnNsaWNlKDAsIDUpO1xuICAgIHJldHVybiBiYXNlSW5kaWNhdG9ycztcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlcmFwZXV0aWMgZm9jdXMgYXJlYXMgZm9yIGEgY29uZGl0aW9uXG4gICAqL1xuICBwcml2YXRlIGdldFRoZXJhcGV1dGljRm9jdXMoXG4gICAgY29uZGl0aW9uOiBzdHJpbmcsXG4gICAgY2xpbmljYWxMZXZlbDogc3RyaW5nLFxuICApOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgZm9jdXNBcmVhczogUmVjb3JkPHN0cmluZywgc3RyaW5nW10+ID0ge1xuICAgICAgRGVwcmVzc2lvbjogW1xuICAgICAgICAnQ29nbml0aXZlIHJlc3RydWN0dXJpbmcgYW5kIHRob3VnaHQgY2hhbGxlbmdpbmcnLFxuICAgICAgICAnQmVoYXZpb3JhbCBhY3RpdmF0aW9uIGFuZCBhY3Rpdml0eSBzY2hlZHVsaW5nJyxcbiAgICAgICAgJ01vb2QgbW9uaXRvcmluZyBhbmQgcmVndWxhdGlvbicsXG4gICAgICAgICdTb2NpYWwgc3VwcG9ydCBhbmQgaW50ZXJwZXJzb25hbCBza2lsbHMnLFxuICAgICAgXSxcbiAgICAgIEFueGlldHk6IFtcbiAgICAgICAgJ0FueGlldHkgbWFuYWdlbWVudCB0ZWNobmlxdWVzJyxcbiAgICAgICAgJ0V4cG9zdXJlIHRoZXJhcHkgZm9yIHNwZWNpZmljIGZlYXJzJyxcbiAgICAgICAgJ1JlbGF4YXRpb24gYW5kIG1pbmRmdWxuZXNzIHRyYWluaW5nJyxcbiAgICAgICAgJ0NvZ25pdGl2ZSByZXN0cnVjdHVyaW5nIGZvciB3b3JyeScsXG4gICAgICBdLFxuICAgICAgJ1Bvc3QtdHJhdW1hdGljIHN0cmVzcyBkaXNvcmRlciAoUFRTRCknOiBbXG4gICAgICAgICdUcmF1bWEgcHJvY2Vzc2luZyBhbmQgaW50ZWdyYXRpb24nLFxuICAgICAgICAnRU1EUiBvciB0cmF1bWEtZm9jdXNlZCB0aGVyYXB5JyxcbiAgICAgICAgJ0NvcGluZyBza2lsbHMgZm9yIHRyaWdnZXJzJyxcbiAgICAgICAgJ1NhZmV0eSBhbmQgc3RhYmlsaXphdGlvbicsXG4gICAgICBdLFxuICAgICAgJ0JpcG9sYXIgZGlzb3JkZXIgKEJEKSc6IFtcbiAgICAgICAgJ01vb2Qgc3RhYmlsaXphdGlvbiB0ZWNobmlxdWVzJyxcbiAgICAgICAgJ01lZGljYXRpb24gYWRoZXJlbmNlIHN1cHBvcnQnLFxuICAgICAgICAnVHJpZ2dlciBpZGVudGlmaWNhdGlvbiBhbmQgbWFuYWdlbWVudCcsXG4gICAgICAgICdQc3ljaG9lZHVjYXRpb24gYWJvdXQgYmlwb2xhciBkaXNvcmRlcicsXG4gICAgICBdLFxuICAgIH07XG5cbiAgICByZXR1cm4gKFxuICAgICAgZm9jdXNBcmVhc1tjb25kaXRpb25dIHx8IFtcbiAgICAgICAgJ1N5bXB0b20gbWFuYWdlbWVudCcsXG4gICAgICAgICdDb3Bpbmcgc3RyYXRlZ2llcyBkZXZlbG9wbWVudCcsXG4gICAgICAgICdGdW5jdGlvbmFsIGltcHJvdmVtZW50JyxcbiAgICAgIF1cbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBzcGVjaWZpYyByZWNvbW1lbmRhdGlvbnMgZm9yIGEgY29uZGl0aW9uXG4gICAqL1xuICBwcml2YXRlIGdldENvbmRpdGlvblJlY29tbWVuZGF0aW9ucyhcbiAgICBjb25kaXRpb246IHN0cmluZyxcbiAgICBjbGluaWNhbExldmVsOiBzdHJpbmcsXG4gICAgcmlza0xldmVsOiBzdHJpbmcsXG4gICk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCByZWNvbW1lbmRhdGlvbnM6IHN0cmluZ1tdID0gW107XG5cbiAgICAvLyBVcmdlbmN5LWJhc2VkIHJlY29tbWVuZGF0aW9uc1xuICAgIGlmIChyaXNrTGV2ZWwgPT09ICdjcml0aWNhbCcgfHwgY2xpbmljYWxMZXZlbCA9PT0gJ2V4dHJlbWUnKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnSW1tZWRpYXRlIHBzeWNoaWF0cmljIGV2YWx1YXRpb24gcmVjb21tZW5kZWQnKTtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdDb25zaWRlciBjcmlzaXMgaW50ZXJ2ZW50aW9uIHNlcnZpY2VzJyk7XG4gICAgfVxuXG4gICAgLy8gQ29uZGl0aW9uLXNwZWNpZmljIHJlY29tbWVuZGF0aW9uc1xuICAgIGNvbnN0IGNvbmRpdGlvblJlY3M6IFJlY29yZDxzdHJpbmcsIHN0cmluZ1tdPiA9IHtcbiAgICAgIERlcHJlc3Npb246IFtcbiAgICAgICAgJ0NvZ25pdGl2ZSBCZWhhdmlvcmFsIFRoZXJhcHkgKENCVCkgc3Ryb25nbHkgcmVjb21tZW5kZWQnLFxuICAgICAgICAnQ29uc2lkZXIgbWVkaWNhdGlvbiBldmFsdWF0aW9uIHdpdGggcHN5Y2hpYXRyaXN0JyxcbiAgICAgICAgJ1JlZ3VsYXIgbW9vZCBtb25pdG9yaW5nIGFuZCBzYWZldHkgcGxhbm5pbmcnLFxuICAgICAgXSxcbiAgICAgIEFueGlldHk6IFtcbiAgICAgICAgJ0NCVCBvciBBY2NlcHRhbmNlIGFuZCBDb21taXRtZW50IFRoZXJhcHkgKEFDVCknLFxuICAgICAgICAnTWluZGZ1bG5lc3MgYW5kIHJlbGF4YXRpb24gdHJhaW5pbmcnLFxuICAgICAgICAnR3JhZHVhbCBleHBvc3VyZSB0byBhbnhpZXR5IHRyaWdnZXJzJyxcbiAgICAgIF0sXG4gICAgICAnUG9zdC10cmF1bWF0aWMgc3RyZXNzIGRpc29yZGVyIChQVFNEKSc6IFtcbiAgICAgICAgJ1RyYXVtYS1mb2N1c2VkIHRoZXJhcHkgKEVNRFIsIENQVCwgb3IgUEUpJyxcbiAgICAgICAgJ1NwZWNpYWxpemVkIFBUU0QgdHJlYXRtZW50IHByb2dyYW0nLFxuICAgICAgICAnU2FmZXR5IHBsYW5uaW5nIGFuZCBzdGFiaWxpemF0aW9uIGZpcnN0JyxcbiAgICAgIF0sXG4gICAgfTtcblxuICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKFxuICAgICAgLi4uKGNvbmRpdGlvblJlY3NbY29uZGl0aW9uXSB8fCBbXG4gICAgICAgICdFdmlkZW5jZS1iYXNlZCBwc3ljaG90aGVyYXB5JyxcbiAgICAgICAgJ1JlZ3VsYXIgbW9uaXRvcmluZyBvZiBzeW1wdG9tcycsXG4gICAgICAgICdQc3ljaG9lZHVjYXRpb24gYWJvdXQgdGhlIGNvbmRpdGlvbicsXG4gICAgICBdKSxcbiAgICApO1xuXG4gICAgcmV0dXJuIHJlY29tbWVuZGF0aW9ucztcbiAgfVxuXG4gIC8qKlxuICAgKiBDYXRlZ29yaXplIGNvbmRpdGlvbnMgaW50byBwcmltYXJ5IGFuZCBzZWNvbmRhcnkgYmFzZWQgb24gc2V2ZXJpdHkgYW5kIHJpc2tcbiAgICovXG4gIHByaXZhdGUgY2F0ZWdvcml6ZUNvbmRpdGlvbnMoaW5zaWdodHM6IENsaW5pY2FsSW5zaWdodFtdKToge1xuICAgIHByaW1hcnlDb25kaXRpb25zOiBDbGluaWNhbEluc2lnaHRbXTtcbiAgICBzZWNvbmRhcnlDb25kaXRpb25zOiBDbGluaWNhbEluc2lnaHRbXTtcbiAgfSB7XG4gICAgY29uc3QgcHJpbWFyeUNvbmRpdGlvbnMgPSBpbnNpZ2h0cy5maWx0ZXIoXG4gICAgICAoaW5zaWdodCkgPT5cbiAgICAgICAgaW5zaWdodC5wcmlvcml0eSA+PSA3IHx8XG4gICAgICAgIGluc2lnaHQucmlza0xldmVsID09PSAnY3JpdGljYWwnIHx8XG4gICAgICAgIGluc2lnaHQucmlza0xldmVsID09PSAnaGlnaCcsXG4gICAgKTtcblxuICAgIGNvbnN0IHNlY29uZGFyeUNvbmRpdGlvbnMgPSBpbnNpZ2h0cy5maWx0ZXIoXG4gICAgICAoaW5zaWdodCkgPT5cbiAgICAgICAgaW5zaWdodC5wcmlvcml0eSA8IDcgJiZcbiAgICAgICAgaW5zaWdodC5yaXNrTGV2ZWwgIT09ICdjcml0aWNhbCcgJiZcbiAgICAgICAgaW5zaWdodC5yaXNrTGV2ZWwgIT09ICdoaWdoJyxcbiAgICApO1xuXG4gICAgcmV0dXJuIHsgcHJpbWFyeUNvbmRpdGlvbnMsIHNlY29uZGFyeUNvbmRpdGlvbnMgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBc3Nlc3Mgb3ZlcmFsbCByaXNrIGZhY3RvcnMgcmVxdWlyaW5nIGltbWVkaWF0ZSBhdHRlbnRpb25cbiAgICovXG4gIHByaXZhdGUgYXNzZXNzUmlza0ZhY3RvcnMoXG4gICAgaW5zaWdodHM6IENsaW5pY2FsSW5zaWdodFtdLFxuICAgIHNjb3JlczogUXVlc3Rpb25uYWlyZVNjb3JlcyxcbiAgKTogUmlza0ZhY3RvcltdIHtcbiAgICBjb25zdCByaXNrRmFjdG9yczogUmlza0ZhY3RvcltdID0gW107XG5cbiAgICAvLyBDaGVjayBmb3Igc3VpY2lkZS9zZWxmLWhhcm0gcmlza1xuICAgIGNvbnN0IGRlcHJlc3Npb25JbnNpZ2h0ID0gaW5zaWdodHMuZmluZChcbiAgICAgIChpKSA9PiBpLmNvbmRpdGlvbiA9PT0gJ0RlcHJlc3Npb24nLFxuICAgICk7XG4gICAgaWYgKFxuICAgICAgZGVwcmVzc2lvbkluc2lnaHQgJiZcbiAgICAgIChkZXByZXNzaW9uSW5zaWdodC5jbGluaWNhbExldmVsID09PSAnc2V2ZXJlJyB8fFxuICAgICAgICBkZXByZXNzaW9uSW5zaWdodC5jbGluaWNhbExldmVsID09PSAnZXh0cmVtZScpXG4gICAgKSB7XG4gICAgICByaXNrRmFjdG9ycy5wdXNoKHtcbiAgICAgICAgdHlwZTogJ3N1aWNpZGUnLFxuICAgICAgICBsZXZlbDpcbiAgICAgICAgICBkZXByZXNzaW9uSW5zaWdodC5jbGluaWNhbExldmVsID09PSAnZXh0cmVtZScgPyAnY3JpdGljYWwnIDogJ2hpZ2gnLFxuICAgICAgICBpbmRpY2F0b3JzOiBbXG4gICAgICAgICAgJ1NldmVyZSBkZXByZXNzaW9uIHN5bXB0b21zJyxcbiAgICAgICAgICAnSGlnaCByaXNrIGZvciBzdWljaWRhbCBpZGVhdGlvbicsXG4gICAgICAgIF0sXG4gICAgICAgIHVyZ2VuY3k6XG4gICAgICAgICAgZGVwcmVzc2lvbkluc2lnaHQuY2xpbmljYWxMZXZlbCA9PT0gJ2V4dHJlbWUnXG4gICAgICAgICAgICA/ICdpbW1lZGlhdGUnXG4gICAgICAgICAgICA6ICd3aXRoaW5fd2VlaycsXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBmb3Igc3Vic3RhbmNlIGFidXNlIHJpc2tcbiAgICBjb25zdCBzdWJzdGFuY2VJbnNpZ2h0ID0gaW5zaWdodHMuZmluZChcbiAgICAgIChpKSA9PlxuICAgICAgICBpLmNvbmRpdGlvbi5pbmNsdWRlcygnU3Vic3RhbmNlJykgfHwgaS5jb25kaXRpb24uaW5jbHVkZXMoJ0FsY29ob2wnKSxcbiAgICApO1xuICAgIGlmIChzdWJzdGFuY2VJbnNpZ2h0ICYmIHN1YnN0YW5jZUluc2lnaHQuY2xpbmljYWxMZXZlbCAhPT0gJ3N1YmNsaW5pY2FsJykge1xuICAgICAgcmlza0ZhY3RvcnMucHVzaCh7XG4gICAgICAgIHR5cGU6ICdzdWJzdGFuY2VfYWJ1c2UnLFxuICAgICAgICBsZXZlbDogc3Vic3RhbmNlSW5zaWdodC5yaXNrTGV2ZWwsXG4gICAgICAgIGluZGljYXRvcnM6IFtcbiAgICAgICAgICAnUHJvYmxlbWF0aWMgc3Vic3RhbmNlIHVzZSBwYXR0ZXJucycsXG4gICAgICAgICAgJ1Jpc2sgZm9yIGRlcGVuZGVuY2UnLFxuICAgICAgICBdLFxuICAgICAgICB1cmdlbmN5OlxuICAgICAgICAgIHN1YnN0YW5jZUluc2lnaHQucmlza0xldmVsID09PSAnY3JpdGljYWwnXG4gICAgICAgICAgICA/ICdpbW1lZGlhdGUnXG4gICAgICAgICAgICA6ICd3aXRoaW5fbW9udGgnLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgZm9yIG1hbmlhIHJpc2sgKGJpcG9sYXIpXG4gICAgY29uc3QgYmlwb2xhckluc2lnaHQgPSBpbnNpZ2h0cy5maW5kKChpKSA9PlxuICAgICAgaS5jb25kaXRpb24uaW5jbHVkZXMoJ0JpcG9sYXInKSxcbiAgICApO1xuICAgIGlmIChcbiAgICAgIGJpcG9sYXJJbnNpZ2h0ICYmXG4gICAgICAoYmlwb2xhckluc2lnaHQuY2xpbmljYWxMZXZlbCA9PT0gJ3NldmVyZScgfHxcbiAgICAgICAgYmlwb2xhckluc2lnaHQuY2xpbmljYWxMZXZlbCA9PT0gJ2V4dHJlbWUnKVxuICAgICkge1xuICAgICAgcmlza0ZhY3RvcnMucHVzaCh7XG4gICAgICAgIHR5cGU6ICdtYW5pYScsXG4gICAgICAgIGxldmVsOiAnaGlnaCcsXG4gICAgICAgIGluZGljYXRvcnM6IFsnTWFuaWMgZXBpc29kZSBpbmRpY2F0b3JzJywgJ01vb2QgaW5zdGFiaWxpdHknXSxcbiAgICAgICAgdXJnZW5jeTogJ3dpdGhpbl93ZWVrJyxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiByaXNrRmFjdG9ycztcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxjdWxhdGUgb3ZlcmFsbCByaXNrIGxldmVsIGJhc2VkIG9uIGFsbCBmYWN0b3JzXG4gICAqL1xuICBwcml2YXRlIGNhbGN1bGF0ZU92ZXJhbGxSaXNrTGV2ZWwoXG4gICAgcmlza0ZhY3RvcnM6IFJpc2tGYWN0b3JbXSxcbiAgICBwcmltYXJ5Q29uZGl0aW9uczogQ2xpbmljYWxJbnNpZ2h0W10sXG4gICk6ICdsb3cnIHwgJ21vZGVyYXRlJyB8ICdoaWdoJyB8ICdjcml0aWNhbCcge1xuICAgIC8vIENoZWNrIGZvciBjcml0aWNhbCByaXNrIGZhY3RvcnNcbiAgICBpZiAoXG4gICAgICByaXNrRmFjdG9ycy5zb21lKChyZikgPT4gcmYubGV2ZWwgPT09ICdjcml0aWNhbCcpIHx8XG4gICAgICBwcmltYXJ5Q29uZGl0aW9ucy5zb21lKChwYykgPT4gcGMucmlza0xldmVsID09PSAnY3JpdGljYWwnKVxuICAgICkge1xuICAgICAgcmV0dXJuICdjcml0aWNhbCc7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgZm9yIGhpZ2ggcmlza1xuICAgIGlmIChcbiAgICAgIHJpc2tGYWN0b3JzLnNvbWUoKHJmKSA9PiByZi5sZXZlbCA9PT0gJ2hpZ2gnKSB8fFxuICAgICAgcHJpbWFyeUNvbmRpdGlvbnMuc29tZSgocGMpID0+IHBjLnJpc2tMZXZlbCA9PT0gJ2hpZ2gnKVxuICAgICkge1xuICAgICAgcmV0dXJuICdoaWdoJztcbiAgICB9XG5cbiAgICAvLyBDaGVjayBmb3IgbW9kZXJhdGUgcmlza1xuICAgIGlmIChwcmltYXJ5Q29uZGl0aW9ucy5zb21lKChwYykgPT4gcGMucmlza0xldmVsID09PSAnbW9kZXJhdGUnKSkge1xuICAgICAgcmV0dXJuICdtb2RlcmF0ZSc7XG4gICAgfVxuXG4gICAgcmV0dXJuICdsb3cnO1xuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIHRoZXJhcGV1dGljIHByaW9yaXRpZXMgYmFzZWQgb24gcHJpbWFyeSBjb25kaXRpb25zXG4gICAqL1xuICBwcml2YXRlIGdlbmVyYXRlVGhlcmFwZXV0aWNQcmlvcml0aWVzKFxuICAgIHByaW1hcnlDb25kaXRpb25zOiBDbGluaWNhbEluc2lnaHRbXSxcbiAgKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IHByaW9yaXRpZXM6IHN0cmluZ1tdID0gW107XG5cbiAgICAvLyBTYWZldHkgZmlyc3RcbiAgICBpZiAocHJpbWFyeUNvbmRpdGlvbnMuc29tZSgocGMpID0+IHBjLnJpc2tMZXZlbCA9PT0gJ2NyaXRpY2FsJykpIHtcbiAgICAgIHByaW9yaXRpZXMucHVzaCgnQ3Jpc2lzIGludGVydmVudGlvbiBhbmQgc2FmZXR5IHBsYW5uaW5nJyk7XG4gICAgfVxuXG4gICAgLy8gUHJpbWFyeSBzeW1wdG9tc1xuICAgIHByaW1hcnlDb25kaXRpb25zXG4gICAgICAuc29ydCgoYSwgYikgPT4gYi5wcmlvcml0eSAtIGEucHJpb3JpdHkpXG4gICAgICAuZm9yRWFjaCgoY29uZGl0aW9uKSA9PiB7XG4gICAgICAgIHByaW9yaXRpZXMucHVzaChgJHtjb25kaXRpb24uY29uZGl0aW9ufSBtYW5hZ2VtZW50IGFuZCB0cmVhdG1lbnRgKTtcbiAgICAgIH0pO1xuXG4gICAgLy8gRnVuY3Rpb25hbCBpbXByb3ZlbWVudFxuICAgIHByaW9yaXRpZXMucHVzaCgnRnVuY3Rpb25hbCBjYXBhY2l0eSBhbmQgcXVhbGl0eSBvZiBsaWZlIGltcHJvdmVtZW50Jyk7XG4gICAgcHJpb3JpdGllcy5wdXNoKCdMb25nLXRlcm0gcmVsYXBzZSBwcmV2ZW50aW9uJyk7XG5cbiAgICByZXR1cm4gcHJpb3JpdGllcy5zbGljZSgwLCA1KTsgLy8gVG9wIDUgcHJpb3JpdGllc1xuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIGNvbXByZWhlbnNpdmUgdHJlYXRtZW50IHJlY29tbWVuZGF0aW9uc1xuICAgKi9cbiAgcHJpdmF0ZSBnZW5lcmF0ZVRyZWF0bWVudFJlY29tbWVuZGF0aW9ucyhcbiAgICBwcmltYXJ5Q29uZGl0aW9uczogQ2xpbmljYWxJbnNpZ2h0W10sXG4gICAgc2Vjb25kYXJ5Q29uZGl0aW9uczogQ2xpbmljYWxJbnNpZ2h0W10sXG4gICAgcmlza0ZhY3RvcnM6IFJpc2tGYWN0b3JbXSxcbiAgKTogVHJlYXRtZW50UmVjb21tZW5kYXRpb25bXSB7XG4gICAgY29uc3QgcmVjb21tZW5kYXRpb25zOiBUcmVhdG1lbnRSZWNvbW1lbmRhdGlvbltdID0gW107XG5cbiAgICAvLyBQcmltYXJ5IGNvbmRpdGlvbnMgcmVjb21tZW5kYXRpb25zXG4gICAgcHJpbWFyeUNvbmRpdGlvbnMuZm9yRWFjaCgoY29uZGl0aW9uLCBpbmRleCkgPT4ge1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goe1xuICAgICAgICBwcmlvcml0eTogaW5kZXggKyAxLFxuICAgICAgICBjb25kaXRpb246IGNvbmRpdGlvbi5jb25kaXRpb24sXG4gICAgICAgIGFwcHJvYWNoOiB0aGlzLmdldFJlY29tbWVuZGVkQXBwcm9hY2hlcyhcbiAgICAgICAgICBjb25kaXRpb24uY29uZGl0aW9uLFxuICAgICAgICAgIGNvbmRpdGlvbi5jbGluaWNhbExldmVsLFxuICAgICAgICApLFxuICAgICAgICBzcGVjaWFsaXphdGlvbjogW2NvbmRpdGlvbi5jb25kaXRpb24sICdDbGluaWNhbCBQc3ljaG9sb2d5J10sXG4gICAgICAgIHVyZ2VuY3k6IHRoaXMubWFwUmlza1RvVXJnZW5jeShjb25kaXRpb24ucmlza0xldmVsKSxcbiAgICAgICAgZXN0aW1hdGVkRHVyYXRpb246IHRoaXMuZXN0aW1hdGVUcmVhdG1lbnREdXJhdGlvbihcbiAgICAgICAgICBjb25kaXRpb24uY2xpbmljYWxMZXZlbCxcbiAgICAgICAgKSxcbiAgICAgICAgZ29hbHM6IHRoaXMuZ2V0VGhlcmFwZXV0aWNHb2FscyhcbiAgICAgICAgICBjb25kaXRpb24uY29uZGl0aW9uLFxuICAgICAgICAgIGNvbmRpdGlvbi5jbGluaWNhbExldmVsLFxuICAgICAgICApLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBSaXNrLWJhc2VkIGVtZXJnZW5jeSByZWNvbW1lbmRhdGlvbnNcbiAgICByaXNrRmFjdG9ycy5mb3JFYWNoKChyaXNrKSA9PiB7XG4gICAgICBpZiAocmlzay51cmdlbmN5ID09PSAnaW1tZWRpYXRlJykge1xuICAgICAgICByZWNvbW1lbmRhdGlvbnMudW5zaGlmdCh7XG4gICAgICAgICAgcHJpb3JpdHk6IDAsIC8vIEhpZ2hlc3QgcHJpb3JpdHlcbiAgICAgICAgICBjb25kaXRpb246IHJpc2sudHlwZS5yZXBsYWNlKCdfJywgJyAnKSxcbiAgICAgICAgICBhcHByb2FjaDogWydDcmlzaXMgSW50ZXJ2ZW50aW9uJywgJ1NhZmV0eSBQbGFubmluZyddLFxuICAgICAgICAgIHNwZWNpYWxpemF0aW9uOiBbJ0NyaXNpcyBJbnRlcnZlbnRpb24nLCAnRW1lcmdlbmN5IFBzeWNob2xvZ3knXSxcbiAgICAgICAgICB1cmdlbmN5OiAnaW1tZWRpYXRlJyxcbiAgICAgICAgICBlc3RpbWF0ZWREdXJhdGlvbjogJ0ltbWVkaWF0ZSBhc3Nlc3NtZW50JyxcbiAgICAgICAgICBnb2FsczogWydFbnN1cmUgc2FmZXR5JywgJ1N0YWJpbGl6ZSBhY3V0ZSBzeW1wdG9tcyddLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiByZWNvbW1lbmRhdGlvbnM7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHJlY29tbWVuZGVkIHRoZXJhcGV1dGljIGFwcHJvYWNoZXMgZm9yIGEgY29uZGl0aW9uXG4gICAqL1xuICBwcml2YXRlIGdldFJlY29tbWVuZGVkQXBwcm9hY2hlcyhcbiAgICBjb25kaXRpb246IHN0cmluZyxcbiAgICBjbGluaWNhbExldmVsOiBzdHJpbmcsXG4gICk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBhcHByb2FjaGVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT4gPSB7XG4gICAgICBEZXByZXNzaW9uOiBbXG4gICAgICAgICdDb2duaXRpdmUgQmVoYXZpb3JhbCBUaGVyYXB5IChDQlQpJyxcbiAgICAgICAgJ0ludGVycGVyc29uYWwgVGhlcmFweSAoSVBUKScsXG4gICAgICAgICdNaW5kZnVsbmVzcy1CYXNlZCBDb2duaXRpdmUgVGhlcmFweScsXG4gICAgICBdLFxuICAgICAgQW54aWV0eTogW1xuICAgICAgICAnQ29nbml0aXZlIEJlaGF2aW9yYWwgVGhlcmFweSAoQ0JUKScsXG4gICAgICAgICdBY2NlcHRhbmNlIGFuZCBDb21taXRtZW50IFRoZXJhcHkgKEFDVCknLFxuICAgICAgICAnRXhwb3N1cmUgVGhlcmFweScsXG4gICAgICBdLFxuICAgICAgJ1Bvc3QtdHJhdW1hdGljIHN0cmVzcyBkaXNvcmRlciAoUFRTRCknOiBbXG4gICAgICAgICdFTURSJyxcbiAgICAgICAgJ0NvZ25pdGl2ZSBQcm9jZXNzaW5nIFRoZXJhcHknLFxuICAgICAgICAnUHJvbG9uZ2VkIEV4cG9zdXJlIFRoZXJhcHknLFxuICAgICAgXSxcbiAgICAgICdCaXBvbGFyIGRpc29yZGVyIChCRCknOiBbXG4gICAgICAgICdEaWFsZWN0aWNhbCBCZWhhdmlvciBUaGVyYXB5IChEQlQpJyxcbiAgICAgICAgJ0NvZ25pdGl2ZSBCZWhhdmlvcmFsIFRoZXJhcHkgKENCVCknLFxuICAgICAgICAnUHN5Y2hvZWR1Y2F0aW9uJyxcbiAgICAgIF0sXG4gICAgfTtcblxuICAgIHJldHVybiAoXG4gICAgICBhcHByb2FjaGVzW2NvbmRpdGlvbl0gfHwgW1xuICAgICAgICAnQ29nbml0aXZlIEJlaGF2aW9yYWwgVGhlcmFweSAoQ0JUKScsXG4gICAgICAgICdQc3ljaG9keW5hbWljIFRoZXJhcHknLFxuICAgICAgXVxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogTWFwIHJpc2sgbGV2ZWwgdG8gdHJlYXRtZW50IHVyZ2VuY3lcbiAgICovXG4gIHByaXZhdGUgbWFwUmlza1RvVXJnZW5jeShcbiAgICByaXNrTGV2ZWw6IHN0cmluZyxcbiAgKTogJ2ltbWVkaWF0ZScgfCAnaGlnaCcgfCAnbW9kZXJhdGUnIHwgJ3JvdXRpbmUnIHtcbiAgICBjb25zdCBtYXBwaW5nID0ge1xuICAgICAgY3JpdGljYWw6ICdpbW1lZGlhdGUnIGFzIGNvbnN0LFxuICAgICAgaGlnaDogJ2hpZ2gnIGFzIGNvbnN0LFxuICAgICAgbW9kZXJhdGU6ICdtb2RlcmF0ZScgYXMgY29uc3QsXG4gICAgICBsb3c6ICdyb3V0aW5lJyBhcyBjb25zdCxcbiAgICB9O1xuICAgIHJldHVybiBtYXBwaW5nW3Jpc2tMZXZlbF0gfHwgJ3JvdXRpbmUnO1xuICB9XG5cbiAgLyoqXG4gICAqIEVzdGltYXRlIHRyZWF0bWVudCBkdXJhdGlvbiBiYXNlZCBvbiBzZXZlcml0eVxuICAgKi9cbiAgcHJpdmF0ZSBlc3RpbWF0ZVRyZWF0bWVudER1cmF0aW9uKGNsaW5pY2FsTGV2ZWw6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgZHVyYXRpb25zID0ge1xuICAgICAgZXh0cmVtZTogJzEyLTE4IG1vbnRocyBpbnRlbnNpdmUgdGhlcmFweScsXG4gICAgICBzZXZlcmU6ICc2LTEyIG1vbnRocyByZWd1bGFyIHRoZXJhcHknLFxuICAgICAgbW9kZXJhdGU6ICczLTYgbW9udGhzIHRoZXJhcHknLFxuICAgICAgbWlsZDogJzItNCBtb250aHMgdGhlcmFweScsXG4gICAgICBzdWJjbGluaWNhbDogJzEtMiBtb250aHMgYnJpZWYgaW50ZXJ2ZW50aW9uJyxcbiAgICB9O1xuICAgIHJldHVybiBkdXJhdGlvbnNbY2xpbmljYWxMZXZlbF0gfHwgJzMtNiBtb250aHMgdGhlcmFweSc7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRoZXJhcGV1dGljIGdvYWxzIGZvciBhIGNvbmRpdGlvblxuICAgKi9cbiAgcHJpdmF0ZSBnZXRUaGVyYXBldXRpY0dvYWxzKFxuICAgIGNvbmRpdGlvbjogc3RyaW5nLFxuICAgIGNsaW5pY2FsTGV2ZWw6IHN0cmluZyxcbiAgKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IGdvYWxzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT4gPSB7XG4gICAgICBEZXByZXNzaW9uOiBbXG4gICAgICAgICdSZWR1Y2UgZGVwcmVzc2l2ZSBzeW1wdG9tcycsXG4gICAgICAgICdJbXByb3ZlIG1vb2QgcmVndWxhdGlvbicsXG4gICAgICAgICdJbmNyZWFzZSBiZWhhdmlvcmFsIGFjdGl2YXRpb24nLFxuICAgICAgICAnRW5oYW5jZSBjb3Bpbmcgc3RyYXRlZ2llcycsXG4gICAgICBdLFxuICAgICAgQW54aWV0eTogW1xuICAgICAgICAnUmVkdWNlIGFueGlldHkgc3ltcHRvbXMnLFxuICAgICAgICAnRGV2ZWxvcCByZWxheGF0aW9uIHNraWxscycsXG4gICAgICAgICdJbmNyZWFzZSB0b2xlcmFuY2UgZm9yIHVuY2VydGFpbnR5JyxcbiAgICAgICAgJ0ltcHJvdmUgZGFpbHkgZnVuY3Rpb25pbmcnLFxuICAgICAgXSxcbiAgICB9O1xuXG4gICAgcmV0dXJuIChcbiAgICAgIGdvYWxzW2NvbmRpdGlvbl0gfHwgW1xuICAgICAgICAnUmVkdWNlIHN5bXB0b20gc2V2ZXJpdHknLFxuICAgICAgICAnSW1wcm92ZSBmdW5jdGlvbmFsIGNhcGFjaXR5JyxcbiAgICAgICAgJ0RldmVsb3AgY29waW5nIHN0cmF0ZWdpZXMnLFxuICAgICAgICAnUHJldmVudCByZWxhcHNlJyxcbiAgICAgIF1cbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIGNsaW5pY2FsIHN1bW1hcnlcbiAgICovXG4gIHByaXZhdGUgZ2VuZXJhdGVDbGluaWNhbFN1bW1hcnkoXG4gICAgcHJpbWFyeUNvbmRpdGlvbnM6IENsaW5pY2FsSW5zaWdodFtdLFxuICAgIHNlY29uZGFyeUNvbmRpdGlvbnM6IENsaW5pY2FsSW5zaWdodFtdLFxuICAgIG92ZXJhbGxSaXNrTGV2ZWw6IHN0cmluZyxcbiAgKTogc3RyaW5nIHtcbiAgICBjb25zdCBwcmltYXJ5Q291bnQgPSBwcmltYXJ5Q29uZGl0aW9ucy5sZW5ndGg7XG4gICAgY29uc3Qgc2Vjb25kYXJ5Q291bnQgPSBzZWNvbmRhcnlDb25kaXRpb25zLmxlbmd0aDtcblxuICAgIGxldCBzdW1tYXJ5ID0gYENsaW5pY2FsIGFzc2Vzc21lbnQgcmV2ZWFscyBgO1xuXG4gICAgaWYgKHByaW1hcnlDb3VudCA+IDApIHtcbiAgICAgIGNvbnN0IHByaW1hcnlOYW1lcyA9IHByaW1hcnlDb25kaXRpb25zLm1hcCgoYykgPT4gYy5jb25kaXRpb24pLmpvaW4oJywgJyk7XG4gICAgICBzdW1tYXJ5ICs9IGAke3ByaW1hcnlDb3VudH0gcHJpbWFyeSBjb25kaXRpb24ocykgcmVxdWlyaW5nIGltbWVkaWF0ZSBhdHRlbnRpb246ICR7cHJpbWFyeU5hbWVzfS4gYDtcbiAgICB9XG5cbiAgICBpZiAoc2Vjb25kYXJ5Q291bnQgPiAwKSB7XG4gICAgICBzdW1tYXJ5ICs9IGAke3NlY29uZGFyeUNvdW50fSBzZWNvbmRhcnkgY29uZGl0aW9uKHMpIGlkZW50aWZpZWQgZm9yIG9uZ29pbmcgbW9uaXRvcmluZy4gYDtcbiAgICB9XG5cbiAgICBzdW1tYXJ5ICs9IGBPdmVyYWxsIHJpc2sgbGV2ZWw6ICR7b3ZlcmFsbFJpc2tMZXZlbH0uIGA7XG5cbiAgICBpZiAob3ZlcmFsbFJpc2tMZXZlbCA9PT0gJ2NyaXRpY2FsJyB8fCBvdmVyYWxsUmlza0xldmVsID09PSAnaGlnaCcpIHtcbiAgICAgIHN1bW1hcnkgKz0gJ0ltbWVkaWF0ZSBwcm9mZXNzaW9uYWwgaW50ZXJ2ZW50aW9uIHJlY29tbWVuZGVkLic7XG4gICAgfSBlbHNlIGlmIChvdmVyYWxsUmlza0xldmVsID09PSAnbW9kZXJhdGUnKSB7XG4gICAgICBzdW1tYXJ5ICs9ICdSZWd1bGFyIHRoZXJhcGV1dGljIHN1cHBvcnQgcmVjb21tZW5kZWQuJztcbiAgICB9IGVsc2Uge1xuICAgICAgc3VtbWFyeSArPSAnUHJldmVudGl2ZSBpbnRlcnZlbnRpb24gYW5kIG1vbml0b3JpbmcgcmVjb21tZW5kZWQuJztcbiAgICB9XG5cbiAgICByZXR1cm4gc3VtbWFyeTtcbiAgfVxufVxuIl0sInZlcnNpb24iOjN9