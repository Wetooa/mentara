{"version":3,"names":["cov_ttbncxvus","actualCoverage","s","common_1","require","exports","ROLES_KEY","Roles","roles","f","SetMetadata","AdminOnly","ModeratorOnly","TherapistOnly","ClientOnly","ModeratorOrAdmin","TherapistOrAdmin","PERMISSIONS_KEY","RequirePermissions","permissions","RESOURCE_OWNER_KEY","AllowResourceOwner","paramName","b","AdminOrResourceOwner","target","propertyKey","descriptor","TherapistOrResourceOwner","TherapySessionAccess","AssessmentAccess","ModerationAccess"],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/auth/decorators/roles.decorator.ts"],"sourcesContent":["import { SetMetadata } from '@nestjs/common';\n\n// Role-based decorators\nexport const ROLES_KEY = 'roles';\nexport const Roles = (...roles: string[]) => SetMetadata(ROLES_KEY, roles);\n\n// Specific role decorators for convenience\nexport const AdminOnly = () => SetMetadata(ROLES_KEY, ['admin']);\nexport const ModeratorOnly = () => SetMetadata(ROLES_KEY, ['moderator']);\nexport const TherapistOnly = () => SetMetadata(ROLES_KEY, ['therapist']);\nexport const ClientOnly = () => SetMetadata(ROLES_KEY, ['client']);\n\n// Combined role decorators\nexport const ModeratorOrAdmin = () =>\n  SetMetadata(ROLES_KEY, ['moderator', 'admin']);\nexport const TherapistOrAdmin = () =>\n  SetMetadata(ROLES_KEY, ['therapist', 'admin']);\n\n// Permission-based decorators\nexport const PERMISSIONS_KEY = 'permissions';\nexport const RequirePermissions = (...permissions: string[]) =>\n  SetMetadata(PERMISSIONS_KEY, permissions);\n\n// Resource ownership decorator\nexport const RESOURCE_OWNER_KEY = 'resource_owner';\nexport const AllowResourceOwner = (paramName: string = 'id') =>\n  SetMetadata(RESOURCE_OWNER_KEY, paramName);\n\n// Combined decorators for common scenarios\nexport const AdminOrResourceOwner =\n  (paramName: string = 'id') =>\n  (target: any, propertyKey: string, descriptor: PropertyDescriptor) => {\n    SetMetadata(ROLES_KEY, ['admin'])(target, propertyKey, descriptor);\n    SetMetadata(RESOURCE_OWNER_KEY, paramName)(target, propertyKey, descriptor);\n  };\n\nexport const TherapistOrResourceOwner =\n  (paramName: string = 'id') =>\n  (target: any, propertyKey: string, descriptor: PropertyDescriptor) => {\n    SetMetadata(ROLES_KEY, ['therapist', 'admin'])(\n      target,\n      propertyKey,\n      descriptor,\n    );\n    SetMetadata(RESOURCE_OWNER_KEY, paramName)(target, propertyKey, descriptor);\n  };\n\n// Therapy session access (therapist assigned to client or admin)\nexport const TherapySessionAccess = () =>\n  RequirePermissions('sessions:read:own', 'sessions:read:all');\n\n// Assessment access (client's own assessments, assigned therapist, or admin)\nexport const AssessmentAccess = () =>\n  RequirePermissions(\n    'assessments:read:own',\n    'assessments:read:assigned',\n    'assessments:read:all',\n  );\n\n// Moderation access (moderators and admins)\nexport const ModerationAccess = () =>\n  RequirePermissions(\n    'posts:moderate',\n    'communities:moderate',\n    'messages:moderate',\n  );\n"],"mappings":"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","ignoreList":[]}