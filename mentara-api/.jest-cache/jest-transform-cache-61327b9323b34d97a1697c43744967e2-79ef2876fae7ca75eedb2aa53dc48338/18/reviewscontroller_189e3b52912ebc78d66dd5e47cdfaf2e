98039b306b2608c582195febf2651ca0
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k;
Object.defineProperty(exports, "__esModule", { value: true });
exports.ReviewsController = void 0;
const common_1 = require("@nestjs/common");
const reviews_service_1 = require("./reviews.service");
const jwt_auth_guard_1 = require("../auth/guards/jwt-auth.guard");
const current_user_id_decorator_1 = require("../auth/decorators/current-user-id.decorator");
const current_user_role_decorator_1 = require("../auth/decorators/current-user-role.decorator");
const zod_validation_pipe_1 = require("../common/pipes/zod-validation.pipe");
const swagger_1 = require("@nestjs/swagger");
const mentara_commons_1 = require("mentara-commons");
let ReviewsController = class ReviewsController {
    reviewsService;
    constructor(reviewsService) {
        this.reviewsService = reviewsService;
    }
    async createReview(meetingId, clientId, therapistId, createReviewDto) {
        return this.reviewsService.createReview(meetingId, clientId, therapistId, createReviewDto);
    }
    async updateReview(reviewId, clientId, updateReviewDto) {
        return this.reviewsService.updateReview(reviewId, clientId, updateReviewDto);
    }
    async deleteReview(reviewId, clientId) {
        return this.reviewsService.deleteReview(reviewId, clientId);
    }
    async getReviews(query) {
        return this.reviewsService.getReviews(query);
    }
    async getTherapistReviews(therapistId, query) {
        return this.reviewsService.getTherapistReviews(therapistId, query);
    }
    async getTherapistReviewStats(therapistId) {
        return this.reviewsService.getReviewStats(therapistId);
    }
    async markReviewHelpful(reviewId, userId) {
        return this.reviewsService.markReviewHelpful(reviewId, userId);
    }
    // Admin/Moderator endpoints
    async moderateReview(reviewId, moderatorId, userRole, moderateReviewDto) {
        // Only allow moderators and admins to moderate reviews
        if (!['moderator', 'admin'].includes(userRole)) {
            throw new common_1.ForbiddenException('Insufficient permissions');
        }
        return this.reviewsService.moderateReview(reviewId, moderatorId, moderateReviewDto);
    }
    async getPendingReviews(userRole, query) {
        // Only allow moderators and admins to view pending reviews
        if (!['moderator', 'admin'].includes(userRole)) {
            throw new common_1.ForbiddenException('Insufficient permissions');
        }
        return this.reviewsService.getReviews({
            ...query,
            status: 'PENDING',
        });
    }
};
exports.ReviewsController = ReviewsController;
__decorate([
    (0, common_1.Post)(':meetingId/:therapistId'),
    (0, swagger_1.ApiOperation)({
        summary: 'Create create review',
        description: 'Create create review',
    }),
    (0, swagger_1.ApiResponse)({
        status: 201,
        description: 'Created successfully',
    }),
    (0, swagger_1.ApiResponse)({ status: 401, description: 'Unauthorized' }),
    (0, common_1.HttpCode)(common_1.HttpStatus.CREATED),
    __param(0, (0, common_1.Param)('meetingId')),
    __param(1, (0, current_user_id_decorator_1.CurrentUserId)()),
    __param(2, (0, common_1.Param)('therapistId')),
    __param(3, (0, common_1.Body)(new zod_validation_pipe_1.ZodValidationPipe(mentara_commons_1.CreateReviewDtoSchema))),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, String, String, typeof (_b = typeof mentara_commons_1.CreateReviewDto !== "undefined" && mentara_commons_1.CreateReviewDto) === "function" ? _b : Object]),
    __metadata("design:returntype", Promise)
], ReviewsController.prototype, "createReview", null);
__decorate([
    (0, common_1.Put)(':id'),
    (0, swagger_1.ApiOperation)({
        summary: 'Update update review',
        description: 'Update update review',
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Updated successfully',
    }),
    (0, swagger_1.ApiResponse)({ status: 401, description: 'Unauthorized' }),
    __param(0, (0, common_1.Param)('id')),
    __param(1, (0, current_user_id_decorator_1.CurrentUserId)()),
    __param(2, (0, common_1.Body)(new zod_validation_pipe_1.ZodValidationPipe(mentara_commons_1.UpdateReviewDtoSchema))),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, String, typeof (_c = typeof mentara_commons_1.UpdateReviewDto !== "undefined" && mentara_commons_1.UpdateReviewDto) === "function" ? _c : Object]),
    __metadata("design:returntype", Promise)
], ReviewsController.prototype, "updateReview", null);
__decorate([
    (0, common_1.Delete)(':id'),
    (0, swagger_1.ApiOperation)({
        summary: 'Delete delete review',
        description: 'Delete delete review',
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Deleted successfully',
    }),
    (0, swagger_1.ApiResponse)({ status: 401, description: 'Unauthorized' }),
    (0, common_1.HttpCode)(common_1.HttpStatus.NO_CONTENT),
    __param(0, (0, common_1.Param)('id')),
    __param(1, (0, current_user_id_decorator_1.CurrentUserId)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, String]),
    __metadata("design:returntype", Promise)
], ReviewsController.prototype, "deleteReview", null);
__decorate([
    (0, common_1.Get)(),
    (0, swagger_1.ApiOperation)({
        summary: 'Retrieve get reviews',
        description: 'Retrieve get reviews',
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Retrieved successfully',
    }),
    (0, swagger_1.ApiResponse)({ status: 401, description: 'Unauthorized' }),
    __param(0, (0, common_1.Query)(new zod_validation_pipe_1.ZodValidationPipe(mentara_commons_1.GetReviewsDtoSchema))),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [typeof (_d = typeof mentara_commons_1.GetReviewsDto !== "undefined" && mentara_commons_1.GetReviewsDto) === "function" ? _d : Object]),
    __metadata("design:returntype", typeof (_e = typeof Promise !== "undefined" && Promise) === "function" ? _e : Object)
], ReviewsController.prototype, "getReviews", null);
__decorate([
    (0, common_1.Get)('therapist/:therapistId'),
    (0, swagger_1.ApiOperation)({
        summary: 'Retrieve get therapist reviews',
        description: 'Retrieve get therapist reviews',
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Retrieved successfully',
    }),
    (0, swagger_1.ApiResponse)({ status: 401, description: 'Unauthorized' }),
    __param(0, (0, common_1.Param)('therapistId')),
    __param(1, (0, common_1.Query)(new zod_validation_pipe_1.ZodValidationPipe(mentara_commons_1.GetReviewsDtoSchema))),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, typeof (_f = typeof Omit !== "undefined" && Omit) === "function" ? _f : Object]),
    __metadata("design:returntype", typeof (_g = typeof Promise !== "undefined" && Promise) === "function" ? _g : Object)
], ReviewsController.prototype, "getTherapistReviews", null);
__decorate([
    (0, common_1.Get)('therapist/:therapistId/stats'),
    (0, swagger_1.ApiOperation)({
        summary: 'Retrieve get therapist review stats',
        description: 'Retrieve get therapist review stats',
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Retrieved successfully',
    }),
    (0, swagger_1.ApiResponse)({ status: 401, description: 'Unauthorized' }),
    __param(0, (0, common_1.Param)('therapistId')),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String]),
    __metadata("design:returntype", Promise)
], ReviewsController.prototype, "getTherapistReviewStats", null);
__decorate([
    (0, common_1.Post)(':id/helpful'),
    (0, swagger_1.ApiOperation)({
        summary: 'Create mark review helpful',
        description: 'Create mark review helpful',
    }),
    (0, swagger_1.ApiResponse)({
        status: 201,
        description: 'Created successfully',
    }),
    (0, swagger_1.ApiResponse)({ status: 401, description: 'Unauthorized' }),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, common_1.Param)('id', new zod_validation_pipe_1.ZodValidationPipe(mentara_commons_1.ReviewIdParamSchema))),
    __param(1, (0, current_user_id_decorator_1.CurrentUserId)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, String]),
    __metadata("design:returntype", Promise)
], ReviewsController.prototype, "markReviewHelpful", null);
__decorate([
    (0, common_1.Post)(':id/moderate'),
    (0, swagger_1.ApiOperation)({
        summary: 'Create moderate review',
        description: 'Create moderate review',
    }),
    (0, swagger_1.ApiResponse)({
        status: 201,
        description: 'Created successfully',
    }),
    (0, swagger_1.ApiResponse)({ status: 401, description: 'Unauthorized' }),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, common_1.Param)('id', new zod_validation_pipe_1.ZodValidationPipe(mentara_commons_1.ReviewIdParamSchema))),
    __param(1, (0, current_user_id_decorator_1.CurrentUserId)()),
    __param(2, (0, current_user_role_decorator_1.CurrentUserRole)()),
    __param(3, (0, common_1.Body)(new zod_validation_pipe_1.ZodValidationPipe(mentara_commons_1.ModerateReviewDtoSchema))),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, String, String, typeof (_h = typeof mentara_commons_1.ModerateReviewDto !== "undefined" && mentara_commons_1.ModerateReviewDto) === "function" ? _h : Object]),
    __metadata("design:returntype", Promise)
], ReviewsController.prototype, "moderateReview", null);
__decorate([
    (0, common_1.Get)('pending'),
    (0, swagger_1.ApiOperation)({
        summary: 'Retrieve get pending reviews',
        description: 'Retrieve get pending reviews',
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Retrieved successfully',
    }),
    (0, swagger_1.ApiResponse)({ status: 401, description: 'Unauthorized' }),
    __param(0, (0, current_user_role_decorator_1.CurrentUserRole)()),
    __param(1, (0, common_1.Query)(new zod_validation_pipe_1.ZodValidationPipe(mentara_commons_1.GetReviewsDtoSchema))),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, typeof (_j = typeof mentara_commons_1.GetReviewsDto !== "undefined" && mentara_commons_1.GetReviewsDto) === "function" ? _j : Object]),
    __metadata("design:returntype", typeof (_k = typeof Promise !== "undefined" && Promise) === "function" ? _k : Object)
], ReviewsController.prototype, "getPendingReviews", null);
exports.ReviewsController = ReviewsController = __decorate([
    (0, swagger_1.ApiTags)('reviews'),
    (0, swagger_1.ApiBearerAuth)('JWT-auth'),
    (0, common_1.Controller)('reviews'),
    (0, common_1.UseGuards)(jwt_auth_guard_1.JwtAuthGuard),
    __metadata("design:paramtypes", [typeof (_a = typeof reviews_service_1.ReviewsService !== "undefined" && reviews_service_1.ReviewsService) === "function" ? _a : Object])
], ReviewsController);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL3Jldmlld3MvcmV2aWV3cy5jb250cm9sbGVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSwyQ0Fhd0I7QUFDeEIsdURBQW1EO0FBQ25ELGtFQUE2RDtBQUM3RCw0RkFBNkU7QUFDN0UsZ0dBQWlGO0FBQ2pGLDZFQUF3RTtBQUN4RSw2Q0FReUI7QUFDekIscURBY3lCO0FBTWxCLElBQU0saUJBQWlCLEdBQXZCLE1BQU0saUJBQWlCO0lBQ0M7SUFBN0IsWUFBNkIsY0FBOEI7UUFBOUIsbUJBQWMsR0FBZCxjQUFjLENBQWdCO0lBQUcsQ0FBQztJQWV6RCxBQUFOLEtBQUssQ0FBQyxZQUFZLENBQ0ksU0FBaUIsRUFDcEIsUUFBZ0IsRUFDWCxXQUFtQixFQUV6QyxlQUFnQztRQUVoQyxPQUFPLElBQUksQ0FBQyxjQUFjLENBQUMsWUFBWSxDQUNyQyxTQUFTLEVBQ1QsUUFBUSxFQUNSLFdBQVcsRUFDWCxlQUFlLENBQ2hCLENBQUM7SUFDSixDQUFDO0lBY0ssQUFBTixLQUFLLENBQUMsWUFBWSxDQUNILFFBQWdCLEVBQ1osUUFBZ0IsRUFFakMsZUFBZ0M7UUFFaEMsT0FBTyxJQUFJLENBQUMsY0FBYyxDQUFDLFlBQVksQ0FDckMsUUFBUSxFQUNSLFFBQVEsRUFDUixlQUFlLENBQ2hCLENBQUM7SUFDSixDQUFDO0lBZUssQUFBTixLQUFLLENBQUMsWUFBWSxDQUNILFFBQWdCLEVBQ1osUUFBZ0I7UUFFakMsT0FBTyxJQUFJLENBQUMsY0FBYyxDQUFDLFlBQVksQ0FBQyxRQUFRLEVBQUUsUUFBUSxDQUFDLENBQUM7SUFDOUQsQ0FBQztJQWNLLEFBQU4sS0FBSyxDQUFDLFVBQVUsQ0FDcUMsS0FBb0I7UUFFdkUsT0FBTyxJQUFJLENBQUMsY0FBYyxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUMvQyxDQUFDO0lBY0ssQUFBTixLQUFLLENBQUMsbUJBQW1C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QU0sRUFBRSxHQUFHO1FBRVgsV0FBVyxFQUFFLHdCQUF3QjtLQUN0QyxDQUFDO0lBQ0QsSUFBQSxxQkFBVyxFQUFDLEVBQUUsTUFBTSxFQUFFLEdBQUcsRUFBRSxXQUFXLEVBQUUsY0FBYyxFQUFFLENBQUM7SUFFdkQsV0FBQSxJQUFBLDZDQUFlLEdBQUUsQ0FBQTtJQUNqQixXQUFBLElBQUEsY0FBSyxFQUFDLElBQUksdUNBQWlCLENBQUMscUNBQW1CLENBQUMsQ0FBQyxDQUFBOztpRUFBUSwrQkFBYSxvQkFBYiwrQkFBYTt3REFDdEUsT0FBTyxvQkFBUCxPQUFPOzBEQVVUOzRCQWhOVSxpQkFBaUI7SUFKN0IsSUFBQSxpQkFBTyxFQUFDLFNBQVMsQ0FBQztJQUNsQixJQUFBLHVCQUFhLEVBQUMsVUFBVSxDQUFDO0lBQ3pCLElBQUEsbUJBQVUsRUFBQyxTQUFTLENBQUM7SUFDckIsSUFBQSxrQkFBUyxFQUFDLDZCQUFZLENBQUM7eURBRXVCLGdDQUFjLG9CQUFkLGdDQUFjO0dBRGhELGlCQUFpQixDQWlON0IiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL3Jldmlld3MvcmV2aWV3cy5jb250cm9sbGVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIENvbnRyb2xsZXIsXG4gIEdldCxcbiAgUG9zdCxcbiAgUHV0LFxuICBEZWxldGUsXG4gIEJvZHksXG4gIFBhcmFtLFxuICBRdWVyeSxcbiAgVXNlR3VhcmRzLFxuICBIdHRwQ29kZSxcbiAgSHR0cFN0YXR1cyxcbiAgRm9yYmlkZGVuRXhjZXB0aW9uLFxufSBmcm9tICdAbmVzdGpzL2NvbW1vbic7XG5pbXBvcnQgeyBSZXZpZXdzU2VydmljZSB9IGZyb20gJy4vcmV2aWV3cy5zZXJ2aWNlJztcbmltcG9ydCB7IEp3dEF1dGhHdWFyZCB9IGZyb20gJy4uL2F1dGgvZ3VhcmRzL2p3dC1hdXRoLmd1YXJkJztcbmltcG9ydCB7IEN1cnJlbnRVc2VySWQgfSBmcm9tICcuLi9hdXRoL2RlY29yYXRvcnMvY3VycmVudC11c2VyLWlkLmRlY29yYXRvcic7XG5pbXBvcnQgeyBDdXJyZW50VXNlclJvbGUgfSBmcm9tICcuLi9hdXRoL2RlY29yYXRvcnMvY3VycmVudC11c2VyLXJvbGUuZGVjb3JhdG9yJztcbmltcG9ydCB7IFpvZFZhbGlkYXRpb25QaXBlIH0gZnJvbSAnLi4vY29tbW9uL3BpcGVzL3pvZC12YWxpZGF0aW9uLnBpcGUnO1xuaW1wb3J0IHtcbiAgQXBpVGFncyxcbiAgQXBpT3BlcmF0aW9uLFxuICBBcGlSZXNwb25zZSxcbiAgQXBpQm9keSxcbiAgQXBpQmVhcmVyQXV0aCxcbiAgQXBpUGFyYW0sXG4gIEFwaVF1ZXJ5LFxufSBmcm9tICdAbmVzdGpzL3N3YWdnZXInO1xuaW1wb3J0IHtcbiAgQ3JlYXRlUmV2aWV3RHRvLFxuICBDcmVhdGVSZXZpZXdEdG9TY2hlbWEsXG4gIFVwZGF0ZVJldmlld0R0byxcbiAgVXBkYXRlUmV2aWV3RHRvU2NoZW1hLFxuICBNb2RlcmF0ZVJldmlld0R0byxcbiAgTW9kZXJhdGVSZXZpZXdEdG9TY2hlbWEsXG4gIEdldFJldmlld3NEdG8sXG4gIEdldFJldmlld3NEdG9TY2hlbWEsXG4gIFJldmlld0lkUGFyYW0sXG4gIFJldmlld0lkUGFyYW1TY2hlbWEsXG4gIFJldmlldyxcbiAgUmV2aWV3TGlzdFJlc3BvbnNlLFxuICBSZXZpZXdTdGF0cyxcbn0gZnJvbSAnbWVudGFyYS1jb21tb25zJztcblxuQEFwaVRhZ3MoJ3Jldmlld3MnKVxuQEFwaUJlYXJlckF1dGgoJ0pXVC1hdXRoJylcbkBDb250cm9sbGVyKCdyZXZpZXdzJylcbkBVc2VHdWFyZHMoSnd0QXV0aEd1YXJkKVxuZXhwb3J0IGNsYXNzIFJldmlld3NDb250cm9sbGVyIHtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSByZWFkb25seSByZXZpZXdzU2VydmljZTogUmV2aWV3c1NlcnZpY2UpIHt9XG5cbiAgQFBvc3QoJzptZWV0aW5nSWQvOnRoZXJhcGlzdElkJylcbiAgQEFwaU9wZXJhdGlvbih7XG4gICAgc3VtbWFyeTogJ0NyZWF0ZSBjcmVhdGUgcmV2aWV3JyxcblxuICAgIGRlc2NyaXB0aW9uOiAnQ3JlYXRlIGNyZWF0ZSByZXZpZXcnLFxuICB9KVxuICBAQXBpUmVzcG9uc2Uoe1xuICAgIHN0YXR1czogMjAxLFxuXG4gICAgZGVzY3JpcHRpb246ICdDcmVhdGVkIHN1Y2Nlc3NmdWxseScsXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7IHN0YXR1czogNDAxLCBkZXNjcmlwdGlvbjogJ1VuYXV0aG9yaXplZCcgfSlcbiAgQEh0dHBDb2RlKEh0dHBTdGF0dXMuQ1JFQVRFRClcbiAgYXN5bmMgY3JlYXRlUmV2aWV3KFxuICAgIEBQYXJhbSgnbWVldGluZ0lkJykgbWVldGluZ0lkOiBzdHJpbmcsXG4gICAgQEN1cnJlbnRVc2VySWQoKSBjbGllbnRJZDogc3RyaW5nLFxuICAgIEBQYXJhbSgndGhlcmFwaXN0SWQnKSB0aGVyYXBpc3RJZDogc3RyaW5nLFxuICAgIEBCb2R5KG5ldyBab2RWYWxpZGF0aW9uUGlwZShDcmVhdGVSZXZpZXdEdG9TY2hlbWEpKVxuICAgIGNyZWF0ZVJldmlld0R0bzogQ3JlYXRlUmV2aWV3RHRvLFxuICApIHtcbiAgICByZXR1cm4gdGhpcy5yZXZpZXdzU2VydmljZS5jcmVhdGVSZXZpZXcoXG4gICAgICBtZWV0aW5nSWQsXG4gICAgICBjbGllbnRJZCxcbiAgICAgIHRoZXJhcGlzdElkLFxuICAgICAgY3JlYXRlUmV2aWV3RHRvLFxuICAgICk7XG4gIH1cblxuICBAUHV0KCc6aWQnKVxuICBAQXBpT3BlcmF0aW9uKHtcbiAgICBzdW1tYXJ5OiAnVXBkYXRlIHVwZGF0ZSByZXZpZXcnLFxuXG4gICAgZGVzY3JpcHRpb246ICdVcGRhdGUgdXBkYXRlIHJldmlldycsXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiAyMDAsXG5cbiAgICBkZXNjcmlwdGlvbjogJ1VwZGF0ZWQgc3VjY2Vzc2Z1bGx5JyxcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHsgc3RhdHVzOiA0MDEsIGRlc2NyaXB0aW9uOiAnVW5hdXRob3JpemVkJyB9KVxuICBhc3luYyB1cGRhdGVSZXZpZXcoXG4gICAgQFBhcmFtKCdpZCcpIHJldmlld0lkOiBzdHJpbmcsXG4gICAgQEN1cnJlbnRVc2VySWQoKSBjbGllbnRJZDogc3RyaW5nLFxuICAgIEBCb2R5KG5ldyBab2RWYWxpZGF0aW9uUGlwZShVcGRhdGVSZXZpZXdEdG9TY2hlbWEpKVxuICAgIHVwZGF0ZVJldmlld0R0bzogVXBkYXRlUmV2aWV3RHRvLFxuICApIHtcbiAgICByZXR1cm4gdGhpcy5yZXZpZXdzU2VydmljZS51cGRhdGVSZXZpZXcoXG4gICAgICByZXZpZXdJZCxcbiAgICAgIGNsaWVudElkLFxuICAgICAgdXBkYXRlUmV2aWV3RHRvLFxuICAgICk7XG4gIH1cblxuICBARGVsZXRlKCc6aWQnKVxuICBAQXBpT3BlcmF0aW9uKHtcbiAgICBzdW1tYXJ5OiAnRGVsZXRlIGRlbGV0ZSByZXZpZXcnLFxuXG4gICAgZGVzY3JpcHRpb246ICdEZWxldGUgZGVsZXRlIHJldmlldycsXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiAyMDAsXG5cbiAgICBkZXNjcmlwdGlvbjogJ0RlbGV0ZWQgc3VjY2Vzc2Z1bGx5JyxcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHsgc3RhdHVzOiA0MDEsIGRlc2NyaXB0aW9uOiAnVW5hdXRob3JpemVkJyB9KVxuICBASHR0cENvZGUoSHR0cFN0YXR1cy5OT19DT05URU5UKVxuICBhc3luYyBkZWxldGVSZXZpZXcoXG4gICAgQFBhcmFtKCdpZCcpIHJldmlld0lkOiBzdHJpbmcsXG4gICAgQEN1cnJlbnRVc2VySWQoKSBjbGllbnRJZDogc3RyaW5nLFxuICApIHtcbiAgICByZXR1cm4gdGhpcy5yZXZpZXdzU2VydmljZS5kZWxldGVSZXZpZXcocmV2aWV3SWQsIGNsaWVudElkKTtcbiAgfVxuXG4gIEBHZXQoKVxuICBAQXBpT3BlcmF0aW9uKHtcbiAgICBzdW1tYXJ5OiAnUmV0cmlldmUgZ2V0IHJldmlld3MnLFxuXG4gICAgZGVzY3JpcHRpb246ICdSZXRyaWV2ZSBnZXQgcmV2aWV3cycsXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiAyMDAsXG5cbiAgICBkZXNjcmlwdGlvbjogJ1JldHJpZXZlZCBzdWNjZXNzZnVsbHknLFxuICB9KVxuICBAQXBpUmVzcG9uc2UoeyBzdGF0dXM6IDQwMSwgZGVzY3JpcHRpb246ICdVbmF1dGhvcml6ZWQnIH0pXG4gIGFzeW5jIGdldFJldmlld3MoXG4gICAgQFF1ZXJ5KG5ldyBab2RWYWxpZGF0aW9uUGlwZShHZXRSZXZpZXdzRHRvU2NoZW1hKSkgcXVlcnk6IEdldFJldmlld3NEdG8sXG4gICk6IFByb21pc2U8UmV2aWV3TGlzdFJlc3BvbnNlPiB7XG4gICAgcmV0dXJuIHRoaXMucmV2aWV3c1NlcnZpY2UuZ2V0UmV2aWV3cyhxdWVyeSk7XG4gIH1cblxuICBAR2V0KCd0aGVyYXBpc3QvOnRoZXJhcGlzdElkJylcbiAgQEFwaU9wZXJhdGlvbih7XG4gICAgc3VtbWFyeTogJ1JldHJpZXZlIGdldCB0aGVyYXBpc3QgcmV2aWV3cycsXG5cbiAgICBkZXNjcmlwdGlvbjogJ1JldHJpZXZlIGdldCB0aGVyYXBpc3QgcmV2aWV3cycsXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiAyMDAsXG5cbiAgICBkZXNjcmlwdGlvbjogJ1JldHJpZXZlZCBzdWNjZXNzZnVsbHknLFxuICB9KVxuICBAQXBpUmVzcG9uc2UoeyBzdGF0dXM6IDQwMSwgZGVzY3JpcHRpb246ICdVbmF1dGhvcml6ZWQnIH0pXG4gIGFzeW5jIGdldFRoZXJhcGlzdFJldmlld3MoXG4gICAgQFBhcmFtKCd0aGVyYXBpc3RJZCcpIHRoZXJhcGlzdElkOiBzdHJpbmcsXG4gICAgQFF1ZXJ5KG5ldyBab2RWYWxpZGF0aW9uUGlwZShHZXRSZXZpZXdzRHRvU2NoZW1hKSlcbiAgICBxdWVyeTogT21pdDxHZXRSZXZpZXdzRHRvLCAndGhlcmFwaXN0SWQnPixcbiAgKTogUHJvbWlzZTxSZXZpZXdMaXN0UmVzcG9uc2U+IHtcbiAgICByZXR1cm4gdGhpcy5yZXZpZXdzU2VydmljZS5nZXRUaGVyYXBpc3RSZXZpZXdzKHRoZXJhcGlzdElkLCBxdWVyeSk7XG4gIH1cblxuICBAR2V0KCd0aGVyYXBpc3QvOnRoZXJhcGlzdElkL3N0YXRzJylcbiAgQEFwaU9wZXJhdGlvbih7XG4gICAgc3VtbWFyeTogJ1JldHJpZXZlIGdldCB0aGVyYXBpc3QgcmV2aWV3IHN0YXRzJyxcblxuICAgIGRlc2NyaXB0aW9uOiAnUmV0cmlldmUgZ2V0IHRoZXJhcGlzdCByZXZpZXcgc3RhdHMnLFxuICB9KVxuICBAQXBpUmVzcG9uc2Uoe1xuICAgIHN0YXR1czogMjAwLFxuXG4gICAgZGVzY3JpcHRpb246ICdSZXRyaWV2ZWQgc3VjY2Vzc2Z1bGx5JyxcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHsgc3RhdHVzOiA0MDEsIGRlc2NyaXB0aW9uOiAnVW5hdXRob3JpemVkJyB9KVxuICBhc3luYyBnZXRUaGVyYXBpc3RSZXZpZXdTdGF0cyhAUGFyYW0oJ3RoZXJhcGlzdElkJykgdGhlcmFwaXN0SWQ6IHN0cmluZykge1xuICAgIHJldHVybiB0aGlzLnJldmlld3NTZXJ2aWNlLmdldFJldmlld1N0YXRzKHRoZXJhcGlzdElkKTtcbiAgfVxuXG4gIEBQb3N0KCc6aWQvaGVscGZ1bCcpXG4gIEBBcGlPcGVyYXRpb24oe1xuICAgIHN1bW1hcnk6ICdDcmVhdGUgbWFyayByZXZpZXcgaGVscGZ1bCcsXG5cbiAgICBkZXNjcmlwdGlvbjogJ0NyZWF0ZSBtYXJrIHJldmlldyBoZWxwZnVsJyxcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHtcbiAgICBzdGF0dXM6IDIwMSxcblxuICAgIGRlc2NyaXB0aW9uOiAnQ3JlYXRlZCBzdWNjZXNzZnVsbHknLFxuICB9KVxuICBAQXBpUmVzcG9uc2UoeyBzdGF0dXM6IDQwMSwgZGVzY3JpcHRpb246ICdVbmF1dGhvcml6ZWQnIH0pXG4gIEBIdHRwQ29kZShIdHRwU3RhdHVzLk9LKVxuICBhc3luYyBtYXJrUmV2aWV3SGVscGZ1bChcbiAgICBAUGFyYW0oJ2lkJywgbmV3IFpvZFZhbGlkYXRpb25QaXBlKFJldmlld0lkUGFyYW1TY2hlbWEpKSByZXZpZXdJZDogc3RyaW5nLFxuICAgIEBDdXJyZW50VXNlcklkKCkgdXNlcklkOiBzdHJpbmcsXG4gICkge1xuICAgIHJldHVybiB0aGlzLnJldmlld3NTZXJ2aWNlLm1hcmtSZXZpZXdIZWxwZnVsKHJldmlld0lkLCB1c2VySWQpO1xuICB9XG5cbiAgLy8gQWRtaW4vTW9kZXJhdG9yIGVuZHBvaW50c1xuICBAUG9zdCgnOmlkL21vZGVyYXRlJylcbiAgQEFwaU9wZXJhdGlvbih7XG4gICAgc3VtbWFyeTogJ0NyZWF0ZSBtb2RlcmF0ZSByZXZpZXcnLFxuXG4gICAgZGVzY3JpcHRpb246ICdDcmVhdGUgbW9kZXJhdGUgcmV2aWV3JyxcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHtcbiAgICBzdGF0dXM6IDIwMSxcblxuICAgIGRlc2NyaXB0aW9uOiAnQ3JlYXRlZCBzdWNjZXNzZnVsbHknLFxuICB9KVxuICBAQXBpUmVzcG9uc2UoeyBzdGF0dXM6IDQwMSwgZGVzY3JpcHRpb246ICdVbmF1dGhvcml6ZWQnIH0pXG4gIEBIdHRwQ29kZShIdHRwU3RhdHVzLk9LKVxuICBhc3luYyBtb2RlcmF0ZVJldmlldyhcbiAgICBAUGFyYW0oJ2lkJywgbmV3IFpvZFZhbGlkYXRpb25QaXBlKFJldmlld0lkUGFyYW1TY2hlbWEpKSByZXZpZXdJZDogc3RyaW5nLFxuICAgIEBDdXJyZW50VXNlcklkKCkgbW9kZXJhdG9ySWQ6IHN0cmluZyxcbiAgICBAQ3VycmVudFVzZXJSb2xlKCkgdXNlclJvbGU6IHN0cmluZyxcbiAgICBAQm9keShuZXcgWm9kVmFsaWRhdGlvblBpcGUoTW9kZXJhdGVSZXZpZXdEdG9TY2hlbWEpKVxuICAgIG1vZGVyYXRlUmV2aWV3RHRvOiBNb2RlcmF0ZVJldmlld0R0byxcbiAgKSB7XG4gICAgLy8gT25seSBhbGxvdyBtb2RlcmF0b3JzIGFuZCBhZG1pbnMgdG8gbW9kZXJhdGUgcmV2aWV3c1xuICAgIGlmICghWydtb2RlcmF0b3InLCAnYWRtaW4nXS5pbmNsdWRlcyh1c2VyUm9sZSkpIHtcbiAgICAgIHRocm93IG5ldyBGb3JiaWRkZW5FeGNlcHRpb24oJ0luc3VmZmljaWVudCBwZXJtaXNzaW9ucycpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLnJldmlld3NTZXJ2aWNlLm1vZGVyYXRlUmV2aWV3KFxuICAgICAgcmV2aWV3SWQsXG4gICAgICBtb2RlcmF0b3JJZCxcbiAgICAgIG1vZGVyYXRlUmV2aWV3RHRvLFxuICAgICk7XG4gIH1cblxuICBAR2V0KCdwZW5kaW5nJylcbiAgQEFwaU9wZXJhdGlvbih7XG4gICAgc3VtbWFyeTogJ1JldHJpZXZlIGdldCBwZW5kaW5nIHJldmlld3MnLFxuXG4gICAgZGVzY3JpcHRpb246ICdSZXRyaWV2ZSBnZXQgcGVuZGluZyByZXZpZXdzJyxcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHtcbiAgICBzdGF0dXM6IDIwMCxcblxuICAgIGRlc2NyaXB0aW9uOiAnUmV0cmlldmVkIHN1Y2Nlc3NmdWxseScsXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7IHN0YXR1czogNDAxLCBkZXNjcmlwdGlvbjogJ1VuYXV0aG9yaXplZCcgfSlcbiAgYXN5bmMgZ2V0UGVuZGluZ1Jldmlld3MoXG4gICAgQEN1cnJlbnRVc2VyUm9sZSgpIHVzZXJSb2xlOiBzdHJpbmcsXG4gICAgQFF1ZXJ5KG5ldyBab2RWYWxpZGF0aW9uUGlwZShHZXRSZXZpZXdzRHRvU2NoZW1hKSkgcXVlcnk6IEdldFJldmlld3NEdG8sXG4gICk6IFByb21pc2U8UmV2aWV3TGlzdFJlc3BvbnNlPiB7XG4gICAgLy8gT25seSBhbGxvdyBtb2RlcmF0b3JzIGFuZCBhZG1pbnMgdG8gdmlldyBwZW5kaW5nIHJldmlld3NcbiAgICBpZiAoIVsnbW9kZXJhdG9yJywgJ2FkbWluJ10uaW5jbHVkZXModXNlclJvbGUpKSB7XG4gICAgICB0aHJvdyBuZXcgRm9yYmlkZGVuRXhjZXB0aW9uKCdJbnN1ZmZpY2llbnQgcGVybWlzc2lvbnMnKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5yZXZpZXdzU2VydmljZS5nZXRSZXZpZXdzKHtcbiAgICAgIC4uLnF1ZXJ5LFxuICAgICAgc3RhdHVzOiAnUEVORElORycsXG4gICAgfSk7XG4gIH1cbn1cbiJdLCJ2ZXJzaW9uIjozfQ==