{"file":"/home/wetooa/Documents/code/projects/mentara/mentara-api/src/worksheets/worksheets.controller.spec.ts","mappings":"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","names":[],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/worksheets/worksheets.controller.spec.ts"],"sourcesContent":["/**\n * Comprehensive Test Suite for WorksheetsController\n * Tests worksheet management, file uploads, submissions, and analytics\n */\n\nimport { Test, TestingModule } from '@nestjs/testing';\nimport { BadRequestException, NotFoundException } from '@nestjs/common';\nimport { JwtAuthGuard } from '../auth/guards/jwt-auth.guard';\nimport { WorksheetsController } from './worksheets.controller';\nimport { WorksheetsService } from './worksheets.service';\nimport { SupabaseStorageService } from '../common/services/supabase-storage.service';\nimport { SecurityGuardTestUtils, RoleBasedTestUtils } from '../test-utils/auth-testing-helpers';\nimport { MockBuilder, TestDataGenerator, TestAssertions } from '../test-utils/enhanced-test-helpers';\nimport { TEST_USER_IDS, TEST_EMAILS } from '../test-utils/index';\n\ndescribe('WorksheetsController', () => {\n  let controller: WorksheetsController;\n  let worksheetsService: WorksheetsService;\n  let supabaseStorageService: SupabaseStorageService;\n  let module: TestingModule;\n\n  // Mock WorksheetsService\n  const mockWorksheetsService = {\n    findAll: jest.fn(),\n    findById: jest.fn(),\n    create: jest.fn(),\n    update: jest.fn(),\n    delete: jest.fn(),\n    createSubmission: jest.fn(),\n    getSubmissions: jest.fn(),\n    updateSubmission: jest.fn(),\n    deleteSubmission: jest.fn(),\n    getWorksheetStats: jest.fn(),\n    getTherapistWorksheets: jest.fn(),\n    getClientWorksheets: jest.fn(),\n    searchWorksheets: jest.fn(),\n    getWorksheetAnalytics: jest.fn(),\n  };\n\n  // Mock SupabaseStorageService\n  const mockSupabaseStorageService = {\n    uploadFile: jest.fn(),\n    uploadFiles: jest.fn(),\n    deleteFile: jest.fn(),\n    getFileUrl: jest.fn(),\n  };\n\n  // Mock JwtAuthGuard\n  const mockJwtAuthGuard = {\n    canActivate: jest.fn().mockReturnValue(true),\n  };\n\n  // Test data\n  const mockWorksheet = {\n    id: 'worksheet_123456789',\n    title: 'Anxiety Management Worksheet',\n    description: 'Weekly exercises for managing anxiety symptoms',\n    content: 'Please complete the following mindfulness exercises...',\n    status: 'assigned',\n    clientId: TEST_USER_IDS.CLIENT,\n    therapistId: TEST_USER_IDS.THERAPIST,\n    dueDate: new Date('2024-02-01T00:00:00Z'),\n    estimatedDuration: 45,\n    difficulty: 'intermediate',\n    tags: ['anxiety', 'mindfulness', 'coping'],\n    materials: [\n      {\n        id: 'material_123',\n        filename: 'anxiety-guide.pdf',\n        url: 'https://storage.example.com/anxiety-guide.pdf',\n        fileType: 'pdf',\n        size: 1024000,\n      },\n    ],\n    submissions: [\n      {\n        id: 'submission_123',\n        content: 'I completed the breathing exercises and found them helpful...',\n        submittedAt: new Date('2024-01-20T14:30:00Z'),\n        score: 8,\n        feedback: 'Great progress with the exercises!',\n      },\n    ],\n    createdAt: new Date(),\n    updatedAt: new Date(),\n  };\n\n  const mockWorksheetSubmission = {\n    id: 'submission_123456789',\n    worksheetId: 'worksheet_123456789',\n    clientId: TEST_USER_IDS.CLIENT,\n    content: 'I completed all the exercises as instructed. The breathing techniques were particularly helpful.',\n    submittedAt: new Date(),\n    score: 9,\n    feedback: 'Excellent work! Your understanding of the techniques is clear.',\n    therapistNotes: 'Client shows good engagement and understanding',\n    attachments: [\n      {\n        id: 'attachment_123',\n        filename: 'exercise-notes.pdf',\n        url: 'https://storage.example.com/exercise-notes.pdf',\n        fileType: 'pdf',\n      },\n    ],\n    createdAt: new Date(),\n    updatedAt: new Date(),\n  };\n\n  const mockWorksheetStats = {\n    totalWorksheets: 25,\n    assignedWorksheets: 8,\n    inProgressWorksheets: 12,\n    completedWorksheets: 5,\n    overdueWorksheets: 3,\n    averageCompletionTime: 48.5,\n    completionRate: 76.2,\n    averageScore: 7.8,\n    popularTags: [\n      { tag: 'anxiety', count: 15 },\n      { tag: 'depression', count: 12 },\n      { tag: 'mindfulness', count: 10 },\n    ],\n    weeklyProgress: [\n      { week: '2024-01-15', completed: 3, assigned: 5 },\n      { week: '2024-01-22', completed: 4, assigned: 6 },\n      { week: '2024-01-29', completed: 2, assigned: 4 },\n    ],\n  };\n\n  const mockFiles = [\n    {\n      fieldname: 'files',\n      originalname: 'worksheet-material.pdf',\n      mimetype: 'application/pdf',\n      buffer: Buffer.from('fake pdf content'),\n      size: 1024000,\n    },\n    {\n      fieldname: 'files',\n      originalname: 'exercise-template.docx',\n      mimetype: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n      buffer: Buffer.from('fake docx content'),\n      size: 512000,\n    },\n  ] as Express.Multer.File[];\n\n  beforeEach(async () => {\n    module = await Test.createTestingModule({\n      controllers: [WorksheetsController],\n      providers: [\n        {\n          provide: WorksheetsService,\n          useValue: mockWorksheetsService,\n        },\n        {\n          provide: SupabaseStorageService,\n          useValue: mockSupabaseStorageService,\n        },\n      ],\n    })\n      .overrideGuard(JwtAuthGuard)\n      .useValue(mockJwtAuthGuard)\n      .compile();\n\n    controller = module.get<WorksheetsController>(WorksheetsController);\n    worksheetsService = module.get<WorksheetsService>(WorksheetsService);\n    supabaseStorageService = module.get<SupabaseStorageService>(SupabaseStorageService);\n  });\n\n  afterEach(() => {\n    jest.clearAllMocks();\n  });\n\n  describe('Controller Initialization', () => {\n    it('should be defined', () => {\n      expect(controller).toBeDefined();\n    });\n\n    it('should have all services injected', () => {\n      expect(worksheetsService).toBeDefined();\n      expect(supabaseStorageService).toBeDefined();\n    });\n  });\n\n  describe('Security Guards', () => {\n    it('should be protected by JwtAuthGuard', () => {\n      const guards = Reflect.getMetadata('__guards__', WorksheetsController);\n      expect(guards).toContain(JwtAuthGuard);\n    });\n\n    it('should have proper route decorators', () => {\n      const controllerMetadata = Reflect.getMetadata('path', WorksheetsController);\n      expect(controllerMetadata).toBe('worksheets');\n    });\n  });\n\n  describe('GET /worksheets', () => {\n    const queryParams = {\n      userId: TEST_USER_IDS.CLIENT,\n      therapistId: TEST_USER_IDS.THERAPIST,\n      status: 'assigned',\n      page: 1,\n      limit: 10,\n    };\n\n    it('should get all worksheets successfully', async () => {\n      const mockResponse = {\n        worksheets: [mockWorksheet],\n        totalCount: 1,\n        page: 1,\n        totalPages: 1,\n      };\n      mockWorksheetsService.findAll.mockResolvedValue(mockResponse);\n\n      const result = await controller.findAll(TEST_USER_IDS.THERAPIST, queryParams);\n\n      expect(result).toEqual(mockResponse);\n      expect(worksheetsService.findAll).toHaveBeenCalledWith(\n        queryParams.userId,\n        queryParams.therapistId,\n        queryParams.status\n      );\n    });\n\n    it('should handle empty worksheets list', async () => {\n      const emptyResponse = {\n        worksheets: [],\n        totalCount: 0,\n        page: 1,\n        totalPages: 0,\n      };\n      mockWorksheetsService.findAll.mockResolvedValue(emptyResponse);\n\n      const result = await controller.findAll(TEST_USER_IDS.THERAPIST, {});\n\n      expect(result).toEqual(emptyResponse);\n      expect(result.worksheets).toHaveLength(0);\n    });\n\n    it('should handle service errors', async () => {\n      const serviceError = new Error('Database connection failed');\n      mockWorksheetsService.findAll.mockRejectedValue(serviceError);\n\n      await expect(\n        controller.findAll(TEST_USER_IDS.THERAPIST, queryParams)\n      ).rejects.toThrow(serviceError);\n    });\n  });\n\n  describe('GET /worksheets/:id', () => {\n    it('should get worksheet by id successfully', async () => {\n      mockWorksheetsService.findById.mockResolvedValue(mockWorksheet);\n\n      const result = await controller.findById('worksheet_123456789');\n\n      expect(result).toEqual(mockWorksheet);\n      expect(worksheetsService.findById).toHaveBeenCalledWith('worksheet_123456789');\n    });\n\n    it('should handle worksheet not found', async () => {\n      const notFoundError = new NotFoundException('Worksheet not found');\n      mockWorksheetsService.findById.mockRejectedValue(notFoundError);\n\n      await expect(\n        controller.findById('nonexistent-worksheet')\n      ).rejects.toThrow(notFoundError);\n    });\n\n    it('should include materials and submissions in response', async () => {\n      const worksheetWithDetails = {\n        ...mockWorksheet,\n        materials: mockWorksheet.materials,\n        submissions: mockWorksheet.submissions,\n      };\n      mockWorksheetsService.findById.mockResolvedValue(worksheetWithDetails);\n\n      const result = await controller.findById('worksheet_123456789');\n\n      expect(result.materials).toBeDefined();\n      expect(result.submissions).toBeDefined();\n      expect(result.materials).toHaveLength(1);\n      expect(result.submissions).toHaveLength(1);\n    });\n  });\n\n  describe('POST /worksheets', () => {\n    const createWorksheetDto = {\n      title: 'New Anxiety Worksheet',\n      description: 'Advanced exercises for anxiety management',\n      content: 'Complete the following cognitive restructuring exercises...',\n      clientId: TEST_USER_IDS.CLIENT,\n      therapistId: TEST_USER_IDS.THERAPIST,\n      dueDate: '2024-02-15T00:00:00Z',\n      estimatedDuration: 60,\n      difficulty: 'advanced',\n      tags: ['anxiety', 'CBT', 'cognitive'],\n    };\n\n    it('should create worksheet without files successfully', async () => {\n      const createdWorksheet = {\n        ...mockWorksheet,\n        ...createWorksheetDto,\n        uploadedFiles: [],\n      };\n      mockWorksheetsService.create.mockResolvedValue(createdWorksheet);\n\n      const result = await controller.create(\n        TEST_USER_IDS.THERAPIST,\n        createWorksheetDto,\n        []\n      );\n\n      expect(result).toEqual(createdWorksheet);\n      expect(worksheetsService.create).toHaveBeenCalledWith(\n        createWorksheetDto,\n        createWorksheetDto.clientId,\n        createWorksheetDto.therapistId,\n        []\n      );\n    });\n\n    it('should create worksheet with files successfully', async () => {\n      const uploadedFiles = [\n        {\n          id: 'file_123',\n          filename: 'worksheet-material.pdf',\n          url: 'https://storage.example.com/worksheet-material.pdf',\n        },\n        {\n          id: 'file_124',\n          filename: 'exercise-template.docx',\n          url: 'https://storage.example.com/exercise-template.docx',\n        },\n      ];\n      const createdWorksheet = {\n        ...mockWorksheet,\n        ...createWorksheetDto,\n        uploadedFiles,\n      };\n      mockWorksheetsService.create.mockResolvedValue(createdWorksheet);\n\n      const result = await controller.create(\n        TEST_USER_IDS.THERAPIST,\n        createWorksheetDto,\n        mockFiles\n      );\n\n      expect(result).toEqual(createdWorksheet);\n      expect(worksheetsService.create).toHaveBeenCalledWith(\n        createWorksheetDto,\n        createWorksheetDto.clientId,\n        createWorksheetDto.therapistId,\n        mockFiles\n      );\n    });\n\n    it('should handle file upload errors', async () => {\n      const uploadError = new BadRequestException('File upload failed');\n      mockWorksheetsService.create.mockRejectedValue(uploadError);\n\n      await expect(\n        controller.create(TEST_USER_IDS.THERAPIST, createWorksheetDto, mockFiles)\n      ).rejects.toThrow(uploadError);\n    });\n\n    it('should validate required fields', async () => {\n      const invalidDto = {\n        title: '', // Empty title\n        clientId: TEST_USER_IDS.CLIENT,\n        therapistId: TEST_USER_IDS.THERAPIST,\n      };\n      const validationError = new BadRequestException('Title is required');\n      mockWorksheetsService.create.mockRejectedValue(validationError);\n\n      await expect(\n        controller.create(TEST_USER_IDS.THERAPIST, invalidDto as any, [])\n      ).rejects.toThrow(validationError);\n    });\n\n    it('should handle maximum file limit', async () => {\n      const tooManyFiles = Array(6).fill(mockFiles[0]); // 6 files exceeds limit of 5\n      const limitError = new BadRequestException('Maximum 5 files allowed');\n      mockWorksheetsService.create.mockRejectedValue(limitError);\n\n      await expect(\n        controller.create(TEST_USER_IDS.THERAPIST, createWorksheetDto, tooManyFiles)\n      ).rejects.toThrow(limitError);\n    });\n  });\n\n  describe('PUT /worksheets/:id', () => {\n    const updateWorksheetDto = {\n      title: 'Updated Worksheet Title',\n      description: 'Updated description with new exercises',\n      content: 'Updated content with additional instructions...',\n      status: 'in_progress' as const,\n      dueDate: '2024-02-20T00:00:00Z',\n    };\n\n    it('should update worksheet successfully', async () => {\n      const updatedWorksheet = { ...mockWorksheet, ...updateWorksheetDto };\n      mockWorksheetsService.update.mockResolvedValue(updatedWorksheet);\n\n      const result = await controller.update(\n        TEST_USER_IDS.THERAPIST,\n        'worksheet_123456789',\n        updateWorksheetDto\n      );\n\n      expect(result).toEqual(updatedWorksheet);\n      expect(worksheetsService.update).toHaveBeenCalledWith(\n        'worksheet_123456789',\n        updateWorksheetDto\n      );\n    });\n\n    it('should handle partial updates', async () => {\n      const partialUpdate = { status: 'completed' as const };\n      const updatedWorksheet = { ...mockWorksheet, ...partialUpdate };\n      mockWorksheetsService.update.mockResolvedValue(updatedWorksheet);\n\n      const result = await controller.update(\n        TEST_USER_IDS.THERAPIST,\n        'worksheet_123456789',\n        partialUpdate\n      );\n\n      expect(result).toEqual(updatedWorksheet);\n      expect(worksheetsService.update).toHaveBeenCalledWith(\n        'worksheet_123456789',\n        partialUpdate\n      );\n    });\n\n    it('should handle worksheet not found', async () => {\n      const notFoundError = new NotFoundException('Worksheet not found');\n      mockWorksheetsService.update.mockRejectedValue(notFoundError);\n\n      await expect(\n        controller.update(TEST_USER_IDS.THERAPIST, 'nonexistent-worksheet', updateWorksheetDto)\n      ).rejects.toThrow(notFoundError);\n    });\n\n    it('should handle invalid status transitions', async () => {\n      const invalidStatusError = new BadRequestException('Invalid status transition');\n      mockWorksheetsService.update.mockRejectedValue(invalidStatusError);\n\n      await expect(\n        controller.update(\n          TEST_USER_IDS.THERAPIST,\n          'worksheet_123456789',\n          { status: 'invalid_status' as any }\n        )\n      ).rejects.toThrow(invalidStatusError);\n    });\n  });\n\n  describe('DELETE /worksheets/:id', () => {\n    it('should delete worksheet successfully', async () => {\n      const deleteResponse = {\n        success: true,\n        message: 'Worksheet deleted successfully',\n        deletedId: 'worksheet_123456789',\n      };\n      mockWorksheetsService.delete.mockResolvedValue(deleteResponse);\n\n      const result = await controller.delete(TEST_USER_IDS.THERAPIST, 'worksheet_123456789');\n\n      expect(result).toEqual(deleteResponse);\n      expect(worksheetsService.delete).toHaveBeenCalledWith('worksheet_123456789');\n    });\n\n    it('should handle worksheet not found for deletion', async () => {\n      const notFoundError = new NotFoundException('Worksheet not found');\n      mockWorksheetsService.delete.mockRejectedValue(notFoundError);\n\n      await expect(\n        controller.delete(TEST_USER_IDS.THERAPIST, 'nonexistent-worksheet')\n      ).rejects.toThrow(notFoundError);\n    });\n\n    it('should handle deletion of worksheet with dependencies', async () => {\n      const dependencyError = new BadRequestException(\n        'Cannot delete worksheet with existing submissions'\n      );\n      mockWorksheetsService.delete.mockRejectedValue(dependencyError);\n\n      await expect(\n        controller.delete(TEST_USER_IDS.THERAPIST, 'worksheet_123456789')\n      ).rejects.toThrow(dependencyError);\n    });\n  });\n\n  describe('Worksheet Submissions', () => {\n    describe('POST /worksheets/submissions', () => {\n      const createSubmissionDto = {\n        worksheetId: 'worksheet_123456789',\n        content: 'I completed all the exercises and found them very helpful.',\n        clientNotes: 'The breathing exercises were particularly effective.',\n        timeSpent: 45,\n      };\n\n      it('should create submission successfully', async () => {\n        mockWorksheetsService.createSubmission.mockResolvedValue(mockWorksheetSubmission);\n\n        const result = await controller.createSubmission(\n          TEST_USER_IDS.CLIENT,\n          createSubmissionDto\n        );\n\n        expect(result).toEqual(mockWorksheetSubmission);\n        expect(worksheetsService.createSubmission).toHaveBeenCalledWith(createSubmissionDto);\n      });\n\n      it('should handle submission with attachments', async () => {\n        const submissionWithAttachments = {\n          ...mockWorksheetSubmission,\n          attachments: mockWorksheetSubmission.attachments,\n        };\n        mockWorksheetsService.createSubmission.mockResolvedValue(submissionWithAttachments);\n\n        const result = await controller.createSubmission(\n          TEST_USER_IDS.CLIENT,\n          createSubmissionDto\n        );\n\n        expect(result.attachments).toBeDefined();\n        expect(result.attachments).toHaveLength(1);\n      });\n\n      it('should handle invalid worksheet id', async () => {\n        const invalidError = new BadRequestException('Invalid worksheet ID');\n        mockWorksheetsService.createSubmission.mockRejectedValue(invalidError);\n\n        await expect(\n          controller.createSubmission(TEST_USER_IDS.CLIENT, {\n            ...createSubmissionDto,\n            worksheetId: 'invalid-id',\n          })\n        ).rejects.toThrow(invalidError);\n      });\n    });\n\n    describe('GET /worksheets/:id/submissions', () => {\n      it('should get all submissions for worksheet', async () => {\n        const mockSubmissions = [mockWorksheetSubmission];\n        mockWorksheetsService.getSubmissions.mockResolvedValue(mockSubmissions);\n\n        const result = await controller.getSubmissions('worksheet_123456789');\n\n        expect(result).toEqual(mockSubmissions);\n        expect(worksheetsService.getSubmissions).toHaveBeenCalledWith('worksheet_123456789');\n      });\n\n      it('should handle empty submissions list', async () => {\n        mockWorksheetsService.getSubmissions.mockResolvedValue([]);\n\n        const result = await controller.getSubmissions('worksheet_123456789');\n\n        expect(result).toEqual([]);\n      });\n    });\n\n    describe('PUT /worksheets/submissions/:id', () => {\n      const updateSubmissionDto = {\n        content: 'Updated submission content with additional insights',\n        score: 9,\n        feedback: 'Excellent improvement shown in this submission',\n        therapistNotes: 'Client demonstrates clear understanding of concepts',\n      };\n\n      it('should update submission successfully', async () => {\n        const updatedSubmission = { ...mockWorksheetSubmission, ...updateSubmissionDto };\n        mockWorksheetsService.updateSubmission.mockResolvedValue(updatedSubmission);\n\n        const result = await controller.updateSubmission(\n          TEST_USER_IDS.THERAPIST,\n          'submission_123456789',\n          updateSubmissionDto\n        );\n\n        expect(result).toEqual(updatedSubmission);\n        expect(worksheetsService.updateSubmission).toHaveBeenCalledWith(\n          'submission_123456789',\n          updateSubmissionDto\n        );\n      });\n\n      it('should handle submission not found', async () => {\n        const notFoundError = new NotFoundException('Submission not found');\n        mockWorksheetsService.updateSubmission.mockRejectedValue(notFoundError);\n\n        await expect(\n          controller.updateSubmission(\n            TEST_USER_IDS.THERAPIST,\n            'nonexistent-submission',\n            updateSubmissionDto\n          )\n        ).rejects.toThrow(notFoundError);\n      });\n    });\n\n    describe('DELETE /worksheets/submissions/:id', () => {\n      it('should delete submission successfully', async () => {\n        const deleteResponse = {\n          success: true,\n          message: 'Submission deleted successfully',\n          deletedId: 'submission_123456789',\n        };\n        mockWorksheetsService.deleteSubmission.mockResolvedValue(deleteResponse);\n\n        const result = await controller.deleteSubmission(\n          TEST_USER_IDS.CLIENT,\n          'submission_123456789'\n        );\n\n        expect(result).toEqual(deleteResponse);\n        expect(worksheetsService.deleteSubmission).toHaveBeenCalledWith('submission_123456789');\n      });\n    });\n  });\n\n  describe('Analytics and Statistics', () => {\n    describe('GET /worksheets/stats', () => {\n      it('should get worksheet statistics successfully', async () => {\n        mockWorksheetsService.getWorksheetStats.mockResolvedValue(mockWorksheetStats);\n\n        const result = await controller.getWorksheetStats(TEST_USER_IDS.THERAPIST);\n\n        expect(result).toEqual(mockWorksheetStats);\n        expect(worksheetsService.getWorksheetStats).toHaveBeenCalledWith(TEST_USER_IDS.THERAPIST);\n      });\n\n      it('should handle empty statistics', async () => {\n        const emptyStats = {\n          totalWorksheets: 0,\n          assignedWorksheets: 0,\n          inProgressWorksheets: 0,\n          completedWorksheets: 0,\n          overdueWorksheets: 0,\n          averageCompletionTime: 0,\n          completionRate: 0,\n          averageScore: 0,\n          popularTags: [],\n          weeklyProgress: [],\n        };\n        mockWorksheetsService.getWorksheetStats.mockResolvedValue(emptyStats);\n\n        const result = await controller.getWorksheetStats(TEST_USER_IDS.THERAPIST);\n\n        expect(result).toEqual(emptyStats);\n        expect(result.totalWorksheets).toBe(0);\n      });\n    });\n\n    describe('GET /worksheets/analytics', () => {\n      const analyticsQuery = {\n        startDate: '2024-01-01T00:00:00Z',\n        endDate: '2024-01-31T23:59:59Z',\n        groupBy: 'week',\n      };\n\n      it('should get worksheet analytics successfully', async () => {\n        const mockAnalytics = {\n          periodStats: {\n            totalAssigned: 50,\n            totalCompleted: 38,\n            totalInProgress: 8,\n            totalOverdue: 4,\n            completionRate: 76.0,\n            averageScore: 8.2,\n          },\n          timeline: [\n            { period: '2024-01-01', assigned: 12, completed: 9, inProgress: 2, overdue: 1 },\n            { period: '2024-01-08', assigned: 15, completed: 11, inProgress: 3, overdue: 1 },\n            { period: '2024-01-15', assigned: 13, completed: 10, inProgress: 2, overdue: 1 },\n            { period: '2024-01-22', assigned: 10, completed: 8, inProgress: 1, overdue: 1 },\n          ],\n          topPerformingClients: [\n            { clientId: TEST_USER_IDS.CLIENT, completionRate: 95.0, averageScore: 9.2 },\n          ],\n          categoryBreakdown: [\n            { category: 'anxiety', count: 18, completionRate: 82.0 },\n            { category: 'depression', count: 15, completionRate: 73.0 },\n            { category: 'mindfulness', count: 12, completionRate: 88.0 },\n          ],\n        };\n        mockWorksheetsService.getWorksheetAnalytics.mockResolvedValue(mockAnalytics);\n\n        const result = await controller.getWorksheetAnalytics(\n          TEST_USER_IDS.THERAPIST,\n          analyticsQuery\n        );\n\n        expect(result).toEqual(mockAnalytics);\n        expect(worksheetsService.getWorksheetAnalytics).toHaveBeenCalledWith(\n          TEST_USER_IDS.THERAPIST,\n          analyticsQuery\n        );\n      });\n    });\n  });\n\n  describe('Search and Filtering', () => {\n    describe('GET /worksheets/search', () => {\n      const searchQuery = {\n        query: 'anxiety management',\n        tags: ['anxiety', 'CBT'],\n        status: 'assigned',\n        clientId: TEST_USER_IDS.CLIENT,\n        page: 1,\n        limit: 10,\n      };\n\n      it('should search worksheets successfully', async () => {\n        const searchResults = {\n          worksheets: [mockWorksheet],\n          totalCount: 1,\n          page: 1,\n          totalPages: 1,\n          searchMetadata: {\n            query: searchQuery.query,\n            tags: searchQuery.tags,\n            resultsFound: 1,\n            searchTime: 45,\n          },\n        };\n        mockWorksheetsService.searchWorksheets.mockResolvedValue(searchResults);\n\n        const result = await controller.searchWorksheets(TEST_USER_IDS.THERAPIST, searchQuery);\n\n        expect(result).toEqual(searchResults);\n        expect(worksheetsService.searchWorksheets).toHaveBeenCalledWith(\n          TEST_USER_IDS.THERAPIST,\n          searchQuery\n        );\n      });\n\n      it('should handle empty search results', async () => {\n        const emptyResults = {\n          worksheets: [],\n          totalCount: 0,\n          page: 1,\n          totalPages: 0,\n          searchMetadata: {\n            query: 'nonexistent term',\n            tags: [],\n            resultsFound: 0,\n            searchTime: 12,\n          },\n        };\n        mockWorksheetsService.searchWorksheets.mockResolvedValue(emptyResults);\n\n        const result = await controller.searchWorksheets(TEST_USER_IDS.THERAPIST, {\n          query: 'nonexistent term',\n        });\n\n        expect(result).toEqual(emptyResults);\n        expect(result.worksheets).toHaveLength(0);\n      });\n    });\n  });\n\n  describe('Error Handling', () => {\n    it('should handle service unavailable scenarios', async () => {\n      const serviceError = new Error('Service temporarily unavailable');\n      mockWorksheetsService.findAll.mockRejectedValue(serviceError);\n\n      await expect(\n        controller.findAll(TEST_USER_IDS.THERAPIST, {})\n      ).rejects.toThrow(serviceError);\n    });\n\n    it('should handle file storage errors', async () => {\n      const storageError = new Error('Storage service unavailable');\n      mockWorksheetsService.create.mockRejectedValue(storageError);\n\n      await expect(\n        controller.create(\n          TEST_USER_IDS.THERAPIST,\n          {\n            title: 'Test Worksheet',\n            clientId: TEST_USER_IDS.CLIENT,\n            therapistId: TEST_USER_IDS.THERAPIST,\n          },\n          mockFiles\n        )\n      ).rejects.toThrow(storageError);\n    });\n\n    it('should handle concurrent worksheet updates', async () => {\n      const concurrencyError = new Error('Worksheet is being updated by another process');\n      mockWorksheetsService.update.mockRejectedValue(concurrencyError);\n\n      await expect(\n        controller.update(TEST_USER_IDS.THERAPIST, 'worksheet_123456789', { title: 'Updated' })\n      ).rejects.toThrow(concurrencyError);\n    });\n\n    it('should handle database connection errors', async () => {\n      const dbError = new Error('Database connection failed');\n      mockWorksheetsService.getWorksheetStats.mockRejectedValue(dbError);\n\n      await expect(\n        controller.getWorksheetStats(TEST_USER_IDS.THERAPIST)\n      ).rejects.toThrow(dbError);\n    });\n  });\n\n  describe('Response Format Validation', () => {\n    it('should return properly formatted worksheet response', async () => {\n      mockWorksheetsService.findById.mockResolvedValue(mockWorksheet);\n\n      const result = await controller.findById('worksheet_123456789');\n\n      TestAssertions.expectValidEntity(result, ['id', 'title', 'description', 'status']);\n      expect(result.id).toBe(mockWorksheet.id);\n      expect(result.status).toBe('assigned');\n      expect(Array.isArray(result.tags)).toBe(true);\n      expect(Array.isArray(result.materials)).toBe(true);\n      expect(Array.isArray(result.submissions)).toBe(true);\n    });\n\n    it('should return properly formatted submission response', async () => {\n      mockWorksheetsService.createSubmission.mockResolvedValue(mockWorksheetSubmission);\n\n      const result = await controller.createSubmission(TEST_USER_IDS.CLIENT, {\n        worksheetId: 'worksheet_123456789',\n        content: 'Test submission',\n      });\n\n      TestAssertions.expectValidEntity(result, ['id', 'worksheetId', 'clientId', 'content']);\n      expect(result.worksheetId).toBe('worksheet_123456789');\n      expect(typeof result.score).toBe('number');\n      expect(Array.isArray(result.attachments)).toBe(true);\n    });\n\n    it('should return properly formatted statistics response', async () => {\n      mockWorksheetsService.getWorksheetStats.mockResolvedValue(mockWorksheetStats);\n\n      const result = await controller.getWorksheetStats(TEST_USER_IDS.THERAPIST);\n\n      expect(typeof result.totalWorksheets).toBe('number');\n      expect(typeof result.completionRate).toBe('number');\n      expect(typeof result.averageScore).toBe('number');\n      expect(Array.isArray(result.popularTags)).toBe(true);\n      expect(Array.isArray(result.weeklyProgress)).toBe(true);\n    });\n\n    it('should maintain data integrity for worksheet creation', async () => {\n      const createDto = {\n        title: 'Test Worksheet',\n        description: 'Test description',\n        clientId: TEST_USER_IDS.CLIENT,\n        therapistId: TEST_USER_IDS.THERAPIST,\n      };\n      const createdWorksheet = { ...mockWorksheet, ...createDto };\n      mockWorksheetsService.create.mockResolvedValue(createdWorksheet);\n\n      const result = await controller.create(TEST_USER_IDS.THERAPIST, createDto, []);\n\n      expect(result.title).toBe(createDto.title);\n      expect(result.clientId).toBe(createDto.clientId);\n      expect(result.therapistId).toBe(createDto.therapistId);\n      expect(result.createdAt).toBeDefined();\n      expect(result.updatedAt).toBeDefined();\n    });\n  });\n});"],"version":3}