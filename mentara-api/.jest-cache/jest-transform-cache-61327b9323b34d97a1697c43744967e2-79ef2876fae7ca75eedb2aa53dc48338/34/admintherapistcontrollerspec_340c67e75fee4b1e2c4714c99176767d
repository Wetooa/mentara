051f9a2f2e905a57bf6e32794b75f70c
"use strict";
/**
 * Comprehensive Test Suite for AdminTherapistController
 * Tests admin functionality for managing therapist applications and status
 */
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const common_1 = require("@nestjs/common");
const admin_therapist_controller_1 = require("./admin-therapist.controller");
const admin_therapist_service_1 = require("../services/admin-therapist.service");
const jwt_auth_guard_1 = require("../../auth/guards/jwt-auth.guard");
const admin_auth_guard_1 = require("../../auth/guards/admin-auth.guard");
const enhanced_test_helpers_1 = require("../../test-utils/enhanced-test-helpers");
const index_1 = require("../../test-utils/index");
describe('AdminTherapistController', () => {
    let controller;
    let adminTherapistService;
    let module;
    // Mock AdminTherapistService
    const mockAdminTherapistService = {
        getPendingApplications: jest.fn(),
        getApplicationDetails: jest.fn(),
        approveTherapist: jest.fn(),
        rejectTherapist: jest.fn(),
        updateTherapistStatus: jest.fn(),
        getTherapistApplicationMetrics: jest.fn(),
    };
    // Mock Guards
    const mockJwtAuthGuard = {
        canActivate: jest.fn().mockReturnValue(true),
    };
    const mockAdminAuthGuard = {
        canActivate: jest.fn().mockReturnValue(true),
    };
    // Test data
    const mockTherapistApplication = {
        id: 'therapist_application_123456789',
        userId: index_1.TEST_USER_IDS.THERAPIST,
        email: index_1.TEST_EMAILS.THERAPIST,
        firstName: 'Dr. Sarah',
        lastName: 'Smith',
        status: 'pending',
        licenseNumber: 'PSY123456',
        licenseState: 'California',
        licenseExpiry: new Date('2025-12-31'),
        specializations: ['anxiety', 'depression', 'trauma'],
        yearsOfExperience: 8,
        education: 'PhD in Clinical Psychology',
        certifications: ['Licensed Clinical Psychologist', 'Trauma-Informed Care'],
        bio: 'Experienced therapist specializing in anxiety and trauma treatment',
        hourlyRate: 150,
        availableHours: 40,
        preferredClientTypes: ['adults', 'teens'],
        treatmentApproaches: ['CBT', 'DBT', 'EMDR'],
        applicationDate: new Date('2024-01-15'),
        documents: [
            {
                type: 'license',
                url: 'https://storage.example.com/license.pdf',
                verified: false,
            },
            {
                type: 'cv',
                url: 'https://storage.example.com/cv.pdf',
                verified: false,
            },
        ],
        adminNotes: '',
        reviewedBy: null,
        reviewedAt: null,
        createdAt: new Date(),
        updatedAt: new Date(),
    };
    const mockApplicationsList = [
        mockTherapistApplication,
        {
            ...mockTherapistApplication,
            id: 'therapist_application_987654321',
            firstName: 'Dr. John',
            lastName: 'Doe',
            email: 'john.doe@example.com',
            status: 'approved',
            reviewedBy: index_1.TEST_USER_IDS.ADMIN,
            reviewedAt: new Date(),
        },
    ];
    const mockApplicationMetrics = {
        totalApplications: 125,
        pendingApplications: 23,
        approvedApplications: 89,
        rejectedApplications: 13,
        averageProcessingTime: 5.2, // days
        monthlyApplications: [
            { month: '2024-01', total: 12, approved: 8, rejected: 2, pending: 2 },
            { month: '2024-02', total: 15, approved: 11, rejected: 1, pending: 3 },
        ],
        specializations: [
            { name: 'anxiety', count: 45 },
            { name: 'depression', count: 38 },
            { name: 'trauma', count: 29 },
        ],
        averageExperience: 6.8,
        topStates: [
            { state: 'California', count: 28 },
            { state: 'New York', count: 19 },
            { state: 'Texas', count: 15 },
        ],
    };
    beforeEach(async () => {
        module = await testing_1.Test.createTestingModule({
            controllers: [admin_therapist_controller_1.AdminTherapistController],
            providers: [
                {
                    provide: admin_therapist_service_1.AdminTherapistService,
                    useValue: mockAdminTherapistService,
                },
            ],
        })
            .overrideGuard(jwt_auth_guard_1.JwtAuthGuard)
            .useValue(mockJwtAuthGuard)
            .overrideGuard(admin_auth_guard_1.AdminAuthGuard)
            .useValue(mockAdminAuthGuard)
            .compile();
        controller = module.get(admin_therapist_controller_1.AdminTherapistController);
        adminTherapistService = module.get(admin_therapist_service_1.AdminTherapistService);
    });
    afterEach(() => {
        jest.clearAllMocks();
    });
    describe('Controller Initialization', () => {
        it('should be defined', () => {
            expect(controller).toBeDefined();
        });
        it('should have adminTherapistService injected', () => {
            expect(adminTherapistService).toBeDefined();
        });
    });
    describe('Security Guards', () => {
        it('should be protected by JwtAuthGuard and AdminAuthGuard', () => {
            const guards = Reflect.getMetadata('__guards__', admin_therapist_controller_1.AdminTherapistController);
            expect(guards).toContain(jwt_auth_guard_1.JwtAuthGuard);
            expect(guards).toContain(admin_auth_guard_1.AdminAuthGuard);
        });
        it('should have AdminOnly decorator', () => {
            const metadata = Reflect.getMetadata('admin_only', admin_therapist_controller_1.AdminTherapistController);
            expect(metadata).toBeTruthy();
        });
        it('should have proper route decorators', () => {
            const controllerMetadata = Reflect.getMetadata('path', admin_therapist_controller_1.AdminTherapistController);
            expect(controllerMetadata).toBe('admin/therapists');
        });
    });
    describe('GET /admin/therapists/pending', () => {
        const mockFilters = {
            status: 'pending',
            specialization: 'anxiety',
            state: 'California',
            experienceMin: 3,
            experienceMax: 10,
            page: 1,
            limit: 20,
        };
        it('should get pending applications successfully', async () => {
            const pendingApplications = mockApplicationsList.filter(app => app.status === 'pending');
            mockAdminTherapistService.getPendingApplications.mockResolvedValue({
                applications: pendingApplications,
                pagination: {
                    page: 1,
                    limit: 20,
                    total: pendingApplications.length,
                    totalPages: 1,
                },
            });
            const result = await controller.getPendingApplications(mockFilters, index_1.TEST_USER_IDS.ADMIN);
            expect(result.applications).toEqual(pendingApplications);
            expect(adminTherapistService.getPendingApplications).toHaveBeenCalledWith(mockFilters);
        });
        it('should get pending applications without filters', async () => {
            const emptyFilters = {};
            mockAdminTherapistService.getPendingApplications.mockResolvedValue({
                applications: mockApplicationsList,
                pagination: {
                    page: 1,
                    limit: 20,
                    total: mockApplicationsList.length,
                    totalPages: 1,
                },
            });
            const result = await controller.getPendingApplications(emptyFilters, index_1.TEST_USER_IDS.ADMIN);
            expect(result.applications).toEqual(mockApplicationsList);
            expect(adminTherapistService.getPendingApplications).toHaveBeenCalledWith(emptyFilters);
        });
        it('should handle pagination correctly', async () => {
            const paginatedFilters = { ...mockFilters, page: 2, limit: 10 };
            const paginatedResult = {
                applications: [],
                pagination: {
                    page: 2,
                    limit: 10,
                    total: 50,
                    totalPages: 5,
                },
            };
            mockAdminTherapistService.getPendingApplications.mockResolvedValue(paginatedResult);
            const result = await controller.getPendingApplications(paginatedFilters, index_1.TEST_USER_IDS.ADMIN);
            expect(result.pagination.page).toBe(2);
            expect(result.pagination.limit).toBe(10);
            expect(result.pagination.totalPages).toBe(5);
        });
        it('should handle specialization filters', async () => {
            const specializationFilters = { specialization: 'trauma' };
            const traumaApplications = mockApplicationsList.filter(app => app.specializations.includes('trauma'));
            mockAdminTherapistService.getPendingApplications.mockResolvedValue({
                applications: traumaApplications,
                pagination: { page: 1, limit: 20, total: traumaApplications.length, totalPages: 1 },
            });
            const result = await controller.getPendingApplications(specializationFilters, index_1.TEST_USER_IDS.ADMIN);
            expect(result.applications).toEqual(traumaApplications);
        });
        it('should handle empty results', async () => {
            mockAdminTherapistService.getPendingApplications.mockResolvedValue({
                applications: [],
                pagination: { page: 1, limit: 20, total: 0, totalPages: 0 },
            });
            const result = await controller.getPendingApplications(mockFilters, index_1.TEST_USER_IDS.ADMIN);
            expect(result.applications).toEqual([]);
            expect(result.applications).toHaveLength(0);
        });
        it('should handle service errors', async () => {
            const serviceError = new Error('Database connection failed');
            mockAdminTherapistService.getPendingApplications.mockRejectedValue(serviceError);
            await expect(controller.getPendingApplications(mockFilters, index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(serviceError);
        });
    });
    describe('GET /admin/therapists/applications', () => {
        const mockFilters = { status: 'all', page: 1, limit: 20 };
        it('should get all applications successfully', async () => {
            mockAdminTherapistService.getPendingApplications.mockResolvedValue({
                applications: mockApplicationsList,
                pagination: {
                    page: 1,
                    limit: 20,
                    total: mockApplicationsList.length,
                    totalPages: 1,
                },
            });
            const result = await controller.getAllApplications(mockFilters, index_1.TEST_USER_IDS.ADMIN);
            expect(result.applications).toEqual(mockApplicationsList);
            expect(adminTherapistService.getPendingApplications).toHaveBeenCalledWith(mockFilters);
        });
        it('should handle different status filters', async () => {
            const statusFilters = ['pending', 'approved', 'rejected', 'all'];
            for (const status of statusFilters) {
                const filters = { status, page: 1, limit: 20 };
                const filteredApps = status === 'all'
                    ? mockApplicationsList
                    : mockApplicationsList.filter(app => app.status === status);
                mockAdminTherapistService.getPendingApplications.mockResolvedValue({
                    applications: filteredApps,
                    pagination: { page: 1, limit: 20, total: filteredApps.length, totalPages: 1 },
                });
                const result = await controller.getAllApplications(filters, index_1.TEST_USER_IDS.ADMIN);
                expect(result.applications).toEqual(filteredApps);
            }
        });
        it('should handle service errors', async () => {
            const serviceError = new Error('Service temporarily unavailable');
            mockAdminTherapistService.getPendingApplications.mockRejectedValue(serviceError);
            await expect(controller.getAllApplications(mockFilters, index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(serviceError);
        });
    });
    describe('GET /admin/therapists/:id/details', () => {
        const therapistId = 'therapist_application_123456789';
        it('should get application details successfully', async () => {
            mockAdminTherapistService.getApplicationDetails.mockResolvedValue(mockTherapistApplication);
            const result = await controller.getApplicationDetails(therapistId, index_1.TEST_USER_IDS.ADMIN);
            expect(result).toEqual(mockTherapistApplication);
            expect(adminTherapistService.getApplicationDetails).toHaveBeenCalledWith(therapistId);
        });
        it('should handle application not found', async () => {
            const notFoundError = new common_1.NotFoundException('Therapist application not found');
            mockAdminTherapistService.getApplicationDetails.mockRejectedValue(notFoundError);
            await expect(controller.getApplicationDetails('non-existent-id', index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(notFoundError);
        });
        it('should return complete application details', async () => {
            const detailedApplication = {
                ...mockTherapistApplication,
                additionalInfo: {
                    backgroundCheck: { status: 'completed', date: new Date() },
                    references: [
                        { name: 'Dr. Jane Smith', contact: 'jane@example.com', verified: true },
                        { name: 'Dr. Bob Johnson', contact: 'bob@example.com', verified: true },
                    ],
                    interview: { scheduled: true, date: new Date(), notes: 'Positive interview' },
                },
            };
            mockAdminTherapistService.getApplicationDetails.mockResolvedValue(detailedApplication);
            const result = await controller.getApplicationDetails(therapistId, index_1.TEST_USER_IDS.ADMIN);
            expect(result.additionalInfo).toBeDefined();
            expect(result.additionalInfo.backgroundCheck).toBeDefined();
            expect(result.additionalInfo.references).toHaveLength(2);
        });
        it('should handle service errors', async () => {
            const serviceError = new Error('Database error');
            mockAdminTherapistService.getApplicationDetails.mockRejectedValue(serviceError);
            await expect(controller.getApplicationDetails(therapistId, index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(serviceError);
        });
    });
    describe('POST /admin/therapists/:id/approve', () => {
        const therapistId = 'therapist_application_123456789';
        const approvalDto = {
            specializations: ['anxiety', 'depression'],
            hourlyRate: 150,
            maxClients: 20,
            adminNotes: 'Excellent qualifications and experience',
            onboardingScheduled: true,
        };
        it('should approve therapist successfully', async () => {
            const approvedApplication = {
                ...mockTherapistApplication,
                status: 'approved',
                reviewedBy: index_1.TEST_USER_IDS.ADMIN,
                reviewedAt: new Date(),
                adminNotes: approvalDto.adminNotes,
            };
            mockAdminTherapistService.approveTherapist.mockResolvedValue(approvedApplication);
            const result = await controller.approveTherapist(therapistId, approvalDto, index_1.TEST_USER_IDS.ADMIN);
            expect(result).toEqual(approvedApplication);
            expect(result.status).toBe('approved');
            expect(adminTherapistService.approveTherapist).toHaveBeenCalledWith(therapistId, index_1.TEST_USER_IDS.ADMIN, approvalDto);
        });
        it('should handle different approval configurations', async () => {
            const configurations = [
                { ...approvalDto, maxClients: 15, hourlyRate: 120 },
                { ...approvalDto, specializations: ['trauma', 'PTSD'], maxClients: 25 },
                { ...approvalDto, onboardingScheduled: false },
            ];
            for (const config of configurations) {
                const approvedApp = {
                    ...mockTherapistApplication,
                    status: 'approved',
                    reviewedBy: index_1.TEST_USER_IDS.ADMIN,
                    reviewedAt: new Date(),
                };
                mockAdminTherapistService.approveTherapist.mockResolvedValue(approvedApp);
                const result = await controller.approveTherapist(therapistId, config, index_1.TEST_USER_IDS.ADMIN);
                expect(result.status).toBe('approved');
                expect(adminTherapistService.approveTherapist).toHaveBeenCalledWith(therapistId, index_1.TEST_USER_IDS.ADMIN, config);
            }
        });
        it('should handle application not found', async () => {
            const notFoundError = new common_1.NotFoundException('Therapist application not found');
            mockAdminTherapistService.approveTherapist.mockRejectedValue(notFoundError);
            await expect(controller.approveTherapist('non-existent-id', approvalDto, index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(notFoundError);
        });
        it('should handle already approved application', async () => {
            const alreadyApprovedError = new common_1.BadRequestException('Application already approved');
            mockAdminTherapistService.approveTherapist.mockRejectedValue(alreadyApprovedError);
            await expect(controller.approveTherapist(therapistId, approvalDto, index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(alreadyApprovedError);
        });
        it('should handle validation errors', async () => {
            const validationError = new common_1.BadRequestException('Invalid hourly rate');
            mockAdminTherapistService.approveTherapist.mockRejectedValue(validationError);
            await expect(controller.approveTherapist(therapistId, { ...approvalDto, hourlyRate: -50 }, index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(validationError);
        });
        it('should handle service errors', async () => {
            const serviceError = new Error('Email service unavailable');
            mockAdminTherapistService.approveTherapist.mockRejectedValue(serviceError);
            await expect(controller.approveTherapist(therapistId, approvalDto, index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(serviceError);
        });
    });
    describe('POST /admin/therapists/:id/reject', () => {
        const therapistId = 'therapist_application_123456789';
        const rejectionDto = {
            reason: 'Insufficient experience for specialization requirements',
            feedback: 'Please gain more experience and reapply in 2 years',
            allowReapplication: true,
            reapplicationDate: new Date('2026-01-01'),
        };
        it('should reject therapist successfully', async () => {
            const rejectedApplication = {
                ...mockTherapistApplication,
                status: 'rejected',
                reviewedBy: index_1.TEST_USER_IDS.ADMIN,
                reviewedAt: new Date(),
                adminNotes: rejectionDto.reason,
            };
            mockAdminTherapistService.rejectTherapist.mockResolvedValue(rejectedApplication);
            const result = await controller.rejectTherapist(therapistId, rejectionDto, index_1.TEST_USER_IDS.ADMIN);
            expect(result).toEqual(rejectedApplication);
            expect(result.status).toBe('rejected');
            expect(adminTherapistService.rejectTherapist).toHaveBeenCalledWith(therapistId, index_1.TEST_USER_IDS.ADMIN, rejectionDto);
        });
        it('should handle different rejection reasons', async () => {
            const rejectionReasons = [
                'License verification failed',
                'Background check issues',
                'Insufficient qualifications',
                'Application incomplete',
                'Does not meet state requirements',
            ];
            for (const reason of rejectionReasons) {
                const dto = { ...rejectionDto, reason };
                const rejectedApp = {
                    ...mockTherapistApplication,
                    status: 'rejected',
                    reviewedBy: index_1.TEST_USER_IDS.ADMIN,
                    reviewedAt: new Date(),
                    adminNotes: reason,
                };
                mockAdminTherapistService.rejectTherapist.mockResolvedValue(rejectedApp);
                const result = await controller.rejectTherapist(therapistId, dto, index_1.TEST_USER_IDS.ADMIN);
                expect(result.status).toBe('rejected');
                expect(result.adminNotes).toBe(reason);
            }
        });
        it('should handle rejection with no reapplication allowed', async () => {
            const permanentRejectionDto = {
                ...rejectionDto,
                allowReapplication: false,
                reapplicationDate: null,
            };
            const rejectedApp = {
                ...mockTherapistApplication,
                status: 'rejected',
                reviewedBy: index_1.TEST_USER_IDS.ADMIN,
                reviewedAt: new Date(),
            };
            mockAdminTherapistService.rejectTherapist.mockResolvedValue(rejectedApp);
            const result = await controller.rejectTherapist(therapistId, permanentRejectionDto, index_1.TEST_USER_IDS.ADMIN);
            expect(result.status).toBe('rejected');
            expect(adminTherapistService.rejectTherapist).toHaveBeenCalledWith(therapistId, index_1.TEST_USER_IDS.ADMIN, permanentRejectionDto);
        });
        it('should handle application not found', async () => {
            const notFoundError = new common_1.NotFoundException('Therapist application not found');
            mockAdminTherapistService.rejectTherapist.mockRejectedValue(notFoundError);
            await expect(controller.rejectTherapist('non-existent-id', rejectionDto, index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(notFoundError);
        });
        it('should handle already processed application', async () => {
            const alreadyProcessedError = new common_1.BadRequestException('Application already processed');
            mockAdminTherapistService.rejectTherapist.mockRejectedValue(alreadyProcessedError);
            await expect(controller.rejectTherapist(therapistId, rejectionDto, index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(alreadyProcessedError);
        });
    });
    describe('PUT /admin/therapists/:id/status', () => {
        const therapistId = 'therapist_application_123456789';
        const statusDto = {
            status: 'active',
            reason: 'Regular status update',
            effectiveDate: new Date(),
        };
        it('should update therapist status successfully', async () => {
            const updatedTherapist = {
                ...mockTherapistApplication,
                status: 'active',
                updatedBy: index_1.TEST_USER_IDS.ADMIN,
                updatedAt: new Date(),
            };
            mockAdminTherapistService.updateTherapistStatus.mockResolvedValue(updatedTherapist);
            const result = await controller.updateTherapistStatus(therapistId, statusDto, index_1.TEST_USER_IDS.ADMIN);
            expect(result).toEqual(updatedTherapist);
            expect(result.status).toBe('active');
            expect(adminTherapistService.updateTherapistStatus).toHaveBeenCalledWith(therapistId, index_1.TEST_USER_IDS.ADMIN, statusDto);
        });
        it('should handle all valid status transitions', async () => {
            const statuses = ['active', 'inactive', 'suspended', 'terminated'];
            for (const status of statuses) {
                const dto = { ...statusDto, status };
                const updatedTherapist = {
                    ...mockTherapistApplication,
                    status,
                    updatedBy: index_1.TEST_USER_IDS.ADMIN,
                    updatedAt: new Date(),
                };
                mockAdminTherapistService.updateTherapistStatus.mockResolvedValue(updatedTherapist);
                const result = await controller.updateTherapistStatus(therapistId, dto, index_1.TEST_USER_IDS.ADMIN);
                expect(result.status).toBe(status);
            }
        });
        it('should handle therapist not found', async () => {
            const notFoundError = new common_1.NotFoundException('Therapist not found');
            mockAdminTherapistService.updateTherapistStatus.mockRejectedValue(notFoundError);
            await expect(controller.updateTherapistStatus('non-existent-id', statusDto, index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(notFoundError);
        });
        it('should handle invalid status transitions', async () => {
            const invalidTransitionError = new common_1.BadRequestException('Invalid status transition');
            mockAdminTherapistService.updateTherapistStatus.mockRejectedValue(invalidTransitionError);
            await expect(controller.updateTherapistStatus(therapistId, statusDto, index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(invalidTransitionError);
        });
        it('should handle service errors', async () => {
            const serviceError = new Error('Database update failed');
            mockAdminTherapistService.updateTherapistStatus.mockRejectedValue(serviceError);
            await expect(controller.updateTherapistStatus(therapistId, statusDto, index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(serviceError);
        });
    });
    describe('GET /admin/therapists/metrics', () => {
        it('should get therapist application metrics successfully', async () => {
            mockAdminTherapistService.getTherapistApplicationMetrics.mockResolvedValue(mockApplicationMetrics);
            const result = await controller.getTherapistApplicationMetrics(undefined, undefined, index_1.TEST_USER_IDS.ADMIN);
            expect(result).toEqual(mockApplicationMetrics);
            expect(adminTherapistService.getTherapistApplicationMetrics).toHaveBeenCalledWith(undefined, undefined);
        });
        it('should get metrics with date range', async () => {
            const startDate = '2024-01-01';
            const endDate = '2024-02-29';
            const dateRangeMetrics = {
                ...mockApplicationMetrics,
                totalApplications: 27,
                monthlyApplications: mockApplicationMetrics.monthlyApplications.slice(0, 2),
            };
            mockAdminTherapistService.getTherapistApplicationMetrics.mockResolvedValue(dateRangeMetrics);
            const result = await controller.getTherapistApplicationMetrics(startDate, endDate, index_1.TEST_USER_IDS.ADMIN);
            expect(result).toEqual(dateRangeMetrics);
            expect(adminTherapistService.getTherapistApplicationMetrics).toHaveBeenCalledWith(startDate, endDate);
        });
        it('should handle empty metrics', async () => {
            const emptyMetrics = {
                totalApplications: 0,
                pendingApplications: 0,
                approvedApplications: 0,
                rejectedApplications: 0,
                averageProcessingTime: 0,
                monthlyApplications: [],
                specializations: [],
                averageExperience: 0,
                topStates: [],
            };
            mockAdminTherapistService.getTherapistApplicationMetrics.mockResolvedValue(emptyMetrics);
            const result = await controller.getTherapistApplicationMetrics(undefined, undefined, index_1.TEST_USER_IDS.ADMIN);
            expect(result).toEqual(emptyMetrics);
            expect(result.totalApplications).toBe(0);
        });
        it('should validate metrics response structure', async () => {
            mockAdminTherapistService.getTherapistApplicationMetrics.mockResolvedValue(mockApplicationMetrics);
            const result = await controller.getTherapistApplicationMetrics(undefined, undefined, index_1.TEST_USER_IDS.ADMIN);
            expect(result).toHaveProperty('totalApplications');
            expect(result).toHaveProperty('pendingApplications');
            expect(result).toHaveProperty('approvedApplications');
            expect(result).toHaveProperty('rejectedApplications');
            expect(result).toHaveProperty('averageProcessingTime');
            expect(Array.isArray(result.monthlyApplications)).toBe(true);
            expect(Array.isArray(result.specializations)).toBe(true);
            expect(Array.isArray(result.topStates)).toBe(true);
        });
        it('should handle service errors', async () => {
            const serviceError = new Error('Analytics service unavailable');
            mockAdminTherapistService.getTherapistApplicationMetrics.mockRejectedValue(serviceError);
            await expect(controller.getTherapistApplicationMetrics(undefined, undefined, index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(serviceError);
        });
    });
    describe('Error Handling', () => {
        it('should handle service unavailable scenarios', async () => {
            const serviceError = new Error('Service temporarily unavailable');
            mockAdminTherapistService.getPendingApplications.mockRejectedValue(serviceError);
            await expect(controller.getPendingApplications({}, index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(serviceError);
        });
        it('should handle database connection errors', async () => {
            const dbError = new Error('Database connection failed');
            mockAdminTherapistService.getApplicationDetails.mockRejectedValue(dbError);
            await expect(controller.getApplicationDetails('therapist_123', index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(dbError);
        });
        it('should handle validation errors', async () => {
            const validationError = new common_1.BadRequestException('Invalid application data');
            mockAdminTherapistService.approveTherapist.mockRejectedValue(validationError);
            await expect(controller.approveTherapist('therapist_123', {}, index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(validationError);
        });
    });
    describe('Response Format Validation', () => {
        it('should return properly formatted application list response', async () => {
            mockAdminTherapistService.getPendingApplications.mockResolvedValue({
                applications: mockApplicationsList,
                pagination: { page: 1, limit: 20, total: 2, totalPages: 1 },
            });
            const result = await controller.getPendingApplications({}, index_1.TEST_USER_IDS.ADMIN);
            expect(result).toHaveProperty('applications');
            expect(result).toHaveProperty('pagination');
            expect(Array.isArray(result.applications)).toBe(true);
            result.applications.forEach((app) => {
                enhanced_test_helpers_1.TestAssertions.expectValidEntity(app, ['id', 'email', 'firstName', 'lastName', 'status']);
                expect(['pending', 'approved', 'rejected']).toContain(app.status);
            });
        });
        it('should return properly formatted application details response', async () => {
            mockAdminTherapistService.getApplicationDetails.mockResolvedValue(mockTherapistApplication);
            const result = await controller.getApplicationDetails('therapist_123', index_1.TEST_USER_IDS.ADMIN);
            enhanced_test_helpers_1.TestAssertions.expectValidEntity(result, ['id', 'email', 'firstName', 'lastName', 'status']);
            expect(Array.isArray(result.specializations)).toBe(true);
            expect(Array.isArray(result.documents)).toBe(true);
            expect(typeof result.yearsOfExperience).toBe('number');
            expect(typeof result.hourlyRate).toBe('number');
        });
        it('should return properly formatted metrics response', async () => {
            mockAdminTherapistService.getTherapistApplicationMetrics.mockResolvedValue(mockApplicationMetrics);
            const result = await controller.getTherapistApplicationMetrics(undefined, undefined, index_1.TEST_USER_IDS.ADMIN);
            expect(typeof result.totalApplications).toBe('number');
            expect(typeof result.averageProcessingTime).toBe('number');
            expect(typeof result.averageExperience).toBe('number');
            expect(Array.isArray(result.monthlyApplications)).toBe(true);
            expect(Array.isArray(result.specializations)).toBe(true);
            expect(Array.isArray(result.topStates)).toBe(true);
        });
    });
    describe('Integration Tests', () => {
        it('should handle complete application approval workflow', async () => {
            // Get application details
            mockAdminTherapistService.getApplicationDetails.mockResolvedValue(mockTherapistApplication);
            const details = await controller.getApplicationDetails('therapist_123', index_1.TEST_USER_IDS.ADMIN);
            expect(details).toBeDefined();
            // Approve application
            const approvalDto = {
                specializations: ['anxiety', 'depression'],
                hourlyRate: 150,
                maxClients: 20,
                adminNotes: 'Approved',
                onboardingScheduled: true,
            };
            const approvedApp = { ...mockTherapistApplication, status: 'approved' };
            mockAdminTherapistService.approveTherapist.mockResolvedValue(approvedApp);
            const approval = await controller.approveTherapist('therapist_123', approvalDto, index_1.TEST_USER_IDS.ADMIN);
            expect(approval.status).toBe('approved');
            // Update status to active
            const statusDto = { status: 'active', reason: 'Onboarding completed' };
            const activeTherapist = { ...approvedApp, status: 'active' };
            mockAdminTherapistService.updateTherapistStatus.mockResolvedValue(activeTherapist);
            const statusUpdate = await controller.updateTherapistStatus('therapist_123', statusDto, index_1.TEST_USER_IDS.ADMIN);
            expect(statusUpdate.status).toBe('active');
        });
        it('should handle complete application rejection workflow', async () => {
            // Get application details
            mockAdminTherapistService.getApplicationDetails.mockResolvedValue(mockTherapistApplication);
            const details = await controller.getApplicationDetails('therapist_123', index_1.TEST_USER_IDS.ADMIN);
            expect(details).toBeDefined();
            // Reject application
            const rejectionDto = {
                reason: 'Insufficient experience',
                feedback: 'Please gain more experience',
                allowReapplication: true,
                reapplicationDate: new Date('2026-01-01'),
            };
            const rejectedApp = { ...mockTherapistApplication, status: 'rejected' };
            mockAdminTherapistService.rejectTherapist.mockResolvedValue(rejectedApp);
            const rejection = await controller.rejectTherapist('therapist_123', rejectionDto, index_1.TEST_USER_IDS.ADMIN);
            expect(rejection.status).toBe('rejected');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL2FkbWluL2NvbnRyb2xsZXJzL2FkbWluLXRoZXJhcGlzdC5jb250cm9sbGVyLnNwZWMudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7R0FHRzs7QUFFSCw2Q0FBc0Q7QUFDdEQsMkNBQXVIO0FBQ3ZILDZFQUF3RTtBQUN4RSxpRkFBNEU7QUFDNUUscUVBQWdFO0FBQ2hFLHlFQUFvRTtBQUdwRSxrRkFBd0c7QUFDeEcsa0RBQW9FO0FBRXBFLFFBQVEsQ0FBQywwQkFBMEIsRUFBRSxHQUFHLEVBQUU7SUFDeEMsSUFBSSxVQUFvQyxDQUFDO0lBQ3pDLElBQUkscUJBQTRDLENBQUM7SUFDakQsSUFBSSxNQUFxQixDQUFDO0lBRTFCLDZCQUE2QjtJQUM3QixNQUFNLHlCQUF5QixHQUFHO1FBQ2hDLHNCQUFzQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDakMscUJBQXFCLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUNoQyxnQkFBZ0IsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQzNCLGVBQWUsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQzFCLHFCQUFxQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDaEMsOEJBQThCLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtLQUMxQyxDQUFDO0lBRUYsY0FBYztJQUNkLE1BQU0sZ0JBQWdCLEdBQUc7UUFDdkIsV0FBVyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDO0tBQzdDLENBQUM7SUFFRixNQUFNLGtCQUFrQixHQUFHO1FBQ3pCLFdBQVcsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQztLQUM3QyxDQUFDO0lBRUYsWUFBWTtJQUNaLE1BQU0sd0JBQXdCLEdBQUc7UUFDL0IsRUFBRSxFQUFFLGlDQUFpQztRQUNyQyxNQUFNLEVBQUUs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LEtBQUssSUFBSSxFQUFFO1lBQ3JFLDBCQUEwQjtZQUMxQix5QkFBeUIsQ0FBQyxxQkFBcUIsQ0FBQyxpQkFBaUIsQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDO1lBQzVGLE1BQU0sT0FBTyxHQUFHLE1BQU0sVUFBVSxDQUFDLHFCQUFxQixDQUFDLGVBQWUsRUFBRSxxQkFBYSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQzdGLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUU5QixxQkFBcUI7WUFDckIsTUFBTSxZQUFZLEdBQUc7Z0JBQ25CLE1BQU0sRUFBRSx5QkFBeUI7Z0JBQ2pDLFFBQVEsRUFBRSw2QkFBNkI7Z0JBQ3ZDLGtCQUFrQixFQUFFLElBQUk7Z0JBQ3hCLGlCQUFpQixFQUFFLElBQUksSUFBSSxDQUFDLFlBQVksQ0FBQzthQUMxQyxDQUFDO1lBQ0YsTUFBTSxXQUFXLEdBQUcsRUFBRSxHQUFHLHdCQUF3QixFQUFFLE1BQU0sRUFBRSxVQUFVLEVBQUUsQ0FBQztZQUN4RSx5QkFBeUIsQ0FBQyxlQUFlLENBQUMsaUJBQWlCLENBQUMsV0FBVyxDQUFDLENBQUM7WUFDekUsTUFBTSxTQUFTLEdBQUcsTUFBTSxVQUFVLENBQUMsZUFBZSxDQUFDLGVBQWUsRUFBRSxZQUFZLEVBQUUscUJBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUN2RyxNQUFNLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUM1QyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL2FkbWluL2NvbnRyb2xsZXJzL2FkbWluLXRoZXJhcGlzdC5jb250cm9sbGVyLnNwZWMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb21wcmVoZW5zaXZlIFRlc3QgU3VpdGUgZm9yIEFkbWluVGhlcmFwaXN0Q29udHJvbGxlclxuICogVGVzdHMgYWRtaW4gZnVuY3Rpb25hbGl0eSBmb3IgbWFuYWdpbmcgdGhlcmFwaXN0IGFwcGxpY2F0aW9ucyBhbmQgc3RhdHVzXG4gKi9cblxuaW1wb3J0IHsgVGVzdCwgVGVzdGluZ01vZHVsZSB9IGZyb20gJ0BuZXN0anMvdGVzdGluZyc7XG5pbXBvcnQgeyBCYWRSZXF1ZXN0RXhjZXB0aW9uLCBOb3RGb3VuZEV4Y2VwdGlvbiwgRm9yYmlkZGVuRXhjZXB0aW9uLCBIdHRwRXhjZXB0aW9uLCBIdHRwU3RhdHVzIH0gZnJvbSAnQG5lc3Rqcy9jb21tb24nO1xuaW1wb3J0IHsgQWRtaW5UaGVyYXBpc3RDb250cm9sbGVyIH0gZnJvbSAnLi9hZG1pbi10aGVyYXBpc3QuY29udHJvbGxlcic7XG5pbXBvcnQgeyBBZG1pblRoZXJhcGlzdFNlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy9hZG1pbi10aGVyYXBpc3Quc2VydmljZSc7XG5pbXBvcnQgeyBKd3RBdXRoR3VhcmQgfSBmcm9tICcuLi8uLi9hdXRoL2d1YXJkcy9qd3QtYXV0aC5ndWFyZCc7XG5pbXBvcnQgeyBBZG1pbkF1dGhHdWFyZCB9IGZyb20gJy4uLy4uL2F1dGgvZ3VhcmRzL2FkbWluLWF1dGguZ3VhcmQnO1xuaW1wb3J0IHsgWm9kVmFsaWRhdGlvblBpcGUgfSBmcm9tICcuLi8uLi9jb21tb24vcGlwZXMvem9kLXZhbGlkYXRpb24ucGlwZSc7XG5pbXBvcnQgeyBTZWN1cml0eUd1YXJkVGVzdFV0aWxzLCBSb2xlQmFzZWRUZXN0VXRpbHMgfSBmcm9tICcuLi8uLi90ZXN0LXV0aWxzL2F1dGgtdGVzdGluZy1oZWxwZXJzJztcbmltcG9ydCB7IE1vY2tCdWlsZGVyLCBUZXN0RGF0YUdlbmVyYXRvciwgVGVzdEFzc2VydGlvbnMgfSBmcm9tICcuLi8uLi90ZXN0LXV0aWxzL2VuaGFuY2VkLXRlc3QtaGVscGVycyc7XG5pbXBvcnQgeyBURVNUX1VTRVJfSURTLCBURVNUX0VNQUlMUyB9IGZyb20gJy4uLy4uL3Rlc3QtdXRpbHMvaW5kZXgnO1xuXG5kZXNjcmliZSgnQWRtaW5UaGVyYXBpc3RDb250cm9sbGVyJywgKCkgPT4ge1xuICBsZXQgY29udHJvbGxlcjogQWRtaW5UaGVyYXBpc3RDb250cm9sbGVyO1xuICBsZXQgYWRtaW5UaGVyYXBpc3RTZXJ2aWNlOiBBZG1pblRoZXJhcGlzdFNlcnZpY2U7XG4gIGxldCBtb2R1bGU6IFRlc3RpbmdNb2R1bGU7XG5cbiAgLy8gTW9jayBBZG1pblRoZXJhcGlzdFNlcnZpY2VcbiAgY29uc3QgbW9ja0FkbWluVGhlcmFwaXN0U2VydmljZSA9IHtcbiAgICBnZXRQZW5kaW5nQXBwbGljYXRpb25zOiBqZXN0LmZuKCksXG4gICAgZ2V0QXBwbGljYXRpb25EZXRhaWxzOiBqZXN0LmZuKCksXG4gICAgYXBwcm92ZVRoZXJhcGlzdDogamVzdC5mbigpLFxuICAgIHJlamVjdFRoZXJhcGlzdDogamVzdC5mbigpLFxuICAgIHVwZGF0ZVRoZXJhcGlzdFN0YXR1czogamVzdC5mbigpLFxuICAgIGdldFRoZXJhcGlzdEFwcGxpY2F0aW9uTWV0cmljczogamVzdC5mbigpLFxuICB9O1xuXG4gIC8vIE1vY2sgR3VhcmRzXG4gIGNvbnN0IG1vY2tKd3RBdXRoR3VhcmQgPSB7XG4gICAgY2FuQWN0aXZhdGU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUodHJ1ZSksXG4gIH07XG5cbiAgY29uc3QgbW9ja0FkbWluQXV0aEd1YXJkID0ge1xuICAgIGNhbkFjdGl2YXRlOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHRydWUpLFxuICB9O1xuXG4gIC8vIFRlc3QgZGF0YVxuICBjb25zdCBtb2NrVGhlcmFwaXN0QXBwbGljYXRpb24gPSB7XG4gICAgaWQ6ICd0aGVyYXBpc3RfYXBwbGljYXRpb25fMTIzNDU2Nzg5JyxcbiAgICB1c2VySWQ6IFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNULFxuICAgIGVtYWlsOiBURVNUX0VNQUlMUy5USEVSQVBJU1QsXG4gICAgZmlyc3ROYW1lOiAnRHIuIFNhcmFoJyxcbiAgICBsYXN0TmFtZTogJ1NtaXRoJyxcbiAgICBzdGF0dXM6ICdwZW5kaW5nJyxcbiAgICBsaWNlbnNlTnVtYmVyOiAnUFNZMTIzNDU2JyxcbiAgICBsaWNlbnNlU3RhdGU6ICdDYWxpZm9ybmlhJyxcbiAgICBsaWNlbnNlRXhwaXJ5OiBuZXcgRGF0ZSgnMjAyNS0xMi0zMScpLFxuICAgIHNwZWNpYWxpemF0aW9uczogWydhbnhpZXR5JywgJ2RlcHJlc3Npb24nLCAndHJhdW1hJ10sXG4gICAgeWVhcnNPZkV4cGVyaWVuY2U6IDgsXG4gICAgZWR1Y2F0aW9uOiAnUGhEIGluIENsaW5pY2FsIFBzeWNob2xvZ3knLFxuICAgIGNlcnRpZmljYXRpb25zOiBbJ0xpY2Vuc2VkIENsaW5pY2FsIFBzeWNob2xvZ2lzdCcsICdUcmF1bWEtSW5mb3JtZWQgQ2FyZSddLFxuICAgIGJpbzogJ0V4cGVyaWVuY2VkIHRoZXJhcGlzdCBzcGVjaWFsaXppbmcgaW4gYW54aWV0eSBhbmQgdHJhdW1hIHRyZWF0bWVudCcsXG4gICAgaG91cmx5UmF0ZTogMTUwLFxuICAgIGF2YWlsYWJsZUhvdXJzOiA0MCxcbiAgICBwcmVmZXJyZWRDbGllbnRUeXBlczogWydhZHVsdHMnLCAndGVlbnMnXSxcbiAgICB0cmVhdG1lbnRBcHByb2FjaGVzOiBbJ0NCVCcsICdEQlQnLCAnRU1EUiddLFxuICAgIGFwcGxpY2F0aW9uRGF0ZTogbmV3IERhdGUoJzIwMjQtMDEtMTUnKSxcbiAgICBkb2N1bWVudHM6IFtcbiAgICAgIHtcbiAgICAgICAgdHlwZTogJ2xpY2Vuc2UnLFxuICAgICAgICB1cmw6ICdodHRwczovL3N0b3JhZ2UuZXhhbXBsZS5jb20vbGljZW5zZS5wZGYnLFxuICAgICAgICB2ZXJpZmllZDogZmFsc2UsXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICB0eXBlOiAnY3YnLFxuICAgICAgICB1cmw6ICdodHRwczovL3N0b3JhZ2UuZXhhbXBsZS5jb20vY3YucGRmJyxcbiAgICAgICAgdmVyaWZpZWQ6IGZhbHNlLFxuICAgICAgfSxcbiAgICBdLFxuICAgIGFkbWluTm90ZXM6ICcnLFxuICAgIHJldmlld2VkQnk6IG51bGwsXG4gICAgcmV2aWV3ZWRBdDogbnVsbCxcbiAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICB9O1xuXG4gIGNvbnN0IG1vY2tBcHBsaWNhdGlvbnNMaXN0ID0gW1xuICAgIG1vY2tUaGVyYXBpc3RBcHBsaWNhdGlvbixcbiAgICB7XG4gICAgICAuLi5tb2NrVGhlcmFwaXN0QXBwbGljYXRpb24sXG4gICAgICBpZDogJ3RoZXJhcGlzdF9hcHBsaWNhdGlvbl85ODc2NTQzMjEnLFxuICAgICAgZmlyc3ROYW1lOiAnRHIuIEpvaG4nLFxuICAgICAgbGFzdE5hbWU6ICdEb2UnLFxuICAgICAgZW1haWw6ICdqb2huLmRvZUBleGFtcGxlLmNvbScsXG4gICAgICBzdGF0dXM6ICdhcHByb3ZlZCcsXG4gICAgICByZXZpZXdlZEJ5OiBURVNUX1VTRVJfSURTLkFETUlOLFxuICAgICAgcmV2aWV3ZWRBdDogbmV3IERhdGUoKSxcbiAgICB9LFxuICBdO1xuXG4gIGNvbnN0IG1vY2tBcHBsaWNhdGlvbk1ldHJpY3MgPSB7XG4gICAgdG90YWxBcHBsaWNhdGlvbnM6IDEyNSxcbiAgICBwZW5kaW5nQXBwbGljYXRpb25zOiAyMyxcbiAgICBhcHByb3ZlZEFwcGxpY2F0aW9uczogODksXG4gICAgcmVqZWN0ZWRBcHBsaWNhdGlvbnM6IDEzLFxuICAgIGF2ZXJhZ2VQcm9jZXNzaW5nVGltZTogNS4yLCAvLyBkYXlzXG4gICAgbW9udGhseUFwcGxpY2F0aW9uczogW1xuICAgICAgeyBtb250aDogJzIwMjQtMDEnLCB0b3RhbDogMTIsIGFwcHJvdmVkOiA4LCByZWplY3RlZDogMiwgcGVuZGluZzogMiB9LFxuICAgICAgeyBtb250aDogJzIwMjQtMDInLCB0b3RhbDogMTUsIGFwcHJvdmVkOiAxMSwgcmVqZWN0ZWQ6IDEsIHBlbmRpbmc6IDMgfSxcbiAgICBdLFxuICAgIHNwZWNpYWxpemF0aW9uczogW1xuICAgICAgeyBuYW1lOiAnYW54aWV0eScsIGNvdW50OiA0NSB9LFxuICAgICAgeyBuYW1lOiAnZGVwcmVzc2lvbicsIGNvdW50OiAzOCB9LFxuICAgICAgeyBuYW1lOiAndHJhdW1hJywgY291bnQ6IDI5IH0sXG4gICAgXSxcbiAgICBhdmVyYWdlRXhwZXJpZW5jZTogNi44LFxuICAgIHRvcFN0YXRlczogW1xuICAgICAgeyBzdGF0ZTogJ0NhbGlmb3JuaWEnLCBjb3VudDogMjggfSxcbiAgICAgIHsgc3RhdGU6ICdOZXcgWW9yaycsIGNvdW50OiAxOSB9LFxuICAgICAgeyBzdGF0ZTogJ1RleGFzJywgY291bnQ6IDE1IH0sXG4gICAgXSxcbiAgfTtcblxuICBiZWZvcmVFYWNoKGFzeW5jICgpID0+IHtcbiAgICBtb2R1bGUgPSBhd2FpdCBUZXN0LmNyZWF0ZVRlc3RpbmdNb2R1bGUoe1xuICAgICAgY29udHJvbGxlcnM6IFtBZG1pblRoZXJhcGlzdENvbnRyb2xsZXJdLFxuICAgICAgcHJvdmlkZXJzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlOiBBZG1pblRoZXJhcGlzdFNlcnZpY2UsXG4gICAgICAgICAgdXNlVmFsdWU6IG1vY2tBZG1pblRoZXJhcGlzdFNlcnZpY2UsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgIH0pXG4gICAgICAub3ZlcnJpZGVHdWFyZChKd3RBdXRoR3VhcmQpXG4gICAgICAudXNlVmFsdWUobW9ja0p3dEF1dGhHdWFyZClcbiAgICAgIC5vdmVycmlkZUd1YXJkKEFkbWluQXV0aEd1YXJkKVxuICAgICAgLnVzZVZhbHVlKG1vY2tBZG1pbkF1dGhHdWFyZClcbiAgICAgIC5jb21waWxlKCk7XG5cbiAgICBjb250cm9sbGVyID0gbW9kdWxlLmdldDxBZG1pblRoZXJhcGlzdENvbnRyb2xsZXI+KEFkbWluVGhlcmFwaXN0Q29udHJvbGxlcik7XG4gICAgYWRtaW5UaGVyYXBpc3RTZXJ2aWNlID0gbW9kdWxlLmdldDxBZG1pblRoZXJhcGlzdFNlcnZpY2U+KEFkbWluVGhlcmFwaXN0U2VydmljZSk7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdDb250cm9sbGVyIEluaXRpYWxpemF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgYmUgZGVmaW5lZCcsICgpID0+IHtcbiAgICAgIGV4cGVjdChjb250cm9sbGVyKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYXZlIGFkbWluVGhlcmFwaXN0U2VydmljZSBpbmplY3RlZCcsICgpID0+IHtcbiAgICAgIGV4cGVjdChhZG1pblRoZXJhcGlzdFNlcnZpY2UpLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdTZWN1cml0eSBHdWFyZHMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBiZSBwcm90ZWN0ZWQgYnkgSnd0QXV0aEd1YXJkIGFuZCBBZG1pbkF1dGhHdWFyZCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGd1YXJkcyA9IFJlZmxlY3QuZ2V0TWV0YWRhdGEoJ19fZ3VhcmRzX18nLCBBZG1pblRoZXJhcGlzdENvbnRyb2xsZXIpO1xuICAgICAgZXhwZWN0KGd1YXJkcykudG9Db250YWluKEp3dEF1dGhHdWFyZCk7XG4gICAgICBleHBlY3QoZ3VhcmRzKS50b0NvbnRhaW4oQWRtaW5BdXRoR3VhcmQpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYXZlIEFkbWluT25seSBkZWNvcmF0b3InLCAoKSA9PiB7XG4gICAgICBjb25zdCBtZXRhZGF0YSA9IFJlZmxlY3QuZ2V0TWV0YWRhdGEoJ2FkbWluX29ubHknLCBBZG1pblRoZXJhcGlzdENvbnRyb2xsZXIpO1xuICAgICAgZXhwZWN0KG1ldGFkYXRhKS50b0JlVHJ1dGh5KCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhdmUgcHJvcGVyIHJvdXRlIGRlY29yYXRvcnMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBjb250cm9sbGVyTWV0YWRhdGEgPSBSZWZsZWN0LmdldE1ldGFkYXRhKCdwYXRoJywgQWRtaW5UaGVyYXBpc3RDb250cm9sbGVyKTtcbiAgICAgIGV4cGVjdChjb250cm9sbGVyTWV0YWRhdGEpLnRvQmUoJ2FkbWluL3RoZXJhcGlzdHMnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0dFVCAvYWRtaW4vdGhlcmFwaXN0cy9wZW5kaW5nJywgKCkgPT4ge1xuICAgIGNvbnN0IG1vY2tGaWx0ZXJzID0ge1xuICAgICAgc3RhdHVzOiAncGVuZGluZycgYXMgY29uc3QsXG4gICAgICBzcGVjaWFsaXphdGlvbjogJ2FueGlldHknLFxuICAgICAgc3RhdGU6ICdDYWxpZm9ybmlhJyxcbiAgICAgIGV4cGVyaWVuY2VNaW46IDMsXG4gICAgICBleHBlcmllbmNlTWF4OiAxMCxcbiAgICAgIHBhZ2U6IDEsXG4gICAgICBsaW1pdDogMjAsXG4gICAgfTtcblxuICAgIGl0KCdzaG91bGQgZ2V0IHBlbmRpbmcgYXBwbGljYXRpb25zIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHBlbmRpbmdBcHBsaWNhdGlvbnMgPSBtb2NrQXBwbGljYXRpb25zTGlzdC5maWx0ZXIoYXBwID0+IGFwcC5zdGF0dXMgPT09ICdwZW5kaW5nJyk7XG4gICAgICBtb2NrQWRtaW5UaGVyYXBpc3RTZXJ2aWNlLmdldFBlbmRpbmdBcHBsaWNhdGlvbnMubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBhcHBsaWNhdGlvbnM6IHBlbmRpbmdBcHBsaWNhdGlvbnMsXG4gICAgICAgIHBhZ2luYXRpb246IHtcbiAgICAgICAgICBwYWdlOiAxLFxuICAgICAgICAgIGxpbWl0OiAyMCxcbiAgICAgICAgICB0b3RhbDogcGVuZGluZ0FwcGxpY2F0aW9ucy5sZW5ndGgsXG4gICAgICAgICAgdG90YWxQYWdlczogMSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldFBlbmRpbmdBcHBsaWNhdGlvbnMobW9ja0ZpbHRlcnMsIFRFU1RfVVNFUl9JRFMuQURNSU4pO1xuXG4gICAgICBleHBlY3QocmVzdWx0LmFwcGxpY2F0aW9ucykudG9FcXVhbChwZW5kaW5nQXBwbGljYXRpb25zKTtcbiAgICAgIGV4cGVjdChhZG1pblRoZXJhcGlzdFNlcnZpY2UuZ2V0UGVuZGluZ0FwcGxpY2F0aW9ucykudG9IYXZlQmVlbkNhbGxlZFdpdGgobW9ja0ZpbHRlcnMpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBnZXQgcGVuZGluZyBhcHBsaWNhdGlvbnMgd2l0aG91dCBmaWx0ZXJzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZW1wdHlGaWx0ZXJzID0ge307XG4gICAgICBtb2NrQWRtaW5UaGVyYXBpc3RTZXJ2aWNlLmdldFBlbmRpbmdBcHBsaWNhdGlvbnMubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBhcHBsaWNhdGlvbnM6IG1vY2tBcHBsaWNhdGlvbnNMaXN0LFxuICAgICAgICBwYWdpbmF0aW9uOiB7XG4gICAgICAgICAgcGFnZTogMSxcbiAgICAgICAgICBsaW1pdDogMjAsXG4gICAgICAgICAgdG90YWw6IG1vY2tBcHBsaWNhdGlvbnNMaXN0Lmxlbmd0aCxcbiAgICAgICAgICB0b3RhbFBhZ2VzOiAxLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0UGVuZGluZ0FwcGxpY2F0aW9ucyhlbXB0eUZpbHRlcnMsIFRFU1RfVVNFUl9JRFMuQURNSU4pO1xuXG4gICAgICBleHBlY3QocmVzdWx0LmFwcGxpY2F0aW9ucykudG9FcXVhbChtb2NrQXBwbGljYXRpb25zTGlzdCk7XG4gICAgICBleHBlY3QoYWRtaW5UaGVyYXBpc3RTZXJ2aWNlLmdldFBlbmRpbmdBcHBsaWNhdGlvbnMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGVtcHR5RmlsdGVycyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBwYWdpbmF0aW9uIGNvcnJlY3RseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHBhZ2luYXRlZEZpbHRlcnMgPSB7IC4uLm1vY2tGaWx0ZXJzLCBwYWdlOiAyLCBsaW1pdDogMTAgfTtcbiAgICAgIGNvbnN0IHBhZ2luYXRlZFJlc3VsdCA9IHtcbiAgICAgICAgYXBwbGljYXRpb25zOiBbXSxcbiAgICAgICAgcGFnaW5hdGlvbjoge1xuICAgICAgICAgIHBhZ2U6IDIsXG4gICAgICAgICAgbGltaXQ6IDEwLFxuICAgICAgICAgIHRvdGFsOiA1MCxcbiAgICAgICAgICB0b3RhbFBhZ2VzOiA1LFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICAgIG1vY2tBZG1pblRoZXJhcGlzdFNlcnZpY2UuZ2V0UGVuZGluZ0FwcGxpY2F0aW9ucy5tb2NrUmVzb2x2ZWRWYWx1ZShwYWdpbmF0ZWRSZXN1bHQpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldFBlbmRpbmdBcHBsaWNhdGlvbnMocGFnaW5hdGVkRmlsdGVycywgVEVTVF9VU0VSX0lEUy5BRE1JTik7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQucGFnaW5hdGlvbi5wYWdlKS50b0JlKDIpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5wYWdpbmF0aW9uLmxpbWl0KS50b0JlKDEwKTtcbiAgICAgIGV4cGVjdChyZXN1bHQucGFnaW5hdGlvbi50b3RhbFBhZ2VzKS50b0JlKDUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc3BlY2lhbGl6YXRpb24gZmlsdGVycycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHNwZWNpYWxpemF0aW9uRmlsdGVycyA9IHsgc3BlY2lhbGl6YXRpb246ICd0cmF1bWEnIH07XG4gICAgICBjb25zdCB0cmF1bWFBcHBsaWNhdGlvbnMgPSBtb2NrQXBwbGljYXRpb25zTGlzdC5maWx0ZXIoYXBwID0+IFxuICAgICAgICBhcHAuc3BlY2lhbGl6YXRpb25zLmluY2x1ZGVzKCd0cmF1bWEnKVxuICAgICAgKTtcbiAgICAgIG1vY2tBZG1pblRoZXJhcGlzdFNlcnZpY2UuZ2V0UGVuZGluZ0FwcGxpY2F0aW9ucy5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGFwcGxpY2F0aW9uczogdHJhdW1hQXBwbGljYXRpb25zLFxuICAgICAgICBwYWdpbmF0aW9uOiB7IHBhZ2U6IDEsIGxpbWl0OiAyMCwgdG90YWw6IHRyYXVtYUFwcGxpY2F0aW9ucy5sZW5ndGgsIHRvdGFsUGFnZXM6IDEgfSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldFBlbmRpbmdBcHBsaWNhdGlvbnMoc3BlY2lhbGl6YXRpb25GaWx0ZXJzLCBURVNUX1VTRVJfSURTLkFETUlOKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5hcHBsaWNhdGlvbnMpLnRvRXF1YWwodHJhdW1hQXBwbGljYXRpb25zKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGVtcHR5IHJlc3VsdHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrQWRtaW5UaGVyYXBpc3RTZXJ2aWNlLmdldFBlbmRpbmdBcHBsaWNhdGlvbnMubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBhcHBsaWNhdGlvbnM6IFtdLFxuICAgICAgICBwYWdpbmF0aW9uOiB7IHBhZ2U6IDEsIGxpbWl0OiAyMCwgdG90YWw6IDAsIHRvdGFsUGFnZXM6IDAgfSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldFBlbmRpbmdBcHBsaWNhdGlvbnMobW9ja0ZpbHRlcnMsIFRFU1RfVVNFUl9JRFMuQURNSU4pO1xuXG4gICAgICBleHBlY3QocmVzdWx0LmFwcGxpY2F0aW9ucykudG9FcXVhbChbXSk7XG4gICAgICBleHBlY3QocmVzdWx0LmFwcGxpY2F0aW9ucykudG9IYXZlTGVuZ3RoKDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2VydmljZSBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBzZXJ2aWNlRXJyb3IgPSBuZXcgRXJyb3IoJ0RhdGFiYXNlIGNvbm5lY3Rpb24gZmFpbGVkJyk7XG4gICAgICBtb2NrQWRtaW5UaGVyYXBpc3RTZXJ2aWNlLmdldFBlbmRpbmdBcHBsaWNhdGlvbnMubW9ja1JlamVjdGVkVmFsdWUoc2VydmljZUVycm9yKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KGNvbnRyb2xsZXIuZ2V0UGVuZGluZ0FwcGxpY2F0aW9ucyhtb2NrRmlsdGVycywgVEVTVF9VU0VSX0lEUy5BRE1JTikpLnJlamVjdHMudG9UaHJvdyhzZXJ2aWNlRXJyb3IpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnR0VUIC9hZG1pbi90aGVyYXBpc3RzL2FwcGxpY2F0aW9ucycsICgpID0+IHtcbiAgICBjb25zdCBtb2NrRmlsdGVycyA9IHsgc3RhdHVzOiAnYWxsJyBhcyBjb25zdCwgcGFnZTogMSwgbGltaXQ6IDIwIH07XG5cbiAgICBpdCgnc2hvdWxkIGdldCBhbGwgYXBwbGljYXRpb25zIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tBZG1pblRoZXJhcGlzdFNlcnZpY2UuZ2V0UGVuZGluZ0FwcGxpY2F0aW9ucy5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGFwcGxpY2F0aW9uczogbW9ja0FwcGxpY2F0aW9uc0xpc3QsXG4gICAgICAgIHBhZ2luYXRpb246IHtcbiAgICAgICAgICBwYWdlOiAxLFxuICAgICAgICAgIGxpbWl0OiAyMCxcbiAgICAgICAgICB0b3RhbDogbW9ja0FwcGxpY2F0aW9uc0xpc3QubGVuZ3RoLFxuICAgICAgICAgIHRvdGFsUGFnZXM6IDEsXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRBbGxBcHBsaWNhdGlvbnMobW9ja0ZpbHRlcnMsIFRFU1RfVVNFUl9JRFMuQURNSU4pO1xuXG4gICAgICBleHBlY3QocmVzdWx0LmFwcGxpY2F0aW9ucykudG9FcXVhbChtb2NrQXBwbGljYXRpb25zTGlzdCk7XG4gICAgICBleHBlY3QoYWRtaW5UaGVyYXBpc3RTZXJ2aWNlLmdldFBlbmRpbmdBcHBsaWNhdGlvbnMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKG1vY2tGaWx0ZXJzKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGRpZmZlcmVudCBzdGF0dXMgZmlsdGVycycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHN0YXR1c0ZpbHRlcnMgPSBbJ3BlbmRpbmcnLCAnYXBwcm92ZWQnLCAncmVqZWN0ZWQnLCAnYWxsJ10gYXMgY29uc3Q7XG4gICAgICBcbiAgICAgIGZvciAoY29uc3Qgc3RhdHVzIG9mIHN0YXR1c0ZpbHRlcnMpIHtcbiAgICAgICAgY29uc3QgZmlsdGVycyA9IHsgc3RhdHVzLCBwYWdlOiAxLCBsaW1pdDogMjAgfTtcbiAgICAgICAgY29uc3QgZmlsdGVyZWRBcHBzID0gc3RhdHVzID09PSAnYWxsJyBcbiAgICAgICAgICA/IG1vY2tBcHBsaWNhdGlvbnNMaXN0IFxuICAgICAgICAgIDogbW9ja0FwcGxpY2F0aW9uc0xpc3QuZmlsdGVyKGFwcCA9PiBhcHAuc3RhdHVzID09PSBzdGF0dXMpO1xuICAgICAgICBcbiAgICAgICAgbW9ja0FkbWluVGhlcmFwaXN0U2VydmljZS5nZXRQZW5kaW5nQXBwbGljYXRpb25zLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICBhcHBsaWNhdGlvbnM6IGZpbHRlcmVkQXBwcyxcbiAgICAgICAgICBwYWdpbmF0aW9uOiB7IHBhZ2U6IDEsIGxpbWl0OiAyMCwgdG90YWw6IGZpbHRlcmVkQXBwcy5sZW5ndGgsIHRvdGFsUGFnZXM6IDEgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRBbGxBcHBsaWNhdGlvbnMoZmlsdGVycywgVEVTVF9VU0VSX0lEUy5BRE1JTik7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdC5hcHBsaWNhdGlvbnMpLnRvRXF1YWwoZmlsdGVyZWRBcHBzKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHNlcnZpY2UgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgc2VydmljZUVycm9yID0gbmV3IEVycm9yKCdTZXJ2aWNlIHRlbXBvcmFyaWx5IHVuYXZhaWxhYmxlJyk7XG4gICAgICBtb2NrQWRtaW5UaGVyYXBpc3RTZXJ2aWNlLmdldFBlbmRpbmdBcHBsaWNhdGlvbnMubW9ja1JlamVjdGVkVmFsdWUoc2VydmljZUVycm9yKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KGNvbnRyb2xsZXIuZ2V0QWxsQXBwbGljYXRpb25zKG1vY2tGaWx0ZXJzLCBURVNUX1VTRVJfSURTLkFETUlOKSkucmVqZWN0cy50b1Rocm93KHNlcnZpY2VFcnJvcik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdHRVQgL2FkbWluL3RoZXJhcGlzdHMvOmlkL2RldGFpbHMnLCAoKSA9PiB7XG4gICAgY29uc3QgdGhlcmFwaXN0SWQgPSAndGhlcmFwaXN0X2FwcGxpY2F0aW9uXzEyMzQ1Njc4OSc7XG5cbiAgICBpdCgnc2hvdWxkIGdldCBhcHBsaWNhdGlvbiBkZXRhaWxzIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tBZG1pblRoZXJhcGlzdFNlcnZpY2UuZ2V0QXBwbGljYXRpb25EZXRhaWxzLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tUaGVyYXBpc3RBcHBsaWNhdGlvbik7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0QXBwbGljYXRpb25EZXRhaWxzKHRoZXJhcGlzdElkLCBURVNUX1VTRVJfSURTLkFETUlOKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2NrVGhlcmFwaXN0QXBwbGljYXRpb24pO1xuICAgICAgZXhwZWN0KGFkbWluVGhlcmFwaXN0U2VydmljZS5nZXRBcHBsaWNhdGlvbkRldGFpbHMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHRoZXJhcGlzdElkKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGFwcGxpY2F0aW9uIG5vdCBmb3VuZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG5vdEZvdW5kRXJyb3IgPSBuZXcgTm90Rm91bmRFeGNlcHRpb24oJ1RoZXJhcGlzdCBhcHBsaWNhdGlvbiBub3QgZm91bmQnKTtcbiAgICAgIG1vY2tBZG1pblRoZXJhcGlzdFNlcnZpY2UuZ2V0QXBwbGljYXRpb25EZXRhaWxzLm1vY2tSZWplY3RlZFZhbHVlKG5vdEZvdW5kRXJyb3IpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIuZ2V0QXBwbGljYXRpb25EZXRhaWxzKCdub24tZXhpc3RlbnQtaWQnLCBURVNUX1VTRVJfSURTLkFETUlOKVxuICAgICAgKS5yZWplY3RzLnRvVGhyb3cobm90Rm91bmRFcnJvcik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBjb21wbGV0ZSBhcHBsaWNhdGlvbiBkZXRhaWxzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZGV0YWlsZWRBcHBsaWNhdGlvbiA9IHtcbiAgICAgICAgLi4ubW9ja1RoZXJhcGlzdEFwcGxpY2F0aW9uLFxuICAgICAgICBhZGRpdGlvbmFsSW5mbzoge1xuICAgICAgICAgIGJhY2tncm91bmRDaGVjazogeyBzdGF0dXM6ICdjb21wbGV0ZWQnLCBkYXRlOiBuZXcgRGF0ZSgpIH0sXG4gICAgICAgICAgcmVmZXJlbmNlczogW1xuICAgICAgICAgICAgeyBuYW1lOiAnRHIuIEphbmUgU21pdGgnLCBjb250YWN0OiAnamFuZUBleGFtcGxlLmNvbScsIHZlcmlmaWVkOiB0cnVlIH0sXG4gICAgICAgICAgICB7IG5hbWU6ICdEci4gQm9iIEpvaG5zb24nLCBjb250YWN0OiAnYm9iQGV4YW1wbGUuY29tJywgdmVyaWZpZWQ6IHRydWUgfSxcbiAgICAgICAgICBdLFxuICAgICAgICAgIGludGVydmlldzogeyBzY2hlZHVsZWQ6IHRydWUsIGRhdGU6IG5ldyBEYXRlKCksIG5vdGVzOiAnUG9zaXRpdmUgaW50ZXJ2aWV3JyB9LFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICAgIG1vY2tBZG1pblRoZXJhcGlzdFNlcnZpY2UuZ2V0QXBwbGljYXRpb25EZXRhaWxzLm1vY2tSZXNvbHZlZFZhbHVlKGRldGFpbGVkQXBwbGljYXRpb24pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldEFwcGxpY2F0aW9uRGV0YWlscyh0aGVyYXBpc3RJZCwgVEVTVF9VU0VSX0lEUy5BRE1JTik7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuYWRkaXRpb25hbEluZm8pLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QocmVzdWx0LmFkZGl0aW9uYWxJbmZvLmJhY2tncm91bmRDaGVjaykudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuYWRkaXRpb25hbEluZm8ucmVmZXJlbmNlcykudG9IYXZlTGVuZ3RoKDIpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2VydmljZSBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBzZXJ2aWNlRXJyb3IgPSBuZXcgRXJyb3IoJ0RhdGFiYXNlIGVycm9yJyk7XG4gICAgICBtb2NrQWRtaW5UaGVyYXBpc3RTZXJ2aWNlLmdldEFwcGxpY2F0aW9uRGV0YWlscy5tb2NrUmVqZWN0ZWRWYWx1ZShzZXJ2aWNlRXJyb3IpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIuZ2V0QXBwbGljYXRpb25EZXRhaWxzKHRoZXJhcGlzdElkLCBURVNUX1VTRVJfSURTLkFETUlOKVxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coc2VydmljZUVycm9yKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1BPU1QgL2FkbWluL3RoZXJhcGlzdHMvOmlkL2FwcHJvdmUnLCAoKSA9PiB7XG4gICAgY29uc3QgdGhlcmFwaXN0SWQgPSAndGhlcmFwaXN0X2FwcGxpY2F0aW9uXzEyMzQ1Njc4OSc7XG4gICAgY29uc3QgYXBwcm92YWxEdG8gPSB7XG4gICAgICBzcGVjaWFsaXphdGlvbnM6IFsnYW54aWV0eScsICdkZXByZXNzaW9uJ10sXG4gICAgICBob3VybHlSYXRlOiAxNTAsXG4gICAgICBtYXhDbGllbnRzOiAyMCxcbiAgICAgIGFkbWluTm90ZXM6ICdFeGNlbGxlbnQgcXVhbGlmaWNhdGlvbnMgYW5kIGV4cGVyaWVuY2UnLFxuICAgICAgb25ib2FyZGluZ1NjaGVkdWxlZDogdHJ1ZSxcbiAgICB9O1xuXG4gICAgaXQoJ3Nob3VsZCBhcHByb3ZlIHRoZXJhcGlzdCBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBhcHByb3ZlZEFwcGxpY2F0aW9uID0ge1xuICAgICAgICAuLi5tb2NrVGhlcmFwaXN0QXBwbGljYXRpb24sXG4gICAgICAgIHN0YXR1czogJ2FwcHJvdmVkJyxcbiAgICAgICAgcmV2aWV3ZWRCeTogVEVTVF9VU0VSX0lEUy5BRE1JTixcbiAgICAgICAgcmV2aWV3ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgYWRtaW5Ob3RlczogYXBwcm92YWxEdG8uYWRtaW5Ob3RlcyxcbiAgICAgIH07XG4gICAgICBtb2NrQWRtaW5UaGVyYXBpc3RTZXJ2aWNlLmFwcHJvdmVUaGVyYXBpc3QubW9ja1Jlc29sdmVkVmFsdWUoYXBwcm92ZWRBcHBsaWNhdGlvbik7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuYXBwcm92ZVRoZXJhcGlzdCh0aGVyYXBpc3RJZCwgYXBwcm92YWxEdG8sIFRFU1RfVVNFUl9JRFMuQURNSU4pO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKGFwcHJvdmVkQXBwbGljYXRpb24pO1xuICAgICAgZXhwZWN0KHJlc3VsdC5zdGF0dXMpLnRvQmUoJ2FwcHJvdmVkJyk7XG4gICAgICBleHBlY3QoYWRtaW5UaGVyYXBpc3RTZXJ2aWNlLmFwcHJvdmVUaGVyYXBpc3QpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICB0aGVyYXBpc3RJZCxcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5BRE1JTixcbiAgICAgICAgYXBwcm92YWxEdG8sXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZGlmZmVyZW50IGFwcHJvdmFsIGNvbmZpZ3VyYXRpb25zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY29uZmlndXJhdGlvbnMgPSBbXG4gICAgICAgIHsgLi4uYXBwcm92YWxEdG8sIG1heENsaWVudHM6IDE1LCBob3VybHlSYXRlOiAxMjAgfSxcbiAgICAgICAgeyAuLi5hcHByb3ZhbER0bywgc3BlY2lhbGl6YXRpb25zOiBbJ3RyYXVtYScsICdQVFNEJ10sIG1heENsaWVudHM6IDI1IH0sXG4gICAgICAgIHsgLi4uYXBwcm92YWxEdG8sIG9uYm9hcmRpbmdTY2hlZHVsZWQ6IGZhbHNlIH0sXG4gICAgICBdO1xuXG4gICAgICBmb3IgKGNvbnN0IGNvbmZpZyBvZiBjb25maWd1cmF0aW9ucykge1xuICAgICAgICBjb25zdCBhcHByb3ZlZEFwcCA9IHtcbiAgICAgICAgICAuLi5tb2NrVGhlcmFwaXN0QXBwbGljYXRpb24sXG4gICAgICAgICAgc3RhdHVzOiAnYXBwcm92ZWQnLFxuICAgICAgICAgIHJldmlld2VkQnk6IFRFU1RfVVNFUl9JRFMuQURNSU4sXG4gICAgICAgICAgcmV2aWV3ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgfTtcbiAgICAgICAgbW9ja0FkbWluVGhlcmFwaXN0U2VydmljZS5hcHByb3ZlVGhlcmFwaXN0Lm1vY2tSZXNvbHZlZFZhbHVlKGFwcHJvdmVkQXBwKTtcblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmFwcHJvdmVUaGVyYXBpc3QodGhlcmFwaXN0SWQsIGNvbmZpZywgVEVTVF9VU0VSX0lEUy5BRE1JTik7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdC5zdGF0dXMpLnRvQmUoJ2FwcHJvdmVkJyk7XG4gICAgICAgIGV4cGVjdChhZG1pblRoZXJhcGlzdFNlcnZpY2UuYXBwcm92ZVRoZXJhcGlzdCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICAgdGhlcmFwaXN0SWQsXG4gICAgICAgICAgVEVTVF9VU0VSX0lEUy5BRE1JTixcbiAgICAgICAgICBjb25maWcsXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBhcHBsaWNhdGlvbiBub3QgZm91bmQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBub3RGb3VuZEVycm9yID0gbmV3IE5vdEZvdW5kRXhjZXB0aW9uKCdUaGVyYXBpc3QgYXBwbGljYXRpb24gbm90IGZvdW5kJyk7XG4gICAgICBtb2NrQWRtaW5UaGVyYXBpc3RTZXJ2aWNlLmFwcHJvdmVUaGVyYXBpc3QubW9ja1JlamVjdGVkVmFsdWUobm90Rm91bmRFcnJvcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5hcHByb3ZlVGhlcmFwaXN0KCdub24tZXhpc3RlbnQtaWQnLCBhcHByb3ZhbER0bywgVEVTVF9VU0VSX0lEUy5BRE1JTilcbiAgICAgICkucmVqZWN0cy50b1Rocm93KG5vdEZvdW5kRXJyb3IpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgYWxyZWFkeSBhcHByb3ZlZCBhcHBsaWNhdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGFscmVhZHlBcHByb3ZlZEVycm9yID0gbmV3IEJhZFJlcXVlc3RFeGNlcHRpb24oJ0FwcGxpY2F0aW9uIGFscmVhZHkgYXBwcm92ZWQnKTtcbiAgICAgIG1vY2tBZG1pblRoZXJhcGlzdFNlcnZpY2UuYXBwcm92ZVRoZXJhcGlzdC5tb2NrUmVqZWN0ZWRWYWx1ZShhbHJlYWR5QXBwcm92ZWRFcnJvcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5hcHByb3ZlVGhlcmFwaXN0KHRoZXJhcGlzdElkLCBhcHByb3ZhbER0bywgVEVTVF9VU0VSX0lEUy5BRE1JTilcbiAgICAgICkucmVqZWN0cy50b1Rocm93KGFscmVhZHlBcHByb3ZlZEVycm9yKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHZhbGlkYXRpb24gZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdmFsaWRhdGlvbkVycm9yID0gbmV3IEJhZFJlcXVlc3RFeGNlcHRpb24oJ0ludmFsaWQgaG91cmx5IHJhdGUnKTtcbiAgICAgIG1vY2tBZG1pblRoZXJhcGlzdFNlcnZpY2UuYXBwcm92ZVRoZXJhcGlzdC5tb2NrUmVqZWN0ZWRWYWx1ZSh2YWxpZGF0aW9uRXJyb3IpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIuYXBwcm92ZVRoZXJhcGlzdCh0aGVyYXBpc3RJZCwgeyAuLi5hcHByb3ZhbER0bywgaG91cmx5UmF0ZTogLTUwIH0sIFRFU1RfVVNFUl9JRFMuQURNSU4pXG4gICAgICApLnJlamVjdHMudG9UaHJvdyh2YWxpZGF0aW9uRXJyb3IpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2VydmljZSBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBzZXJ2aWNlRXJyb3IgPSBuZXcgRXJyb3IoJ0VtYWlsIHNlcnZpY2UgdW5hdmFpbGFibGUnKTtcbiAgICAgIG1vY2tBZG1pblRoZXJhcGlzdFNlcnZpY2UuYXBwcm92ZVRoZXJhcGlzdC5tb2NrUmVqZWN0ZWRWYWx1ZShzZXJ2aWNlRXJyb3IpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIuYXBwcm92ZVRoZXJhcGlzdCh0aGVyYXBpc3RJZCwgYXBwcm92YWxEdG8sIFRFU1RfVVNFUl9JRFMuQURNSU4pXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhzZXJ2aWNlRXJyb3IpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUE9TVCAvYWRtaW4vdGhlcmFwaXN0cy86aWQvcmVqZWN0JywgKCkgPT4ge1xuICAgIGNvbnN0IHRoZXJhcGlzdElkID0gJ3RoZXJhcGlzdF9hcHBsaWNhdGlvbl8xMjM0NTY3ODknO1xuICAgIGNvbnN0IHJlamVjdGlvbkR0byA9IHtcbiAgICAgIHJlYXNvbjogJ0luc3VmZmljaWVudCBleHBlcmllbmNlIGZvciBzcGVjaWFsaXphdGlvbiByZXF1aXJlbWVudHMnLFxuICAgICAgZmVlZGJhY2s6ICdQbGVhc2UgZ2FpbiBtb3JlIGV4cGVyaWVuY2UgYW5kIHJlYXBwbHkgaW4gMiB5ZWFycycsXG4gICAgICBhbGxvd1JlYXBwbGljYXRpb246IHRydWUsXG4gICAgICByZWFwcGxpY2F0aW9uRGF0ZTogbmV3IERhdGUoJzIwMjYtMDEtMDEnKSxcbiAgICB9O1xuXG4gICAgaXQoJ3Nob3VsZCByZWplY3QgdGhlcmFwaXN0IHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlamVjdGVkQXBwbGljYXRpb24gPSB7XG4gICAgICAgIC4uLm1vY2tUaGVyYXBpc3RBcHBsaWNhdGlvbixcbiAgICAgICAgc3RhdHVzOiAncmVqZWN0ZWQnLFxuICAgICAgICByZXZpZXdlZEJ5OiBURVNUX1VTRVJfSURTLkFETUlOLFxuICAgICAgICByZXZpZXdlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgICBhZG1pbk5vdGVzOiByZWplY3Rpb25EdG8ucmVhc29uLFxuICAgICAgfTtcbiAgICAgIG1vY2tBZG1pblRoZXJhcGlzdFNlcnZpY2UucmVqZWN0VGhlcmFwaXN0Lm1vY2tSZXNvbHZlZFZhbHVlKHJlamVjdGVkQXBwbGljYXRpb24pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLnJlamVjdFRoZXJhcGlzdCh0aGVyYXBpc3RJZCwgcmVqZWN0aW9uRHRvLCBURVNUX1VTRVJfSURTLkFETUlOKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChyZWplY3RlZEFwcGxpY2F0aW9uKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuc3RhdHVzKS50b0JlKCdyZWplY3RlZCcpO1xuICAgICAgZXhwZWN0KGFkbWluVGhlcmFwaXN0U2VydmljZS5yZWplY3RUaGVyYXBpc3QpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICB0aGVyYXBpc3RJZCxcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5BRE1JTixcbiAgICAgICAgcmVqZWN0aW9uRHRvLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGRpZmZlcmVudCByZWplY3Rpb24gcmVhc29ucycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlamVjdGlvblJlYXNvbnMgPSBbXG4gICAgICAgICdMaWNlbnNlIHZlcmlmaWNhdGlvbiBmYWlsZWQnLFxuICAgICAgICAnQmFja2dyb3VuZCBjaGVjayBpc3N1ZXMnLFxuICAgICAgICAnSW5zdWZmaWNpZW50IHF1YWxpZmljYXRpb25zJyxcbiAgICAgICAgJ0FwcGxpY2F0aW9uIGluY29tcGxldGUnLFxuICAgICAgICAnRG9lcyBub3QgbWVldCBzdGF0ZSByZXF1aXJlbWVudHMnLFxuICAgICAgXTtcblxuICAgICAgZm9yIChjb25zdCByZWFzb24gb2YgcmVqZWN0aW9uUmVhc29ucykge1xuICAgICAgICBjb25zdCBkdG8gPSB7IC4uLnJlamVjdGlvbkR0bywgcmVhc29uIH07XG4gICAgICAgIGNvbnN0IHJlamVjdGVkQXBwID0ge1xuICAgICAgICAgIC4uLm1vY2tUaGVyYXBpc3RBcHBsaWNhdGlvbixcbiAgICAgICAgICBzdGF0dXM6ICdyZWplY3RlZCcsXG4gICAgICAgICAgcmV2aWV3ZWRCeTogVEVTVF9VU0VSX0lEUy5BRE1JTixcbiAgICAgICAgICByZXZpZXdlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgICAgIGFkbWluTm90ZXM6IHJlYXNvbixcbiAgICAgICAgfTtcbiAgICAgICAgbW9ja0FkbWluVGhlcmFwaXN0U2VydmljZS5yZWplY3RUaGVyYXBpc3QubW9ja1Jlc29sdmVkVmFsdWUocmVqZWN0ZWRBcHApO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIucmVqZWN0VGhlcmFwaXN0KHRoZXJhcGlzdElkLCBkdG8sIFRFU1RfVVNFUl9JRFMuQURNSU4pO1xuXG4gICAgICAgIGV4cGVjdChyZXN1bHQuc3RhdHVzKS50b0JlKCdyZWplY3RlZCcpO1xuICAgICAgICBleHBlY3QocmVzdWx0LmFkbWluTm90ZXMpLnRvQmUocmVhc29uKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHJlamVjdGlvbiB3aXRoIG5vIHJlYXBwbGljYXRpb24gYWxsb3dlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHBlcm1hbmVudFJlamVjdGlvbkR0byA9IHtcbiAgICAgICAgLi4ucmVqZWN0aW9uRHRvLFxuICAgICAgICBhbGxvd1JlYXBwbGljYXRpb246IGZhbHNlLFxuICAgICAgICByZWFwcGxpY2F0aW9uRGF0ZTogbnVsbCxcbiAgICAgIH07XG4gICAgICBjb25zdCByZWplY3RlZEFwcCA9IHtcbiAgICAgICAgLi4ubW9ja1RoZXJhcGlzdEFwcGxpY2F0aW9uLFxuICAgICAgICBzdGF0dXM6ICdyZWplY3RlZCcsXG4gICAgICAgIHJldmlld2VkQnk6IFRFU1RfVVNFUl9JRFMuQURNSU4sXG4gICAgICAgIHJldmlld2VkQXQ6IG5ldyBEYXRlKCksXG4gICAgICB9O1xuICAgICAgbW9ja0FkbWluVGhlcmFwaXN0U2VydmljZS5yZWplY3RUaGVyYXBpc3QubW9ja1Jlc29sdmVkVmFsdWUocmVqZWN0ZWRBcHApO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLnJlamVjdFRoZXJhcGlzdCh0aGVyYXBpc3RJZCwgcGVybWFuZW50UmVqZWN0aW9uRHRvLCBURVNUX1VTRVJfSURTLkFETUlOKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5zdGF0dXMpLnRvQmUoJ3JlamVjdGVkJyk7XG4gICAgICBleHBlY3QoYWRtaW5UaGVyYXBpc3RTZXJ2aWNlLnJlamVjdFRoZXJhcGlzdCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIHRoZXJhcGlzdElkLFxuICAgICAgICBURVNUX1VTRVJfSURTLkFETUlOLFxuICAgICAgICBwZXJtYW5lbnRSZWplY3Rpb25EdG8sXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgYXBwbGljYXRpb24gbm90IGZvdW5kJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgbm90Rm91bmRFcnJvciA9IG5ldyBOb3RGb3VuZEV4Y2VwdGlvbignVGhlcmFwaXN0IGFwcGxpY2F0aW9uIG5vdCBmb3VuZCcpO1xuICAgICAgbW9ja0FkbWluVGhlcmFwaXN0U2VydmljZS5yZWplY3RUaGVyYXBpc3QubW9ja1JlamVjdGVkVmFsdWUobm90Rm91bmRFcnJvcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5yZWplY3RUaGVyYXBpc3QoJ25vbi1leGlzdGVudC1pZCcsIHJlamVjdGlvbkR0bywgVEVTVF9VU0VSX0lEUy5BRE1JTilcbiAgICAgICkucmVqZWN0cy50b1Rocm93KG5vdEZvdW5kRXJyb3IpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgYWxyZWFkeSBwcm9jZXNzZWQgYXBwbGljYXRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBhbHJlYWR5UHJvY2Vzc2VkRXJyb3IgPSBuZXcgQmFkUmVxdWVzdEV4Y2VwdGlvbignQXBwbGljYXRpb24gYWxyZWFkeSBwcm9jZXNzZWQnKTtcbiAgICAgIG1vY2tBZG1pblRoZXJhcGlzdFNlcnZpY2UucmVqZWN0VGhlcmFwaXN0Lm1vY2tSZWplY3RlZFZhbHVlKGFscmVhZHlQcm9jZXNzZWRFcnJvcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5yZWplY3RUaGVyYXBpc3QodGhlcmFwaXN0SWQsIHJlamVjdGlvbkR0bywgVEVTVF9VU0VSX0lEUy5BRE1JTilcbiAgICAgICkucmVqZWN0cy50b1Rocm93KGFscmVhZHlQcm9jZXNzZWRFcnJvcik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdQVVQgL2FkbWluL3RoZXJhcGlzdHMvOmlkL3N0YXR1cycsICgpID0+IHtcbiAgICBjb25zdCB0aGVyYXBpc3RJZCA9ICd0aGVyYXBpc3RfYXBwbGljYXRpb25fMTIzNDU2Nzg5JztcbiAgICBjb25zdCBzdGF0dXNEdG8gPSB7XG4gICAgICBzdGF0dXM6ICdhY3RpdmUnIGFzIGNvbnN0LFxuICAgICAgcmVhc29uOiAnUmVndWxhciBzdGF0dXMgdXBkYXRlJyxcbiAgICAgIGVmZmVjdGl2ZURhdGU6IG5ldyBEYXRlKCksXG4gICAgfTtcblxuICAgIGl0KCdzaG91bGQgdXBkYXRlIHRoZXJhcGlzdCBzdGF0dXMgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdXBkYXRlZFRoZXJhcGlzdCA9IHtcbiAgICAgICAgLi4ubW9ja1RoZXJhcGlzdEFwcGxpY2F0aW9uLFxuICAgICAgICBzdGF0dXM6ICdhY3RpdmUnLFxuICAgICAgICB1cGRhdGVkQnk6IFRFU1RfVVNFUl9JRFMuQURNSU4sXG4gICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgIH07XG4gICAgICBtb2NrQWRtaW5UaGVyYXBpc3RTZXJ2aWNlLnVwZGF0ZVRoZXJhcGlzdFN0YXR1cy5tb2NrUmVzb2x2ZWRWYWx1ZSh1cGRhdGVkVGhlcmFwaXN0KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci51cGRhdGVUaGVyYXBpc3RTdGF0dXModGhlcmFwaXN0SWQsIHN0YXR1c0R0bywgVEVTVF9VU0VSX0lEUy5BRE1JTik7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwodXBkYXRlZFRoZXJhcGlzdCk7XG4gICAgICBleHBlY3QocmVzdWx0LnN0YXR1cykudG9CZSgnYWN0aXZlJyk7XG4gICAgICBleHBlY3QoYWRtaW5UaGVyYXBpc3RTZXJ2aWNlLnVwZGF0ZVRoZXJhcGlzdFN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIHRoZXJhcGlzdElkLFxuICAgICAgICBURVNUX1VTRVJfSURTLkFETUlOLFxuICAgICAgICBzdGF0dXNEdG8sXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgYWxsIHZhbGlkIHN0YXR1cyB0cmFuc2l0aW9ucycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHN0YXR1c2VzID0gWydhY3RpdmUnLCAnaW5hY3RpdmUnLCAnc3VzcGVuZGVkJywgJ3Rlcm1pbmF0ZWQnXSBhcyBjb25zdDtcbiAgICAgIFxuICAgICAgZm9yIChjb25zdCBzdGF0dXMgb2Ygc3RhdHVzZXMpIHtcbiAgICAgICAgY29uc3QgZHRvID0geyAuLi5zdGF0dXNEdG8sIHN0YXR1cyB9O1xuICAgICAgICBjb25zdCB1cGRhdGVkVGhlcmFwaXN0ID0ge1xuICAgICAgICAgIC4uLm1vY2tUaGVyYXBpc3RBcHBsaWNhdGlvbixcbiAgICAgICAgICBzdGF0dXMsXG4gICAgICAgICAgdXBkYXRlZEJ5OiBURVNUX1VTRVJfSURTLkFETUlOLFxuICAgICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgfTtcbiAgICAgICAgbW9ja0FkbWluVGhlcmFwaXN0U2VydmljZS51cGRhdGVUaGVyYXBpc3RTdGF0dXMubW9ja1Jlc29sdmVkVmFsdWUodXBkYXRlZFRoZXJhcGlzdCk7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci51cGRhdGVUaGVyYXBpc3RTdGF0dXModGhlcmFwaXN0SWQsIGR0bywgVEVTVF9VU0VSX0lEUy5BRE1JTik7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdC5zdGF0dXMpLnRvQmUoc3RhdHVzKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHRoZXJhcGlzdCBub3QgZm91bmQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBub3RGb3VuZEVycm9yID0gbmV3IE5vdEZvdW5kRXhjZXB0aW9uKCdUaGVyYXBpc3Qgbm90IGZvdW5kJyk7XG4gICAgICBtb2NrQWRtaW5UaGVyYXBpc3RTZXJ2aWNlLnVwZGF0ZVRoZXJhcGlzdFN0YXR1cy5tb2NrUmVqZWN0ZWRWYWx1ZShub3RGb3VuZEVycm9yKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLnVwZGF0ZVRoZXJhcGlzdFN0YXR1cygnbm9uLWV4aXN0ZW50LWlkJywgc3RhdHVzRHRvLCBURVNUX1VTRVJfSURTLkFETUlOKVxuICAgICAgKS5yZWplY3RzLnRvVGhyb3cobm90Rm91bmRFcnJvcik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBpbnZhbGlkIHN0YXR1cyB0cmFuc2l0aW9ucycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGludmFsaWRUcmFuc2l0aW9uRXJyb3IgPSBuZXcgQmFkUmVxdWVzdEV4Y2VwdGlvbignSW52YWxpZCBzdGF0dXMgdHJhbnNpdGlvbicpO1xuICAgICAgbW9ja0FkbWluVGhlcmFwaXN0U2VydmljZS51cGRhdGVUaGVyYXBpc3RTdGF0dXMubW9ja1JlamVjdGVkVmFsdWUoaW52YWxpZFRyYW5zaXRpb25FcnJvcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci51cGRhdGVUaGVyYXBpc3RTdGF0dXModGhlcmFwaXN0SWQsIHN0YXR1c0R0bywgVEVTVF9VU0VSX0lEUy5BRE1JTilcbiAgICAgICkucmVqZWN0cy50b1Rocm93KGludmFsaWRUcmFuc2l0aW9uRXJyb3IpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2VydmljZSBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBzZXJ2aWNlRXJyb3IgPSBuZXcgRXJyb3IoJ0RhdGFiYXNlIHVwZGF0ZSBmYWlsZWQnKTtcbiAgICAgIG1vY2tBZG1pblRoZXJhcGlzdFNlcnZpY2UudXBkYXRlVGhlcmFwaXN0U3RhdHVzLm1vY2tSZWplY3RlZFZhbHVlKHNlcnZpY2VFcnJvcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci51cGRhdGVUaGVyYXBpc3RTdGF0dXModGhlcmFwaXN0SWQsIHN0YXR1c0R0bywgVEVTVF9VU0VSX0lEUy5BRE1JTilcbiAgICAgICkucmVqZWN0cy50b1Rocm93KHNlcnZpY2VFcnJvcik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdHRVQgL2FkbWluL3RoZXJhcGlzdHMvbWV0cmljcycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGdldCB0aGVyYXBpc3QgYXBwbGljYXRpb24gbWV0cmljcyBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrQWRtaW5UaGVyYXBpc3RTZXJ2aWNlLmdldFRoZXJhcGlzdEFwcGxpY2F0aW9uTWV0cmljcy5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrQXBwbGljYXRpb25NZXRyaWNzKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRUaGVyYXBpc3RBcHBsaWNhdGlvbk1ldHJpY3ModW5kZWZpbmVkLCB1bmRlZmluZWQsIFRFU1RfVVNFUl9JRFMuQURNSU4pO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKG1vY2tBcHBsaWNhdGlvbk1ldHJpY3MpO1xuICAgICAgZXhwZWN0KGFkbWluVGhlcmFwaXN0U2VydmljZS5nZXRUaGVyYXBpc3RBcHBsaWNhdGlvbk1ldHJpY3MpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHVuZGVmaW5lZCwgdW5kZWZpbmVkKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZ2V0IG1ldHJpY3Mgd2l0aCBkYXRlIHJhbmdlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgc3RhcnREYXRlID0gJzIwMjQtMDEtMDEnO1xuICAgICAgY29uc3QgZW5kRGF0ZSA9ICcyMDI0LTAyLTI5JztcbiAgICAgIGNvbnN0IGRhdGVSYW5nZU1ldHJpY3MgPSB7XG4gICAgICAgIC4uLm1vY2tBcHBsaWNhdGlvbk1ldHJpY3MsXG4gICAgICAgIHRvdGFsQXBwbGljYXRpb25zOiAyNyxcbiAgICAgICAgbW9udGhseUFwcGxpY2F0aW9uczogbW9ja0FwcGxpY2F0aW9uTWV0cmljcy5tb250aGx5QXBwbGljYXRpb25zLnNsaWNlKDAsIDIpLFxuICAgICAgfTtcbiAgICAgIG1vY2tBZG1pblRoZXJhcGlzdFNlcnZpY2UuZ2V0VGhlcmFwaXN0QXBwbGljYXRpb25NZXRyaWNzLm1vY2tSZXNvbHZlZFZhbHVlKGRhdGVSYW5nZU1ldHJpY3MpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldFRoZXJhcGlzdEFwcGxpY2F0aW9uTWV0cmljcyhzdGFydERhdGUsIGVuZERhdGUsIFRFU1RfVVNFUl9JRFMuQURNSU4pO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKGRhdGVSYW5nZU1ldHJpY3MpO1xuICAgICAgZXhwZWN0KGFkbWluVGhlcmFwaXN0U2VydmljZS5nZXRUaGVyYXBpc3RBcHBsaWNhdGlvbk1ldHJpY3MpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHN0YXJ0RGF0ZSwgZW5kRGF0ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBlbXB0eSBtZXRyaWNzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZW1wdHlNZXRyaWNzID0ge1xuICAgICAgICB0b3RhbEFwcGxpY2F0aW9uczogMCxcbiAgICAgICAgcGVuZGluZ0FwcGxpY2F0aW9uczogMCxcbiAgICAgICAgYXBwcm92ZWRBcHBsaWNhdGlvbnM6IDAsXG4gICAgICAgIHJlamVjdGVkQXBwbGljYXRpb25zOiAwLFxuICAgICAgICBhdmVyYWdlUHJvY2Vzc2luZ1RpbWU6IDAsXG4gICAgICAgIG1vbnRobHlBcHBsaWNhdGlvbnM6IFtdLFxuICAgICAgICBzcGVjaWFsaXphdGlvbnM6IFtdLFxuICAgICAgICBhdmVyYWdlRXhwZXJpZW5jZTogMCxcbiAgICAgICAgdG9wU3RhdGVzOiBbXSxcbiAgICAgIH07XG4gICAgICBtb2NrQWRtaW5UaGVyYXBpc3RTZXJ2aWNlLmdldFRoZXJhcGlzdEFwcGxpY2F0aW9uTWV0cmljcy5tb2NrUmVzb2x2ZWRWYWx1ZShlbXB0eU1ldHJpY3MpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldFRoZXJhcGlzdEFwcGxpY2F0aW9uTWV0cmljcyh1bmRlZmluZWQsIHVuZGVmaW5lZCwgVEVTVF9VU0VSX0lEUy5BRE1JTik7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoZW1wdHlNZXRyaWNzKTtcbiAgICAgIGV4cGVjdChyZXN1bHQudG90YWxBcHBsaWNhdGlvbnMpLnRvQmUoMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIG1ldHJpY3MgcmVzcG9uc2Ugc3RydWN0dXJlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0FkbWluVGhlcmFwaXN0U2VydmljZS5nZXRUaGVyYXBpc3RBcHBsaWNhdGlvbk1ldHJpY3MubW9ja1Jlc29sdmVkVmFsdWUobW9ja0FwcGxpY2F0aW9uTWV0cmljcyk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0VGhlcmFwaXN0QXBwbGljYXRpb25NZXRyaWNzKHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBURVNUX1VTRVJfSURTLkFETUlOKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ3RvdGFsQXBwbGljYXRpb25zJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgncGVuZGluZ0FwcGxpY2F0aW9ucycpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ2FwcHJvdmVkQXBwbGljYXRpb25zJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgncmVqZWN0ZWRBcHBsaWNhdGlvbnMnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdhdmVyYWdlUHJvY2Vzc2luZ1RpbWUnKTtcbiAgICAgIGV4cGVjdChBcnJheS5pc0FycmF5KHJlc3VsdC5tb250aGx5QXBwbGljYXRpb25zKSkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChBcnJheS5pc0FycmF5KHJlc3VsdC5zcGVjaWFsaXphdGlvbnMpKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KEFycmF5LmlzQXJyYXkocmVzdWx0LnRvcFN0YXRlcykpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzZXJ2aWNlIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHNlcnZpY2VFcnJvciA9IG5ldyBFcnJvcignQW5hbHl0aWNzIHNlcnZpY2UgdW5hdmFpbGFibGUnKTtcbiAgICAgIG1vY2tBZG1pblRoZXJhcGlzdFNlcnZpY2UuZ2V0VGhlcmFwaXN0QXBwbGljYXRpb25NZXRyaWNzLm1vY2tSZWplY3RlZFZhbHVlKHNlcnZpY2VFcnJvcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5nZXRUaGVyYXBpc3RBcHBsaWNhdGlvbk1ldHJpY3ModW5kZWZpbmVkLCB1bmRlZmluZWQsIFRFU1RfVVNFUl9JRFMuQURNSU4pXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhzZXJ2aWNlRXJyb3IpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRXJyb3IgSGFuZGxpbmcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2VydmljZSB1bmF2YWlsYWJsZSBzY2VuYXJpb3MnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBzZXJ2aWNlRXJyb3IgPSBuZXcgRXJyb3IoJ1NlcnZpY2UgdGVtcG9yYXJpbHkgdW5hdmFpbGFibGUnKTtcbiAgICAgIG1vY2tBZG1pblRoZXJhcGlzdFNlcnZpY2UuZ2V0UGVuZGluZ0FwcGxpY2F0aW9ucy5tb2NrUmVqZWN0ZWRWYWx1ZShzZXJ2aWNlRXJyb3IpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoY29udHJvbGxlci5nZXRQZW5kaW5nQXBwbGljYXRpb25zKHt9LCBURVNUX1VTRVJfSURTLkFETUlOKSkucmVqZWN0cy50b1Rocm93KHNlcnZpY2VFcnJvcik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBkYXRhYmFzZSBjb25uZWN0aW9uIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGRiRXJyb3IgPSBuZXcgRXJyb3IoJ0RhdGFiYXNlIGNvbm5lY3Rpb24gZmFpbGVkJyk7XG4gICAgICBtb2NrQWRtaW5UaGVyYXBpc3RTZXJ2aWNlLmdldEFwcGxpY2F0aW9uRGV0YWlscy5tb2NrUmVqZWN0ZWRWYWx1ZShkYkVycm9yKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLmdldEFwcGxpY2F0aW9uRGV0YWlscygndGhlcmFwaXN0XzEyMycsIFRFU1RfVVNFUl9JRFMuQURNSU4pXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhkYkVycm9yKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHZhbGlkYXRpb24gZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdmFsaWRhdGlvbkVycm9yID0gbmV3IEJhZFJlcXVlc3RFeGNlcHRpb24oJ0ludmFsaWQgYXBwbGljYXRpb24gZGF0YScpO1xuICAgICAgbW9ja0FkbWluVGhlcmFwaXN0U2VydmljZS5hcHByb3ZlVGhlcmFwaXN0Lm1vY2tSZWplY3RlZFZhbHVlKHZhbGlkYXRpb25FcnJvcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5hcHByb3ZlVGhlcmFwaXN0KCd0aGVyYXBpc3RfMTIzJywge30gYXMgYW55LCBURVNUX1VTRVJfSURTLkFETUlOKVxuICAgICAgKS5yZWplY3RzLnRvVGhyb3codmFsaWRhdGlvbkVycm9yKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1Jlc3BvbnNlIEZvcm1hdCBWYWxpZGF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIHByb3Blcmx5IGZvcm1hdHRlZCBhcHBsaWNhdGlvbiBsaXN0IHJlc3BvbnNlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0FkbWluVGhlcmFwaXN0U2VydmljZS5nZXRQZW5kaW5nQXBwbGljYXRpb25zLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgYXBwbGljYXRpb25zOiBtb2NrQXBwbGljYXRpb25zTGlzdCxcbiAgICAgICAgcGFnaW5hdGlvbjogeyBwYWdlOiAxLCBsaW1pdDogMjAsIHRvdGFsOiAyLCB0b3RhbFBhZ2VzOiAxIH0sXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRQZW5kaW5nQXBwbGljYXRpb25zKHt9LCBURVNUX1VTRVJfSURTLkFETUlOKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ2FwcGxpY2F0aW9ucycpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ3BhZ2luYXRpb24nKTtcbiAgICAgIGV4cGVjdChBcnJheS5pc0FycmF5KHJlc3VsdC5hcHBsaWNhdGlvbnMpKS50b0JlKHRydWUpO1xuICAgICAgcmVzdWx0LmFwcGxpY2F0aW9ucy5mb3JFYWNoKChhcHApID0+IHtcbiAgICAgICAgVGVzdEFzc2VydGlvbnMuZXhwZWN0VmFsaWRFbnRpdHkoYXBwLCBbJ2lkJywgJ2VtYWlsJywgJ2ZpcnN0TmFtZScsICdsYXN0TmFtZScsICdzdGF0dXMnXSk7XG4gICAgICAgIGV4cGVjdChbJ3BlbmRpbmcnLCAnYXBwcm92ZWQnLCAncmVqZWN0ZWQnXSkudG9Db250YWluKGFwcC5zdGF0dXMpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBwcm9wZXJseSBmb3JtYXR0ZWQgYXBwbGljYXRpb24gZGV0YWlscyByZXNwb25zZScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tBZG1pblRoZXJhcGlzdFNlcnZpY2UuZ2V0QXBwbGljYXRpb25EZXRhaWxzLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tUaGVyYXBpc3RBcHBsaWNhdGlvbik7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0QXBwbGljYXRpb25EZXRhaWxzKCd0aGVyYXBpc3RfMTIzJywgVEVTVF9VU0VSX0lEUy5BRE1JTik7XG5cbiAgICAgIFRlc3RBc3NlcnRpb25zLmV4cGVjdFZhbGlkRW50aXR5KHJlc3VsdCwgWydpZCcsICdlbWFpbCcsICdmaXJzdE5hbWUnLCAnbGFzdE5hbWUnLCAnc3RhdHVzJ10pO1xuICAgICAgZXhwZWN0KEFycmF5LmlzQXJyYXkocmVzdWx0LnNwZWNpYWxpemF0aW9ucykpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QoQXJyYXkuaXNBcnJheShyZXN1bHQuZG9jdW1lbnRzKSkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdCh0eXBlb2YgcmVzdWx0LnllYXJzT2ZFeHBlcmllbmNlKS50b0JlKCdudW1iZXInKTtcbiAgICAgIGV4cGVjdCh0eXBlb2YgcmVzdWx0LmhvdXJseVJhdGUpLnRvQmUoJ251bWJlcicpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gcHJvcGVybHkgZm9ybWF0dGVkIG1ldHJpY3MgcmVzcG9uc2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrQWRtaW5UaGVyYXBpc3RTZXJ2aWNlLmdldFRoZXJhcGlzdEFwcGxpY2F0aW9uTWV0cmljcy5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrQXBwbGljYXRpb25NZXRyaWNzKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRUaGVyYXBpc3RBcHBsaWNhdGlvbk1ldHJpY3ModW5kZWZpbmVkLCB1bmRlZmluZWQsIFRFU1RfVVNFUl9JRFMuQURNSU4pO1xuXG4gICAgICBleHBlY3QodHlwZW9mIHJlc3VsdC50b3RhbEFwcGxpY2F0aW9ucykudG9CZSgnbnVtYmVyJyk7XG4gICAgICBleHBlY3QodHlwZW9mIHJlc3VsdC5hdmVyYWdlUHJvY2Vzc2luZ1RpbWUpLnRvQmUoJ251bWJlcicpO1xuICAgICAgZXhwZWN0KHR5cGVvZiByZXN1bHQuYXZlcmFnZUV4cGVyaWVuY2UpLnRvQmUoJ251bWJlcicpO1xuICAgICAgZXhwZWN0KEFycmF5LmlzQXJyYXkocmVzdWx0Lm1vbnRobHlBcHBsaWNhdGlvbnMpKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KEFycmF5LmlzQXJyYXkocmVzdWx0LnNwZWNpYWxpemF0aW9ucykpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QoQXJyYXkuaXNBcnJheShyZXN1bHQudG9wU3RhdGVzKSkudG9CZSh0cnVlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0ludGVncmF0aW9uIFRlc3RzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbXBsZXRlIGFwcGxpY2F0aW9uIGFwcHJvdmFsIHdvcmtmbG93JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gR2V0IGFwcGxpY2F0aW9uIGRldGFpbHNcbiAgICAgIG1vY2tBZG1pblRoZXJhcGlzdFNlcnZpY2UuZ2V0QXBwbGljYXRpb25EZXRhaWxzLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tUaGVyYXBpc3RBcHBsaWNhdGlvbik7XG4gICAgICBjb25zdCBkZXRhaWxzID0gYXdhaXQgY29udHJvbGxlci5nZXRBcHBsaWNhdGlvbkRldGFpbHMoJ3RoZXJhcGlzdF8xMjMnLCBURVNUX1VTRVJfSURTLkFETUlOKTtcbiAgICAgIGV4cGVjdChkZXRhaWxzKS50b0JlRGVmaW5lZCgpO1xuXG4gICAgICAvLyBBcHByb3ZlIGFwcGxpY2F0aW9uXG4gICAgICBjb25zdCBhcHByb3ZhbER0byA9IHtcbiAgICAgICAgc3BlY2lhbGl6YXRpb25zOiBbJ2FueGlldHknLCAnZGVwcmVzc2lvbiddLFxuICAgICAgICBob3VybHlSYXRlOiAxNTAsXG4gICAgICAgIG1heENsaWVudHM6IDIwLFxuICAgICAgICBhZG1pbk5vdGVzOiAnQXBwcm92ZWQnLFxuICAgICAgICBvbmJvYXJkaW5nU2NoZWR1bGVkOiB0cnVlLFxuICAgICAgfTtcbiAgICAgIGNvbnN0IGFwcHJvdmVkQXBwID0geyAuLi5tb2NrVGhlcmFwaXN0QXBwbGljYXRpb24sIHN0YXR1czogJ2FwcHJvdmVkJyB9O1xuICAgICAgbW9ja0FkbWluVGhlcmFwaXN0U2VydmljZS5hcHByb3ZlVGhlcmFwaXN0Lm1vY2tSZXNvbHZlZFZhbHVlKGFwcHJvdmVkQXBwKTtcbiAgICAgIGNvbnN0IGFwcHJvdmFsID0gYXdhaXQgY29udHJvbGxlci5hcHByb3ZlVGhlcmFwaXN0KCd0aGVyYXBpc3RfMTIzJywgYXBwcm92YWxEdG8sIFRFU1RfVVNFUl9JRFMuQURNSU4pO1xuICAgICAgZXhwZWN0KGFwcHJvdmFsLnN0YXR1cykudG9CZSgnYXBwcm92ZWQnKTtcblxuICAgICAgLy8gVXBkYXRlIHN0YXR1cyB0byBhY3RpdmVcbiAgICAgIGNvbnN0IHN0YXR1c0R0byA9IHsgc3RhdHVzOiAnYWN0aXZlJyBhcyBjb25zdCwgcmVhc29uOiAnT25ib2FyZGluZyBjb21wbGV0ZWQnIH07XG4gICAgICBjb25zdCBhY3RpdmVUaGVyYXBpc3QgPSB7IC4uLmFwcHJvdmVkQXBwLCBzdGF0dXM6ICdhY3RpdmUnIH07XG4gICAgICBtb2NrQWRtaW5UaGVyYXBpc3RTZXJ2aWNlLnVwZGF0ZVRoZXJhcGlzdFN0YXR1cy5tb2NrUmVzb2x2ZWRWYWx1ZShhY3RpdmVUaGVyYXBpc3QpO1xuICAgICAgY29uc3Qgc3RhdHVzVXBkYXRlID0gYXdhaXQgY29udHJvbGxlci51cGRhdGVUaGVyYXBpc3RTdGF0dXMoJ3RoZXJhcGlzdF8xMjMnLCBzdGF0dXNEdG8sIFRFU1RfVVNFUl9JRFMuQURNSU4pO1xuICAgICAgZXhwZWN0KHN0YXR1c1VwZGF0ZS5zdGF0dXMpLnRvQmUoJ2FjdGl2ZScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgY29tcGxldGUgYXBwbGljYXRpb24gcmVqZWN0aW9uIHdvcmtmbG93JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gR2V0IGFwcGxpY2F0aW9uIGRldGFpbHNcbiAgICAgIG1vY2tBZG1pblRoZXJhcGlzdFNlcnZpY2UuZ2V0QXBwbGljYXRpb25EZXRhaWxzLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tUaGVyYXBpc3RBcHBsaWNhdGlvbik7XG4gICAgICBjb25zdCBkZXRhaWxzID0gYXdhaXQgY29udHJvbGxlci5nZXRBcHBsaWNhdGlvbkRldGFpbHMoJ3RoZXJhcGlzdF8xMjMnLCBURVNUX1VTRVJfSURTLkFETUlOKTtcbiAgICAgIGV4cGVjdChkZXRhaWxzKS50b0JlRGVmaW5lZCgpO1xuXG4gICAgICAvLyBSZWplY3QgYXBwbGljYXRpb25cbiAgICAgIGNvbnN0IHJlamVjdGlvbkR0byA9IHtcbiAgICAgICAgcmVhc29uOiAnSW5zdWZmaWNpZW50IGV4cGVyaWVuY2UnLFxuICAgICAgICBmZWVkYmFjazogJ1BsZWFzZSBnYWluIG1vcmUgZXhwZXJpZW5jZScsXG4gICAgICAgIGFsbG93UmVhcHBsaWNhdGlvbjogdHJ1ZSxcbiAgICAgICAgcmVhcHBsaWNhdGlvbkRhdGU6IG5ldyBEYXRlKCcyMDI2LTAxLTAxJyksXG4gICAgICB9O1xuICAgICAgY29uc3QgcmVqZWN0ZWRBcHAgPSB7IC4uLm1vY2tUaGVyYXBpc3RBcHBsaWNhdGlvbiwgc3RhdHVzOiAncmVqZWN0ZWQnIH07XG4gICAgICBtb2NrQWRtaW5UaGVyYXBpc3RTZXJ2aWNlLnJlamVjdFRoZXJhcGlzdC5tb2NrUmVzb2x2ZWRWYWx1ZShyZWplY3RlZEFwcCk7XG4gICAgICBjb25zdCByZWplY3Rpb24gPSBhd2FpdCBjb250cm9sbGVyLnJlamVjdFRoZXJhcGlzdCgndGhlcmFwaXN0XzEyMycsIHJlamVjdGlvbkR0bywgVEVTVF9VU0VSX0lEUy5BRE1JTik7XG4gICAgICBleHBlY3QocmVqZWN0aW9uLnN0YXR1cykudG9CZSgncmVqZWN0ZWQnKTtcbiAgICB9KTtcbiAgfSk7XG59KTsiXSwidmVyc2lvbiI6M30=