{"version":3,"names":["common_1","cov_27a2hv5e5h","s","require","swagger_1","stripe_service_1","prisma_client_provider_1","event_emitter_1","StripeWebhookController","StripeWebhookController_1","stripeService","prisma","eventEmitter","logger","Logger","name","constructor","f","handleWebhook","request","body","signature","startTime","Date","now","b","error","BadRequestException","rawBody","event","constructWebhookEvent","log","type","id","existingEvent","checkEventIdempotency","received","eventId","eventType","message","recordWebhookEvent","handleWebhookEvent","markEventProcessed","processingTime","emit","success","Error","String","stack","undefined","substring","bodyType","rawBodyLength","length","parseError","dbError","InternalServerErrorException","testWebhook","timestamp","toISOString","stripeWebhookEvent","findUnique","where","create","data","eventData","livemode","apiVersion","api_version","created","processed","errorMessage","update","processedAt","getWebhookStats","oneDayAgo","getTime","oneWeekAgo","totalEvents","processedEvents","failedEvents","recentEvents","eventsByType","Promise","all","count","gte","groupBy","by","_count","successRate","Math","round","map","getRecentEvents","events","findMany","select","orderBy","take","retryFailedEvent","params","webhookEvent","stripeEvent","floor","exports","__decorate","Post","HttpCode","HttpStatus","OK","ApiExcludeEndpoint","ApiOperation","summary","description","ApiResponse","status","schema","properties","__param","Req","Body","Headers","RawBodyRequest","_d","Object","ApiTags","ApiBearerAuth","Controller","StripeService","_a","_b","PrismaService","_c","EventEmitter2"],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/billing/controllers/stripe-webhook.controller.ts"],"sourcesContent":["import {\n  Controller,\n  Post,\n  Body,\n  Headers,\n  HttpCode,\n  HttpStatus,\n  Logger,\n  RawBodyRequest,\n  Req,\n  BadRequestException,\n  InternalServerErrorException,\n} from '@nestjs/common';\nimport {\n  ApiTags,\n  ApiOperation,\n  ApiResponse,\n  ApiExcludeEndpoint,\n  ApiBearerAuth,\n} from '@nestjs/swagger';\nimport { Request } from 'express';\nimport { StripeService } from '../services/stripe.service';\nimport { PrismaService } from '../../providers/prisma-client.provider';\nimport { EventEmitter2 } from '@nestjs/event-emitter';\n\n@ApiTags('Stripe Webhooks')\n@ApiTags('stripe-webhook')\n@ApiBearerAuth('JWT-auth')\n@Controller('billing/stripe/webhooks')\nexport class StripeWebhookController {\n  private readonly logger = new Logger(StripeWebhookController.name);\n\n  constructor(\n    private readonly stripeService: StripeService,\n    private readonly prisma: PrismaService,\n    private readonly eventEmitter: EventEmitter2,\n  ) {}\n\n  @Post()\n  @HttpCode(HttpStatus.OK)\n  @ApiExcludeEndpoint() // Hide from public API docs for security\n  @ApiOperation({\n    summary: 'Handle Stripe webhook events',\n    description: 'Receives and processes webhook events from Stripe',\n  })\n  @ApiResponse({\n    status: 200,\n    description: 'Webhook processed successfully',\n    schema: {\n      type: 'object',\n      properties: {\n        received: { type: 'boolean' },\n        eventId: { type: 'string' },\n        eventType: { type: 'string' },\n      },\n    },\n  })\n  @ApiResponse({\n    status: 400,\n    description: 'Invalid webhook signature or payload',\n  })\n  @ApiResponse({\n    status: 500,\n    description: 'Error processing webhook',\n  })\n  async handleWebhook(\n    @Req() request: RawBodyRequest<Request>,\n    @Body() body: any,\n    @Headers('stripe-signature') signature: string,\n  ) {\n    const startTime = Date.now();\n\n    try {\n      // Validate required headers\n      if (!signature) {\n        this.logger.error('Missing Stripe signature header');\n        throw new BadRequestException('Missing Stripe signature header');\n      }\n\n      // Get raw body for signature validation\n      const rawBody = request.rawBody;\n      if (!rawBody) {\n        this.logger.error('Missing raw body for webhook validation');\n        throw new BadRequestException(\n          'Missing raw body for webhook validation',\n        );\n      }\n\n      // Construct and validate webhook event\n      const event = this.stripeService.constructWebhookEvent(\n        rawBody,\n        signature,\n      );\n\n      this.logger.log(`Received Stripe webhook: ${event.type} (${event.id})`);\n\n      // Check if we've already processed this event (idempotency)\n      const existingEvent = await this.checkEventIdempotency(event.id);\n      if (existingEvent) {\n        this.logger.log(`Event ${event.id} already processed, skipping`);\n        return {\n          received: true,\n          eventId: event.id,\n          eventType: event.type,\n          message: 'Event already processed',\n        };\n      }\n\n      // Record the event as being processed\n      await this.recordWebhookEvent(event);\n\n      // Process the event\n      await this.stripeService.handleWebhookEvent(event);\n\n      // Mark event as successfully processed\n      await this.markEventProcessed(event.id, true);\n\n      // Log performance metrics\n      const processingTime = Date.now() - startTime;\n      this.logger.log(\n        `Webhook ${event.type} processed successfully in ${processingTime}ms`,\n      );\n\n      // Emit event for monitoring/analytics\n      this.eventEmitter.emit('stripe.webhook.processed', {\n        eventId: event.id,\n        eventType: event.type,\n        processingTime,\n        success: true,\n      });\n\n      return {\n        received: true,\n        eventId: event.id,\n        eventType: event.type,\n        processingTime,\n      };\n    } catch (error) {\n      const processingTime = Date.now() - startTime;\n\n      // Log the error with context\n      this.logger.error(`Webhook processing failed in ${processingTime}ms:`, {\n        error: error instanceof Error ? error.message : String(error),\n        stack: error instanceof Error ? error.stack : undefined,\n        signature: signature?.substring(0, 20) + '...',\n        bodyType: typeof body,\n        rawBodyLength: request.rawBody?.length,\n      });\n\n      // Try to extract event info for logging even if processing failed\n      let eventId = 'unknown';\n      let eventType = 'unknown';\n\n      try {\n        if (body && typeof body === 'object') {\n          eventId = body.id || 'unknown';\n          eventType = body.type || 'unknown';\n        }\n      } catch (parseError) {\n        // Ignore parsing errors for logging\n      }\n\n      // Mark event as failed if we have an event ID\n      if (eventId !== 'unknown') {\n        try {\n          await this.markEventProcessed(\n            eventId,\n            false,\n            error instanceof Error ? error.message : String(error),\n          );\n        } catch (dbError) {\n          this.logger.error(\n            'Failed to mark event as failed in database:',\n            dbError,\n          );\n        }\n      }\n\n      // Emit error event for monitoring\n      this.eventEmitter.emit('stripe.webhook.error', {\n        eventId,\n        eventType,\n        processingTime,\n        error: error instanceof Error ? error.message : String(error),\n        success: false,\n      });\n\n      // Return appropriate error response\n      if (error instanceof BadRequestException) {\n        throw error;\n      }\n\n      throw new InternalServerErrorException('Failed to process webhook');\n    }\n  }\n\n  @Post('test')\n  @HttpCode(HttpStatus.OK)\n  @ApiOperation({\n    summary: 'Test webhook endpoint',\n    description: 'Test endpoint for webhook connectivity (development only)',\n  })\n  @ApiResponse({\n    status: 200,\n    description: 'Test webhook received successfully',\n  })\n  async testWebhook(@Body() body: any) {\n    try {\n      this.logger.log('Test webhook received:', body);\n\n      return {\n        received: true,\n        timestamp: new Date().toISOString(),\n        message: 'Test webhook processed successfully',\n        body: body,\n      };\n    } catch (error) {\n      this.logger.error('Test webhook processing failed:', error);\n      throw new InternalServerErrorException('Failed to process test webhook');\n    }\n  }\n\n  /**\n   * Check if event has already been processed (idempotency)\n   */\n  private async checkEventIdempotency(eventId: string): Promise<boolean> {\n    try {\n      const existingEvent = await this.prisma.stripeWebhookEvent.findUnique({\n        where: { eventId },\n      });\n\n      return !!existingEvent;\n    } catch (error) {\n      this.logger.error(\n        `Error checking event idempotency for ${eventId}:`,\n        error,\n      );\n      return false; // Allow processing if we can't check\n    }\n  }\n\n  /**\n   * Record webhook event in database\n   */\n  private async recordWebhookEvent(event: any): Promise<void> {\n    try {\n      await this.prisma.stripeWebhookEvent.create({\n        data: {\n          eventId: event.id,\n          eventType: event.type,\n          eventData: event.data,\n          livemode: event.livemode,\n          apiVersion: event.api_version,\n          created: new Date(event.created * 1000),\n          processed: false,\n        },\n      });\n    } catch (error) {\n      this.logger.error(`Error recording webhook event ${event.id}:`, error);\n      // Don't throw here - we still want to process the event\n    }\n  }\n\n  /**\n   * Mark event as processed\n   */\n  private async markEventProcessed(\n    eventId: string,\n    success: boolean,\n    errorMessage?: string,\n  ): Promise<void> {\n    try {\n      await this.prisma.stripeWebhookEvent.update({\n        where: { eventId },\n        data: {\n          processed: true,\n          processedAt: new Date(),\n          success,\n          errorMessage: errorMessage || null,\n        },\n      });\n    } catch (error) {\n      this.logger.error(`Error marking event ${eventId} as processed:`, error);\n      // Don't throw here - event processing was the important part\n    }\n  }\n\n  /**\n   * Get webhook processing statistics\n   */\n  @Post('stats')\n  @HttpCode(HttpStatus.OK)\n  @ApiOperation({\n    summary: 'Get webhook processing statistics',\n    description: 'Returns statistics about webhook processing (admin only)',\n  })\n  @ApiResponse({\n    status: 200,\n    description: 'Webhook statistics retrieved successfully',\n  })\n  async getWebhookStats() {\n    try {\n      const now = new Date();\n      const oneDayAgo = new Date(now.getTime() - 24 * 60 * 60 * 1000);\n      const oneWeekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);\n\n      const [\n        totalEvents,\n        processedEvents,\n        failedEvents,\n        recentEvents,\n        eventsByType,\n      ] = await Promise.all([\n        this.prisma.stripeWebhookEvent.count(),\n        this.prisma.stripeWebhookEvent.count({\n          where: { processed: true, success: true },\n        }),\n        this.prisma.stripeWebhookEvent.count({\n          where: { processed: true, success: false },\n        }),\n        this.prisma.stripeWebhookEvent.count({\n          where: { created: { gte: oneDayAgo } },\n        }),\n        this.prisma.stripeWebhookEvent.groupBy({\n          by: ['eventType'],\n          where: { created: { gte: oneWeekAgo } },\n          _count: { eventType: true },\n        }),\n      ]);\n\n      const successRate =\n        totalEvents > 0 ? (processedEvents / totalEvents) * 100 : 0;\n\n      return {\n        totalEvents,\n        processedEvents,\n        failedEvents,\n        recentEvents,\n        successRate: Math.round(successRate * 100) / 100,\n        eventsByType: eventsByType.map((event) => ({\n          eventType: event.eventType,\n          count: event._count.eventType,\n        })),\n      };\n    } catch (error) {\n      this.logger.error('Error getting webhook statistics:', error);\n      throw new InternalServerErrorException(\n        'Failed to get webhook statistics',\n      );\n    }\n  }\n\n  /**\n   * Get recent webhook events\n   */\n  @Post('recent')\n  @HttpCode(HttpStatus.OK)\n  @ApiOperation({\n    summary: 'Get recent webhook events',\n    description: 'Returns recent webhook events for debugging (admin only)',\n  })\n  @ApiResponse({\n    status: 200,\n    description: 'Recent webhook events retrieved successfully',\n  })\n  async getRecentEvents() {\n    try {\n      const events = await this.prisma.stripeWebhookEvent.findMany({\n        select: {\n          eventId: true,\n          eventType: true,\n          created: true,\n          processed: true,\n          processedAt: true,\n          success: true,\n          errorMessage: true,\n        },\n        orderBy: { created: 'desc' },\n        take: 50,\n      });\n\n      return {\n        events,\n        count: events.length,\n      };\n    } catch (error) {\n      this.logger.error('Error getting recent webhook events:', error);\n      throw new InternalServerErrorException(\n        'Failed to get recent webhook events',\n      );\n    }\n  }\n\n  /**\n   * Retry failed webhook event\n   */\n  @Post('retry/:eventId')\n  @HttpCode(HttpStatus.OK)\n  @ApiOperation({\n    summary: 'Retry failed webhook event',\n    description:\n      'Manually retry processing a failed webhook event (admin only)',\n  })\n  @ApiResponse({\n    status: 200,\n    description: 'Webhook event retried successfully',\n  })\n  async retryFailedEvent(@Req() request: any) {\n    try {\n      const eventId = request.params.eventId;\n\n      // Get the failed event\n      const webhookEvent = await this.prisma.stripeWebhookEvent.findUnique({\n        where: { eventId },\n      });\n\n      if (!webhookEvent) {\n        throw new BadRequestException(`Webhook event ${eventId} not found`);\n      }\n\n      if (webhookEvent.success) {\n        throw new BadRequestException(\n          `Webhook event ${eventId} already processed successfully`,\n        );\n      }\n\n      // Reconstruct the Stripe event and retry processing\n      const stripeEvent = {\n        id: webhookEvent.eventId,\n        type: webhookEvent.eventType,\n        data: webhookEvent.eventData,\n        created: Math.floor(webhookEvent.created.getTime() / 1000),\n        livemode: webhookEvent.livemode,\n        api_version: webhookEvent.apiVersion,\n      };\n\n      // Process the event\n      await this.stripeService.handleWebhookEvent(stripeEvent as any);\n\n      // Mark as successfully processed\n      await this.markEventProcessed(eventId, true);\n\n      this.logger.log(`Successfully retried webhook event ${eventId}`);\n\n      return {\n        success: true,\n        eventId,\n        message: 'Webhook event retried successfully',\n      };\n    } catch (error) {\n      this.logger.error('Error retrying webhook event:', error);\n      throw new InternalServerErrorException('Failed to retry webhook event');\n    }\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,MAAAA,QAAA;AAAA;AAAA,CAAAC,cAAA,GAAAC,CAAA,QAAAC,OAAA;AAaA,MAAAC,SAAA;AAAA;AAAA,CAAAH,cAAA,GAAAC,CAAA,QAAAC,OAAA;AAQA,MAAAE,gBAAA;AAAA;AAAA,CAAAJ,cAAA,GAAAC,CAAA,QAAAC,OAAA;AACA,MAAAG,wBAAA;AAAA;AAAA,CAAAL,cAAA,GAAAC,CAAA,QAAAC,OAAA;AACA,MAAAI,eAAA;AAAA;AAAA,CAAAN,cAAA,GAAAC,CAAA,QAAAC,OAAA;AAMO,IAAMK,uBAAuB;AAAA;AAAA,CAAAP,cAAA,GAAAC,CAAA,QAAAO,yBAAA,GAA7B,MAAMD,uBAAuB;EAIfE,aAAA;EACAC,MAAA;EACAC,YAAA;EALFC,MAAM;EAAA;EAAA,CAAAZ,cAAA,GAAAC,CAAA,QAAG,IAAIF,QAAA,CAAAc,MAAM,CAACL,yBAAuB,CAACM,IAAI,CAAC;EAElEC,YACmBN,aAA4B,EAC5BC,MAAqB,EACrBC,YAA2B;IAAA;IAAAX,cAAA,GAAAgB,CAAA;IAAAhB,cAAA,GAAAC,CAAA;IAF3B,KAAAQ,aAAa,GAAbA,aAAa;IAAe;IAAAT,cAAA,GAAAC,CAAA;IAC5B,KAAAS,MAAM,GAANA,MAAM;IAAe;IAAAV,cAAA,GAAAC,CAAA;IACrB,KAAAU,YAAY,GAAZA,YAAY;EAC5B;EA6BG,MAAAM,aAAaA,CACVC,OAAgC,EAC/BC,IAAS,EACYC,SAAiB;IAAA;IAAApB,cAAA,GAAAgB,CAAA;IAE9C,MAAMK,SAAS;IAAA;IAAA,CAAArB,cAAA,GAAAC,CAAA,QAAGqB,IAAI,CAACC,GAAG,EAAE;IAAC;IAAAvB,cAAA,GAAAC,CAAA;IAE7B,IAAI;MAAA;MAAAD,cAAA,GAAAC,CAAA;MACF;MACA,IAAI,CAACmB,SAAS,EAAE;QAAA;QAAApB,cAAA,GAAAwB,CAAA;QAAAxB,cAAA,GAAAC,CAAA;QACd,IAAI,CAACW,MAAM,CAACa,KAAK,CAAC,iCAAiC,CAAC;QAAC;QAAAzB,cAAA,GAAAC,CAAA;QACrD,MAAM,IAAIF,QAAA,CAAA2B,mBAAmB,CAAC,iCAAiC,CAAC;MAClE,CAAC;MAAA;MAAA;QAAA1B,cAAA,GAAAwB,CAAA;MAAA;MAED;MACA,MAAMG,OAAO;MAAA;MAAA,CAAA3B,cAAA,GAAAC,CAAA,QAAGiB,OAAO,CAACS,OAAO;MAAC;MAAA3B,cAAA,GAAAC,CAAA;MAChC,IAAI,CAAC0B,OAAO,EAAE;QAAA;QAAA3B,cAAA,GAAAwB,CAAA;QAAAxB,cAAA,GAAAC,CAAA;QACZ,IAAI,CAACW,MAAM,CAACa,KAAK,CAAC,yCAAyC,CAAC;QAAC;QAAAzB,cAAA,GAAAC,CAAA;QAC7D,MAAM,IAAIF,QAAA,CAAA2B,mBAAmB,CAC3B,yCAAyC,CAC1C;MACH,CAAC;MAAA;MAAA;QAAA1B,cAAA,GAAAwB,CAAA;MAAA;MAED;MACA,MAAMI,KAAK;MAAA;MAAA,CAAA5B,cAAA,GAAAC,CAAA,QAAG,IAAI,CAACQ,aAAa,CAACoB,qBAAqB,CACpDF,OAAO,EACPP,SAAS,CACV;MAAC;MAAApB,cAAA,GAAAC,CAAA;MAEF,IAAI,CAACW,MAAM,CAACkB,GAAG,CAAC,4BAA4BF,KAAK,CAACG,IAAI,KAAKH,KAAK,CAACI,EAAE,GAAG,CAAC;MAEvE;MACA,MAAMC,aAAa;MAAA;MAAA,CAAAjC,cAAA,GAAAC,CAAA,QAAG,MAAM,IAAI,CAACiC,qBAAqB,CAACN,KAAK,CAACI,EAAE,CAAC;MAAC;MAAAhC,cAAA,GAAAC,CAAA;MACjE,IAAIgC,aAAa,EAAE;QAAA;QAAAjC,cAAA,GAAAwB,CAAA;QAAAxB,cAAA,GAAAC,CAAA;QACjB,IAAI,CAACW,MAAM,CAACkB,GAAG,CAAC,SAASF,KAAK,CAACI,EAAE,8BAA8B,CAAC;QAAC;QAAAhC,cAAA,GAAAC,CAAA;QACjE,OAAO;UACLkC,QAAQ,EAAE,IAAI;UACdC,OAAO,EAAER,KAAK,CAACI,EAAE;UACjBK,SAAS,EAAET,KAAK,CAACG,IAAI;UACrBO,OAAO,EAAE;SACV;MACH,CAAC;MAAA;MAAA;QAAAtC,cAAA,GAAAwB,CAAA;MAAA;MAED;MAAAxB,cAAA,GAAAC,CAAA;MACA,MAAM,IAAI,CAACsC,kBAAkB,CAACX,KAAK,CAAC;MAEpC;MAAA;MAAA5B,cAAA,GAAAC,CAAA;MACA,MAAM,IAAI,CAACQ,aAAa,CAAC+B,kBAAkB,CAACZ,KAAK,CAAC;MAElD;MAAA;MAAA5B,cAAA,GAAAC,CAAA;MACA,MAAM,IAAI,CAACwC,kBAAkB,CAACb,KAAK,CAACI,EAAE,EAAE,IAAI,CAAC;MAE7C;MACA,MAAMU,cAAc;MAAA;MAAA,CAAA1C,cAAA,GAAAC,CAAA,QAAGqB,IAAI,CAACC,GAAG,EAAE,GAAGF,SAAS;MAAC;MAAArB,cAAA,GAAAC,CAAA;MAC9C,IAAI,CAACW,MAAM,CAACkB,GAAG,CACb,WAAWF,KAAK,CAACG,IAAI,8BAA8BW,cAAc,IAAI,CACtE;MAED;MAAA;MAAA1C,cAAA,GAAAC,CAAA;MACA,IAAI,CAACU,YAAY,CAACgC,IAAI,CAAC,0BAA0B,EAAE;QACjDP,OAAO,EAAER,KAAK,CAACI,EAAE;QACjBK,SAAS,EAAET,KAAK,CAACG,IAAI;QACrBW,cAAc;QACdE,OAAO,EAAE;OACV,CAAC;MAAC;MAAA5C,cAAA,GAAAC,CAAA;MAEH,OAAO;QACLkC,QAAQ,EAAE,IAAI;QACdC,OAAO,EAAER,KAAK,CAACI,EAAE;QACjBK,SAAS,EAAET,KAAK,CAACG,IAAI;QACrBW;OACD;IACH,CAAC,CAAC,OAAOjB,KAAK,EAAE;MACd,MAAMiB,cAAc;MAAA;MAAA,CAAA1C,cAAA,GAAAC,CAAA,QAAGqB,IAAI,CAACC,GAAG,EAAE,GAAGF,SAAS;MAE7C;MAAA;MAAArB,cAAA,GAAAC,CAAA;MACA,IAAI,CAACW,MAAM,CAACa,KAAK,CAAC,gCAAgCiB,cAAc,KAAK,EAAE;QACrEjB,KAAK,EAAEA,KAAK,YAAYoB,KAAK;QAAA;QAAA,CAAA7C,cAAA,GAAAwB,CAAA,WAAGC,KAAK,CAACa,OAAO;QAAA;QAAA,CAAAtC,cAAA,GAAAwB,CAAA,WAAGsB,MAAM,CAACrB,KAAK,CAAC;QAC7DsB,KAAK,EAAEtB,KAAK,YAAYoB,KAAK;QAAA;QAAA,CAAA7C,cAAA,GAAAwB,CAAA,WAAGC,KAAK,CAACsB,KAAK;QAAA;QAAA,CAAA/C,cAAA,GAAAwB,CAAA,WAAGwB,SAAS;QACvD5B,SAAS,EAAEA,SAAS,EAAE6B,SAAS,CAAC,CAAC,EAAE,EAAE,CAAC,GAAG,KAAK;QAC9CC,QAAQ,EAAE,OAAO/B,IAAI;QACrBgC,aAAa,EAAEjC,OAAO,CAACS,OAAO,EAAEyB;OACjC,CAAC;MAEF;MACA,IAAIhB,OAAO;MAAA;MAAA,CAAApC,cAAA,GAAAC,CAAA,QAAG,SAAS;MACvB,IAAIoC,SAAS;MAAA;MAAA,CAAArC,cAAA,GAAAC,CAAA,QAAG,SAAS;MAAC;MAAAD,cAAA,GAAAC,CAAA;MAE1B,IAAI;QAAA;QAAAD,cAAA,GAAAC,CAAA;QACF;QAAI;QAAA,CAAAD,cAAA,GAAAwB,CAAA,WAAAL,IAAI;QAAA;QAAA,CAAAnB,cAAA,GAAAwB,CAAA,WAAI,OAAOL,IAAI,KAAK,QAAQ,GAAE;UAAA;UAAAnB,cAAA,GAAAwB,CAAA;UAAAxB,cAAA,GAAAC,CAAA;UACpCmC,OAAO;UAAG;UAAA,CAAApC,cAAA,GAAAwB,CAAA,WAAAL,IAAI,CAACa,EAAE;UAAA;UAAA,CAAAhC,cAAA,GAAAwB,CAAA,WAAI,SAAS;UAAC;UAAAxB,cAAA,GAAAC,CAAA;UAC/BoC,SAAS;UAAG;UAAA,CAAArC,cAAA,GAAAwB,CAAA,WAAAL,IAAI,CAACY,IAAI;UAAA;UAAA,CAAA/B,cAAA,GAAAwB,CAAA,WAAI,SAAS;QACpC,CAAC;QAAA;QAAA;UAAAxB,cAAA,GAAAwB,CAAA;QAAA;MACH,CAAC,CAAC,OAAO6B,UAAU,EAAE;QACnB;MAAA;MAGF;MAAA;MAAArD,cAAA,GAAAC,CAAA;MACA,IAAImC,OAAO,KAAK,SAAS,EAAE;QAAA;QAAApC,cAAA,GAAAwB,CAAA;QAAAxB,cAAA,GAAAC,CAAA;QACzB,IAAI;UAAA;UAAAD,cAAA,GAAAC,CAAA;UACF,MAAM,IAAI,CAACwC,kBAAkB,CAC3BL,OAAO,EACP,KAAK,EACLX,KAAK,YAAYoB,KAAK;UAAA;UAAA,CAAA7C,cAAA,GAAAwB,CAAA,WAAGC,KAAK,CAACa,OAAO;UAAA;UAAA,CAAAtC,cAAA,GAAAwB,CAAA,WAAGsB,MAAM,CAACrB,KAAK,CAAC,EACvD;QACH,CAAC,CAAC,OAAO6B,OAAO,EAAE;UAAA;UAAAtD,cAAA,GAAAC,CAAA;UAChB,IAAI,CAACW,MAAM,CAACa,KAAK,CACf,6CAA6C,EAC7C6B,OAAO,CACR;QACH;MACF,CAAC;MAAA;MAAA;QAAAtD,cAAA,GAAAwB,CAAA;MAAA;MAED;MAAAxB,cAAA,GAAAC,CAAA;MACA,IAAI,CAACU,YAAY,CAACgC,IAAI,CAAC,sBAAsB,EAAE;QAC7CP,OAAO;QACPC,SAAS;QACTK,cAAc;QACdjB,KAAK,EAAEA,KAAK,YAAYoB,KAAK;QAAA;QAAA,CAAA7C,cAAA,GAAAwB,CAAA,WAAGC,KAAK,CAACa,OAAO;QAAA;QAAA,CAAAtC,cAAA,GAAAwB,CAAA,WAAGsB,MAAM,CAACrB,KAAK,CAAC;QAC7DmB,OAAO,EAAE;OACV,CAAC;MAEF;MAAA;MAAA5C,cAAA,GAAAC,CAAA;MACA,IAAIwB,KAAK,YAAY1B,QAAA,CAAA2B,mBAAmB,EAAE;QAAA;QAAA1B,cAAA,GAAAwB,CAAA;QAAAxB,cAAA,GAAAC,CAAA;QACxC,MAAMwB,KAAK;MACb,CAAC;MAAA;MAAA;QAAAzB,cAAA,GAAAwB,CAAA;MAAA;MAAAxB,cAAA,GAAAC,CAAA;MAED,MAAM,IAAIF,QAAA,CAAAwD,4BAA4B,CAAC,2BAA2B,CAAC;IACrE;EACF;EAYM,MAAAC,WAAWA,CAASrC,IAAS;IAAA;IAAAnB,cAAA,GAAAgB,CAAA;IAAAhB,cAAA,GAAAC,CAAA;IACjC,IAAI;MAAA;MAAAD,cAAA,GAAAC,CAAA;MACF,IAAI,CAACW,MAAM,CAACkB,GAAG,CAAC,wBAAwB,EAAEX,IAAI,CAAC;MAAC;MAAAnB,cAAA,GAAAC,CAAA;MAEhD,OAAO;QACLkC,QAAQ,EAAE,IAAI;QACdsB,SAAS,EAAE,IAAInC,IAAI,EAAE,CAACoC,WAAW,EAAE;QACnCpB,OAAO,EAAE,qCAAqC;QAC9CnB,IAAI,EAAEA;OACP;IACH,CAAC,CAAC,OAAOM,KAAK,EAAE;MAAA;MAAAzB,cAAA,GAAAC,CAAA;MACd,IAAI,CAACW,MAAM,CAACa,KAAK,CAAC,iCAAiC,EAAEA,KAAK,CAAC;MAAC;MAAAzB,cAAA,GAAAC,CAAA;MAC5D,MAAM,IAAIF,QAAA,CAAAwD,4BAA4B,CAAC,gCAAgC,CAAC;IAC1E;EACF;EAEA;;;EAGQ,MAAMrB,qBAAqBA,CAACE,OAAe;IAAA;IAAApC,cAAA,GAAAgB,CAAA;IAAAhB,cAAA,GAAAC,CAAA;IACjD,IAAI;MACF,MAAMgC,aAAa;MAAA;MAAA,CAAAjC,cAAA,GAAAC,CAAA,QAAG,MAAM,IAAI,CAACS,MAAM,CAACiD,kBAAkB,CAACC,UAAU,CAAC;QACpEC,KAAK,EAAE;UAAEzB;QAAO;OACjB,CAAC;MAAC;MAAApC,cAAA,GAAAC,CAAA;MAEH,OAAO,CAAC,CAACgC,aAAa;IACxB,CAAC,CAAC,OAAOR,KAAK,EAAE;MAAA;MAAAzB,cAAA,GAAAC,CAAA;MACd,IAAI,CAACW,MAAM,CAACa,KAAK,CACf,wCAAwCW,OAAO,GAAG,EAClDX,KAAK,CACN;MAAC;MAAAzB,cAAA,GAAAC,CAAA;MACF,OAAO,KAAK,CAAC,CAAC;IAChB;EACF;EAEA;;;EAGQ,MAAMsC,kBAAkBA,CAACX,KAAU;IAAA;IAAA5B,cAAA,GAAAgB,CAAA;IAAAhB,cAAA,GAAAC,CAAA;IACzC,IAAI;MAAA;MAAAD,cAAA,GAAAC,CAAA;MACF,MAAM,IAAI,CAACS,MAAM,CAACiD,kBAAkB,CAACG,MAAM,CAAC;QAC1CC,IAAI,EAAE;UACJ3B,OAAO,EAAER,KAAK,CAACI,EAAE;UACjBK,SAAS,EAAET,KAAK,CAACG,IAAI;UACrBiC,SAAS,EAAEpC,KAAK,CAACmC,IAAI;UACrBE,QAAQ,EAAErC,KAAK,CAACqC,QAAQ;UACxBC,UAAU,EAAEtC,KAAK,CAACuC,WAAW;UAC7BC,OAAO,EAAE,IAAI9C,IAAI,CAACM,KAAK,CAACwC,OAAO,GAAG,IAAI,CAAC;UACvCC,SAAS,EAAE;;OAEd,CAAC;IACJ,CAAC,CAAC,OAAO5C,KAAK,EAAE;MAAA;MAAAzB,cAAA,GAAAC,CAAA;MACd,IAAI,CAACW,MAAM,CAACa,KAAK,CAAC,iCAAiCG,KAAK,CAACI,EAAE,GAAG,EAAEP,KAAK,CAAC;MACtE;IACF;EACF;EAEA;;;EAGQ,MAAMgB,kBAAkBA,CAC9BL,OAAe,EACfQ,OAAgB,EAChB0B,YAAqB;IAAA;IAAAtE,cAAA,GAAAgB,CAAA;IAAAhB,cAAA,GAAAC,CAAA;IAErB,IAAI;MAAA;MAAAD,cAAA,GAAAC,CAAA;MACF,MAAM,IAAI,CAACS,MAAM,CAACiD,kBAAkB,CAACY,MAAM,CAAC;QAC1CV,KAAK,EAAE;UAAEzB;QAAO,CAAE;QAClB2B,IAAI,EAAE;UACJM,SAAS,EAAE,IAAI;UACfG,WAAW,EAAE,IAAIlD,IAAI,EAAE;UACvBsB,OAAO;UACP0B,YAAY;UAAE;UAAA,CAAAtE,cAAA,GAAAwB,CAAA,WAAA8C,YAAY;UAAA;UAAA,CAAAtE,cAAA,GAAAwB,CAAA,WAAI,IAAI;;OAErC,CAAC;IACJ,CAAC,CAAC,OAAOC,KAAK,EAAE;MAAA;MAAAzB,cAAA,GAAAC,CAAA;MACd,IAAI,CAACW,MAAM,CAACa,KAAK,CAAC,uBAAuBW,OAAO,gBAAgB,EAAEX,KAAK,CAAC;MACxE;IACF;EACF;EAEA;;;EAaM,MAAAgD,eAAeA,CAAA;IAAA;IAAAzE,cAAA,GAAAgB,CAAA;IAAAhB,cAAA,GAAAC,CAAA;IACnB,IAAI;MACF,MAAMsB,GAAG;MAAA;MAAA,CAAAvB,cAAA,GAAAC,CAAA,QAAG,IAAIqB,IAAI,EAAE;MACtB,MAAMoD,SAAS;MAAA;MAAA,CAAA1E,cAAA,GAAAC,CAAA,QAAG,IAAIqB,IAAI,CAACC,GAAG,CAACoD,OAAO,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,CAAC;MAC/D,MAAMC,UAAU;MAAA;MAAA,CAAA5E,cAAA,GAAAC,CAAA,QAAG,IAAIqB,IAAI,CAACC,GAAG,CAACoD,OAAO,EAAE,GAAG,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,CAAC;MAEpE,MAAM,CACJE,WAAW,EACXC,eAAe,EACfC,YAAY,EACZC,YAAY,EACZC,YAAY,CACb;MAAA;MAAA,CAAAjF,cAAA,GAAAC,CAAA,QAAG,MAAMiF,OAAO,CAACC,GAAG,CAAC,CACpB,IAAI,CAACzE,MAAM,CAACiD,kBAAkB,CAACyB,KAAK,EAAE,EACtC,IAAI,CAAC1E,MAAM,CAACiD,kBAAkB,CAACyB,KAAK,CAAC;QACnCvB,KAAK,EAAE;UAAEQ,SAAS,EAAE,IAAI;UAAEzB,OAAO,EAAE;QAAI;OACxC,CAAC,EACF,IAAI,CAAClC,MAAM,CAACiD,kBAAkB,CAACyB,KAAK,CAAC;QACnCvB,KAAK,EAAE;UAAEQ,SAAS,EAAE,IAAI;UAAEzB,OAAO,EAAE;QAAK;OACzC,CAAC,EACF,IAAI,CAAClC,MAAM,CAACiD,kBAAkB,CAACyB,KAAK,CAAC;QACnCvB,KAAK,EAAE;UAAEO,OAAO,EAAE;YAAEiB,GAAG,EAAEX;UAAS;QAAE;OACrC,CAAC,EACF,IAAI,CAAChE,MAAM,CAACiD,kBAAkB,CAAC2B,OAAO,CAAC;QACrCC,EAAE,EAAE,CAAC,WAAW,CAAC;QACjB1B,KAAK,EAAE;UAAEO,OAAO,EAAE;YAAEiB,GAAG,EAAET;UAAU;QAAE,CAAE;QACvCY,MAAM,EAAE;UAAEnD,SAAS,EAAE;QAAI;OAC1B,CAAC,CACH,CAAC;MAEF,MAAMoD,WAAW;MAAA;MAAA,CAAAzF,cAAA,GAAAC,CAAA,QACf4E,WAAW,GAAG,CAAC;MAAA;MAAA,CAAA7E,cAAA,GAAAwB,CAAA,WAAIsD,eAAe,GAAGD,WAAW,GAAI,GAAG;MAAA;MAAA,CAAA7E,cAAA,GAAAwB,CAAA,WAAG,CAAC;MAAC;MAAAxB,cAAA,GAAAC,CAAA;MAE9D,OAAO;QACL4E,WAAW;QACXC,eAAe;QACfC,YAAY;QACZC,YAAY;QACZS,WAAW,EAAEC,IAAI,CAACC,KAAK,CAACF,WAAW,GAAG,GAAG,CAAC,GAAG,GAAG;QAChDR,YAAY,EAAEA,YAAY,CAACW,GAAG,CAAEhE,KAAK,IAAM;UAAA;UAAA5B,cAAA,GAAAgB,CAAA;UAAAhB,cAAA,GAAAC,CAAA;UAAA;YACzCoC,SAAS,EAAET,KAAK,CAACS,SAAS;YAC1B+C,KAAK,EAAExD,KAAK,CAAC4D,MAAM,CAACnD;WACrB;SAAC;OACH;IACH,CAAC,CAAC,OAAOZ,KAAK,EAAE;MAAA;MAAAzB,cAAA,GAAAC,CAAA;MACd,IAAI,CAACW,MAAM,CAACa,KAAK,CAAC,mCAAmC,EAAEA,KAAK,CAAC;MAAC;MAAAzB,cAAA,GAAAC,CAAA;MAC9D,MAAM,IAAIF,QAAA,CAAAwD,4BAA4B,CACpC,kCAAkC,CACnC;IACH;EACF;EAEA;;;EAaM,MAAAsC,eAAeA,CAAA;IAAA;IAAA7F,cAAA,GAAAgB,CAAA;IAAAhB,cAAA,GAAAC,CAAA;IACnB,IAAI;MACF,MAAM6F,MAAM;MAAA;MAAA,CAAA9F,cAAA,GAAAC,CAAA,QAAG,MAAM,IAAI,CAACS,MAAM,CAACiD,kBAAkB,CAACoC,QAAQ,CAAC;QAC3DC,MAAM,EAAE;UACN5D,OAAO,EAAE,IAAI;UACbC,SAAS,EAAE,IAAI;UACf+B,OAAO,EAAE,IAAI;UACbC,SAAS,EAAE,IAAI;UACfG,WAAW,EAAE,IAAI;UACjB5B,OAAO,EAAE,IAAI;UACb0B,YAAY,EAAE;SACf;QACD2B,OAAO,EAAE;UAAE7B,OAAO,EAAE;QAAM,CAAE;QAC5B8B,IAAI,EAAE;OACP,CAAC;MAAC;MAAAlG,cAAA,GAAAC,CAAA;MAEH,OAAO;QACL6F,MAAM;QACNV,KAAK,EAAEU,MAAM,CAAC1C;OACf;IACH,CAAC,CAAC,OAAO3B,KAAK,EAAE;MAAA;MAAAzB,cAAA,GAAAC,CAAA;MACd,IAAI,CAACW,MAAM,CAACa,KAAK,CAAC,sCAAsC,EAAEA,KAAK,CAAC;MAAC;MAAAzB,cAAA,GAAAC,CAAA;MACjE,MAAM,IAAIF,QAAA,CAAAwD,4BAA4B,CACpC,qCAAqC,CACtC;IACH;EACF;EAEA;;;EAcM,MAAA4C,gBAAgBA,CAAQjF,OAAY;IAAA;IAAAlB,cAAA,GAAAgB,CAAA;IAAAhB,cAAA,GAAAC,CAAA;IACxC,IAAI;MACF,MAAMmC,OAAO;MAAA;MAAA,CAAApC,cAAA,GAAAC,CAAA,QAAGiB,OAAO,CAACkF,MAAM,CAAChE,OAAO;MAEtC;MACA,MAAMiE,YAAY;MAAA;MAAA,CAAArG,cAAA,GAAAC,CAAA,QAAG,MAAM,IAAI,CAACS,MAAM,CAACiD,kBAAkB,CAACC,UAAU,CAAC;QACnEC,KAAK,EAAE;UAAEzB;QAAO;OACjB,CAAC;MAAC;MAAApC,cAAA,GAAAC,CAAA;MAEH,IAAI,CAACoG,YAAY,EAAE;QAAA;QAAArG,cAAA,GAAAwB,CAAA;QAAAxB,cAAA,GAAAC,CAAA;QACjB,MAAM,IAAIF,QAAA,CAAA2B,mBAAmB,CAAC,iBAAiBU,OAAO,YAAY,CAAC;MACrE,CAAC;MAAA;MAAA;QAAApC,cAAA,GAAAwB,CAAA;MAAA;MAAAxB,cAAA,GAAAC,CAAA;MAED,IAAIoG,YAAY,CAACzD,OAAO,EAAE;QAAA;QAAA5C,cAAA,GAAAwB,CAAA;QAAAxB,cAAA,GAAAC,CAAA;QACxB,MAAM,IAAIF,QAAA,CAAA2B,mBAAmB,CAC3B,iBAAiBU,OAAO,iCAAiC,CAC1D;MACH,CAAC;MAAA;MAAA;QAAApC,cAAA,GAAAwB,CAAA;MAAA;MAED;MACA,MAAM8E,WAAW;MAAA;MAAA,CAAAtG,cAAA,GAAAC,CAAA,SAAG;QAClB+B,EAAE,EAAEqE,YAAY,CAACjE,OAAO;QACxBL,IAAI,EAAEsE,YAAY,CAAChE,SAAS;QAC5B0B,IAAI,EAAEsC,YAAY,CAACrC,SAAS;QAC5BI,OAAO,EAAEsB,IAAI,CAACa,KAAK,CAACF,YAAY,CAACjC,OAAO,CAACO,OAAO,EAAE,GAAG,IAAI,CAAC;QAC1DV,QAAQ,EAAEoC,YAAY,CAACpC,QAAQ;QAC/BE,WAAW,EAAEkC,YAAY,CAACnC;OAC3B;MAED;MAAA;MAAAlE,cAAA,GAAAC,CAAA;MACA,MAAM,IAAI,CAACQ,aAAa,CAAC+B,kBAAkB,CAAC8D,WAAkB,CAAC;MAE/D;MAAA;MAAAtG,cAAA,GAAAC,CAAA;MACA,MAAM,IAAI,CAACwC,kBAAkB,CAACL,OAAO,EAAE,IAAI,CAAC;MAAC;MAAApC,cAAA,GAAAC,CAAA;MAE7C,IAAI,CAACW,MAAM,CAACkB,GAAG,CAAC,sCAAsCM,OAAO,EAAE,CAAC;MAAC;MAAApC,cAAA,GAAAC,CAAA;MAEjE,OAAO;QACL2C,OAAO,EAAE,IAAI;QACbR,OAAO;QACPE,OAAO,EAAE;OACV;IACH,CAAC,CAAC,OAAOb,KAAK,EAAE;MAAA;MAAAzB,cAAA,GAAAC,CAAA;MACd,IAAI,CAACW,MAAM,CAACa,KAAK,CAAC,+BAA+B,EAAEA,KAAK,CAAC;MAAC;MAAAzB,cAAA,GAAAC,CAAA;MAC1D,MAAM,IAAIF,QAAA,CAAAwD,4BAA4B,CAAC,+BAA+B,CAAC;IACzE;EACF;CACD;AAAA;AAAAvD,cAAA,GAAAC,CAAA;AAzaYuG,OAAA,CAAAjG,uBAAA,GAAAA,uBAAA;AAAuB;AAAAP,cAAA,GAAAC,CAAA;AAoC5BwG,UAAA,EA3BL,IAAA1G,QAAA,CAAA2G,IAAI,GAAE,EACN,IAAA3G,QAAA,CAAA4G,QAAQ,EAAC5G,QAAA,CAAA6G,UAAU,CAACC,EAAE,CAAC,EACvB,IAAA1G,SAAA,CAAA2G,kBAAkB,GAAE,CAAC;AAAA,EACrB,IAAA3G,SAAA,CAAA4G,YAAY,EAAC;EACZC,OAAO,EAAE,8BAA8B;EACvCC,WAAW,EAAE;CACd,CAAC,EACD,IAAA9G,SAAA,CAAA+G,WAAW,EAAC;EACXC,MAAM,EAAE,GAAG;EACXF,WAAW,EAAE,gCAAgC;EAC7CG,MAAM,EAAE;IACNrF,IAAI,EAAE,QAAQ;IACdsF,UAAU,EAAE;MACVlF,QAAQ,EAAE;QAAEJ,IAAI,EAAE;MAAS,CAAE;MAC7BK,OAAO,EAAE;QAAEL,IAAI,EAAE;MAAQ,CAAE;MAC3BM,SAAS,EAAE;QAAEN,IAAI,EAAE;MAAQ;;;CAGhC,CAAC,EACD,IAAA5B,SAAA,CAAA+G,WAAW,EAAC;EACXC,MAAM,EAAE,GAAG;EACXF,WAAW,EAAE;CACd,CAAC,EACD,IAAA9G,SAAA,CAAA+G,WAAW,EAAC;EACXC,MAAM,EAAE,GAAG;EACXF,WAAW,EAAE;CACd,CAAC,EAECK,OAAA,QAAAvH,QAAA,CAAAwH,GAAG,GAAE,GACLD,OAAA,QAAAvH,QAAA,CAAAyH,IAAI,GAAE,GACNF,OAAA,QAAAvH,QAAA,CAAA0H,OAAO,EAAC,kBAAkB,CAAC,G;;qCAFZ1H,QAAA,CAAA2H,cAAc;AAAA;AAAA,CAAA1H,cAAA,GAAAwB,CAAA,WAAdzB,QAAA,CAAA2H,cAAc;AAAA;AAAA,CAAA1H,cAAA,GAAAwB,CAAA,WAAAmG,EAAA;AAAA;AAAA,CAAA3H,cAAA,GAAAwB,CAAA,WAAAoG,MAAA,GAAAA,MAAA,EAAA9E,MAAA,I,oGAgI/B;AAAA;AAAA9C,cAAA,GAAAC,CAAA;AAYKwG,UAAA,EAVL,IAAA1G,QAAA,CAAA2G,IAAI,EAAC,MAAM,CAAC,EACZ,IAAA3G,QAAA,CAAA4G,QAAQ,EAAC5G,QAAA,CAAA6G,UAAU,CAACC,EAAE,CAAC,EACvB,IAAA1G,SAAA,CAAA4G,YAAY,EAAC;EACZC,OAAO,EAAE,uBAAuB;EAChCC,WAAW,EAAE;CACd,CAAC,EACD,IAAA9G,SAAA,CAAA+G,WAAW,EAAC;EACXC,MAAM,EAAE,GAAG;EACXF,WAAW,EAAE;CACd,CAAC,EACiBK,OAAA,QAAAvH,QAAA,CAAAyH,IAAI,GAAE,G,kLAcxB;AAAA;AAAAxH,cAAA,GAAAC,CAAA;AAgFKwG,UAAA,EAVL,IAAA1G,QAAA,CAAA2G,IAAI,EAAC,OAAO,CAAC,EACb,IAAA3G,QAAA,CAAA4G,QAAQ,EAAC5G,QAAA,CAAA6G,UAAU,CAACC,EAAE,CAAC,EACvB,IAAA1G,SAAA,CAAA4G,YAAY,EAAC;EACZC,OAAO,EAAE,mCAAmC;EAC5CC,WAAW,EAAE;CACd,CAAC,EACD,IAAA9G,SAAA,CAAA+G,WAAW,EAAC;EACXC,MAAM,EAAE,GAAG;EACXF,WAAW,EAAE;CACd,CAAC,E,gLAmDD;AAAA;AAAAjH,cAAA,GAAAC,CAAA;AAeKwG,UAAA,EAVL,IAAA1G,QAAA,CAAA2G,IAAI,EAAC,QAAQ,CAAC,EACd,IAAA3G,QAAA,CAAA4G,QAAQ,EAAC5G,QAAA,CAAA6G,UAAU,CAACC,EAAE,CAAC,EACvB,IAAA1G,SAAA,CAAA4G,YAAY,EAAC;EACZC,OAAO,EAAE,2BAA2B;EACpCC,WAAW,EAAE;CACd,CAAC,EACD,IAAA9G,SAAA,CAAA+G,WAAW,EAAC;EACXC,MAAM,EAAE,GAAG;EACXF,WAAW,EAAE;CACd,CAAC,E,gLA2BD;AAAA;AAAAjH,cAAA,GAAAC,CAAA;AAgBKwG,UAAA,EAXL,IAAA1G,QAAA,CAAA2G,IAAI,EAAC,gBAAgB,CAAC,EACtB,IAAA3G,QAAA,CAAA4G,QAAQ,EAAC5G,QAAA,CAAA6G,UAAU,CAACC,EAAE,CAAC,EACvB,IAAA1G,SAAA,CAAA4G,YAAY,EAAC;EACZC,OAAO,EAAE,4BAA4B;EACrCC,WAAW,EACT;CACH,CAAC,EACD,IAAA9G,SAAA,CAAA+G,WAAW,EAAC;EACXC,MAAM,EAAE,GAAG;EACXF,WAAW,EAAE;CACd,CAAC,EACsBK,OAAA,QAAAvH,QAAA,CAAAwH,GAAG,GAAE,G,uLA8C5B;AAAA;AAAAvH,cAAA,GAAAC,CAAA;kCAxaUM,uBAAuB,GAAAC,yBAAA,GAAAiG,UAAA,EAJnC,IAAAtG,SAAA,CAAA0H,OAAO,EAAC,iBAAiB,CAAC,EAC1B,IAAA1H,SAAA,CAAA0H,OAAO,EAAC,gBAAgB,CAAC,EACzB,IAAA1H,SAAA,CAAA2H,aAAa,EAAC,UAAU,CAAC,EACzB,IAAA/H,QAAA,CAAAgI,UAAU,EAAC,yBAAyB,CAAC,E;;qCAKF3H,gBAAA,CAAA4H,aAAa;AAAA;AAAA,CAAAhI,cAAA,GAAAwB,CAAA,WAAbpB,gBAAA,CAAA4H,aAAa;AAAA;AAAA,CAAAhI,cAAA,GAAAwB,CAAA,WAAAyG,EAAA;AAAA;AAAA,CAAAjI,cAAA,GAAAwB,CAAA,WAAAoG,MAAA,WAAAM,EAAA;AAAA;AAAA,CAAAlI,cAAA,GAAAwB,CAAA,kBACpBnB,wBAAA,CAAA8H,aAAa;AAAA;AAAA,CAAAnI,cAAA,GAAAwB,CAAA,WAAbnB,wBAAA,CAAA8H,aAAa;AAAA;AAAA,CAAAnI,cAAA,GAAAwB,CAAA,WAAA0G,EAAA;AAAA;AAAA,CAAAlI,cAAA,GAAAwB,CAAA,WAAAoG,MAAA,WAAAQ,EAAA;AAAA;AAAA,CAAApI,cAAA,GAAAwB,CAAA,kBACPlB,eAAA,CAAA+H,aAAa;AAAA;AAAA,CAAArI,cAAA,GAAAwB,CAAA,WAAblB,eAAA,CAAA+H,aAAa;AAAA;AAAA,CAAArI,cAAA,GAAAwB,CAAA,WAAA4G,EAAA;AAAA;AAAA,CAAApI,cAAA,GAAAwB,CAAA,WAAAoG,MAAA,I,EANnCrH,uBAAuB,CAyanC","ignoreList":[]}