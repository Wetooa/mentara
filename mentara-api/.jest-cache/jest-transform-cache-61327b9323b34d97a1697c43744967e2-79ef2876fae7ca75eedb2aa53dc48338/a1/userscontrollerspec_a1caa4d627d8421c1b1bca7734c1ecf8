0ef702bab64149732bf772c04e092875
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const common_1 = require("@nestjs/common");
const users_controller_1 = require("./users.controller");
const users_service_1 = require("./users.service");
const jwt_auth_guard_1 = require("../auth/guards/jwt-auth.guard");
const admin_auth_guard_1 = require("../auth/guards/admin-auth.guard");
const supabase_storage_service_1 = require("../common/services/supabase-storage.service");
const role_utils_1 = require("../utils/role-utils");
const zod_validation_pipe_1 = require("../common/pipes/zod-validation.pipe");
const auth_testing_helpers_1 = require("../test-utils/auth-testing-helpers");
describe('UsersController', () => {
    let controller;
    let usersService;
    let supabaseStorageService;
    let roleUtils;
    let mockJwtAuthGuard;
    let mockAdminAuthGuard;
    // Test data constants
    const mockUser = {
        id: auth_testing_helpers_1.TEST_USER_IDS.CLIENT,
        email: auth_testing_helpers_1.TEST_EMAILS.CLIENT,
        firstName: 'John',
        lastName: 'Doe',
        role: 'client',
        bio: 'User bio',
        avatarUrl: 'https://example.com/avatar.jpg',
        coverImageUrl: 'https://example.com/cover.jpg',
        phoneNumber: '+1234567890',
        timezone: 'America/New_York',
        language: 'en',
        theme: 'light',
        createdAt: new Date(),
        updatedAt: new Date(),
        emailVerified: true,
        profileComplete: true,
        isActive: true,
    };
    const mockAdminUser = {
        id: auth_testing_helpers_1.TEST_USER_IDS.ADMIN,
        email: auth_testing_helpers_1.TEST_EMAILS.ADMIN,
        firstName: 'Admin',
        lastName: 'User',
        role: 'admin',
        createdAt: new Date(),
        updatedAt: new Date(),
        emailVerified: true,
        profileComplete: true,
        isActive: true,
    };
    const mockUsers = [mockUser, mockAdminUser];
    const mockFile = {
        fieldname: 'avatar',
        originalname: 'avatar.jpg',
        encoding: '7bit',
        mimetype: 'image/jpeg',
        size: 1024,
        buffer: Buffer.from('test file content'),
    };
    const mockUploadResult = {
        url: 'https://example.com/uploaded-avatar.jpg',
        filename: 'avatar.jpg',
        size: 1024,
    };
    beforeEach(async () => {
        // Create mock services
        const mockUsersService = {
            findAll: jest.fn(),
            findAllIncludeInactive: jest.fn(),
            findOne: jest.fn(),
            findOneIncludeInactive: jest.fn(),
            update: jest.fn(),
            remove: jest.fn(),
            deactivate: jest.fn(),
            reactivate: jest.fn(),
        };
        const mockSupabaseStorageService = {
            validateFile: jest.fn(),
            uploadFile: jest.fn(),
            getSupportedBuckets: jest.fn(),
        };
        const mockRoleUtils = {
            isUserAdmin: jest.fn(),
        };
        mockJwtAuthGuard = {
            canActivate: jest.fn().mockReturnValue(true),
        };
        mockAdminAuthGuard = {
            canActivate: jest.fn().mockReturnValue(true),
        };
        // Add static method mock
        supabase_storage_service_1.SupabaseStorageService.getSupportedBuckets = jest.fn().mockReturnValue({
            USER_PROFILES: 'user-profiles',
        });
        const module = await testing_1.Test.createTestingModule({
            controllers: [users_controller_1.UsersController],
            providers: [
                {
                    provide: users_service_1.UsersService,
                    useValue: mockUsersService,
                },
                {
                    provide: supabase_storage_service_1.SupabaseStorageService,
                    useValue: mockSupabaseStorageService,
                },
                {
                    provide: role_utils_1.RoleUtils,
                    useValue: mockRoleUtils,
                },
                {
                    provide: common_1.Logger,
                    useValue: {
                        log: jest.fn(),
                        error: jest.fn(),
                        warn: jest.fn(),
                        debug: jest.fn(),
                    },
                },
            ],
        })
            .overrideGuard(jwt_auth_guard_1.JwtAuthGuard)
            .useValue(mockJwtAuthGuard)
            .overrideGuard(admin_auth_guard_1.AdminAuthGuard)
            .useValue(mockAdminAuthGuard)
            .compile();
        controller = module.get(users_controller_1.UsersController);
        usersService = module.get(users_service_1.UsersService);
        supabaseStorageService = module.get(supabase_storage_service_1.SupabaseStorageService);
        roleUtils = module.get(role_utils_1.RoleUtils);
    });
    afterEach(() => {
        jest.clearAllMocks();
    });
    describe('findAll', () => {
        it('should return all users for admin', async () => {
            // Arrange
            jest.spyOn(usersService, 'findAll').mockResolvedValue(mockUsers);
            // Act
            const result = await controller.findAll(auth_testing_helpers_1.TEST_USER_IDS.ADMIN);
            // Assert
            expect(usersService.findAll).toHaveBeenCalled();
            expect(result).toEqual(mockUsers);
        });
        it('should handle service errors', async () => {
            // Arrange
            const error = new Error('Database error');
            jest.spyOn(usersService, 'findAll').mockRejectedValue(error);
            // Act & Assert
            await expect(controller.findAll(auth_testing_helpers_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('findAllIncludeInactive', () => {
        it('should return all users including inactive for admin', async () => {
            const mockUsers = [
                auth_testing_helpers_1.TestDataGenerator.createUser({ isActive: true }),
                auth_testing_helpers_1.TestDataGenerator.createUser({ isActive: false }),
            ];
            usersService.findAllIncludeInactive.mockResolvedValue(mockUsers);
            const result = await controller.findAllIncludeInactive(auth_testing_helpers_1.TEST_USER_IDS.ADMIN);
            expect(usersService.findAllIncludeInactive).toHaveBeenCalled();
            expect(result).toEqual(mockUsers);
        });
        it('should handle service errors when fetching all users', async () => {
            usersService.findAllIncludeInactive.mockRejectedValue(new Error('Database connection failed'));
            await expect(controller.findAllIncludeInactive(auth_testing_helpers_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('findOne', () => {
        const mockUser = auth_testing_helpers_1.TestDataGenerator.createUser({ id: auth_testing_helpers_1.TEST_USER_IDS.CLIENT });
        it('should allow user to view their own profile', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.findOne.mockResolvedValue(mockUser);
            const result = await controller.findOne(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            expect(roleUtils.isUserAdmin).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            expect(usersService.findOne).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            expect(result).toEqual(mockUser);
        });
        it('should allow admin to view any user profile', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(true);
            usersService.findOneIncludeInactive.mockResolvedValue(mockUser);
            const result = await controller.findOne(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, auth_testing_helpers_1.TEST_USER_IDS.ADMIN);
            expect(roleUtils.isUserAdmin).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_USER_IDS.ADMIN);
            expect(usersService.findOneIncludeInactive).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            expect(result).toEqual(mockUser);
        });
        it('should throw ForbiddenException when non-admin tries to view other user', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(false);
            await expect(controller.findOne(auth_testing_helpers_1.TEST_USER_IDS.THERAPIST, auth_testing_helpers_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.ForbiddenException);
            expect(usersService.findOne).not.toHaveBeenCalled();
        });
        it('should throw HttpException when user not found', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.findOne.mockResolvedValue(null);
            await expect(controller.findOne(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, auth_testing_helpers_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('update', () => {
        const updateData = {
            firstName: 'Updated',
            lastName: 'Name',
            bio: 'Updated bio',
        };
        it('should allow user to update their own profile', async () => {
            const updatedUser = { ...auth_testing_helpers_1.TestDataGenerator.createUser(), ...updateData };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.update.mockResolvedValue(updatedUser);
            const result = await controller.update(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, updateData, auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            expect(roleUtils.isUserAdmin).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            expect(usersService.update).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, updateData);
            expect(result).toEqual(updatedUser);
        });
        it('should allow admin to update any user with all fields', async () => {
            const adminUpdateData = {
                firstName: 'Admin Updated',
                role: 'moderator',
                isActive: false,
            };
            const updatedUser = {
                ...auth_testing_helpers_1.TestDataGenerator.createUser(),
                ...adminUpdateData,
            };
            roleUtils.isUserAdmin.mockResolvedValue(true);
            usersService.update.mockResolvedValue(updatedUser);
            const result = await controller.update(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, adminUpdateData, auth_testing_helpers_1.TEST_USER_IDS.ADMIN);
            expect(usersService.update).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, adminUpdateData);
            expect(result).toEqual(updatedUser);
        });
        it('should sanitize non-admin updates to allowed fields only', async () => {
            const unauthorizedData = {
                firstName: 'John',
                role: 'admin', // Should be filtered out
                isActive: false, // Should be filtered out
                bio: 'New bio',
            };
            const sanitizedData = {
                firstName: 'John',
                bio: 'New bio',
            };
            const updatedUser = {
                ...auth_testing_helpers_1.TestDataGenerator.createUser(),
                ...sanitizedData,
            };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.update.mockResolvedValue(updatedUser);
            const result = await controller.update(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, unauthorizedData, auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            expect(usersService.update).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, sanitizedData);
            expect(result).toEqual(updatedUser);
        });
        it('should throw ForbiddenException when non-admin tries to update other user', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(false);
            await expect(controller.update(auth_testing_helpers_1.TEST_USER_IDS.THERAPIST, updateData, auth_testing_helpers_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.ForbiddenException);
            expect(usersService.update).not.toHaveBeenCalled();
        });
    });
    describe('remove', () => {
        it('should allow user to deactivate their own account', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.remove.mockResolvedValue({});
            const result = await controller.remove(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            expect(roleUtils.isUserAdmin).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            expect(usersService.remove).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            expect(result).toEqual({
                message: 'User account deactivated successfully',
            });
        });
        it('should allow admin to deactivate any user account', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(true);
            usersService.remove.mockResolvedValue({});
            const result = await controller.remove(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, auth_testing_helpers_1.TEST_USER_IDS.ADMIN);
            expect(usersService.remove).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            expect(result).toEqual({
                message: 'User account deactivated successfully',
            });
        });
        it('should throw ForbiddenException when non-admin tries to deactivate other user', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(false);
            await expect(controller.remove(auth_testing_helpers_1.TEST_USER_IDS.THERAPIST, auth_testing_helpers_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.ForbiddenException);
            expect(usersService.remove).not.toHaveBeenCalled();
        });
    });
    describe('deactivateUser (admin only)', () => {
        it('should allow admin to deactivate user with reason', async () => {
            const deactivationBody = { reason: 'Policy violation' };
            usersService.deactivate.mockResolvedValue({});
            const result = await controller.deactivateUser(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, deactivationBody, auth_testing_helpers_1.TEST_USER_IDS.ADMIN);
            expect(usersService.deactivate).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, 'Policy violation', auth_testing_helpers_1.TEST_USER_IDS.ADMIN);
            expect(result).toEqual({
                message: 'User account deactivated by administrator',
            });
        });
        it('should handle deactivation without reason', async () => {
            const deactivationBody = {};
            usersService.deactivate.mockResolvedValue({});
            const result = await controller.deactivateUser(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, deactivationBody, auth_testing_helpers_1.TEST_USER_IDS.ADMIN);
            expect(usersService.deactivate).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, undefined, auth_testing_helpers_1.TEST_USER_IDS.ADMIN);
            expect(result).toEqual({
                message: 'User account deactivated by administrator',
            });
        });
        it('should handle service errors during deactivation', async () => {
            const deactivationBody = { reason: 'Test reason' };
            usersService.deactivate.mockRejectedValue(new Error('Service error'));
            await expect(controller.deactivateUser(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, deactivationBody, auth_testing_helpers_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('reactivateUser (admin only)', () => {
        it('should allow admin to reactivate user', async () => {
            usersService.reactivate.mockResolvedValue({});
            const result = await controller.reactivateUser(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, auth_testing_helpers_1.TEST_USER_IDS.ADMIN);
            expect(usersService.reactivate).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            expect(result).toEqual({
                message: 'User account reactivated successfully',
            });
        });
        it('should handle service errors during reactivation', async () => {
            usersService.reactivate.mockRejectedValue(new Error('Reactivation failed'));
            await expect(controller.reactivateUser(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, auth_testing_helpers_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('error handling', () => {
        it('should preserve ForbiddenException from service layer', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(true);
            usersService.findOneIncludeInactive.mockRejectedValue(new common_1.ForbiddenException('Access denied'));
            await expect(controller.findOne(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, auth_testing_helpers_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(common_1.ForbiddenException);
        });
        it('should wrap generic errors in HttpException', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.findOne.mockRejectedValue(new Error('Generic error'));
            await expect(controller.findOne(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, auth_testing_helpers_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.HttpException);
        });
        it('should handle role utils errors gracefully', async () => {
            roleUtils.isUserAdmin.mockRejectedValue(new Error('Role check failed'));
            await expect(controller.findOne(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, auth_testing_helpers_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('authorization edge cases', () => {
        it('should handle empty update data for non-admin', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.update.mockResolvedValue(auth_testing_helpers_1.TestDataGenerator.createUser());
            await controller.update(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, {}, auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            expect(usersService.update).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, {});
        });
        it('should handle mixed allowed and disallowed fields for non-admin', async () => {
            const mixedData = {
                firstName: 'John', // Allowed
                lastName: 'Doe', // Allowed
                role: 'admin', // Not allowed
                bio: 'New bio', // Allowed
                isActive: false, // Not allowed
                avatarUrl: 'http://example.com/avatar.jpg', // Allowed
            };
            const expectedSanitizedData = {
                firstName: 'John',
                lastName: 'Doe',
                bio: 'New bio',
                avatarUrl: 'http://example.com/avatar.jpg',
            };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.update.mockResolvedValue(auth_testing_helpers_1.TestDataGenerator.createUser());
            await controller.update(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, mixedData, auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            expect(usersService.update).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, expectedSanitizedData);
        });
    });
    describe('File Upload Integration', () => {
        it('should handle avatar upload successfully', async () => {
            // Arrange
            const mockFiles = {
                avatar: [mockFile],
            };
            const updateData = {
                firstName: 'John',
                lastName: 'Doe',
            };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            supabaseStorageService.validateFile.mockReturnValue({ isValid: true });
            supabaseStorageService.uploadFile.mockResolvedValue(mockUploadResult);
            usersService.update.mockResolvedValue(auth_testing_helpers_1.TestDataGenerator.createUser());
            // Act
            await controller.update(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, updateData, auth_testing_helpers_1.TEST_USER_IDS.CLIENT, mockFiles);
            // Assert
            expect(supabaseStorageService.validateFile).toHaveBeenCalledWith(mockFile);
            expect(supabaseStorageService.uploadFile).toHaveBeenCalledWith(mockFile, 'user-profiles');
            expect(usersService.update).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, {
                ...updateData,
                avatarUrl: mockUploadResult.url,
            });
        });
        it('should handle cover image upload successfully', async () => {
            // Arrange
            const mockCoverFile = {
                ...mockFile,
                fieldname: 'cover',
                originalname: 'cover.jpg',
            };
            const mockFiles = {
                cover: [mockCoverFile],
            };
            const updateData = {
                firstName: 'John',
                lastName: 'Doe',
            };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            supabaseStorageService.validateFile.mockReturnValue({ isValid: true });
            supabaseStorageService.uploadFile.mockResolvedValue(mockUploadResult);
            usersService.update.mockResolvedValue(auth_testing_helpers_1.TestDataGenerator.createUser());
            // Act
            await controller.update(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, updateData, auth_testing_helpers_1.TEST_USER_IDS.CLIENT, mockFiles);
            // Assert
            expect(supabaseStorageService.validateFile).toHaveBeenCalledWith(mockCoverFile);
            expect(supabaseStorageService.uploadFile).toHaveBeenCalledWith(mockCoverFile, 'user-profiles');
            expect(usersService.update).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, {
                ...updateData,
                coverImageUrl: mockUploadResult.url,
            });
        });
        it('should handle multiple file uploads simultaneously', async () => {
            // Arrange
            const mockCoverFile = {
                ...mockFile,
                fieldname: 'cover',
                originalname: 'cover.jpg',
            };
            const mockFiles = {
                avatar: [mockFile],
                cover: [mockCoverFile],
            };
            const updateData = {
                firstName: 'John',
                lastName: 'Doe',
            };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            supabaseStorageService.validateFile.mockReturnValue({ isValid: true });
            supabaseStorageService.uploadFile.mockResolvedValue(mockUploadResult);
            usersService.update.mockResolvedValue(auth_testing_helpers_1.TestDataGenerator.createUser());
            // Act
            await controller.update(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, updateData, auth_testing_helpers_1.TEST_USER_IDS.CLIENT, mockFiles);
            // Assert
            expect(supabaseStorageService.validateFile).toHaveBeenCalledTimes(2);
            expect(supabaseStorageService.uploadFile).toHaveBeenCalledTimes(2);
            expect(usersService.update).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, {
                ...updateData,
                avatarUrl: mockUploadResult.url,
                coverImageUrl: mockUploadResult.url,
            });
        });
        it('should handle file validation errors', async () => {
            // Arrange
            const mockFiles = {
                avatar: [mockFile],
            };
            const updateData = {
                firstName: 'John',
                lastName: 'Doe',
            };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            supabaseStorageService.validateFile.mockReturnValue({
                isValid: false,
                error: 'File too large',
            });
            // Act & Assert
            await expect(controller.update(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, updateData, auth_testing_helpers_1.TEST_USER_IDS.CLIENT, mockFiles)).rejects.toThrow('Avatar validation failed: File too large');
        });
        it('should handle file upload errors', async () => {
            // Arrange
            const mockFiles = {
                avatar: [mockFile],
            };
            const updateData = {
                firstName: 'John',
                lastName: 'Doe',
            };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            supabaseStorageService.validateFile.mockReturnValue({ isValid: true });
            supabaseStorageService.uploadFile.mockRejectedValue(new Error('Upload failed'));
            // Act & Assert
            await expect(controller.update(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, updateData, auth_testing_helpers_1.TEST_USER_IDS.CLIENT, mockFiles)).rejects.toThrow('Failed to update user: Upload failed');
        });
    });
    describe('Security Tests', () => {
        it('should validate input data through ZodValidationPipe', () => {
            // This tests that the controller uses proper validation
            const validationPipe = new zod_validation_pipe_1.ZodValidationPipe({});
            expect(validationPipe).toBeDefined();
        });
        it('should require authentication for all endpoints', () => {
            // Test that all endpoints have JwtAuthGuard
            const protectedMethods = ['findAll', 'findAllIncludeInactive', 'findOne', 'update', 'remove', 'deactivateUser', 'reactivateUser'];
            protectedMethods.forEach(method => {
                const guards = Reflect.getMetadata('__guards__', controller[method]);
                expect(guards).toBeDefined();
            });
        });
        it('should enforce admin-only access for admin endpoints', () => {
            // Test that admin endpoints have AdminAuthGuard
            const adminMethods = ['findAll', 'findAllIncludeInactive', 'deactivateUser', 'reactivateUser'];
            adminMethods.forEach(method => {
                const guards = Reflect.getMetadata('__guards__', controller[method]);
                expect(guards).toBeDefined();
            });
        });
        it('should handle JWT token validation', async () => {
            // Test that JWT guard is properly applied
            mockJwtAuthGuard.canActivate.mockReturnValue(false);
            // Mock the actual HTTP exception that would be thrown
            const unauthorizedError = new Error('Unauthorized');
            usersService.findAll.mockRejectedValue(unauthorizedError);
            await expect(controller.findAll(auth_testing_helpers_1.TEST_USER_IDS.ADMIN)).rejects.toThrow();
        });
        it('should handle admin authorization validation', async () => {
            // Test that admin guard is properly applied
            mockAdminAuthGuard.canActivate.mockReturnValue(false);
            // Mock the actual HTTP exception that would be thrown
            const forbiddenError = new Error('Forbidden');
            usersService.findAll.mockRejectedValue(forbiddenError);
            await expect(controller.findAll(auth_testing_helpers_1.TEST_USER_IDS.ADMIN)).rejects.toThrow();
        });
        it('should prevent unauthorized access to other user profiles', async () => {
            // Test that users can only access their own profile
            roleUtils.isUserAdmin.mockResolvedValue(false);
            await expect(controller.findOne(auth_testing_helpers_1.TEST_USER_IDS.THERAPIST, auth_testing_helpers_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.ForbiddenException);
        });
    });
    describe('Role-based Access Control', () => {
        it('should test role-based access for admin endpoints', async () => {
            // Test that admin endpoints require admin role
            await auth_testing_helpers_1.RoleBasedTestUtils.testWithRoles(async (userId, role) => {
                try {
                    await controller.findAll(userId);
                    return true;
                }
                catch (error) {
                    return false;
                }
            }, {
                client: false,
                therapist: false,
                admin: true,
                moderator: false,
            });
        });
        it('should validate user-specific functionality', async () => {
            // Test that users can access their own profile
            const userContext = auth_testing_helpers_1.MockBuilder.createAuthContext('client');
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.findOne.mockResolvedValue(mockUser);
            const result = await controller.findOne(userContext.userId, userContext.userId);
            expect(result).toBeDefined();
            expect(result.id).toBe(userContext.userId);
        });
        it('should test field sanitization for non-admin users', async () => {
            // Test that non-admin users cannot update sensitive fields
            const sensitiveData = {
                firstName: 'John',
                role: 'admin', // Should be filtered out
                isActive: false, // Should be filtered out
                emailVerified: true, // Should be filtered out
            };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.update.mockResolvedValue(mockUser);
            await controller.update(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, sensitiveData, auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            expect(usersService.update).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, { firstName: 'John' });
        });
    });
    describe('Integration Tests', () => {
        it('should handle complete user profile update workflow', async () => {
            // Arrange
            const updateData = {
                firstName: 'Updated',
                lastName: 'Name',
                bio: 'Updated bio',
                timezone: 'America/Los_Angeles',
                language: 'en',
                theme: 'dark',
            };
            const updatedUser = { ...mockUser, ...updateData };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.update.mockResolvedValue(updatedUser);
            // Act
            const result = await controller.update(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, updateData, auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            // Assert
            expect(result).toBeDefined();
            expect(result.firstName).toBe('Updated');
            expect(result.lastName).toBe('Name');
            expect(result.bio).toBe('Updated bio');
            expect(result.timezone).toBe('America/Los_Angeles');
        });
        it('should handle complete admin user management workflow', async () => {
            // Arrange
            roleUtils.isUserAdmin.mockResolvedValue(true);
            usersService.findAll.mockResolvedValue(mockUsers);
            usersService.findAllIncludeInactive.mockResolvedValue(mockUsers);
            usersService.findOneIncludeInactive.mockResolvedValue(mockUser);
            // Act - Get all users
            const allUsers = await controller.findAll(auth_testing_helpers_1.TEST_USER_IDS.ADMIN);
            // Act - Get all users including inactive
            const allUsersIncludeInactive = await controller.findAllIncludeInactive(auth_testing_helpers_1.TEST_USER_IDS.ADMIN);
            // Act - View specific user
            const specificUser = await controller.findOne(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, auth_testing_helpers_1.TEST_USER_IDS.ADMIN);
            // Assert
            expect(allUsers).toBeDefined();
            expect(allUsers).toHaveLength(2);
            expect(allUsersIncludeInactive).toBeDefined();
            expect(allUsersIncludeInactive).toHaveLength(2);
            expect(specificUser).toBeDefined();
            expect(specificUser.id).toBe(auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
        });
        it('should handle complete user deactivation workflow', async () => {
            // Arrange
            roleUtils.isUserAdmin.mockResolvedValue(true);
            usersService.deactivate.mockResolvedValue({});
            // Act
            const result = await controller.deactivateUser(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, { reason: 'Policy violation' }, auth_testing_helpers_1.TEST_USER_IDS.ADMIN);
            // Assert
            expect(result).toBeDefined();
            expect(result.message).toBe('User account deactivated by administrator');
            expect(usersService.deactivate).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, 'Policy violation', auth_testing_helpers_1.TEST_USER_IDS.ADMIN);
        });
        it('should handle complete user reactivation workflow', async () => {
            // Arrange
            roleUtils.isUserAdmin.mockResolvedValue(true);
            usersService.reactivate.mockResolvedValue({});
            // Act
            const result = await controller.reactivateUser(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, auth_testing_helpers_1.TEST_USER_IDS.ADMIN);
            // Assert
            expect(result).toBeDefined();
            expect(result.message).toBe('User account reactivated successfully');
            expect(usersService.reactivate).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
        });
    });
    describe('Data Validation', () => {
        it('should validate user update data structure', () => {
            // Test that we're using the correct DTO structure
            const validUpdateData = {
                firstName: 'John',
                lastName: 'Doe',
                bio: 'User bio',
                avatarUrl: 'https://example.com/avatar.jpg',
                coverImageUrl: 'https://example.com/cover.jpg',
                phoneNumber: '+1234567890',
                timezone: 'America/New_York',
                language: 'en',
                theme: 'light',
            };
            // Verify all fields are defined
            expect(validUpdateData.firstName).toBeDefined();
            expect(validUpdateData.lastName).toBeDefined();
            expect(validUpdateData.bio).toBeDefined();
            expect(validUpdateData.avatarUrl).toBeDefined();
            expect(validUpdateData.coverImageUrl).toBeDefined();
            expect(validUpdateData.phoneNumber).toBeDefined();
            expect(validUpdateData.timezone).toBeDefined();
            expect(validUpdateData.language).toBeDefined();
            expect(validUpdateData.theme).toBeDefined();
        });
        it('should validate deactivation data structure', () => {
            // Test that we're using the correct DTO structure
            const validDeactivationData = {
                reason: 'Policy violation',
            };
            // Verify all fields are defined
            expect(validDeactivationData.reason).toBeDefined();
        });
        it('should validate user ID parameter structure', () => {
            // Test that we're using the correct parameter structure
            const validUserIdParam = {
                id: auth_testing_helpers_1.TEST_USER_IDS.CLIENT,
            };
            // Verify all fields are defined
            expect(validUserIdParam.id).toBeDefined();
        });
    });
    describe('Response Format Validation', () => {
        it('should return correctly formatted user list response', async () => {
            // Arrange
            roleUtils.isUserAdmin.mockResolvedValue(true);
            usersService.findAll.mockResolvedValue(mockUsers);
            // Act
            const result = await controller.findAll(auth_testing_helpers_1.TEST_USER_IDS.ADMIN);
            // Assert
            expect(result).toBeInstanceOf(Array);
            expect(result).toHaveLength(2);
            const user = result[0];
            expect(user).toHaveProperty('id');
            expect(user).toHaveProperty('email');
            expect(user).toHaveProperty('firstName');
            expect(user).toHaveProperty('lastName');
            expect(user).toHaveProperty('role');
            expect(user).toHaveProperty('createdAt');
            expect(user).toHaveProperty('isActive');
        });
        it('should return correctly formatted user profile response', async () => {
            // Arrange
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.findOne.mockResolvedValue(mockUser);
            // Act
            const result = await controller.findOne(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            // Assert
            expect(result).toHaveProperty('id');
            expect(result).toHaveProperty('email');
            expect(result).toHaveProperty('firstName');
            expect(result).toHaveProperty('lastName');
            expect(result).toHaveProperty('role');
            expect(result).toHaveProperty('bio');
            expect(result).toHaveProperty('avatarUrl');
            expect(result).toHaveProperty('coverImageUrl');
            expect(result).toHaveProperty('phoneNumber');
            expect(result).toHaveProperty('timezone');
            expect(result).toHaveProperty('language');
            expect(result).toHaveProperty('theme');
            expect(result).toHaveProperty('createdAt');
            expect(result).toHaveProperty('updatedAt');
        });
        it('should return correctly formatted update response', async () => {
            // Arrange
            const updateData = {
                firstName: 'Updated',
                lastName: 'Name',
            };
            const updatedUser = { ...mockUser, ...updateData };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.update.mockResolvedValue(updatedUser);
            // Act
            const result = await controller.update(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, updateData, auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            // Assert
            expect(result).toHaveProperty('id');
            expect(result).toHaveProperty('email');
            expect(result).toHaveProperty('firstName');
            expect(result).toHaveProperty('lastName');
            expect(result.firstName).toBe('Updated');
            expect(result.lastName).toBe('Name');
        });
        it('should return correctly formatted deactivation response', async () => {
            // Arrange
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.remove.mockResolvedValue({});
            // Act
            const result = await controller.remove(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, auth_testing_helpers_1.TEST_USER_IDS.CLIENT);
            // Assert
            expect(result).toHaveProperty('message');
            expect(result.message).toBe('User account deactivated successfully');
        });
        it('should return correctly formatted admin deactivation response', async () => {
            // Arrange
            usersService.deactivate.mockResolvedValue({});
            // Act
            const result = await controller.deactivateUser(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, { reason: 'Policy violation' }, auth_testing_helpers_1.TEST_USER_IDS.ADMIN);
            // Assert
            expect(result).toHaveProperty('message');
            expect(result.message).toBe('User account deactivated by administrator');
        });
        it('should return correctly formatted reactivation response', async () => {
            // Arrange
            usersService.reactivate.mockResolvedValue({});
            // Act
            const result = await controller.reactivateUser(auth_testing_helpers_1.TEST_USER_IDS.CLIENT, auth_testing_helpers_1.TEST_USER_IDS.ADMIN);
            // Assert
            expect(result).toHaveProperty('message');
            expect(result.message).toBe('User account reactivated successfully');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL3VzZXJzL3VzZXJzLmNvbnRyb2xsZXIuc3BlYy50cyIsIm1hcHBpbmdzIjoiOztBQUFBLDZDQUFzRDtBQUN0RCwyQ0FLd0I7QUFDeEIseURBQXFEO0FBQ3JELG1EQUErQztBQUMvQyxrRUFBNkQ7QUFDN0Qsc0VBQWlFO0FBQ2pFLDBGQUFxRjtBQUNyRixvREFBZ0Q7QUFDaEQsNkVBQXdFO0FBQ3hFLDZFQVE0QztBQUU1QyxRQUFRLENBQUMsaUJBQWlCLEVBQUUsR0FBRyxFQUFFO0lBQy9CLElBQUksVUFBMkIsQ0FBQztJQUNoQyxJQUFJLFlBQTBCLENBQUM7SUFDL0IsSUFBSSxzQkFBOEMsQ0FBQztJQUNuRCxJQUFJLFNBQW9CLENBQUM7SUFDekIsSUFBSSxnQkFBMkMsQ0FBQztJQUNoRCxJQUFJLGtCQUErQyxDQUFDO0lBRXBELHNCQUFzQjtJQUN0QixNQUFNLFFBQVEsR0FBRztRQUNmLEVBQUUsRUFBRSxvQ0FBYSxDQUFDLE1BQU07UUFDeEIsS0FBSyxFQUFFLGtDQUFXLENBQUMsTUFBTTtRQUN6QixTQUFTLEVBQUUsTUFBTTtRQUNqQixRQUFRLEVBQUUsS0FBSztRQUNmLElBQUksRUFBRSxRQUFRO1FBQ2QsR0FBRyxFQUFFLFVBQVU7UUFDZixTQUFTLEVBQUUsZ0NBQWdDO1FBQzNDLGFBQWEsRUFBRSwrQkFBK0I7UUFDOUMsV0FBVyxFQUFFLGFBQWE7UUFDMUIsUUFBUSxFQUFFLGtCQUFrQjtRQUM1QixRQUFRLEVBQUUsSUFBSTtRQUNkLEtBQUssRUFBRSxPQUFPO1FBQ2QsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFO1FBQ3JCLFNBQVMsRUFBRSxJQUFJLElBQUksRUFBRTtRQUNyQixhQUFhLEVBQUUsSUFBSTtRQUNuQixlQUFlLEVBQUUsSUFBSTtRQUNyQixRQUFRLEVBQUUsSUFBSTtLQUNmLENBQUM7SUFFRixNQUFNLGFBQWEsR0FBRztRQUNwQixFQUFFLEVBQUUsb0NB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Q0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9ob21lL3dldG9vYS9Eb2N1bWVudHMvY29kZS9wcm9qZWN0cy9tZW50YXJhL21lbnRhcmEtYXBpL3NyYy91c2Vycy91c2Vycy5jb250cm9sbGVyLnNwZWMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVGVzdCwgVGVzdGluZ01vZHVsZSB9IGZyb20gJ0BuZXN0anMvdGVzdGluZyc7XG5pbXBvcnQgeyBcbiAgSHR0cEV4Y2VwdGlvbiwgXG4gIEh0dHBTdGF0dXMsIFxuICBGb3JiaWRkZW5FeGNlcHRpb24sIFxuICBMb2dnZXIgXG59IGZyb20gJ0BuZXN0anMvY29tbW9uJztcbmltcG9ydCB7IFVzZXJzQ29udHJvbGxlciB9IGZyb20gJy4vdXNlcnMuY29udHJvbGxlcic7XG5pbXBvcnQgeyBVc2Vyc1NlcnZpY2UgfSBmcm9tICcuL3VzZXJzLnNlcnZpY2UnO1xuaW1wb3J0IHsgSnd0QXV0aEd1YXJkIH0gZnJvbSAnLi4vYXV0aC9ndWFyZHMvand0LWF1dGguZ3VhcmQnO1xuaW1wb3J0IHsgQWRtaW5BdXRoR3VhcmQgfSBmcm9tICcuLi9hdXRoL2d1YXJkcy9hZG1pbi1hdXRoLmd1YXJkJztcbmltcG9ydCB7IFN1cGFiYXNlU3RvcmFnZVNlcnZpY2UgfSBmcm9tICcuLi9jb21tb24vc2VydmljZXMvc3VwYWJhc2Utc3RvcmFnZS5zZXJ2aWNlJztcbmltcG9ydCB7IFJvbGVVdGlscyB9IGZyb20gJy4uL3V0aWxzL3JvbGUtdXRpbHMnO1xuaW1wb3J0IHsgWm9kVmFsaWRhdGlvblBpcGUgfSBmcm9tICcuLi9jb21tb24vcGlwZXMvem9kLXZhbGlkYXRpb24ucGlwZSc7XG5pbXBvcnQge1xuICBNb2NrQnVpbGRlcixcbiAgVGVzdERhdGFHZW5lcmF0b3IsXG4gIFRlc3RBc3NlcnRpb25zLFxuICBTZWN1cml0eUd1YXJkVGVzdFV0aWxzLFxuICBSb2xlQmFzZWRUZXN0VXRpbHMsXG4gIFRFU1RfVVNFUl9JRFMsXG4gIFRFU1RfRU1BSUxTLFxufSBmcm9tICcuLi90ZXN0LXV0aWxzL2F1dGgtdGVzdGluZy1oZWxwZXJzJztcblxuZGVzY3JpYmUoJ1VzZXJzQ29udHJvbGxlcicsICgpID0+IHtcbiAgbGV0IGNvbnRyb2xsZXI6IFVzZXJzQ29udHJvbGxlcjtcbiAgbGV0IHVzZXJzU2VydmljZTogVXNlcnNTZXJ2aWNlO1xuICBsZXQgc3VwYWJhc2VTdG9yYWdlU2VydmljZTogU3VwYWJhc2VTdG9yYWdlU2VydmljZTtcbiAgbGV0IHJvbGVVdGlsczogUm9sZVV0aWxzO1xuICBsZXQgbW9ja0p3dEF1dGhHdWFyZDogamVzdC5Nb2NrZWQ8Snd0QXV0aEd1YXJkPjtcbiAgbGV0IG1vY2tBZG1pbkF1dGhHdWFyZDogamVzdC5Nb2NrZWQ8QWRtaW5BdXRoR3VhcmQ+O1xuXG4gIC8vIFRlc3QgZGF0YSBjb25zdGFudHNcbiAgY29uc3QgbW9ja1VzZXIgPSB7XG4gICAgaWQ6IFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgIGVtYWlsOiBURVNUX0VNQUlMUy5DTElFTlQsXG4gICAgZmlyc3ROYW1lOiAnSm9obicsXG4gICAgbGFzdE5hbWU6ICdEb2UnLFxuICAgIHJvbGU6ICdjbGllbnQnLFxuICAgIGJpbzogJ1VzZXIgYmlvJyxcbiAgICBhdmF0YXJVcmw6ICdodHRwczovL2V4YW1wbGUuY29tL2F2YXRhci5qcGcnLFxuICAgIGNvdmVySW1hZ2VVcmw6ICdodHRwczovL2V4YW1wbGUuY29tL2NvdmVyLmpwZycsXG4gICAgcGhvbmVOdW1iZXI6ICcrMTIzNDU2Nzg5MCcsXG4gICAgdGltZXpvbmU6ICdBbWVyaWNhL05ld19Zb3JrJyxcbiAgICBsYW5ndWFnZTogJ2VuJyxcbiAgICB0aGVtZTogJ2xpZ2h0JyxcbiAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgIGVtYWlsVmVyaWZpZWQ6IHRydWUsXG4gICAgcHJvZmlsZUNvbXBsZXRlOiB0cnVlLFxuICAgIGlzQWN0aXZlOiB0cnVlLFxuICB9O1xuXG4gIGNvbnN0IG1vY2tBZG1pblVzZXIgPSB7XG4gICAgaWQ6IFRFU1RfVVNFUl9JRFMuQURNSU4sXG4gICAgZW1haWw6IFRFU1RfRU1BSUxTLkFETUlOLFxuICAgIGZpcnN0TmFtZTogJ0FkbWluJyxcbiAgICBsYXN0TmFtZTogJ1VzZXInLFxuICAgIHJvbGU6ICdhZG1pbicsXG4gICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICBlbWFpbFZlcmlmaWVkOiB0cnVlLFxuICAgIHByb2ZpbGVDb21wbGV0ZTogdHJ1ZSxcbiAgICBpc0FjdGl2ZTogdHJ1ZSxcbiAgfTtcblxuICBjb25zdCBtb2NrVXNlcnMgPSBbbW9ja1VzZXIsIG1vY2tBZG1pblVzZXJdO1xuXG4gIGNvbnN0IG1vY2tGaWxlID0ge1xuICAgIGZpZWxkbmFtZTogJ2F2YXRhcicsXG4gICAgb3JpZ2luYWxuYW1lOiAnYXZhdGFyLmpwZycsXG4gICAgZW5jb2Rpbmc6ICc3Yml0JyxcbiAgICBtaW1ldHlwZTogJ2ltYWdlL2pwZWcnLFxuICAgIHNpemU6IDEwMjQsXG4gICAgYnVmZmVyOiBCdWZmZXIuZnJvbSgndGVzdCBmaWxlIGNvbnRlbnQnKSxcbiAgfSBhcyBFeHByZXNzLk11bHRlci5GaWxlO1xuXG4gIGNvbnN0IG1vY2tVcGxvYWRSZXN1bHQgPSB7XG4gICAgdXJsOiAnaHR0cHM6Ly9leGFtcGxlLmNvbS91cGxvYWRlZC1hdmF0YXIuanBnJyxcbiAgICBmaWxlbmFtZTogJ2F2YXRhci5qcGcnLFxuICAgIHNpemU6IDEwMjQsXG4gIH07XG5cbiAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7XG4gICAgLy8gQ3JlYXRlIG1vY2sgc2VydmljZXNcbiAgICBjb25zdCBtb2NrVXNlcnNTZXJ2aWNlID0ge1xuICAgICAgZmluZEFsbDogamVzdC5mbigpLFxuICAgICAgZmluZEFsbEluY2x1ZGVJbmFjdGl2ZTogamVzdC5mbigpLFxuICAgICAgZmluZE9uZTogamVzdC5mbigpLFxuICAgICAgZmluZE9uZUluY2x1ZGVJbmFjdGl2ZTogamVzdC5mbigpLFxuICAgICAgdXBkYXRlOiBqZXN0LmZuKCksXG4gICAgICByZW1vdmU6IGplc3QuZm4oKSxcbiAgICAgIGRlYWN0aXZhdGU6IGplc3QuZm4oKSxcbiAgICAgIHJlYWN0aXZhdGU6IGplc3QuZm4oKSxcbiAgICB9O1xuXG4gICAgY29uc3QgbW9ja1N1cGFiYXNlU3RvcmFnZVNlcnZpY2UgPSB7XG4gICAgICB2YWxpZGF0ZUZpbGU6IGplc3QuZm4oKSxcbiAgICAgIHVwbG9hZEZpbGU6IGplc3QuZm4oKSxcbiAgICAgIGdldFN1cHBvcnRlZEJ1Y2tldHM6IGplc3QuZm4oKSxcbiAgICB9O1xuXG4gICAgY29uc3QgbW9ja1JvbGVVdGlscyA9IHtcbiAgICAgIGlzVXNlckFkbWluOiBqZXN0LmZuKCksXG4gICAgfTtcblxuICAgIG1vY2tKd3RBdXRoR3VhcmQgPSB7XG4gICAgICBjYW5BY3RpdmF0ZTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh0cnVlKSxcbiAgICB9IGFzIGFueTtcblxuICAgIG1vY2tBZG1pbkF1dGhHdWFyZCA9IHtcbiAgICAgIGNhbkFjdGl2YXRlOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHRydWUpLFxuICAgIH0gYXMgYW55O1xuXG4gICAgLy8gQWRkIHN0YXRpYyBtZXRob2QgbW9ja1xuICAgIFN1cGFiYXNlU3RvcmFnZVNlcnZpY2UuZ2V0U3VwcG9ydGVkQnVja2V0cyA9IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgVVNFUl9QUk9GSUxFUzogJ3VzZXItcHJvZmlsZXMnLFxuICAgIH0pO1xuXG4gICAgY29uc3QgbW9kdWxlOiBUZXN0aW5nTW9kdWxlID0gYXdhaXQgVGVzdC5jcmVhdGVUZXN0aW5nTW9kdWxlKHtcbiAgICAgIGNvbnRyb2xsZXJzOiBbVXNlcnNDb250cm9sbGVyXSxcbiAgICAgIHByb3ZpZGVyczogW1xuICAgICAgICB7XG4gICAgICAgICAgcHJvdmlkZTogVXNlcnNTZXJ2aWNlLFxuICAgICAgICAgIHVzZVZhbHVlOiBtb2NrVXNlcnNTZXJ2aWNlLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgcHJvdmlkZTogU3VwYWJhc2VTdG9yYWdlU2VydmljZSxcbiAgICAgICAgICB1c2VWYWx1ZTogbW9ja1N1cGFiYXNlU3RvcmFnZVNlcnZpY2UsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlOiBSb2xlVXRpbHMsXG4gICAgICAgICAgdXNlVmFsdWU6IG1vY2tSb2xlVXRpbHMsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlOiBMb2dnZXIsXG4gICAgICAgICAgdXNlVmFsdWU6IHtcbiAgICAgICAgICAgIGxvZzogamVzdC5mbigpLFxuICAgICAgICAgICAgZXJyb3I6IGplc3QuZm4oKSxcbiAgICAgICAgICAgIHdhcm46IGplc3QuZm4oKSxcbiAgICAgICAgICAgIGRlYnVnOiBqZXN0LmZuKCksXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSlcbiAgICAgIC5vdmVycmlkZUd1YXJkKEp3dEF1dGhHdWFyZClcbiAgICAgIC51c2VWYWx1ZShtb2NrSnd0QXV0aEd1YXJkKVxuICAgICAgLm92ZXJyaWRlR3VhcmQoQWRtaW5BdXRoR3VhcmQpXG4gICAgICAudXNlVmFsdWUobW9ja0FkbWluQXV0aEd1YXJkKVxuICAgICAgLmNvbXBpbGUoKTtcblxuICAgIGNvbnRyb2xsZXIgPSBtb2R1bGUuZ2V0PFVzZXJzQ29udHJvbGxlcj4oVXNlcnNDb250cm9sbGVyKTtcbiAgICB1c2Vyc1NlcnZpY2UgPSBtb2R1bGUuZ2V0PFVzZXJzU2VydmljZT4oVXNlcnNTZXJ2aWNlKTtcbiAgICBzdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlID0gbW9kdWxlLmdldDxTdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlPihTdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlKTtcbiAgICByb2xlVXRpbHMgPSBtb2R1bGUuZ2V0PFJvbGVVdGlscz4oUm9sZVV0aWxzKTtcbiAgfSk7XG5cbiAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2ZpbmRBbGwnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gYWxsIHVzZXJzIGZvciBhZG1pbicsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGplc3Quc3B5T24odXNlcnNTZXJ2aWNlLCAnZmluZEFsbCcpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVc2Vycyk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5maW5kQWxsKFRFU1RfVVNFUl9JRFMuQURNSU4pO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdCh1c2Vyc1NlcnZpY2UuZmluZEFsbCkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2NrVXNlcnMpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2VydmljZSBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcignRGF0YWJhc2UgZXJyb3InKTtcbiAgICAgIGplc3Quc3B5T24odXNlcnNTZXJ2aWNlLCAnZmluZEFsbCcpLm1vY2tSZWplY3RlZFZhbHVlKGVycm9yKTtcblxuICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICBhd2FpdCBleHBlY3QoY29udHJvbGxlci5maW5kQWxsKFRFU1RfVVNFUl9JRFMuQURNSU4pKS5yZWplY3RzLnRvVGhyb3coSHR0cEV4Y2VwdGlvbik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdmaW5kQWxsSW5jbHVkZUluYWN0aXZlJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIGFsbCB1c2VycyBpbmNsdWRpbmcgaW5hY3RpdmUgZm9yIGFkbWluJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja1VzZXJzID0gW1xuICAgICAgICBUZXN0RGF0YUdlbmVyYXRvci5jcmVhdGVVc2VyKHsgaXNBY3RpdmU6IHRydWUgfSksXG4gICAgICAgIFRlc3REYXRhR2VuZXJhdG9yLmNyZWF0ZVVzZXIoeyBpc0FjdGl2ZTogZmFsc2UgfSksXG4gICAgICBdO1xuXG4gICAgICB1c2Vyc1NlcnZpY2UuZmluZEFsbEluY2x1ZGVJbmFjdGl2ZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXNlcnMgYXMgYW55KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5maW5kQWxsSW5jbHVkZUluYWN0aXZlKFxuICAgICAgICBURVNUX1VTRVJfSURTLkFETUlOLFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHVzZXJzU2VydmljZS5maW5kQWxsSW5jbHVkZUluYWN0aXZlKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKG1vY2tVc2Vycyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzZXJ2aWNlIGVycm9ycyB3aGVuIGZldGNoaW5nIGFsbCB1c2VycycsIGFzeW5jICgpID0+IHtcbiAgICAgIHVzZXJzU2VydmljZS5maW5kQWxsSW5jbHVkZUluYWN0aXZlLm1vY2tSZWplY3RlZFZhbHVlKFxuICAgICAgICBuZXcgRXJyb3IoJ0RhdGFiYXNlIGNvbm5lY3Rpb24gZmFpbGVkJyksXG4gICAgICApO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIuZmluZEFsbEluY2x1ZGVJbmFjdGl2ZShURVNUX1VTRVJfSURTLkFETUlOKSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KEh0dHBFeGNlcHRpb24pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZmluZE9uZScsICgpID0+IHtcbiAgICBjb25zdCBtb2NrVXNlciA9IFRlc3REYXRhR2VuZXJhdG9yLmNyZWF0ZVVzZXIoeyBpZDogVEVTVF9VU0VSX0lEUy5DTElFTlQgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFsbG93IHVzZXIgdG8gdmlldyB0aGVpciBvd24gcHJvZmlsZScsIGFzeW5jICgpID0+IHtcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7XG4gICAgICB1c2Vyc1NlcnZpY2UuZmluZE9uZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXNlciBhcyBhbnkpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmZpbmRPbmUoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyb2xlVXRpbHMuaXNVc2VyQWRtaW4pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFRFU1RfVVNFUl9JRFMuQ0xJRU5UKTtcbiAgICAgIGV4cGVjdCh1c2Vyc1NlcnZpY2UuZmluZE9uZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoVEVTVF9VU0VSX0lEUy5DTElFTlQpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2NrVXNlcik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFsbG93IGFkbWluIHRvIHZpZXcgYW55IHVzZXIgcHJvZmlsZScsIGFzeW5jICgpID0+IHtcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZSh0cnVlKTtcbiAgICAgIHVzZXJzU2VydmljZS5maW5kT25lSW5jbHVkZUluYWN0aXZlLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVc2VyIGFzIGFueSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZmluZE9uZShcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQURNSU4sXG4gICAgICApO1xuXG4gICAgICBleHBlY3Qocm9sZVV0aWxzLmlzVXNlckFkbWluKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChURVNUX1VTRVJfSURTLkFETUlOKTtcbiAgICAgIGV4cGVjdCh1c2Vyc1NlcnZpY2UuZmluZE9uZUluY2x1ZGVJbmFjdGl2ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja1VzZXIpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0aHJvdyBGb3JiaWRkZW5FeGNlcHRpb24gd2hlbiBub24tYWRtaW4gdHJpZXMgdG8gdmlldyBvdGhlciB1c2VyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKGZhbHNlKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLmZpbmRPbmUoVEVTVF9VU0VSX0lEUy5USEVSQVBJU1QsIFRFU1RfVVNFUl9JRFMuQ0xJRU5UKSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KEZvcmJpZGRlbkV4Y2VwdGlvbik7XG5cbiAgICAgIGV4cGVjdCh1c2Vyc1NlcnZpY2UuZmluZE9uZSkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdGhyb3cgSHR0cEV4Y2VwdGlvbiB3aGVuIHVzZXIgbm90IGZvdW5kJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKGZhbHNlKTtcbiAgICAgIHVzZXJzU2VydmljZS5maW5kT25lLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIuZmluZE9uZShURVNUX1VTRVJfSURTLkNMSUVOVCwgVEVTVF9VU0VSX0lEUy5DTElFTlQpLFxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coSHR0cEV4Y2VwdGlvbik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCd1cGRhdGUnLCAoKSA9PiB7XG4gICAgY29uc3QgdXBkYXRlRGF0YSA9IHtcbiAgICAgIGZpcnN0TmFtZTogJ1VwZGF0ZWQnLFxuICAgICAgbGFzdE5hbWU6ICdOYW1lJyxcbiAgICAgIGJpbzogJ1VwZGF0ZWQgYmlvJyxcbiAgICB9O1xuXG4gICAgaXQoJ3Nob3VsZCBhbGxvdyB1c2VyIHRvIHVwZGF0ZSB0aGVpciBvd24gcHJvZmlsZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHVwZGF0ZWRVc2VyID0geyAuLi5UZXN0RGF0YUdlbmVyYXRvci5jcmVhdGVVc2VyKCksIC4uLnVwZGF0ZURhdGEgfTtcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7XG4gICAgICB1c2Vyc1NlcnZpY2UudXBkYXRlLm1vY2tSZXNvbHZlZFZhbHVlKHVwZGF0ZWRVc2VyIGFzIGFueSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIudXBkYXRlKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgdXBkYXRlRGF0YSxcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICApO1xuXG4gICAgICBleHBlY3Qocm9sZVV0aWxzLmlzVXNlckFkbWluKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChURVNUX1VTRVJfSURTLkNMSUVOVCk7XG4gICAgICBleHBlY3QodXNlcnNTZXJ2aWNlLnVwZGF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICB1cGRhdGVEYXRhLFxuICAgICAgKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwodXBkYXRlZFVzZXIpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhbGxvdyBhZG1pbiB0byB1cGRhdGUgYW55IHVzZXIgd2l0aCBhbGwgZmllbGRzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgYWRtaW5VcGRhdGVEYXRhID0ge1xuICAgICAgICBmaXJzdE5hbWU6ICdBZG1pbiBVcGRhdGVkJyxcbiAgICAgICAgcm9sZTogJ21vZGVyYXRvcicsXG4gICAgICAgIGlzQWN0aXZlOiBmYWxzZSxcbiAgICAgIH07XG4gICAgICBjb25zdCB1cGRhdGVkVXNlciA9IHtcbiAgICAgICAgLi4uVGVzdERhdGFHZW5lcmF0b3IuY3JlYXRlVXNlcigpLFxuICAgICAgICAuLi5hZG1pblVwZGF0ZURhdGEsXG4gICAgICB9O1xuXG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUodHJ1ZSk7XG4gICAgICB1c2Vyc1NlcnZpY2UudXBkYXRlLm1vY2tSZXNvbHZlZFZhbHVlKHVwZGF0ZWRVc2VyIGFzIGFueSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIudXBkYXRlKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgYWRtaW5VcGRhdGVEYXRhLFxuICAgICAgICBURVNUX1VTRVJfSURTLkFETUlOLFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHVzZXJzU2VydmljZS51cGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgYWRtaW5VcGRhdGVEYXRhLFxuICAgICAgKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwodXBkYXRlZFVzZXIpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzYW5pdGl6ZSBub24tYWRtaW4gdXBkYXRlcyB0byBhbGxvd2VkIGZpZWxkcyBvbmx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdW5hdXRob3JpemVkRGF0YSA9IHtcbiAgICAgICAgZmlyc3ROYW1lOiAnSm9obicsXG4gICAgICAgIHJvbGU6ICdhZG1pbicsIC8vIFNob3VsZCBiZSBmaWx0ZXJlZCBvdXRcbiAgICAgICAgaXNBY3RpdmU6IGZhbHNlLCAvLyBTaG91bGQgYmUgZmlsdGVyZWQgb3V0XG4gICAgICAgIGJpbzogJ05ldyBiaW8nLFxuICAgICAgfTtcbiAgICAgIGNvbnN0IHNhbml0aXplZERhdGEgPSB7XG4gICAgICAgIGZpcnN0TmFtZTogJ0pvaG4nLFxuICAgICAgICBiaW86ICdOZXcgYmlvJyxcbiAgICAgIH07XG4gICAgICBjb25zdCB1cGRhdGVkVXNlciA9IHtcbiAgICAgICAgLi4uVGVzdERhdGFHZW5lcmF0b3IuY3JlYXRlVXNlcigpLFxuICAgICAgICAuLi5zYW5pdGl6ZWREYXRhLFxuICAgICAgfTtcblxuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKGZhbHNlKTtcbiAgICAgIHVzZXJzU2VydmljZS51cGRhdGUubW9ja1Jlc29sdmVkVmFsdWUodXBkYXRlZFVzZXIgYXMgYW55KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci51cGRhdGUoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICB1bmF1dGhvcml6ZWREYXRhLFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdCh1c2Vyc1NlcnZpY2UudXBkYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgIHNhbml0aXplZERhdGEsXG4gICAgICApO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh1cGRhdGVkVXNlcik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IEZvcmJpZGRlbkV4Y2VwdGlvbiB3aGVuIG5vbi1hZG1pbiB0cmllcyB0byB1cGRhdGUgb3RoZXIgdXNlcicsIGFzeW5jICgpID0+IHtcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci51cGRhdGUoXG4gICAgICAgICAgVEVTVF9VU0VSX0lEUy5USEVSQVBJU1QsXG4gICAgICAgICAgdXBkYXRlRGF0YSxcbiAgICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgKSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KEZvcmJpZGRlbkV4Y2VwdGlvbik7XG5cbiAgICAgIGV4cGVjdCh1c2Vyc1NlcnZpY2UudXBkYXRlKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgncmVtb3ZlJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgYWxsb3cgdXNlciB0byBkZWFjdGl2YXRlIHRoZWlyIG93biBhY2NvdW50JywgYXN5bmMgKCkgPT4ge1xuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKGZhbHNlKTtcbiAgICAgIHVzZXJzU2VydmljZS5yZW1vdmUubW9ja1Jlc29sdmVkVmFsdWUoe30gYXMgYW55KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5yZW1vdmUoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyb2xlVXRpbHMuaXNVc2VyQWRtaW4pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFRFU1RfVVNFUl9JRFMuQ0xJRU5UKTtcbiAgICAgIGV4cGVjdCh1c2Vyc1NlcnZpY2UucmVtb3ZlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChURVNUX1VTRVJfSURTLkNMSUVOVCk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHtcbiAgICAgICAgbWVzc2FnZTogJ1VzZXIgYWNjb3VudCBkZWFjdGl2YXRlZCBzdWNjZXNzZnVsbHknLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFsbG93IGFkbWluIHRvIGRlYWN0aXZhdGUgYW55IHVzZXIgYWNjb3VudCcsIGFzeW5jICgpID0+IHtcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZSh0cnVlKTtcbiAgICAgIHVzZXJzU2VydmljZS5yZW1vdmUubW9ja1Jlc29sdmVkVmFsdWUoe30gYXMgYW55KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5yZW1vdmUoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICBURVNUX1VTRVJfSURTLkFETUlOLFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHVzZXJzU2VydmljZS5yZW1vdmUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFRFU1RfVVNFUl9JRFMuQ0xJRU5UKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoe1xuICAgICAgICBtZXNzYWdlOiAnVXNlciBhY2NvdW50IGRlYWN0aXZhdGVkIHN1Y2Nlc3NmdWxseScsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdGhyb3cgRm9yYmlkZGVuRXhjZXB0aW9uIHdoZW4gbm9uLWFkbWluIHRyaWVzIHRvIGRlYWN0aXZhdGUgb3RoZXIgdXNlcicsIGFzeW5jICgpID0+IHtcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5yZW1vdmUoVEVTVF9VU0VSX0lEUy5USEVSQVBJU1QsIFRFU1RfVVNFUl9JRFMuQ0xJRU5UKSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KEZvcmJpZGRlbkV4Y2VwdGlvbik7XG5cbiAgICAgIGV4cGVjdCh1c2Vyc1NlcnZpY2UucmVtb3ZlKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZGVhY3RpdmF0ZVVzZXIgKGFkbWluIG9ubHkpJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgYWxsb3cgYWRtaW4gdG8gZGVhY3RpdmF0ZSB1c2VyIHdpdGggcmVhc29uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZGVhY3RpdmF0aW9uQm9keSA9IHsgcmVhc29uOiAnUG9saWN5IHZpb2xhdGlvbicgfTtcbiAgICAgIHVzZXJzU2VydmljZS5kZWFjdGl2YXRlLm1vY2tSZXNvbHZlZFZhbHVlKHt9IGFzIGFueSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZGVhY3RpdmF0ZVVzZXIoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICBkZWFjdGl2YXRpb25Cb2R5LFxuICAgICAgICBURVNUX1VTRVJfSURTLkFETUlOLFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHVzZXJzU2VydmljZS5kZWFjdGl2YXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgICdQb2xpY3kgdmlvbGF0aW9uJyxcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5BRE1JTixcbiAgICAgICk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHtcbiAgICAgICAgbWVzc2FnZTogJ1VzZXIgYWNjb3VudCBkZWFjdGl2YXRlZCBieSBhZG1pbmlzdHJhdG9yJyxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZGVhY3RpdmF0aW9uIHdpdGhvdXQgcmVhc29uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZGVhY3RpdmF0aW9uQm9keSA9IHt9O1xuICAgICAgdXNlcnNTZXJ2aWNlLmRlYWN0aXZhdGUubW9ja1Jlc29sdmVkVmFsdWUoe30gYXMgYW55KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5kZWFjdGl2YXRlVXNlcihcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgIGRlYWN0aXZhdGlvbkJvZHksXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQURNSU4sXG4gICAgICApO1xuXG4gICAgICBleHBlY3QodXNlcnNTZXJ2aWNlLmRlYWN0aXZhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgdW5kZWZpbmVkLFxuICAgICAgICBURVNUX1VTRVJfSURTLkFETUlOLFxuICAgICAgKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoe1xuICAgICAgICBtZXNzYWdlOiAnVXNlciBhY2NvdW50IGRlYWN0aXZhdGVkIGJ5IGFkbWluaXN0cmF0b3InLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzZXJ2aWNlIGVycm9ycyBkdXJpbmcgZGVhY3RpdmF0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZGVhY3RpdmF0aW9uQm9keSA9IHsgcmVhc29uOiAnVGVzdCByZWFzb24nIH07XG4gICAgICB1c2Vyc1NlcnZpY2UuZGVhY3RpdmF0ZS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ1NlcnZpY2UgZXJyb3InKSk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5kZWFjdGl2YXRlVXNlcihcbiAgICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgICBkZWFjdGl2YXRpb25Cb2R5LFxuICAgICAgICAgIFRFU1RfVVNFUl9JRFMuQURNSU4sXG4gICAgICAgICksXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhIdHRwRXhjZXB0aW9uKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3JlYWN0aXZhdGVVc2VyIChhZG1pbiBvbmx5KScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGFsbG93IGFkbWluIHRvIHJlYWN0aXZhdGUgdXNlcicsIGFzeW5jICgpID0+IHtcbiAgICAgIHVzZXJzU2VydmljZS5yZWFjdGl2YXRlLm1vY2tSZXNvbHZlZFZhbHVlKHt9IGFzIGFueSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIucmVhY3RpdmF0ZVVzZXIoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICBURVNUX1VTRVJfSURTLkFETUlOLFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHVzZXJzU2VydmljZS5yZWFjdGl2YXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICApO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7XG4gICAgICAgIG1lc3NhZ2U6ICdVc2VyIGFjY291bnQgcmVhY3RpdmF0ZWQgc3VjY2Vzc2Z1bGx5JyxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2VydmljZSBlcnJvcnMgZHVyaW5nIHJlYWN0aXZhdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIHVzZXJzU2VydmljZS5yZWFjdGl2YXRlLm1vY2tSZWplY3RlZFZhbHVlKFxuICAgICAgICBuZXcgRXJyb3IoJ1JlYWN0aXZhdGlvbiBmYWlsZWQnKSxcbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5yZWFjdGl2YXRlVXNlcihURVNUX1VTRVJfSURTLkNMSUVOVCwgVEVTVF9VU0VSX0lEUy5BRE1JTiksXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhIdHRwRXhjZXB0aW9uKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2Vycm9yIGhhbmRsaW5nJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcHJlc2VydmUgRm9yYmlkZGVuRXhjZXB0aW9uIGZyb20gc2VydmljZSBsYXllcicsIGFzeW5jICgpID0+IHtcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZSh0cnVlKTtcbiAgICAgIHVzZXJzU2VydmljZS5maW5kT25lSW5jbHVkZUluYWN0aXZlLm1vY2tSZWplY3RlZFZhbHVlKFxuICAgICAgICBuZXcgRm9yYmlkZGVuRXhjZXB0aW9uKCdBY2Nlc3MgZGVuaWVkJyksXG4gICAgICApO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIuZmluZE9uZShURVNUX1VTRVJfSURTLkNMSUVOVCwgVEVTVF9VU0VSX0lEUy5BRE1JTiksXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhGb3JiaWRkZW5FeGNlcHRpb24pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB3cmFwIGdlbmVyaWMgZXJyb3JzIGluIEh0dHBFeGNlcHRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoZmFsc2UpO1xuICAgICAgdXNlcnNTZXJ2aWNlLmZpbmRPbmUubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdHZW5lcmljIGVycm9yJykpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIuZmluZE9uZShURVNUX1VTRVJfSURTLkNMSUVOVCwgVEVTVF9VU0VSX0lEUy5DTElFTlQpLFxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coSHR0cEV4Y2VwdGlvbik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSByb2xlIHV0aWxzIGVycm9ycyBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZWplY3RlZFZhbHVlKG5ldyBFcnJvcignUm9sZSBjaGVjayBmYWlsZWQnKSk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5maW5kT25lKFRFU1RfVVNFUl9JRFMuQ0xJRU5ULCBURVNUX1VTRVJfSURTLkNMSUVOVCksXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhIdHRwRXhjZXB0aW9uKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2F1dGhvcml6YXRpb24gZWRnZSBjYXNlcycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBlbXB0eSB1cGRhdGUgZGF0YSBmb3Igbm9uLWFkbWluJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKGZhbHNlKTtcbiAgICAgIHVzZXJzU2VydmljZS51cGRhdGUubW9ja1Jlc29sdmVkVmFsdWUoXG4gICAgICAgIFRlc3REYXRhR2VuZXJhdG9yLmNyZWF0ZVVzZXIoKSBhcyBhbnksXG4gICAgICApO1xuXG4gICAgICBhd2FpdCBjb250cm9sbGVyLnVwZGF0ZShURVNUX1VTRVJfSURTLkNMSUVOVCwge30sIFRFU1RfVVNFUl9JRFMuQ0xJRU5UKTtcblxuICAgICAgZXhwZWN0KHVzZXJzU2VydmljZS51cGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAge30sXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbWl4ZWQgYWxsb3dlZCBhbmQgZGlzYWxsb3dlZCBmaWVsZHMgZm9yIG5vbi1hZG1pbicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1peGVkRGF0YSA9IHtcbiAgICAgICAgZmlyc3ROYW1lOiAnSm9obicsIC8vIEFsbG93ZWRcbiAgICAgICAgbGFzdE5hbWU6ICdEb2UnLCAvLyBBbGxvd2VkXG4gICAgICAgIHJvbGU6ICdhZG1pbicsIC8vIE5vdCBhbGxvd2VkXG4gICAgICAgIGJpbzogJ05ldyBiaW8nLCAvLyBBbGxvd2VkXG4gICAgICAgIGlzQWN0aXZlOiBmYWxzZSwgLy8gTm90IGFsbG93ZWRcbiAgICAgICAgYXZhdGFyVXJsOiAnaHR0cDovL2V4YW1wbGUuY29tL2F2YXRhci5qcGcnLCAvLyBBbGxvd2VkXG4gICAgICB9O1xuICAgICAgY29uc3QgZXhwZWN0ZWRTYW5pdGl6ZWREYXRhID0ge1xuICAgICAgICBmaXJzdE5hbWU6ICdKb2huJyxcbiAgICAgICAgbGFzdE5hbWU6ICdEb2UnLFxuICAgICAgICBiaW86ICdOZXcgYmlvJyxcbiAgICAgICAgYXZhdGFyVXJsOiAnaHR0cDovL2V4YW1wbGUuY29tL2F2YXRhci5qcGcnLFxuICAgICAgfTtcblxuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKGZhbHNlKTtcbiAgICAgIHVzZXJzU2VydmljZS51cGRhdGUubW9ja1Jlc29sdmVkVmFsdWUoXG4gICAgICAgIFRlc3REYXRhR2VuZXJhdG9yLmNyZWF0ZVVzZXIoKSBhcyBhbnksXG4gICAgICApO1xuXG4gICAgICBhd2FpdCBjb250cm9sbGVyLnVwZGF0ZShcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgIG1peGVkRGF0YSxcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICApO1xuXG4gICAgICBleHBlY3QodXNlcnNTZXJ2aWNlLnVwZGF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICBleHBlY3RlZFNhbml0aXplZERhdGEsXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRmlsZSBVcGxvYWQgSW50ZWdyYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgYXZhdGFyIHVwbG9hZCBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBtb2NrRmlsZXMgPSB7XG4gICAgICAgIGF2YXRhcjogW21vY2tGaWxlXSxcbiAgICAgIH07XG4gICAgICBjb25zdCB1cGRhdGVEYXRhID0ge1xuICAgICAgICBmaXJzdE5hbWU6ICdKb2huJyxcbiAgICAgICAgbGFzdE5hbWU6ICdEb2UnLFxuICAgICAgfTtcblxuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKGZhbHNlKTtcbiAgICAgIHN1cGFiYXNlU3RvcmFnZVNlcnZpY2UudmFsaWRhdGVGaWxlLm1vY2tSZXR1cm5WYWx1ZSh7IGlzVmFsaWQ6IHRydWUgfSk7XG4gICAgICBzdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlLnVwbG9hZEZpbGUubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VwbG9hZFJlc3VsdCk7XG4gICAgICB1c2Vyc1NlcnZpY2UudXBkYXRlLm1vY2tSZXNvbHZlZFZhbHVlKFxuICAgICAgICBUZXN0RGF0YUdlbmVyYXRvci5jcmVhdGVVc2VyKCkgYXMgYW55LFxuICAgICAgKTtcblxuICAgICAgLy8gQWN0XG4gICAgICBhd2FpdCBjb250cm9sbGVyLnVwZGF0ZShcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgIHVwZGF0ZURhdGEsXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICBtb2NrRmlsZXMsXG4gICAgICApO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChzdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlLnZhbGlkYXRlRmlsZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgobW9ja0ZpbGUpO1xuICAgICAgZXhwZWN0KHN1cGFiYXNlU3RvcmFnZVNlcnZpY2UudXBsb2FkRmlsZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIG1vY2tGaWxlLFxuICAgICAgICAndXNlci1wcm9maWxlcycsXG4gICAgICApO1xuICAgICAgZXhwZWN0KHVzZXJzU2VydmljZS51cGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAge1xuICAgICAgICAgIC4uLnVwZGF0ZURhdGEsXG4gICAgICAgICAgYXZhdGFyVXJsOiBtb2NrVXBsb2FkUmVzdWx0LnVybCxcbiAgICAgICAgfSxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBjb3ZlciBpbWFnZSB1cGxvYWQgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgbW9ja0NvdmVyRmlsZSA9IHtcbiAgICAgICAgLi4ubW9ja0ZpbGUsXG4gICAgICAgIGZpZWxkbmFtZTogJ2NvdmVyJyxcbiAgICAgICAgb3JpZ2luYWxuYW1lOiAnY292ZXIuanBnJyxcbiAgICAgIH07XG4gICAgICBjb25zdCBtb2NrRmlsZXMgPSB7XG4gICAgICAgIGNvdmVyOiBbbW9ja0NvdmVyRmlsZV0sXG4gICAgICB9O1xuICAgICAgY29uc3QgdXBkYXRlRGF0YSA9IHtcbiAgICAgICAgZmlyc3ROYW1lOiAnSm9obicsXG4gICAgICAgIGxhc3ROYW1lOiAnRG9lJyxcbiAgICAgIH07XG5cbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7XG4gICAgICBzdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlLnZhbGlkYXRlRmlsZS5tb2NrUmV0dXJuVmFsdWUoeyBpc1ZhbGlkOiB0cnVlIH0pO1xuICAgICAgc3VwYWJhc2VTdG9yYWdlU2VydmljZS51cGxvYWRGaWxlLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVcGxvYWRSZXN1bHQpO1xuICAgICAgdXNlcnNTZXJ2aWNlLnVwZGF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZShcbiAgICAgICAgVGVzdERhdGFHZW5lcmF0b3IuY3JlYXRlVXNlcigpIGFzIGFueSxcbiAgICAgICk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgYXdhaXQgY29udHJvbGxlci51cGRhdGUoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICB1cGRhdGVEYXRhLFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgbW9ja0ZpbGVzLFxuICAgICAgKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3Qoc3VwYWJhc2VTdG9yYWdlU2VydmljZS52YWxpZGF0ZUZpbGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKG1vY2tDb3ZlckZpbGUpO1xuICAgICAgZXhwZWN0KHN1cGFiYXNlU3RvcmFnZVNlcnZpY2UudXBsb2FkRmlsZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIG1vY2tDb3ZlckZpbGUsXG4gICAgICAgICd1c2VyLXByb2ZpbGVzJyxcbiAgICAgICk7XG4gICAgICBleHBlY3QodXNlcnNTZXJ2aWNlLnVwZGF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICB7XG4gICAgICAgICAgLi4udXBkYXRlRGF0YSxcbiAgICAgICAgICBjb3ZlckltYWdlVXJsOiBtb2NrVXBsb2FkUmVzdWx0LnVybCxcbiAgICAgICAgfSxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBtdWx0aXBsZSBmaWxlIHVwbG9hZHMgc2ltdWx0YW5lb3VzbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBtb2NrQ292ZXJGaWxlID0ge1xuICAgICAgICAuLi5tb2NrRmlsZSxcbiAgICAgICAgZmllbGRuYW1lOiAnY292ZXInLFxuICAgICAgICBvcmlnaW5hbG5hbWU6ICdjb3Zlci5qcGcnLFxuICAgICAgfTtcbiAgICAgIGNvbnN0IG1vY2tGaWxlcyA9IHtcbiAgICAgICAgYXZhdGFyOiBbbW9ja0ZpbGVdLFxuICAgICAgICBjb3ZlcjogW21vY2tDb3ZlckZpbGVdLFxuICAgICAgfTtcbiAgICAgIGNvbnN0IHVwZGF0ZURhdGEgPSB7XG4gICAgICAgIGZpcnN0TmFtZTogJ0pvaG4nLFxuICAgICAgICBsYXN0TmFtZTogJ0RvZScsXG4gICAgICB9O1xuXG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoZmFsc2UpO1xuICAgICAgc3VwYWJhc2VTdG9yYWdlU2VydmljZS52YWxpZGF0ZUZpbGUubW9ja1JldHVyblZhbHVlKHsgaXNWYWxpZDogdHJ1ZSB9KTtcbiAgICAgIHN1cGFiYXNlU3RvcmFnZVNlcnZpY2UudXBsb2FkRmlsZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXBsb2FkUmVzdWx0KTtcbiAgICAgIHVzZXJzU2VydmljZS51cGRhdGUubW9ja1Jlc29sdmVkVmFsdWUoXG4gICAgICAgIFRlc3REYXRhR2VuZXJhdG9yLmNyZWF0ZVVzZXIoKSBhcyBhbnksXG4gICAgICApO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGF3YWl0IGNvbnRyb2xsZXIudXBkYXRlKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgdXBkYXRlRGF0YSxcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgIG1vY2tGaWxlcyxcbiAgICAgICk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHN1cGFiYXNlU3RvcmFnZVNlcnZpY2UudmFsaWRhdGVGaWxlKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMik7XG4gICAgICBleHBlY3Qoc3VwYWJhc2VTdG9yYWdlU2VydmljZS51cGxvYWRGaWxlKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMik7XG4gICAgICBleHBlY3QodXNlcnNTZXJ2aWNlLnVwZGF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICB7XG4gICAgICAgICAgLi4udXBkYXRlRGF0YSxcbiAgICAgICAgICBhdmF0YXJVcmw6IG1vY2tVcGxvYWRSZXN1bHQudXJsLFxuICAgICAgICAgIGNvdmVySW1hZ2VVcmw6IG1vY2tVcGxvYWRSZXN1bHQudXJsLFxuICAgICAgICB9LFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGZpbGUgdmFsaWRhdGlvbiBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBtb2NrRmlsZXMgPSB7XG4gICAgICAgIGF2YXRhcjogW21vY2tGaWxlXSxcbiAgICAgIH07XG4gICAgICBjb25zdCB1cGRhdGVEYXRhID0ge1xuICAgICAgICBmaXJzdE5hbWU6ICdKb2huJyxcbiAgICAgICAgbGFzdE5hbWU6ICdEb2UnLFxuICAgICAgfTtcblxuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKGZhbHNlKTtcbiAgICAgIHN1cGFiYXNlU3RvcmFnZVNlcnZpY2UudmFsaWRhdGVGaWxlLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgIGlzVmFsaWQ6IGZhbHNlLFxuICAgICAgICBlcnJvcjogJ0ZpbGUgdG9vIGxhcmdlJyxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci51cGRhdGUoXG4gICAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgICAgdXBkYXRlRGF0YSxcbiAgICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgICBtb2NrRmlsZXMsXG4gICAgICAgICksXG4gICAgICApLnJlamVjdHMudG9UaHJvdygnQXZhdGFyIHZhbGlkYXRpb24gZmFpbGVkOiBGaWxlIHRvbyBsYXJnZScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZmlsZSB1cGxvYWQgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgbW9ja0ZpbGVzID0ge1xuICAgICAgICBhdmF0YXI6IFttb2NrRmlsZV0sXG4gICAgICB9O1xuICAgICAgY29uc3QgdXBkYXRlRGF0YSA9IHtcbiAgICAgICAgZmlyc3ROYW1lOiAnSm9obicsXG4gICAgICAgIGxhc3ROYW1lOiAnRG9lJyxcbiAgICAgIH07XG5cbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7XG4gICAgICBzdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlLnZhbGlkYXRlRmlsZS5tb2NrUmV0dXJuVmFsdWUoeyBpc1ZhbGlkOiB0cnVlIH0pO1xuICAgICAgc3VwYWJhc2VTdG9yYWdlU2VydmljZS51cGxvYWRGaWxlLm1vY2tSZWplY3RlZFZhbHVlKG5ldyBFcnJvcignVXBsb2FkIGZhaWxlZCcpKTtcblxuICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIudXBkYXRlKFxuICAgICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICAgIHVwZGF0ZURhdGEsXG4gICAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgICAgbW9ja0ZpbGVzLFxuICAgICAgICApLFxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coJ0ZhaWxlZCB0byB1cGRhdGUgdXNlcjogVXBsb2FkIGZhaWxlZCcpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnU2VjdXJpdHkgVGVzdHMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBpbnB1dCBkYXRhIHRocm91Z2ggWm9kVmFsaWRhdGlvblBpcGUnLCAoKSA9PiB7XG4gICAgICAvLyBUaGlzIHRlc3RzIHRoYXQgdGhlIGNvbnRyb2xsZXIgdXNlcyBwcm9wZXIgdmFsaWRhdGlvblxuICAgICAgY29uc3QgdmFsaWRhdGlvblBpcGUgPSBuZXcgWm9kVmFsaWRhdGlvblBpcGUoe30gYXMgYW55KTtcbiAgICAgIGV4cGVjdCh2YWxpZGF0aW9uUGlwZSkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVxdWlyZSBhdXRoZW50aWNhdGlvbiBmb3IgYWxsIGVuZHBvaW50cycsICgpID0+IHtcbiAgICAgIC8vIFRlc3QgdGhhdCBhbGwgZW5kcG9pbnRzIGhhdmUgSnd0QXV0aEd1YXJkXG4gICAgICBjb25zdCBwcm90ZWN0ZWRNZXRob2RzID0gWydmaW5kQWxsJywgJ2ZpbmRBbGxJbmNsdWRlSW5hY3RpdmUnLCAnZmluZE9uZScsICd1cGRhdGUnLCAncmVtb3ZlJywgJ2RlYWN0aXZhdGVVc2VyJywgJ3JlYWN0aXZhdGVVc2VyJ107XG4gICAgICBcbiAgICAgIHByb3RlY3RlZE1ldGhvZHMuZm9yRWFjaChtZXRob2QgPT4ge1xuICAgICAgICBjb25zdCBndWFyZHMgPSBSZWZsZWN0LmdldE1ldGFkYXRhKCdfX2d1YXJkc19fJywgY29udHJvbGxlclttZXRob2QgYXMga2V5b2YgVXNlcnNDb250cm9sbGVyXSk7XG4gICAgICAgIGV4cGVjdChndWFyZHMpLnRvQmVEZWZpbmVkKCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZW5mb3JjZSBhZG1pbi1vbmx5IGFjY2VzcyBmb3IgYWRtaW4gZW5kcG9pbnRzJywgKCkgPT4ge1xuICAgICAgLy8gVGVzdCB0aGF0IGFkbWluIGVuZHBvaW50cyBoYXZlIEFkbWluQXV0aEd1YXJkXG4gICAgICBjb25zdCBhZG1pbk1ldGhvZHMgPSBbJ2ZpbmRBbGwnLCAnZmluZEFsbEluY2x1ZGVJbmFjdGl2ZScsICdkZWFjdGl2YXRlVXNlcicsICdyZWFjdGl2YXRlVXNlciddO1xuICAgICAgXG4gICAgICBhZG1pbk1ldGhvZHMuZm9yRWFjaChtZXRob2QgPT4ge1xuICAgICAgICBjb25zdCBndWFyZHMgPSBSZWZsZWN0LmdldE1ldGFkYXRhKCdfX2d1YXJkc19fJywgY29udHJvbGxlclttZXRob2QgYXMga2V5b2YgVXNlcnNDb250cm9sbGVyXSk7XG4gICAgICAgIGV4cGVjdChndWFyZHMpLnRvQmVEZWZpbmVkKCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIEpXVCB0b2tlbiB2YWxpZGF0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gVGVzdCB0aGF0IEpXVCBndWFyZCBpcyBwcm9wZXJseSBhcHBsaWVkXG4gICAgICBtb2NrSnd0QXV0aEd1YXJkLmNhbkFjdGl2YXRlLm1vY2tSZXR1cm5WYWx1ZShmYWxzZSk7XG4gICAgICBcbiAgICAgIC8vIE1vY2sgdGhlIGFjdHVhbCBIVFRQIGV4Y2VwdGlvbiB0aGF0IHdvdWxkIGJlIHRocm93blxuICAgICAgY29uc3QgdW5hdXRob3JpemVkRXJyb3IgPSBuZXcgRXJyb3IoJ1VuYXV0aG9yaXplZCcpO1xuICAgICAgdXNlcnNTZXJ2aWNlLmZpbmRBbGwubW9ja1JlamVjdGVkVmFsdWUodW5hdXRob3JpemVkRXJyb3IpO1xuICAgICAgXG4gICAgICBhd2FpdCBleHBlY3QoY29udHJvbGxlci5maW5kQWxsKFRFU1RfVVNFUl9JRFMuQURNSU4pKS5yZWplY3RzLnRvVGhyb3coKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGFkbWluIGF1dGhvcml6YXRpb24gdmFsaWRhdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFRlc3QgdGhhdCBhZG1pbiBndWFyZCBpcyBwcm9wZXJseSBhcHBsaWVkXG4gICAgICBtb2NrQWRtaW5BdXRoR3VhcmQuY2FuQWN0aXZhdGUubW9ja1JldHVyblZhbHVlKGZhbHNlKTtcbiAgICAgIFxuICAgICAgLy8gTW9jayB0aGUgYWN0dWFsIEhUVFAgZXhjZXB0aW9uIHRoYXQgd291bGQgYmUgdGhyb3duXG4gICAgICBjb25zdCBmb3JiaWRkZW5FcnJvciA9IG5ldyBFcnJvcignRm9yYmlkZGVuJyk7XG4gICAgICB1c2Vyc1NlcnZpY2UuZmluZEFsbC5tb2NrUmVqZWN0ZWRWYWx1ZShmb3JiaWRkZW5FcnJvcik7XG4gICAgICBcbiAgICAgIGF3YWl0IGV4cGVjdChjb250cm9sbGVyLmZpbmRBbGwoVEVTVF9VU0VSX0lEUy5BRE1JTikpLnJlamVjdHMudG9UaHJvdygpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBwcmV2ZW50IHVuYXV0aG9yaXplZCBhY2Nlc3MgdG8gb3RoZXIgdXNlciBwcm9maWxlcycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFRlc3QgdGhhdCB1c2VycyBjYW4gb25seSBhY2Nlc3MgdGhlaXIgb3duIHByb2ZpbGVcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7XG4gICAgICBcbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5maW5kT25lKFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNULCBURVNUX1VTRVJfSURTLkNMSUVOVCksXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhGb3JiaWRkZW5FeGNlcHRpb24pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUm9sZS1iYXNlZCBBY2Nlc3MgQ29udHJvbCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHRlc3Qgcm9sZS1iYXNlZCBhY2Nlc3MgZm9yIGFkbWluIGVuZHBvaW50cycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFRlc3QgdGhhdCBhZG1pbiBlbmRwb2ludHMgcmVxdWlyZSBhZG1pbiByb2xlXG4gICAgICBhd2FpdCBSb2xlQmFzZWRUZXN0VXRpbHMudGVzdFdpdGhSb2xlcyhcbiAgICAgICAgYXN5bmMgKHVzZXJJZDogc3RyaW5nLCByb2xlOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgY29udHJvbGxlci5maW5kQWxsKHVzZXJJZCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIGNsaWVudDogZmFsc2UsXG4gICAgICAgICAgdGhlcmFwaXN0OiBmYWxzZSxcbiAgICAgICAgICBhZG1pbjogdHJ1ZSxcbiAgICAgICAgICBtb2RlcmF0b3I6IGZhbHNlLFxuICAgICAgICB9LFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgdXNlci1zcGVjaWZpYyBmdW5jdGlvbmFsaXR5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gVGVzdCB0aGF0IHVzZXJzIGNhbiBhY2Nlc3MgdGhlaXIgb3duIHByb2ZpbGVcbiAgICAgIGNvbnN0IHVzZXJDb250ZXh0ID0gTW9ja0J1aWxkZXIuY3JlYXRlQXV0aENvbnRleHQoJ2NsaWVudCcpO1xuICAgICAgXG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoZmFsc2UpO1xuICAgICAgdXNlcnNTZXJ2aWNlLmZpbmRPbmUubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXIgYXMgYW55KTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5maW5kT25lKHVzZXJDb250ZXh0LnVzZXJJZCwgdXNlckNvbnRleHQudXNlcklkKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuaWQpLnRvQmUodXNlckNvbnRleHQudXNlcklkKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdGVzdCBmaWVsZCBzYW5pdGl6YXRpb24gZm9yIG5vbi1hZG1pbiB1c2VycycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFRlc3QgdGhhdCBub24tYWRtaW4gdXNlcnMgY2Fubm90IHVwZGF0ZSBzZW5zaXRpdmUgZmllbGRzXG4gICAgICBjb25zdCBzZW5zaXRpdmVEYXRhID0ge1xuICAgICAgICBmaXJzdE5hbWU6ICdKb2huJyxcbiAgICAgICAgcm9sZTogJ2FkbWluJywgLy8gU2hvdWxkIGJlIGZpbHRlcmVkIG91dFxuICAgICAgICBpc0FjdGl2ZTogZmFsc2UsIC8vIFNob3VsZCBiZSBmaWx0ZXJlZCBvdXRcbiAgICAgICAgZW1haWxWZXJpZmllZDogdHJ1ZSwgLy8gU2hvdWxkIGJlIGZpbHRlcmVkIG91dFxuICAgICAgfTtcbiAgICAgIFxuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKGZhbHNlKTtcbiAgICAgIHVzZXJzU2VydmljZS51cGRhdGUubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXIgYXMgYW55KTtcbiAgICAgIFxuICAgICAgYXdhaXQgY29udHJvbGxlci51cGRhdGUoVEVTVF9VU0VSX0lEUy5DTElFTlQsIHNlbnNpdGl2ZURhdGEsIFRFU1RfVVNFUl9JRFMuQ0xJRU5UKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHVzZXJzU2VydmljZS51cGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgeyBmaXJzdE5hbWU6ICdKb2huJyB9LCAvLyBPbmx5IGFsbG93ZWQgZmllbGRzXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnSW50ZWdyYXRpb24gVGVzdHMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgY29tcGxldGUgdXNlciBwcm9maWxlIHVwZGF0ZSB3b3JrZmxvdycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IHVwZGF0ZURhdGEgPSB7XG4gICAgICAgIGZpcnN0TmFtZTogJ1VwZGF0ZWQnLFxuICAgICAgICBsYXN0TmFtZTogJ05hbWUnLFxuICAgICAgICBiaW86ICdVcGRhdGVkIGJpbycsXG4gICAgICAgIHRpbWV6b25lOiAnQW1lcmljYS9Mb3NfQW5nZWxlcycsXG4gICAgICAgIGxhbmd1YWdlOiAnZW4nLFxuICAgICAgICB0aGVtZTogJ2RhcmsnLFxuICAgICAgfTtcbiAgICAgIGNvbnN0IHVwZGF0ZWRVc2VyID0geyAuLi5tb2NrVXNlciwgLi4udXBkYXRlRGF0YSB9O1xuICAgICAgXG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoZmFsc2UpO1xuICAgICAgdXNlcnNTZXJ2aWNlLnVwZGF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh1cGRhdGVkVXNlciBhcyBhbnkpO1xuICAgICAgXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIudXBkYXRlKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgdXBkYXRlRGF0YSxcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICApO1xuICAgICAgXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QocmVzdWx0LmZpcnN0TmFtZSkudG9CZSgnVXBkYXRlZCcpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5sYXN0TmFtZSkudG9CZSgnTmFtZScpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5iaW8pLnRvQmUoJ1VwZGF0ZWQgYmlvJyk7XG4gICAgICBleHBlY3QocmVzdWx0LnRpbWV6b25lKS50b0JlKCdBbWVyaWNhL0xvc19BbmdlbGVzJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBjb21wbGV0ZSBhZG1pbiB1c2VyIG1hbmFnZW1lbnQgd29ya2Zsb3cnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUodHJ1ZSk7XG4gICAgICB1c2Vyc1NlcnZpY2UuZmluZEFsbC5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXNlcnMgYXMgYW55KTtcbiAgICAgIHVzZXJzU2VydmljZS5maW5kQWxsSW5jbHVkZUluYWN0aXZlLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVc2VycyBhcyBhbnkpO1xuICAgICAgdXNlcnNTZXJ2aWNlLmZpbmRPbmVJbmNsdWRlSW5hY3RpdmUubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXIgYXMgYW55KTtcbiAgICAgIFxuICAgICAgLy8gQWN0IC0gR2V0IGFsbCB1c2Vyc1xuICAgICAgY29uc3QgYWxsVXNlcnMgPSBhd2FpdCBjb250cm9sbGVyLmZpbmRBbGwoVEVTVF9VU0VSX0lEUy5BRE1JTik7XG4gICAgICBcbiAgICAgIC8vIEFjdCAtIEdldCBhbGwgdXNlcnMgaW5jbHVkaW5nIGluYWN0aXZlXG4gICAgICBjb25zdCBhbGxVc2Vyc0luY2x1ZGVJbmFjdGl2ZSA9IGF3YWl0IGNvbnRyb2xsZXIuZmluZEFsbEluY2x1ZGVJbmFjdGl2ZShURVNUX1VTRVJfSURTLkFETUlOKTtcbiAgICAgIFxuICAgICAgLy8gQWN0IC0gVmlldyBzcGVjaWZpYyB1c2VyXG4gICAgICBjb25zdCBzcGVjaWZpY1VzZXIgPSBhd2FpdCBjb250cm9sbGVyLmZpbmRPbmUoVEVTVF9VU0VSX0lEUy5DTElFTlQsIFRFU1RfVVNFUl9JRFMuQURNSU4pO1xuICAgICAgXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChhbGxVc2VycykudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChhbGxVc2VycykudG9IYXZlTGVuZ3RoKDIpO1xuICAgICAgXG4gICAgICBleHBlY3QoYWxsVXNlcnNJbmNsdWRlSW5hY3RpdmUpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoYWxsVXNlcnNJbmNsdWRlSW5hY3RpdmUpLnRvSGF2ZUxlbmd0aCgyKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHNwZWNpZmljVXNlcikudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChzcGVjaWZpY1VzZXIuaWQpLnRvQmUoVEVTVF9VU0VSX0lEUy5DTElFTlQpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgY29tcGxldGUgdXNlciBkZWFjdGl2YXRpb24gd29ya2Zsb3cnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUodHJ1ZSk7XG4gICAgICB1c2Vyc1NlcnZpY2UuZGVhY3RpdmF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7fSBhcyBhbnkpO1xuICAgICAgXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZGVhY3RpdmF0ZVVzZXIoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICB7IHJlYXNvbjogJ1BvbGljeSB2aW9sYXRpb24nIH0sXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQURNSU4sXG4gICAgICApO1xuICAgICAgXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QocmVzdWx0Lm1lc3NhZ2UpLnRvQmUoJ1VzZXIgYWNjb3VudCBkZWFjdGl2YXRlZCBieSBhZG1pbmlzdHJhdG9yJyk7XG4gICAgICBleHBlY3QodXNlcnNTZXJ2aWNlLmRlYWN0aXZhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgJ1BvbGljeSB2aW9sYXRpb24nLFxuICAgICAgICBURVNUX1VTRVJfSURTLkFETUlOLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbXBsZXRlIHVzZXIgcmVhY3RpdmF0aW9uIHdvcmtmbG93JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKHRydWUpO1xuICAgICAgdXNlcnNTZXJ2aWNlLnJlYWN0aXZhdGUubW9ja1Jlc29sdmVkVmFsdWUoe30gYXMgYW55KTtcbiAgICAgIFxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLnJlYWN0aXZhdGVVc2VyKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5BRE1JTixcbiAgICAgICk7XG4gICAgICBcbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQubWVzc2FnZSkudG9CZSgnVXNlciBhY2NvdW50IHJlYWN0aXZhdGVkIHN1Y2Nlc3NmdWxseScpO1xuICAgICAgZXhwZWN0KHVzZXJzU2VydmljZS5yZWFjdGl2YXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChURVNUX1VTRVJfSURTLkNMSUVOVCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdEYXRhIFZhbGlkYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSB1c2VyIHVwZGF0ZSBkYXRhIHN0cnVjdHVyZScsICgpID0+IHtcbiAgICAgIC8vIFRlc3QgdGhhdCB3ZSdyZSB1c2luZyB0aGUgY29ycmVjdCBEVE8gc3RydWN0dXJlXG4gICAgICBjb25zdCB2YWxpZFVwZGF0ZURhdGEgPSB7XG4gICAgICAgIGZpcnN0TmFtZTogJ0pvaG4nLFxuICAgICAgICBsYXN0TmFtZTogJ0RvZScsXG4gICAgICAgIGJpbzogJ1VzZXIgYmlvJyxcbiAgICAgICAgYXZhdGFyVXJsOiAnaHR0cHM6Ly9leGFtcGxlLmNvbS9hdmF0YXIuanBnJyxcbiAgICAgICAgY292ZXJJbWFnZVVybDogJ2h0dHBzOi8vZXhhbXBsZS5jb20vY292ZXIuanBnJyxcbiAgICAgICAgcGhvbmVOdW1iZXI6ICcrMTIzNDU2Nzg5MCcsXG4gICAgICAgIHRpbWV6b25lOiAnQW1lcmljYS9OZXdfWW9yaycsXG4gICAgICAgIGxhbmd1YWdlOiAnZW4nLFxuICAgICAgICB0aGVtZTogJ2xpZ2h0JyxcbiAgICAgIH07XG4gICAgICBcbiAgICAgIC8vIFZlcmlmeSBhbGwgZmllbGRzIGFyZSBkZWZpbmVkXG4gICAgICBleHBlY3QodmFsaWRVcGRhdGVEYXRhLmZpcnN0TmFtZSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdCh2YWxpZFVwZGF0ZURhdGEubGFzdE5hbWUpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QodmFsaWRVcGRhdGVEYXRhLmJpbykudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdCh2YWxpZFVwZGF0ZURhdGEuYXZhdGFyVXJsKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHZhbGlkVXBkYXRlRGF0YS5jb3ZlckltYWdlVXJsKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHZhbGlkVXBkYXRlRGF0YS5waG9uZU51bWJlcikudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdCh2YWxpZFVwZGF0ZURhdGEudGltZXpvbmUpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QodmFsaWRVcGRhdGVEYXRhLmxhbmd1YWdlKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHZhbGlkVXBkYXRlRGF0YS50aGVtZSkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgZGVhY3RpdmF0aW9uIGRhdGEgc3RydWN0dXJlJywgKCkgPT4ge1xuICAgICAgLy8gVGVzdCB0aGF0IHdlJ3JlIHVzaW5nIHRoZSBjb3JyZWN0IERUTyBzdHJ1Y3R1cmVcbiAgICAgIGNvbnN0IHZhbGlkRGVhY3RpdmF0aW9uRGF0YSA9IHtcbiAgICAgICAgcmVhc29uOiAnUG9saWN5IHZpb2xhdGlvbicsXG4gICAgICB9O1xuICAgICAgXG4gICAgICAvLyBWZXJpZnkgYWxsIGZpZWxkcyBhcmUgZGVmaW5lZFxuICAgICAgZXhwZWN0KHZhbGlkRGVhY3RpdmF0aW9uRGF0YS5yZWFzb24pLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIHVzZXIgSUQgcGFyYW1ldGVyIHN0cnVjdHVyZScsICgpID0+IHtcbiAgICAgIC8vIFRlc3QgdGhhdCB3ZSdyZSB1c2luZyB0aGUgY29ycmVjdCBwYXJhbWV0ZXIgc3RydWN0dXJlXG4gICAgICBjb25zdCB2YWxpZFVzZXJJZFBhcmFtID0ge1xuICAgICAgICBpZDogVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICB9O1xuICAgICAgXG4gICAgICAvLyBWZXJpZnkgYWxsIGZpZWxkcyBhcmUgZGVmaW5lZFxuICAgICAgZXhwZWN0KHZhbGlkVXNlcklkUGFyYW0uaWQpLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdSZXNwb25zZSBGb3JtYXQgVmFsaWRhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiBjb3JyZWN0bHkgZm9ybWF0dGVkIHVzZXIgbGlzdCByZXNwb25zZScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZSh0cnVlKTtcbiAgICAgIHVzZXJzU2VydmljZS5maW5kQWxsLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVc2VycyBhcyBhbnkpO1xuICAgICAgXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZmluZEFsbChURVNUX1VTRVJfSURTLkFETUlOKTtcbiAgICAgIFxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlSW5zdGFuY2VPZihBcnJheSk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVMZW5ndGgoMik7XG4gICAgICBcbiAgICAgIGNvbnN0IHVzZXIgPSByZXN1bHRbMF07XG4gICAgICBleHBlY3QodXNlcikudG9IYXZlUHJvcGVydHkoJ2lkJyk7XG4gICAgICBleHBlY3QodXNlcikudG9IYXZlUHJvcGVydHkoJ2VtYWlsJyk7XG4gICAgICBleHBlY3QodXNlcikudG9IYXZlUHJvcGVydHkoJ2ZpcnN0TmFtZScpO1xuICAgICAgZXhwZWN0KHVzZXIpLnRvSGF2ZVByb3BlcnR5KCdsYXN0TmFtZScpO1xuICAgICAgZXhwZWN0KHVzZXIpLnRvSGF2ZVByb3BlcnR5KCdyb2xlJyk7XG4gICAgICBleHBlY3QodXNlcikudG9IYXZlUHJvcGVydHkoJ2NyZWF0ZWRBdCcpO1xuICAgICAgZXhwZWN0KHVzZXIpLnRvSGF2ZVByb3BlcnR5KCdpc0FjdGl2ZScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gY29ycmVjdGx5IGZvcm1hdHRlZCB1c2VyIHByb2ZpbGUgcmVzcG9uc2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoZmFsc2UpO1xuICAgICAgdXNlcnNTZXJ2aWNlLmZpbmRPbmUubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXIgYXMgYW55KTtcbiAgICAgIFxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmZpbmRPbmUoVEVTVF9VU0VSX0lEUy5DTElFTlQsIFRFU1RfVVNFUl9JRFMuQ0xJRU5UKTtcbiAgICAgIFxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgnaWQnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdlbWFpbCcpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ2ZpcnN0TmFtZScpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ2xhc3ROYW1lJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgncm9sZScpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ2JpbycpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ2F2YXRhclVybCcpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ2NvdmVySW1hZ2VVcmwnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdwaG9uZU51bWJlcicpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ3RpbWV6b25lJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgnbGFuZ3VhZ2UnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCd0aGVtZScpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ2NyZWF0ZWRBdCcpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ3VwZGF0ZWRBdCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gY29ycmVjdGx5IGZvcm1hdHRlZCB1cGRhdGUgcmVzcG9uc2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCB1cGRhdGVEYXRhID0ge1xuICAgICAgICBmaXJzdE5hbWU6ICdVcGRhdGVkJyxcbiAgICAgICAgbGFzdE5hbWU6ICdOYW1lJyxcbiAgICAgIH07XG4gICAgICBjb25zdCB1cGRhdGVkVXNlciA9IHsgLi4ubW9ja1VzZXIsIC4uLnVwZGF0ZURhdGEgfTtcbiAgICAgIFxuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKGZhbHNlKTtcbiAgICAgIHVzZXJzU2VydmljZS51cGRhdGUubW9ja1Jlc29sdmVkVmFsdWUodXBkYXRlZFVzZXIgYXMgYW55KTtcbiAgICAgIFxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLnVwZGF0ZShcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgIHVwZGF0ZURhdGEsXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgKTtcbiAgICAgIFxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgnaWQnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdlbWFpbCcpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ2ZpcnN0TmFtZScpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ2xhc3ROYW1lJyk7XG4gICAgICBleHBlY3QocmVzdWx0LmZpcnN0TmFtZSkudG9CZSgnVXBkYXRlZCcpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5sYXN0TmFtZSkudG9CZSgnTmFtZScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gY29ycmVjdGx5IGZvcm1hdHRlZCBkZWFjdGl2YXRpb24gcmVzcG9uc2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoZmFsc2UpO1xuICAgICAgdXNlcnNTZXJ2aWNlLnJlbW92ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7fSBhcyBhbnkpO1xuICAgICAgXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIucmVtb3ZlKFRFU1RfVVNFUl9JRFMuQ0xJRU5ULCBURVNUX1VTRVJfSURTLkNMSUVOVCk7XG4gICAgICBcbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ21lc3NhZ2UnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQubWVzc2FnZSkudG9CZSgnVXNlciBhY2NvdW50IGRlYWN0aXZhdGVkIHN1Y2Nlc3NmdWxseScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gY29ycmVjdGx5IGZvcm1hdHRlZCBhZG1pbiBkZWFjdGl2YXRpb24gcmVzcG9uc2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICB1c2Vyc1NlcnZpY2UuZGVhY3RpdmF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7fSBhcyBhbnkpO1xuICAgICAgXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZGVhY3RpdmF0ZVVzZXIoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICB7IHJlYXNvbjogJ1BvbGljeSB2aW9sYXRpb24nIH0sXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQURNSU4sXG4gICAgICApO1xuICAgICAgXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdtZXNzYWdlJyk7XG4gICAgICBleHBlY3QocmVzdWx0Lm1lc3NhZ2UpLnRvQmUoJ1VzZXIgYWNjb3VudCBkZWFjdGl2YXRlZCBieSBhZG1pbmlzdHJhdG9yJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBjb3JyZWN0bHkgZm9ybWF0dGVkIHJlYWN0aXZhdGlvbiByZXNwb25zZScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIHVzZXJzU2VydmljZS5yZWFjdGl2YXRlLm1vY2tSZXNvbHZlZFZhbHVlKHt9IGFzIGFueSk7XG4gICAgICBcbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5yZWFjdGl2YXRlVXNlcihcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQURNSU4sXG4gICAgICApO1xuICAgICAgXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdtZXNzYWdlJyk7XG4gICAgICBleHBlY3QocmVzdWx0Lm1lc3NhZ2UpLnRvQmUoJ1VzZXIgYWNjb3VudCByZWFjdGl2YXRlZCBzdWNjZXNzZnVsbHknKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJ2ZXJzaW9uIjozfQ==