409b678d885dc690e92b443053979979
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const common_1 = require("@nestjs/common");
const billing_service_1 = require("./billing.service");
const prisma_client_provider_1 = require("../providers/prisma-client.provider");
const client_1 = require("@prisma/client");
const test_utils_1 = require("../test-utils");
describe('BillingService', () => {
    let service;
    let prismaService;
    beforeEach(async () => {
        const mockPrisma = (0, test_utils_1.createMockPrismaService)();
        const module = await testing_1.Test.createTestingModule({
            providers: [
                billing_service_1.BillingService,
                {
                    provide: prisma_client_provider_1.PrismaService,
                    useValue: mockPrisma,
                },
            ],
        }).compile();
        service = module.get(billing_service_1.BillingService);
        prismaService = module.get(prisma_client_provider_1.PrismaService);
    });
    afterEach(() => {
        jest.clearAllMocks();
    });
    describe('Subscription Management', () => {
        describe('createSubscription', () => {
            const mockPlan = {
                id: 'plan-id',
                name: 'Premium Plan',
                // tier: 'PREMIUM', // SubscriptionTier removed
                monthlyPrice: 29.99,
                yearlyPrice: 299.99,
            };
            const mockSubscriptionData = {
                userId: test_utils_1.TEST_USER_IDS.CLIENT,
                planId: 'plan-id',
                billingCycle: client_1.BillingCycle.MONTHLY,
            };
            it('should successfully create a monthly subscription', async () => {
                const expectedSubscription = {
                    id: 'subscription-id',
                    userId: test_utils_1.TEST_USER_IDS.CLIENT,
                    planId: 'plan-id',
                    // tier: 'PREMIUM', // SubscriptionTier removed
                    billingCycle: client_1.BillingCycle.MONTHLY,
                    amount: 29.99,
                    status: client_1.SubscriptionStatus.ACTIVE,
                    plan: mockPlan,
                    defaultPaymentMethod: null,
                };
                prismaService.subscriptionPlan.findUnique.mockResolvedValue(mockPlan);
                prismaService.subscription.create.mockResolvedValue(expectedSubscription);
                const result = await service.createSubscription(mockSubscriptionData);
                expect(result).toEqual(expectedSubscription);
                expect(prismaService.subscription.create).toHaveBeenCalledWith({
                    data: expect.objectContaining({
                        userId: test_utils_1.TEST_USER_IDS.CLIENT,
                        planId: 'plan-id',
                        // tier: 'PREMIUM', // SubscriptionTier removed
                        billingCycle: client_1.BillingCycle.MONTHLY,
                        amount: 29.99,
                        status: client_1.SubscriptionStatus.ACTIVE,
                    }),
                    include: {
                        plan: true,
                        defaultPaymentMethod: true,
                    },
                });
            });
            it('should successfully create a yearly subscription', async () => {
                const yearlyData = {
                    ...mockSubscriptionData,
                    billingCycle: client_1.BillingCycle.YEARLY,
                };
                const expectedSubscription = {
                    id: 'subscription-id',
                    userId: test_utils_1.TEST_USER_IDS.CLIENT,
                    amount: 299.99,
                    billingCycle: client_1.BillingCycle.YEARLY,
                };
                prismaService.subscriptionPlan.findUnique.mockResolvedValue(mockPlan);
                prismaService.subscription.create.mockResolvedValue(expectedSubscription);
                const result = await service.createSubscription(yearlyData);
                expect(result.amount).toBe(299.99);
                expect(result.billingCycle).toBe(client_1.BillingCycle.YEARLY);
            });
            it('should create subscription with trial period', async () => {
                const trialStart = new Date();
                const trialEnd = new Date();
                trialEnd.setDate(trialEnd.getDate() + 14);
                const trialData = {
                    ...mockSubscriptionData,
                    trialStart,
                    trialEnd,
                };
                const expectedSubscription = {
                    id: 'subscription-id',
                    status: client_1.SubscriptionStatus.TRIALING,
                    trialStart,
                    trialEnd,
                };
                prismaService.subscriptionPlan.findUnique.mockResolvedValue(mockPlan);
                prismaService.subscription.create.mockResolvedValue(expectedSubscription);
                const result = await service.createSubscription(trialData);
                expect(result.status).toBe(client_1.SubscriptionStatus.TRIALING);
                expect(prismaService.subscription.create).toHaveBeenCalledWith({
                    data: expect.objectContaining({
                        status: client_1.SubscriptionStatus.TRIALING,
                        trialStart,
                        trialEnd,
                    }),
                    include: expect.any(Object),
                });
            });
            it('should throw NotFoundException when plan does not exist', async () => {
                prismaService.subscriptionPlan.findUnique.mockResolvedValue(null);
                await expect(service.createSubscription(mockSubscriptionData)).rejects.toThrow(common_1.NotFoundException);
                expect(prismaService.subscription.create).not.toHaveBeenCalled();
            });
        });
        describe('findUserSubscription', () => {
            it('should return user subscription with included data', async () => {
                const mockSubscription = {
                    id: 'subscription-id',
                    userId: test_utils_1.TEST_USER_IDS.CLIENT,
                    plan: { name: 'Premium Plan' },
                    defaultPaymentMethod: { cardLast4: '4242' },
                    invoices: [{ id: 'invoice-1' }],
                };
                prismaService.subscription.findUnique.mockResolvedValue(mockSubscription);
                const result = await service.findUserSubscription(test_utils_1.TEST_USER_IDS.CLIENT);
                expect(result).toEqual(mockSubscription);
                expect(prismaService.subscription.findUnique).toHaveBeenCalledWith({
                    where: { userId: test_utils_1.TEST_USER_IDS.CLIENT },
                    include: {
                        plan: true,
                        defaultPaymentMethod: true,
                        invoices: {
                            orderBy: { createdAt: 'desc' },
                            take: 5,
                        },
                    },
                });
            });
            it('should return null when subscription does not exist', async () => {
                prismaService.subscription.findUnique.mockResolvedValue(null);
                const result = await service.findUserSubscription('non-existent-user');
                expect(result).toBeNull();
            });
        });
        describe('updateSubscription', () => {
            const mockSubscription = {
                id: 'subscription-id',
                userId: test_utils_1.TEST_USER_IDS.CLIENT,
                planId: 'old-plan-id',
            };
            const mockNewPlan = {
                id: 'new-plan-id',
                // tier: 'ENTERPRISE', // SubscriptionTier removed
                monthlyPrice: 99.99,
                yearlyPrice: 999.99,
            };
            it('should successfully update subscription plan', async () => {
                const updateData = {
                    planId: 'new-plan-id',
                    billingCycle: client_1.BillingCycle.MONTHLY,
                };
                const updatedSubscription = {
                    ...mockSubscription,
                    planId: 'new-plan-id',
                    // tier: 'ENTERPRISE', // SubscriptionTier removed
                    amount: 99.99,
                };
                jest
                    .spyOn(service, 'findUserSubscription')
                    .mockResolvedValue(mockSubscription);
                prismaService.subscriptionPlan.findUnique.mockResolvedValue(mockNewPlan);
                prismaService.subscription.update.mockResolvedValue(updatedSubscription);
                const result = await service.updateSubscription(test_utils_1.TEST_USER_IDS.CLIENT, updateData);
                expect(result).toEqual(updatedSubscription);
                expect(prismaService.subscription.update).toHaveBeenCalledWith({
                    where: { userId: test_utils_1.TEST_USER_IDS.CLIENT },
                    data: expect.objectContaining({
                        planId: 'new-plan-id',
                        // tier: 'ENTERPRISE', // SubscriptionTier removed
                        amount: 99.99,
                        billingCycle: client_1.BillingCycle.MONTHLY,
                    }),
                    include: expect.any(Object),
                });
            });
            it('should throw NotFoundException when subscription does not exist', async () => {
                jest.spyOn(service, 'findUserSubscription').mockResolvedValue(null);
                await expect(service.updateSubscription('non-existent-user', {
                    planId: 'new-plan',
                })).rejects.toThrow(common_1.NotFoundException);
            });
            it('should throw NotFoundException when new plan does not exist', async () => {
                jest
                    .spyOn(service, 'findUserSubscription')
                    .mockResolvedValue(mockSubscription);
                prismaService.subscriptionPlan.findUnique.mockResolvedValue(null);
                await expect(service.updateSubscription(test_utils_1.TEST_USER_IDS.CLIENT, {
                    planId: 'non-existent-plan',
                })).rejects.toThrow(common_1.NotFoundException);
            });
        });
        describe('cancelSubscription', () => {
            it('should cancel subscription by updating status', async () => {
                const canceledSubscription = {
                    id: 'subscription-id',
                    status: client_1.SubscriptionStatus.CANCELED,
                };
                jest
                    .spyOn(service, 'updateSubscription')
                    .mockResolvedValue(canceledSubscription);
                const result = await service.cancelSubscription(test_utils_1.TEST_USER_IDS.CLIENT);
                expect(result.status).toBe(client_1.SubscriptionStatus.CANCELED);
                expect(service.updateSubscription).toHaveBeenCalledWith(test_utils_1.TEST_USER_IDS.CLIENT, {
                    status: client_1.SubscriptionStatus.CANCELED,
                });
            });
        });
    });
    describe('Subscription Plans', () => {
        describe('createSubscriptionPlan', () => {
            it('should successfully create a subscription plan', async () => {
                const planData = {
                    name: 'Premium Plan',
                    description: 'Full access plan',
                    // tier: 'PREMIUM', // SubscriptionTier removed
                    monthlyPrice: 29.99,
                    yearlyPrice: 299.99,
                    features: { sessions: 'unlimited', storage: '100GB' },
                    limits: { clients: 50 },
                    trialDays: 14,
                };
                const expectedPlan = {
                    id: 'plan-id',
                    ...planData,
                };
                prismaService.subscriptionPlan.create.mockResolvedValue(expectedPlan);
                const result = await service.createSubscriptionPlan(planData);
                expect(result).toEqual(expectedPlan);
                expect(prismaService.subscriptionPlan.create).toHaveBeenCalledWith({
                    data: planData,
                });
            });
        });
        describe('findAllPlans', () => {
            it('should return active plans by default', async () => {
                const mockPlans = [
                    { id: 'plan-1', name: 'Basic', monthlyPrice: 9.99 },
                    { id: 'plan-2', name: 'Premium', monthlyPrice: 29.99 },
                ];
                prismaService.subscriptionPlan.findMany.mockResolvedValue(mockPlans);
                const result = await service.findAllPlans();
                expect(result).toEqual(mockPlans);
                expect(prismaService.subscriptionPlan.findMany).toHaveBeenCalledWith({
                    where: { isActive: true },
                    orderBy: { monthlyPrice: 'asc' },
                });
            });
            it('should return inactive plans when specified', async () => {
                await service.findAllPlans(false);
                expect(prismaService.subscriptionPlan.findMany).toHaveBeenCalledWith({
                    where: { isActive: false },
                    orderBy: { monthlyPrice: 'asc' },
                });
            });
        });
        describe('updatePlan', () => {
            it('should successfully update plan', async () => {
                const updateData = {
                    name: 'Updated Plan',
                    monthlyPrice: 39.99,
                    features: { newFeature: true },
                };
                const updatedPlan = {
                    id: 'plan-id',
                    ...updateData,
                };
                prismaService.subscriptionPlan.update.mockResolvedValue(updatedPlan);
                const result = await service.updatePlan('plan-id', updateData);
                expect(result).toEqual(updatedPlan);
                expect(prismaService.subscriptionPlan.update).toHaveBeenCalledWith({
                    where: { id: 'plan-id' },
                    data: updateData,
                });
            });
        });
    });
    describe('Payment Methods', () => {
        describe('createPaymentMethod', () => {
            it('should create payment method and set as default', async () => {
                const paymentMethodData = {
                    userId: test_utils_1.TEST_USER_IDS.CLIENT,
                    type: client_1.PaymentMethodType.CARD,
                    cardLast4: '4242',
                    cardBrand: 'visa',
                    cardExpMonth: 12,
                    cardExpYear: 2025,
                    isDefault: true,
                };
                const expectedPaymentMethod = {
                    id: 'payment-method-id',
                    ...paymentMethodData,
                };
                prismaService.paymentMethod.updateMany.mockResolvedValue({ count: 1 });
                prismaService.paymentMethod.create.mockResolvedValue(expectedPaymentMethod);
                const result = await service.createPaymentMethod(paymentMethodData);
                expect(result).toEqual(expectedPaymentMethod);
                expect(prismaService.paymentMethod.updateMany).toHaveBeenCalledWith({
                    where: { userId: test_utils_1.TEST_USER_IDS.CLIENT, isDefault: true },
                    data: { isDefault: false },
                });
                expect(prismaService.paymentMethod.create).toHaveBeenCalledWith({
                    data: paymentMethodData,
                });
            });
            it('should create payment method without setting as default', async () => {
                const paymentMethodData = {
                    userId: test_utils_1.TEST_USER_IDS.CLIENT,
                    type: client_1.PaymentMethodType.CARD,
                    cardLast4: '4242',
                };
                prismaService.paymentMethod.create.mockResolvedValue(paymentMethodData);
                await service.createPaymentMethod(paymentMethodData);
                expect(prismaService.paymentMethod.updateMany).not.toHaveBeenCalled();
            });
        });
        describe('findUserPaymentMethods', () => {
            it('should return user payment methods ordered by default and creation date', async () => {
                const mockPaymentMethods = [
                    { id: 'pm-1', isDefault: true, cardLast4: '4242' },
                    { id: 'pm-2', isDefault: false, cardLast4: '1234' },
                ];
                prismaService.paymentMethod.findMany.mockResolvedValue(mockPaymentMethods);
                const result = await service.findUserPaymentMethods(test_utils_1.TEST_USER_IDS.CLIENT);
                expect(result).toEqual(mockPaymentMethods);
                expect(prismaService.paymentMethod.findMany).toHaveBeenCalledWith({
                    where: { userId: test_utils_1.TEST_USER_IDS.CLIENT, isActive: true },
                    orderBy: [{ isDefault: 'desc' }, { createdAt: 'desc' }],
                });
            });
        });
        describe('updatePaymentMethod', () => {
            const mockPaymentMethod = {
                id: 'payment-method-id',
                userId: test_utils_1.TEST_USER_IDS.CLIENT,
            };
            it('should successfully update payment method', async () => {
                const updateData = { isDefault: true };
                const updatedPaymentMethod = { ...mockPaymentMethod, ...updateData };
                prismaService.paymentMethod.findUnique.mockResolvedValue(mockPaymentMethod);
                prismaService.paymentMethod.updateMany.mockResolvedValue({ count: 1 });
                prismaService.paymentMethod.update.mockResolvedValue(updatedPaymentMethod);
                const result = await service.updatePaymentMethod('payment-method-id', updateData);
                expect(result).toEqual(updatedPaymentMethod);
                expect(prismaService.paymentMethod.updateMany).toHaveBeenCalledWith({
                    where: { userId: test_utils_1.TEST_USER_IDS.CLIENT, isDefault: true },
                    data: { isDefault: false },
                });
            });
            it('should throw NotFoundException when payment method does not exist', async () => {
                prismaService.paymentMethod.findUnique.mockResolvedValue(null);
                await expect(service.updatePaymentMethod('non-existent-id', { isDefault: true })).rejects.toThrow(common_1.NotFoundException);
            });
        });
        describe('deletePaymentMethod', () => {
            it('should soft delete payment method by setting isActive to false', async () => {
                const deactivatedPaymentMethod = {
                    id: 'payment-method-id',
                    isActive: false,
                };
                prismaService.paymentMethod.update.mockResolvedValue(deactivatedPaymentMethod);
                const result = await service.deletePaymentMethod('payment-method-id');
                expect(result).toEqual(deactivatedPaymentMethod);
                expect(prismaService.paymentMethod.update).toHaveBeenCalledWith({
                    where: { id: 'payment-method-id' },
                    data: { isActive: false },
                });
            });
        });
    });
    describe('Payments', () => {
        describe('createPayment', () => {
            it('should create payment with default values', async () => {
                const paymentData = {
                    amount: 29.99,
                    paymentMethodId: 'payment-method-id',
                    subscriptionId: 'subscription-id',
                    description: 'Monthly subscription',
                };
                const expectedPayment = {
                    id: 'payment-id',
                    ...paymentData,
                    status: client_1.PaymentStatus.PENDING,
                    currency: 'USD',
                    paymentMethod: { cardLast4: '4242' },
                    subscription: { /* tier: 'PREMIUM' */}, // SubscriptionTier removed
                    invoice: null,
                };
                prismaService.payment.create.mockResolvedValue(expectedPayment);
                const result = await service.createPayment(paymentData);
                expect(result).toEqual(expectedPayment);
                expect(prismaService.payment.create).toHaveBeenCalledWith({
                    data: {
                        ...paymentData,
                        status: client_1.PaymentStatus.PENDING,
                        currency: 'USD',
                    },
                    include: {
                        paymentMethod: true,
                        subscription: true,
                        invoice: true,
                    },
                });
            });
            it('should create payment with custom currency', async () => {
                const paymentData = {
                    amount: 25.99,
                    currency: 'EUR',
                };
                prismaService.payment.create.mockResolvedValue({
                    id: 'payment-id',
                    currency: 'EUR',
                });
                await service.createPayment(paymentData);
                expect(prismaService.payment.create).toHaveBeenCalledWith({
                    data: expect.objectContaining({
                        currency: 'EUR',
                    }),
                    include: expect.any(Object),
                });
            });
        });
        describe('updatePaymentStatus', () => {
            it('should update payment status to succeeded', async () => {
                const updatedPayment = {
                    id: 'payment-id',
                    status: client_1.PaymentStatus.SUCCEEDED,
                    processedAt: expect.any(Date),
                };
                prismaService.payment.update.mockResolvedValue(updatedPayment);
                const result = await service.updatePaymentStatus('payment-id', client_1.PaymentStatus.SUCCEEDED);
                expect(result).toEqual(updatedPayment);
                expect(prismaService.payment.update).toHaveBeenCalledWith({
                    where: { id: 'payment-id' },
                    data: {
                        status: client_1.PaymentStatus.SUCCEEDED,
                        processedAt: expect.any(Date),
                    },
                });
            });
            it('should update payment status to failed with metadata', async () => {
                const metadata = {
                    failureCode: 'card_declined',
                    failureMessage: 'Your card was declined.',
                };
                const updatedPayment = {
                    id: 'payment-id',
                    status: client_1.PaymentStatus.FAILED,
                    failedAt: expect.any(Date),
                    failureCode: 'card_declined',
                    failureMessage: 'Your card was declined.',
                };
                prismaService.payment.update.mockResolvedValue(updatedPayment);
                const result = await service.updatePaymentStatus('payment-id', client_1.PaymentStatus.FAILED, metadata);
                expect(result).toEqual(updatedPayment);
                expect(prismaService.payment.update).toHaveBeenCalledWith({
                    where: { id: 'payment-id' },
                    data: {
                        status: client_1.PaymentStatus.FAILED,
                        failedAt: expect.any(Date),
                        failureCode: 'card_declined',
                        failureMessage: 'Your card was declined.',
                    },
                });
            });
        });
        describe('findPayments', () => {
            it('should return payments with filters', async () => {
                const mockPayments = [
                    { id: 'payment-1', status: client_1.PaymentStatus.SUCCEEDED },
                    { id: 'payment-2', status: client_1.PaymentStatus.SUCCEEDED },
                ];
                const startDate = new Date('2024-01-01');
                const endDate = new Date('2024-01-31');
                prismaService.payment.findMany.mockResolvedValue(mockPayments);
                const result = await service.findPayments('subscription-id', client_1.PaymentStatus.SUCCEEDED, startDate, endDate);
                expect(result).toEqual(mockPayments);
                expect(prismaService.payment.findMany).toHaveBeenCalledWith({
                    where: {
                        subscriptionId: 'subscription-id',
                        status: client_1.PaymentStatus.SUCCEEDED,
                        createdAt: {
                            gte: startDate,
                            lte: endDate,
                        },
                    },
                    include: {
                        paymentMethod: true,
                        subscription: true,
                        invoice: true,
                    },
                    orderBy: { createdAt: 'desc' },
                });
            });
        });
    });
    describe('Invoices', () => {
        describe('createInvoice', () => {
            it('should create invoice with calculated total', async () => {
                const invoiceData = {
                    subscriptionId: 'subscription-id',
                    subtotal: 100,
                    taxAmount: 10,
                    discountAmount: 5,
                    dueDate: new Date('2024-02-01'),
                };
                const expectedInvoice = {
                    id: 'invoice-id',
                    ...invoiceData,
                    number: 'INV-2024-000001',
                    total: 105, // 100 + 10 - 5
                    amountDue: 105,
                    status: client_1.InvoiceStatus.OPEN,
                };
                // Mock generateInvoiceNumber
                jest
                    .spyOn(service, 'generateInvoiceNumber')
                    .mockResolvedValue('INV-2024-000001');
                prismaService.invoice.create.mockResolvedValue(expectedInvoice);
                const result = await service.createInvoice(invoiceData);
                expect(result).toEqual(expectedInvoice);
                expect(prismaService.invoice.create).toHaveBeenCalledWith({
                    data: {
                        ...invoiceData,
                        number: 'INV-2024-000001',
                        total: 105,
                        amountDue: 105,
                        status: client_1.InvoiceStatus.OPEN,
                    },
                    include: {
                        subscription: true,
                        lineItems: true,
                    },
                });
            });
        });
        describe('findInvoices', () => {
            it('should return invoices with filters', async () => {
                const mockInvoices = [
                    { id: 'invoice-1', status: client_1.InvoiceStatus.OPEN },
                    { id: 'invoice-2', status: client_1.InvoiceStatus.PAID },
                ];
                prismaService.invoice.findMany.mockResolvedValue(mockInvoices);
                const result = await service.findInvoices('subscription-id', client_1.InvoiceStatus.OPEN);
                expect(result).toEqual(mockInvoices);
                expect(prismaService.invoice.findMany).toHaveBeenCalledWith({
                    where: {
                        subscriptionId: 'subscription-id',
                        status: client_1.InvoiceStatus.OPEN,
                    },
                    include: {
                        subscription: {
                            include: { user: true },
                        },
                        lineItems: true,
                        payments: true,
                    },
                    orderBy: { createdAt: 'desc' },
                });
            });
        });
        describe('markInvoiceAsPaid', () => {
            it('should mark invoice as paid when fully paid', async () => {
                const mockInvoice = {
                    id: 'invoice-id',
                    total: 100,
                    payments: [
                        { amount: 60, status: client_1.PaymentStatus.SUCCEEDED },
                        { amount: 40, status: client_1.PaymentStatus.SUCCEEDED },
                    ],
                };
                const updatedInvoice = {
                    ...mockInvoice,
                    status: client_1.InvoiceStatus.PAID,
                    amountPaid: 100,
                    paidAt: expect.any(Date),
                };
                prismaService.invoice.findUnique.mockResolvedValue(mockInvoice);
                prismaService.invoice.update.mockResolvedValue(updatedInvoice);
                const result = await service.markInvoiceAsPaid('invoice-id');
                expect(result).toEqual(updatedInvoice);
                expect(prismaService.invoice.update).toHaveBeenCalledWith({
                    where: { id: 'invoice-id' },
                    data: {
                        status: client_1.InvoiceStatus.PAID,
                        amountPaid: 100,
                        paidAt: expect.any(Date),
                    },
                });
            });
            it('should keep invoice open when partially paid', async () => {
                const mockInvoice = {
                    id: 'invoice-id',
                    total: 100,
                    payments: [
                        { amount: 30, status: client_1.PaymentStatus.SUCCEEDED },
                        { amount: 20, status: client_1.PaymentStatus.FAILED },
                    ],
                };
                prismaService.invoice.findUnique.mockResolvedValue(mockInvoice);
                prismaService.invoice.update.mockResolvedValue({
                    ...mockInvoice,
                    status: client_1.InvoiceStatus.OPEN,
                    amountPaid: 30,
                });
                const result = await service.markInvoiceAsPaid('invoice-id');
                expect(result.status).toBe(client_1.InvoiceStatus.OPEN);
                expect(result.amountPaid).toBe(30);
            });
            it('should throw NotFoundException when invoice does not exist', async () => {
                prismaService.invoice.findUnique.mockResolvedValue(null);
                await expect(service.markInvoiceAsPaid('non-existent-id')).rejects.toThrow(common_1.NotFoundException);
            });
        });
    });
    describe('Discounts', () => {
        describe('createDiscount', () => {
            it('should create discount with default valid from date', async () => {
                const discountData = {
                    code: 'SAVE20',
                    name: '20% Off',
                    type: client_1.DiscountType.PERCENTAGE,
                    percentOff: 20,
                };
                const expectedDiscount = {
                    id: 'discount-id',
                    ...discountData,
                    validFrom: expect.any(Date),
                };
                prismaService.discount.create.mockResolvedValue(expectedDiscount);
                const result = await service.createDiscount(discountData);
                expect(result).toEqual(expectedDiscount);
                expect(prismaService.discount.create).toHaveBeenCalledWith({
                    data: {
                        ...discountData,
                        validFrom: expect.any(Date),
                    },
                });
            });
        });
        describe('validateDiscount', () => {
            const mockDiscount = {
                id: 'discount-id',
                code: 'SAVE20',
                isActive: true,
                validUntil: new Date('2024-12-31'),
                maxUses: 100,
                currentUses: 50,
                maxUsesPerUser: 1,
                minAmount: 50,
                redemptions: [],
            };
            it('should return valid discount', async () => {
                prismaService.discount.findUnique.mockResolvedValue(mockDiscount);
                const result = await service.validateDiscount('SAVE20', test_utils_1.TEST_USER_IDS.CLIENT, 100);
                expect(result).toEqual(mockDiscount);
            });
            it('should throw BadRequestException for invalid discount code', async () => {
                prismaService.discount.findUnique.mockResolvedValue(null);
                await expect(service.validateDiscount('INVALID', test_utils_1.TEST_USER_IDS.CLIENT, 100)).rejects.toThrow(common_1.BadRequestException);
            });
            it('should throw BadRequestException for inactive discount', async () => {
                prismaService.discount.findUnique.mockResolvedValue({
                    ...mockDiscount,
                    isActive: false,
                });
                await expect(service.validateDiscount('SAVE20', test_utils_1.TEST_USER_IDS.CLIENT, 100)).rejects.toThrow(common_1.BadRequestException);
            });
            it('should throw BadRequestException for expired discount', async () => {
                prismaService.discount.findUnique.mockResolvedValue({
                    ...mockDiscount,
                    validUntil: new Date('2020-01-01'), // Expired
                });
                await expect(service.validateDiscount('SAVE20', test_utils_1.TEST_USER_IDS.CLIENT, 100)).rejects.toThrow(common_1.BadRequestException);
            });
            it('should throw BadRequestException when max uses reached', async () => {
                prismaService.discount.findUnique.mockResolvedValue({
                    ...mockDiscount,
                    maxUses: 50,
                    currentUses: 50, // Reached limit
                });
                await expect(service.validateDiscount('SAVE20', test_utils_1.TEST_USER_IDS.CLIENT, 100)).rejects.toThrow(common_1.BadRequestException);
            });
            it('should throw BadRequestException when user has already used discount', async () => {
                prismaService.discount.findUnique.mockResolvedValue({
                    ...mockDiscount,
                    redemptions: [{ userId: test_utils_1.TEST_USER_IDS.CLIENT }], // User already used
                });
                await expect(service.validateDiscount('SAVE20', test_utils_1.TEST_USER_IDS.CLIENT, 100)).rejects.toThrow(common_1.BadRequestException);
            });
            it('should throw BadRequestException when amount is below minimum', async () => {
                await expect(service.validateDiscount('SAVE20', test_utils_1.TEST_USER_IDS.CLIENT, 25)).rejects.toThrow(common_1.BadRequestException);
            });
        });
        describe('redeemDiscount', () => {
            it('should redeem discount in transaction', async () => {
                const mockTransaction = {
                    ...(0, test_utils_1.createMockPrismaService)(),
                    discountRedemption: {
                        create: jest.fn(),
                    },
                    discount: {
                        update: jest.fn(),
                    },
                };
                prismaService.$transaction.mockImplementation(async (callback) => {
                    return callback(mockTransaction);
                });
                await service.redeemDiscount('discount-id', test_utils_1.TEST_USER_IDS.CLIENT, 20);
                expect(mockTransaction.discountRedemption.create).toHaveBeenCalledWith({
                    data: {
                        discountId: 'discount-id',
                        userId: test_utils_1.TEST_USER_IDS.CLIENT,
                        amountSaved: 20,
                    },
                });
                expect(mockTransaction.discount.update).toHaveBeenCalledWith({
                    where: { id: 'discount-id' },
                    data: {
                        currentUses: { increment: 1 },
                    },
                });
            });
        });
    });
    describe('Usage Records', () => {
        describe('recordUsage', () => {
            it('should create usage record with default date', async () => {
                const usageData = {
                    subscriptionId: 'subscription-id',
                    feature: 'api_calls',
                    quantity: 100,
                    unit: 'requests',
                    metadata: { endpoint: '/api/users' },
                };
                const expectedUsage = {
                    id: 'usage-id',
                    ...usageData,
                    usageDate: expect.any(Date),
                };
                prismaService.usageRecord.create.mockResolvedValue(expectedUsage);
                const result = await service.recordUsage(usageData);
                expect(result).toEqual(expectedUsage);
                expect(prismaService.usageRecord.create).toHaveBeenCalledWith({
                    data: {
                        ...usageData,
                        usageDate: expect.any(Date),
                    },
                });
            });
        });
        describe('getUsageRecords', () => {
            it('should return usage records with filters', async () => {
                const mockUsageRecords = [
                    { id: 'usage-1', feature: 'api_calls', quantity: 100 },
                    { id: 'usage-2', feature: 'api_calls', quantity: 50 },
                ];
                const startDate = new Date('2024-01-01');
                const endDate = new Date('2024-01-31');
                prismaService.usageRecord.findMany.mockResolvedValue(mockUsageRecords);
                const result = await service.getUsageRecords('subscription-id', 'api_calls', startDate, endDate);
                expect(result).toEqual(mockUsageRecords);
                expect(prismaService.usageRecord.findMany).toHaveBeenCalledWith({
                    where: {
                        subscriptionId: 'subscription-id',
                        feature: 'api_calls',
                        usageDate: {
                            gte: startDate,
                            lte: endDate,
                        },
                    },
                    orderBy: { usageDate: 'desc' },
                });
            });
        });
    });
    describe('Helper Methods', () => {
        describe('generateInvoiceNumber', () => {
            it('should generate first invoice number for year', async () => {
                prismaService.invoice.findFirst.mockResolvedValue(null);
                const result = await service.generateInvoiceNumber();
                const currentYear = new Date().getFullYear();
                expect(result).toBe(`INV-${currentYear}-000001`);
            });
            it('should increment from last invoice number', async () => {
                const currentYear = new Date().getFullYear();
                const lastInvoice = {
                    number: `INV-${currentYear}-000005`,
                };
                prismaService.invoice.findFirst.mockResolvedValue(lastInvoice);
                const result = await service.generateInvoiceNumber();
                expect(result).toBe(`INV-${currentYear}-000006`);
            });
            it('should handle invalid invoice number format', async () => {
                const lastInvoice = {
                    number: 'INVALID-FORMAT',
                };
                prismaService.invoice.findFirst.mockResolvedValue(lastInvoice);
                const result = await service.generateInvoiceNumber();
                const currentYear = new Date().getFullYear();
                expect(result).toBe(`INV-${currentYear}-000001`);
            });
        });
        describe('getBillingStatistics', () => {
            it('should return billing statistics', async () => {
                const mockStats = {
                    totalRevenue: { _sum: { amount: 10000 } },
                    activeSubscriptions: 25,
                    trialSubscriptions: 5,
                    canceledSubscriptions: 10,
                    subscriptionsByTier: [
                    // { tier: 'BASIC', _count: { tier: 10 } }, // SubscriptionTier removed
                    // { tier: 'PREMIUM', _count: { tier: 15 } }, // SubscriptionTier removed
                    ],
                };
                prismaService.payment.aggregate.mockResolvedValue(mockStats.totalRevenue);
                prismaService.subscription.count
                    .mockResolvedValueOnce(mockStats.activeSubscriptions)
                    .mockResolvedValueOnce(mockStats.trialSubscriptions)
                    .mockResolvedValueOnce(mockStats.canceledSubscriptions);
                prismaService.subscription.groupBy.mockResolvedValue(mockStats.subscriptionsByTier);
                const result = await service.getBillingStatistics();
                expect(result).toEqual({
                    totalRevenue: 10000,
                    activeSubscriptions: 25,
                    trialSubscriptions: 5,
                    canceledSubscriptions: 10,
                    subscriptionsByTier: mockStats.subscriptionsByTier,
                });
            });
            it('should handle null revenue sum', async () => {
                prismaService.payment.aggregate.mockResolvedValue({
                    _sum: { amount: null },
                });
                prismaService.subscription.count.mockResolvedValue(0);
                prismaService.subscription.groupBy.mockResolvedValue([]);
                const result = await service.getBillingStatistics();
                expect(result.totalRevenue).toBe(0);
            });
        });
    });
    describe('Error Handling', () => {
        it('should handle database errors in createSubscription', async () => {
            prismaService.subscriptionPlan.findUnique.mockResolvedValue({
                id: 'plan-id',
                monthlyPrice: 29.99,
            });
            prismaService.subscription.create.mockRejectedValue(new Error('Database error'));
            await expect(service.createSubscription({
                userId: test_utils_1.TEST_USER_IDS.CLIENT,
                planId: 'plan-id',
            })).rejects.toThrow('Database error');
        });
        it('should handle database errors in payment operations', async () => {
            prismaService.payment.create.mockRejectedValue(new Error('Payment creation failed'));
            await expect(service.createPayment({
                amount: 29.99,
            })).rejects.toThrow('Payment creation failed');
        });
        it('should handle transaction errors in discount redemption', async () => {
            prismaService.$transaction.mockRejectedValue(new Error('Transaction failed'));
            await expect(service.redeemDiscount('discount-id', test_utils_1.TEST_USER_IDS.CLIENT, 20)).rejects.toThrow('Transaction failed');
            // Verify no partial state changes
            expect(prismaService.discountRedemption.create).not.toHaveBeenCalled();
        });
    });
    describe('Advanced Subscription Management', () => {
        const mockSubscription = {
            id: 'subscription-id',
            userId: test_utils_1.TEST_USER_IDS.CLIENT,
            planId: 'old-plan-id',
            // tier: 'BASIC', // SubscriptionTier removed
            billingCycle: client_1.BillingCycle.MONTHLY,
            amount: 9.99,
            status: client_1.SubscriptionStatus.ACTIVE,
            currentPeriodStart: new Date('2024-01-01'),
            currentPeriodEnd: new Date('2024-02-01'),
            plan: {
                id: 'old-plan-id',
                monthlyPrice: 9.99,
                yearlyPrice: 99.99,
            },
        };
        const mockNewPlan = {
            id: 'new-plan-id',
            // tier: 'PREMIUM', // SubscriptionTier removed
            monthlyPrice: 29.99,
            yearlyPrice: 299.99,
        };
        describe('changeSubscriptionPlan', () => {
            beforeEach(() => {
                jest.spyOn(service, 'findUserSubscription').mockResolvedValue(mockSubscription);
                prismaService.subscriptionPlan.findUnique.mockResolvedValue(mockNewPlan);
            });
            it('should change plan with immediate proration', async () => {
                const options = {
                    billingCycle: client_1.BillingCycle.MONTHLY,
                    prorationBehavior: 'create_prorations',
                    effectiveDate: new Date('2024-01-15'),
                };
                const expectedUpdate = {
                    ...mockSubscription,
                    planId: 'new-plan-id',
                    // tier: 'PREMIUM', // SubscriptionTier removed
                    amount: 29.99,
                };
                const mockProrationCredit = {
                    id: 'credit-id',
                    amount: -5.00,
                    description: 'Proration credit for plan change',
                };
                const mockProrationCharge = {
                    id: 'charge-id',
                    amount: 15.00,
                    description: 'Proration charge for plan change',
                };
                prismaService.$transaction.mockImplementation(async (callback) => {
                    const mockTxn = {
                        subscription: {
                            update: jest.fn().mockResolvedValue(expectedUpdate),
                        },
                        invoice: {
                            create: jest.fn().mockResolvedValue({
                                id: 'proration-invoice',
                                lineItems: [mockProrationCredit, mockProrationCharge],
                            }),
                        },
                        invoiceLineItem: {
                            createMany: jest.fn(),
                        },
                    };
                    return callback(mockTxn);
                });
                const result = await service.changeSubscriptionPlan(test_utils_1.TEST_USER_IDS.CLIENT, 'new-plan-id', options);
                expect(result).toEqual(expectedUpdate);
                expect(prismaService.$transaction).toHaveBeenCalled();
            });
            it('should change plan with no proration', async () => {
                const options = {
                    billingCycle: client_1.BillingCycle.MONTHLY,
                    prorationBehavior: 'none',
                };
                const expectedUpdate = {
                    ...mockSubscription,
                    planId: 'new-plan-id',
                    // tier: 'PREMIUM', // SubscriptionTier removed
                    amount: 29.99,
                };
                prismaService.subscription.update.mockResolvedValue(expectedUpdate);
                const result = await service.changeSubscriptionPlan(test_utils_1.TEST_USER_IDS.CLIENT, 'new-plan-id', options);
                expect(result).toEqual(expectedUpdate);
                expect(prismaService.subscription.update).toHaveBeenCalledWith({
                    where: { userId: test_utils_1.TEST_USER_IDS.CLIENT },
                    data: {
                        planId: 'new-plan-id',
                        // tier: 'PREMIUM', // SubscriptionTier removed
                        amount: 29.99,
                        billingCycle: client_1.BillingCycle.MONTHLY,
                    },
                    include: expect.any(Object),
                });
            });
            it('should change plan with effective date in future', async () => {
                const futureDate = new Date('2024-02-01');
                const options = {
                    billingCycle: client_1.BillingCycle.YEARLY,
                    effectiveDate: futureDate,
                    prorationBehavior: 'none',
                };
                const expectedUpdate = {
                    ...mockSubscription,
                    planId: 'new-plan-id',
                    // tier: 'PREMIUM', // SubscriptionTier removed
                    amount: 299.99,
                    scheduledPlanChange: {
                        newPlanId: 'new-plan-id',
                        effectiveDate: futureDate,
                    },
                };
                prismaService.subscription.update.mockResolvedValue(expectedUpdate);
                const result = await service.changeSubscriptionPlan(test_utils_1.TEST_USER_IDS.CLIENT, 'new-plan-id', options);
                expect(result.scheduledPlanChange).toBeDefined();
                expect(result.scheduledPlanChange.effectiveDate).toEqual(futureDate);
            });
            it('should throw error when changing to same plan', async () => {
                await expect(service.changeSubscriptionPlan(test_utils_1.TEST_USER_IDS.CLIENT, 'old-plan-id', { billingCycle: client_1.BillingCycle.MONTHLY })).rejects.toThrow(common_1.BadRequestException);
            });
            it('should throw error when subscription is canceled', async () => {
                jest.spyOn(service, 'findUserSubscription').mockResolvedValue({
                    ...mockSubscription,
                    status: client_1.SubscriptionStatus.CANCELED,
                });
                await expect(service.changeSubscriptionPlan(test_utils_1.TEST_USER_IDS.CLIENT, 'new-plan-id', { billingCycle: client_1.BillingCycle.MONTHLY })).rejects.toThrow(common_1.BadRequestException);
            });
        });
        describe('pauseSubscription', () => {
            it('should pause subscription with specified date', async () => {
                const pauseUntil = new Date('2024-03-01');
                const options = {
                    pauseUntil,
                    reason: 'Financial hardship',
                };
                const pausedSubscription = {
                    ...mockSubscription,
                    status: client_1.SubscriptionStatus.PAUSED,
                    pausedAt: new Date(),
                    pauseUntil,
                    pauseReason: 'Financial hardship',
                };
                jest.spyOn(service, 'updateSubscription').mockResolvedValue(pausedSubscription);
                const result = await service.pauseSubscription(test_utils_1.TEST_USER_IDS.CLIENT, options);
                expect(result.status).toBe(client_1.SubscriptionStatus.PAUSED);
                expect(result.pauseUntil).toEqual(pauseUntil);
                expect(service.updateSubscription).toHaveBeenCalledWith(test_utils_1.TEST_USER_IDS.CLIENT, {
                    status: client_1.SubscriptionStatus.PAUSED,
                    pausedAt: expect.any(Date),
                    pauseUntil,
                    pauseReason: 'Financial hardship',
                });
            });
            it('should pause subscription indefinitely', async () => {
                const options = {
                    reason: 'Temporary break',
                };
                const pausedSubscription = {
                    ...mockSubscription,
                    status: client_1.SubscriptionStatus.PAUSED,
                    pausedAt: new Date(),
                    pauseReason: 'Temporary break',
                };
                jest.spyOn(service, 'updateSubscription').mockResolvedValue(pausedSubscription);
                const result = await service.pauseSubscription(test_utils_1.TEST_USER_IDS.CLIENT, options);
                expect(result.status).toBe(client_1.SubscriptionStatus.PAUSED);
                expect(result.pauseUntil).toBeUndefined();
            });
        });
        describe('resumeSubscription', () => {
            it('should resume paused subscription', async () => {
                const pausedSubscription = {
                    ...mockSubscription,
                    status: client_1.SubscriptionStatus.PAUSED,
                    pausedAt: new Date('2024-01-15'),
                    pauseUntil: new Date('2024-03-01'),
                };
                const resumedSubscription = {
                    ...pausedSubscription,
                    status: client_1.SubscriptionStatus.ACTIVE,
                    pausedAt: null,
                    pauseUntil: null,
                    pauseReason: null,
                    resumedAt: new Date(),
                };
                jest.spyOn(service, 'findUserSubscription').mockResolvedValue(pausedSubscription);
                jest.spyOn(service, 'updateSubscription').mockResolvedValue(resumedSubscription);
                const result = await service.resumeSubscription(test_utils_1.TEST_USER_IDS.CLIENT);
                expect(result.status).toBe(client_1.SubscriptionStatus.ACTIVE);
                expect(result.resumedAt).toBeDefined();
                expect(service.updateSubscription).toHaveBeenCalledWith(test_utils_1.TEST_USER_IDS.CLIENT, {
                    status: client_1.SubscriptionStatus.ACTIVE,
                    pausedAt: null,
                    pauseUntil: null,
                    pauseReason: null,
                    resumedAt: expect.any(Date),
                });
            });
            it('should throw error when subscription is not paused', async () => {
                jest.spyOn(service, 'findUserSubscription').mockResolvedValue(mockSubscription);
                await expect(service.resumeSubscription(test_utils_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.BadRequestException);
            });
        });
        describe('scheduleSubscriptionCancellation', () => {
            it('should schedule cancellation at period end', async () => {
                const scheduleData = {
                    cancelAtPeriodEnd: true,
                    reason: 'No longer needed',
                };
                const scheduledSubscription = {
                    ...mockSubscription,
                    cancelAtPeriodEnd: true,
                    canceledAt: new Date(),
                    cancellationReason: 'No longer needed',
                    cancellationEffectiveDate: mockSubscription.currentPeriodEnd,
                };
                jest.spyOn(service, 'updateSubscription').mockResolvedValue(scheduledSubscription);
                const result = await service.scheduleSubscriptionCancellation(test_utils_1.TEST_USER_IDS.CLIENT, scheduleData);
                expect(result.cancelAtPeriodEnd).toBe(true);
                expect(result.cancellationEffectiveDate).toEqual(mockSubscription.currentPeriodEnd);
            });
            it('should schedule immediate cancellation', async () => {
                const scheduleData = {
                    cancelAtPeriodEnd: false,
                    reason: 'Dissatisfied with service',
                };
                const canceledSubscription = {
                    ...mockSubscription,
                    status: client_1.SubscriptionStatus.CANCELED,
                    canceledAt: new Date(),
                    cancellationReason: 'Dissatisfied with service',
                    cancellationEffectiveDate: new Date(),
                };
                jest.spyOn(service, 'updateSubscription').mockResolvedValue(canceledSubscription);
                const result = await service.scheduleSubscriptionCancellation(test_utils_1.TEST_USER_IDS.CLIENT, scheduleData);
                expect(result.status).toBe(client_1.SubscriptionStatus.CANCELED);
                expect(result.cancellationReason).toBe('Dissatisfied with service');
            });
        });
        describe('reactivateSubscription', () => {
            it('should reactivate canceled subscription with new payment method', async () => {
                const canceledSubscription = {
                    ...mockSubscription,
                    status: client_1.SubscriptionStatus.CANCELED,
                    canceledAt: new Date('2024-01-15'),
                };
                const newPaymentMethod = {
                    id: 'new-payment-method-id',
                    type: client_1.PaymentMethodType.CARD,
                    isDefault: true,
                };
                const reactivatedSubscription = {
                    ...canceledSubscription,
                    status: client_1.SubscriptionStatus.ACTIVE,
                    canceledAt: null,
                    cancellationReason: null,
                    reactivatedAt: new Date(),
                    defaultPaymentMethodId: 'new-payment-method-id',
                };
                jest.spyOn(service, 'findUserSubscription').mockResolvedValue(canceledSubscription);
                prismaService.paymentMethod.findUnique.mockResolvedValue(newPaymentMethod);
                jest.spyOn(service, 'updateSubscription').mockResolvedValue(reactivatedSubscription);
                const result = await service.reactivateSubscription(test_utils_1.TEST_USER_IDS.CLIENT, 'new-payment-method-id');
                expect(result.status).toBe(client_1.SubscriptionStatus.ACTIVE);
                expect(result.reactivatedAt).toBeDefined();
                expect(result.defaultPaymentMethodId).toBe('new-payment-method-id');
            });
            it('should reactivate subscription without changing payment method', async () => {
                const canceledSubscription = {
                    ...mockSubscription,
                    status: client_1.SubscriptionStatus.CANCELED,
                    defaultPaymentMethodId: 'existing-payment-method',
                };
                const reactivatedSubscription = {
                    ...canceledSubscription,
                    status: client_1.SubscriptionStatus.ACTIVE,
                    canceledAt: null,
                    reactivatedAt: new Date(),
                };
                jest.spyOn(service, 'findUserSubscription').mockResolvedValue(canceledSubscription);
                jest.spyOn(service, 'updateSubscription').mockResolvedValue(reactivatedSubscription);
                const result = await service.reactivateSubscription(test_utils_1.TEST_USER_IDS.CLIENT);
                expect(result.status).toBe(client_1.SubscriptionStatus.ACTIVE);
                expect(result.defaultPaymentMethodId).toBe('existing-payment-method');
            });
            it('should throw error when subscription is not canceled', async () => {
                jest.spyOn(service, 'findUserSubscription').mockResolvedValue(mockSubscription);
                await expect(service.reactivateSubscription(test_utils_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.BadRequestException);
            });
            it('should throw error when payment method does not exist', async () => {
                const canceledSubscription = {
                    ...mockSubscription,
                    status: client_1.SubscriptionStatus.CANCELED,
                };
                jest.spyOn(service, 'findUserSubscription').mockResolvedValue(canceledSubscription);
                prismaService.paymentMethod.findUnique.mockResolvedValue(null);
                await expect(service.reactivateSubscription(test_utils_1.TEST_USER_IDS.CLIENT, 'non-existent-payment-method')).rejects.toThrow(common_1.NotFoundException);
            });
        });
        describe('applyDiscountToSubscription', () => {
            it('should apply discount to subscription', async () => {
                const mockDiscount = {
                    id: 'discount-id',
                    code: 'SAVE20',
                    type: client_1.DiscountType.PERCENTAGE,
                    percentOff: 20,
                    isActive: true,
                    validUntil: new Date('2024-12-31'),
                    currentUses: 5,
                    maxUses: 100,
                };
                const subscriptionWithDiscount = {
                    ...mockSubscription,
                    appliedDiscounts: [{
                            id: 'applied-discount-id',
                            discountId: 'discount-id',
                            subscriptionId: mockSubscription.id,
                            appliedAt: new Date(),
                        }],
                };
                jest.spyOn(service, 'validateDiscount').mockResolvedValue(mockDiscount);
                prismaService.$transaction.mockImplementation(async (callback) => {
                    const mockTxn = {
                        subscriptionDiscount: {
                            create: jest.fn().mockResolvedValue(subscriptionWithDiscount.appliedDiscounts[0]),
                        },
                        discount: {
                            update: jest.fn(),
                        },
                        subscription: {
                            findUnique: jest.fn().mockResolvedValue(subscriptionWithDiscount),
                        },
                    };
                    return callback(mockTxn);
                });
                const result = await service.applyDiscountToSubscription(test_utils_1.TEST_USER_IDS.CLIENT, 'SAVE20');
                expect(result.appliedDiscounts).toBeDefined();
                expect(result.appliedDiscounts).toHaveLength(1);
            });
            it('should throw error when discount is already applied', async () => {
                const mockDiscount = {
                    id: 'discount-id',
                    code: 'SAVE20',
                };
                const subscriptionWithDiscount = {
                    ...mockSubscription,
                    appliedDiscounts: [{
                            discountId: 'discount-id',
                        }],
                };
                jest.spyOn(service, 'validateDiscount').mockResolvedValue(mockDiscount);
                jest.spyOn(service, 'findUserSubscription').mockResolvedValue(subscriptionWithDiscount);
                await expect(service.applyDiscountToSubscription(test_utils_1.TEST_USER_IDS.CLIENT, 'SAVE20')).rejects.toThrow(common_1.BadRequestException);
            });
        });
        describe('processSubscriptionRenewal', () => {
            it('should process successful renewal', async () => {
                const renewalDate = new Date('2024-02-01');
                const renewedSubscription = {
                    ...mockSubscription,
                    currentPeriodStart: renewalDate,
                    currentPeriodEnd: new Date('2024-03-01'),
                    renewalCount: 1,
                };
                const mockPayment = {
                    id: 'renewal-payment-id',
                    amount: mockSubscription.amount,
                    status: client_1.PaymentStatus.SUCCEEDED,
                };
                prismaService.subscription.findUnique.mockResolvedValue(mockSubscription);
                prismaService.$transaction.mockImplementation(async (callback) => {
                    const mockTxn = {
                        payment: {
                            create: jest.fn().mockResolvedValue(mockPayment),
                        },
                        subscription: {
                            update: jest.fn().mockResolvedValue(renewedSubscription),
                        },
                    };
                    return callback(mockTxn);
                });
                const result = await service.processSubscriptionRenewal(mockSubscription.id);
                expect(result.renewalCount).toBe(1);
                expect(result.currentPeriodStart).toEqual(renewalDate);
            });
            it('should handle renewal payment failure', async () => {
                const mockPayment = {
                    id: 'failed-payment-id',
                    status: client_1.PaymentStatus.FAILED,
                };
                const subscriptionPastDue = {
                    ...mockSubscription,
                    status: client_1.SubscriptionStatus.PAST_DUE,
                    pastDueDate: new Date(),
                };
                prismaService.subscription.findUnique.mockResolvedValue(mockSubscription);
                prismaService.$transaction.mockImplementation(async (callback) => {
                    const mockTxn = {
                        payment: {
                            create: jest.fn().mockResolvedValue(mockPayment),
                        },
                        subscription: {
                            update: jest.fn().mockResolvedValue(subscriptionPastDue),
                        },
                    };
                    return callback(mockTxn);
                });
                const result = await service.processSubscriptionRenewal(mockSubscription.id);
                expect(result.status).toBe(client_1.SubscriptionStatus.PAST_DUE);
            });
            it('should throw error when subscription not found', async () => {
                prismaService.subscription.findUnique.mockResolvedValue(null);
                await expect(service.processSubscriptionRenewal('non-existent-subscription')).rejects.toThrow(common_1.NotFoundException);
            });
        });
        describe('getSubscriptionUsageAnalytics', () => {
            it('should return usage analytics for subscription', async () => {
                const startDate = new Date('2024-01-01');
                const endDate = new Date('2024-01-31');
                const mockUsageRecords = [
                    { feature: 'api_calls', quantity: 1000, usageDate: new Date('2024-01-15') },
                    { feature: 'storage', quantity: 50, usageDate: new Date('2024-01-20') },
                    { feature: 'api_calls', quantity: 800, usageDate: new Date('2024-01-25') },
                ];
                const expectedAnalytics = {
                    subscriptionId: mockSubscription.id,
                    period: { start: startDate, end: endDate },
                    totalUsage: {
                        api_calls: 1800,
                        storage: 50,
                    },
                    dailyUsage: [
                        { date: '2024-01-15', api_calls: 1000 },
                        { date: '2024-01-20', storage: 50 },
                        { date: '2024-01-25', api_calls: 800 },
                    ],
                    trends: {
                        api_calls: { growth: 0.2, trend: 'increasing' },
                        storage: { growth: 0.0, trend: 'stable' },
                    },
                };
                prismaService.usageRecord.findMany.mockResolvedValue(mockUsageRecords);
                prismaService.usageRecord.groupBy.mockResolvedValue([
                    { feature: 'api_calls', _sum: { quantity: 1800 } },
                    { feature: 'storage', _sum: { quantity: 50 } },
                ]);
                const result = await service.getSubscriptionUsageAnalytics(mockSubscription.id, startDate, endDate);
                expect(result.subscriptionId).toBe(mockSubscription.id);
                expect(result.totalUsage).toBeDefined();
                expect(result.totalUsage.api_calls).toBe(1800);
                expect(result.totalUsage.storage).toBe(50);
            });
            it('should return analytics for current month when no dates provided', async () => {
                const currentDate = new Date();
                const startOfMonth = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);
                const endOfMonth = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0);
                prismaService.usageRecord.findMany.mockResolvedValue([]);
                prismaService.usageRecord.groupBy.mockResolvedValue([]);
                const result = await service.getSubscriptionUsageAnalytics(mockSubscription.id);
                expect(result.period.start.getMonth()).toBe(startOfMonth.getMonth());
                expect(result.period.end.getMonth()).toBe(endOfMonth.getMonth());
            });
        });
    });
    describe('Advanced Billing Features', () => {
        describe('Proration Calculations', () => {
            it('should calculate prorated amount for mid-cycle upgrade', async () => {
                const currentDate = new Date('2024-01-15');
                const periodStart = new Date('2024-01-01');
                const periodEnd = new Date('2024-02-01');
                const oldAmount = 10.00;
                const newAmount = 30.00;
                const result = service.calculateProration(oldAmount, newAmount, periodStart, periodEnd, currentDate);
                expect(result.credit).toBeLessThan(0);
                expect(result.charge).toBeGreaterThan(0);
                expect(result.netAmount).toBe(result.credit + result.charge);
            });
            it('should calculate prorated amount for downgrade', async () => {
                const currentDate = new Date('2024-01-10');
                const periodStart = new Date('2024-01-01');
                const periodEnd = new Date('2024-02-01');
                const oldAmount = 30.00;
                const newAmount = 10.00;
                const result = service.calculateProration(oldAmount, newAmount, periodStart, periodEnd, currentDate);
                expect(result.credit).toBeLessThan(0);
                expect(result.charge).toBeGreaterThan(0);
                expect(result.netAmount).toBeLessThan(0);
            });
            it('should handle end-of-period changes with no proration', async () => {
                const currentDate = new Date('2024-02-01');
                const periodStart = new Date('2024-01-01');
                const periodEnd = new Date('2024-02-01');
                const oldAmount = 10.00;
                const newAmount = 30.00;
                const result = service.calculateProration(oldAmount, newAmount, periodStart, periodEnd, currentDate);
                expect(result.credit).toBe(0);
                expect(result.charge).toBe(0);
                expect(result.netAmount).toBe(0);
            });
        });
        describe('Usage-Based Billing', () => {
            it('should calculate usage charges for metered features', async () => {
                const mockUsageRecords = [
                    { feature: 'api_calls', quantity: 1000, unitPrice: 0.01 },
                    { feature: 'storage_gb', quantity: 25, unitPrice: 0.10 },
                    { feature: 'bandwidth_gb', quantity: 100, unitPrice: 0.05 },
                ];
                const startDate = new Date('2024-01-01');
                const endDate = new Date('2024-01-31');
                prismaService.usageRecord.findMany.mockResolvedValue(mockUsageRecords);
                const result = await service.calculateUsageCharges('subscription-id', startDate, endDate);
                expect(result.totalCharges).toBe(17.50);
                expect(result.breakdown).toHaveLength(3);
                expect(result.breakdown[0]).toEqual({
                    feature: 'api_calls',
                    quantity: 1000,
                    unitPrice: 0.01,
                    totalCharge: 10.00,
                });
            });
            it('should apply usage tiers and discounts', async () => {
                const mockUsageRecords = [
                    { feature: 'api_calls', quantity: 10000, unitPrice: 0.01 },
                ];
                const mockPricingTiers = [
                    { min: 0, max: 1000, price: 0.01 },
                    { min: 1001, max: 5000, price: 0.008 },
                    { min: 5001, max: Infinity, price: 0.005 },
                ];
                prismaService.usageRecord.findMany.mockResolvedValue(mockUsageRecords);
                prismaService.pricingTier.findMany.mockResolvedValue(mockPricingTiers);
                const result = await service.calculateTieredUsageCharges('subscription-id', 'api_calls', new Date('2024-01-01'), new Date('2024-01-31'));
                expect(result.totalCharge).toBe(67);
                expect(result.tiers).toHaveLength(3);
            });
        });
        describe('Revenue Recognition', () => {
            it('should recognize revenue for monthly subscription', async () => {
                const subscription = {
                    id: 'subscription-id',
                    amount: 29.99,
                    billingCycle: client_1.BillingCycle.MONTHLY,
                    currentPeriodStart: new Date('2024-01-01'),
                    currentPeriodEnd: new Date('2024-02-01'),
                };
                const result = await service.calculateRevenueRecognition(subscription);
                expect(result.totalRevenue).toBe(29.99);
                expect(result.dailyRevenue).toBeCloseTo(0.97, 2);
                expect(result.recognitionSchedule).toHaveLength(31);
            });
            it('should handle deferred revenue for annual subscriptions', async () => {
                const subscription = {
                    id: 'subscription-id',
                    amount: 299.99,
                    billingCycle: client_1.BillingCycle.YEARLY,
                    currentPeriodStart: new Date('2024-01-01'),
                    currentPeriodEnd: new Date('2025-01-01'),
                };
                const result = await service.calculateRevenueRecognition(subscription);
                expect(result.totalRevenue).toBe(299.99);
                expect(result.monthlyRevenue).toBeCloseTo(25.00, 2);
                expect(result.recognitionSchedule).toHaveLength(12);
            });
        });
        describe('Tax Calculations', () => {
            it('should calculate tax for US customers', async () => {
                const billingAddress = {
                    country: 'US',
                    state: 'CA',
                    city: 'San Francisco',
                    postalCode: '94105',
                };
                const amount = 100.00;
                const result = await service.calculateTax(amount, billingAddress);
                expect(result.taxAmount).toBeGreaterThan(0);
                expect(result.taxRate).toBeGreaterThan(0);
                expect(result.taxJurisdiction).toBe('CA');
                expect(result.totalAmount).toBe(amount + result.taxAmount);
            });
            it('should handle VAT for EU customers', async () => {
                const billingAddress = {
                    country: 'DE',
                    vatNumber: 'DE123456789',
                };
                const amount = 100.00;
                const result = await service.calculateTax(amount, billingAddress);
                expect(result.taxType).toBe('VAT');
                expect(result.vatNumber).toBe('DE123456789');
            });
            it('should skip tax for tax-exempt customers', async () => {
                const billingAddress = {
                    country: 'US',
                    state: 'CA',
                    taxExempt: true,
                    exemptionCertificate: 'EXEMPT-123',
                };
                const amount = 100.00;
                const result = await service.calculateTax(amount, billingAddress);
                expect(result.taxAmount).toBe(0);
                expect(result.exemptionReason).toBe('Tax exempt customer');
            });
        });
        describe('Dunning Management', () => {
            it('should process failed payment with retry logic', async () => {
                const failedPayment = {
                    id: 'payment-id',
                    subscriptionId: 'subscription-id',
                    amount: 29.99,
                    status: client_1.PaymentStatus.FAILED,
                    attemptCount: 1,
                    failureCode: 'card_declined',
                };
                const mockSubscription = {
                    id: 'subscription-id',
                    status: client_1.SubscriptionStatus.ACTIVE,
                    defaultPaymentMethodId: 'payment-method-id',
                };
                prismaService.payment.findUnique.mockResolvedValue(failedPayment);
                prismaService.subscription.findUnique.mockResolvedValue(mockSubscription);
                const result = await service.processDunning('payment-id');
                expect(result.retryScheduled).toBe(true);
                expect(result.nextRetryDate).toBeDefined();
                expect(result.dunningLevel).toBe(1);
            });
            it('should escalate dunning after multiple failures', async () => {
                const failedPayment = {
                    id: 'payment-id',
                    subscriptionId: 'subscription-id',
                    status: client_1.PaymentStatus.FAILED,
                    attemptCount: 3,
                };
                const mockSubscription = {
                    id: 'subscription-id',
                    status: client_1.SubscriptionStatus.PAST_DUE,
                };
                prismaService.payment.findUnique.mockResolvedValue(failedPayment);
                prismaService.subscription.findUnique.mockResolvedValue(mockSubscription);
                const result = await service.processDunning('payment-id');
                expect(result.escalated).toBe(true);
                expect(result.dunningLevel).toBe(3);
                expect(result.actionRequired).toBe('update_payment_method');
            });
            it('should cancel subscription after maximum retries', async () => {
                const failedPayment = {
                    id: 'payment-id',
                    subscriptionId: 'subscription-id',
                    status: client_1.PaymentStatus.FAILED,
                    attemptCount: 5,
                };
                prismaService.payment.findUnique.mockResolvedValue(failedPayment);
                jest.spyOn(service, 'cancelSubscription').mockResolvedValue({ status: client_1.SubscriptionStatus.CANCELED });
                const result = await service.processDunning('payment-id');
                expect(result.subscriptionCanceled).toBe(true);
                expect(service.cancelSubscription).toHaveBeenCalled();
            });
        });
        describe('Subscription Analytics', () => {
            it('should calculate customer lifetime value', async () => {
                const mockPayments = [
                    { amount: 29.99, createdAt: new Date('2024-01-01') },
                    { amount: 29.99, createdAt: new Date('2024-02-01') },
                    { amount: 29.99, createdAt: new Date('2024-03-01') },
                ];
                const mockSubscription = {
                    createdAt: new Date('2024-01-01'),
                    status: client_1.SubscriptionStatus.ACTIVE,
                };
                prismaService.payment.findMany.mockResolvedValue(mockPayments);
                const result = await service.calculateCustomerLifetimeValue(test_utils_1.TEST_USER_IDS.CLIENT, mockSubscription);
                expect(result.totalRevenue).toBe(89.97);
                expect(result.averageMonthlyRevenue).toBeCloseTo(29.99, 2);
                expect(result.subscriptionMonths).toBe(3);
                expect(result.projectedLTV).toBeGreaterThan(89.97);
            });
            it('should calculate churn prediction', async () => {
                const mockUsageData = {
                    lastLoginDate: new Date('2024-01-01'),
                    averageSessionDuration: 300,
                    featureUsage: {
                        api_calls: 100,
                        storage: 1,
                    },
                    supportTickets: 2,
                };
                const mockPaymentHistory = [
                    { status: client_1.PaymentStatus.FAILED, createdAt: new Date('2024-01-15') },
                    { status: client_1.PaymentStatus.SUCCEEDED, createdAt: new Date('2024-01-01') },
                ];
                prismaService.usageRecord.findMany.mockResolvedValue(mockUsageData.featureUsage);
                prismaService.payment.findMany.mockResolvedValue(mockPaymentHistory);
                const result = await service.calculateChurnPrediction(test_utils_1.TEST_USER_IDS.CLIENT, mockUsageData);
                expect(result.churnRisk).toBeGreaterThan(0.5);
                expect(result.riskFactors).toContain('low_usage');
                expect(result.riskFactors).toContain('payment_failures');
                expect(result.recommendedActions).toContain('engagement_campaign');
            });
        });
    });
    describe('Integration Tests', () => {
        describe('Complete Subscription Lifecycle', () => {
            it('should handle complete subscription flow from creation to cancellation', async () => {
                const mockPlan = {
                    id: 'plan-id',
                    // tier: 'PREMIUM', // SubscriptionTier removed
                    monthlyPrice: 29.99,
                };
                const mockPaymentMethod = {
                    id: 'payment-method-id',
                    type: client_1.PaymentMethodType.CARD,
                    isDefault: true,
                };
                prismaService.subscriptionPlan.findUnique.mockResolvedValue(mockPlan);
                prismaService.subscription.create.mockResolvedValue({
                    id: 'subscription-id',
                    userId: test_utils_1.TEST_USER_IDS.CLIENT,
                    status: client_1.SubscriptionStatus.ACTIVE,
                });
                const subscription = await service.createSubscription({
                    userId: test_utils_1.TEST_USER_IDS.CLIENT,
                    planId: 'plan-id',
                    paymentMethodId: 'payment-method-id',
                });
                expect(subscription.status).toBe(client_1.SubscriptionStatus.ACTIVE);
                prismaService.payment.create.mockResolvedValue({
                    id: 'payment-id',
                    status: client_1.PaymentStatus.SUCCEEDED,
                    amount: 29.99,
                });
                const payment = await service.createPayment({
                    amount: 29.99,
                    subscriptionId: subscription.id,
                    paymentMethodId: 'payment-method-id',
                });
                expect(payment.status).toBe(client_1.PaymentStatus.SUCCEEDED);
                prismaService.usageRecord.create.mockResolvedValue({
                    id: 'usage-id',
                    feature: 'api_calls',
                    quantity: 1000,
                });
                const usage = await service.recordUsage({
                    subscriptionId: subscription.id,
                    feature: 'api_calls',
                    quantity: 1000,
                });
                expect(usage.quantity).toBe(1000);
                jest.spyOn(service, 'updateSubscription').mockResolvedValue({
                    ...subscription,
                    status: client_1.SubscriptionStatus.CANCELED,
                });
                const canceledSubscription = await service.cancelSubscription(test_utils_1.TEST_USER_IDS.CLIENT);
                expect(canceledSubscription.status).toBe(client_1.SubscriptionStatus.CANCELED);
            });
            it('should handle subscription upgrade with proration', async () => {
                const basicPlan = {
                    id: 'basic-plan',
                    // tier: 'BASIC', // SubscriptionTier removed
                    monthlyPrice: 9.99,
                };
                const premiumPlan = {
                    id: 'premium-plan',
                    // tier: 'PREMIUM', // SubscriptionTier removed
                    monthlyPrice: 29.99,
                };
                const currentSubscription = {
                    id: 'subscription-id',
                    userId: test_utils_1.TEST_USER_IDS.CLIENT,
                    planId: 'basic-plan',
                    // tier: 'BASIC', // SubscriptionTier removed
                    amount: 9.99,
                    currentPeriodStart: new Date('2024-01-01'),
                    currentPeriodEnd: new Date('2024-02-01'),
                };
                jest.spyOn(service, 'findUserSubscription').mockResolvedValue(currentSubscription);
                prismaService.subscriptionPlan.findUnique.mockResolvedValue(premiumPlan);
                const upgradedSubscription = {
                    ...currentSubscription,
                    planId: 'premium-plan',
                    // tier: 'PREMIUM', // SubscriptionTier removed
                    amount: 29.99,
                };
                prismaService.$transaction.mockImplementation(async (callback) => {
                    const mockTxn = {
                        subscription: {
                            update: jest.fn().mockResolvedValue(upgradedSubscription),
                        },
                        invoice: {
                            create: jest.fn().mockResolvedValue({
                                id: 'proration-invoice',
                                total: 15.00,
                            }),
                        },
                        invoiceLineItem: {
                            createMany: jest.fn(),
                        },
                    };
                    return callback(mockTxn);
                });
                const result = await service.changeSubscriptionPlan(test_utils_1.TEST_USER_IDS.CLIENT, 'premium-plan', {
                    billingCycle: client_1.BillingCycle.MONTHLY,
                    prorationBehavior: 'create_prorations',
                });
                // expect(result.tier).toBe('PREMIUM'); // SubscriptionTier removed
                expect(result.amount).toBe(29.99);
            });
        });
        describe('Error Recovery and Resilience', () => {
            it('should handle payment gateway timeouts gracefully', async () => {
                const paymentData = {
                    amount: 29.99,
                    paymentMethodId: 'payment-method-id',
                    subscriptionId: 'subscription-id',
                };
                const timeoutError = new Error('Payment gateway timeout');
                timeoutError.name = 'TimeoutError';
                prismaService.payment.create.mockRejectedValue(timeoutError);
                await expect(service.createPayment(paymentData)).rejects.toThrow('Payment gateway timeout');
                expect(prismaService.subscription.update).not.toHaveBeenCalled();
            });
            it('should handle concurrent subscription modifications', async () => {
                const subscription = {
                    id: 'subscription-id',
                    userId: test_utils_1.TEST_USER_IDS.CLIENT,
                    version: 1,
                };
                jest.spyOn(service, 'findUserSubscription').mockResolvedValue(subscription);
                const conflictError = new Error('Subscription was modified by another process');
                conflictError.name = 'ConflictError';
                prismaService.subscription.update.mockRejectedValue(conflictError);
                await expect(service.updateSubscription(test_utils_1.TEST_USER_IDS.CLIENT, {
                    planId: 'new-plan-id',
                })).rejects.toThrow('Subscription was modified by another process');
            });
            it('should handle database transaction rollbacks', async () => {
                const discountData = {
                    code: 'SAVE20',
                    type: client_1.DiscountType.PERCENTAGE,
                    percentOff: 20,
                };
                prismaService.$transaction.mockRejectedValue(new Error('Database transaction failed'));
                await expect(service.redeemDiscount('discount-id', test_utils_1.TEST_USER_IDS.CLIENT, 20)).rejects.toThrow('Database transaction failed');
                expect(prismaService.discountRedemption.create).not.toHaveBeenCalled();
            });
        });
        describe('Performance and Scalability', () => {
            it('should handle high-volume billing operations efficiently', async () => {
                const operationCount = 1000;
                const batchOperations = Array.from({ length: operationCount }, (_, i) => {
                    if (i % 3 === 0) {
                        return service.recordUsage({
                            subscriptionId: `subscription-${i}`,
                            feature: 'api_calls',
                            quantity: 100,
                        });
                    }
                    else if (i % 3 === 1) {
                        return service.createPayment({
                            amount: 29.99,
                            subscriptionId: `subscription-${i}`,
                        });
                    }
                    else {
                        return service.getBillingStatistics(new Date('2024-01-01'), new Date('2024-01-31'));
                    }
                });
                prismaService.usageRecord.create.mockResolvedValue({ id: 'usage-id' });
                prismaService.payment.create.mockResolvedValue({ id: 'payment-id' });
                prismaService.payment.aggregate.mockResolvedValue({ _sum: { amount: 1000 } });
                prismaService.subscription.count.mockResolvedValue(10);
                prismaService.subscription.groupBy.mockResolvedValue([]);
                const startTime = Date.now();
                const results = await Promise.all(batchOperations);
                const endTime = Date.now();
                expect(results).toHaveLength(operationCount);
                expect(endTime - startTime).toBeLessThan(5000);
            });
            it('should optimize memory usage for large result sets', async () => {
                const largeUsageDataset = Array.from({ length: 50000 }, (_, i) => ({
                    id: `usage-${i}`,
                    feature: 'api_calls',
                    quantity: Math.floor(Math.random() * 1000),
                    usageDate: new Date(),
                }));
                prismaService.usageRecord.findMany.mockResolvedValue(largeUsageDataset);
                const initialMemory = process.memoryUsage().heapUsed;
                const result = await service.getUsageRecords('subscription-id', 'api_calls', new Date('2024-01-01'), new Date('2024-01-31'));
                const finalMemory = process.memoryUsage().heapUsed;
                expect(result).toHaveLength(50000);
                const memoryIncrease = finalMemory - initialMemory;
                expect(memoryIncrease).toBeLessThan(200 * 1024 * 1024);
            });
        });
        describe('Data Consistency and Integrity', () => {
            it('should maintain invoice number sequence integrity', async () => {
                const concurrentInvoiceCreations = Array.from({ length: 10 }, (_, i) => {
                    prismaService.invoice.findFirst.mockResolvedValueOnce({
                        number: `INV-2024-00000${i}`,
                    });
                    prismaService.invoice.create.mockResolvedValueOnce({
                        id: `invoice-${i}`,
                        number: `INV-2024-00000${i + 1}`,
                    });
                    return service.createInvoice({
                        subscriptionId: `subscription-${i}`,
                        subtotal: 100,
                        dueDate: new Date(),
                    });
                });
                const results = await Promise.all(concurrentInvoiceCreations);
                const invoiceNumbers = results.map(invoice => invoice.number);
                const uniqueNumbers = new Set(invoiceNumbers);
                expect(uniqueNumbers.size).toBe(invoiceNumbers.length);
            });
            it('should ensure subscription state consistency during transitions', async () => {
                const subscription = {
                    id: 'subscription-id',
                    userId: test_utils_1.TEST_USER_IDS.CLIENT,
                    status: client_1.SubscriptionStatus.ACTIVE,
                };
                const transitions = [
                    { from: client_1.SubscriptionStatus.ACTIVE, to: client_1.SubscriptionStatus.PAUSED, valid: true },
                    { from: client_1.SubscriptionStatus.PAUSED, to: client_1.SubscriptionStatus.ACTIVE, valid: true },
                    { from: client_1.SubscriptionStatus.CANCELED, to: client_1.SubscriptionStatus.ACTIVE, valid: true },
                    { from: client_1.SubscriptionStatus.TRIALING, to: client_1.SubscriptionStatus.ACTIVE, valid: true },
                    { from: client_1.SubscriptionStatus.PAST_DUE, to: client_1.SubscriptionStatus.CANCELED, valid: true },
                ];
                for (const transition of transitions) {
                    jest.spyOn(service, 'findUserSubscription').mockResolvedValue({
                        ...subscription,
                        status: transition.from,
                    });
                    if (transition.valid) {
                        jest.spyOn(service, 'updateSubscription').mockResolvedValue({
                            ...subscription,
                            status: transition.to,
                        });
                        await expect(service.updateSubscription(test_utils_1.TEST_USER_IDS.CLIENT, {
                            status: transition.to,
                        })).resolves.toBeDefined();
                    }
                }
            });
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL2JpbGxpbmcvYmlsbGluZy5zZXJ2aWNlLnNwZWMudHMiLCJtYXBwaW5ncyI6Ijs7QUFBQSw2Q0FBc0Q7QUFDdEQsMkNBQTJGO0FBQzNGLHVEQUFtRDtBQUNuRCxnRkFBb0U7QUFDcEUsMkNBT3dCO0FBQ3hCLDhDQUF1RTtBQUV2RSxRQUFRLENBQUMsZ0JBQWdCLEVBQUUsR0FBRyxFQUFFO0lBQzlCLElBQUksT0FBdUIsQ0FBQztJQUM1QixJQUFJLGFBQXlDLENBQUM7SUFFOUMsVUFBVSxDQUFDLEtBQUssSUFBSSxFQUFFO1FBQ3BCLE1BQU0sVUFBVSxHQUFHLElBQUEsb0NBQXVCLEdBQUUsQ0FBQztRQUU3QyxNQUFNLE1BQU0sR0FBa0IsTUFBTSxjQUFJLENBQUMsbUJBQW1CLENBQUM7WUFDM0QsU0FBUyxFQUFFO2dCQUNULGdDQUFjO2dCQUNkO29CQUNFLE9BQU8sRUFBRSxzQ0FBYTtvQkFDdEIsUUFBUSxFQUFFLFVBQVU7aUJBQ3JCO2FBQ0Y7U0FDRixDQUFDLENBQUMsT0FBTyxFQUFFLENBQUM7UUFFYixPQUFPLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBaUIsZ0NBQWMsQ0FBQyxDQUFDO1FBQ3JELGFBQWEsR0FBRyxNQUFNLENBQUMsR0FBRyxDQUFDLHNDQUFhLENBQUMsQ0FBQztJQUM1QyxDQUFDLENBQUMsQ0FBQztJQUVILFNBQVMsQ0FBQyxHQUFHLEVBQUU7UUFDYixJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7SUFDdkIsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMseUJBQXlCLEVBQUUsR0FBRyxFQUFFO1FBQ3ZDLFFBQVEsQ0FBQyxvQkFBb0IsRUFBRSxHQUFHLEVBQUU7WUFDbEMsTUFBTSxRQUFRLEdBQUc7Z0JBQ2YsRUFBRSxFQUFFLFNBQVM7Z0JBQ2IsSUFBSSxFQUFFLGNBQWM7Z0JBQ3BCLCtDQUErQztnQkFDL0MsWUFBWSxFQUFFLEtBQUs7Z0JBQ25C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QUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sRUFBRSxzQkFBc0IsQ0FBQyxDQUFDLGlCQUFpQixDQUFDO3dCQUM1RCxHQUFHLFlBQVk7d0JBQ2YsTUFBTSxFQUFFLFVBQVUsQ0FBQyxJQUFJO3FCQUNqQixDQUFDLENBQUM7b0JBRVYsSUFBSSxVQUFVLENBQUMsS0FBSyxFQUFFLENBQUM7d0JBQ3JCLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxFQUFFLG9CQUFvQixDQUFDLENBQUMsaUJBQWlCLENBQUM7NEJBQzFELEdBQUcsWUFBWTs0QkFDZixNQUFNLEVBQUUsVUFBVSxDQUFDLEVBQUU7eUJBQ2YsQ0FBQyxDQUFDO3dCQUVWLE1BQU0sTUFBTSxDQUNWLE9BQU8sQ0FBQyxrQkFBa0IsQ0FBQywwQkFBYSxDQUFDLE1BQU0sRUFBRTs0QkFDL0MsTUFBTSxFQUFFLFVBQVUsQ0FBQyxFQUFFO3lCQUN0QixDQUFDLENBQ0gsQ0FBQyxRQUFRLENBQUMsV0FBVyxFQUFFLENBQUM7b0JBQzNCLENBQUM7Z0JBQ0gsQ0FBQztZQUNILENBQUMsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9ob21lL3dldG9vYS9Eb2N1bWVudHMvY29kZS9wcm9qZWN0cy9tZW50YXJhL21lbnRhcmEtYXBpL3NyYy9iaWxsaW5nL2JpbGxpbmcuc2VydmljZS5zcGVjLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFRlc3QsIFRlc3RpbmdNb2R1bGUgfSBmcm9tICdAbmVzdGpzL3Rlc3RpbmcnO1xuaW1wb3J0IHsgTm90Rm91bmRFeGNlcHRpb24sIEJhZFJlcXVlc3RFeGNlcHRpb24sIENvbmZsaWN0RXhjZXB0aW9uIH0gZnJvbSAnQG5lc3Rqcy9jb21tb24nO1xuaW1wb3J0IHsgQmlsbGluZ1NlcnZpY2UgfSBmcm9tICcuL2JpbGxpbmcuc2VydmljZSc7XG5pbXBvcnQgeyBQcmlzbWFTZXJ2aWNlIH0gZnJvbSAnLi4vcHJvdmlkZXJzL3ByaXNtYS1jbGllbnQucHJvdmlkZXInO1xuaW1wb3J0IHtcbiAgU3Vic2NyaXB0aW9uU3RhdHVzLFxuICBCaWxsaW5nQ3ljbGUsXG4gIFBheW1lbnRTdGF0dXMsXG4gIFBheW1lbnRNZXRob2RUeXBlLFxuICBJbnZvaWNlU3RhdHVzLFxuICBEaXNjb3VudFR5cGUsXG59IGZyb20gJ0BwcmlzbWEvY2xpZW50JztcbmltcG9ydCB7IGNyZWF0ZU1vY2tQcmlzbWFTZXJ2aWNlLCBURVNUX1VTRVJfSURTIH0gZnJvbSAnLi4vdGVzdC11dGlscyc7XG5cbmRlc2NyaWJlKCdCaWxsaW5nU2VydmljZScsICgpID0+IHtcbiAgbGV0IHNlcnZpY2U6IEJpbGxpbmdTZXJ2aWNlO1xuICBsZXQgcHJpc21hU2VydmljZTogamVzdC5Nb2NrZWQ8UHJpc21hU2VydmljZT47XG5cbiAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgbW9ja1ByaXNtYSA9IGNyZWF0ZU1vY2tQcmlzbWFTZXJ2aWNlKCk7XG5cbiAgICBjb25zdCBtb2R1bGU6IFRlc3RpbmdNb2R1bGUgPSBhd2FpdCBUZXN0LmNyZWF0ZVRlc3RpbmdNb2R1bGUoe1xuICAgICAgcHJvdmlkZXJzOiBbXG4gICAgICAgIEJpbGxpbmdTZXJ2aWNlLFxuICAgICAgICB7XG4gICAgICAgICAgcHJvdmlkZTogUHJpc21hU2VydmljZSxcbiAgICAgICAgICB1c2VWYWx1ZTogbW9ja1ByaXNtYSxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSkuY29tcGlsZSgpO1xuXG4gICAgc2VydmljZSA9IG1vZHVsZS5nZXQ8QmlsbGluZ1NlcnZpY2U+KEJpbGxpbmdTZXJ2aWNlKTtcbiAgICBwcmlzbWFTZXJ2aWNlID0gbW9kdWxlLmdldChQcmlzbWFTZXJ2aWNlKTtcbiAgfSk7XG5cbiAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1N1YnNjcmlwdGlvbiBNYW5hZ2VtZW50JywgKCkgPT4ge1xuICAgIGRlc2NyaWJlKCdjcmVhdGVTdWJzY3JpcHRpb24nLCAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrUGxhbiA9IHtcbiAgICAgICAgaWQ6ICdwbGFuLWlkJyxcbiAgICAgICAgbmFtZTogJ1ByZW1pdW0gUGxhbicsXG4gICAgICAgIC8vIHRpZXI6ICdQUkVNSVVNJywgLy8gU3Vic2NyaXB0aW9uVGllciByZW1vdmVkXG4gICAgICAgIG1vbnRobHlQcmljZTogMjkuOTksXG4gICAgICAgIHllYXJseVByaWNlOiAyOTkuOTksXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBtb2NrU3Vic2NyaXB0aW9uRGF0YSA9IHtcbiAgICAgICAgdXNlcklkOiBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgcGxhbklkOiAncGxhbi1pZCcsXG4gICAgICAgIGJpbGxpbmdDeWNsZTogQmlsbGluZ0N5Y2xlLk1PTlRITFksXG4gICAgICB9O1xuXG4gICAgICBpdCgnc2hvdWxkIHN1Y2Nlc3NmdWxseSBjcmVhdGUgYSBtb250aGx5IHN1YnNjcmlwdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgZXhwZWN0ZWRTdWJzY3JpcHRpb24gPSB7XG4gICAgICAgICAgaWQ6ICdzdWJzY3JpcHRpb24taWQnLFxuICAgICAgICAgIHVzZXJJZDogVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgICAgcGxhbklkOiAncGxhbi1pZCcsXG4gICAgICAgICAgLy8gdGllcjogJ1BSRU1JVU0nLCAvLyBTdWJzY3JpcHRpb25UaWVyIHJlbW92ZWRcbiAgICAgICAgICBiaWxsaW5nQ3ljbGU6IEJpbGxpbmdDeWNsZS5NT05USExZLFxuICAgICAgICAgIGFtb3VudDogMjkuOTksXG4gICAgICAgICAgc3RhdHVzOiBTdWJzY3JpcHRpb25TdGF0dXMuQUNUSVZFLFxuICAgICAgICAgIHBsYW46IG1vY2tQbGFuLFxuICAgICAgICAgIGRlZmF1bHRQYXltZW50TWV0aG9kOiBudWxsLFxuICAgICAgICB9O1xuXG4gICAgICAgIChcbiAgICAgICAgICBwcmlzbWFTZXJ2aWNlLnN1YnNjcmlwdGlvblBsYW4uZmluZFVuaXF1ZSBhcyBqZXN0Lk1vY2tcbiAgICAgICAgKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUGxhbik7XG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLnN1YnNjcmlwdGlvbi5jcmVhdGUgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShcbiAgICAgICAgICBleHBlY3RlZFN1YnNjcmlwdGlvbixcbiAgICAgICAgKTtcblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLmNyZWF0ZVN1YnNjcmlwdGlvbihtb2NrU3Vic2NyaXB0aW9uRGF0YSk7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChleHBlY3RlZFN1YnNjcmlwdGlvbik7XG4gICAgICAgIGV4cGVjdChwcmlzbWFTZXJ2aWNlLnN1YnNjcmlwdGlvbi5jcmVhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgICBkYXRhOiBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgICAgICB1c2VySWQ6IFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICAgICAgcGxhbklkOiAncGxhbi1pZCcsXG4gICAgICAgICAgICAvLyB0aWVyOiAnUFJFTUlVTScsIC8vIFN1YnNjcmlwdGlvblRpZXIgcmVtb3ZlZFxuICAgICAgICAgICAgYmlsbGluZ0N5Y2xlOiBCaWxsaW5nQ3ljbGUuTU9OVEhMWSxcbiAgICAgICAgICAgIGFtb3VudDogMjkuOTksXG4gICAgICAgICAgICBzdGF0dXM6IFN1YnNjcmlwdGlvblN0YXR1cy5BQ1RJVkUsXG4gICAgICAgICAgfSksXG4gICAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgICAgcGxhbjogdHJ1ZSxcbiAgICAgICAgICAgIGRlZmF1bHRQYXltZW50TWV0aG9kOiB0cnVlLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgc3VjY2Vzc2Z1bGx5IGNyZWF0ZSBhIHllYXJseSBzdWJzY3JpcHRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHllYXJseURhdGEgPSB7XG4gICAgICAgICAgLi4ubW9ja1N1YnNjcmlwdGlvbkRhdGEsXG4gICAgICAgICAgYmlsbGluZ0N5Y2xlOiBCaWxsaW5nQ3ljbGUuWUVBUkxZLFxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IGV4cGVjdGVkU3Vic2NyaXB0aW9uID0ge1xuICAgICAgICAgIGlkOiAnc3Vic2NyaXB0aW9uLWlkJyxcbiAgICAgICAgICB1c2VySWQ6IFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICAgIGFtb3VudDogMjk5Ljk5LFxuICAgICAgICAgIGJpbGxpbmdDeWNsZTogQmlsbGluZ0N5Y2xlLllFQVJMWSxcbiAgICAgICAgfTtcblxuICAgICAgICAoXG4gICAgICAgICAgcHJpc21hU2VydmljZS5zdWJzY3JpcHRpb25QbGFuLmZpbmRVbmlxdWUgYXMgamVzdC5Nb2NrXG4gICAgICAgICkubW9ja1Jlc29sdmVkVmFsdWUobW9ja1BsYW4pO1xuICAgICAgICAocHJpc21hU2VydmljZS5zdWJzY3JpcHRpb24uY3JlYXRlIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoXG4gICAgICAgICAgZXhwZWN0ZWRTdWJzY3JpcHRpb24sXG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5jcmVhdGVTdWJzY3JpcHRpb24oeWVhcmx5RGF0YSk7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdC5hbW91bnQpLnRvQmUoMjk5Ljk5KTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5iaWxsaW5nQ3ljbGUpLnRvQmUoQmlsbGluZ0N5Y2xlLllFQVJMWSk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBjcmVhdGUgc3Vic2NyaXB0aW9uIHdpdGggdHJpYWwgcGVyaW9kJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCB0cmlhbFN0YXJ0ID0gbmV3IERhdGUoKTtcbiAgICAgICAgY29uc3QgdHJpYWxFbmQgPSBuZXcgRGF0ZSgpO1xuICAgICAgICB0cmlhbEVuZC5zZXREYXRlKHRyaWFsRW5kLmdldERhdGUoKSArIDE0KTtcblxuICAgICAgICBjb25zdCB0cmlhbERhdGEgPSB7XG4gICAgICAgICAgLi4ubW9ja1N1YnNjcmlwdGlvbkRhdGEsXG4gICAgICAgICAgdHJpYWxTdGFydCxcbiAgICAgICAgICB0cmlhbEVuZCxcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBleHBlY3RlZFN1YnNjcmlwdGlvbiA9IHtcbiAgICAgICAgICBpZDogJ3N1YnNjcmlwdGlvbi1pZCcsXG4gICAgICAgICAgc3RhdHVzOiBTdWJzY3JpcHRpb25TdGF0dXMuVFJJQUxJTkcsXG4gICAgICAgICAgdHJpYWxTdGFydCxcbiAgICAgICAgICB0cmlhbEVuZCxcbiAgICAgICAgfTtcblxuICAgICAgICAoXG4gICAgICAgICAgcHJpc21hU2VydmljZS5zdWJzY3JpcHRpb25QbGFuLmZpbmRVbmlxdWUgYXMgamVzdC5Nb2NrXG4gICAgICAgICkubW9ja1Jlc29sdmVkVmFsdWUobW9ja1BsYW4pO1xuICAgICAgICAocHJpc21hU2VydmljZS5zdWJzY3JpcHRpb24uY3JlYXRlIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoXG4gICAgICAgICAgZXhwZWN0ZWRTdWJzY3JpcHRpb24sXG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5jcmVhdGVTdWJzY3JpcHRpb24odHJpYWxEYXRhKTtcblxuICAgICAgICBleHBlY3QocmVzdWx0LnN0YXR1cykudG9CZShTdWJzY3JpcHRpb25TdGF0dXMuVFJJQUxJTkcpO1xuICAgICAgICBleHBlY3QocHJpc21hU2VydmljZS5zdWJzY3JpcHRpb24uY3JlYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgICAgZGF0YTogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgICAgc3RhdHVzOiBTdWJzY3JpcHRpb25TdGF0dXMuVFJJQUxJTkcsXG4gICAgICAgICAgICB0cmlhbFN0YXJ0LFxuICAgICAgICAgICAgdHJpYWxFbmQsXG4gICAgICAgICAgfSksXG4gICAgICAgICAgaW5jbHVkZTogZXhwZWN0LmFueShPYmplY3QpLFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIHRocm93IE5vdEZvdW5kRXhjZXB0aW9uIHdoZW4gcGxhbiBkb2VzIG5vdCBleGlzdCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgKFxuICAgICAgICAgIHByaXNtYVNlcnZpY2Uuc3Vic2NyaXB0aW9uUGxhbi5maW5kVW5pcXVlIGFzIGplc3QuTW9ja1xuICAgICAgICApLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpO1xuXG4gICAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgICBzZXJ2aWNlLmNyZWF0ZVN1YnNjcmlwdGlvbihtb2NrU3Vic2NyaXB0aW9uRGF0YSksXG4gICAgICAgICkucmVqZWN0cy50b1Rocm93KE5vdEZvdW5kRXhjZXB0aW9uKTtcblxuICAgICAgICBleHBlY3QocHJpc21hU2VydmljZS5zdWJzY3JpcHRpb24uY3JlYXRlKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnZmluZFVzZXJTdWJzY3JpcHRpb24nLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIHJldHVybiB1c2VyIHN1YnNjcmlwdGlvbiB3aXRoIGluY2x1ZGVkIGRhdGEnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IG1vY2tTdWJzY3JpcHRpb24gPSB7XG4gICAgICAgICAgaWQ6ICdzdWJzY3JpcHRpb24taWQnLFxuICAgICAgICAgIHVzZXJJZDogVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgICAgcGxhbjogeyBuYW1lOiAnUHJlbWl1bSBQbGFuJyB9LFxuICAgICAgICAgIGRlZmF1bHRQYXltZW50TWV0aG9kOiB7IGNhcmRMYXN0NDogJzQyNDInIH0sXG4gICAgICAgICAgaW52b2ljZXM6IFt7IGlkOiAnaW52b2ljZS0xJyB9XSxcbiAgICAgICAgfTtcblxuICAgICAgICAocHJpc21hU2VydmljZS5zdWJzY3JpcHRpb24uZmluZFVuaXF1ZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKFxuICAgICAgICAgIG1vY2tTdWJzY3JpcHRpb24sXG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5maW5kVXNlclN1YnNjcmlwdGlvbihURVNUX1VTRVJfSURTLkNMSUVOVCk7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2NrU3Vic2NyaXB0aW9uKTtcbiAgICAgICAgZXhwZWN0KHByaXNtYVNlcnZpY2Uuc3Vic2NyaXB0aW9uLmZpbmRVbmlxdWUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgICB3aGVyZTogeyB1c2VySWQ6IFRFU1RfVVNFUl9JRFMuQ0xJRU5UIH0sXG4gICAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgICAgcGxhbjogdHJ1ZSxcbiAgICAgICAgICAgIGRlZmF1bHRQYXltZW50TWV0aG9kOiB0cnVlLFxuICAgICAgICAgICAgaW52b2ljZXM6IHtcbiAgICAgICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LFxuICAgICAgICAgICAgICB0YWtlOiA1LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIHJldHVybiBudWxsIHdoZW4gc3Vic2NyaXB0aW9uIGRvZXMgbm90IGV4aXN0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAocHJpc21hU2VydmljZS5zdWJzY3JpcHRpb24uZmluZFVuaXF1ZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKFxuICAgICAgICAgIG51bGwsXG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5maW5kVXNlclN1YnNjcmlwdGlvbignbm9uLWV4aXN0ZW50LXVzZXInKTtcblxuICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlTnVsbCgpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgndXBkYXRlU3Vic2NyaXB0aW9uJywgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja1N1YnNjcmlwdGlvbiA9IHtcbiAgICAgICAgaWQ6ICdzdWJzY3JpcHRpb24taWQnLFxuICAgICAgICB1c2VySWQ6IFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICBwbGFuSWQ6ICdvbGQtcGxhbi1pZCcsXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBtb2NrTmV3UGxhbiA9IHtcbiAgICAgICAgaWQ6ICduZXctcGxhbi1pZCcsXG4gICAgICAgIC8vIHRpZXI6ICdFTlRFUlBSSVNFJywgLy8gU3Vic2NyaXB0aW9uVGllciByZW1vdmVkXG4gICAgICAgIG1vbnRobHlQcmljZTogOTkuOTksXG4gICAgICAgIHllYXJseVByaWNlOiA5OTkuOTksXG4gICAgICB9O1xuXG4gICAgICBpdCgnc2hvdWxkIHN1Y2Nlc3NmdWxseSB1cGRhdGUgc3Vic2NyaXB0aW9uIHBsYW4nLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHVwZGF0ZURhdGEgPSB7XG4gICAgICAgICAgcGxhbklkOiAnbmV3LXBsYW4taWQnLFxuICAgICAgICAgIGJpbGxpbmdDeWNsZTogQmlsbGluZ0N5Y2xlLk1PTlRITFksXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgdXBkYXRlZFN1YnNjcmlwdGlvbiA9IHtcbiAgICAgICAgICAuLi5tb2NrU3Vic2NyaXB0aW9uLFxuICAgICAgICAgIHBsYW5JZDogJ25ldy1wbGFuLWlkJyxcbiAgICAgICAgICAvLyB0aWVyOiAnRU5URVJQUklTRScsIC8vIFN1YnNjcmlwdGlvblRpZXIgcmVtb3ZlZFxuICAgICAgICAgIGFtb3VudDogOTkuOTksXG4gICAgICAgIH07XG5cbiAgICAgICAgamVzdFxuICAgICAgICAgIC5zcHlPbihzZXJ2aWNlLCAnZmluZFVzZXJTdWJzY3JpcHRpb24nKVxuICAgICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrU3Vic2NyaXB0aW9uIGFzIGFueSk7XG4gICAgICAgIChcbiAgICAgICAgICBwcmlzbWFTZXJ2aWNlLnN1YnNjcmlwdGlvblBsYW4uZmluZFVuaXF1ZSBhcyBqZXN0Lk1vY2tcbiAgICAgICAgKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrTmV3UGxhbik7XG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLnN1YnNjcmlwdGlvbi51cGRhdGUgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShcbiAgICAgICAgICB1cGRhdGVkU3Vic2NyaXB0aW9uLFxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UudXBkYXRlU3Vic2NyaXB0aW9uKFxuICAgICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICAgIHVwZGF0ZURhdGEsXG4gICAgICAgICk7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh1cGRhdGVkU3Vic2NyaXB0aW9uKTtcbiAgICAgICAgZXhwZWN0KHByaXNtYVNlcnZpY2Uuc3Vic2NyaXB0aW9uLnVwZGF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICAgIHdoZXJlOiB7IHVzZXJJZDogVEVTVF9VU0VSX0lEUy5DTElFTlQgfSxcbiAgICAgICAgICBkYXRhOiBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgICAgICBwbGFuSWQ6ICduZXctcGxhbi1pZCcsXG4gICAgICAgICAgICAvLyB0aWVyOiAnRU5URVJQUklTRScsIC8vIFN1YnNjcmlwdGlvblRpZXIgcmVtb3ZlZFxuICAgICAgICAgICAgYW1vdW50OiA5OS45OSxcbiAgICAgICAgICAgIGJpbGxpbmdDeWNsZTogQmlsbGluZ0N5Y2xlLk1PTlRITFksXG4gICAgICAgICAgfSksXG4gICAgICAgICAgaW5jbHVkZTogZXhwZWN0LmFueShPYmplY3QpLFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIHRocm93IE5vdEZvdW5kRXhjZXB0aW9uIHdoZW4gc3Vic2NyaXB0aW9uIGRvZXMgbm90IGV4aXN0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBqZXN0LnNweU9uKHNlcnZpY2UsICdmaW5kVXNlclN1YnNjcmlwdGlvbicpLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpO1xuXG4gICAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgICBzZXJ2aWNlLnVwZGF0ZVN1YnNjcmlwdGlvbignbm9uLWV4aXN0ZW50LXVzZXInLCB7XG4gICAgICAgICAgICBwbGFuSWQ6ICduZXctcGxhbicsXG4gICAgICAgICAgfSksXG4gICAgICAgICkucmVqZWN0cy50b1Rocm93KE5vdEZvdW5kRXhjZXB0aW9uKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIHRocm93IE5vdEZvdW5kRXhjZXB0aW9uIHdoZW4gbmV3IHBsYW4gZG9lcyBub3QgZXhpc3QnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGplc3RcbiAgICAgICAgICAuc3B5T24oc2VydmljZSwgJ2ZpbmRVc2VyU3Vic2NyaXB0aW9uJylcbiAgICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWUobW9ja1N1YnNjcmlwdGlvbiBhcyBhbnkpO1xuICAgICAgICAoXG4gICAgICAgICAgcHJpc21hU2VydmljZS5zdWJzY3JpcHRpb25QbGFuLmZpbmRVbmlxdWUgYXMgamVzdC5Nb2NrXG4gICAgICAgICkubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7XG5cbiAgICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICAgIHNlcnZpY2UudXBkYXRlU3Vic2NyaXB0aW9uKFRFU1RfVVNFUl9JRFMuQ0xJRU5ULCB7XG4gICAgICAgICAgICBwbGFuSWQ6ICdub24tZXhpc3RlbnQtcGxhbicsXG4gICAgICAgICAgfSksXG4gICAgICAgICkucmVqZWN0cy50b1Rocm93KE5vdEZvdW5kRXhjZXB0aW9uKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ2NhbmNlbFN1YnNjcmlwdGlvbicsICgpID0+IHtcbiAgICAgIGl0KCdzaG91bGQgY2FuY2VsIHN1YnNjcmlwdGlvbiBieSB1cGRhdGluZyBzdGF0dXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGNhbmNlbGVkU3Vic2NyaXB0aW9uID0ge1xuICAgICAgICAgIGlkOiAnc3Vic2NyaXB0aW9uLWlkJyxcbiAgICAgICAgICBzdGF0dXM6IFN1YnNjcmlwdGlvblN0YXR1cy5DQU5DRUxFRCxcbiAgICAgICAgfTtcblxuICAgICAgICBqZXN0XG4gICAgICAgICAgLnNweU9uKHNlcnZpY2UsICd1cGRhdGVTdWJzY3JpcHRpb24nKVxuICAgICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZShjYW5jZWxlZFN1YnNjcmlwdGlvbiBhcyBhbnkpO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuY2FuY2VsU3Vic2NyaXB0aW9uKFRFU1RfVVNFUl9JRFMuQ0xJRU5UKTtcblxuICAgICAgICBleHBlY3QocmVzdWx0LnN0YXR1cykudG9CZShTdWJzY3JpcHRpb25TdGF0dXMuQ0FOQ0VMRUQpO1xuICAgICAgICBleHBlY3Qoc2VydmljZS51cGRhdGVTdWJzY3JpcHRpb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHN0YXR1czogU3Vic2NyaXB0aW9uU3RhdHVzLkNBTkNFTEVELFxuICAgICAgICAgIH0sXG4gICAgICAgICk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1N1YnNjcmlwdGlvbiBQbGFucycsICgpID0+IHtcbiAgICBkZXNjcmliZSgnY3JlYXRlU3Vic2NyaXB0aW9uUGxhbicsICgpID0+IHtcbiAgICAgIGl0KCdzaG91bGQgc3VjY2Vzc2Z1bGx5IGNyZWF0ZSBhIHN1YnNjcmlwdGlvbiBwbGFuJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBwbGFuRGF0YSA9IHtcbiAgICAgICAgICBuYW1lOiAnUHJlbWl1bSBQbGFuJyxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogJ0Z1bGwgYWNjZXNzIHBsYW4nLFxuICAgICAgICAgIC8vIHRpZXI6ICdQUkVNSVVNJywgLy8gU3Vic2NyaXB0aW9uVGllciByZW1vdmVkXG4gICAgICAgICAgbW9udGhseVByaWNlOiAyOS45OSxcbiAgICAgICAgICB5ZWFybHlQcmljZTogMjk5Ljk5LFxuICAgICAgICAgIGZlYXR1cmVzOiB7IHNlc3Npb25zOiAndW5saW1pdGVkJywgc3RvcmFnZTogJzEwMEdCJyB9LFxuICAgICAgICAgIGxpbWl0czogeyBjbGllbnRzOiA1MCB9LFxuICAgICAgICAgIHRyaWFsRGF5czogMTQsXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgZXhwZWN0ZWRQbGFuID0ge1xuICAgICAgICAgIGlkOiAncGxhbi1pZCcsXG4gICAgICAgICAgLi4ucGxhbkRhdGEsXG4gICAgICAgIH07XG5cbiAgICAgICAgKHByaXNtYVNlcnZpY2Uuc3Vic2NyaXB0aW9uUGxhbi5jcmVhdGUgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShcbiAgICAgICAgICBleHBlY3RlZFBsYW4sXG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5jcmVhdGVTdWJzY3JpcHRpb25QbGFuKHBsYW5EYXRhKTtcblxuICAgICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKGV4cGVjdGVkUGxhbik7XG4gICAgICAgIGV4cGVjdChwcmlzbWFTZXJ2aWNlLnN1YnNjcmlwdGlvblBsYW4uY3JlYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgICAgZGF0YTogcGxhbkRhdGEsXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnZmluZEFsbFBsYW5zJywgKCkgPT4ge1xuICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gYWN0aXZlIHBsYW5zIGJ5IGRlZmF1bHQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IG1vY2tQbGFucyA9IFtcbiAgICAgICAgICB7IGlkOiAncGxhbi0xJywgbmFtZTogJ0Jhc2ljJywgbW9udGhseVByaWNlOiA5Ljk5IH0sXG4gICAgICAgICAgeyBpZDogJ3BsYW4tMicsIG5hbWU6ICdQcmVtaXVtJywgbW9udGhseVByaWNlOiAyOS45OSB9LFxuICAgICAgICBdO1xuXG4gICAgICAgIChcbiAgICAgICAgICBwcmlzbWFTZXJ2aWNlLnN1YnNjcmlwdGlvblBsYW4uZmluZE1hbnkgYXMgamVzdC5Nb2NrXG4gICAgICAgICkubW9ja1Jlc29sdmVkVmFsdWUobW9ja1BsYW5zKTtcblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLmZpbmRBbGxQbGFucygpO1xuXG4gICAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja1BsYW5zKTtcbiAgICAgICAgZXhwZWN0KHByaXNtYVNlcnZpY2Uuc3Vic2NyaXB0aW9uUGxhbi5maW5kTWFueSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICAgIHdoZXJlOiB7IGlzQWN0aXZlOiB0cnVlIH0sXG4gICAgICAgICAgb3JkZXJCeTogeyBtb250aGx5UHJpY2U6ICdhc2MnIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgcmV0dXJuIGluYWN0aXZlIHBsYW5zIHdoZW4gc3BlY2lmaWVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBhd2FpdCBzZXJ2aWNlLmZpbmRBbGxQbGFucyhmYWxzZSk7XG5cbiAgICAgICAgZXhwZWN0KHByaXNtYVNlcnZpY2Uuc3Vic2NyaXB0aW9uUGxhbi5maW5kTWFueSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICAgIHdoZXJlOiB7IGlzQWN0aXZlOiBmYWxzZSB9LFxuICAgICAgICAgIG9yZGVyQnk6IHsgbW9udGhseVByaWNlOiAnYXNjJyB9LFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ3VwZGF0ZVBsYW4nLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIHN1Y2Nlc3NmdWxseSB1cGRhdGUgcGxhbicsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgdXBkYXRlRGF0YSA9IHtcbiAgICAgICAgICBuYW1lOiAnVXBkYXRlZCBQbGFuJyxcbiAgICAgICAgICBtb250aGx5UHJpY2U6IDM5Ljk5LFxuICAgICAgICAgIGZlYXR1cmVzOiB7IG5ld0ZlYXR1cmU6IHRydWUgfSxcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCB1cGRhdGVkUGxhbiA9IHtcbiAgICAgICAgICBpZDogJ3BsYW4taWQnLFxuICAgICAgICAgIC4uLnVwZGF0ZURhdGEsXG4gICAgICAgIH07XG5cbiAgICAgICAgKHByaXNtYVNlcnZpY2Uuc3Vic2NyaXB0aW9uUGxhbi51cGRhdGUgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShcbiAgICAgICAgICB1cGRhdGVkUGxhbixcbiAgICAgICAgKTtcblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLnVwZGF0ZVBsYW4oJ3BsYW4taWQnLCB1cGRhdGVEYXRhKTtcblxuICAgICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHVwZGF0ZWRQbGFuKTtcbiAgICAgICAgZXhwZWN0KHByaXNtYVNlcnZpY2Uuc3Vic2NyaXB0aW9uUGxhbi51cGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgICB3aGVyZTogeyBpZDogJ3BsYW4taWQnIH0sXG4gICAgICAgICAgZGF0YTogdXBkYXRlRGF0YSxcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1BheW1lbnQgTWV0aG9kcycsICgpID0+IHtcbiAgICBkZXNjcmliZSgnY3JlYXRlUGF5bWVudE1ldGhvZCcsICgpID0+IHtcbiAgICAgIGl0KCdzaG91bGQgY3JlYXRlIHBheW1lbnQgbWV0aG9kIGFuZCBzZXQgYXMgZGVmYXVsdCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgcGF5bWVudE1ldGhvZERhdGEgPSB7XG4gICAgICAgICAgdXNlcklkOiBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgICB0eXBlOiBQYXltZW50TWV0aG9kVHlwZS5DQVJELFxuICAgICAgICAgIGNhcmRMYXN0NDogJzQyNDInLFxuICAgICAgICAgIGNhcmRCcmFuZDogJ3Zpc2EnLFxuICAgICAgICAgIGNhcmRFeHBNb250aDogMTIsXG4gICAgICAgICAgY2FyZEV4cFllYXI6IDIwMjUsXG4gICAgICAgICAgaXNEZWZhdWx0OiB0cnVlLFxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IGV4cGVjdGVkUGF5bWVudE1ldGhvZCA9IHtcbiAgICAgICAgICBpZDogJ3BheW1lbnQtbWV0aG9kLWlkJyxcbiAgICAgICAgICAuLi5wYXltZW50TWV0aG9kRGF0YSxcbiAgICAgICAgfTtcblxuICAgICAgICAocHJpc21hU2VydmljZS5wYXltZW50TWV0aG9kLnVwZGF0ZU1hbnkgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShcbiAgICAgICAgICB7IGNvdW50OiAxIH0sXG4gICAgICAgICk7XG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLnBheW1lbnRNZXRob2QuY3JlYXRlIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoXG4gICAgICAgICAgZXhwZWN0ZWRQYXltZW50TWV0aG9kLFxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuY3JlYXRlUGF5bWVudE1ldGhvZChwYXltZW50TWV0aG9kRGF0YSk7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChleHBlY3RlZFBheW1lbnRNZXRob2QpO1xuICAgICAgICBleHBlY3QocHJpc21hU2VydmljZS5wYXltZW50TWV0aG9kLnVwZGF0ZU1hbnkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgICB3aGVyZTogeyB1c2VySWQ6IFRFU1RfVVNFUl9JRFMuQ0xJRU5ULCBpc0RlZmF1bHQ6IHRydWUgfSxcbiAgICAgICAgICBkYXRhOiB7IGlzRGVmYXVsdDogZmFsc2UgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIGV4cGVjdChwcmlzbWFTZXJ2aWNlLnBheW1lbnRNZXRob2QuY3JlYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgICAgZGF0YTogcGF5bWVudE1ldGhvZERhdGEsXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgY3JlYXRlIHBheW1lbnQgbWV0aG9kIHdpdGhvdXQgc2V0dGluZyBhcyBkZWZhdWx0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBwYXltZW50TWV0aG9kRGF0YSA9IHtcbiAgICAgICAgICB1c2VySWQ6IFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICAgIHR5cGU6IFBheW1lbnRNZXRob2RUeXBlLkNBUkQsXG4gICAgICAgICAgY2FyZExhc3Q0OiAnNDI0MicsXG4gICAgICAgIH07XG5cbiAgICAgICAgKHByaXNtYVNlcnZpY2UucGF5bWVudE1ldGhvZC5jcmVhdGUgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShcbiAgICAgICAgICBwYXltZW50TWV0aG9kRGF0YSxcbiAgICAgICAgKTtcblxuICAgICAgICBhd2FpdCBzZXJ2aWNlLmNyZWF0ZVBheW1lbnRNZXRob2QocGF5bWVudE1ldGhvZERhdGEpO1xuXG4gICAgICAgIGV4cGVjdChwcmlzbWFTZXJ2aWNlLnBheW1lbnRNZXRob2QudXBkYXRlTWFueSkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ2ZpbmRVc2VyUGF5bWVudE1ldGhvZHMnLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIHJldHVybiB1c2VyIHBheW1lbnQgbWV0aG9kcyBvcmRlcmVkIGJ5IGRlZmF1bHQgYW5kIGNyZWF0aW9uIGRhdGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IG1vY2tQYXltZW50TWV0aG9kcyA9IFtcbiAgICAgICAgICB7IGlkOiAncG0tMScsIGlzRGVmYXVsdDogdHJ1ZSwgY2FyZExhc3Q0OiAnNDI0MicgfSxcbiAgICAgICAgICB7IGlkOiAncG0tMicsIGlzRGVmYXVsdDogZmFsc2UsIGNhcmRMYXN0NDogJzEyMzQnIH0sXG4gICAgICAgIF07XG5cbiAgICAgICAgKHByaXNtYVNlcnZpY2UucGF5bWVudE1ldGhvZC5maW5kTWFueSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKFxuICAgICAgICAgIG1vY2tQYXltZW50TWV0aG9kcyxcbiAgICAgICAgKTtcblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLmZpbmRVc2VyUGF5bWVudE1ldGhvZHMoXG4gICAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgICk7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2NrUGF5bWVudE1ldGhvZHMpO1xuICAgICAgICBleHBlY3QocHJpc21hU2VydmljZS5wYXltZW50TWV0aG9kLmZpbmRNYW55KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgICAgd2hlcmU6IHsgdXNlcklkOiBURVNUX1VTRVJfSURTLkNMSUVOVCwgaXNBY3RpdmU6IHRydWUgfSxcbiAgICAgICAgICBvcmRlckJ5OiBbeyBpc0RlZmF1bHQ6ICdkZXNjJyB9LCB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH1dLFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ3VwZGF0ZVBheW1lbnRNZXRob2QnLCAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrUGF5bWVudE1ldGhvZCA9IHtcbiAgICAgICAgaWQ6ICdwYXltZW50LW1ldGhvZC1pZCcsXG4gICAgICAgIHVzZXJJZDogVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICB9O1xuXG4gICAgICBpdCgnc2hvdWxkIHN1Y2Nlc3NmdWxseSB1cGRhdGUgcGF5bWVudCBtZXRob2QnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHVwZGF0ZURhdGEgPSB7IGlzRGVmYXVsdDogdHJ1ZSB9O1xuICAgICAgICBjb25zdCB1cGRhdGVkUGF5bWVudE1ldGhvZCA9IHsgLi4ubW9ja1BheW1lbnRNZXRob2QsIC4uLnVwZGF0ZURhdGEgfTtcblxuICAgICAgICAocHJpc21hU2VydmljZS5wYXltZW50TWV0aG9kLmZpbmRVbmlxdWUgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShcbiAgICAgICAgICBtb2NrUGF5bWVudE1ldGhvZCxcbiAgICAgICAgKTtcbiAgICAgICAgKHByaXNtYVNlcnZpY2UucGF5bWVudE1ldGhvZC51cGRhdGVNYW55IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoXG4gICAgICAgICAgeyBjb3VudDogMSB9LFxuICAgICAgICApO1xuICAgICAgICAocHJpc21hU2VydmljZS5wYXltZW50TWV0aG9kLnVwZGF0ZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKFxuICAgICAgICAgIHVwZGF0ZWRQYXltZW50TWV0aG9kLFxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UudXBkYXRlUGF5bWVudE1ldGhvZChcbiAgICAgICAgICAncGF5bWVudC1tZXRob2QtaWQnLFxuICAgICAgICAgIHVwZGF0ZURhdGEsXG4gICAgICAgICk7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh1cGRhdGVkUGF5bWVudE1ldGhvZCk7XG4gICAgICAgIGV4cGVjdChwcmlzbWFTZXJ2aWNlLnBheW1lbnRNZXRob2QudXBkYXRlTWFueSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICAgIHdoZXJlOiB7IHVzZXJJZDogVEVTVF9VU0VSX0lEUy5DTElFTlQsIGlzRGVmYXVsdDogdHJ1ZSB9LFxuICAgICAgICAgIGRhdGE6IHsgaXNEZWZhdWx0OiBmYWxzZSB9LFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIHRocm93IE5vdEZvdW5kRXhjZXB0aW9uIHdoZW4gcGF5bWVudCBtZXRob2QgZG9lcyBub3QgZXhpc3QnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLnBheW1lbnRNZXRob2QuZmluZFVuaXF1ZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKFxuICAgICAgICAgIG51bGwsXG4gICAgICAgICk7XG5cbiAgICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICAgIHNlcnZpY2UudXBkYXRlUGF5bWVudE1ldGhvZCgnbm9uLWV4aXN0ZW50LWlkJywgeyBpc0RlZmF1bHQ6IHRydWUgfSksXG4gICAgICAgICkucmVqZWN0cy50b1Rocm93KE5vdEZvdW5kRXhjZXB0aW9uKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ2RlbGV0ZVBheW1lbnRNZXRob2QnLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIHNvZnQgZGVsZXRlIHBheW1lbnQgbWV0aG9kIGJ5IHNldHRpbmcgaXNBY3RpdmUgdG8gZmFsc2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGRlYWN0aXZhdGVkUGF5bWVudE1ldGhvZCA9IHtcbiAgICAgICAgICBpZDogJ3BheW1lbnQtbWV0aG9kLWlkJyxcbiAgICAgICAgICBpc0FjdGl2ZTogZmFsc2UsXG4gICAgICAgIH07XG5cbiAgICAgICAgKHByaXNtYVNlcnZpY2UucGF5bWVudE1ldGhvZC51cGRhdGUgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShcbiAgICAgICAgICBkZWFjdGl2YXRlZFBheW1lbnRNZXRob2QsXG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5kZWxldGVQYXltZW50TWV0aG9kKCdwYXltZW50LW1ldGhvZC1pZCcpO1xuXG4gICAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoZGVhY3RpdmF0ZWRQYXltZW50TWV0aG9kKTtcbiAgICAgICAgZXhwZWN0KHByaXNtYVNlcnZpY2UucGF5bWVudE1ldGhvZC51cGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgICB3aGVyZTogeyBpZDogJ3BheW1lbnQtbWV0aG9kLWlkJyB9LFxuICAgICAgICAgIGRhdGE6IHsgaXNBY3RpdmU6IGZhbHNlIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdQYXltZW50cycsICgpID0+IHtcbiAgICBkZXNjcmliZSgnY3JlYXRlUGF5bWVudCcsICgpID0+IHtcbiAgICAgIGl0KCdzaG91bGQgY3JlYXRlIHBheW1lbnQgd2l0aCBkZWZhdWx0IHZhbHVlcycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgcGF5bWVudERhdGEgPSB7XG4gICAgICAgICAgYW1vdW50OiAyOS45OSxcbiAgICAgICAgICBwYXltZW50TWV0aG9kSWQ6ICdwYXltZW50LW1ldGhvZC1pZCcsXG4gICAgICAgICAgc3Vic2NyaXB0aW9uSWQ6ICdzdWJzY3JpcHRpb24taWQnLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAnTW9udGhseSBzdWJzY3JpcHRpb24nLFxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IGV4cGVjdGVkUGF5bWVudCA9IHtcbiAgICAgICAgICBpZDogJ3BheW1lbnQtaWQnLFxuICAgICAgICAgIC4uLnBheW1lbnREYXRhLFxuICAgICAgICAgIHN0YXR1czogUGF5bWVudFN0YXR1cy5QRU5ESU5HLFxuICAgICAgICAgIGN1cnJlbmN5OiAnVVNEJyxcbiAgICAgICAgICBwYXltZW50TWV0aG9kOiB7IGNhcmRMYXN0NDogJzQyNDInIH0sXG4gICAgICAgICAgc3Vic2NyaXB0aW9uOiB7IC8qIHRpZXI6ICdQUkVNSVVNJyAqLyB9LCAvLyBTdWJzY3JpcHRpb25UaWVyIHJlbW92ZWRcbiAgICAgICAgICBpbnZvaWNlOiBudWxsLFxuICAgICAgICB9O1xuXG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLnBheW1lbnQuY3JlYXRlIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoXG4gICAgICAgICAgZXhwZWN0ZWRQYXltZW50LFxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuY3JlYXRlUGF5bWVudChwYXltZW50RGF0YSk7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChleHBlY3RlZFBheW1lbnQpO1xuICAgICAgICBleHBlY3QocHJpc21hU2VydmljZS5wYXltZW50LmNyZWF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgIC4uLnBheW1lbnREYXRhLFxuICAgICAgICAgICAgc3RhdHVzOiBQYXltZW50U3RhdHVzLlBFTkRJTkcsXG4gICAgICAgICAgICBjdXJyZW5jeTogJ1VTRCcsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgICBwYXltZW50TWV0aG9kOiB0cnVlLFxuICAgICAgICAgICAgc3Vic2NyaXB0aW9uOiB0cnVlLFxuICAgICAgICAgICAgaW52b2ljZTogdHJ1ZSxcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIGNyZWF0ZSBwYXltZW50IHdpdGggY3VzdG9tIGN1cnJlbmN5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBwYXltZW50RGF0YSA9IHtcbiAgICAgICAgICBhbW91bnQ6IDI1Ljk5LFxuICAgICAgICAgIGN1cnJlbmN5OiAnRVVSJyxcbiAgICAgICAgfTtcblxuICAgICAgICAocHJpc21hU2VydmljZS5wYXltZW50LmNyZWF0ZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICBpZDogJ3BheW1lbnQtaWQnLFxuICAgICAgICAgIGN1cnJlbmN5OiAnRVVSJyxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgYXdhaXQgc2VydmljZS5jcmVhdGVQYXltZW50KHBheW1lbnREYXRhKTtcblxuICAgICAgICBleHBlY3QocHJpc21hU2VydmljZS5wYXltZW50LmNyZWF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICAgIGRhdGE6IGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICAgIGN1cnJlbmN5OiAnRVVSJyxcbiAgICAgICAgICB9KSxcbiAgICAgICAgICBpbmNsdWRlOiBleHBlY3QuYW55KE9iamVjdCksXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgndXBkYXRlUGF5bWVudFN0YXR1cycsICgpID0+IHtcbiAgICAgIGl0KCdzaG91bGQgdXBkYXRlIHBheW1lbnQgc3RhdHVzIHRvIHN1Y2NlZWRlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgdXBkYXRlZFBheW1lbnQgPSB7XG4gICAgICAgICAgaWQ6ICdwYXltZW50LWlkJyxcbiAgICAgICAgICBzdGF0dXM6IFBheW1lbnRTdGF0dXMuU1VDQ0VFREVELFxuICAgICAgICAgIHByb2Nlc3NlZEF0OiBleHBlY3QuYW55KERhdGUpLFxuICAgICAgICB9O1xuXG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLnBheW1lbnQudXBkYXRlIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoXG4gICAgICAgICAgdXBkYXRlZFBheW1lbnQsXG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS51cGRhdGVQYXltZW50U3RhdHVzKFxuICAgICAgICAgICdwYXltZW50LWlkJyxcbiAgICAgICAgICBQYXltZW50U3RhdHVzLlNVQ0NFRURFRCxcbiAgICAgICAgKTtcblxuICAgICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHVwZGF0ZWRQYXltZW50KTtcbiAgICAgICAgZXhwZWN0KHByaXNtYVNlcnZpY2UucGF5bWVudC51cGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgICB3aGVyZTogeyBpZDogJ3BheW1lbnQtaWQnIH0sXG4gICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgc3RhdHVzOiBQYXltZW50U3RhdHVzLlNVQ0NFRURFRCxcbiAgICAgICAgICAgIHByb2Nlc3NlZEF0OiBleHBlY3QuYW55KERhdGUpLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgdXBkYXRlIHBheW1lbnQgc3RhdHVzIHRvIGZhaWxlZCB3aXRoIG1ldGFkYXRhJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBtZXRhZGF0YSA9IHtcbiAgICAgICAgICBmYWlsdXJlQ29kZTogJ2NhcmRfZGVjbGluZWQnLFxuICAgICAgICAgIGZhaWx1cmVNZXNzYWdlOiAnWW91ciBjYXJkIHdhcyBkZWNsaW5lZC4nLFxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IHVwZGF0ZWRQYXltZW50ID0ge1xuICAgICAgICAgIGlkOiAncGF5bWVudC1pZCcsXG4gICAgICAgICAgc3RhdHVzOiBQYXltZW50U3RhdHVzLkZBSUxFRCxcbiAgICAgICAgICBmYWlsZWRBdDogZXhwZWN0LmFueShEYXRlKSxcbiAgICAgICAgICBmYWlsdXJlQ29kZTogJ2NhcmRfZGVjbGluZWQnLFxuICAgICAgICAgIGZhaWx1cmVNZXNzYWdlOiAnWW91ciBjYXJkIHdhcyBkZWNsaW5lZC4nLFxuICAgICAgICB9O1xuXG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLnBheW1lbnQudXBkYXRlIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoXG4gICAgICAgICAgdXBkYXRlZFBheW1lbnQsXG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS51cGRhdGVQYXltZW50U3RhdHVzKFxuICAgICAgICAgICdwYXltZW50LWlkJyxcbiAgICAgICAgICBQYXltZW50U3RhdHVzLkZBSUxFRCxcbiAgICAgICAgICBtZXRhZGF0YSxcbiAgICAgICAgKTtcblxuICAgICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHVwZGF0ZWRQYXltZW50KTtcbiAgICAgICAgZXhwZWN0KHByaXNtYVNlcnZpY2UucGF5bWVudC51cGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgICB3aGVyZTogeyBpZDogJ3BheW1lbnQtaWQnIH0sXG4gICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgc3RhdHVzOiBQYXltZW50U3RhdHVzLkZBSUxFRCxcbiAgICAgICAgICAgIGZhaWxlZEF0OiBleHBlY3QuYW55KERhdGUpLFxuICAgICAgICAgICAgZmFpbHVyZUNvZGU6ICdjYXJkX2RlY2xpbmVkJyxcbiAgICAgICAgICAgIGZhaWx1cmVNZXNzYWdlOiAnWW91ciBjYXJkIHdhcyBkZWNsaW5lZC4nLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnZmluZFBheW1lbnRzJywgKCkgPT4ge1xuICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gcGF5bWVudHMgd2l0aCBmaWx0ZXJzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBtb2NrUGF5bWVudHMgPSBbXG4gICAgICAgICAgeyBpZDogJ3BheW1lbnQtMScsIHN0YXR1czogUGF5bWVudFN0YXR1cy5TVUNDRUVERUQgfSxcbiAgICAgICAgICB7IGlkOiAncGF5bWVudC0yJywgc3RhdHVzOiBQYXltZW50U3RhdHVzLlNVQ0NFRURFRCB9LFxuICAgICAgICBdO1xuXG4gICAgICAgIGNvbnN0IHN0YXJ0RGF0ZSA9IG5ldyBEYXRlKCcyMDI0LTAxLTAxJyk7XG4gICAgICAgIGNvbnN0IGVuZERhdGUgPSBuZXcgRGF0ZSgnMjAyNC0wMS0zMScpO1xuXG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLnBheW1lbnQuZmluZE1hbnkgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShcbiAgICAgICAgICBtb2NrUGF5bWVudHMsXG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5maW5kUGF5bWVudHMoXG4gICAgICAgICAgJ3N1YnNjcmlwdGlvbi1pZCcsXG4gICAgICAgICAgUGF5bWVudFN0YXR1cy5TVUNDRUVERUQsXG4gICAgICAgICAgc3RhcnREYXRlLFxuICAgICAgICAgIGVuZERhdGUsXG4gICAgICAgICk7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2NrUGF5bWVudHMpO1xuICAgICAgICBleHBlY3QocHJpc21hU2VydmljZS5wYXltZW50LmZpbmRNYW55KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgIHN1YnNjcmlwdGlvbklkOiAnc3Vic2NyaXB0aW9uLWlkJyxcbiAgICAgICAgICAgIHN0YXR1czogUGF5bWVudFN0YXR1cy5TVUNDRUVERUQsXG4gICAgICAgICAgICBjcmVhdGVkQXQ6IHtcbiAgICAgICAgICAgICAgZ3RlOiBzdGFydERhdGUsXG4gICAgICAgICAgICAgIGx0ZTogZW5kRGF0ZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgICBwYXltZW50TWV0aG9kOiB0cnVlLFxuICAgICAgICAgICAgc3Vic2NyaXB0aW9uOiB0cnVlLFxuICAgICAgICAgICAgaW52b2ljZTogdHJ1ZSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfSxcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0ludm9pY2VzJywgKCkgPT4ge1xuICAgIGRlc2NyaWJlKCdjcmVhdGVJbnZvaWNlJywgKCkgPT4ge1xuICAgICAgaXQoJ3Nob3VsZCBjcmVhdGUgaW52b2ljZSB3aXRoIGNhbGN1bGF0ZWQgdG90YWwnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGludm9pY2VEYXRhID0ge1xuICAgICAgICAgIHN1YnNjcmlwdGlvbklkOiAnc3Vic2NyaXB0aW9uLWlkJyxcbiAgICAgICAgICBzdWJ0b3RhbDogMTAwLFxuICAgICAgICAgIHRheEFtb3VudDogMTAsXG4gICAgICAgICAgZGlzY291bnRBbW91bnQ6IDUsXG4gICAgICAgICAgZHVlRGF0ZTogbmV3IERhdGUoJzIwMjQtMDItMDEnKSxcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBleHBlY3RlZEludm9pY2UgPSB7XG4gICAgICAgICAgaWQ6ICdpbnZvaWNlLWlkJyxcbiAgICAgICAgICAuLi5pbnZvaWNlRGF0YSxcbiAgICAgICAgICBudW1iZXI6ICdJTlYtMjAyNC0wMDAwMDEnLFxuICAgICAgICAgIHRvdGFsOiAxMDUsIC8vIDEwMCArIDEwIC0gNVxuICAgICAgICAgIGFtb3VudER1ZTogMTA1LFxuICAgICAgICAgIHN0YXR1czogSW52b2ljZVN0YXR1cy5PUEVOLFxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIE1vY2sgZ2VuZXJhdGVJbnZvaWNlTnVtYmVyXG4gICAgICAgIGplc3RcbiAgICAgICAgICAuc3B5T24oc2VydmljZSBhcyBhbnksICdnZW5lcmF0ZUludm9pY2VOdW1iZXInKVxuICAgICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZSgnSU5WLTIwMjQtMDAwMDAxJyk7XG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLmludm9pY2UuY3JlYXRlIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoXG4gICAgICAgICAgZXhwZWN0ZWRJbnZvaWNlLFxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuY3JlYXRlSW52b2ljZShpbnZvaWNlRGF0YSk7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChleHBlY3RlZEludm9pY2UpO1xuICAgICAgICBleHBlY3QocHJpc21hU2VydmljZS5pbnZvaWNlLmNyZWF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgIC4uLmludm9pY2VEYXRhLFxuICAgICAgICAgICAgbnVtYmVyOiAnSU5WLTIwMjQtMDAwMDAxJyxcbiAgICAgICAgICAgIHRvdGFsOiAxMDUsXG4gICAgICAgICAgICBhbW91bnREdWU6IDEwNSxcbiAgICAgICAgICAgIHN0YXR1czogSW52b2ljZVN0YXR1cy5PUEVOLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgICAgc3Vic2NyaXB0aW9uOiB0cnVlLFxuICAgICAgICAgICAgbGluZUl0ZW1zOiB0cnVlLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnZmluZEludm9pY2VzJywgKCkgPT4ge1xuICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gaW52b2ljZXMgd2l0aCBmaWx0ZXJzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBtb2NrSW52b2ljZXMgPSBbXG4gICAgICAgICAgeyBpZDogJ2ludm9pY2UtMScsIHN0YXR1czogSW52b2ljZVN0YXR1cy5PUEVOIH0sXG4gICAgICAgICAgeyBpZDogJ2ludm9pY2UtMicsIHN0YXR1czogSW52b2ljZVN0YXR1cy5QQUlEIH0sXG4gICAgICAgIF07XG5cbiAgICAgICAgKHByaXNtYVNlcnZpY2UuaW52b2ljZS5maW5kTWFueSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKFxuICAgICAgICAgIG1vY2tJbnZvaWNlcyxcbiAgICAgICAgKTtcblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLmZpbmRJbnZvaWNlcyhcbiAgICAgICAgICAnc3Vic2NyaXB0aW9uLWlkJyxcbiAgICAgICAgICBJbnZvaWNlU3RhdHVzLk9QRU4sXG4gICAgICAgICk7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2NrSW52b2ljZXMpO1xuICAgICAgICBleHBlY3QocHJpc21hU2VydmljZS5pbnZvaWNlLmZpbmRNYW55KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgIHN1YnNjcmlwdGlvbklkOiAnc3Vic2NyaXB0aW9uLWlkJyxcbiAgICAgICAgICAgIHN0YXR1czogSW52b2ljZVN0YXR1cy5PUEVOLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgICAgc3Vic2NyaXB0aW9uOiB7XG4gICAgICAgICAgICAgIGluY2x1ZGU6IHsgdXNlcjogdHJ1ZSB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGxpbmVJdGVtczogdHJ1ZSxcbiAgICAgICAgICAgIHBheW1lbnRzOiB0cnVlLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ21hcmtJbnZvaWNlQXNQYWlkJywgKCkgPT4ge1xuICAgICAgaXQoJ3Nob3VsZCBtYXJrIGludm9pY2UgYXMgcGFpZCB3aGVuIGZ1bGx5IHBhaWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IG1vY2tJbnZvaWNlID0ge1xuICAgICAgICAgIGlkOiAnaW52b2ljZS1pZCcsXG4gICAgICAgICAgdG90YWw6IDEwMCxcbiAgICAgICAgICBwYXltZW50czogW1xuICAgICAgICAgICAgeyBhbW91bnQ6IDYwLCBzdGF0dXM6IFBheW1lbnRTdGF0dXMuU1VDQ0VFREVEIH0sXG4gICAgICAgICAgICB7IGFtb3VudDogNDAsIHN0YXR1czogUGF5bWVudFN0YXR1cy5TVUNDRUVERUQgfSxcbiAgICAgICAgICBdLFxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IHVwZGF0ZWRJbnZvaWNlID0ge1xuICAgICAgICAgIC4uLm1vY2tJbnZvaWNlLFxuICAgICAgICAgIHN0YXR1czogSW52b2ljZVN0YXR1cy5QQUlELFxuICAgICAgICAgIGFtb3VudFBhaWQ6IDEwMCxcbiAgICAgICAgICBwYWlkQXQ6IGV4cGVjdC5hbnkoRGF0ZSksXG4gICAgICAgIH07XG5cbiAgICAgICAgKHByaXNtYVNlcnZpY2UuaW52b2ljZS5maW5kVW5pcXVlIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoXG4gICAgICAgICAgbW9ja0ludm9pY2UsXG4gICAgICAgICk7XG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLmludm9pY2UudXBkYXRlIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoXG4gICAgICAgICAgdXBkYXRlZEludm9pY2UsXG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5tYXJrSW52b2ljZUFzUGFpZCgnaW52b2ljZS1pZCcpO1xuXG4gICAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwodXBkYXRlZEludm9pY2UpO1xuICAgICAgICBleHBlY3QocHJpc21hU2VydmljZS5pbnZvaWNlLnVwZGF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICAgIHdoZXJlOiB7IGlkOiAnaW52b2ljZS1pZCcgfSxcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBzdGF0dXM6IEludm9pY2VTdGF0dXMuUEFJRCxcbiAgICAgICAgICAgIGFtb3VudFBhaWQ6IDEwMCxcbiAgICAgICAgICAgIHBhaWRBdDogZXhwZWN0LmFueShEYXRlKSxcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIGtlZXAgaW52b2ljZSBvcGVuIHdoZW4gcGFydGlhbGx5IHBhaWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IG1vY2tJbnZvaWNlID0ge1xuICAgICAgICAgIGlkOiAnaW52b2ljZS1pZCcsXG4gICAgICAgICAgdG90YWw6IDEwMCxcbiAgICAgICAgICBwYXltZW50czogW1xuICAgICAgICAgICAgeyBhbW91bnQ6IDMwLCBzdGF0dXM6IFBheW1lbnRTdGF0dXMuU1VDQ0VFREVEIH0sXG4gICAgICAgICAgICB7IGFtb3VudDogMjAsIHN0YXR1czogUGF5bWVudFN0YXR1cy5GQUlMRUQgfSxcbiAgICAgICAgICBdLFxuICAgICAgICB9O1xuXG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLmludm9pY2UuZmluZFVuaXF1ZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKFxuICAgICAgICAgIG1vY2tJbnZvaWNlLFxuICAgICAgICApO1xuICAgICAgICAocHJpc21hU2VydmljZS5pbnZvaWNlLnVwZGF0ZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICAuLi5tb2NrSW52b2ljZSxcbiAgICAgICAgICBzdGF0dXM6IEludm9pY2VTdGF0dXMuT1BFTixcbiAgICAgICAgICBhbW91bnRQYWlkOiAzMCxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5tYXJrSW52b2ljZUFzUGFpZCgnaW52b2ljZS1pZCcpO1xuXG4gICAgICAgIGV4cGVjdChyZXN1bHQuc3RhdHVzKS50b0JlKEludm9pY2VTdGF0dXMuT1BFTik7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuYW1vdW50UGFpZCkudG9CZSgzMCk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCB0aHJvdyBOb3RGb3VuZEV4Y2VwdGlvbiB3aGVuIGludm9pY2UgZG9lcyBub3QgZXhpc3QnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLmludm9pY2UuZmluZFVuaXF1ZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpO1xuXG4gICAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgICBzZXJ2aWNlLm1hcmtJbnZvaWNlQXNQYWlkKCdub24tZXhpc3RlbnQtaWQnKSxcbiAgICAgICAgKS5yZWplY3RzLnRvVGhyb3coTm90Rm91bmRFeGNlcHRpb24pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdEaXNjb3VudHMnLCAoKSA9PiB7XG4gICAgZGVzY3JpYmUoJ2NyZWF0ZURpc2NvdW50JywgKCkgPT4ge1xuICAgICAgaXQoJ3Nob3VsZCBjcmVhdGUgZGlzY291bnQgd2l0aCBkZWZhdWx0IHZhbGlkIGZyb20gZGF0ZScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgZGlzY291bnREYXRhID0ge1xuICAgICAgICAgIGNvZGU6ICdTQVZFMjAnLFxuICAgICAgICAgIG5hbWU6ICcyMCUgT2ZmJyxcbiAgICAgICAgICB0eXBlOiBEaXNjb3VudFR5cGUuUEVSQ0VOVEFHRSxcbiAgICAgICAgICBwZXJjZW50T2ZmOiAyMCxcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBleHBlY3RlZERpc2NvdW50ID0ge1xuICAgICAgICAgIGlkOiAnZGlzY291bnQtaWQnLFxuICAgICAgICAgIC4uLmRpc2NvdW50RGF0YSxcbiAgICAgICAgICB2YWxpZEZyb206IGV4cGVjdC5hbnkoRGF0ZSksXG4gICAgICAgIH07XG5cbiAgICAgICAgKHByaXNtYVNlcnZpY2UuZGlzY291bnQuY3JlYXRlIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoXG4gICAgICAgICAgZXhwZWN0ZWREaXNjb3VudCxcbiAgICAgICAgKTtcblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLmNyZWF0ZURpc2NvdW50KGRpc2NvdW50RGF0YSk7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChleHBlY3RlZERpc2NvdW50KTtcbiAgICAgICAgZXhwZWN0KHByaXNtYVNlcnZpY2UuZGlzY291bnQuY3JlYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgLi4uZGlzY291bnREYXRhLFxuICAgICAgICAgICAgdmFsaWRGcm9tOiBleHBlY3QuYW55KERhdGUpLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgndmFsaWRhdGVEaXNjb3VudCcsICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tEaXNjb3VudCA9IHtcbiAgICAgICAgaWQ6ICdkaXNjb3VudC1pZCcsXG4gICAgICAgIGNvZGU6ICdTQVZFMjAnLFxuICAgICAgICBpc0FjdGl2ZTogdHJ1ZSxcbiAgICAgICAgdmFsaWRVbnRpbDogbmV3IERhdGUoJzIwMjQtMTItMzEnKSxcbiAgICAgICAgbWF4VXNlczogMTAwLFxuICAgICAgICBjdXJyZW50VXNlczogNTAsXG4gICAgICAgIG1heFVzZXNQZXJVc2VyOiAxLFxuICAgICAgICBtaW5BbW91bnQ6IDUwLFxuICAgICAgICByZWRlbXB0aW9uczogW10sXG4gICAgICB9O1xuXG4gICAgICBpdCgnc2hvdWxkIHJldHVybiB2YWxpZCBkaXNjb3VudCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgKHByaXNtYVNlcnZpY2UuZGlzY291bnQuZmluZFVuaXF1ZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKFxuICAgICAgICAgIG1vY2tEaXNjb3VudCxcbiAgICAgICAgKTtcblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLnZhbGlkYXRlRGlzY291bnQoXG4gICAgICAgICAgJ1NBVkUyMCcsXG4gICAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgICAgMTAwLFxuICAgICAgICApO1xuXG4gICAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja0Rpc2NvdW50KTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIHRocm93IEJhZFJlcXVlc3RFeGNlcHRpb24gZm9yIGludmFsaWQgZGlzY291bnQgY29kZScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgKHByaXNtYVNlcnZpY2UuZGlzY291bnQuZmluZFVuaXF1ZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKFxuICAgICAgICAgIG51bGwsXG4gICAgICAgICk7XG5cbiAgICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICAgIHNlcnZpY2UudmFsaWRhdGVEaXNjb3VudCgnSU5WQUxJRCcsIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULCAxMDApLFxuICAgICAgICApLnJlamVjdHMudG9UaHJvdyhCYWRSZXF1ZXN0RXhjZXB0aW9uKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIHRocm93IEJhZFJlcXVlc3RFeGNlcHRpb24gZm9yIGluYWN0aXZlIGRpc2NvdW50JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAocHJpc21hU2VydmljZS5kaXNjb3VudC5maW5kVW5pcXVlIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAgIC4uLm1vY2tEaXNjb3VudCxcbiAgICAgICAgICBpc0FjdGl2ZTogZmFsc2UsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgICBzZXJ2aWNlLnZhbGlkYXRlRGlzY291bnQoJ1NBVkUyMCcsIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULCAxMDApLFxuICAgICAgICApLnJlamVjdHMudG9UaHJvdyhCYWRSZXF1ZXN0RXhjZXB0aW9uKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIHRocm93IEJhZFJlcXVlc3RFeGNlcHRpb24gZm9yIGV4cGlyZWQgZGlzY291bnQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLmRpc2NvdW50LmZpbmRVbmlxdWUgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgLi4ubW9ja0Rpc2NvdW50LFxuICAgICAgICAgIHZhbGlkVW50aWw6IG5ldyBEYXRlKCcyMDIwLTAxLTAxJyksIC8vIEV4cGlyZWRcbiAgICAgICAgfSk7XG5cbiAgICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICAgIHNlcnZpY2UudmFsaWRhdGVEaXNjb3VudCgnU0FWRTIwJywgVEVTVF9VU0VSX0lEUy5DTElFTlQsIDEwMCksXG4gICAgICAgICkucmVqZWN0cy50b1Rocm93KEJhZFJlcXVlc3RFeGNlcHRpb24pO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgdGhyb3cgQmFkUmVxdWVzdEV4Y2VwdGlvbiB3aGVuIG1heCB1c2VzIHJlYWNoZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLmRpc2NvdW50LmZpbmRVbmlxdWUgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgLi4ubW9ja0Rpc2NvdW50LFxuICAgICAgICAgIG1heFVzZXM6IDUwLFxuICAgICAgICAgIGN1cnJlbnRVc2VzOiA1MCwgLy8gUmVhY2hlZCBsaW1pdFxuICAgICAgICB9KTtcblxuICAgICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgICAgc2VydmljZS52YWxpZGF0ZURpc2NvdW50KCdTQVZFMjAnLCBURVNUX1VTRVJfSURTLkNMSUVOVCwgMTAwKSxcbiAgICAgICAgKS5yZWplY3RzLnRvVGhyb3coQmFkUmVxdWVzdEV4Y2VwdGlvbik7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCB0aHJvdyBCYWRSZXF1ZXN0RXhjZXB0aW9uIHdoZW4gdXNlciBoYXMgYWxyZWFkeSB1c2VkIGRpc2NvdW50JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAocHJpc21hU2VydmljZS5kaXNjb3VudC5maW5kVW5pcXVlIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAgIC4uLm1vY2tEaXNjb3VudCxcbiAgICAgICAgICByZWRlbXB0aW9uczogW3sgdXNlcklkOiBURVNUX1VTRVJfSURTLkNMSUVOVCB9XSwgLy8gVXNlciBhbHJlYWR5IHVzZWRcbiAgICAgICAgfSk7XG5cbiAgICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICAgIHNlcnZpY2UudmFsaWRhdGVEaXNjb3VudCgnU0FWRTIwJywgVEVTVF9VU0VSX0lEUy5DTElFTlQsIDEwMCksXG4gICAgICAgICkucmVqZWN0cy50b1Rocm93KEJhZFJlcXVlc3RFeGNlcHRpb24pO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgdGhyb3cgQmFkUmVxdWVzdEV4Y2VwdGlvbiB3aGVuIGFtb3VudCBpcyBiZWxvdyBtaW5pbXVtJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgICAgc2VydmljZS52YWxpZGF0ZURpc2NvdW50KCdTQVZFMjAnLCBURVNUX1VTRVJfSURTLkNMSUVOVCwgMjUpLCAvLyBCZWxvdyBtaW4gb2YgNTBcbiAgICAgICAgKS5yZWplY3RzLnRvVGhyb3coQmFkUmVxdWVzdEV4Y2VwdGlvbik7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdyZWRlZW1EaXNjb3VudCcsICgpID0+IHtcbiAgICAgIGl0KCdzaG91bGQgcmVkZWVtIGRpc2NvdW50IGluIHRyYW5zYWN0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBtb2NrVHJhbnNhY3Rpb24gPSB7XG4gICAgICAgICAgLi4uY3JlYXRlTW9ja1ByaXNtYVNlcnZpY2UoKSxcbiAgICAgICAgICBkaXNjb3VudFJlZGVtcHRpb246IHtcbiAgICAgICAgICAgIGNyZWF0ZTogamVzdC5mbigpLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgZGlzY291bnQ6IHtcbiAgICAgICAgICAgIHVwZGF0ZTogamVzdC5mbigpLFxuICAgICAgICAgIH0sXG4gICAgICAgIH07XG5cbiAgICAgICAgKHByaXNtYVNlcnZpY2UuJHRyYW5zYWN0aW9uIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKFxuICAgICAgICAgIGFzeW5jIChjYWxsYmFjaykgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKG1vY2tUcmFuc2FjdGlvbik7XG4gICAgICAgICAgfSxcbiAgICAgICAgKTtcblxuICAgICAgICBhd2FpdCBzZXJ2aWNlLnJlZGVlbURpc2NvdW50KCdkaXNjb3VudC1pZCcsIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULCAyMCk7XG5cbiAgICAgICAgZXhwZWN0KG1vY2tUcmFuc2FjdGlvbi5kaXNjb3VudFJlZGVtcHRpb24uY3JlYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgZGlzY291bnRJZDogJ2Rpc2NvdW50LWlkJyxcbiAgICAgICAgICAgIHVzZXJJZDogVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgICAgICBhbW91bnRTYXZlZDogMjAsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZXhwZWN0KG1vY2tUcmFuc2FjdGlvbi5kaXNjb3VudC51cGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgICB3aGVyZTogeyBpZDogJ2Rpc2NvdW50LWlkJyB9LFxuICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgIGN1cnJlbnRVc2VzOiB7IGluY3JlbWVudDogMSB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdVc2FnZSBSZWNvcmRzJywgKCkgPT4ge1xuICAgIGRlc2NyaWJlKCdyZWNvcmRVc2FnZScsICgpID0+IHtcbiAgICAgIGl0KCdzaG91bGQgY3JlYXRlIHVzYWdlIHJlY29yZCB3aXRoIGRlZmF1bHQgZGF0ZScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgdXNhZ2VEYXRhID0ge1xuICAgICAgICAgIHN1YnNjcmlwdGlvbklkOiAnc3Vic2NyaXB0aW9uLWlkJyxcbiAgICAgICAgICBmZWF0dXJlOiAnYXBpX2NhbGxzJyxcbiAgICAgICAgICBxdWFudGl0eTogMTAwLFxuICAgICAgICAgIHVuaXQ6ICdyZXF1ZXN0cycsXG4gICAgICAgICAgbWV0YWRhdGE6IHsgZW5kcG9pbnQ6ICcvYXBpL3VzZXJzJyB9LFxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IGV4cGVjdGVkVXNhZ2UgPSB7XG4gICAgICAgICAgaWQ6ICd1c2FnZS1pZCcsXG4gICAgICAgICAgLi4udXNhZ2VEYXRhLFxuICAgICAgICAgIHVzYWdlRGF0ZTogZXhwZWN0LmFueShEYXRlKSxcbiAgICAgICAgfTtcblxuICAgICAgICAocHJpc21hU2VydmljZS51c2FnZVJlY29yZC5jcmVhdGUgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShcbiAgICAgICAgICBleHBlY3RlZFVzYWdlLFxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UucmVjb3JkVXNhZ2UodXNhZ2VEYXRhKTtcblxuICAgICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKGV4cGVjdGVkVXNhZ2UpO1xuICAgICAgICBleHBlY3QocHJpc21hU2VydmljZS51c2FnZVJlY29yZC5jcmVhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAuLi51c2FnZURhdGEsXG4gICAgICAgICAgICB1c2FnZURhdGU6IGV4cGVjdC5hbnkoRGF0ZSksXG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdnZXRVc2FnZVJlY29yZHMnLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIHJldHVybiB1c2FnZSByZWNvcmRzIHdpdGggZmlsdGVycycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgbW9ja1VzYWdlUmVjb3JkcyA9IFtcbiAgICAgICAgICB7IGlkOiAndXNhZ2UtMScsIGZlYXR1cmU6ICdhcGlfY2FsbHMnLCBxdWFudGl0eTogMTAwIH0sXG4gICAgICAgICAgeyBpZDogJ3VzYWdlLTInLCBmZWF0dXJlOiAnYXBpX2NhbGxzJywgcXVhbnRpdHk6IDUwIH0sXG4gICAgICAgIF07XG5cbiAgICAgICAgY29uc3Qgc3RhcnREYXRlID0gbmV3IERhdGUoJzIwMjQtMDEtMDEnKTtcbiAgICAgICAgY29uc3QgZW5kRGF0ZSA9IG5ldyBEYXRlKCcyMDI0LTAxLTMxJyk7XG5cbiAgICAgICAgKHByaXNtYVNlcnZpY2UudXNhZ2VSZWNvcmQuZmluZE1hbnkgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShcbiAgICAgICAgICBtb2NrVXNhZ2VSZWNvcmRzLFxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuZ2V0VXNhZ2VSZWNvcmRzKFxuICAgICAgICAgICdzdWJzY3JpcHRpb24taWQnLFxuICAgICAgICAgICdhcGlfY2FsbHMnLFxuICAgICAgICAgIHN0YXJ0RGF0ZSxcbiAgICAgICAgICBlbmREYXRlLFxuICAgICAgICApO1xuXG4gICAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja1VzYWdlUmVjb3Jkcyk7XG4gICAgICAgIGV4cGVjdChwcmlzbWFTZXJ2aWNlLnVzYWdlUmVjb3JkLmZpbmRNYW55KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgIHN1YnNjcmlwdGlvbklkOiAnc3Vic2NyaXB0aW9uLWlkJyxcbiAgICAgICAgICAgIGZlYXR1cmU6ICdhcGlfY2FsbHMnLFxuICAgICAgICAgICAgdXNhZ2VEYXRlOiB7XG4gICAgICAgICAgICAgIGd0ZTogc3RhcnREYXRlLFxuICAgICAgICAgICAgICBsdGU6IGVuZERhdGUsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgICAgb3JkZXJCeTogeyB1c2FnZURhdGU6ICdkZXNjJyB9LFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnSGVscGVyIE1ldGhvZHMnLCAoKSA9PiB7XG4gICAgZGVzY3JpYmUoJ2dlbmVyYXRlSW52b2ljZU51bWJlcicsICgpID0+IHtcbiAgICAgIGl0KCdzaG91bGQgZ2VuZXJhdGUgZmlyc3QgaW52b2ljZSBudW1iZXIgZm9yIHllYXInLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLmludm9pY2UuZmluZEZpcnN0IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgKHNlcnZpY2UgYXMgYW55KS5nZW5lcmF0ZUludm9pY2VOdW1iZXIoKTtcblxuICAgICAgICBjb25zdCBjdXJyZW50WWVhciA9IG5ldyBEYXRlKCkuZ2V0RnVsbFllYXIoKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZShgSU5WLSR7Y3VycmVudFllYXJ9LTAwMDAwMWApO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgaW5jcmVtZW50IGZyb20gbGFzdCBpbnZvaWNlIG51bWJlcicsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgY3VycmVudFllYXIgPSBuZXcgRGF0ZSgpLmdldEZ1bGxZZWFyKCk7XG4gICAgICAgIGNvbnN0IGxhc3RJbnZvaWNlID0ge1xuICAgICAgICAgIG51bWJlcjogYElOVi0ke2N1cnJlbnRZZWFyfS0wMDAwMDVgLFxuICAgICAgICB9O1xuXG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLmludm9pY2UuZmluZEZpcnN0IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoXG4gICAgICAgICAgbGFzdEludm9pY2UsXG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgKHNlcnZpY2UgYXMgYW55KS5nZW5lcmF0ZUludm9pY2VOdW1iZXIoKTtcblxuICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlKGBJTlYtJHtjdXJyZW50WWVhcn0tMDAwMDA2YCk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgaW52YWxpZCBpbnZvaWNlIG51bWJlciBmb3JtYXQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGxhc3RJbnZvaWNlID0ge1xuICAgICAgICAgIG51bWJlcjogJ0lOVkFMSUQtRk9STUFUJyxcbiAgICAgICAgfTtcblxuICAgICAgICAocHJpc21hU2VydmljZS5pbnZvaWNlLmZpbmRGaXJzdCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKFxuICAgICAgICAgIGxhc3RJbnZvaWNlLFxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IChzZXJ2aWNlIGFzIGFueSkuZ2VuZXJhdGVJbnZvaWNlTnVtYmVyKCk7XG5cbiAgICAgICAgY29uc3QgY3VycmVudFllYXIgPSBuZXcgRGF0ZSgpLmdldEZ1bGxZZWFyKCk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUoYElOVi0ke2N1cnJlbnRZZWFyfS0wMDAwMDFgKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ2dldEJpbGxpbmdTdGF0aXN0aWNzJywgKCkgPT4ge1xuICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gYmlsbGluZyBzdGF0aXN0aWNzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBtb2NrU3RhdHMgPSB7XG4gICAgICAgICAgdG90YWxSZXZlbnVlOiB7IF9zdW06IHsgYW1vdW50OiAxMDAwMCB9IH0sXG4gICAgICAgICAgYWN0aXZlU3Vic2NyaXB0aW9uczogMjUsXG4gICAgICAgICAgdHJpYWxTdWJzY3JpcHRpb25zOiA1LFxuICAgICAgICAgIGNhbmNlbGVkU3Vic2NyaXB0aW9uczogMTAsXG4gICAgICAgICAgc3Vic2NyaXB0aW9uc0J5VGllcjogW1xuICAgICAgICAgICAgLy8geyB0aWVyOiAnQkFTSUMnLCBfY291bnQ6IHsgdGllcjogMTAgfSB9LCAvLyBTdWJzY3JpcHRpb25UaWVyIHJlbW92ZWRcbiAgICAgICAgICAgIC8vIHsgdGllcjogJ1BSRU1JVU0nLCBfY291bnQ6IHsgdGllcjogMTUgfSB9LCAvLyBTdWJzY3JpcHRpb25UaWVyIHJlbW92ZWRcbiAgICAgICAgICBdLFxuICAgICAgICB9O1xuXG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLnBheW1lbnQuYWdncmVnYXRlIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoXG4gICAgICAgICAgbW9ja1N0YXRzLnRvdGFsUmV2ZW51ZSxcbiAgICAgICAgKTtcbiAgICAgICAgKHByaXNtYVNlcnZpY2Uuc3Vic2NyaXB0aW9uLmNvdW50IGFzIGplc3QuTW9jaylcbiAgICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKG1vY2tTdGF0cy5hY3RpdmVTdWJzY3JpcHRpb25zKVxuICAgICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UobW9ja1N0YXRzLnRyaWFsU3Vic2NyaXB0aW9ucylcbiAgICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKG1vY2tTdGF0cy5jYW5jZWxlZFN1YnNjcmlwdGlvbnMpO1xuICAgICAgICAocHJpc21hU2VydmljZS5zdWJzY3JpcHRpb24uZ3JvdXBCeSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKFxuICAgICAgICAgIG1vY2tTdGF0cy5zdWJzY3JpcHRpb25zQnlUaWVyLFxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuZ2V0QmlsbGluZ1N0YXRpc3RpY3MoKTtcblxuICAgICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHtcbiAgICAgICAgICB0b3RhbFJldmVudWU6IDEwMDAwLFxuICAgICAgICAgIGFjdGl2ZVN1YnNjcmlwdGlvbnM6IDI1LFxuICAgICAgICAgIHRyaWFsU3Vic2NyaXB0aW9uczogNSxcbiAgICAgICAgICBjYW5jZWxlZFN1YnNjcmlwdGlvbnM6IDEwLFxuICAgICAgICAgIHN1YnNjcmlwdGlvbnNCeVRpZXI6IG1vY2tTdGF0cy5zdWJzY3JpcHRpb25zQnlUaWVyLFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIGhhbmRsZSBudWxsIHJldmVudWUgc3VtJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAocHJpc21hU2VydmljZS5wYXltZW50LmFnZ3JlZ2F0ZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICBfc3VtOiB7IGFtb3VudDogbnVsbCB9LFxuICAgICAgICB9KTtcbiAgICAgICAgKHByaXNtYVNlcnZpY2Uuc3Vic2NyaXB0aW9uLmNvdW50IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoMCk7XG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLnN1YnNjcmlwdGlvbi5ncm91cEJ5IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoW10pO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuZ2V0QmlsbGluZ1N0YXRpc3RpY3MoKTtcblxuICAgICAgICBleHBlY3QocmVzdWx0LnRvdGFsUmV2ZW51ZSkudG9CZSgwKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRXJyb3IgSGFuZGxpbmcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZGF0YWJhc2UgZXJyb3JzIGluIGNyZWF0ZVN1YnNjcmlwdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIChcbiAgICAgICAgcHJpc21hU2VydmljZS5zdWJzY3JpcHRpb25QbGFuLmZpbmRVbmlxdWUgYXMgamVzdC5Nb2NrXG4gICAgICApLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgaWQ6ICdwbGFuLWlkJyxcbiAgICAgICAgbW9udGhseVByaWNlOiAyOS45OSxcbiAgICAgIH0pO1xuICAgICAgKHByaXNtYVNlcnZpY2Uuc3Vic2NyaXB0aW9uLmNyZWF0ZSBhcyBqZXN0Lk1vY2spLm1vY2tSZWplY3RlZFZhbHVlKFxuICAgICAgICBuZXcgRXJyb3IoJ0RhdGFiYXNlIGVycm9yJyksXG4gICAgICApO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIHNlcnZpY2UuY3JlYXRlU3Vic2NyaXB0aW9uKHtcbiAgICAgICAgICB1c2VySWQ6IFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICAgIHBsYW5JZDogJ3BsYW4taWQnLFxuICAgICAgICB9KSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KCdEYXRhYmFzZSBlcnJvcicpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZGF0YWJhc2UgZXJyb3JzIGluIHBheW1lbnQgb3BlcmF0aW9ucycsIGFzeW5jICgpID0+IHtcbiAgICAgIChwcmlzbWFTZXJ2aWNlLnBheW1lbnQuY3JlYXRlIGFzIGplc3QuTW9jaykubW9ja1JlamVjdGVkVmFsdWUoXG4gICAgICAgIG5ldyBFcnJvcignUGF5bWVudCBjcmVhdGlvbiBmYWlsZWQnKSxcbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgc2VydmljZS5jcmVhdGVQYXltZW50KHtcbiAgICAgICAgICBhbW91bnQ6IDI5Ljk5LFxuICAgICAgICB9KSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KCdQYXltZW50IGNyZWF0aW9uIGZhaWxlZCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgdHJhbnNhY3Rpb24gZXJyb3JzIGluIGRpc2NvdW50IHJlZGVtcHRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBwcmlzbWFTZXJ2aWNlLiR0cmFuc2FjdGlvbi5tb2NrUmVqZWN0ZWRWYWx1ZShcbiAgICAgICAgbmV3IEVycm9yKCdUcmFuc2FjdGlvbiBmYWlsZWQnKSxcbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgc2VydmljZS5yZWRlZW1EaXNjb3VudCgnZGlzY291bnQtaWQnLCBURVNUX1VTRVJfSURTLkNMSUVOVCwgMjApLFxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coJ1RyYW5zYWN0aW9uIGZhaWxlZCcpO1xuXG4gICAgICAvLyBWZXJpZnkgbm8gcGFydGlhbCBzdGF0ZSBjaGFuZ2VzXG4gICAgICBleHBlY3QocHJpc21hU2VydmljZS5kaXNjb3VudFJlZGVtcHRpb24uY3JlYXRlKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQWR2YW5jZWQgU3Vic2NyaXB0aW9uIE1hbmFnZW1lbnQnLCAoKSA9PiB7XG4gICAgY29uc3QgbW9ja1N1YnNjcmlwdGlvbiA9IHtcbiAgICAgIGlkOiAnc3Vic2NyaXB0aW9uLWlkJyxcbiAgICAgIHVzZXJJZDogVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICBwbGFuSWQ6ICdvbGQtcGxhbi1pZCcsXG4gICAgICAvLyB0aWVyOiAnQkFTSUMnLCAvLyBTdWJzY3JpcHRpb25UaWVyIHJlbW92ZWRcbiAgICAgIGJpbGxpbmdDeWNsZTogQmlsbGluZ0N5Y2xlLk1PTlRITFksXG4gICAgICBhbW91bnQ6IDkuOTksXG4gICAgICBzdGF0dXM6IFN1YnNjcmlwdGlvblN0YXR1cy5BQ1RJVkUsXG4gICAgICBjdXJyZW50UGVyaW9kU3RhcnQ6IG5ldyBEYXRlKCcyMDI0LTAxLTAxJyksXG4gICAgICBjdXJyZW50UGVyaW9kRW5kOiBuZXcgRGF0ZSgnMjAyNC0wMi0wMScpLFxuICAgICAgcGxhbjoge1xuICAgICAgICBpZDogJ29sZC1wbGFuLWlkJyxcbiAgICAgICAgbW9udGhseVByaWNlOiA5Ljk5LFxuICAgICAgICB5ZWFybHlQcmljZTogOTkuOTksXG4gICAgICB9LFxuICAgIH07XG5cbiAgICBjb25zdCBtb2NrTmV3UGxhbiA9IHtcbiAgICAgIGlkOiAnbmV3LXBsYW4taWQnLFxuICAgICAgLy8gdGllcjogJ1BSRU1JVU0nLCAvLyBTdWJzY3JpcHRpb25UaWVyIHJlbW92ZWRcbiAgICAgIG1vbnRobHlQcmljZTogMjkuOTksXG4gICAgICB5ZWFybHlQcmljZTogMjk5Ljk5LFxuICAgIH07XG5cbiAgICBkZXNjcmliZSgnY2hhbmdlU3Vic2NyaXB0aW9uUGxhbicsICgpID0+IHtcbiAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgICBqZXN0LnNweU9uKHNlcnZpY2UsICdmaW5kVXNlclN1YnNjcmlwdGlvbicpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tTdWJzY3JpcHRpb24gYXMgYW55KTtcbiAgICAgICAgKHByaXNtYVNlcnZpY2Uuc3Vic2NyaXB0aW9uUGxhbi5maW5kVW5pcXVlIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUobW9ja05ld1BsYW4pO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgY2hhbmdlIHBsYW4gd2l0aCBpbW1lZGlhdGUgcHJvcmF0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgICAgIGJpbGxpbmdDeWNsZTogQmlsbGluZ0N5Y2xlLk1PTlRITFksXG4gICAgICAgICAgcHJvcmF0aW9uQmVoYXZpb3I6ICdjcmVhdGVfcHJvcmF0aW9ucycsXG4gICAgICAgICAgZWZmZWN0aXZlRGF0ZTogbmV3IERhdGUoJzIwMjQtMDEtMTUnKSxcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBleHBlY3RlZFVwZGF0ZSA9IHtcbiAgICAgICAgICAuLi5tb2NrU3Vic2NyaXB0aW9uLFxuICAgICAgICAgIHBsYW5JZDogJ25ldy1wbGFuLWlkJyxcbiAgICAgICAgICAvLyB0aWVyOiAnUFJFTUlVTScsIC8vIFN1YnNjcmlwdGlvblRpZXIgcmVtb3ZlZFxuICAgICAgICAgIGFtb3VudDogMjkuOTksXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgbW9ja1Byb3JhdGlvbkNyZWRpdCA9IHtcbiAgICAgICAgICBpZDogJ2NyZWRpdC1pZCcsXG4gICAgICAgICAgYW1vdW50OiAtNS4wMCxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogJ1Byb3JhdGlvbiBjcmVkaXQgZm9yIHBsYW4gY2hhbmdlJyxcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBtb2NrUHJvcmF0aW9uQ2hhcmdlID0ge1xuICAgICAgICAgIGlkOiAnY2hhcmdlLWlkJyxcbiAgICAgICAgICBhbW91bnQ6IDE1LjAwLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAnUHJvcmF0aW9uIGNoYXJnZSBmb3IgcGxhbiBjaGFuZ2UnLFxuICAgICAgICB9O1xuXG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLiR0cmFuc2FjdGlvbiBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbihhc3luYyAoY2FsbGJhY2spID0+IHtcbiAgICAgICAgICBjb25zdCBtb2NrVHhuID0ge1xuICAgICAgICAgICAgc3Vic2NyaXB0aW9uOiB7XG4gICAgICAgICAgICAgIHVwZGF0ZTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKGV4cGVjdGVkVXBkYXRlKSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBpbnZvaWNlOiB7XG4gICAgICAgICAgICAgIGNyZWF0ZTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICAgICAgICBpZDogJ3Byb3JhdGlvbi1pbnZvaWNlJyxcbiAgICAgICAgICAgICAgICBsaW5lSXRlbXM6IFttb2NrUHJvcmF0aW9uQ3JlZGl0LCBtb2NrUHJvcmF0aW9uQ2hhcmdlXSxcbiAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaW52b2ljZUxpbmVJdGVtOiB7XG4gICAgICAgICAgICAgIGNyZWF0ZU1hbnk6IGplc3QuZm4oKSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfTtcbiAgICAgICAgICByZXR1cm4gY2FsbGJhY2sobW9ja1R4bik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuY2hhbmdlU3Vic2NyaXB0aW9uUGxhbihcbiAgICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgICAnbmV3LXBsYW4taWQnLFxuICAgICAgICAgIG9wdGlvbnNcbiAgICAgICAgKTtcblxuICAgICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKGV4cGVjdGVkVXBkYXRlKTtcbiAgICAgICAgZXhwZWN0KHByaXNtYVNlcnZpY2UuJHRyYW5zYWN0aW9uKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBjaGFuZ2UgcGxhbiB3aXRoIG5vIHByb3JhdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgICAgICBiaWxsaW5nQ3ljbGU6IEJpbGxpbmdDeWNsZS5NT05USExZLFxuICAgICAgICAgIHByb3JhdGlvbkJlaGF2aW9yOiAnbm9uZScsXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgZXhwZWN0ZWRVcGRhdGUgPSB7XG4gICAgICAgICAgLi4ubW9ja1N1YnNjcmlwdGlvbixcbiAgICAgICAgICBwbGFuSWQ6ICduZXctcGxhbi1pZCcsXG4gICAgICAgICAgLy8gdGllcjogJ1BSRU1JVU0nLCAvLyBTdWJzY3JpcHRpb25UaWVyIHJlbW92ZWRcbiAgICAgICAgICBhbW91bnQ6IDI5Ljk5LFxuICAgICAgICB9O1xuXG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLnN1YnNjcmlwdGlvbi51cGRhdGUgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShleHBlY3RlZFVwZGF0ZSk7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5jaGFuZ2VTdWJzY3JpcHRpb25QbGFuKFxuICAgICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICAgICduZXctcGxhbi1pZCcsXG4gICAgICAgICAgb3B0aW9uc1xuICAgICAgICApO1xuXG4gICAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoZXhwZWN0ZWRVcGRhdGUpO1xuICAgICAgICBleHBlY3QocHJpc21hU2VydmljZS5zdWJzY3JpcHRpb24udXBkYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgICAgd2hlcmU6IHsgdXNlcklkOiBURVNUX1VTRVJfSURTLkNMSUVOVCB9LFxuICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgIHBsYW5JZDogJ25ldy1wbGFuLWlkJyxcbiAgICAgICAgICAgIC8vIHRpZXI6ICdQUkVNSVVNJywgLy8gU3Vic2NyaXB0aW9uVGllciByZW1vdmVkXG4gICAgICAgICAgICBhbW91bnQ6IDI5Ljk5LFxuICAgICAgICAgICAgYmlsbGluZ0N5Y2xlOiBCaWxsaW5nQ3ljbGUuTU9OVEhMWSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGluY2x1ZGU6IGV4cGVjdC5hbnkoT2JqZWN0KSxcbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBjaGFuZ2UgcGxhbiB3aXRoIGVmZmVjdGl2ZSBkYXRlIGluIGZ1dHVyZScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgZnV0dXJlRGF0ZSA9IG5ldyBEYXRlKCcyMDI0LTAyLTAxJyk7XG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICAgICAgYmlsbGluZ0N5Y2xlOiBCaWxsaW5nQ3ljbGUuWUVBUkxZLFxuICAgICAgICAgIGVmZmVjdGl2ZURhdGU6IGZ1dHVyZURhdGUsXG4gICAgICAgICAgcHJvcmF0aW9uQmVoYXZpb3I6ICdub25lJyxcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBleHBlY3RlZFVwZGF0ZSA9IHtcbiAgICAgICAgICAuLi5tb2NrU3Vic2NyaXB0aW9uLFxuICAgICAgICAgIHBsYW5JZDogJ25ldy1wbGFuLWlkJyxcbiAgICAgICAgICAvLyB0aWVyOiAnUFJFTUlVTScsIC8vIFN1YnNjcmlwdGlvblRpZXIgcmVtb3ZlZFxuICAgICAgICAgIGFtb3VudDogMjk5Ljk5LFxuICAgICAgICAgIHNjaGVkdWxlZFBsYW5DaGFuZ2U6IHtcbiAgICAgICAgICAgIG5ld1BsYW5JZDogJ25ldy1wbGFuLWlkJyxcbiAgICAgICAgICAgIGVmZmVjdGl2ZURhdGU6IGZ1dHVyZURhdGUsXG4gICAgICAgICAgfSxcbiAgICAgICAgfTtcblxuICAgICAgICAocHJpc21hU2VydmljZS5zdWJzY3JpcHRpb24udXBkYXRlIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoZXhwZWN0ZWRVcGRhdGUpO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuY2hhbmdlU3Vic2NyaXB0aW9uUGxhbihcbiAgICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgICAnbmV3LXBsYW4taWQnLFxuICAgICAgICAgIG9wdGlvbnNcbiAgICAgICAgKTtcblxuICAgICAgICBleHBlY3QocmVzdWx0LnNjaGVkdWxlZFBsYW5DaGFuZ2UpLnRvQmVEZWZpbmVkKCk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuc2NoZWR1bGVkUGxhbkNoYW5nZS5lZmZlY3RpdmVEYXRlKS50b0VxdWFsKGZ1dHVyZURhdGUpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgdGhyb3cgZXJyb3Igd2hlbiBjaGFuZ2luZyB0byBzYW1lIHBsYW4nLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgICBzZXJ2aWNlLmNoYW5nZVN1YnNjcmlwdGlvblBsYW4oXG4gICAgICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgICAgICdvbGQtcGxhbi1pZCcsXG4gICAgICAgICAgICB7IGJpbGxpbmdDeWNsZTogQmlsbGluZ0N5Y2xlLk1PTlRITFkgfVxuICAgICAgICAgIClcbiAgICAgICAgKS5yZWplY3RzLnRvVGhyb3coQmFkUmVxdWVzdEV4Y2VwdGlvbik7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCB0aHJvdyBlcnJvciB3aGVuIHN1YnNjcmlwdGlvbiBpcyBjYW5jZWxlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgamVzdC5zcHlPbihzZXJ2aWNlLCAnZmluZFVzZXJTdWJzY3JpcHRpb24nKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgLi4ubW9ja1N1YnNjcmlwdGlvbixcbiAgICAgICAgICBzdGF0dXM6IFN1YnNjcmlwdGlvblN0YXR1cy5DQU5DRUxFRCxcbiAgICAgICAgfSBhcyBhbnkpO1xuXG4gICAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgICBzZXJ2aWNlLmNoYW5nZVN1YnNjcmlwdGlvblBsYW4oXG4gICAgICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgICAgICduZXctcGxhbi1pZCcsXG4gICAgICAgICAgICB7IGJpbGxpbmdDeWNsZTogQmlsbGluZ0N5Y2xlLk1PTlRITFkgfVxuICAgICAgICAgIClcbiAgICAgICAgKS5yZWplY3RzLnRvVGhyb3coQmFkUmVxdWVzdEV4Y2VwdGlvbik7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdwYXVzZVN1YnNjcmlwdGlvbicsICgpID0+IHtcbiAgICAgIGl0KCdzaG91bGQgcGF1c2Ugc3Vic2NyaXB0aW9uIHdpdGggc3BlY2lmaWVkIGRhdGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHBhdXNlVW50aWwgPSBuZXcgRGF0ZSgnMjAyNC0wMy0wMScpO1xuICAgICAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgICAgIHBhdXNlVW50aWwsXG4gICAgICAgICAgcmVhc29uOiAnRmluYW5jaWFsIGhhcmRzaGlwJyxcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBwYXVzZWRTdWJzY3JpcHRpb24gPSB7XG4gICAgICAgICAgLi4ubW9ja1N1YnNjcmlwdGlvbixcbiAgICAgICAgICBzdGF0dXM6IFN1YnNjcmlwdGlvblN0YXR1cy5QQVVTRUQsXG4gICAgICAgICAgcGF1c2VkQXQ6IG5ldyBEYXRlKCksXG4gICAgICAgICAgcGF1c2VVbnRpbCxcbiAgICAgICAgICBwYXVzZVJlYXNvbjogJ0ZpbmFuY2lhbCBoYXJkc2hpcCcsXG4gICAgICAgIH07XG5cbiAgICAgICAgamVzdC5zcHlPbihzZXJ2aWNlLCAndXBkYXRlU3Vic2NyaXB0aW9uJykubW9ja1Jlc29sdmVkVmFsdWUocGF1c2VkU3Vic2NyaXB0aW9uIGFzIGFueSk7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5wYXVzZVN1YnNjcmlwdGlvbihURVNUX1VTRVJfSURTLkNMSUVOVCwgb3B0aW9ucyk7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdC5zdGF0dXMpLnRvQmUoU3Vic2NyaXB0aW9uU3RhdHVzLlBBVVNFRCk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQucGF1c2VVbnRpbCkudG9FcXVhbChwYXVzZVVudGlsKTtcbiAgICAgICAgZXhwZWN0KHNlcnZpY2UudXBkYXRlU3Vic2NyaXB0aW9uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChURVNUX1VTRVJfSURTLkNMSUVOVCwge1xuICAgICAgICAgIHN0YXR1czogU3Vic2NyaXB0aW9uU3RhdHVzLlBBVVNFRCxcbiAgICAgICAgICBwYXVzZWRBdDogZXhwZWN0LmFueShEYXRlKSxcbiAgICAgICAgICBwYXVzZVVudGlsLFxuICAgICAgICAgIHBhdXNlUmVhc29uOiAnRmluYW5jaWFsIGhhcmRzaGlwJyxcbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBwYXVzZSBzdWJzY3JpcHRpb24gaW5kZWZpbml0ZWx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgICAgIHJlYXNvbjogJ1RlbXBvcmFyeSBicmVhaycsXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgcGF1c2VkU3Vic2NyaXB0aW9uID0ge1xuICAgICAgICAgIC4uLm1vY2tTdWJzY3JpcHRpb24sXG4gICAgICAgICAgc3RhdHVzOiBTdWJzY3JpcHRpb25TdGF0dXMuUEFVU0VELFxuICAgICAgICAgIHBhdXNlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgICAgIHBhdXNlUmVhc29uOiAnVGVtcG9yYXJ5IGJyZWFrJyxcbiAgICAgICAgfTtcblxuICAgICAgICBqZXN0LnNweU9uKHNlcnZpY2UsICd1cGRhdGVTdWJzY3JpcHRpb24nKS5tb2NrUmVzb2x2ZWRWYWx1ZShwYXVzZWRTdWJzY3JpcHRpb24gYXMgYW55KTtcblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLnBhdXNlU3Vic2NyaXB0aW9uKFRFU1RfVVNFUl9JRFMuQ0xJRU5ULCBvcHRpb25zKTtcblxuICAgICAgICBleHBlY3QocmVzdWx0LnN0YXR1cykudG9CZShTdWJzY3JpcHRpb25TdGF0dXMuUEFVU0VEKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5wYXVzZVVudGlsKS50b0JlVW5kZWZpbmVkKCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdyZXN1bWVTdWJzY3JpcHRpb24nLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIHJlc3VtZSBwYXVzZWQgc3Vic2NyaXB0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBwYXVzZWRTdWJzY3JpcHRpb24gPSB7XG4gICAgICAgICAgLi4ubW9ja1N1YnNjcmlwdGlvbixcbiAgICAgICAgICBzdGF0dXM6IFN1YnNjcmlwdGlvblN0YXR1cy5QQVVTRUQsXG4gICAgICAgICAgcGF1c2VkQXQ6IG5ldyBEYXRlKCcyMDI0LTAxLTE1JyksXG4gICAgICAgICAgcGF1c2VVbnRpbDogbmV3IERhdGUoJzIwMjQtMDMtMDEnKSxcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCByZXN1bWVkU3Vic2NyaXB0aW9uID0ge1xuICAgICAgICAgIC4uLnBhdXNlZFN1YnNjcmlwdGlvbixcbiAgICAgICAgICBzdGF0dXM6IFN1YnNjcmlwdGlvblN0YXR1cy5BQ1RJVkUsXG4gICAgICAgICAgcGF1c2VkQXQ6IG51bGwsXG4gICAgICAgICAgcGF1c2VVbnRpbDogbnVsbCxcbiAgICAgICAgICBwYXVzZVJlYXNvbjogbnVsbCxcbiAgICAgICAgICByZXN1bWVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICAgIH07XG5cbiAgICAgICAgamVzdC5zcHlPbihzZXJ2aWNlLCAnZmluZFVzZXJTdWJzY3JpcHRpb24nKS5tb2NrUmVzb2x2ZWRWYWx1ZShwYXVzZWRTdWJzY3JpcHRpb24gYXMgYW55KTtcbiAgICAgICAgamVzdC5zcHlPbihzZXJ2aWNlLCAndXBkYXRlU3Vic2NyaXB0aW9uJykubW9ja1Jlc29sdmVkVmFsdWUocmVzdW1lZFN1YnNjcmlwdGlvbiBhcyBhbnkpO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UucmVzdW1lU3Vic2NyaXB0aW9uKFRFU1RfVVNFUl9JRFMuQ0xJRU5UKTtcblxuICAgICAgICBleHBlY3QocmVzdWx0LnN0YXR1cykudG9CZShTdWJzY3JpcHRpb25TdGF0dXMuQUNUSVZFKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5yZXN1bWVkQXQpLnRvQmVEZWZpbmVkKCk7XG4gICAgICAgIGV4cGVjdChzZXJ2aWNlLnVwZGF0ZVN1YnNjcmlwdGlvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoVEVTVF9VU0VSX0lEUy5DTElFTlQsIHtcbiAgICAgICAgICBzdGF0dXM6IFN1YnNjcmlwdGlvblN0YXR1cy5BQ1RJVkUsXG4gICAgICAgICAgcGF1c2VkQXQ6IG51bGwsXG4gICAgICAgICAgcGF1c2VVbnRpbDogbnVsbCxcbiAgICAgICAgICBwYXVzZVJlYXNvbjogbnVsbCxcbiAgICAgICAgICByZXN1bWVkQXQ6IGV4cGVjdC5hbnkoRGF0ZSksXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgdGhyb3cgZXJyb3Igd2hlbiBzdWJzY3JpcHRpb24gaXMgbm90IHBhdXNlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgamVzdC5zcHlPbihzZXJ2aWNlLCAnZmluZFVzZXJTdWJzY3JpcHRpb24nKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrU3Vic2NyaXB0aW9uIGFzIGFueSk7XG5cbiAgICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICAgIHNlcnZpY2UucmVzdW1lU3Vic2NyaXB0aW9uKFRFU1RfVVNFUl9JRFMuQ0xJRU5UKVxuICAgICAgICApLnJlamVjdHMudG9UaHJvdyhCYWRSZXF1ZXN0RXhjZXB0aW9uKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ3NjaGVkdWxlU3Vic2NyaXB0aW9uQ2FuY2VsbGF0aW9uJywgKCkgPT4ge1xuICAgICAgaXQoJ3Nob3VsZCBzY2hlZHVsZSBjYW5jZWxsYXRpb24gYXQgcGVyaW9kIGVuZCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3Qgc2NoZWR1bGVEYXRhID0ge1xuICAgICAgICAgIGNhbmNlbEF0UGVyaW9kRW5kOiB0cnVlLFxuICAgICAgICAgIHJlYXNvbjogJ05vIGxvbmdlciBuZWVkZWQnLFxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IHNjaGVkdWxlZFN1YnNjcmlwdGlvbiA9IHtcbiAgICAgICAgICAuLi5tb2NrU3Vic2NyaXB0aW9uLFxuICAgICAgICAgIGNhbmNlbEF0UGVyaW9kRW5kOiB0cnVlLFxuICAgICAgICAgIGNhbmNlbGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICAgICAgY2FuY2VsbGF0aW9uUmVhc29uOiAnTm8gbG9uZ2VyIG5lZWRlZCcsXG4gICAgICAgICAgY2FuY2VsbGF0aW9uRWZmZWN0aXZlRGF0ZTogbW9ja1N1YnNjcmlwdGlvbi5jdXJyZW50UGVyaW9kRW5kLFxuICAgICAgICB9O1xuXG4gICAgICAgIGplc3Quc3B5T24oc2VydmljZSwgJ3VwZGF0ZVN1YnNjcmlwdGlvbicpLm1vY2tSZXNvbHZlZFZhbHVlKHNjaGVkdWxlZFN1YnNjcmlwdGlvbiBhcyBhbnkpO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2Uuc2NoZWR1bGVTdWJzY3JpcHRpb25DYW5jZWxsYXRpb24oXG4gICAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgICAgc2NoZWR1bGVEYXRhXG4gICAgICAgICk7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdC5jYW5jZWxBdFBlcmlvZEVuZCkudG9CZSh0cnVlKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5jYW5jZWxsYXRpb25FZmZlY3RpdmVEYXRlKS50b0VxdWFsKG1vY2tTdWJzY3JpcHRpb24uY3VycmVudFBlcmlvZEVuZCk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBzY2hlZHVsZSBpbW1lZGlhdGUgY2FuY2VsbGF0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBzY2hlZHVsZURhdGEgPSB7XG4gICAgICAgICAgY2FuY2VsQXRQZXJpb2RFbmQ6IGZhbHNlLFxuICAgICAgICAgIHJlYXNvbjogJ0Rpc3NhdGlzZmllZCB3aXRoIHNlcnZpY2UnLFxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IGNhbmNlbGVkU3Vic2NyaXB0aW9uID0ge1xuICAgICAgICAgIC4uLm1vY2tTdWJzY3JpcHRpb24sXG4gICAgICAgICAgc3RhdHVzOiBTdWJzY3JpcHRpb25TdGF0dXMuQ0FOQ0VMRUQsXG4gICAgICAgICAgY2FuY2VsZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgICBjYW5jZWxsYXRpb25SZWFzb246ICdEaXNzYXRpc2ZpZWQgd2l0aCBzZXJ2aWNlJyxcbiAgICAgICAgICBjYW5jZWxsYXRpb25FZmZlY3RpdmVEYXRlOiBuZXcgRGF0ZSgpLFxuICAgICAgICB9O1xuXG4gICAgICAgIGplc3Quc3B5T24oc2VydmljZSwgJ3VwZGF0ZVN1YnNjcmlwdGlvbicpLm1vY2tSZXNvbHZlZFZhbHVlKGNhbmNlbGVkU3Vic2NyaXB0aW9uIGFzIGFueSk7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5zY2hlZHVsZVN1YnNjcmlwdGlvbkNhbmNlbGxhdGlvbihcbiAgICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgICBzY2hlZHVsZURhdGFcbiAgICAgICAgKTtcblxuICAgICAgICBleHBlY3QocmVzdWx0LnN0YXR1cykudG9CZShTdWJzY3JpcHRpb25TdGF0dXMuQ0FOQ0VMRUQpO1xuICAgICAgICBleHBlY3QocmVzdWx0LmNhbmNlbGxhdGlvblJlYXNvbikudG9CZSgnRGlzc2F0aXNmaWVkIHdpdGggc2VydmljZScpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgncmVhY3RpdmF0ZVN1YnNjcmlwdGlvbicsICgpID0+IHtcbiAgICAgIGl0KCdzaG91bGQgcmVhY3RpdmF0ZSBjYW5jZWxlZCBzdWJzY3JpcHRpb24gd2l0aCBuZXcgcGF5bWVudCBtZXRob2QnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGNhbmNlbGVkU3Vic2NyaXB0aW9uID0ge1xuICAgICAgICAgIC4uLm1vY2tTdWJzY3JpcHRpb24sXG4gICAgICAgICAgc3RhdHVzOiBTdWJzY3JpcHRpb25TdGF0dXMuQ0FOQ0VMRUQsXG4gICAgICAgICAgY2FuY2VsZWRBdDogbmV3IERhdGUoJzIwMjQtMDEtMTUnKSxcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBuZXdQYXltZW50TWV0aG9kID0ge1xuICAgICAgICAgIGlkOiAnbmV3LXBheW1lbnQtbWV0aG9kLWlkJyxcbiAgICAgICAgICB0eXBlOiBQYXltZW50TWV0aG9kVHlwZS5DQVJELFxuICAgICAgICAgIGlzRGVmYXVsdDogdHJ1ZSxcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCByZWFjdGl2YXRlZFN1YnNjcmlwdGlvbiA9IHtcbiAgICAgICAgICAuLi5jYW5jZWxlZFN1YnNjcmlwdGlvbixcbiAgICAgICAgICBzdGF0dXM6IFN1YnNjcmlwdGlvblN0YXR1cy5BQ1RJVkUsXG4gICAgICAgICAgY2FuY2VsZWRBdDogbnVsbCxcbiAgICAgICAgICBjYW5jZWxsYXRpb25SZWFzb246IG51bGwsXG4gICAgICAgICAgcmVhY3RpdmF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgICBkZWZhdWx0UGF5bWVudE1ldGhvZElkOiAnbmV3LXBheW1lbnQtbWV0aG9kLWlkJyxcbiAgICAgICAgfTtcblxuICAgICAgICBqZXN0LnNweU9uKHNlcnZpY2UsICdmaW5kVXNlclN1YnNjcmlwdGlvbicpLm1vY2tSZXNvbHZlZFZhbHVlKGNhbmNlbGVkU3Vic2NyaXB0aW9uIGFzIGFueSk7XG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLnBheW1lbnRNZXRob2QuZmluZFVuaXF1ZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKG5ld1BheW1lbnRNZXRob2QpO1xuICAgICAgICBqZXN0LnNweU9uKHNlcnZpY2UsICd1cGRhdGVTdWJzY3JpcHRpb24nKS5tb2NrUmVzb2x2ZWRWYWx1ZShyZWFjdGl2YXRlZFN1YnNjcmlwdGlvbiBhcyBhbnkpO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UucmVhY3RpdmF0ZVN1YnNjcmlwdGlvbihcbiAgICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgICAnbmV3LXBheW1lbnQtbWV0aG9kLWlkJ1xuICAgICAgICApO1xuXG4gICAgICAgIGV4cGVjdChyZXN1bHQuc3RhdHVzKS50b0JlKFN1YnNjcmlwdGlvblN0YXR1cy5BQ1RJVkUpO1xuICAgICAgICBleHBlY3QocmVzdWx0LnJlYWN0aXZhdGVkQXQpLnRvQmVEZWZpbmVkKCk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuZGVmYXVsdFBheW1lbnRNZXRob2RJZCkudG9CZSgnbmV3LXBheW1lbnQtbWV0aG9kLWlkJyk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCByZWFjdGl2YXRlIHN1YnNjcmlwdGlvbiB3aXRob3V0IGNoYW5naW5nIHBheW1lbnQgbWV0aG9kJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBjYW5jZWxlZFN1YnNjcmlwdGlvbiA9IHtcbiAgICAgICAgICAuLi5tb2NrU3Vic2NyaXB0aW9uLFxuICAgICAgICAgIHN0YXR1czogU3Vic2NyaXB0aW9uU3RhdHVzLkNBTkNFTEVELFxuICAgICAgICAgIGRlZmF1bHRQYXltZW50TWV0aG9kSWQ6ICdleGlzdGluZy1wYXltZW50LW1ldGhvZCcsXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgcmVhY3RpdmF0ZWRTdWJzY3JpcHRpb24gPSB7XG4gICAgICAgICAgLi4uY2FuY2VsZWRTdWJzY3JpcHRpb24sXG4gICAgICAgICAgc3RhdHVzOiBTdWJzY3JpcHRpb25TdGF0dXMuQUNUSVZFLFxuICAgICAgICAgIGNhbmNlbGVkQXQ6IG51bGwsXG4gICAgICAgICAgcmVhY3RpdmF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgfTtcblxuICAgICAgICBqZXN0LnNweU9uKHNlcnZpY2UsICdmaW5kVXNlclN1YnNjcmlwdGlvbicpLm1vY2tSZXNvbHZlZFZhbHVlKGNhbmNlbGVkU3Vic2NyaXB0aW9uIGFzIGFueSk7XG4gICAgICAgIGplc3Quc3B5T24oc2VydmljZSwgJ3VwZGF0ZVN1YnNjcmlwdGlvbicpLm1vY2tSZXNvbHZlZFZhbHVlKHJlYWN0aXZhdGVkU3Vic2NyaXB0aW9uIGFzIGFueSk7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5yZWFjdGl2YXRlU3Vic2NyaXB0aW9uKFRFU1RfVVNFUl9JRFMuQ0xJRU5UKTtcblxuICAgICAgICBleHBlY3QocmVzdWx0LnN0YXR1cykudG9CZShTdWJzY3JpcHRpb25TdGF0dXMuQUNUSVZFKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5kZWZhdWx0UGF5bWVudE1ldGhvZElkKS50b0JlKCdleGlzdGluZy1wYXltZW50LW1ldGhvZCcpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgdGhyb3cgZXJyb3Igd2hlbiBzdWJzY3JpcHRpb24gaXMgbm90IGNhbmNlbGVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBqZXN0LnNweU9uKHNlcnZpY2UsICdmaW5kVXNlclN1YnNjcmlwdGlvbicpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tTdWJzY3JpcHRpb24gYXMgYW55KTtcblxuICAgICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgICAgc2VydmljZS5yZWFjdGl2YXRlU3Vic2NyaXB0aW9uKFRFU1RfVVNFUl9JRFMuQ0xJRU5UKVxuICAgICAgICApLnJlamVjdHMudG9UaHJvdyhCYWRSZXF1ZXN0RXhjZXB0aW9uKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIHRocm93IGVycm9yIHdoZW4gcGF5bWVudCBtZXRob2QgZG9lcyBub3QgZXhpc3QnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGNhbmNlbGVkU3Vic2NyaXB0aW9uID0ge1xuICAgICAgICAgIC4uLm1vY2tTdWJzY3JpcHRpb24sXG4gICAgICAgICAgc3RhdHVzOiBTdWJzY3JpcHRpb25TdGF0dXMuQ0FOQ0VMRUQsXG4gICAgICAgIH07XG5cbiAgICAgICAgamVzdC5zcHlPbihzZXJ2aWNlLCAnZmluZFVzZXJTdWJzY3JpcHRpb24nKS5tb2NrUmVzb2x2ZWRWYWx1ZShjYW5jZWxlZFN1YnNjcmlwdGlvbiBhcyBhbnkpO1xuICAgICAgICAocHJpc21hU2VydmljZS5wYXltZW50TWV0aG9kLmZpbmRVbmlxdWUgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShudWxsKTtcblxuICAgICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgICAgc2VydmljZS5yZWFjdGl2YXRlU3Vic2NyaXB0aW9uKFRFU1RfVVNFUl9JRFMuQ0xJRU5ULCAnbm9uLWV4aXN0ZW50LXBheW1lbnQtbWV0aG9kJylcbiAgICAgICAgKS5yZWplY3RzLnRvVGhyb3coTm90Rm91bmRFeGNlcHRpb24pO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnYXBwbHlEaXNjb3VudFRvU3Vic2NyaXB0aW9uJywgKCkgPT4ge1xuICAgICAgaXQoJ3Nob3VsZCBhcHBseSBkaXNjb3VudCB0byBzdWJzY3JpcHRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IG1vY2tEaXNjb3VudCA9IHtcbiAgICAgICAgICBpZDogJ2Rpc2NvdW50LWlkJyxcbiAgICAgICAgICBjb2RlOiAnU0FWRTIwJyxcbiAgICAgICAgICB0eXBlOiBEaXNjb3VudFR5cGUuUEVSQ0VOVEFHRSxcbiAgICAgICAgICBwZXJjZW50T2ZmOiAyMCxcbiAgICAgICAgICBpc0FjdGl2ZTogdHJ1ZSxcbiAgICAgICAgICB2YWxpZFVudGlsOiBuZXcgRGF0ZSgnMjAyNC0xMi0zMScpLFxuICAgICAgICAgIGN1cnJlbnRVc2VzOiA1LFxuICAgICAgICAgIG1heFVzZXM6IDEwMCxcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBzdWJzY3JpcHRpb25XaXRoRGlzY291bnQgPSB7XG4gICAgICAgICAgLi4ubW9ja1N1YnNjcmlwdGlvbixcbiAgICAgICAgICBhcHBsaWVkRGlzY291bnRzOiBbe1xuICAgICAgICAgICAgaWQ6ICdhcHBsaWVkLWRpc2NvdW50LWlkJyxcbiAgICAgICAgICAgIGRpc2NvdW50SWQ6ICdkaXNjb3VudC1pZCcsXG4gICAgICAgICAgICBzdWJzY3JpcHRpb25JZDogbW9ja1N1YnNjcmlwdGlvbi5pZCxcbiAgICAgICAgICAgIGFwcGxpZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgICB9XSxcbiAgICAgICAgfTtcblxuICAgICAgICBqZXN0LnNweU9uKHNlcnZpY2UsICd2YWxpZGF0ZURpc2NvdW50JykubW9ja1Jlc29sdmVkVmFsdWUobW9ja0Rpc2NvdW50IGFzIGFueSk7XG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLiR0cmFuc2FjdGlvbiBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbihhc3luYyAoY2FsbGJhY2spID0+IHtcbiAgICAgICAgICBjb25zdCBtb2NrVHhuID0ge1xuICAgICAgICAgICAgc3Vic2NyaXB0aW9uRGlzY291bnQ6IHtcbiAgICAgICAgICAgICAgY3JlYXRlOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoc3Vic2NyaXB0aW9uV2l0aERpc2NvdW50LmFwcGxpZWREaXNjb3VudHNbMF0pLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGRpc2NvdW50OiB7XG4gICAgICAgICAgICAgIHVwZGF0ZTogamVzdC5mbigpLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHN1YnNjcmlwdGlvbjoge1xuICAgICAgICAgICAgICBmaW5kVW5pcXVlOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoc3Vic2NyaXB0aW9uV2l0aERpc2NvdW50KSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfTtcbiAgICAgICAgICByZXR1cm4gY2FsbGJhY2sobW9ja1R4bik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuYXBwbHlEaXNjb3VudFRvU3Vic2NyaXB0aW9uKFxuICAgICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICAgICdTQVZFMjAnXG4gICAgICAgICk7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdC5hcHBsaWVkRGlzY291bnRzKS50b0JlRGVmaW5lZCgpO1xuICAgICAgICBleHBlY3QocmVzdWx0LmFwcGxpZWREaXNjb3VudHMpLnRvSGF2ZUxlbmd0aCgxKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIHRocm93IGVycm9yIHdoZW4gZGlzY291bnQgaXMgYWxyZWFkeSBhcHBsaWVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBtb2NrRGlzY291bnQgPSB7XG4gICAgICAgICAgaWQ6ICdkaXNjb3VudC1pZCcsXG4gICAgICAgICAgY29kZTogJ1NBVkUyMCcsXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3Qgc3Vic2NyaXB0aW9uV2l0aERpc2NvdW50ID0ge1xuICAgICAgICAgIC4uLm1vY2tTdWJzY3JpcHRpb24sXG4gICAgICAgICAgYXBwbGllZERpc2NvdW50czogW3tcbiAgICAgICAgICAgIGRpc2NvdW50SWQ6ICdkaXNjb3VudC1pZCcsXG4gICAgICAgICAgfV0sXG4gICAgICAgIH07XG5cbiAgICAgICAgamVzdC5zcHlPbihzZXJ2aWNlLCAndmFsaWRhdGVEaXNjb3VudCcpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tEaXNjb3VudCBhcyBhbnkpO1xuICAgICAgICBqZXN0LnNweU9uKHNlcnZpY2UsICdmaW5kVXNlclN1YnNjcmlwdGlvbicpLm1vY2tSZXNvbHZlZFZhbHVlKHN1YnNjcmlwdGlvbldpdGhEaXNjb3VudCBhcyBhbnkpO1xuXG4gICAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgICBzZXJ2aWNlLmFwcGx5RGlzY291bnRUb1N1YnNjcmlwdGlvbihURVNUX1VTRVJfSURTLkNMSUVOVCwgJ1NBVkUyMCcpXG4gICAgICAgICkucmVqZWN0cy50b1Rocm93KEJhZFJlcXVlc3RFeGNlcHRpb24pO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgncHJvY2Vzc1N1YnNjcmlwdGlvblJlbmV3YWwnLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIHByb2Nlc3Mgc3VjY2Vzc2Z1bCByZW5ld2FsJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCByZW5ld2FsRGF0ZSA9IG5ldyBEYXRlKCcyMDI0LTAyLTAxJyk7XG4gICAgICAgIGNvbnN0IHJlbmV3ZWRTdWJzY3JpcHRpb24gPSB7XG4gICAgICAgICAgLi4ubW9ja1N1YnNjcmlwdGlvbixcbiAgICAgICAgICBjdXJyZW50UGVyaW9kU3RhcnQ6IHJlbmV3YWxEYXRlLFxuICAgICAgICAgIGN1cnJlbnRQZXJpb2RFbmQ6IG5ldyBEYXRlKCcyMDI0LTAzLTAxJyksXG4gICAgICAgICAgcmVuZXdhbENvdW50OiAxLFxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IG1vY2tQYXltZW50ID0ge1xuICAgICAgICAgIGlkOiAncmVuZXdhbC1wYXltZW50LWlkJyxcbiAgICAgICAgICBhbW91bnQ6IG1vY2tTdWJzY3JpcHRpb24uYW1vdW50LFxuICAgICAgICAgIHN0YXR1czogUGF5bWVudFN0YXR1cy5TVUNDRUVERUQsXG4gICAgICAgIH07XG5cbiAgICAgICAgKHByaXNtYVNlcnZpY2Uuc3Vic2NyaXB0aW9uLmZpbmRVbmlxdWUgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrU3Vic2NyaXB0aW9uKTtcbiAgICAgICAgKHByaXNtYVNlcnZpY2UuJHRyYW5zYWN0aW9uIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKGFzeW5jIChjYWxsYmFjaykgPT4ge1xuICAgICAgICAgIGNvbnN0IG1vY2tUeG4gPSB7XG4gICAgICAgICAgICBwYXltZW50OiB7XG4gICAgICAgICAgICAgIGNyZWF0ZTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tQYXltZW50KSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzdWJzY3JpcHRpb246IHtcbiAgICAgICAgICAgICAgdXBkYXRlOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUocmVuZXdlZFN1YnNjcmlwdGlvbiksXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH07XG4gICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKG1vY2tUeG4pO1xuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLnByb2Nlc3NTdWJzY3JpcHRpb25SZW5ld2FsKG1vY2tTdWJzY3JpcHRpb24uaWQpO1xuXG4gICAgICAgIGV4cGVjdChyZXN1bHQucmVuZXdhbENvdW50KS50b0JlKDEpO1xuICAgICAgICBleHBlY3QocmVzdWx0LmN1cnJlbnRQZXJpb2RTdGFydCkudG9FcXVhbChyZW5ld2FsRGF0ZSk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgcmVuZXdhbCBwYXltZW50IGZhaWx1cmUnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IG1vY2tQYXltZW50ID0ge1xuICAgICAgICAgIGlkOiAnZmFpbGVkLXBheW1lbnQtaWQnLFxuICAgICAgICAgIHN0YXR1czogUGF5bWVudFN0YXR1cy5GQUlMRUQsXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3Qgc3Vic2NyaXB0aW9uUGFzdER1ZSA9IHtcbiAgICAgICAgICAuLi5tb2NrU3Vic2NyaXB0aW9uLFxuICAgICAgICAgIHN0YXR1czogU3Vic2NyaXB0aW9uU3RhdHVzLlBBU1RfRFVFLFxuICAgICAgICAgIHBhc3REdWVEYXRlOiBuZXcgRGF0ZSgpLFxuICAgICAgICB9O1xuXG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLnN1YnNjcmlwdGlvbi5maW5kVW5pcXVlIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1N1YnNjcmlwdGlvbik7XG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLiR0cmFuc2FjdGlvbiBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbihhc3luYyAoY2FsbGJhY2spID0+IHtcbiAgICAgICAgICBjb25zdCBtb2NrVHhuID0ge1xuICAgICAgICAgICAgcGF5bWVudDoge1xuICAgICAgICAgICAgICBjcmVhdGU6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUGF5bWVudCksXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc3Vic2NyaXB0aW9uOiB7XG4gICAgICAgICAgICAgIHVwZGF0ZTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHN1YnNjcmlwdGlvblBhc3REdWUpLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9O1xuICAgICAgICAgIHJldHVybiBjYWxsYmFjayhtb2NrVHhuKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5wcm9jZXNzU3Vic2NyaXB0aW9uUmVuZXdhbChtb2NrU3Vic2NyaXB0aW9uLmlkKTtcblxuICAgICAgICBleHBlY3QocmVzdWx0LnN0YXR1cykudG9CZShTdWJzY3JpcHRpb25TdGF0dXMuUEFTVF9EVUUpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgdGhyb3cgZXJyb3Igd2hlbiBzdWJzY3JpcHRpb24gbm90IGZvdW5kJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAocHJpc21hU2VydmljZS5zdWJzY3JpcHRpb24uZmluZFVuaXF1ZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpO1xuXG4gICAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgICBzZXJ2aWNlLnByb2Nlc3NTdWJzY3JpcHRpb25SZW5ld2FsKCdub24tZXhpc3RlbnQtc3Vic2NyaXB0aW9uJylcbiAgICAgICAgKS5yZWplY3RzLnRvVGhyb3coTm90Rm91bmRFeGNlcHRpb24pO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnZ2V0U3Vic2NyaXB0aW9uVXNhZ2VBbmFseXRpY3MnLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIHJldHVybiB1c2FnZSBhbmFseXRpY3MgZm9yIHN1YnNjcmlwdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3Qgc3RhcnREYXRlID0gbmV3IERhdGUoJzIwMjQtMDEtMDEnKTtcbiAgICAgICAgY29uc3QgZW5kRGF0ZSA9IG5ldyBEYXRlKCcyMDI0LTAxLTMxJyk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBtb2NrVXNhZ2VSZWNvcmRzID0gW1xuICAgICAgICAgIHsgZmVhdHVyZTogJ2FwaV9jYWxscycsIHF1YW50aXR5OiAxMDAwLCB1c2FnZURhdGU6IG5ldyBEYXRlKCcyMDI0LTAxLTE1JykgfSxcbiAgICAgICAgICB7IGZlYXR1cmU6ICdzdG9yYWdlJywgcXVhbnRpdHk6IDUwLCB1c2FnZURhdGU6IG5ldyBEYXRlKCcyMDI0LTAxLTIwJykgfSxcbiAgICAgICAgICB7IGZlYXR1cmU6ICdhcGlfY2FsbHMnLCBxdWFudGl0eTogODAwLCB1c2FnZURhdGU6IG5ldyBEYXRlKCcyMDI0LTAxLTI1JykgfSxcbiAgICAgICAgXTtcblxuICAgICAgICBjb25zdCBleHBlY3RlZEFuYWx5dGljcyA9IHtcbiAgICAgICAgICBzdWJzY3JpcHRpb25JZDogbW9ja1N1YnNjcmlwdGlvbi5pZCxcbiAgICAgICAgICBwZXJpb2Q6IHsgc3RhcnQ6IHN0YXJ0RGF0ZSwgZW5kOiBlbmREYXRlIH0sXG4gICAgICAgICAgdG90YWxVc2FnZToge1xuICAgICAgICAgICAgYXBpX2NhbGxzOiAxODAwLFxuICAgICAgICAgICAgc3RvcmFnZTogNTAsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBkYWlseVVzYWdlOiBbXG4gICAgICAgICAgICB7IGRhdGU6ICcyMDI0LTAxLTE1JywgYXBpX2NhbGxzOiAxMDAwIH0sXG4gICAgICAgICAgICB7IGRhdGU6ICcyMDI0LTAxLTIwJywgc3RvcmFnZTogNTAgfSxcbiAgICAgICAgICAgIHsgZGF0ZTogJzIwMjQtMDEtMjUnLCBhcGlfY2FsbHM6IDgwMCB9LFxuICAgICAgICAgIF0sXG4gICAgICAgICAgdHJlbmRzOiB7XG4gICAgICAgICAgICBhcGlfY2FsbHM6IHsgZ3Jvd3RoOiAwLjIsIHRyZW5kOiAnaW5jcmVhc2luZycgfSxcbiAgICAgICAgICAgIHN0b3JhZ2U6IHsgZ3Jvd3RoOiAwLjAsIHRyZW5kOiAnc3RhYmxlJyB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH07XG5cbiAgICAgICAgKHByaXNtYVNlcnZpY2UudXNhZ2VSZWNvcmQuZmluZE1hbnkgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXNhZ2VSZWNvcmRzKTtcbiAgICAgICAgKHByaXNtYVNlcnZpY2UudXNhZ2VSZWNvcmQuZ3JvdXBCeSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKFtcbiAgICAgICAgICB7IGZlYXR1cmU6ICdhcGlfY2FsbHMnLCBfc3VtOiB7IHF1YW50aXR5OiAxODAwIH0gfSxcbiAgICAgICAgICB7IGZlYXR1cmU6ICdzdG9yYWdlJywgX3N1bTogeyBxdWFudGl0eTogNTAgfSB9LFxuICAgICAgICBdKTtcblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLmdldFN1YnNjcmlwdGlvblVzYWdlQW5hbHl0aWNzKFxuICAgICAgICAgIG1vY2tTdWJzY3JpcHRpb24uaWQsXG4gICAgICAgICAgc3RhcnREYXRlLFxuICAgICAgICAgIGVuZERhdGVcbiAgICAgICAgKTtcblxuICAgICAgICBleHBlY3QocmVzdWx0LnN1YnNjcmlwdGlvbklkKS50b0JlKG1vY2tTdWJzY3JpcHRpb24uaWQpO1xuICAgICAgICBleHBlY3QocmVzdWx0LnRvdGFsVXNhZ2UpLnRvQmVEZWZpbmVkKCk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQudG90YWxVc2FnZS5hcGlfY2FsbHMpLnRvQmUoMTgwMCk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQudG90YWxVc2FnZS5zdG9yYWdlKS50b0JlKDUwKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIHJldHVybiBhbmFseXRpY3MgZm9yIGN1cnJlbnQgbW9udGggd2hlbiBubyBkYXRlcyBwcm92aWRlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgY3VycmVudERhdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICBjb25zdCBzdGFydE9mTW9udGggPSBuZXcgRGF0ZShjdXJyZW50RGF0ZS5nZXRGdWxsWWVhcigpLCBjdXJyZW50RGF0ZS5nZXRNb250aCgpLCAxKTtcbiAgICAgICAgY29uc3QgZW5kT2ZNb250aCA9IG5ldyBEYXRlKGN1cnJlbnREYXRlLmdldEZ1bGxZZWFyKCksIGN1cnJlbnREYXRlLmdldE1vbnRoKCkgKyAxLCAwKTtcblxuICAgICAgICAocHJpc21hU2VydmljZS51c2FnZVJlY29yZC5maW5kTWFueSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKFtdKTtcbiAgICAgICAgKHByaXNtYVNlcnZpY2UudXNhZ2VSZWNvcmQuZ3JvdXBCeSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKFtdKTtcblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLmdldFN1YnNjcmlwdGlvblVzYWdlQW5hbHl0aWNzKG1vY2tTdWJzY3JpcHRpb24uaWQpO1xuXG4gICAgICAgIGV4cGVjdChyZXN1bHQucGVyaW9kLnN0YXJ0LmdldE1vbnRoKCkpLnRvQmUoc3RhcnRPZk1vbnRoLmdldE1vbnRoKCkpO1xuICAgICAgICBleHBlY3QocmVzdWx0LnBlcmlvZC5lbmQuZ2V0TW9udGgoKSkudG9CZShlbmRPZk1vbnRoLmdldE1vbnRoKCkpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdBZHZhbmNlZCBCaWxsaW5nIEZlYXR1cmVzJywgKCkgPT4ge1xuICAgIGRlc2NyaWJlKCdQcm9yYXRpb24gQ2FsY3VsYXRpb25zJywgKCkgPT4ge1xuICAgICAgaXQoJ3Nob3VsZCBjYWxjdWxhdGUgcHJvcmF0ZWQgYW1vdW50IGZvciBtaWQtY3ljbGUgdXBncmFkZScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgY3VycmVudERhdGUgPSBuZXcgRGF0ZSgnMjAyNC0wMS0xNScpO1xuICAgICAgICBjb25zdCBwZXJpb2RTdGFydCA9IG5ldyBEYXRlKCcyMDI0LTAxLTAxJyk7XG4gICAgICAgIGNvbnN0IHBlcmlvZEVuZCA9IG5ldyBEYXRlKCcyMDI0LTAyLTAxJyk7XG4gICAgICAgIGNvbnN0IG9sZEFtb3VudCA9IDEwLjAwO1xuICAgICAgICBjb25zdCBuZXdBbW91bnQgPSAzMC4wMDtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IChzZXJ2aWNlIGFzIGFueSkuY2FsY3VsYXRlUHJvcmF0aW9uKFxuICAgICAgICAgIG9sZEFtb3VudCxcbiAgICAgICAgICBuZXdBbW91bnQsXG4gICAgICAgICAgcGVyaW9kU3RhcnQsXG4gICAgICAgICAgcGVyaW9kRW5kLFxuICAgICAgICAgIGN1cnJlbnREYXRlXG4gICAgICAgICk7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdC5jcmVkaXQpLnRvQmVMZXNzVGhhbigwKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5jaGFyZ2UpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5uZXRBbW91bnQpLnRvQmUocmVzdWx0LmNyZWRpdCArIHJlc3VsdC5jaGFyZ2UpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgY2FsY3VsYXRlIHByb3JhdGVkIGFtb3VudCBmb3IgZG93bmdyYWRlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBjdXJyZW50RGF0ZSA9IG5ldyBEYXRlKCcyMDI0LTAxLTEwJyk7XG4gICAgICAgIGNvbnN0IHBlcmlvZFN0YXJ0ID0gbmV3IERhdGUoJzIwMjQtMDEtMDEnKTtcbiAgICAgICAgY29uc3QgcGVyaW9kRW5kID0gbmV3IERhdGUoJzIwMjQtMDItMDEnKTtcbiAgICAgICAgY29uc3Qgb2xkQW1vdW50ID0gMzAuMDA7XG4gICAgICAgIGNvbnN0IG5ld0Ftb3VudCA9IDEwLjAwO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gKHNlcnZpY2UgYXMgYW55KS5jYWxjdWxhdGVQcm9yYXRpb24oXG4gICAgICAgICAgb2xkQW1vdW50LFxuICAgICAgICAgIG5ld0Ftb3VudCxcbiAgICAgICAgICBwZXJpb2RTdGFydCxcbiAgICAgICAgICBwZXJpb2RFbmQsXG4gICAgICAgICAgY3VycmVudERhdGVcbiAgICAgICAgKTtcblxuICAgICAgICBleHBlY3QocmVzdWx0LmNyZWRpdCkudG9CZUxlc3NUaGFuKDApO1xuICAgICAgICBleHBlY3QocmVzdWx0LmNoYXJnZSkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgICBleHBlY3QocmVzdWx0Lm5ldEFtb3VudCkudG9CZUxlc3NUaGFuKDApO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgaGFuZGxlIGVuZC1vZi1wZXJpb2QgY2hhbmdlcyB3aXRoIG5vIHByb3JhdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgY3VycmVudERhdGUgPSBuZXcgRGF0ZSgnMjAyNC0wMi0wMScpO1xuICAgICAgICBjb25zdCBwZXJpb2RTdGFydCA9IG5ldyBEYXRlKCcyMDI0LTAxLTAxJyk7XG4gICAgICAgIGNvbnN0IHBlcmlvZEVuZCA9IG5ldyBEYXRlKCcyMDI0LTAyLTAxJyk7XG4gICAgICAgIGNvbnN0IG9sZEFtb3VudCA9IDEwLjAwO1xuICAgICAgICBjb25zdCBuZXdBbW91bnQgPSAzMC4wMDtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IChzZXJ2aWNlIGFzIGFueSkuY2FsY3VsYXRlUHJvcmF0aW9uKFxuICAgICAgICAgIG9sZEFtb3VudCxcbiAgICAgICAgICBuZXdBbW91bnQsXG4gICAgICAgICAgcGVyaW9kU3RhcnQsXG4gICAgICAgICAgcGVyaW9kRW5kLFxuICAgICAgICAgIGN1cnJlbnREYXRlXG4gICAgICAgICk7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdC5jcmVkaXQpLnRvQmUoMCk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuY2hhcmdlKS50b0JlKDApO1xuICAgICAgICBleHBlY3QocmVzdWx0Lm5ldEFtb3VudCkudG9CZSgwKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ1VzYWdlLUJhc2VkIEJpbGxpbmcnLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIGNhbGN1bGF0ZSB1c2FnZSBjaGFyZ2VzIGZvciBtZXRlcmVkIGZlYXR1cmVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBtb2NrVXNhZ2VSZWNvcmRzID0gW1xuICAgICAgICAgIHsgZmVhdHVyZTogJ2FwaV9jYWxscycsIHF1YW50aXR5OiAxMDAwLCB1bml0UHJpY2U6IDAuMDEgfSxcbiAgICAgICAgICB7IGZlYXR1cmU6ICdzdG9yYWdlX2diJywgcXVhbnRpdHk6IDI1LCB1bml0UHJpY2U6IDAuMTAgfSxcbiAgICAgICAgICB7IGZlYXR1cmU6ICdiYW5kd2lkdGhfZ2InLCBxdWFudGl0eTogMTAwLCB1bml0UHJpY2U6IDAuMDUgfSxcbiAgICAgICAgXTtcblxuICAgICAgICBjb25zdCBzdGFydERhdGUgPSBuZXcgRGF0ZSgnMjAyNC0wMS0wMScpO1xuICAgICAgICBjb25zdCBlbmREYXRlID0gbmV3IERhdGUoJzIwMjQtMDEtMzEnKTtcblxuICAgICAgICAocHJpc21hU2VydmljZS51c2FnZVJlY29yZC5maW5kTWFueSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVc2FnZVJlY29yZHMpO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuY2FsY3VsYXRlVXNhZ2VDaGFyZ2VzKFxuICAgICAgICAgICdzdWJzY3JpcHRpb24taWQnLFxuICAgICAgICAgIHN0YXJ0RGF0ZSxcbiAgICAgICAgICBlbmREYXRlXG4gICAgICAgICk7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdC50b3RhbENoYXJnZXMpLnRvQmUoMTcuNTApO1xuICAgICAgICBleHBlY3QocmVzdWx0LmJyZWFrZG93bikudG9IYXZlTGVuZ3RoKDMpO1xuICAgICAgICBleHBlY3QocmVzdWx0LmJyZWFrZG93blswXSkudG9FcXVhbCh7XG4gICAgICAgICAgZmVhdHVyZTogJ2FwaV9jYWxscycsXG4gICAgICAgICAgcXVhbnRpdHk6IDEwMDAsXG4gICAgICAgICAgdW5pdFByaWNlOiAwLjAxLFxuICAgICAgICAgIHRvdGFsQ2hhcmdlOiAxMC4wMCxcbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBhcHBseSB1c2FnZSB0aWVycyBhbmQgZGlzY291bnRzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBtb2NrVXNhZ2VSZWNvcmRzID0gW1xuICAgICAgICAgIHsgZmVhdHVyZTogJ2FwaV9jYWxscycsIHF1YW50aXR5OiAxMDAwMCwgdW5pdFByaWNlOiAwLjAxIH0sXG4gICAgICAgIF07XG5cbiAgICAgICAgY29uc3QgbW9ja1ByaWNpbmdUaWVycyA9IFtcbiAgICAgICAgICB7IG1pbjogMCwgbWF4OiAxMDAwLCBwcmljZTogMC4wMSB9LFxuICAgICAgICAgIHsgbWluOiAxMDAxLCBtYXg6IDUwMDAsIHByaWNlOiAwLjAwOCB9LFxuICAgICAgICAgIHsgbWluOiA1MDAxLCBtYXg6IEluZmluaXR5LCBwcmljZTogMC4wMDUgfSxcbiAgICAgICAgXTtcblxuICAgICAgICAocHJpc21hU2VydmljZS51c2FnZVJlY29yZC5maW5kTWFueSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVc2FnZVJlY29yZHMpO1xuICAgICAgICAocHJpc21hU2VydmljZS5wcmljaW5nVGllci5maW5kTWFueSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tQcmljaW5nVGllcnMpO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuY2FsY3VsYXRlVGllcmVkVXNhZ2VDaGFyZ2VzKFxuICAgICAgICAgICdzdWJzY3JpcHRpb24taWQnLFxuICAgICAgICAgICdhcGlfY2FsbHMnLFxuICAgICAgICAgIG5ldyBEYXRlKCcyMDI0LTAxLTAxJyksXG4gICAgICAgICAgbmV3IERhdGUoJzIwMjQtMDEtMzEnKVxuICAgICAgICApO1xuXG4gICAgICAgIGV4cGVjdChyZXN1bHQudG90YWxDaGFyZ2UpLnRvQmUoNjcpO1xuICAgICAgICBleHBlY3QocmVzdWx0LnRpZXJzKS50b0hhdmVMZW5ndGgoMyk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdSZXZlbnVlIFJlY29nbml0aW9uJywgKCkgPT4ge1xuICAgICAgaXQoJ3Nob3VsZCByZWNvZ25pemUgcmV2ZW51ZSBmb3IgbW9udGhseSBzdWJzY3JpcHRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHN1YnNjcmlwdGlvbiA9IHtcbiAgICAgICAgICBpZDogJ3N1YnNjcmlwdGlvbi1pZCcsXG4gICAgICAgICAgYW1vdW50OiAyOS45OSxcbiAgICAgICAgICBiaWxsaW5nQ3ljbGU6IEJpbGxpbmdDeWNsZS5NT05USExZLFxuICAgICAgICAgIGN1cnJlbnRQZXJpb2RTdGFydDogbmV3IERhdGUoJzIwMjQtMDEtMDEnKSxcbiAgICAgICAgICBjdXJyZW50UGVyaW9kRW5kOiBuZXcgRGF0ZSgnMjAyNC0wMi0wMScpLFxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuY2FsY3VsYXRlUmV2ZW51ZVJlY29nbml0aW9uKHN1YnNjcmlwdGlvbiBhcyBhbnkpO1xuXG4gICAgICAgIGV4cGVjdChyZXN1bHQudG90YWxSZXZlbnVlKS50b0JlKDI5Ljk5KTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5kYWlseVJldmVudWUpLnRvQmVDbG9zZVRvKDAuOTcsIDIpO1xuICAgICAgICBleHBlY3QocmVzdWx0LnJlY29nbml0aW9uU2NoZWR1bGUpLnRvSGF2ZUxlbmd0aCgzMSk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgZGVmZXJyZWQgcmV2ZW51ZSBmb3IgYW5udWFsIHN1YnNjcmlwdGlvbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHN1YnNjcmlwdGlvbiA9IHtcbiAgICAgICAgICBpZDogJ3N1YnNjcmlwdGlvbi1pZCcsXG4gICAgICAgICAgYW1vdW50OiAyOTkuOTksXG4gICAgICAgICAgYmlsbGluZ0N5Y2xlOiBCaWxsaW5nQ3ljbGUuWUVBUkxZLFxuICAgICAgICAgIGN1cnJlbnRQZXJpb2RTdGFydDogbmV3IERhdGUoJzIwMjQtMDEtMDEnKSxcbiAgICAgICAgICBjdXJyZW50UGVyaW9kRW5kOiBuZXcgRGF0ZSgnMjAyNS0wMS0wMScpLFxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuY2FsY3VsYXRlUmV2ZW51ZVJlY29nbml0aW9uKHN1YnNjcmlwdGlvbiBhcyBhbnkpO1xuXG4gICAgICAgIGV4cGVjdChyZXN1bHQudG90YWxSZXZlbnVlKS50b0JlKDI5OS45OSk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQubW9udGhseVJldmVudWUpLnRvQmVDbG9zZVRvKDI1LjAwLCAyKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5yZWNvZ25pdGlvblNjaGVkdWxlKS50b0hhdmVMZW5ndGgoMTIpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnVGF4IENhbGN1bGF0aW9ucycsICgpID0+IHtcbiAgICAgIGl0KCdzaG91bGQgY2FsY3VsYXRlIHRheCBmb3IgVVMgY3VzdG9tZXJzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBiaWxsaW5nQWRkcmVzcyA9IHtcbiAgICAgICAgICBjb3VudHJ5OiAnVVMnLFxuICAgICAgICAgIHN0YXRlOiAnQ0EnLFxuICAgICAgICAgIGNpdHk6ICdTYW4gRnJhbmNpc2NvJyxcbiAgICAgICAgICBwb3N0YWxDb2RlOiAnOTQxMDUnLFxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IGFtb3VudCA9IDEwMC4wMDtcblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLmNhbGN1bGF0ZVRheChhbW91bnQsIGJpbGxpbmdBZGRyZXNzKTtcblxuICAgICAgICBleHBlY3QocmVzdWx0LnRheEFtb3VudCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgICBleHBlY3QocmVzdWx0LnRheFJhdGUpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC50YXhKdXJpc2RpY3Rpb24pLnRvQmUoJ0NBJyk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQudG90YWxBbW91bnQpLnRvQmUoYW1vdW50ICsgcmVzdWx0LnRheEFtb3VudCk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgVkFUIGZvciBFVSBjdXN0b21lcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGJpbGxpbmdBZGRyZXNzID0ge1xuICAgICAgICAgIGNvdW50cnk6ICdERScsXG4gICAgICAgICAgdmF0TnVtYmVyOiAnREUxMjM0NTY3ODknLFxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IGFtb3VudCA9IDEwMC4wMDtcblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLmNhbGN1bGF0ZVRheChhbW91bnQsIGJpbGxpbmdBZGRyZXNzKTtcblxuICAgICAgICBleHBlY3QocmVzdWx0LnRheFR5cGUpLnRvQmUoJ1ZBVCcpO1xuICAgICAgICBleHBlY3QocmVzdWx0LnZhdE51bWJlcikudG9CZSgnREUxMjM0NTY3ODknKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIHNraXAgdGF4IGZvciB0YXgtZXhlbXB0IGN1c3RvbWVycycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgYmlsbGluZ0FkZHJlc3MgPSB7XG4gICAgICAgICAgY291bnRyeTogJ1VTJyxcbiAgICAgICAgICBzdGF0ZTogJ0NBJyxcbiAgICAgICAgICB0YXhFeGVtcHQ6IHRydWUsXG4gICAgICAgICAgZXhlbXB0aW9uQ2VydGlmaWNhdGU6ICdFWEVNUFQtMTIzJyxcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBhbW91bnQgPSAxMDAuMDA7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5jYWxjdWxhdGVUYXgoYW1vdW50LCBiaWxsaW5nQWRkcmVzcyk7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdC50YXhBbW91bnQpLnRvQmUoMCk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuZXhlbXB0aW9uUmVhc29uKS50b0JlKCdUYXggZXhlbXB0IGN1c3RvbWVyJyk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdEdW5uaW5nIE1hbmFnZW1lbnQnLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIHByb2Nlc3MgZmFpbGVkIHBheW1lbnQgd2l0aCByZXRyeSBsb2dpYycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgZmFpbGVkUGF5bWVudCA9IHtcbiAgICAgICAgICBpZDogJ3BheW1lbnQtaWQnLFxuICAgICAgICAgIHN1YnNjcmlwdGlvbklkOiAnc3Vic2NyaXB0aW9uLWlkJyxcbiAgICAgICAgICBhbW91bnQ6IDI5Ljk5LFxuICAgICAgICAgIHN0YXR1czogUGF5bWVudFN0YXR1cy5GQUlMRUQsXG4gICAgICAgICAgYXR0ZW1wdENvdW50OiAxLFxuICAgICAgICAgIGZhaWx1cmVDb2RlOiAnY2FyZF9kZWNsaW5lZCcsXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgbW9ja1N1YnNjcmlwdGlvbiA9IHtcbiAgICAgICAgICBpZDogJ3N1YnNjcmlwdGlvbi1pZCcsXG4gICAgICAgICAgc3RhdHVzOiBTdWJzY3JpcHRpb25TdGF0dXMuQUNUSVZFLFxuICAgICAgICAgIGRlZmF1bHRQYXltZW50TWV0aG9kSWQ6ICdwYXltZW50LW1ldGhvZC1pZCcsXG4gICAgICAgIH07XG5cbiAgICAgICAgKHByaXNtYVNlcnZpY2UucGF5bWVudC5maW5kVW5pcXVlIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoZmFpbGVkUGF5bWVudCk7XG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLnN1YnNjcmlwdGlvbi5maW5kVW5pcXVlIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1N1YnNjcmlwdGlvbik7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5wcm9jZXNzRHVubmluZygncGF5bWVudC1pZCcpO1xuXG4gICAgICAgIGV4cGVjdChyZXN1bHQucmV0cnlTY2hlZHVsZWQpLnRvQmUodHJ1ZSk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQubmV4dFJldHJ5RGF0ZSkudG9CZURlZmluZWQoKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5kdW5uaW5nTGV2ZWwpLnRvQmUoMSk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBlc2NhbGF0ZSBkdW5uaW5nIGFmdGVyIG11bHRpcGxlIGZhaWx1cmVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBmYWlsZWRQYXltZW50ID0ge1xuICAgICAgICAgIGlkOiAncGF5bWVudC1pZCcsXG4gICAgICAgICAgc3Vic2NyaXB0aW9uSWQ6ICdzdWJzY3JpcHRpb24taWQnLFxuICAgICAgICAgIHN0YXR1czogUGF5bWVudFN0YXR1cy5GQUlMRUQsXG4gICAgICAgICAgYXR0ZW1wdENvdW50OiAzLFxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IG1vY2tTdWJzY3JpcHRpb24gPSB7XG4gICAgICAgICAgaWQ6ICdzdWJzY3JpcHRpb24taWQnLFxuICAgICAgICAgIHN0YXR1czogU3Vic2NyaXB0aW9uU3RhdHVzLlBBU1RfRFVFLFxuICAgICAgICB9O1xuXG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLnBheW1lbnQuZmluZFVuaXF1ZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKGZhaWxlZFBheW1lbnQpO1xuICAgICAgICAocHJpc21hU2VydmljZS5zdWJzY3JpcHRpb24uZmluZFVuaXF1ZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tTdWJzY3JpcHRpb24pO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UucHJvY2Vzc0R1bm5pbmcoJ3BheW1lbnQtaWQnKTtcblxuICAgICAgICBleHBlY3QocmVzdWx0LmVzY2FsYXRlZCkudG9CZSh0cnVlKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5kdW5uaW5nTGV2ZWwpLnRvQmUoMyk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuYWN0aW9uUmVxdWlyZWQpLnRvQmUoJ3VwZGF0ZV9wYXltZW50X21ldGhvZCcpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgY2FuY2VsIHN1YnNjcmlwdGlvbiBhZnRlciBtYXhpbXVtIHJldHJpZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGZhaWxlZFBheW1lbnQgPSB7XG4gICAgICAgICAgaWQ6ICdwYXltZW50LWlkJyxcbiAgICAgICAgICBzdWJzY3JpcHRpb25JZDogJ3N1YnNjcmlwdGlvbi1pZCcsXG4gICAgICAgICAgc3RhdHVzOiBQYXltZW50U3RhdHVzLkZBSUxFRCxcbiAgICAgICAgICBhdHRlbXB0Q291bnQ6IDUsXG4gICAgICAgIH07XG5cbiAgICAgICAgKHByaXNtYVNlcnZpY2UucGF5bWVudC5maW5kVW5pcXVlIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoZmFpbGVkUGF5bWVudCk7XG4gICAgICAgIGplc3Quc3B5T24oc2VydmljZSwgJ2NhbmNlbFN1YnNjcmlwdGlvbicpLm1vY2tSZXNvbHZlZFZhbHVlKHsgc3RhdHVzOiBTdWJzY3JpcHRpb25TdGF0dXMuQ0FOQ0VMRUQgfSBhcyBhbnkpO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UucHJvY2Vzc0R1bm5pbmcoJ3BheW1lbnQtaWQnKTtcblxuICAgICAgICBleHBlY3QocmVzdWx0LnN1YnNjcmlwdGlvbkNhbmNlbGVkKS50b0JlKHRydWUpO1xuICAgICAgICBleHBlY3Qoc2VydmljZS5jYW5jZWxTdWJzY3JpcHRpb24pLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ1N1YnNjcmlwdGlvbiBBbmFseXRpY3MnLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIGNhbGN1bGF0ZSBjdXN0b21lciBsaWZldGltZSB2YWx1ZScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgbW9ja1BheW1lbnRzID0gW1xuICAgICAgICAgIHsgYW1vdW50OiAyOS45OSwgY3JlYXRlZEF0OiBuZXcgRGF0ZSgnMjAyNC0wMS0wMScpIH0sXG4gICAgICAgICAgeyBhbW91bnQ6IDI5Ljk5LCBjcmVhdGVkQXQ6IG5ldyBEYXRlKCcyMDI0LTAyLTAxJykgfSxcbiAgICAgICAgICB7IGFtb3VudDogMjkuOTksIGNyZWF0ZWRBdDogbmV3IERhdGUoJzIwMjQtMDMtMDEnKSB9LFxuICAgICAgICBdO1xuXG4gICAgICAgIGNvbnN0IG1vY2tTdWJzY3JpcHRpb24gPSB7XG4gICAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgnMjAyNC0wMS0wMScpLFxuICAgICAgICAgIHN0YXR1czogU3Vic2NyaXB0aW9uU3RhdHVzLkFDVElWRSxcbiAgICAgICAgfTtcblxuICAgICAgICAocHJpc21hU2VydmljZS5wYXltZW50LmZpbmRNYW55IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1BheW1lbnRzKTtcblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLmNhbGN1bGF0ZUN1c3RvbWVyTGlmZXRpbWVWYWx1ZShcbiAgICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgICBtb2NrU3Vic2NyaXB0aW9uIGFzIGFueVxuICAgICAgICApO1xuXG4gICAgICAgIGV4cGVjdChyZXN1bHQudG90YWxSZXZlbnVlKS50b0JlKDg5Ljk3KTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5hdmVyYWdlTW9udGhseVJldmVudWUpLnRvQmVDbG9zZVRvKDI5Ljk5LCAyKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5zdWJzY3JpcHRpb25Nb250aHMpLnRvQmUoMyk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQucHJvamVjdGVkTFRWKS50b0JlR3JlYXRlclRoYW4oODkuOTcpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgY2FsY3VsYXRlIGNodXJuIHByZWRpY3Rpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IG1vY2tVc2FnZURhdGEgPSB7XG4gICAgICAgICAgbGFzdExvZ2luRGF0ZTogbmV3IERhdGUoJzIwMjQtMDEtMDEnKSxcbiAgICAgICAgICBhdmVyYWdlU2Vzc2lvbkR1cmF0aW9uOiAzMDAsXG4gICAgICAgICAgZmVhdHVyZVVzYWdlOiB7XG4gICAgICAgICAgICBhcGlfY2FsbHM6IDEwMCxcbiAgICAgICAgICAgIHN0b3JhZ2U6IDEsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBzdXBwb3J0VGlja2V0czogMixcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBtb2NrUGF5bWVudEhpc3RvcnkgPSBbXG4gICAgICAgICAgeyBzdGF0dXM6IFBheW1lbnRTdGF0dXMuRkFJTEVELCBjcmVhdGVkQXQ6IG5ldyBEYXRlKCcyMDI0LTAxLTE1JykgfSxcbiAgICAgICAgICB7IHN0YXR1czogUGF5bWVudFN0YXR1cy5TVUNDRUVERUQsIGNyZWF0ZWRBdDogbmV3IERhdGUoJzIwMjQtMDEtMDEnKSB9LFxuICAgICAgICBdO1xuXG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLnVzYWdlUmVjb3JkLmZpbmRNYW55IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzYWdlRGF0YS5mZWF0dXJlVXNhZ2UpO1xuICAgICAgICAocHJpc21hU2VydmljZS5wYXltZW50LmZpbmRNYW55IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1BheW1lbnRIaXN0b3J5KTtcblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLmNhbGN1bGF0ZUNodXJuUHJlZGljdGlvbihcbiAgICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgICBtb2NrVXNhZ2VEYXRhXG4gICAgICAgICk7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdC5jaHVyblJpc2spLnRvQmVHcmVhdGVyVGhhbigwLjUpO1xuICAgICAgICBleHBlY3QocmVzdWx0LnJpc2tGYWN0b3JzKS50b0NvbnRhaW4oJ2xvd191c2FnZScpO1xuICAgICAgICBleHBlY3QocmVzdWx0LnJpc2tGYWN0b3JzKS50b0NvbnRhaW4oJ3BheW1lbnRfZmFpbHVyZXMnKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5yZWNvbW1lbmRlZEFjdGlvbnMpLnRvQ29udGFpbignZW5nYWdlbWVudF9jYW1wYWlnbicpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdJbnRlZ3JhdGlvbiBUZXN0cycsICgpID0+IHtcbiAgICBkZXNjcmliZSgnQ29tcGxldGUgU3Vic2NyaXB0aW9uIExpZmVjeWNsZScsICgpID0+IHtcbiAgICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbXBsZXRlIHN1YnNjcmlwdGlvbiBmbG93IGZyb20gY3JlYXRpb24gdG8gY2FuY2VsbGF0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBtb2NrUGxhbiA9IHtcbiAgICAgICAgICBpZDogJ3BsYW4taWQnLFxuICAgICAgICAgIC8vIHRpZXI6ICdQUkVNSVVNJywgLy8gU3Vic2NyaXB0aW9uVGllciByZW1vdmVkXG4gICAgICAgICAgbW9udGhseVByaWNlOiAyOS45OSxcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBtb2NrUGF5bWVudE1ldGhvZCA9IHtcbiAgICAgICAgICBpZDogJ3BheW1lbnQtbWV0aG9kLWlkJyxcbiAgICAgICAgICB0eXBlOiBQYXltZW50TWV0aG9kVHlwZS5DQVJELFxuICAgICAgICAgIGlzRGVmYXVsdDogdHJ1ZSxcbiAgICAgICAgfTtcblxuICAgICAgICAocHJpc21hU2VydmljZS5zdWJzY3JpcHRpb25QbGFuLmZpbmRVbmlxdWUgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUGxhbik7XG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLnN1YnNjcmlwdGlvbi5jcmVhdGUgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgaWQ6ICdzdWJzY3JpcHRpb24taWQnLFxuICAgICAgICAgIHVzZXJJZDogVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgICAgc3RhdHVzOiBTdWJzY3JpcHRpb25TdGF0dXMuQUNUSVZFLFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBzdWJzY3JpcHRpb24gPSBhd2FpdCBzZXJ2aWNlLmNyZWF0ZVN1YnNjcmlwdGlvbih7XG4gICAgICAgICAgdXNlcklkOiBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgICBwbGFuSWQ6ICdwbGFuLWlkJyxcbiAgICAgICAgICBwYXltZW50TWV0aG9kSWQ6ICdwYXltZW50LW1ldGhvZC1pZCcsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGV4cGVjdChzdWJzY3JpcHRpb24uc3RhdHVzKS50b0JlKFN1YnNjcmlwdGlvblN0YXR1cy5BQ1RJVkUpO1xuXG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLnBheW1lbnQuY3JlYXRlIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAgIGlkOiAncGF5bWVudC1pZCcsXG4gICAgICAgICAgc3RhdHVzOiBQYXltZW50U3RhdHVzLlNVQ0NFRURFRCxcbiAgICAgICAgICBhbW91bnQ6IDI5Ljk5LFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgc2VydmljZS5jcmVhdGVQYXltZW50KHtcbiAgICAgICAgICBhbW91bnQ6IDI5Ljk5LFxuICAgICAgICAgIHN1YnNjcmlwdGlvbklkOiBzdWJzY3JpcHRpb24uaWQsXG4gICAgICAgICAgcGF5bWVudE1ldGhvZElkOiAncGF5bWVudC1tZXRob2QtaWQnLFxuICAgICAgICB9KTtcblxuICAgICAgICBleHBlY3QocGF5bWVudC5zdGF0dXMpLnRvQmUoUGF5bWVudFN0YXR1cy5TVUNDRUVERUQpO1xuXG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLnVzYWdlUmVjb3JkLmNyZWF0ZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICBpZDogJ3VzYWdlLWlkJyxcbiAgICAgICAgICBmZWF0dXJlOiAnYXBpX2NhbGxzJyxcbiAgICAgICAgICBxdWFudGl0eTogMTAwMCxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgdXNhZ2UgPSBhd2FpdCBzZXJ2aWNlLnJlY29yZFVzYWdlKHtcbiAgICAgICAgICBzdWJzY3JpcHRpb25JZDogc3Vic2NyaXB0aW9uLmlkLFxuICAgICAgICAgIGZlYXR1cmU6ICdhcGlfY2FsbHMnLFxuICAgICAgICAgIHF1YW50aXR5OiAxMDAwLFxuICAgICAgICB9KTtcblxuICAgICAgICBleHBlY3QodXNhZ2UucXVhbnRpdHkpLnRvQmUoMTAwMCk7XG5cbiAgICAgICAgamVzdC5zcHlPbihzZXJ2aWNlLCAndXBkYXRlU3Vic2NyaXB0aW9uJykubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAgIC4uLnN1YnNjcmlwdGlvbixcbiAgICAgICAgICBzdGF0dXM6IFN1YnNjcmlwdGlvblN0YXR1cy5DQU5DRUxFRCxcbiAgICAgICAgfSBhcyBhbnkpO1xuXG4gICAgICAgIGNvbnN0IGNhbmNlbGVkU3Vic2NyaXB0aW9uID0gYXdhaXQgc2VydmljZS5jYW5jZWxTdWJzY3JpcHRpb24oVEVTVF9VU0VSX0lEUy5DTElFTlQpO1xuXG4gICAgICAgIGV4cGVjdChjYW5jZWxlZFN1YnNjcmlwdGlvbi5zdGF0dXMpLnRvQmUoU3Vic2NyaXB0aW9uU3RhdHVzLkNBTkNFTEVEKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIGhhbmRsZSBzdWJzY3JpcHRpb24gdXBncmFkZSB3aXRoIHByb3JhdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgYmFzaWNQbGFuID0ge1xuICAgICAgICAgIGlkOiAnYmFzaWMtcGxhbicsXG4gICAgICAgICAgLy8gdGllcjogJ0JBU0lDJywgLy8gU3Vic2NyaXB0aW9uVGllciByZW1vdmVkXG4gICAgICAgICAgbW9udGhseVByaWNlOiA5Ljk5LFxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IHByZW1pdW1QbGFuID0ge1xuICAgICAgICAgIGlkOiAncHJlbWl1bS1wbGFuJyxcbiAgICAgICAgICAvLyB0aWVyOiAnUFJFTUlVTScsIC8vIFN1YnNjcmlwdGlvblRpZXIgcmVtb3ZlZFxuICAgICAgICAgIG1vbnRobHlQcmljZTogMjkuOTksXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgY3VycmVudFN1YnNjcmlwdGlvbiA9IHtcbiAgICAgICAgICBpZDogJ3N1YnNjcmlwdGlvbi1pZCcsXG4gICAgICAgICAgdXNlcklkOiBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgICBwbGFuSWQ6ICdiYXNpYy1wbGFuJyxcbiAgICAgICAgICAvLyB0aWVyOiAnQkFTSUMnLCAvLyBTdWJzY3JpcHRpb25UaWVyIHJlbW92ZWRcbiAgICAgICAgICBhbW91bnQ6IDkuOTksXG4gICAgICAgICAgY3VycmVudFBlcmlvZFN0YXJ0OiBuZXcgRGF0ZSgnMjAyNC0wMS0wMScpLFxuICAgICAgICAgIGN1cnJlbnRQZXJpb2RFbmQ6IG5ldyBEYXRlKCcyMDI0LTAyLTAxJyksXG4gICAgICAgIH07XG5cbiAgICAgICAgamVzdC5zcHlPbihzZXJ2aWNlLCAnZmluZFVzZXJTdWJzY3JpcHRpb24nKS5tb2NrUmVzb2x2ZWRWYWx1ZShjdXJyZW50U3Vic2NyaXB0aW9uIGFzIGFueSk7XG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLnN1YnNjcmlwdGlvblBsYW4uZmluZFVuaXF1ZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKHByZW1pdW1QbGFuKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHVwZ3JhZGVkU3Vic2NyaXB0aW9uID0ge1xuICAgICAgICAgIC4uLmN1cnJlbnRTdWJzY3JpcHRpb24sXG4gICAgICAgICAgcGxhbklkOiAncHJlbWl1bS1wbGFuJyxcbiAgICAgICAgICAvLyB0aWVyOiAnUFJFTUlVTScsIC8vIFN1YnNjcmlwdGlvblRpZXIgcmVtb3ZlZFxuICAgICAgICAgIGFtb3VudDogMjkuOTksXG4gICAgICAgIH07XG5cbiAgICAgICAgKHByaXNtYVNlcnZpY2UuJHRyYW5zYWN0aW9uIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKGFzeW5jIChjYWxsYmFjaykgPT4ge1xuICAgICAgICAgIGNvbnN0IG1vY2tUeG4gPSB7XG4gICAgICAgICAgICBzdWJzY3JpcHRpb246IHtcbiAgICAgICAgICAgICAgdXBkYXRlOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUodXBncmFkZWRTdWJzY3JpcHRpb24pLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGludm9pY2U6IHtcbiAgICAgICAgICAgICAgY3JlYXRlOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAgICAgICAgIGlkOiAncHJvcmF0aW9uLWludm9pY2UnLFxuICAgICAgICAgICAgICAgIHRvdGFsOiAxNS4wMCxcbiAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaW52b2ljZUxpbmVJdGVtOiB7XG4gICAgICAgICAgICAgIGNyZWF0ZU1hbnk6IGplc3QuZm4oKSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfTtcbiAgICAgICAgICByZXR1cm4gY2FsbGJhY2sobW9ja1R4bik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuY2hhbmdlU3Vic2NyaXB0aW9uUGxhbihcbiAgICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgICAncHJlbWl1bS1wbGFuJyxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBiaWxsaW5nQ3ljbGU6IEJpbGxpbmdDeWNsZS5NT05USExZLFxuICAgICAgICAgICAgcHJvcmF0aW9uQmVoYXZpb3I6ICdjcmVhdGVfcHJvcmF0aW9ucycsXG4gICAgICAgICAgfVxuICAgICAgICApO1xuXG4gICAgICAgIC8vIGV4cGVjdChyZXN1bHQudGllcikudG9CZSgnUFJFTUlVTScpOyAvLyBTdWJzY3JpcHRpb25UaWVyIHJlbW92ZWRcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5hbW91bnQpLnRvQmUoMjkuOTkpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnRXJyb3IgUmVjb3ZlcnkgYW5kIFJlc2lsaWVuY2UnLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIGhhbmRsZSBwYXltZW50IGdhdGV3YXkgdGltZW91dHMgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgcGF5bWVudERhdGEgPSB7XG4gICAgICAgICAgYW1vdW50OiAyOS45OSxcbiAgICAgICAgICBwYXltZW50TWV0aG9kSWQ6ICdwYXltZW50LW1ldGhvZC1pZCcsXG4gICAgICAgICAgc3Vic2NyaXB0aW9uSWQ6ICdzdWJzY3JpcHRpb24taWQnLFxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IHRpbWVvdXRFcnJvciA9IG5ldyBFcnJvcignUGF5bWVudCBnYXRld2F5IHRpbWVvdXQnKTtcbiAgICAgICAgdGltZW91dEVycm9yLm5hbWUgPSAnVGltZW91dEVycm9yJztcbiAgICAgICAgXG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLnBheW1lbnQuY3JlYXRlIGFzIGplc3QuTW9jaykubW9ja1JlamVjdGVkVmFsdWUodGltZW91dEVycm9yKTtcblxuICAgICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgICAgc2VydmljZS5jcmVhdGVQYXltZW50KHBheW1lbnREYXRhKVxuICAgICAgICApLnJlamVjdHMudG9UaHJvdygnUGF5bWVudCBnYXRld2F5IHRpbWVvdXQnKTtcblxuICAgICAgICBleHBlY3QocHJpc21hU2VydmljZS5zdWJzY3JpcHRpb24udXBkYXRlKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbmN1cnJlbnQgc3Vic2NyaXB0aW9uIG1vZGlmaWNhdGlvbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHN1YnNjcmlwdGlvbiA9IHtcbiAgICAgICAgICBpZDogJ3N1YnNjcmlwdGlvbi1pZCcsXG4gICAgICAgICAgdXNlcklkOiBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgICB2ZXJzaW9uOiAxLFxuICAgICAgICB9O1xuXG4gICAgICAgIGplc3Quc3B5T24oc2VydmljZSwgJ2ZpbmRVc2VyU3Vic2NyaXB0aW9uJykubW9ja1Jlc29sdmVkVmFsdWUoc3Vic2NyaXB0aW9uIGFzIGFueSk7XG5cbiAgICAgICAgY29uc3QgY29uZmxpY3RFcnJvciA9IG5ldyBFcnJvcignU3Vic2NyaXB0aW9uIHdhcyBtb2RpZmllZCBieSBhbm90aGVyIHByb2Nlc3MnKTtcbiAgICAgICAgY29uZmxpY3RFcnJvci5uYW1lID0gJ0NvbmZsaWN0RXJyb3InO1xuICAgICAgICBcbiAgICAgICAgKHByaXNtYVNlcnZpY2Uuc3Vic2NyaXB0aW9uLnVwZGF0ZSBhcyBqZXN0Lk1vY2spLm1vY2tSZWplY3RlZFZhbHVlKGNvbmZsaWN0RXJyb3IpO1xuXG4gICAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgICBzZXJ2aWNlLnVwZGF0ZVN1YnNjcmlwdGlvbihURVNUX1VTRVJfSURTLkNMSUVOVCwge1xuICAgICAgICAgICAgcGxhbklkOiAnbmV3LXBsYW4taWQnLFxuICAgICAgICAgIH0pXG4gICAgICAgICkucmVqZWN0cy50b1Rocm93KCdTdWJzY3JpcHRpb24gd2FzIG1vZGlmaWVkIGJ5IGFub3RoZXIgcHJvY2VzcycpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgaGFuZGxlIGRhdGFiYXNlIHRyYW5zYWN0aW9uIHJvbGxiYWNrcycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgZGlzY291bnREYXRhID0ge1xuICAgICAgICAgIGNvZGU6ICdTQVZFMjAnLFxuICAgICAgICAgIHR5cGU6IERpc2NvdW50VHlwZS5QRVJDRU5UQUdFLFxuICAgICAgICAgIHBlcmNlbnRPZmY6IDIwLFxuICAgICAgICB9O1xuXG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLiR0cmFuc2FjdGlvbiBhcyBqZXN0Lk1vY2spLm1vY2tSZWplY3RlZFZhbHVlKFxuICAgICAgICAgIG5ldyBFcnJvcignRGF0YWJhc2UgdHJhbnNhY3Rpb24gZmFpbGVkJylcbiAgICAgICAgKTtcblxuICAgICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgICAgc2VydmljZS5yZWRlZW1EaXNjb3VudCgnZGlzY291bnQtaWQnLCBURVNUX1VTRVJfSURTLkNMSUVOVCwgMjApXG4gICAgICAgICkucmVqZWN0cy50b1Rocm93KCdEYXRhYmFzZSB0cmFuc2FjdGlvbiBmYWlsZWQnKTtcblxuICAgICAgICBleHBlY3QocHJpc21hU2VydmljZS5kaXNjb3VudFJlZGVtcHRpb24uY3JlYXRlKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnUGVyZm9ybWFuY2UgYW5kIFNjYWxhYmlsaXR5JywgKCkgPT4ge1xuICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgaGlnaC12b2x1bWUgYmlsbGluZyBvcGVyYXRpb25zIGVmZmljaWVudGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBvcGVyYXRpb25Db3VudCA9IDEwMDA7XG4gICAgICAgIGNvbnN0IGJhdGNoT3BlcmF0aW9ucyA9IEFycmF5LmZyb20oeyBsZW5ndGg6IG9wZXJhdGlvbkNvdW50IH0sIChfLCBpKSA9PiB7XG4gICAgICAgICAgaWYgKGkgJSAzID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gc2VydmljZS5yZWNvcmRVc2FnZSh7XG4gICAgICAgICAgICAgIHN1YnNjcmlwdGlvbklkOiBgc3Vic2NyaXB0aW9uLSR7aX1gLFxuICAgICAgICAgICAgICBmZWF0dXJlOiAnYXBpX2NhbGxzJyxcbiAgICAgICAgICAgICAgcXVhbnRpdHk6IDEwMCxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gZWxzZSBpZiAoaSAlIDMgPT09IDEpIHtcbiAgICAgICAgICAgIHJldHVybiBzZXJ2aWNlLmNyZWF0ZVBheW1lbnQoe1xuICAgICAgICAgICAgICBhbW91bnQ6IDI5Ljk5LFxuICAgICAgICAgICAgICBzdWJzY3JpcHRpb25JZDogYHN1YnNjcmlwdGlvbi0ke2l9YCxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gc2VydmljZS5nZXRCaWxsaW5nU3RhdGlzdGljcyhcbiAgICAgICAgICAgICAgbmV3IERhdGUoJzIwMjQtMDEtMDEnKSxcbiAgICAgICAgICAgICAgbmV3IERhdGUoJzIwMjQtMDEtMzEnKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLnVzYWdlUmVjb3JkLmNyZWF0ZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKHsgaWQ6ICd1c2FnZS1pZCcgfSk7XG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLnBheW1lbnQuY3JlYXRlIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoeyBpZDogJ3BheW1lbnQtaWQnIH0pO1xuICAgICAgICAocHJpc21hU2VydmljZS5wYXltZW50LmFnZ3JlZ2F0ZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKHsgX3N1bTogeyBhbW91bnQ6IDEwMDAgfSB9KTtcbiAgICAgICAgKHByaXNtYVNlcnZpY2Uuc3Vic2NyaXB0aW9uLmNvdW50IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoMTApO1xuICAgICAgICAocHJpc21hU2VydmljZS5zdWJzY3JpcHRpb24uZ3JvdXBCeSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKFtdKTtcblxuICAgICAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgUHJvbWlzZS5hbGwoYmF0Y2hPcGVyYXRpb25zKTtcbiAgICAgICAgY29uc3QgZW5kVGltZSA9IERhdGUubm93KCk7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdHMpLnRvSGF2ZUxlbmd0aChvcGVyYXRpb25Db3VudCk7XG4gICAgICAgIGV4cGVjdChlbmRUaW1lIC0gc3RhcnRUaW1lKS50b0JlTGVzc1RoYW4oNTAwMCk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBvcHRpbWl6ZSBtZW1vcnkgdXNhZ2UgZm9yIGxhcmdlIHJlc3VsdCBzZXRzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBsYXJnZVVzYWdlRGF0YXNldCA9IEFycmF5LmZyb20oeyBsZW5ndGg6IDUwMDAwIH0sIChfLCBpKSA9PiAoe1xuICAgICAgICAgIGlkOiBgdXNhZ2UtJHtpfWAsXG4gICAgICAgICAgZmVhdHVyZTogJ2FwaV9jYWxscycsXG4gICAgICAgICAgcXVhbnRpdHk6IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDApLFxuICAgICAgICAgIHVzYWdlRGF0ZTogbmV3IERhdGUoKSxcbiAgICAgICAgfSkpO1xuXG4gICAgICAgIChwcmlzbWFTZXJ2aWNlLnVzYWdlUmVjb3JkLmZpbmRNYW55IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUobGFyZ2VVc2FnZURhdGFzZXQpO1xuXG4gICAgICAgIGNvbnN0IGluaXRpYWxNZW1vcnkgPSBwcm9jZXNzLm1lbW9yeVVzYWdlKCkuaGVhcFVzZWQ7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuZ2V0VXNhZ2VSZWNvcmRzKFxuICAgICAgICAgICdzdWJzY3JpcHRpb24taWQnLFxuICAgICAgICAgICdhcGlfY2FsbHMnLFxuICAgICAgICAgIG5ldyBEYXRlKCcyMDI0LTAxLTAxJyksXG4gICAgICAgICAgbmV3IERhdGUoJzIwMjQtMDEtMzEnKVxuICAgICAgICApO1xuICAgICAgICBjb25zdCBmaW5hbE1lbW9yeSA9IHByb2Nlc3MubWVtb3J5VXNhZ2UoKS5oZWFwVXNlZDtcblxuICAgICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVMZW5ndGgoNTAwMDApO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgbWVtb3J5SW5jcmVhc2UgPSBmaW5hbE1lbW9yeSAtIGluaXRpYWxNZW1vcnk7XG4gICAgICAgIGV4cGVjdChtZW1vcnlJbmNyZWFzZSkudG9CZUxlc3NUaGFuKDIwMCAqIDEwMjQgKiAxMDI0KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ0RhdGEgQ29uc2lzdGVuY3kgYW5kIEludGVncml0eScsICgpID0+IHtcbiAgICAgIGl0KCdzaG91bGQgbWFpbnRhaW4gaW52b2ljZSBudW1iZXIgc2VxdWVuY2UgaW50ZWdyaXR5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBjb25jdXJyZW50SW52b2ljZUNyZWF0aW9ucyA9IEFycmF5LmZyb20oeyBsZW5ndGg6IDEwIH0sIChfLCBpKSA9PiB7XG4gICAgICAgICAgKHByaXNtYVNlcnZpY2UuaW52b2ljZS5maW5kRmlyc3QgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICAgICAgbnVtYmVyOiBgSU5WLTIwMjQtMDAwMDAke2l9YCxcbiAgICAgICAgICB9KTtcbiAgICAgICAgICAocHJpc21hU2VydmljZS5pbnZvaWNlLmNyZWF0ZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XG4gICAgICAgICAgICBpZDogYGludm9pY2UtJHtpfWAsXG4gICAgICAgICAgICBudW1iZXI6IGBJTlYtMjAyNC0wMDAwMCR7aSArIDF9YCxcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHJldHVybiBzZXJ2aWNlLmNyZWF0ZUludm9pY2Uoe1xuICAgICAgICAgICAgc3Vic2NyaXB0aW9uSWQ6IGBzdWJzY3JpcHRpb24tJHtpfWAsXG4gICAgICAgICAgICBzdWJ0b3RhbDogMTAwLFxuICAgICAgICAgICAgZHVlRGF0ZTogbmV3IERhdGUoKSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IFByb21pc2UuYWxsKGNvbmN1cnJlbnRJbnZvaWNlQ3JlYXRpb25zKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGludm9pY2VOdW1iZXJzID0gcmVzdWx0cy5tYXAoaW52b2ljZSA9PiBpbnZvaWNlLm51bWJlcik7XG4gICAgICAgIGNvbnN0IHVuaXF1ZU51bWJlcnMgPSBuZXcgU2V0KGludm9pY2VOdW1iZXJzKTtcbiAgICAgICAgZXhwZWN0KHVuaXF1ZU51bWJlcnMuc2l6ZSkudG9CZShpbnZvaWNlTnVtYmVycy5sZW5ndGgpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgZW5zdXJlIHN1YnNjcmlwdGlvbiBzdGF0ZSBjb25zaXN0ZW5jeSBkdXJpbmcgdHJhbnNpdGlvbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHN1YnNjcmlwdGlvbiA9IHtcbiAgICAgICAgICBpZDogJ3N1YnNjcmlwdGlvbi1pZCcsXG4gICAgICAgICAgdXNlcklkOiBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgICBzdGF0dXM6IFN1YnNjcmlwdGlvblN0YXR1cy5BQ1RJVkUsXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgdHJhbnNpdGlvbnMgPSBbXG4gICAgICAgICAgeyBmcm9tOiBTdWJzY3JpcHRpb25TdGF0dXMuQUNUSVZFLCB0bzogU3Vic2NyaXB0aW9uU3RhdHVzLlBBVVNFRCwgdmFsaWQ6IHRydWUgfSxcbiAgICAgICAgICB7IGZyb206IFN1YnNjcmlwdGlvblN0YXR1cy5QQVVTRUQsIHRvOiBTdWJzY3JpcHRpb25TdGF0dXMuQUNUSVZFLCB2YWxpZDogdHJ1ZSB9LFxuICAgICAgICAgIHsgZnJvbTogU3Vic2NyaXB0aW9uU3RhdHVzLkNBTkNFTEVELCB0bzogU3Vic2NyaXB0aW9uU3RhdHVzLkFDVElWRSwgdmFsaWQ6IHRydWUgfSxcbiAgICAgICAgICB7IGZyb206IFN1YnNjcmlwdGlvblN0YXR1cy5UUklBTElORywgdG86IFN1YnNjcmlwdGlvblN0YXR1cy5BQ1RJVkUsIHZhbGlkOiB0cnVlIH0sXG4gICAgICAgICAgeyBmcm9tOiBTdWJzY3JpcHRpb25TdGF0dXMuUEFTVF9EVUUsIHRvOiBTdWJzY3JpcHRpb25TdGF0dXMuQ0FOQ0VMRUQsIHZhbGlkOiB0cnVlIH0sXG4gICAgICAgIF07XG5cbiAgICAgICAgZm9yIChjb25zdCB0cmFuc2l0aW9uIG9mIHRyYW5zaXRpb25zKSB7XG4gICAgICAgICAgamVzdC5zcHlPbihzZXJ2aWNlLCAnZmluZFVzZXJTdWJzY3JpcHRpb24nKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgICAuLi5zdWJzY3JpcHRpb24sXG4gICAgICAgICAgICBzdGF0dXM6IHRyYW5zaXRpb24uZnJvbSxcbiAgICAgICAgICB9IGFzIGFueSk7XG5cbiAgICAgICAgICBpZiAodHJhbnNpdGlvbi52YWxpZCkge1xuICAgICAgICAgICAgamVzdC5zcHlPbihzZXJ2aWNlLCAndXBkYXRlU3Vic2NyaXB0aW9uJykubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAgICAgICAuLi5zdWJzY3JpcHRpb24sXG4gICAgICAgICAgICAgIHN0YXR1czogdHJhbnNpdGlvbi50byxcbiAgICAgICAgICAgIH0gYXMgYW55KTtcblxuICAgICAgICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICAgICAgICBzZXJ2aWNlLnVwZGF0ZVN1YnNjcmlwdGlvbihURVNUX1VTRVJfSURTLkNMSUVOVCwge1xuICAgICAgICAgICAgICAgIHN0YXR1czogdHJhbnNpdGlvbi50byxcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICkucmVzb2x2ZXMudG9CZURlZmluZWQoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl0sInZlcnNpb24iOjN9