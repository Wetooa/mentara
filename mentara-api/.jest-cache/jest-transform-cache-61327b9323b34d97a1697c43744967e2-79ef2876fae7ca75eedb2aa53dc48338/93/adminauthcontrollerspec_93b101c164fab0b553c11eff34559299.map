{"file":"/home/wetooa/Documents/code/projects/mentara/mentara-api/src/auth/controllers/admin-auth.controller.spec.ts","mappings":"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","names":[],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/auth/controllers/admin-auth.controller.spec.ts"],"sourcesContent":["import { Test, TestingModule } from '@nestjs/testing';\nimport { ForbiddenException, UnauthorizedException } from '@nestjs/common';\nimport { ThrottlerGuard, ThrottlerModule } from '@nestjs/throttler';\nimport { AdminAuthController } from './admin-auth.controller';\nimport { AdminAuthService } from '../services/admin-auth.service';\nimport { JwtAuthGuard } from '../guards/jwt-auth.guard';\nimport { ZodValidationPipe } from '../../common/pipes/zod-validation.pipe';\nimport {\n  MockBuilder,\n  TestDataGenerator,\n  TestAssertions,\n  SecurityGuardTestUtils,\n  RoleBasedTestUtils,\n  TEST_USER_IDS,\n  TEST_EMAILS,\n} from '../../test-utils/auth-testing-helpers';\nimport { createMockPrismaService } from '../../test-utils';\n\ndescribe('AdminAuthController', () => {\n  let controller: AdminAuthController;\n  let adminAuthService: AdminAuthService;\n  let mockJwtAuthGuard: jest.Mocked<JwtAuthGuard>;\n\n  // Test data constants\n  const mockAdminUser = {\n    id: TEST_USER_IDS.ADMIN,\n    email: TEST_EMAILS.ADMIN,\n    firstName: 'Admin',\n    lastName: 'User',\n    role: 'admin',\n    emailVerified: true,\n    adminLevel: 'admin',\n    permissions: ['read', 'write', 'delete'],\n    createdAt: new Date(),\n    lastLoginAt: new Date(),\n  };\n\n  const mockSuperAdminUser = {\n    ...mockAdminUser,\n    id: 'super-admin-123',\n    email: 'super@mentara.com',\n    adminLevel: 'super_admin',\n    permissions: ['read', 'write', 'delete', 'create_admins'],\n  };\n\n  const mockTokens = {\n    accessToken: 'mock-access-token',\n    refreshToken: 'mock-refresh-token',\n    expiresIn: 3600,\n  };\n\n  const mockDashboardStats = {\n    totalUsers: 1000,\n    totalTherapists: 100,\n    totalAdmins: 5,\n    activeUsers: 750,\n    pendingApplications: 25,\n    systemHealth: 'healthy',\n    lastUpdated: new Date(),\n  };\n\n  beforeEach(async () => {\n    // Create mock services\n    const mockAdminAuthService = {\n      createAdminAccount: jest.fn(),\n      loginAdmin: jest.fn(),\n      getAdminProfile: jest.fn(),\n      getAdminPermissions: jest.fn(),\n      getAdminDashboardStats: jest.fn(),\n    };\n\n    mockJwtAuthGuard = {\n      canActivate: jest.fn().mockReturnValue(true),\n    } as any;\n\n    const module: TestingModule = await Test.createTestingModule({\n      imports: [\n        ThrottlerModule.forRoot([\n          {\n            name: 'short',\n            ttl: 1000,\n            limit: 3,\n          },\n        ]),\n      ],\n      controllers: [AdminAuthController],\n      providers: [\n        {\n          provide: AdminAuthService,\n          useValue: mockAdminAuthService,\n        },\n      ],\n    })\n      .overrideGuard(JwtAuthGuard)\n      .useValue(mockJwtAuthGuard)\n      .overrideGuard(ThrottlerGuard)\n      .useValue({ canActivate: jest.fn().mockReturnValue(true) })\n      .compile();\n\n    controller = module.get<AdminAuthController>(AdminAuthController);\n    adminAuthService = module.get<AdminAuthService>(AdminAuthService);\n  });\n\n  afterEach(() => {\n    jest.clearAllMocks();\n  });\n\n  describe('createAdminAccount', () => {\n    const validRegisterDto = {\n      email: 'newadmin@mentara.com',\n      password: 'SecurePass123!',\n      firstName: 'New',\n      lastName: 'Admin',\n      adminLevel: 'admin' as const,\n      permissions: ['read', 'write'] as string[],\n    };\n\n    it('should create admin account successfully when called by admin', async () => {\n      // Arrange\n      const mockCreatedUser = {\n        user: mockAdminUser,\n        message: 'Admin account created successfully',\n      };\n\n      jest.spyOn(adminAuthService, 'createAdminAccount').mockResolvedValue(mockCreatedUser);\n\n      // Act\n      const result = await controller.createAdminAccount('admin', validRegisterDto);\n\n      // Assert\n      expect(adminAuthService.createAdminAccount).toHaveBeenCalledWith(\n        validRegisterDto.email,\n        validRegisterDto.password,\n        validRegisterDto.firstName,\n        validRegisterDto.lastName,\n        validRegisterDto.adminLevel,\n        validRegisterDto.permissions,\n      );\n\n      expect(result).toEqual({\n        user: {\n          id: mockAdminUser.id,\n          email: mockAdminUser.email,\n          firstName: mockAdminUser.firstName,\n          lastName: mockAdminUser.lastName,\n          role: mockAdminUser.role,\n          emailVerified: mockAdminUser.emailVerified,\n        },\n        message: mockCreatedUser.message,\n      });\n    });\n\n    it('should throw ForbiddenException when called by non-admin', async () => {\n      // Arrange & Act & Assert\n      await TestAssertions.expectToThrowNestException(\n        () => controller.createAdminAccount('client', validRegisterDto),\n        ForbiddenException,\n        'Only admins can create admin accounts',\n      );\n\n      expect(adminAuthService.createAdminAccount).not.toHaveBeenCalled();\n    });\n\n    it('should use default values when optional fields are not provided', async () => {\n      // Arrange\n      const minimalRegisterDto = {\n        email: 'newadmin@mentara.com',\n        password: 'SecurePass123!',\n        firstName: 'New',\n        lastName: 'Admin',\n      };\n\n      const mockCreatedUser = {\n        user: mockAdminUser,\n        message: 'Admin account created successfully',\n      };\n\n      jest.spyOn(adminAuthService, 'createAdminAccount').mockResolvedValue(mockCreatedUser);\n\n      // Act\n      await controller.createAdminAccount('admin', minimalRegisterDto);\n\n      // Assert\n      expect(adminAuthService.createAdminAccount).toHaveBeenCalledWith(\n        minimalRegisterDto.email,\n        minimalRegisterDto.password,\n        minimalRegisterDto.firstName,\n        minimalRegisterDto.lastName,\n        'admin', // Default adminLevel\n        [], // Default permissions\n      );\n    });\n\n    it('should handle service errors appropriately', async () => {\n      // Arrange\n      const serviceError = new Error('Email already exists');\n      jest.spyOn(adminAuthService, 'createAdminAccount').mockRejectedValue(serviceError);\n\n      // Act & Assert\n      await expect(controller.createAdminAccount('admin', validRegisterDto)).rejects.toThrow(serviceError);\n    });\n  });\n\n  describe('login', () => {\n    const validLoginDto = {\n      email: TEST_EMAILS.ADMIN,\n      password: 'SecurePass123!',\n    };\n\n    const mockRequest = {\n      ip: '192.168.1.1',\n      get: jest.fn().mockReturnValue('Test User Agent'),\n    } as any;\n\n    it('should login admin successfully with valid credentials', async () => {\n      // Arrange\n      const mockLoginResult = {\n        user: mockAdminUser,\n        tokens: mockTokens,\n      };\n\n      jest.spyOn(adminAuthService, 'loginAdmin').mockResolvedValue(mockLoginResult);\n\n      // Act\n      const result = await controller.login(validLoginDto, mockRequest);\n\n      // Assert\n      expect(adminAuthService.loginAdmin).toHaveBeenCalledWith(\n        validLoginDto.email,\n        validLoginDto.password,\n        mockRequest.ip,\n        'Test User Agent',\n      );\n\n      expect(result).toEqual({\n        user: {\n          id: mockAdminUser.id,\n          email: mockAdminUser.email,\n          firstName: mockAdminUser.firstName,\n          lastName: mockAdminUser.lastName,\n          role: mockAdminUser.role,\n          emailVerified: mockAdminUser.emailVerified,\n        },\n        accessToken: mockTokens.accessToken,\n        refreshToken: mockTokens.refreshToken,\n        expiresIn: mockTokens.expiresIn,\n      });\n    });\n\n    it('should handle missing User-Agent header', async () => {\n      // Arrange\n      const mockRequestWithoutUserAgent = {\n        ip: '192.168.1.1',\n        get: jest.fn().mockReturnValue(undefined),\n      } as any;\n\n      const mockLoginResult = {\n        user: mockAdminUser,\n        tokens: mockTokens,\n      };\n\n      jest.spyOn(adminAuthService, 'loginAdmin').mockResolvedValue(mockLoginResult);\n\n      // Act\n      await controller.login(validLoginDto, mockRequestWithoutUserAgent);\n\n      // Assert\n      expect(adminAuthService.loginAdmin).toHaveBeenCalledWith(\n        validLoginDto.email,\n        validLoginDto.password,\n        mockRequestWithoutUserAgent.ip,\n        undefined,\n      );\n    });\n\n    it('should handle invalid credentials', async () => {\n      // Arrange\n      const authError = new UnauthorizedException('Invalid credentials');\n      jest.spyOn(adminAuthService, 'loginAdmin').mockRejectedValue(authError);\n\n      // Act & Assert\n      await expect(controller.login(validLoginDto, mockRequest)).rejects.toThrow(authError);\n    });\n\n    it('should handle service errors', async () => {\n      // Arrange\n      const serviceError = new Error('Database connection failed');\n      jest.spyOn(adminAuthService, 'loginAdmin').mockRejectedValue(serviceError);\n\n      // Act & Assert\n      await expect(controller.login(validLoginDto, mockRequest)).rejects.toThrow(serviceError);\n    });\n  });\n\n  describe('getProfile', () => {\n    it('should return admin profile successfully', async () => {\n      // Arrange\n      jest.spyOn(adminAuthService, 'getAdminProfile').mockResolvedValue(mockAdminUser);\n\n      // Act\n      const result = await controller.getProfile(TEST_USER_IDS.ADMIN);\n\n      // Assert\n      expect(adminAuthService.getAdminProfile).toHaveBeenCalledWith(TEST_USER_IDS.ADMIN);\n      expect(result).toEqual(mockAdminUser);\n    });\n\n    it('should handle profile not found', async () => {\n      // Arrange\n      const notFoundError = new Error('Admin profile not found');\n      jest.spyOn(adminAuthService, 'getAdminProfile').mockRejectedValue(notFoundError);\n\n      // Act & Assert\n      await expect(controller.getProfile(TEST_USER_IDS.ADMIN)).rejects.toThrow(notFoundError);\n    });\n  });\n\n  describe('getPermissions', () => {\n    const mockPermissions = {\n      permissions: ['read', 'write', 'delete'],\n      adminLevel: 'admin',\n      canCreateAdmins: true,\n      canModifyUsers: true,\n      canAccessAnalytics: true,\n    };\n\n    it('should return admin permissions successfully', async () => {\n      // Arrange\n      jest.spyOn(adminAuthService, 'getAdminPermissions').mockResolvedValue(mockPermissions);\n\n      // Act\n      const result = await controller.getPermissions(TEST_USER_IDS.ADMIN);\n\n      // Assert\n      expect(adminAuthService.getAdminPermissions).toHaveBeenCalledWith(TEST_USER_IDS.ADMIN);\n      expect(result).toEqual(mockPermissions);\n    });\n\n    it('should handle permissions not found', async () => {\n      // Arrange\n      const notFoundError = new Error('Admin permissions not found');\n      jest.spyOn(adminAuthService, 'getAdminPermissions').mockRejectedValue(notFoundError);\n\n      // Act & Assert\n      await expect(controller.getPermissions(TEST_USER_IDS.ADMIN)).rejects.toThrow(notFoundError);\n    });\n  });\n\n  describe('getDashboardStats', () => {\n    it('should return dashboard statistics successfully', async () => {\n      // Arrange\n      jest.spyOn(adminAuthService, 'getAdminDashboardStats').mockResolvedValue(mockDashboardStats);\n\n      // Act\n      const result = await controller.getDashboardStats(TEST_USER_IDS.ADMIN);\n\n      // Assert\n      expect(adminAuthService.getAdminDashboardStats).toHaveBeenCalledWith(TEST_USER_IDS.ADMIN);\n      expect(result).toEqual(mockDashboardStats);\n    });\n\n    it('should handle dashboard stats error', async () => {\n      // Arrange\n      const statsError = new Error('Unable to fetch dashboard statistics');\n      jest.spyOn(adminAuthService, 'getAdminDashboardStats').mockRejectedValue(statsError);\n\n      // Act & Assert\n      await expect(controller.getDashboardStats(TEST_USER_IDS.ADMIN)).rejects.toThrow(statsError);\n    });\n  });\n\n  describe('Role-based Access Control', () => {\n    it('should test role-based access for protected endpoints', async () => {\n      // Test that different roles can access appropriate endpoints\n      await RoleBasedTestUtils.testWithRoles(\n        async (userId: string, role: string) => {\n          // Mock the auth guard to return the specific role\n          mockJwtAuthGuard.canActivate.mockReturnValue(role === 'admin');\n          \n          try {\n            await controller.getProfile(userId);\n            return true;\n          } catch (error) {\n            return false;\n          }\n        },\n        {\n          admin: true,\n          client: false,\n          therapist: false,\n          moderator: false,\n        },\n      );\n    });\n  });\n\n  describe('Security Tests', () => {\n    it('should validate input data through ZodValidationPipe', () => {\n      // This tests that the controller uses proper validation\n      const validationPipe = new ZodValidationPipe({} as any);\n      expect(validationPipe).toBeDefined();\n    });\n\n    it('should apply rate limiting through ThrottlerGuard', () => {\n      // Test that throttling is configured\n      const createAccountMetadata = Reflect.getMetadata('__throttler_options__', controller.createAdminAccount);\n      const loginMetadata = Reflect.getMetadata('__throttler_options__', controller.login);\n      \n      expect(createAccountMetadata).toBeDefined();\n      expect(loginMetadata).toBeDefined();\n    });\n\n    it('should require authentication for protected endpoints', () => {\n      // Test that protected endpoints have JwtAuthGuard\n      const protectedMethods = ['createAdminAccount', 'getProfile', 'getPermissions', 'getDashboardStats'];\n      \n      protectedMethods.forEach(method => {\n        const guards = Reflect.getMetadata('__guards__', controller[method as keyof AdminAuthController]);\n        expect(guards).toBeDefined();\n      });\n    });\n\n    it('should allow public access to login endpoint', () => {\n      // Test that login endpoint is marked as public\n      const publicMetadata = Reflect.getMetadata('isPublic', controller.login);\n      expect(publicMetadata).toBeTruthy();\n    });\n  });\n\n  describe('Error Handling', () => {\n    it('should handle network errors gracefully', async () => {\n      // Arrange\n      const networkError = new Error('Network timeout');\n      jest.spyOn(adminAuthService, 'getAdminProfile').mockRejectedValue(networkError);\n\n      // Act & Assert\n      await expect(controller.getProfile(TEST_USER_IDS.ADMIN)).rejects.toThrow(networkError);\n    });\n\n    it('should handle validation errors', async () => {\n      // This would be handled by the ZodValidationPipe\n      const invalidData = {\n        email: 'invalid-email',\n        password: '123', // Too short\n        firstName: '',\n        lastName: '',\n      };\n\n      // In a real scenario, this would throw a validation error\n      // The pipe would catch this before it reaches the controller\n    });\n  });\n\n  describe('Integration Tests', () => {\n    it('should handle complete admin creation workflow', async () => {\n      // Arrange\n      const mockCreatedUser = {\n        user: mockAdminUser,\n        message: 'Admin account created successfully',\n      };\n\n      jest.spyOn(adminAuthService, 'createAdminAccount').mockResolvedValue(mockCreatedUser);\n\n      // Act\n      const result = await controller.createAdminAccount('admin', {\n        email: 'newadmin@mentara.com',\n        password: 'SecurePass123!',\n        firstName: 'New',\n        lastName: 'Admin',\n        adminLevel: 'admin',\n        permissions: ['read', 'write'],\n      });\n\n      // Assert\n      expect(result).toBeDefined();\n      expect(result.user.email).toBe(mockAdminUser.email);\n      expect(result.message).toBe('Admin account created successfully');\n    });\n\n    it('should handle complete login workflow', async () => {\n      // Arrange\n      const mockLoginResult = {\n        user: mockAdminUser,\n        tokens: mockTokens,\n      };\n\n      jest.spyOn(adminAuthService, 'loginAdmin').mockResolvedValue(mockLoginResult);\n\n      // Act\n      const result = await controller.login(\n        {\n          email: TEST_EMAILS.ADMIN,\n          password: 'SecurePass123!',\n        },\n        {\n          ip: '192.168.1.1',\n          get: jest.fn().mockReturnValue('Test User Agent'),\n        } as any,\n      );\n\n      // Assert\n      expect(result).toBeDefined();\n      expect(result.user.email).toBe(mockAdminUser.email);\n      expect(result.accessToken).toBe(mockTokens.accessToken);\n      expect(result.refreshToken).toBe(mockTokens.refreshToken);\n      expect(result.expiresIn).toBe(mockTokens.expiresIn);\n    });\n  });\n});"],"version":3}