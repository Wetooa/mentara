8cd3019867ef4c36b415286e83fdd416
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const common_1 = require("@nestjs/common");
const throttler_1 = require("@nestjs/throttler");
const therapist_auth_controller_1 = require("./therapist-auth.controller");
const therapist_auth_service_1 = require("../../services/auth/therapist-auth.service");
const jwt_auth_guard_1 = require("../guards/jwt-auth.guard");
const supabase_storage_service_1 = require("../../common/services/supabase-storage.service");
const zod_validation_pipe_1 = require("../../common/pipes/zod-validation.pipe");
const auth_testing_helpers_1 = require("../../test-utils/auth-testing-helpers");
describe('TherapistAuthController', () => {
    let controller;
    let therapistAuthService;
    let supabaseStorageService;
    let mockJwtAuthGuard;
    // Test data constants
    const mockTherapistUser = {
        id: auth_testing_helpers_1.TEST_USER_IDS.THERAPIST,
        email: auth_testing_helpers_1.TEST_EMAILS.THERAPIST,
        firstName: 'Dr. Jane',
        lastName: 'Smith',
        role: 'therapist',
        emailVerified: false,
        licenseNumber: 'LIC123456',
        specializations: ['anxiety', 'depression'],
        approvalStatus: 'pending',
        profileComplete: true,
        createdAt: new Date(),
    };
    const mockTokens = {
        accessToken: 'mock-access-token',
        refreshToken: 'mock-refresh-token',
        expiresIn: 3600,
    };
    const mockRegistrationResult = {
        user: mockTherapistUser,
        tokens: mockTokens,
        message: 'Therapist account created successfully',
    };
    const mockLoginResult = {
        user: mockTherapistUser,
        tokens: mockTokens,
    };
    const mockTherapistApplication = {
        id: 'app-123',
        email: auth_testing_helpers_1.TEST_EMAILS.THERAPIST,
        firstName: 'Dr. Jane',
        lastName: 'Smith',
        licenseNumber: 'LIC123456',
        specializations: ['anxiety', 'depression'],
        education: 'PhD in Psychology',
        experience: '5 years',
        status: 'pending',
        submittedAt: new Date(),
        reviewedAt: null,
        notes: null,
        reviewerComments: null,
    };
    const mockApplicationFiles = [
        {
            id: 'file-123',
            fileName: 'license.pdf',
            fileUrl: 'https://example.com/license.pdf',
            uploadedAt: new Date().toISOString(),
        },
        {
            id: 'file-456',
            fileName: 'diploma.pdf',
            fileUrl: 'https://example.com/diploma.pdf',
            uploadedAt: new Date().toISOString(),
        },
    ];
    const mockFiles = [
        {
            fieldname: 'files',
            originalname: 'license.pdf',
            encoding: '7bit',
            mimetype: 'application/pdf',
            size: 1024,
            buffer: Buffer.from('test license content'),
        },
        {
            fieldname: 'files',
            originalname: 'diploma.pdf',
            encoding: '7bit',
            mimetype: 'application/pdf',
            size: 2048,
            buffer: Buffer.from('test diploma content'),
        },
    ];
    const mockApplicationData = {
        email: auth_testing_helpers_1.TEST_EMAILS.THERAPIST,
        firstName: 'Dr. Jane',
        lastName: 'Smith',
        licenseNumber: 'LIC123456',
        specializations: ['anxiety', 'depression'],
        education: 'PhD in Psychology',
        experience: '5 years',
    };
    beforeEach(async () => {
        // Create mock services
        const mockTherapistAuthService = {
            registerTherapist: jest.fn(),
            loginTherapist: jest.fn(),
            getTherapistProfile: jest.fn(),
            createApplicationWithDocuments: jest.fn(),
            getAllApplications: jest.fn(),
            getApplicationById: jest.fn(),
            updateApplicationStatus: jest.fn(),
            getApplicationFiles: jest.fn(),
        };
        const mockSupabaseStorageService = {
            validateFile: jest.fn(),
            uploadFiles: jest.fn(),
            getSupportedBuckets: jest.fn(),
        };
        mockJwtAuthGuard = {
            canActivate: jest.fn().mockReturnValue(true),
        };
        const module = await testing_1.Test.createTestingModule({
            imports: [
                throttler_1.ThrottlerModule.forRoot([
                    {
                        name: 'short',
                        ttl: 1000,
                        limit: 3,
                    },
                ]),
            ],
            controllers: [therapist_auth_controller_1.TherapistAuthController],
            providers: [
                {
                    provide: therapist_auth_service_1.TherapistAuthService,
                    useValue: mockTherapistAuthService,
                },
                {
                    provide: supabase_storage_service_1.SupabaseStorageService,
                    useValue: mockSupabaseStorageService,
                },
            ],
        })
            .overrideGuard(jwt_auth_guard_1.JwtAuthGuard)
            .useValue(mockJwtAuthGuard)
            .overrideGuard(throttler_1.ThrottlerGuard)
            .useValue({ canActivate: jest.fn().mockReturnValue(true) })
            .compile();
        controller = module.get(therapist_auth_controller_1.TherapistAuthController);
        therapistAuthService = module.get(therapist_auth_service_1.TherapistAuthService);
        supabaseStorageService = module.get(supabase_storage_service_1.SupabaseStorageService);
    });
    afterEach(() => {
        jest.clearAllMocks();
    });
    describe('register', () => {
        const validRegisterDto = {
            email: 'newtherapist@example.com',
            password: 'SecurePass123!',
            firstName: 'Dr. Sarah',
            lastName: 'Johnson',
        };
        it('should register therapist successfully', async () => {
            // Arrange
            jest.spyOn(therapistAuthService, 'registerTherapist').mockResolvedValue(mockRegistrationResult);
            // Act
            const result = await controller.register(validRegisterDto);
            // Assert
            expect(therapistAuthService.registerTherapist).toHaveBeenCalledWith(validRegisterDto.email, validRegisterDto.password, validRegisterDto.firstName, validRegisterDto.lastName);
            expect(result).toEqual({
                user: {
                    id: mockTherapistUser.id,
                    email: mockTherapistUser.email,
                    firstName: mockTherapistUser.firstName,
                    lastName: mockTherapistUser.lastName,
                    role: mockTherapistUser.role,
                    emailVerified: mockTherapistUser.emailVerified,
                },
                accessToken: mockTokens.accessToken,
                refreshToken: mockTokens.refreshToken,
                expiresIn: mockTokens.expiresIn,
                message: mockRegistrationResult.message,
            });
        });
        it('should handle email already exists error', async () => {
            // Arrange
            const error = new common_1.BadRequestException('Email already exists');
            jest.spyOn(therapistAuthService, 'registerTherapist').mockRejectedValue(error);
            // Act & Assert
            await expect(controller.register(validRegisterDto)).rejects.toThrow(common_1.BadRequestException);
        });
        it('should handle service errors', async () => {
            // Arrange
            const error = new Error('Database error');
            jest.spyOn(therapistAuthService, 'registerTherapist').mockRejectedValue(error);
            // Act & Assert
            await expect(controller.register(validRegisterDto)).rejects.toThrow(error);
        });
    });
    describe('login', () => {
        const validLoginDto = {
            email: auth_testing_helpers_1.TEST_EMAILS.THERAPIST,
            password: 'SecurePass123!',
        };
        const mockRequest = {
            ip: '192.168.1.1',
            get: jest.fn().mockReturnValue('Test User Agent'),
        };
        it('should login therapist successfully with valid credentials', async () => {
            // Arrange
            jest.spyOn(therapistAuthService, 'loginTherapist').mockResolvedValue(mockLoginResult);
            // Act
            const result = await controller.login(validLoginDto, mockRequest);
            // Assert
            expect(therapistAuthService.loginTherapist).toHaveBeenCalledWith(validLoginDto.email, validLoginDto.password, mockRequest.ip, 'Test User Agent');
            expect(result).toEqual({
                user: {
                    id: mockTherapistUser.id,
                    email: mockTherapistUser.email,
                    firstName: mockTherapistUser.firstName,
                    lastName: mockTherapistUser.lastName,
                    role: mockTherapistUser.role,
                    emailVerified: mockTherapistUser.emailVerified,
                },
                accessToken: mockTokens.accessToken,
                refreshToken: mockTokens.refreshToken,
                expiresIn: mockTokens.expiresIn,
            });
        });
        it('should handle missing User-Agent header', async () => {
            // Arrange
            const mockRequestWithoutUserAgent = {
                ip: '192.168.1.1',
                get: jest.fn().mockReturnValue(undefined),
            };
            jest.spyOn(therapistAuthService, 'loginTherapist').mockResolvedValue(mockLoginResult);
            // Act
            await controller.login(validLoginDto, mockRequestWithoutUserAgent);
            // Assert
            expect(therapistAuthService.loginTherapist).toHaveBeenCalledWith(validLoginDto.email, validLoginDto.password, mockRequestWithoutUserAgent.ip, undefined);
        });
        it('should handle invalid credentials', async () => {
            // Arrange
            const authError = new common_1.UnauthorizedException('Invalid credentials');
            jest.spyOn(therapistAuthService, 'loginTherapist').mockRejectedValue(authError);
            // Act & Assert
            await expect(controller.login(validLoginDto, mockRequest)).rejects.toThrow(authError);
        });
        it('should handle service errors', async () => {
            // Arrange
            const serviceError = new Error('Database connection failed');
            jest.spyOn(therapistAuthService, 'loginTherapist').mockRejectedValue(serviceError);
            // Act & Assert
            await expect(controller.login(validLoginDto, mockRequest)).rejects.toThrow(serviceError);
        });
    });
    describe('getProfile', () => {
        it('should return therapist profile successfully', async () => {
            // Arrange
            jest.spyOn(therapistAuthService, 'getTherapistProfile').mockResolvedValue(mockTherapistUser);
            // Act
            const result = await controller.getProfile(auth_testing_helpers_1.TEST_USER_IDS.THERAPIST);
            // Assert
            expect(therapistAuthService.getTherapistProfile).toHaveBeenCalledWith(auth_testing_helpers_1.TEST_USER_IDS.THERAPIST);
            expect(result).toEqual(mockTherapistUser);
        });
        it('should handle profile not found', async () => {
            // Arrange
            const notFoundError = new Error('Therapist profile not found');
            jest.spyOn(therapistAuthService, 'getTherapistProfile').mockRejectedValue(notFoundError);
            // Act & Assert
            await expect(controller.getProfile(auth_testing_helpers_1.TEST_USER_IDS.THERAPIST)).rejects.toThrow(notFoundError);
        });
    });
    // TODO: Update tests for unified register method instead of removed applyWithDocuments
    describe.skip('applyWithDocuments', () => {
        const validApplicationDataJson = JSON.stringify(mockApplicationData);
        const validFileTypes = JSON.stringify({ '0': 'license', '1': 'diploma' });
        const mockApplicationResult = {
            application: { userId: 'temp_12345_therapist_at_example.com' },
            uploadedFiles: [
                { id: 'file-123', fileName: 'license.pdf', url: 'https://example.com/license.pdf' },
                { id: 'file-456', fileName: 'diploma.pdf', url: 'https://example.com/diploma.pdf' },
            ],
        };
        it('should submit application with documents successfully', async () => {
            // Arrange
            jest.spyOn(therapistAuthService, 'createApplicationWithDocuments').mockResolvedValue(mockApplicationResult);
            // Act
            const result = await controller.applyWithDocuments(validApplicationDataJson, validFileTypes, mockFiles);
            // Assert
            expect(therapistAuthService.createApplicationWithDocuments).toHaveBeenCalledWith(expect.objectContaining({
                ...mockApplicationData,
                userId: expect.stringContaining('temp_'),
            }), mockFiles, { '0': 'license', '1': 'diploma' });
            expect(result).toEqual({
                success: true,
                message: 'Application submitted successfully with documents',
                applicationId: mockApplicationResult.application.userId,
                uploadedFiles: mockApplicationResult.uploadedFiles,
            });
        });
        it('should submit application without files', async () => {
            // Arrange
            jest.spyOn(therapistAuthService, 'createApplicationWithDocuments').mockResolvedValue(mockApplicationResult);
            // Act
            const result = await controller.applyWithDocuments(validApplicationDataJson, validFileTypes, []);
            // Assert
            expect(therapistAuthService.createApplicationWithDocuments).toHaveBeenCalledWith(expect.objectContaining(mockApplicationData), [], { '0': 'license', '1': 'diploma' });
            expect(result.success).toBe(true);
        });
        it('should handle missing application data', async () => {
            // Act & Assert
            await expect(controller.applyWithDocuments('', validFileTypes, mockFiles)).rejects.toThrow(common_1.BadRequestException);
        });
        it('should handle invalid JSON format', async () => {
            // Act & Assert
            await expect(controller.applyWithDocuments('invalid json', validFileTypes, mockFiles)).rejects.toThrow(common_1.BadRequestException);
        });
        it('should handle email already exists error', async () => {
            // Arrange
            const error = new Error('email already exists');
            jest.spyOn(therapistAuthService, 'createApplicationWithDocuments').mockRejectedValue(error);
            // Act & Assert
            await expect(controller.applyWithDocuments(validApplicationDataJson, validFileTypes, mockFiles)).rejects.toThrow(common_1.BadRequestException);
        });
        it('should handle file upload errors', async () => {
            // Arrange
            const error = new Error('file upload failed');
            jest.spyOn(therapistAuthService, 'createApplicationWithDocuments').mockRejectedValue(error);
            // Act & Assert
            await expect(controller.applyWithDocuments(validApplicationDataJson, validFileTypes, mockFiles)).rejects.toThrow(common_1.BadRequestException);
        });
        it('should handle validation errors', async () => {
            // Arrange
            const error = new Error('validation failed');
            jest.spyOn(therapistAuthService, 'createApplicationWithDocuments').mockRejectedValue(error);
            // Act & Assert
            await expect(controller.applyWithDocuments(validApplicationDataJson, validFileTypes, mockFiles)).rejects.toThrow(common_1.BadRequestException);
        });
        it('should handle service errors', async () => {
            // Arrange
            const error = new Error('Unknown database error');
            jest.spyOn(therapistAuthService, 'createApplicationWithDocuments').mockRejectedValue(error);
            // Act & Assert
            await expect(controller.applyWithDocuments(validApplicationDataJson, validFileTypes, mockFiles)).rejects.toThrow(common_1.InternalServerErrorException);
        });
        it('should handle invalid file types JSON', async () => {
            // Arrange
            jest.spyOn(therapistAuthService, 'createApplicationWithDocuments').mockResolvedValue(mockApplicationResult);
            // Act
            const result = await controller.applyWithDocuments(validApplicationDataJson, 'invalid json', mockFiles);
            // Assert
            expect(therapistAuthService.createApplicationWithDocuments).toHaveBeenCalledWith(expect.objectContaining(mockApplicationData), mockFiles, {});
            expect(result.success).toBe(true);
        });
    });
    describe('getAllApplications', () => {
        const mockApplicationsResult = {
            applications: [mockTherapistApplication],
            totalCount: 1,
            page: 1,
            totalPages: 1,
        };
        it('should return all applications for admin user', async () => {
            // Arrange
            jest.spyOn(therapistAuthService, 'getAllApplications').mockResolvedValue(mockApplicationsResult);
            // Act
            const result = await controller.getAllApplications('admin');
            // Assert
            expect(therapistAuthService.getAllApplications).toHaveBeenCalledWith({
                status: undefined,
                page: 1,
                limit: 10,
            });
            expect(result).toEqual(mockApplicationsResult);
        });
        it('should return applications with custom filters', async () => {
            // Arrange
            jest.spyOn(therapistAuthService, 'getAllApplications').mockResolvedValue(mockApplicationsResult);
            // Act
            const result = await controller.getAllApplications('admin', 'pending', 2, 20);
            // Assert
            expect(therapistAuthService.getAllApplications).toHaveBeenCalledWith({
                status: 'pending',
                page: 2,
                limit: 20,
            });
            expect(result).toEqual(mockApplicationsResult);
        });
        it('should handle pagination bounds', async () => {
            // Arrange
            jest.spyOn(therapistAuthService, 'getAllApplications').mockResolvedValue(mockApplicationsResult);
            // Act
            await controller.getAllApplications('admin', undefined, 0, 200);
            // Assert
            expect(therapistAuthService.getAllApplications).toHaveBeenCalledWith({
                status: undefined,
                page: 1, // Clamped to minimum 1
                limit: 100, // Clamped to maximum 100
            });
        });
        it('should throw ForbiddenException for non-admin users', async () => {
            // Act & Assert
            await expect(controller.getAllApplications('client')).rejects.toThrow(common_1.ForbiddenException);
        });
        it('should handle service errors', async () => {
            // Arrange
            const error = new Error('Database error');
            jest.spyOn(therapistAuthService, 'getAllApplications').mockRejectedValue(error);
            // Act & Assert
            await expect(controller.getAllApplications('admin')).rejects.toThrow(common_1.InternalServerErrorException);
        });
    });
    describe('getApplicationById', () => {
        it('should return application by ID for admin user', async () => {
            // Arrange
            jest.spyOn(therapistAuthService, 'getApplicationById').mockResolvedValue(mockTherapistApplication);
            // Act
            const result = await controller.getApplicationById('admin', 'app-123');
            // Assert
            expect(therapistAuthService.getApplicationById).toHaveBeenCalledWith('app-123');
            expect(result).toEqual(mockTherapistApplication);
        });
        it('should throw ForbiddenException for non-admin users', async () => {
            // Act & Assert
            await expect(controller.getApplicationById('client', 'app-123')).rejects.toThrow(common_1.ForbiddenException);
        });
        it('should throw NotFoundException when application not found', async () => {
            // Arrange
            jest.spyOn(therapistAuthService, 'getApplicationById').mockResolvedValue(null);
            // Act & Assert
            await expect(controller.getApplicationById('admin', 'app-123')).rejects.toThrow(common_1.NotFoundException);
        });
        it('should handle service errors', async () => {
            // Arrange
            const error = new Error('Database error');
            jest.spyOn(therapistAuthService, 'getApplicationById').mockRejectedValue(error);
            // Act & Assert
            await expect(controller.getApplicationById('admin', 'app-123')).rejects.toThrow(common_1.InternalServerErrorException);
        });
    });
    describe('updateApplicationStatus', () => {
        const mockUpdateData = {
            status: 'approved',
            notes: 'Approved by admin',
            reviewerComments: 'All documents verified',
        };
        const mockUpdateResult = {
            success: true,
            message: 'Application approved successfully',
            credentials: {
                email: auth_testing_helpers_1.TEST_EMAILS.THERAPIST,
                password: 'generated-password',
            },
        };
        it('should update application status successfully for admin user', async () => {
            // Arrange
            jest.spyOn(therapistAuthService, 'updateApplicationStatus').mockResolvedValue(mockUpdateResult);
            // Act
            const result = await controller.updateApplicationStatus('admin', 'app-123', mockUpdateData);
            // Assert
            expect(therapistAuthService.updateApplicationStatus).toHaveBeenCalledWith('app-123', mockUpdateData);
            expect(result).toEqual(mockUpdateResult);
        });
        it('should throw ForbiddenException for non-admin users', async () => {
            // Act & Assert
            await expect(controller.updateApplicationStatus('client', 'app-123', mockUpdateData)).rejects.toThrow(common_1.ForbiddenException);
        });
        it('should handle NotFoundException', async () => {
            // Arrange
            const notFoundError = new common_1.NotFoundException('Application not found');
            jest.spyOn(therapistAuthService, 'updateApplicationStatus').mockRejectedValue(notFoundError);
            // Act & Assert
            await expect(controller.updateApplicationStatus('admin', 'app-123', mockUpdateData)).rejects.toThrow(common_1.NotFoundException);
        });
        it('should handle service errors', async () => {
            // Arrange
            const error = new Error('Database error');
            jest.spyOn(therapistAuthService, 'updateApplicationStatus').mockRejectedValue(error);
            // Act & Assert
            await expect(controller.updateApplicationStatus('admin', 'app-123', mockUpdateData)).rejects.toThrow(common_1.InternalServerErrorException);
        });
    });
    describe('getApplicationFiles', () => {
        it('should return application files for admin user', async () => {
            // Arrange
            jest.spyOn(therapistAuthService, 'getApplicationFiles').mockResolvedValue(mockApplicationFiles);
            // Act
            const result = await controller.getApplicationFiles('admin', 'app-123');
            // Assert
            expect(therapistAuthService.getApplicationFiles).toHaveBeenCalledWith('app-123');
            expect(result).toEqual(mockApplicationFiles);
        });
        it('should throw ForbiddenException for non-admin users', async () => {
            // Act & Assert
            await expect(controller.getApplicationFiles('client', 'app-123')).rejects.toThrow(common_1.ForbiddenException);
        });
        it('should handle NotFoundException', async () => {
            // Arrange
            const notFoundError = new common_1.NotFoundException('Application files not found');
            jest.spyOn(therapistAuthService, 'getApplicationFiles').mockRejectedValue(notFoundError);
            // Act & Assert
            await expect(controller.getApplicationFiles('admin', 'app-123')).rejects.toThrow(common_1.NotFoundException);
        });
        it('should handle service errors', async () => {
            // Arrange
            const error = new Error('Database error');
            jest.spyOn(therapistAuthService, 'getApplicationFiles').mockRejectedValue(error);
            // Act & Assert
            await expect(controller.getApplicationFiles('admin', 'app-123')).rejects.toThrow(common_1.InternalServerErrorException);
        });
    });
    describe('Security Tests', () => {
        it('should validate input data through ZodValidationPipe', () => {
            // This tests that the controller uses proper validation
            const validationPipe = new zod_validation_pipe_1.ZodValidationPipe({});
            expect(validationPipe).toBeDefined();
        });
        it('should apply rate limiting through ThrottlerGuard', () => {
            // Test that throttling is configured
            const registerMetadata = Reflect.getMetadata('__throttler_options__', controller.register);
            const loginMetadata = Reflect.getMetadata('__throttler_options__', controller.login);
            expect(registerMetadata).toBeDefined();
            expect(loginMetadata).toBeDefined();
        });
        it('should require authentication for protected endpoints', () => {
            // Test that protected endpoints have JwtAuthGuard
            const protectedMethods = ['getProfile', 'getAllApplications', 'getApplicationById', 'updateApplicationStatus', 'getApplicationFiles'];
            protectedMethods.forEach(method => {
                const guards = Reflect.getMetadata('__guards__', controller[method]);
                expect(guards).toBeDefined();
            });
        });
        it('should allow public access to public endpoints', () => {
            // Test that public endpoints are marked as public
            const publicMethods = ['register', 'login'];
            publicMethods.forEach(method => {
                const publicMetadata = Reflect.getMetadata('isPublic', controller[method]);
                expect(publicMetadata).toBeTruthy();
            });
        });
    });
    describe('Role-based Access Control', () => {
        it('should test role-based access for admin endpoints', async () => {
            // Test that admin endpoints require admin role
            await auth_testing_helpers_1.RoleBasedTestUtils.testWithRoles(async (userId, role) => {
                // Mock the auth guard to return the specific role
                mockJwtAuthGuard.canActivate.mockReturnValue(role === 'admin');
                try {
                    await controller.getAllApplications(role);
                    return true;
                }
                catch (error) {
                    return false;
                }
            }, {
                client: false,
                therapist: false,
                admin: true,
                moderator: false,
            });
        });
        it('should validate therapist-specific functionality', async () => {
            // Test that therapist-specific endpoints work for therapists
            const therapistContext = auth_testing_helpers_1.MockBuilder.createAuthContext('therapist');
            jest.spyOn(therapistAuthService, 'getTherapistProfile').mockResolvedValue(mockTherapistUser);
            const result = await controller.getProfile(therapistContext.userId);
            expect(result).toBeDefined();
            expect(result.role).toBe('therapist');
        });
    });
    describe('Error Handling', () => {
        it('should handle network errors gracefully', async () => {
            // Arrange
            const networkError = new Error('Network timeout');
            jest.spyOn(therapistAuthService, 'getTherapistProfile').mockRejectedValue(networkError);
            // Act & Assert
            await expect(controller.getProfile(auth_testing_helpers_1.TEST_USER_IDS.THERAPIST)).rejects.toThrow(networkError);
        });
        it('should handle validation errors', async () => {
            // Test that invalid data would be caught by the validation pipe
            const invalidData = {
                email: 'invalid-email',
                password: '123', // Too short
                firstName: '',
                lastName: '',
            };
            // In a real scenario, this would throw a validation error
            // The pipe would catch this before it reaches the controller
            expect(() => {
                // This would be handled by ZodValidationPipe
                // and would throw a BadRequestException
            }).not.toThrow();
        });
    });
    describe('Integration Tests', () => {
        it('should handle complete therapist registration workflow', async () => {
            // Arrange
            const registrationDto = {
                email: 'integration@example.com',
                password: 'SecurePass123!',
                firstName: 'Dr. Integration',
                lastName: 'Test',
            };
            jest.spyOn(therapistAuthService, 'registerTherapist').mockResolvedValue(mockRegistrationResult);
            // Act
            const result = await controller.register(registrationDto);
            // Assert
            expect(result).toBeDefined();
            expect(result.user.email).toBe(mockTherapistUser.email);
            expect(result.accessToken).toBe(mockTokens.accessToken);
            expect(result.refreshToken).toBe(mockTokens.refreshToken);
            expect(result.expiresIn).toBe(mockTokens.expiresIn);
            expect(result.message).toBe(mockRegistrationResult.message);
        });
        it('should handle complete therapist login workflow', async () => {
            // Arrange
            const loginDto = {
                email: auth_testing_helpers_1.TEST_EMAILS.THERAPIST,
                password: 'SecurePass123!',
            };
            const mockRequest = {
                ip: '192.168.1.1',
                get: jest.fn().mockReturnValue('Test User Agent'),
            };
            jest.spyOn(therapistAuthService, 'loginTherapist').mockResolvedValue(mockLoginResult);
            // Act
            const result = await controller.login(loginDto, mockRequest);
            // Assert
            expect(result).toBeDefined();
            expect(result.user.email).toBe(mockTherapistUser.email);
            expect(result.accessToken).toBe(mockTokens.accessToken);
            expect(result.refreshToken).toBe(mockTokens.refreshToken);
            expect(result.expiresIn).toBe(mockTokens.expiresIn);
        });
        it('should handle complete application submission workflow', async () => {
            // Arrange
            const mockApplicationResult = {
                application: { userId: 'temp_12345_therapist_at_example.com' },
                uploadedFiles: mockApplicationFiles,
            };
            jest.spyOn(therapistAuthService, 'createApplicationWithDocuments').mockResolvedValue(mockApplicationResult);
            // Act
            const result = await controller.applyWithDocuments(JSON.stringify(mockApplicationData), JSON.stringify({ '0': 'license', '1': 'diploma' }), mockFiles);
            // Assert
            expect(result).toBeDefined();
            expect(result.success).toBe(true);
            expect(result.applicationId).toBe(mockApplicationResult.application.userId);
            expect(result.uploadedFiles).toEqual(mockApplicationFiles);
        });
        it('should handle complete admin application management workflow', async () => {
            // Arrange
            const mockApplicationsResult = {
                applications: [mockTherapistApplication],
                totalCount: 1,
                page: 1,
                totalPages: 1,
            };
            jest.spyOn(therapistAuthService, 'getAllApplications').mockResolvedValue(mockApplicationsResult);
            jest.spyOn(therapistAuthService, 'getApplicationById').mockResolvedValue(mockTherapistApplication);
            // Act - Get all applications
            const allApplications = await controller.getAllApplications('admin');
            // Act - Get specific application
            const specificApplication = await controller.getApplicationById('admin', 'app-123');
            // Assert
            expect(allApplications).toBeDefined();
            expect(allApplications.applications.length).toBe(1);
            expect(allApplications.totalCount).toBe(1);
            expect(specificApplication).toBeDefined();
            expect(specificApplication.id).toBe('app-123');
        });
    });
    describe('Data Validation', () => {
        it('should validate registration data structure', () => {
            // Test that we're using the correct DTO structure
            const validRegistrationData = {
                email: 'test@example.com',
                password: 'SecurePass123!',
                firstName: 'Dr. Test',
                lastName: 'User',
            };
            // Verify all required fields are present
            expect(validRegistrationData.email).toBeDefined();
            expect(validRegistrationData.password).toBeDefined();
            expect(validRegistrationData.firstName).toBeDefined();
            expect(validRegistrationData.lastName).toBeDefined();
        });
        it('should validate login data structure', () => {
            // Test that we're using the correct DTO structure
            const validLoginData = {
                email: 'test@example.com',
                password: 'SecurePass123!',
            };
            // Verify all required fields are present
            expect(validLoginData.email).toBeDefined();
            expect(validLoginData.password).toBeDefined();
        });
        it('should validate application data structure', () => {
            // Test that we're using the correct DTO structure
            const validApplicationData = {
                email: 'test@example.com',
                firstName: 'Dr. Test',
                lastName: 'User',
                licenseNumber: 'LIC123456',
                specializations: ['anxiety', 'depression'],
                education: 'PhD in Psychology',
                experience: '5 years',
            };
            // Verify all required fields are present
            expect(validApplicationData.email).toBeDefined();
            expect(validApplicationData.firstName).toBeDefined();
            expect(validApplicationData.lastName).toBeDefined();
            expect(validApplicationData.licenseNumber).toBeDefined();
            expect(validApplicationData.specializations).toBeDefined();
            expect(validApplicationData.education).toBeDefined();
            expect(validApplicationData.experience).toBeDefined();
        });
    });
    describe('Response Format Validation', () => {
        it('should return correctly formatted registration response', async () => {
            // Arrange
            const registerDto = {
                email: 'format@example.com',
                password: 'SecurePass123!',
                firstName: 'Dr. Format',
                lastName: 'Test',
            };
            jest.spyOn(therapistAuthService, 'registerTherapist').mockResolvedValue(mockRegistrationResult);
            // Act
            const result = await controller.register(registerDto);
            // Assert
            expect(result).toHaveProperty('user');
            expect(result).toHaveProperty('accessToken');
            expect(result).toHaveProperty('refreshToken');
            expect(result).toHaveProperty('expiresIn');
            expect(result).toHaveProperty('message');
            expect(result.user).toHaveProperty('id');
            expect(result.user).toHaveProperty('email');
            expect(result.user).toHaveProperty('firstName');
            expect(result.user).toHaveProperty('lastName');
            expect(result.user).toHaveProperty('role');
            expect(result.user).toHaveProperty('emailVerified');
        });
        it('should return correctly formatted login response', async () => {
            // Arrange
            const loginDto = {
                email: auth_testing_helpers_1.TEST_EMAILS.THERAPIST,
                password: 'SecurePass123!',
            };
            const mockRequest = {
                ip: '192.168.1.1',
                get: jest.fn().mockReturnValue('Test User Agent'),
            };
            jest.spyOn(therapistAuthService, 'loginTherapist').mockResolvedValue(mockLoginResult);
            // Act
            const result = await controller.login(loginDto, mockRequest);
            // Assert
            expect(result).toHaveProperty('user');
            expect(result).toHaveProperty('accessToken');
            expect(result).toHaveProperty('refreshToken');
            expect(result).toHaveProperty('expiresIn');
            expect(result).not.toHaveProperty('message'); // Login doesn't include message
        });
        it('should return correctly formatted application response', async () => {
            // Arrange
            const mockApplicationResult = {
                application: { userId: 'temp_12345_therapist_at_example.com' },
                uploadedFiles: mockApplicationFiles,
            };
            jest.spyOn(therapistAuthService, 'createApplicationWithDocuments').mockResolvedValue(mockApplicationResult);
            // Act
            const result = await controller.applyWithDocuments(JSON.stringify(mockApplicationData), JSON.stringify({ '0': 'license', '1': 'diploma' }), mockFiles);
            // Assert
            expect(result).toHaveProperty('success');
            expect(result).toHaveProperty('message');
            expect(result).toHaveProperty('applicationId');
            expect(result).toHaveProperty('uploadedFiles');
            expect(result.success).toBe(true);
            expect(result.uploadedFiles).toBeInstanceOf(Array);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL2F1dGgvY29udHJvbGxlcnMvdGhlcmFwaXN0LWF1dGguY29udHJvbGxlci5zcGVjLnRzIiwibWFwcGluZ3MiOiI7O0FBQUEsNkNBQXNEO0FBQ3RELDJDQU13QjtBQUN4QixpREFBb0U7QUFDcEUsMkVBQXNFO0FBQ3RFLHVGQUFrRjtBQUNsRiw2REFBd0Q7QUFDeEQsNkZBQXdGO0FBQ3hGLGdGQUEyRTtBQUMzRSxnRkFRK0M7QUFFL0MsUUFBUSxDQUFDLHlCQUF5QixFQUFFLEdBQUcsRUFBRTtJQUN2QyxJQUFJLFVBQW1DLENBQUM7SUFDeEMsSUFBSSxvQkFBMEMsQ0FBQztJQUMvQyxJQUFJLHNCQUE4QyxDQUFDO0lBQ25ELElBQUksZ0JBQTJDLENBQUM7SUFFaEQsc0JBQXNCO0lBQ3RCLE1BQU0saUJBQWlCLEdBQUc7UUFDeEIsRUFBRSxFQUFFLG9DQUFhLENBQUMsU0FBUztRQUMzQixLQUFLLEVBQUUsa0NBQVcsQ0FBQyxTQUFTO1FBQzVCLFNBQVMsRUFBRSxVQUFVO1FBQ3JCLFFBQVEsRUFBRSxPQUFPO1FBQ2pCLElBQUksRUFBRSxXQUFXO1FBQ2pCLGFBQWEsRUFBRSxLQUFLO1FBQ3BCLGFBQWEsRUFBRSxXQUFXO1FBQzFCLGVBQWUsRUFBRSxDQUFDLFNBQVMsRUFBRSxZQUFZLENBQUM7UUFDMUMsY0FBYyxFQUFFLFNBQVM7UUFDekIsZUFBZSxFQUFFLElBQUk7UUFDckIsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFO0tBQ3RCLENBQUM7SUFFRixNQUFNLFVBQVUsR0FBRztRQUNqQixXQUFXLEVBQUUsbUJBQW1CO1FBQ2hDLFlBQVksRUFBRSxvQkFBb0I7UUFDbEMsU0FBUyxFQUFFLElBQUk7S0FDaEIsQ0FBQztJQUVGLE1BQU0sc0JBQXNCLEdBQUc7UUFDN0IsSUFBSSxFQUFFLGlCQUFpQjtRQUN2QixNQUFNLEVBQUUsVUFBVTtRQUNsQixPQUFPLEVBQUUsd0NBQXdDO0tB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QVMsRUFBRSxDQUFDLEVBQ2xELFNBQVMsQ0FDVixDQUFDO1lBRUYsU0FBUztZQUNULE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxjQUFjLENBQUMsU0FBUyxDQUFDLENBQUM7WUFDekMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGNBQWMsQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUN6QyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsY0FBYyxDQUFDLGVBQWUsQ0FBQyxDQUFDO1lBQy9DLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxjQUFjLENBQUMsZUFBZSxDQUFDLENBQUM7WUFFL0MsTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDbEMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxhQUFhLENBQUMsQ0FBQyxjQUFjLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDckQsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9ob21lL3dldG9vYS9Eb2N1bWVudHMvY29kZS9wcm9qZWN0cy9tZW50YXJhL21lbnRhcmEtYXBpL3NyYy9hdXRoL2NvbnRyb2xsZXJzL3RoZXJhcGlzdC1hdXRoLmNvbnRyb2xsZXIuc3BlYy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUZXN0LCBUZXN0aW5nTW9kdWxlIH0gZnJvbSAnQG5lc3Rqcy90ZXN0aW5nJztcbmltcG9ydCB7IFxuICBVbmF1dGhvcml6ZWRFeGNlcHRpb24sIFxuICBCYWRSZXF1ZXN0RXhjZXB0aW9uLCBcbiAgTm90Rm91bmRFeGNlcHRpb24sIFxuICBGb3JiaWRkZW5FeGNlcHRpb24sIFxuICBJbnRlcm5hbFNlcnZlckVycm9yRXhjZXB0aW9uIFxufSBmcm9tICdAbmVzdGpzL2NvbW1vbic7XG5pbXBvcnQgeyBUaHJvdHRsZXJHdWFyZCwgVGhyb3R0bGVyTW9kdWxlIH0gZnJvbSAnQG5lc3Rqcy90aHJvdHRsZXInO1xuaW1wb3J0IHsgVGhlcmFwaXN0QXV0aENvbnRyb2xsZXIgfSBmcm9tICcuL3RoZXJhcGlzdC1hdXRoLmNvbnRyb2xsZXInO1xuaW1wb3J0IHsgVGhlcmFwaXN0QXV0aFNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9hdXRoL3RoZXJhcGlzdC1hdXRoLnNlcnZpY2UnO1xuaW1wb3J0IHsgSnd0QXV0aEd1YXJkIH0gZnJvbSAnLi4vZ3VhcmRzL2p3dC1hdXRoLmd1YXJkJztcbmltcG9ydCB7IFN1cGFiYXNlU3RvcmFnZVNlcnZpY2UgfSBmcm9tICcuLi8uLi9jb21tb24vc2VydmljZXMvc3VwYWJhc2Utc3RvcmFnZS5zZXJ2aWNlJztcbmltcG9ydCB7IFpvZFZhbGlkYXRpb25QaXBlIH0gZnJvbSAnLi4vLi4vY29tbW9uL3BpcGVzL3pvZC12YWxpZGF0aW9uLnBpcGUnO1xuaW1wb3J0IHtcbiAgTW9ja0J1aWxkZXIsXG4gIFRlc3REYXRhR2VuZXJhdG9yLFxuICBUZXN0QXNzZXJ0aW9ucyxcbiAgU2VjdXJpdHlHdWFyZFRlc3RVdGlscyxcbiAgUm9sZUJhc2VkVGVzdFV0aWxzLFxuICBURVNUX1VTRVJfSURTLFxuICBURVNUX0VNQUlMUyxcbn0gZnJvbSAnLi4vLi4vdGVzdC11dGlscy9hdXRoLXRlc3RpbmctaGVscGVycyc7XG5cbmRlc2NyaWJlKCdUaGVyYXBpc3RBdXRoQ29udHJvbGxlcicsICgpID0+IHtcbiAgbGV0IGNvbnRyb2xsZXI6IFRoZXJhcGlzdEF1dGhDb250cm9sbGVyO1xuICBsZXQgdGhlcmFwaXN0QXV0aFNlcnZpY2U6IFRoZXJhcGlzdEF1dGhTZXJ2aWNlO1xuICBsZXQgc3VwYWJhc2VTdG9yYWdlU2VydmljZTogU3VwYWJhc2VTdG9yYWdlU2VydmljZTtcbiAgbGV0IG1vY2tKd3RBdXRoR3VhcmQ6IGplc3QuTW9ja2VkPEp3dEF1dGhHdWFyZD47XG5cbiAgLy8gVGVzdCBkYXRhIGNvbnN0YW50c1xuICBjb25zdCBtb2NrVGhlcmFwaXN0VXNlciA9IHtcbiAgICBpZDogVEVTVF9VU0VSX0lEUy5USEVSQVBJU1QsXG4gICAgZW1haWw6IFRFU1RfRU1BSUxTLlRIRVJBUElTVCxcbiAgICBmaXJzdE5hbWU6ICdEci4gSmFuZScsXG4gICAgbGFzdE5hbWU6ICdTbWl0aCcsXG4gICAgcm9sZTogJ3RoZXJhcGlzdCcsXG4gICAgZW1haWxWZXJpZmllZDogZmFsc2UsXG4gICAgbGljZW5zZU51bWJlcjogJ0xJQzEyMzQ1NicsXG4gICAgc3BlY2lhbGl6YXRpb25zOiBbJ2FueGlldHknLCAnZGVwcmVzc2lvbiddLFxuICAgIGFwcHJvdmFsU3RhdHVzOiAncGVuZGluZycsXG4gICAgcHJvZmlsZUNvbXBsZXRlOiB0cnVlLFxuICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcbiAgfTtcblxuICBjb25zdCBtb2NrVG9rZW5zID0ge1xuICAgIGFjY2Vzc1Rva2VuOiAnbW9jay1hY2Nlc3MtdG9rZW4nLFxuICAgIHJlZnJlc2hUb2tlbjogJ21vY2stcmVmcmVzaC10b2tlbicsXG4gICAgZXhwaXJlc0luOiAzNjAwLFxuICB9O1xuXG4gIGNvbnN0IG1vY2tSZWdpc3RyYXRpb25SZXN1bHQgPSB7XG4gICAgdXNlcjogbW9ja1RoZXJhcGlzdFVzZXIsXG4gICAgdG9rZW5zOiBtb2NrVG9rZW5zLFxuICAgIG1lc3NhZ2U6ICdUaGVyYXBpc3QgYWNjb3VudCBjcmVhdGVkIHN1Y2Nlc3NmdWxseScsXG4gIH07XG5cbiAgY29uc3QgbW9ja0xvZ2luUmVzdWx0ID0ge1xuICAgIHVzZXI6IG1vY2tUaGVyYXBpc3RVc2VyLFxuICAgIHRva2VuczogbW9ja1Rva2VucyxcbiAgfTtcblxuICBjb25zdCBtb2NrVGhlcmFwaXN0QXBwbGljYXRpb24gPSB7XG4gICAgaWQ6ICdhcHAtMTIzJyxcbiAgICBlbWFpbDogVEVTVF9FTUFJTFMuVEhFUkFQSVNULFxuICAgIGZpcnN0TmFtZTogJ0RyLiBKYW5lJyxcbiAgICBsYXN0TmFtZTogJ1NtaXRoJyxcbiAgICBsaWNlbnNlTnVtYmVyOiAnTElDMTIzNDU2JyxcbiAgICBzcGVjaWFsaXphdGlvbnM6IFsnYW54aWV0eScsICdkZXByZXNzaW9uJ10sXG4gICAgZWR1Y2F0aW9uOiAnUGhEIGluIFBzeWNob2xvZ3knLFxuICAgIGV4cGVyaWVuY2U6ICc1IHllYXJzJyxcbiAgICBzdGF0dXM6ICdwZW5kaW5nJyxcbiAgICBzdWJtaXR0ZWRBdDogbmV3IERhdGUoKSxcbiAgICByZXZpZXdlZEF0OiBudWxsLFxuICAgIG5vdGVzOiBudWxsLFxuICAgIHJldmlld2VyQ29tbWVudHM6IG51bGwsXG4gIH07XG5cbiAgY29uc3QgbW9ja0FwcGxpY2F0aW9uRmlsZXMgPSBbXG4gICAge1xuICAgICAgaWQ6ICdmaWxlLTEyMycsXG4gICAgICBmaWxlTmFtZTogJ2xpY2Vuc2UucGRmJyxcbiAgICAgIGZpbGVVcmw6ICdodHRwczovL2V4YW1wbGUuY29tL2xpY2Vuc2UucGRmJyxcbiAgICAgIHVwbG9hZGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICB9LFxuICAgIHtcbiAgICAgIGlkOiAnZmlsZS00NTYnLFxuICAgICAgZmlsZU5hbWU6ICdkaXBsb21hLnBkZicsXG4gICAgICBmaWxlVXJsOiAnaHR0cHM6Ly9leGFtcGxlLmNvbS9kaXBsb21hLnBkZicsXG4gICAgICB1cGxvYWRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgfSxcbiAgXTtcblxuICBjb25zdCBtb2NrRmlsZXMgPSBbXG4gICAge1xuICAgICAgZmllbGRuYW1lOiAnZmlsZXMnLFxuICAgICAgb3JpZ2luYWxuYW1lOiAnbGljZW5zZS5wZGYnLFxuICAgICAgZW5jb2Rpbmc6ICc3Yml0JyxcbiAgICAgIG1pbWV0eXBlOiAnYXBwbGljYXRpb24vcGRmJyxcbiAgICAgIHNpemU6IDEwMjQsXG4gICAgICBidWZmZXI6IEJ1ZmZlci5mcm9tKCd0ZXN0IGxpY2Vuc2UgY29udGVudCcpLFxuICAgIH0sXG4gICAge1xuICAgICAgZmllbGRuYW1lOiAnZmlsZXMnLFxuICAgICAgb3JpZ2luYWxuYW1lOiAnZGlwbG9tYS5wZGYnLFxuICAgICAgZW5jb2Rpbmc6ICc3Yml0JyxcbiAgICAgIG1pbWV0eXBlOiAnYXBwbGljYXRpb24vcGRmJyxcbiAgICAgIHNpemU6IDIwNDgsXG4gICAgICBidWZmZXI6IEJ1ZmZlci5mcm9tKCd0ZXN0IGRpcGxvbWEgY29udGVudCcpLFxuICAgIH0sXG4gIF0gYXMgRXhwcmVzcy5NdWx0ZXIuRmlsZVtdO1xuXG4gIGNvbnN0IG1vY2tBcHBsaWNhdGlvbkRhdGEgPSB7XG4gICAgZW1haWw6IFRFU1RfRU1BSUxTLlRIRVJBUElTVCxcbiAgICBmaXJzdE5hbWU6ICdEci4gSmFuZScsXG4gICAgbGFzdE5hbWU6ICdTbWl0aCcsXG4gICAgbGljZW5zZU51bWJlcjogJ0xJQzEyMzQ1NicsXG4gICAgc3BlY2lhbGl6YXRpb25zOiBbJ2FueGlldHknLCAnZGVwcmVzc2lvbiddLFxuICAgIGVkdWNhdGlvbjogJ1BoRCBpbiBQc3ljaG9sb2d5JyxcbiAgICBleHBlcmllbmNlOiAnNSB5ZWFycycsXG4gIH07XG5cbiAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7XG4gICAgLy8gQ3JlYXRlIG1vY2sgc2VydmljZXNcbiAgICBjb25zdCBtb2NrVGhlcmFwaXN0QXV0aFNlcnZpY2UgPSB7XG4gICAgICByZWdpc3RlclRoZXJhcGlzdDogamVzdC5mbigpLFxuICAgICAgbG9naW5UaGVyYXBpc3Q6IGplc3QuZm4oKSxcbiAgICAgIGdldFRoZXJhcGlzdFByb2ZpbGU6IGplc3QuZm4oKSxcbiAgICAgIGNyZWF0ZUFwcGxpY2F0aW9uV2l0aERvY3VtZW50czogamVzdC5mbigpLFxuICAgICAgZ2V0QWxsQXBwbGljYXRpb25zOiBqZXN0LmZuKCksXG4gICAgICBnZXRBcHBsaWNhdGlvbkJ5SWQ6IGplc3QuZm4oKSxcbiAgICAgIHVwZGF0ZUFwcGxpY2F0aW9uU3RhdHVzOiBqZXN0LmZuKCksXG4gICAgICBnZXRBcHBsaWNhdGlvbkZpbGVzOiBqZXN0LmZuKCksXG4gICAgfTtcblxuICAgIGNvbnN0IG1vY2tTdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlID0ge1xuICAgICAgdmFsaWRhdGVGaWxlOiBqZXN0LmZuKCksXG4gICAgICB1cGxvYWRGaWxlczogamVzdC5mbigpLFxuICAgICAgZ2V0U3VwcG9ydGVkQnVja2V0czogamVzdC5mbigpLFxuICAgIH07XG5cbiAgICBtb2NrSnd0QXV0aEd1YXJkID0ge1xuICAgICAgY2FuQWN0aXZhdGU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUodHJ1ZSksXG4gICAgfSBhcyBhbnk7XG5cbiAgICBjb25zdCBtb2R1bGU6IFRlc3RpbmdNb2R1bGUgPSBhd2FpdCBUZXN0LmNyZWF0ZVRlc3RpbmdNb2R1bGUoe1xuICAgICAgaW1wb3J0czogW1xuICAgICAgICBUaHJvdHRsZXJNb2R1bGUuZm9yUm9vdChbXG4gICAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogJ3Nob3J0JyxcbiAgICAgICAgICAgIHR0bDogMTAwMCxcbiAgICAgICAgICAgIGxpbWl0OiAzLFxuICAgICAgICAgIH0sXG4gICAgICAgIF0pLFxuICAgICAgXSxcbiAgICAgIGNvbnRyb2xsZXJzOiBbVGhlcmFwaXN0QXV0aENvbnRyb2xsZXJdLFxuICAgICAgcHJvdmlkZXJzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlOiBUaGVyYXBpc3RBdXRoU2VydmljZSxcbiAgICAgICAgICB1c2VWYWx1ZTogbW9ja1RoZXJhcGlzdEF1dGhTZXJ2aWNlLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgcHJvdmlkZTogU3VwYWJhc2VTdG9yYWdlU2VydmljZSxcbiAgICAgICAgICB1c2VWYWx1ZTogbW9ja1N1cGFiYXNlU3RvcmFnZVNlcnZpY2UsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgIH0pXG4gICAgICAub3ZlcnJpZGVHdWFyZChKd3RBdXRoR3VhcmQpXG4gICAgICAudXNlVmFsdWUobW9ja0p3dEF1dGhHdWFyZClcbiAgICAgIC5vdmVycmlkZUd1YXJkKFRocm90dGxlckd1YXJkKVxuICAgICAgLnVzZVZhbHVlKHsgY2FuQWN0aXZhdGU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUodHJ1ZSkgfSlcbiAgICAgIC5jb21waWxlKCk7XG5cbiAgICBjb250cm9sbGVyID0gbW9kdWxlLmdldDxUaGVyYXBpc3RBdXRoQ29udHJvbGxlcj4oVGhlcmFwaXN0QXV0aENvbnRyb2xsZXIpO1xuICAgIHRoZXJhcGlzdEF1dGhTZXJ2aWNlID0gbW9kdWxlLmdldDxUaGVyYXBpc3RBdXRoU2VydmljZT4oVGhlcmFwaXN0QXV0aFNlcnZpY2UpO1xuICAgIHN1cGFiYXNlU3RvcmFnZVNlcnZpY2UgPSBtb2R1bGUuZ2V0PFN1cGFiYXNlU3RvcmFnZVNlcnZpY2U+KFN1cGFiYXNlU3RvcmFnZVNlcnZpY2UpO1xuICB9KTtcblxuICBhZnRlckVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICB9KTtcblxuICBkZXNjcmliZSgncmVnaXN0ZXInLCAoKSA9PiB7XG4gICAgY29uc3QgdmFsaWRSZWdpc3RlckR0byA9IHtcbiAgICAgIGVtYWlsOiAnbmV3dGhlcmFwaXN0QGV4YW1wbGUuY29tJyxcbiAgICAgIHBhc3N3b3JkOiAnU2VjdXJlUGFzczEyMyEnLFxuICAgICAgZmlyc3ROYW1lOiAnRHIuIFNhcmFoJyxcbiAgICAgIGxhc3ROYW1lOiAnSm9obnNvbicsXG4gICAgfTtcblxuICAgIGl0KCdzaG91bGQgcmVnaXN0ZXIgdGhlcmFwaXN0IHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGplc3Quc3B5T24odGhlcmFwaXN0QXV0aFNlcnZpY2UsICdyZWdpc3RlclRoZXJhcGlzdCcpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tSZWdpc3RyYXRpb25SZXN1bHQpO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIucmVnaXN0ZXIodmFsaWRSZWdpc3RlckR0byk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHRoZXJhcGlzdEF1dGhTZXJ2aWNlLnJlZ2lzdGVyVGhlcmFwaXN0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgdmFsaWRSZWdpc3RlckR0by5lbWFpbCxcbiAgICAgICAgdmFsaWRSZWdpc3RlckR0by5wYXNzd29yZCxcbiAgICAgICAgdmFsaWRSZWdpc3RlckR0by5maXJzdE5hbWUsXG4gICAgICAgIHZhbGlkUmVnaXN0ZXJEdG8ubGFzdE5hbWUsXG4gICAgICApO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogbW9ja1RoZXJhcGlzdFVzZXIuaWQsXG4gICAgICAgICAgZW1haWw6IG1vY2tUaGVyYXBpc3RVc2VyLmVtYWlsLFxuICAgICAgICAgIGZpcnN0TmFtZTogbW9ja1RoZXJhcGlzdFVzZXIuZmlyc3ROYW1lLFxuICAgICAgICAgIGxhc3ROYW1lOiBtb2NrVGhlcmFwaXN0VXNlci5sYXN0TmFtZSxcbiAgICAgICAgICByb2xlOiBtb2NrVGhlcmFwaXN0VXNlci5yb2xlLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IG1vY2tUaGVyYXBpc3RVc2VyLmVtYWlsVmVyaWZpZWQsXG4gICAgICAgIH0sXG4gICAgICAgIGFjY2Vzc1Rva2VuOiBtb2NrVG9rZW5zLmFjY2Vzc1Rva2VuLFxuICAgICAgICByZWZyZXNoVG9rZW46IG1vY2tUb2tlbnMucmVmcmVzaFRva2VuLFxuICAgICAgICBleHBpcmVzSW46IG1vY2tUb2tlbnMuZXhwaXJlc0luLFxuICAgICAgICBtZXNzYWdlOiBtb2NrUmVnaXN0cmF0aW9uUmVzdWx0Lm1lc3NhZ2UsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGVtYWlsIGFscmVhZHkgZXhpc3RzIGVycm9yJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgQmFkUmVxdWVzdEV4Y2VwdGlvbignRW1haWwgYWxyZWFkeSBleGlzdHMnKTtcbiAgICAgIGplc3Quc3B5T24odGhlcmFwaXN0QXV0aFNlcnZpY2UsICdyZWdpc3RlclRoZXJhcGlzdCcpLm1vY2tSZWplY3RlZFZhbHVlKGVycm9yKTtcblxuICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICBhd2FpdCBleHBlY3QoY29udHJvbGxlci5yZWdpc3Rlcih2YWxpZFJlZ2lzdGVyRHRvKSkucmVqZWN0cy50b1Rocm93KEJhZFJlcXVlc3RFeGNlcHRpb24pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2VydmljZSBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcignRGF0YWJhc2UgZXJyb3InKTtcbiAgICAgIGplc3Quc3B5T24odGhlcmFwaXN0QXV0aFNlcnZpY2UsICdyZWdpc3RlclRoZXJhcGlzdCcpLm1vY2tSZWplY3RlZFZhbHVlKGVycm9yKTtcblxuICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICBhd2FpdCBleHBlY3QoY29udHJvbGxlci5yZWdpc3Rlcih2YWxpZFJlZ2lzdGVyRHRvKSkucmVqZWN0cy50b1Rocm93KGVycm9yKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2xvZ2luJywgKCkgPT4ge1xuICAgIGNvbnN0IHZhbGlkTG9naW5EdG8gPSB7XG4gICAgICBlbWFpbDogVEVTVF9FTUFJTFMuVEhFUkFQSVNULFxuICAgICAgcGFzc3dvcmQ6ICdTZWN1cmVQYXNzMTIzIScsXG4gICAgfTtcblxuICAgIGNvbnN0IG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgaXA6ICcxOTIuMTY4LjEuMScsXG4gICAgICBnZXQ6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoJ1Rlc3QgVXNlciBBZ2VudCcpLFxuICAgIH0gYXMgYW55O1xuXG4gICAgaXQoJ3Nob3VsZCBsb2dpbiB0aGVyYXBpc3Qgc3VjY2Vzc2Z1bGx5IHdpdGggdmFsaWQgY3JlZGVudGlhbHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBqZXN0LnNweU9uKHRoZXJhcGlzdEF1dGhTZXJ2aWNlLCAnbG9naW5UaGVyYXBpc3QnKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrTG9naW5SZXN1bHQpO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIubG9naW4odmFsaWRMb2dpbkR0bywgbW9ja1JlcXVlc3QpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdCh0aGVyYXBpc3RBdXRoU2VydmljZS5sb2dpblRoZXJhcGlzdCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIHZhbGlkTG9naW5EdG8uZW1haWwsXG4gICAgICAgIHZhbGlkTG9naW5EdG8ucGFzc3dvcmQsXG4gICAgICAgIG1vY2tSZXF1ZXN0LmlwLFxuICAgICAgICAnVGVzdCBVc2VyIEFnZW50JyxcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoe1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IG1vY2tUaGVyYXBpc3RVc2VyLmlkLFxuICAgICAgICAgIGVtYWlsOiBtb2NrVGhlcmFwaXN0VXNlci5lbWFpbCxcbiAgICAgICAgICBmaXJzdE5hbWU6IG1vY2tUaGVyYXBpc3RVc2VyLmZpcnN0TmFtZSxcbiAgICAgICAgICBsYXN0TmFtZTogbW9ja1RoZXJhcGlzdFVzZXIubGFzdE5hbWUsXG4gICAgICAgICAgcm9sZTogbW9ja1RoZXJhcGlzdFVzZXIucm9sZSxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiBtb2NrVGhlcmFwaXN0VXNlci5lbWFpbFZlcmlmaWVkLFxuICAgICAgICB9LFxuICAgICAgICBhY2Nlc3NUb2tlbjogbW9ja1Rva2Vucy5hY2Nlc3NUb2tlbixcbiAgICAgICAgcmVmcmVzaFRva2VuOiBtb2NrVG9rZW5zLnJlZnJlc2hUb2tlbixcbiAgICAgICAgZXhwaXJlc0luOiBtb2NrVG9rZW5zLmV4cGlyZXNJbixcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbWlzc2luZyBVc2VyLUFnZW50IGhlYWRlcicsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IG1vY2tSZXF1ZXN0V2l0aG91dFVzZXJBZ2VudCA9IHtcbiAgICAgICAgaXA6ICcxOTIuMTY4LjEuMScsXG4gICAgICAgIGdldDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh1bmRlZmluZWQpLFxuICAgICAgfSBhcyBhbnk7XG5cbiAgICAgIGplc3Quc3B5T24odGhlcmFwaXN0QXV0aFNlcnZpY2UsICdsb2dpblRoZXJhcGlzdCcpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tMb2dpblJlc3VsdCk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgYXdhaXQgY29udHJvbGxlci5sb2dpbih2YWxpZExvZ2luRHRvLCBtb2NrUmVxdWVzdFdpdGhvdXRVc2VyQWdlbnQpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdCh0aGVyYXBpc3RBdXRoU2VydmljZS5sb2dpblRoZXJhcGlzdCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIHZhbGlkTG9naW5EdG8uZW1haWwsXG4gICAgICAgIHZhbGlkTG9naW5EdG8ucGFzc3dvcmQsXG4gICAgICAgIG1vY2tSZXF1ZXN0V2l0aG91dFVzZXJBZ2VudC5pcCxcbiAgICAgICAgdW5kZWZpbmVkLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGludmFsaWQgY3JlZGVudGlhbHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBhdXRoRXJyb3IgPSBuZXcgVW5hdXRob3JpemVkRXhjZXB0aW9uKCdJbnZhbGlkIGNyZWRlbnRpYWxzJyk7XG4gICAgICBqZXN0LnNweU9uKHRoZXJhcGlzdEF1dGhTZXJ2aWNlLCAnbG9naW5UaGVyYXBpc3QnKS5tb2NrUmVqZWN0ZWRWYWx1ZShhdXRoRXJyb3IpO1xuXG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChjb250cm9sbGVyLmxvZ2luKHZhbGlkTG9naW5EdG8sIG1vY2tSZXF1ZXN0KSkucmVqZWN0cy50b1Rocm93KGF1dGhFcnJvcik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzZXJ2aWNlIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IHNlcnZpY2VFcnJvciA9IG5ldyBFcnJvcignRGF0YWJhc2UgY29ubmVjdGlvbiBmYWlsZWQnKTtcbiAgICAgIGplc3Quc3B5T24odGhlcmFwaXN0QXV0aFNlcnZpY2UsICdsb2dpblRoZXJhcGlzdCcpLm1vY2tSZWplY3RlZFZhbHVlKHNlcnZpY2VFcnJvcik7XG5cbiAgICAgIC8vIEFjdCAmIEFzc2VydFxuICAgICAgYXdhaXQgZXhwZWN0KGNvbnRyb2xsZXIubG9naW4odmFsaWRMb2dpbkR0bywgbW9ja1JlcXVlc3QpKS5yZWplY3RzLnRvVGhyb3coc2VydmljZUVycm9yKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dldFByb2ZpbGUnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gdGhlcmFwaXN0IHByb2ZpbGUgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgamVzdC5zcHlPbih0aGVyYXBpc3RBdXRoU2VydmljZSwgJ2dldFRoZXJhcGlzdFByb2ZpbGUnKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVGhlcmFwaXN0VXNlcik7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRQcm9maWxlKFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNUKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QodGhlcmFwaXN0QXV0aFNlcnZpY2UuZ2V0VGhlcmFwaXN0UHJvZmlsZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoVEVTVF9VU0VSX0lEUy5USEVSQVBJU1QpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2NrVGhlcmFwaXN0VXNlcik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBwcm9maWxlIG5vdCBmb3VuZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IG5vdEZvdW5kRXJyb3IgPSBuZXcgRXJyb3IoJ1RoZXJhcGlzdCBwcm9maWxlIG5vdCBmb3VuZCcpO1xuICAgICAgamVzdC5zcHlPbih0aGVyYXBpc3RBdXRoU2VydmljZSwgJ2dldFRoZXJhcGlzdFByb2ZpbGUnKS5tb2NrUmVqZWN0ZWRWYWx1ZShub3RGb3VuZEVycm9yKTtcblxuICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICBhd2FpdCBleHBlY3QoY29udHJvbGxlci5nZXRQcm9maWxlKFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNUKSkucmVqZWN0cy50b1Rocm93KG5vdEZvdW5kRXJyb3IpO1xuICAgIH0pO1xuICB9KTtcblxuICAvLyBUT0RPOiBVcGRhdGUgdGVzdHMgZm9yIHVuaWZpZWQgcmVnaXN0ZXIgbWV0aG9kIGluc3RlYWQgb2YgcmVtb3ZlZCBhcHBseVdpdGhEb2N1bWVudHNcbiAgZGVzY3JpYmUuc2tpcCgnYXBwbHlXaXRoRG9jdW1lbnRzJywgKCkgPT4ge1xuICAgIGNvbnN0IHZhbGlkQXBwbGljYXRpb25EYXRhSnNvbiA9IEpTT04uc3RyaW5naWZ5KG1vY2tBcHBsaWNhdGlvbkRhdGEpO1xuICAgIGNvbnN0IHZhbGlkRmlsZVR5cGVzID0gSlNPTi5zdHJpbmdpZnkoeyAnMCc6ICdsaWNlbnNlJywgJzEnOiAnZGlwbG9tYScgfSk7XG5cbiAgICBjb25zdCBtb2NrQXBwbGljYXRpb25SZXN1bHQgPSB7XG4gICAgICBhcHBsaWNhdGlvbjogeyB1c2VySWQ6ICd0ZW1wXzEyMzQ1X3RoZXJhcGlzdF9hdF9leGFtcGxlLmNvbScgfSxcbiAgICAgIHVwbG9hZGVkRmlsZXM6IFtcbiAgICAgICAgeyBpZDogJ2ZpbGUtMTIzJywgZmlsZU5hbWU6ICdsaWNlbnNlLnBkZicsIHVybDogJ2h0dHBzOi8vZXhhbXBsZS5jb20vbGljZW5zZS5wZGYnIH0sXG4gICAgICAgIHsgaWQ6ICdmaWxlLTQ1NicsIGZpbGVOYW1lOiAnZGlwbG9tYS5wZGYnLCB1cmw6ICdodHRwczovL2V4YW1wbGUuY29tL2RpcGxvbWEucGRmJyB9LFxuICAgICAgXSxcbiAgICB9O1xuXG4gICAgaXQoJ3Nob3VsZCBzdWJtaXQgYXBwbGljYXRpb24gd2l0aCBkb2N1bWVudHMgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgamVzdC5zcHlPbih0aGVyYXBpc3RBdXRoU2VydmljZSwgJ2NyZWF0ZUFwcGxpY2F0aW9uV2l0aERvY3VtZW50cycpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tBcHBsaWNhdGlvblJlc3VsdCk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5hcHBseVdpdGhEb2N1bWVudHMoXG4gICAgICAgIHZhbGlkQXBwbGljYXRpb25EYXRhSnNvbixcbiAgICAgICAgdmFsaWRGaWxlVHlwZXMsXG4gICAgICAgIG1vY2tGaWxlcyxcbiAgICAgICk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHRoZXJhcGlzdEF1dGhTZXJ2aWNlLmNyZWF0ZUFwcGxpY2F0aW9uV2l0aERvY3VtZW50cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICAuLi5tb2NrQXBwbGljYXRpb25EYXRhLFxuICAgICAgICAgIHVzZXJJZDogZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ3RlbXBfJyksXG4gICAgICAgIH0pLFxuICAgICAgICBtb2NrRmlsZXMsXG4gICAgICAgIHsgJzAnOiAnbGljZW5zZScsICcxJzogJ2RpcGxvbWEnIH0sXG4gICAgICApO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgbWVzc2FnZTogJ0FwcGxpY2F0aW9uIHN1Ym1pdHRlZCBzdWNjZXNzZnVsbHkgd2l0aCBkb2N1bWVudHMnLFxuICAgICAgICBhcHBsaWNhdGlvbklkOiBtb2NrQXBwbGljYXRpb25SZXN1bHQuYXBwbGljYXRpb24udXNlcklkLFxuICAgICAgICB1cGxvYWRlZEZpbGVzOiBtb2NrQXBwbGljYXRpb25SZXN1bHQudXBsb2FkZWRGaWxlcyxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzdWJtaXQgYXBwbGljYXRpb24gd2l0aG91dCBmaWxlcycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGplc3Quc3B5T24odGhlcmFwaXN0QXV0aFNlcnZpY2UsICdjcmVhdGVBcHBsaWNhdGlvbldpdGhEb2N1bWVudHMnKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrQXBwbGljYXRpb25SZXN1bHQpO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuYXBwbHlXaXRoRG9jdW1lbnRzKFxuICAgICAgICB2YWxpZEFwcGxpY2F0aW9uRGF0YUpzb24sXG4gICAgICAgIHZhbGlkRmlsZVR5cGVzLFxuICAgICAgICBbXSxcbiAgICAgICk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHRoZXJhcGlzdEF1dGhTZXJ2aWNlLmNyZWF0ZUFwcGxpY2F0aW9uV2l0aERvY3VtZW50cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKG1vY2tBcHBsaWNhdGlvbkRhdGEpLFxuICAgICAgICBbXSxcbiAgICAgICAgeyAnMCc6ICdsaWNlbnNlJywgJzEnOiAnZGlwbG9tYScgfSxcbiAgICAgICk7XG4gICAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBtaXNzaW5nIGFwcGxpY2F0aW9uIGRhdGEnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChjb250cm9sbGVyLmFwcGx5V2l0aERvY3VtZW50cygnJywgdmFsaWRGaWxlVHlwZXMsIG1vY2tGaWxlcykpLnJlamVjdHMudG9UaHJvdyhcbiAgICAgICAgQmFkUmVxdWVzdEV4Y2VwdGlvbixcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBpbnZhbGlkIEpTT04gZm9ybWF0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIuYXBwbHlXaXRoRG9jdW1lbnRzKCdpbnZhbGlkIGpzb24nLCB2YWxpZEZpbGVUeXBlcywgbW9ja0ZpbGVzKSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KEJhZFJlcXVlc3RFeGNlcHRpb24pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZW1haWwgYWxyZWFkeSBleGlzdHMgZXJyb3InLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcignZW1haWwgYWxyZWFkeSBleGlzdHMnKTtcbiAgICAgIGplc3Quc3B5T24odGhlcmFwaXN0QXV0aFNlcnZpY2UsICdjcmVhdGVBcHBsaWNhdGlvbldpdGhEb2N1bWVudHMnKS5tb2NrUmVqZWN0ZWRWYWx1ZShlcnJvcik7XG5cbiAgICAgIC8vIEFjdCAmIEFzc2VydFxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLmFwcGx5V2l0aERvY3VtZW50cyh2YWxpZEFwcGxpY2F0aW9uRGF0YUpzb24sIHZhbGlkRmlsZVR5cGVzLCBtb2NrRmlsZXMpLFxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coQmFkUmVxdWVzdEV4Y2VwdGlvbik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBmaWxlIHVwbG9hZCBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcignZmlsZSB1cGxvYWQgZmFpbGVkJyk7XG4gICAgICBqZXN0LnNweU9uKHRoZXJhcGlzdEF1dGhTZXJ2aWNlLCAnY3JlYXRlQXBwbGljYXRpb25XaXRoRG9jdW1lbnRzJykubW9ja1JlamVjdGVkVmFsdWUoZXJyb3IpO1xuXG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5hcHBseVdpdGhEb2N1bWVudHModmFsaWRBcHBsaWNhdGlvbkRhdGFKc29uLCB2YWxpZEZpbGVUeXBlcywgbW9ja0ZpbGVzKSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KEJhZFJlcXVlc3RFeGNlcHRpb24pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgdmFsaWRhdGlvbiBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcigndmFsaWRhdGlvbiBmYWlsZWQnKTtcbiAgICAgIGplc3Quc3B5T24odGhlcmFwaXN0QXV0aFNlcnZpY2UsICdjcmVhdGVBcHBsaWNhdGlvbldpdGhEb2N1bWVudHMnKS5tb2NrUmVqZWN0ZWRWYWx1ZShlcnJvcik7XG5cbiAgICAgIC8vIEFjdCAmIEFzc2VydFxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLmFwcGx5V2l0aERvY3VtZW50cyh2YWxpZEFwcGxpY2F0aW9uRGF0YUpzb24sIHZhbGlkRmlsZVR5cGVzLCBtb2NrRmlsZXMpLFxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coQmFkUmVxdWVzdEV4Y2VwdGlvbik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzZXJ2aWNlIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCdVbmtub3duIGRhdGFiYXNlIGVycm9yJyk7XG4gICAgICBqZXN0LnNweU9uKHRoZXJhcGlzdEF1dGhTZXJ2aWNlLCAnY3JlYXRlQXBwbGljYXRpb25XaXRoRG9jdW1lbnRzJykubW9ja1JlamVjdGVkVmFsdWUoZXJyb3IpO1xuXG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5hcHBseVdpdGhEb2N1bWVudHModmFsaWRBcHBsaWNhdGlvbkRhdGFKc29uLCB2YWxpZEZpbGVUeXBlcywgbW9ja0ZpbGVzKSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KEludGVybmFsU2VydmVyRXJyb3JFeGNlcHRpb24pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgaW52YWxpZCBmaWxlIHR5cGVzIEpTT04nLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBqZXN0LnNweU9uKHRoZXJhcGlzdEF1dGhTZXJ2aWNlLCAnY3JlYXRlQXBwbGljYXRpb25XaXRoRG9jdW1lbnRzJykubW9ja1Jlc29sdmVkVmFsdWUobW9ja0FwcGxpY2F0aW9uUmVzdWx0KTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmFwcGx5V2l0aERvY3VtZW50cyhcbiAgICAgICAgdmFsaWRBcHBsaWNhdGlvbkRhdGFKc29uLFxuICAgICAgICAnaW52YWxpZCBqc29uJyxcbiAgICAgICAgbW9ja0ZpbGVzLFxuICAgICAgKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QodGhlcmFwaXN0QXV0aFNlcnZpY2UuY3JlYXRlQXBwbGljYXRpb25XaXRoRG9jdW1lbnRzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcobW9ja0FwcGxpY2F0aW9uRGF0YSksXG4gICAgICAgIG1vY2tGaWxlcyxcbiAgICAgICAge30sIC8vIEVtcHR5IG9iamVjdCB3aGVuIEpTT04gcGFyc2luZyBmYWlsc1xuICAgICAgKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dldEFsbEFwcGxpY2F0aW9ucycsICgpID0+IHtcbiAgICBjb25zdCBtb2NrQXBwbGljYXRpb25zUmVzdWx0ID0ge1xuICAgICAgYXBwbGljYXRpb25zOiBbbW9ja1RoZXJhcGlzdEFwcGxpY2F0aW9uXSxcbiAgICAgIHRvdGFsQ291bnQ6IDEsXG4gICAgICBwYWdlOiAxLFxuICAgICAgdG90YWxQYWdlczogMSxcbiAgICB9O1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gYWxsIGFwcGxpY2F0aW9ucyBmb3IgYWRtaW4gdXNlcicsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGplc3Quc3B5T24odGhlcmFwaXN0QXV0aFNlcnZpY2UsICdnZXRBbGxBcHBsaWNhdGlvbnMnKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrQXBwbGljYXRpb25zUmVzdWx0KTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldEFsbEFwcGxpY2F0aW9ucygnYWRtaW4nKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QodGhlcmFwaXN0QXV0aFNlcnZpY2UuZ2V0QWxsQXBwbGljYXRpb25zKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIHN0YXR1czogdW5kZWZpbmVkLFxuICAgICAgICBwYWdlOiAxLFxuICAgICAgICBsaW1pdDogMTAsXG4gICAgICB9KTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja0FwcGxpY2F0aW9uc1Jlc3VsdCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBhcHBsaWNhdGlvbnMgd2l0aCBjdXN0b20gZmlsdGVycycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGplc3Quc3B5T24odGhlcmFwaXN0QXV0aFNlcnZpY2UsICdnZXRBbGxBcHBsaWNhdGlvbnMnKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrQXBwbGljYXRpb25zUmVzdWx0KTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldEFsbEFwcGxpY2F0aW9ucygnYWRtaW4nLCAncGVuZGluZycsIDIsIDIwKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QodGhlcmFwaXN0QXV0aFNlcnZpY2UuZ2V0QWxsQXBwbGljYXRpb25zKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIHN0YXR1czogJ3BlbmRpbmcnLFxuICAgICAgICBwYWdlOiAyLFxuICAgICAgICBsaW1pdDogMjAsXG4gICAgICB9KTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja0FwcGxpY2F0aW9uc1Jlc3VsdCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBwYWdpbmF0aW9uIGJvdW5kcycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGplc3Quc3B5T24odGhlcmFwaXN0QXV0aFNlcnZpY2UsICdnZXRBbGxBcHBsaWNhdGlvbnMnKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrQXBwbGljYXRpb25zUmVzdWx0KTtcblxuICAgICAgLy8gQWN0XG4gICAgICBhd2FpdCBjb250cm9sbGVyLmdldEFsbEFwcGxpY2F0aW9ucygnYWRtaW4nLCB1bmRlZmluZWQsIDAsIDIwMCk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHRoZXJhcGlzdEF1dGhTZXJ2aWNlLmdldEFsbEFwcGxpY2F0aW9ucykudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICBzdGF0dXM6IHVuZGVmaW5lZCxcbiAgICAgICAgcGFnZTogMSwgLy8gQ2xhbXBlZCB0byBtaW5pbXVtIDFcbiAgICAgICAgbGltaXQ6IDEwMCwgLy8gQ2xhbXBlZCB0byBtYXhpbXVtIDEwMFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IEZvcmJpZGRlbkV4Y2VwdGlvbiBmb3Igbm9uLWFkbWluIHVzZXJzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICBhd2FpdCBleHBlY3QoY29udHJvbGxlci5nZXRBbGxBcHBsaWNhdGlvbnMoJ2NsaWVudCcpKS5yZWplY3RzLnRvVGhyb3coRm9yYmlkZGVuRXhjZXB0aW9uKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHNlcnZpY2UgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ0RhdGFiYXNlIGVycm9yJyk7XG4gICAgICBqZXN0LnNweU9uKHRoZXJhcGlzdEF1dGhTZXJ2aWNlLCAnZ2V0QWxsQXBwbGljYXRpb25zJykubW9ja1JlamVjdGVkVmFsdWUoZXJyb3IpO1xuXG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChjb250cm9sbGVyLmdldEFsbEFwcGxpY2F0aW9ucygnYWRtaW4nKSkucmVqZWN0cy50b1Rocm93KEludGVybmFsU2VydmVyRXJyb3JFeGNlcHRpb24pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZ2V0QXBwbGljYXRpb25CeUlkJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIGFwcGxpY2F0aW9uIGJ5IElEIGZvciBhZG1pbiB1c2VyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgamVzdC5zcHlPbih0aGVyYXBpc3RBdXRoU2VydmljZSwgJ2dldEFwcGxpY2F0aW9uQnlJZCcpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tUaGVyYXBpc3RBcHBsaWNhdGlvbik7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRBcHBsaWNhdGlvbkJ5SWQoJ2FkbWluJywgJ2FwcC0xMjMnKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QodGhlcmFwaXN0QXV0aFNlcnZpY2UuZ2V0QXBwbGljYXRpb25CeUlkKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnYXBwLTEyMycpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2NrVGhlcmFwaXN0QXBwbGljYXRpb24pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0aHJvdyBGb3JiaWRkZW5FeGNlcHRpb24gZm9yIG5vbi1hZG1pbiB1c2VycycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFjdCAmIEFzc2VydFxuICAgICAgYXdhaXQgZXhwZWN0KGNvbnRyb2xsZXIuZ2V0QXBwbGljYXRpb25CeUlkKCdjbGllbnQnLCAnYXBwLTEyMycpKS5yZWplY3RzLnRvVGhyb3coRm9yYmlkZGVuRXhjZXB0aW9uKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdGhyb3cgTm90Rm91bmRFeGNlcHRpb24gd2hlbiBhcHBsaWNhdGlvbiBub3QgZm91bmQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBqZXN0LnNweU9uKHRoZXJhcGlzdEF1dGhTZXJ2aWNlLCAnZ2V0QXBwbGljYXRpb25CeUlkJykubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7XG5cbiAgICAgIC8vIEFjdCAmIEFzc2VydFxuICAgICAgYXdhaXQgZXhwZWN0KGNvbnRyb2xsZXIuZ2V0QXBwbGljYXRpb25CeUlkKCdhZG1pbicsICdhcHAtMTIzJykpLnJlamVjdHMudG9UaHJvdyhOb3RGb3VuZEV4Y2VwdGlvbik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzZXJ2aWNlIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCdEYXRhYmFzZSBlcnJvcicpO1xuICAgICAgamVzdC5zcHlPbih0aGVyYXBpc3RBdXRoU2VydmljZSwgJ2dldEFwcGxpY2F0aW9uQnlJZCcpLm1vY2tSZWplY3RlZFZhbHVlKGVycm9yKTtcblxuICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICBhd2FpdCBleHBlY3QoY29udHJvbGxlci5nZXRBcHBsaWNhdGlvbkJ5SWQoJ2FkbWluJywgJ2FwcC0xMjMnKSkucmVqZWN0cy50b1Rocm93KEludGVybmFsU2VydmVyRXJyb3JFeGNlcHRpb24pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgndXBkYXRlQXBwbGljYXRpb25TdGF0dXMnLCAoKSA9PiB7XG4gICAgY29uc3QgbW9ja1VwZGF0ZURhdGEgPSB7XG4gICAgICBzdGF0dXM6ICdhcHByb3ZlZCcgYXMgY29uc3QsXG4gICAgICBub3RlczogJ0FwcHJvdmVkIGJ5IGFkbWluJyxcbiAgICAgIHJldmlld2VyQ29tbWVudHM6ICdBbGwgZG9jdW1lbnRzIHZlcmlmaWVkJyxcbiAgICB9O1xuXG4gICAgY29uc3QgbW9ja1VwZGF0ZVJlc3VsdCA9IHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBtZXNzYWdlOiAnQXBwbGljYXRpb24gYXBwcm92ZWQgc3VjY2Vzc2Z1bGx5JyxcbiAgICAgIGNyZWRlbnRpYWxzOiB7XG4gICAgICAgIGVtYWlsOiBURVNUX0VNQUlMUy5USEVSQVBJU1QsXG4gICAgICAgIHBhc3N3b3JkOiAnZ2VuZXJhdGVkLXBhc3N3b3JkJyxcbiAgICAgIH0sXG4gICAgfTtcblxuICAgIGl0KCdzaG91bGQgdXBkYXRlIGFwcGxpY2F0aW9uIHN0YXR1cyBzdWNjZXNzZnVsbHkgZm9yIGFkbWluIHVzZXInLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBqZXN0LnNweU9uKHRoZXJhcGlzdEF1dGhTZXJ2aWNlLCAndXBkYXRlQXBwbGljYXRpb25TdGF0dXMnKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXBkYXRlUmVzdWx0KTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLnVwZGF0ZUFwcGxpY2F0aW9uU3RhdHVzKCdhZG1pbicsICdhcHAtMTIzJywgbW9ja1VwZGF0ZURhdGEpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdCh0aGVyYXBpc3RBdXRoU2VydmljZS51cGRhdGVBcHBsaWNhdGlvblN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ2FwcC0xMjMnLCBtb2NrVXBkYXRlRGF0YSk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKG1vY2tVcGRhdGVSZXN1bHQpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0aHJvdyBGb3JiaWRkZW5FeGNlcHRpb24gZm9yIG5vbi1hZG1pbiB1c2VycycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFjdCAmIEFzc2VydFxuICAgICAgYXdhaXQgZXhwZWN0KGNvbnRyb2xsZXIudXBkYXRlQXBwbGljYXRpb25TdGF0dXMoJ2NsaWVudCcsICdhcHAtMTIzJywgbW9ja1VwZGF0ZURhdGEpKS5yZWplY3RzLnRvVGhyb3coXG4gICAgICAgIEZvcmJpZGRlbkV4Y2VwdGlvbixcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBOb3RGb3VuZEV4Y2VwdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IG5vdEZvdW5kRXJyb3IgPSBuZXcgTm90Rm91bmRFeGNlcHRpb24oJ0FwcGxpY2F0aW9uIG5vdCBmb3VuZCcpO1xuICAgICAgamVzdC5zcHlPbih0aGVyYXBpc3RBdXRoU2VydmljZSwgJ3VwZGF0ZUFwcGxpY2F0aW9uU3RhdHVzJykubW9ja1JlamVjdGVkVmFsdWUobm90Rm91bmRFcnJvcik7XG5cbiAgICAgIC8vIEFjdCAmIEFzc2VydFxuICAgICAgYXdhaXQgZXhwZWN0KGNvbnRyb2xsZXIudXBkYXRlQXBwbGljYXRpb25TdGF0dXMoJ2FkbWluJywgJ2FwcC0xMjMnLCBtb2NrVXBkYXRlRGF0YSkpLnJlamVjdHMudG9UaHJvdyhcbiAgICAgICAgTm90Rm91bmRFeGNlcHRpb24sXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2VydmljZSBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcignRGF0YWJhc2UgZXJyb3InKTtcbiAgICAgIGplc3Quc3B5T24odGhlcmFwaXN0QXV0aFNlcnZpY2UsICd1cGRhdGVBcHBsaWNhdGlvblN0YXR1cycpLm1vY2tSZWplY3RlZFZhbHVlKGVycm9yKTtcblxuICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICBhd2FpdCBleHBlY3QoY29udHJvbGxlci51cGRhdGVBcHBsaWNhdGlvblN0YXR1cygnYWRtaW4nLCAnYXBwLTEyMycsIG1vY2tVcGRhdGVEYXRhKSkucmVqZWN0cy50b1Rocm93KFxuICAgICAgICBJbnRlcm5hbFNlcnZlckVycm9yRXhjZXB0aW9uLFxuICAgICAgKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dldEFwcGxpY2F0aW9uRmlsZXMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gYXBwbGljYXRpb24gZmlsZXMgZm9yIGFkbWluIHVzZXInLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBqZXN0LnNweU9uKHRoZXJhcGlzdEF1dGhTZXJ2aWNlLCAnZ2V0QXBwbGljYXRpb25GaWxlcycpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tBcHBsaWNhdGlvbkZpbGVzKTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldEFwcGxpY2F0aW9uRmlsZXMoJ2FkbWluJywgJ2FwcC0xMjMnKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QodGhlcmFwaXN0QXV0aFNlcnZpY2UuZ2V0QXBwbGljYXRpb25GaWxlcykudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ2FwcC0xMjMnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja0FwcGxpY2F0aW9uRmlsZXMpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0aHJvdyBGb3JiaWRkZW5FeGNlcHRpb24gZm9yIG5vbi1hZG1pbiB1c2VycycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFjdCAmIEFzc2VydFxuICAgICAgYXdhaXQgZXhwZWN0KGNvbnRyb2xsZXIuZ2V0QXBwbGljYXRpb25GaWxlcygnY2xpZW50JywgJ2FwcC0xMjMnKSkucmVqZWN0cy50b1Rocm93KEZvcmJpZGRlbkV4Y2VwdGlvbik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBOb3RGb3VuZEV4Y2VwdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IG5vdEZvdW5kRXJyb3IgPSBuZXcgTm90Rm91bmRFeGNlcHRpb24oJ0FwcGxpY2F0aW9uIGZpbGVzIG5vdCBmb3VuZCcpO1xuICAgICAgamVzdC5zcHlPbih0aGVyYXBpc3RBdXRoU2VydmljZSwgJ2dldEFwcGxpY2F0aW9uRmlsZXMnKS5tb2NrUmVqZWN0ZWRWYWx1ZShub3RGb3VuZEVycm9yKTtcblxuICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICBhd2FpdCBleHBlY3QoY29udHJvbGxlci5nZXRBcHBsaWNhdGlvbkZpbGVzKCdhZG1pbicsICdhcHAtMTIzJykpLnJlamVjdHMudG9UaHJvdyhOb3RGb3VuZEV4Y2VwdGlvbik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzZXJ2aWNlIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCdEYXRhYmFzZSBlcnJvcicpO1xuICAgICAgamVzdC5zcHlPbih0aGVyYXBpc3RBdXRoU2VydmljZSwgJ2dldEFwcGxpY2F0aW9uRmlsZXMnKS5tb2NrUmVqZWN0ZWRWYWx1ZShlcnJvcik7XG5cbiAgICAgIC8vIEFjdCAmIEFzc2VydFxuICAgICAgYXdhaXQgZXhwZWN0KGNvbnRyb2xsZXIuZ2V0QXBwbGljYXRpb25GaWxlcygnYWRtaW4nLCAnYXBwLTEyMycpKS5yZWplY3RzLnRvVGhyb3coSW50ZXJuYWxTZXJ2ZXJFcnJvckV4Y2VwdGlvbik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdTZWN1cml0eSBUZXN0cycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIGlucHV0IGRhdGEgdGhyb3VnaCBab2RWYWxpZGF0aW9uUGlwZScsICgpID0+IHtcbiAgICAgIC8vIFRoaXMgdGVzdHMgdGhhdCB0aGUgY29udHJvbGxlciB1c2VzIHByb3BlciB2YWxpZGF0aW9uXG4gICAgICBjb25zdCB2YWxpZGF0aW9uUGlwZSA9IG5ldyBab2RWYWxpZGF0aW9uUGlwZSh7fSBhcyBhbnkpO1xuICAgICAgZXhwZWN0KHZhbGlkYXRpb25QaXBlKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhcHBseSByYXRlIGxpbWl0aW5nIHRocm91Z2ggVGhyb3R0bGVyR3VhcmQnLCAoKSA9PiB7XG4gICAgICAvLyBUZXN0IHRoYXQgdGhyb3R0bGluZyBpcyBjb25maWd1cmVkXG4gICAgICBjb25zdCByZWdpc3Rlck1ldGFkYXRhID0gUmVmbGVjdC5nZXRNZXRhZGF0YSgnX190aHJvdHRsZXJfb3B0aW9uc19fJywgY29udHJvbGxlci5yZWdpc3Rlcik7XG4gICAgICBjb25zdCBsb2dpbk1ldGFkYXRhID0gUmVmbGVjdC5nZXRNZXRhZGF0YSgnX190aHJvdHRsZXJfb3B0aW9uc19fJywgY29udHJvbGxlci5sb2dpbik7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZWdpc3Rlck1ldGFkYXRhKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGxvZ2luTWV0YWRhdGEpLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlcXVpcmUgYXV0aGVudGljYXRpb24gZm9yIHByb3RlY3RlZCBlbmRwb2ludHMnLCAoKSA9PiB7XG4gICAgICAvLyBUZXN0IHRoYXQgcHJvdGVjdGVkIGVuZHBvaW50cyBoYXZlIEp3dEF1dGhHdWFyZFxuICAgICAgY29uc3QgcHJvdGVjdGVkTWV0aG9kcyA9IFsnZ2V0UHJvZmlsZScsICdnZXRBbGxBcHBsaWNhdGlvbnMnLCAnZ2V0QXBwbGljYXRpb25CeUlkJywgJ3VwZGF0ZUFwcGxpY2F0aW9uU3RhdHVzJywgJ2dldEFwcGxpY2F0aW9uRmlsZXMnXTtcbiAgICAgIFxuICAgICAgcHJvdGVjdGVkTWV0aG9kcy5mb3JFYWNoKG1ldGhvZCA9PiB7XG4gICAgICAgIGNvbnN0IGd1YXJkcyA9IFJlZmxlY3QuZ2V0TWV0YWRhdGEoJ19fZ3VhcmRzX18nLCBjb250cm9sbGVyW21ldGhvZCBhcyBrZXlvZiBUaGVyYXBpc3RBdXRoQ29udHJvbGxlcl0pO1xuICAgICAgICBleHBlY3QoZ3VhcmRzKS50b0JlRGVmaW5lZCgpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFsbG93IHB1YmxpYyBhY2Nlc3MgdG8gcHVibGljIGVuZHBvaW50cycsICgpID0+IHtcbiAgICAgIC8vIFRlc3QgdGhhdCBwdWJsaWMgZW5kcG9pbnRzIGFyZSBtYXJrZWQgYXMgcHVibGljXG4gICAgICBjb25zdCBwdWJsaWNNZXRob2RzID0gWydyZWdpc3RlcicsICdsb2dpbiddO1xuICAgICAgXG4gICAgICBwdWJsaWNNZXRob2RzLmZvckVhY2gobWV0aG9kID0+IHtcbiAgICAgICAgY29uc3QgcHVibGljTWV0YWRhdGEgPSBSZWZsZWN0LmdldE1ldGFkYXRhKCdpc1B1YmxpYycsIGNvbnRyb2xsZXJbbWV0aG9kIGFzIGtleW9mIFRoZXJhcGlzdEF1dGhDb250cm9sbGVyXSk7XG4gICAgICAgIGV4cGVjdChwdWJsaWNNZXRhZGF0YSkudG9CZVRydXRoeSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdSb2xlLWJhc2VkIEFjY2VzcyBDb250cm9sJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgdGVzdCByb2xlLWJhc2VkIGFjY2VzcyBmb3IgYWRtaW4gZW5kcG9pbnRzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gVGVzdCB0aGF0IGFkbWluIGVuZHBvaW50cyByZXF1aXJlIGFkbWluIHJvbGVcbiAgICAgIGF3YWl0IFJvbGVCYXNlZFRlc3RVdGlscy50ZXN0V2l0aFJvbGVzKFxuICAgICAgICBhc3luYyAodXNlcklkOiBzdHJpbmcsIHJvbGU6IHN0cmluZykgPT4ge1xuICAgICAgICAgIC8vIE1vY2sgdGhlIGF1dGggZ3VhcmQgdG8gcmV0dXJuIHRoZSBzcGVjaWZpYyByb2xlXG4gICAgICAgICAgbW9ja0p3dEF1dGhHdWFyZC5jYW5BY3RpdmF0ZS5tb2NrUmV0dXJuVmFsdWUocm9sZSA9PT0gJ2FkbWluJyk7XG4gICAgICAgICAgXG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IGNvbnRyb2xsZXIuZ2V0QWxsQXBwbGljYXRpb25zKHJvbGUpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBjbGllbnQ6IGZhbHNlLFxuICAgICAgICAgIHRoZXJhcGlzdDogZmFsc2UsXG4gICAgICAgICAgYWRtaW46IHRydWUsXG4gICAgICAgICAgbW9kZXJhdG9yOiBmYWxzZSxcbiAgICAgICAgfSxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIHRoZXJhcGlzdC1zcGVjaWZpYyBmdW5jdGlvbmFsaXR5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gVGVzdCB0aGF0IHRoZXJhcGlzdC1zcGVjaWZpYyBlbmRwb2ludHMgd29yayBmb3IgdGhlcmFwaXN0c1xuICAgICAgY29uc3QgdGhlcmFwaXN0Q29udGV4dCA9IE1vY2tCdWlsZGVyLmNyZWF0ZUF1dGhDb250ZXh0KCd0aGVyYXBpc3QnKTtcbiAgICAgIFxuICAgICAgamVzdC5zcHlPbih0aGVyYXBpc3RBdXRoU2VydmljZSwgJ2dldFRoZXJhcGlzdFByb2ZpbGUnKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVGhlcmFwaXN0VXNlcik7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0UHJvZmlsZSh0aGVyYXBpc3RDb250ZXh0LnVzZXJJZCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QocmVzdWx0LnJvbGUpLnRvQmUoJ3RoZXJhcGlzdCcpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRXJyb3IgSGFuZGxpbmcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbmV0d29yayBlcnJvcnMgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IG5ldHdvcmtFcnJvciA9IG5ldyBFcnJvcignTmV0d29yayB0aW1lb3V0Jyk7XG4gICAgICBqZXN0LnNweU9uKHRoZXJhcGlzdEF1dGhTZXJ2aWNlLCAnZ2V0VGhlcmFwaXN0UHJvZmlsZScpLm1vY2tSZWplY3RlZFZhbHVlKG5ldHdvcmtFcnJvcik7XG5cbiAgICAgIC8vIEFjdCAmIEFzc2VydFxuICAgICAgYXdhaXQgZXhwZWN0KGNvbnRyb2xsZXIuZ2V0UHJvZmlsZShURVNUX1VTRVJfSURTLlRIRVJBUElTVCkpLnJlamVjdHMudG9UaHJvdyhuZXR3b3JrRXJyb3IpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgdmFsaWRhdGlvbiBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBUZXN0IHRoYXQgaW52YWxpZCBkYXRhIHdvdWxkIGJlIGNhdWdodCBieSB0aGUgdmFsaWRhdGlvbiBwaXBlXG4gICAgICBjb25zdCBpbnZhbGlkRGF0YSA9IHtcbiAgICAgICAgZW1haWw6ICdpbnZhbGlkLWVtYWlsJyxcbiAgICAgICAgcGFzc3dvcmQ6ICcxMjMnLCAvLyBUb28gc2hvcnRcbiAgICAgICAgZmlyc3ROYW1lOiAnJyxcbiAgICAgICAgbGFzdE5hbWU6ICcnLFxuICAgICAgfTtcblxuICAgICAgLy8gSW4gYSByZWFsIHNjZW5hcmlvLCB0aGlzIHdvdWxkIHRocm93IGEgdmFsaWRhdGlvbiBlcnJvclxuICAgICAgLy8gVGhlIHBpcGUgd291bGQgY2F0Y2ggdGhpcyBiZWZvcmUgaXQgcmVhY2hlcyB0aGUgY29udHJvbGxlclxuICAgICAgZXhwZWN0KCgpID0+IHtcbiAgICAgICAgLy8gVGhpcyB3b3VsZCBiZSBoYW5kbGVkIGJ5IFpvZFZhbGlkYXRpb25QaXBlXG4gICAgICAgIC8vIGFuZCB3b3VsZCB0aHJvdyBhIEJhZFJlcXVlc3RFeGNlcHRpb25cbiAgICAgIH0pLm5vdC50b1Rocm93KCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdJbnRlZ3JhdGlvbiBUZXN0cycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBjb21wbGV0ZSB0aGVyYXBpc3QgcmVnaXN0cmF0aW9uIHdvcmtmbG93JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgcmVnaXN0cmF0aW9uRHRvID0ge1xuICAgICAgICBlbWFpbDogJ2ludGVncmF0aW9uQGV4YW1wbGUuY29tJyxcbiAgICAgICAgcGFzc3dvcmQ6ICdTZWN1cmVQYXNzMTIzIScsXG4gICAgICAgIGZpcnN0TmFtZTogJ0RyLiBJbnRlZ3JhdGlvbicsXG4gICAgICAgIGxhc3ROYW1lOiAnVGVzdCcsXG4gICAgICB9O1xuXG4gICAgICBqZXN0LnNweU9uKHRoZXJhcGlzdEF1dGhTZXJ2aWNlLCAncmVnaXN0ZXJUaGVyYXBpc3QnKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUmVnaXN0cmF0aW9uUmVzdWx0KTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLnJlZ2lzdGVyKHJlZ2lzdHJhdGlvbkR0byk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQudXNlci5lbWFpbCkudG9CZShtb2NrVGhlcmFwaXN0VXNlci5lbWFpbCk7XG4gICAgICBleHBlY3QocmVzdWx0LmFjY2Vzc1Rva2VuKS50b0JlKG1vY2tUb2tlbnMuYWNjZXNzVG9rZW4pO1xuICAgICAgZXhwZWN0KHJlc3VsdC5yZWZyZXNoVG9rZW4pLnRvQmUobW9ja1Rva2Vucy5yZWZyZXNoVG9rZW4pO1xuICAgICAgZXhwZWN0KHJlc3VsdC5leHBpcmVzSW4pLnRvQmUobW9ja1Rva2Vucy5leHBpcmVzSW4pO1xuICAgICAgZXhwZWN0KHJlc3VsdC5tZXNzYWdlKS50b0JlKG1vY2tSZWdpc3RyYXRpb25SZXN1bHQubWVzc2FnZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBjb21wbGV0ZSB0aGVyYXBpc3QgbG9naW4gd29ya2Zsb3cnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBsb2dpbkR0byA9IHtcbiAgICAgICAgZW1haWw6IFRFU1RfRU1BSUxTLlRIRVJBUElTVCxcbiAgICAgICAgcGFzc3dvcmQ6ICdTZWN1cmVQYXNzMTIzIScsXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBtb2NrUmVxdWVzdCA9IHtcbiAgICAgICAgaXA6ICcxOTIuMTY4LjEuMScsXG4gICAgICAgIGdldDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnVGVzdCBVc2VyIEFnZW50JyksXG4gICAgICB9IGFzIGFueTtcblxuICAgICAgamVzdC5zcHlPbih0aGVyYXBpc3RBdXRoU2VydmljZSwgJ2xvZ2luVGhlcmFwaXN0JykubW9ja1Jlc29sdmVkVmFsdWUobW9ja0xvZ2luUmVzdWx0KTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmxvZ2luKGxvZ2luRHRvLCBtb2NrUmVxdWVzdCk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQudXNlci5lbWFpbCkudG9CZShtb2NrVGhlcmFwaXN0VXNlci5lbWFpbCk7XG4gICAgICBleHBlY3QocmVzdWx0LmFjY2Vzc1Rva2VuKS50b0JlKG1vY2tUb2tlbnMuYWNjZXNzVG9rZW4pO1xuICAgICAgZXhwZWN0KHJlc3VsdC5yZWZyZXNoVG9rZW4pLnRvQmUobW9ja1Rva2Vucy5yZWZyZXNoVG9rZW4pO1xuICAgICAgZXhwZWN0KHJlc3VsdC5leHBpcmVzSW4pLnRvQmUobW9ja1Rva2Vucy5leHBpcmVzSW4pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgY29tcGxldGUgYXBwbGljYXRpb24gc3VibWlzc2lvbiB3b3JrZmxvdycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IG1vY2tBcHBsaWNhdGlvblJlc3VsdCA9IHtcbiAgICAgICAgYXBwbGljYXRpb246IHsgdXNlcklkOiAndGVtcF8xMjM0NV90aGVyYXBpc3RfYXRfZXhhbXBsZS5jb20nIH0sXG4gICAgICAgIHVwbG9hZGVkRmlsZXM6IG1vY2tBcHBsaWNhdGlvbkZpbGVzLFxuICAgICAgfTtcblxuICAgICAgamVzdC5zcHlPbih0aGVyYXBpc3RBdXRoU2VydmljZSwgJ2NyZWF0ZUFwcGxpY2F0aW9uV2l0aERvY3VtZW50cycpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tBcHBsaWNhdGlvblJlc3VsdCk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5hcHBseVdpdGhEb2N1bWVudHMoXG4gICAgICAgIEpTT04uc3RyaW5naWZ5KG1vY2tBcHBsaWNhdGlvbkRhdGEpLFxuICAgICAgICBKU09OLnN0cmluZ2lmeSh7ICcwJzogJ2xpY2Vuc2UnLCAnMSc6ICdkaXBsb21hJyB9KSxcbiAgICAgICAgbW9ja0ZpbGVzLFxuICAgICAgKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5hcHBsaWNhdGlvbklkKS50b0JlKG1vY2tBcHBsaWNhdGlvblJlc3VsdC5hcHBsaWNhdGlvbi51c2VySWQpO1xuICAgICAgZXhwZWN0KHJlc3VsdC51cGxvYWRlZEZpbGVzKS50b0VxdWFsKG1vY2tBcHBsaWNhdGlvbkZpbGVzKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbXBsZXRlIGFkbWluIGFwcGxpY2F0aW9uIG1hbmFnZW1lbnQgd29ya2Zsb3cnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBtb2NrQXBwbGljYXRpb25zUmVzdWx0ID0ge1xuICAgICAgICBhcHBsaWNhdGlvbnM6IFttb2NrVGhlcmFwaXN0QXBwbGljYXRpb25dLFxuICAgICAgICB0b3RhbENvdW50OiAxLFxuICAgICAgICBwYWdlOiAxLFxuICAgICAgICB0b3RhbFBhZ2VzOiAxLFxuICAgICAgfTtcblxuICAgICAgamVzdC5zcHlPbih0aGVyYXBpc3RBdXRoU2VydmljZSwgJ2dldEFsbEFwcGxpY2F0aW9ucycpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tBcHBsaWNhdGlvbnNSZXN1bHQpO1xuICAgICAgamVzdC5zcHlPbih0aGVyYXBpc3RBdXRoU2VydmljZSwgJ2dldEFwcGxpY2F0aW9uQnlJZCcpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tUaGVyYXBpc3RBcHBsaWNhdGlvbik7XG5cbiAgICAgIC8vIEFjdCAtIEdldCBhbGwgYXBwbGljYXRpb25zXG4gICAgICBjb25zdCBhbGxBcHBsaWNhdGlvbnMgPSBhd2FpdCBjb250cm9sbGVyLmdldEFsbEFwcGxpY2F0aW9ucygnYWRtaW4nKTtcbiAgICAgIFxuICAgICAgLy8gQWN0IC0gR2V0IHNwZWNpZmljIGFwcGxpY2F0aW9uXG4gICAgICBjb25zdCBzcGVjaWZpY0FwcGxpY2F0aW9uID0gYXdhaXQgY29udHJvbGxlci5nZXRBcHBsaWNhdGlvbkJ5SWQoJ2FkbWluJywgJ2FwcC0xMjMnKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QoYWxsQXBwbGljYXRpb25zKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGFsbEFwcGxpY2F0aW9ucy5hcHBsaWNhdGlvbnMubGVuZ3RoKS50b0JlKDEpO1xuICAgICAgZXhwZWN0KGFsbEFwcGxpY2F0aW9ucy50b3RhbENvdW50KS50b0JlKDEpO1xuICAgICAgXG4gICAgICBleHBlY3Qoc3BlY2lmaWNBcHBsaWNhdGlvbikudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChzcGVjaWZpY0FwcGxpY2F0aW9uLmlkKS50b0JlKCdhcHAtMTIzJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdEYXRhIFZhbGlkYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSByZWdpc3RyYXRpb24gZGF0YSBzdHJ1Y3R1cmUnLCAoKSA9PiB7XG4gICAgICAvLyBUZXN0IHRoYXQgd2UncmUgdXNpbmcgdGhlIGNvcnJlY3QgRFRPIHN0cnVjdHVyZVxuICAgICAgY29uc3QgdmFsaWRSZWdpc3RyYXRpb25EYXRhID0ge1xuICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgICBwYXNzd29yZDogJ1NlY3VyZVBhc3MxMjMhJyxcbiAgICAgICAgZmlyc3ROYW1lOiAnRHIuIFRlc3QnLFxuICAgICAgICBsYXN0TmFtZTogJ1VzZXInLFxuICAgICAgfTtcblxuICAgICAgLy8gVmVyaWZ5IGFsbCByZXF1aXJlZCBmaWVsZHMgYXJlIHByZXNlbnRcbiAgICAgIGV4cGVjdCh2YWxpZFJlZ2lzdHJhdGlvbkRhdGEuZW1haWwpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QodmFsaWRSZWdpc3RyYXRpb25EYXRhLnBhc3N3b3JkKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHZhbGlkUmVnaXN0cmF0aW9uRGF0YS5maXJzdE5hbWUpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QodmFsaWRSZWdpc3RyYXRpb25EYXRhLmxhc3ROYW1lKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBsb2dpbiBkYXRhIHN0cnVjdHVyZScsICgpID0+IHtcbiAgICAgIC8vIFRlc3QgdGhhdCB3ZSdyZSB1c2luZyB0aGUgY29ycmVjdCBEVE8gc3RydWN0dXJlXG4gICAgICBjb25zdCB2YWxpZExvZ2luRGF0YSA9IHtcbiAgICAgICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcbiAgICAgICAgcGFzc3dvcmQ6ICdTZWN1cmVQYXNzMTIzIScsXG4gICAgICB9O1xuXG4gICAgICAvLyBWZXJpZnkgYWxsIHJlcXVpcmVkIGZpZWxkcyBhcmUgcHJlc2VudFxuICAgICAgZXhwZWN0KHZhbGlkTG9naW5EYXRhLmVtYWlsKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHZhbGlkTG9naW5EYXRhLnBhc3N3b3JkKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBhcHBsaWNhdGlvbiBkYXRhIHN0cnVjdHVyZScsICgpID0+IHtcbiAgICAgIC8vIFRlc3QgdGhhdCB3ZSdyZSB1c2luZyB0aGUgY29ycmVjdCBEVE8gc3RydWN0dXJlXG4gICAgICBjb25zdCB2YWxpZEFwcGxpY2F0aW9uRGF0YSA9IHtcbiAgICAgICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcbiAgICAgICAgZmlyc3ROYW1lOiAnRHIuIFRlc3QnLFxuICAgICAgICBsYXN0TmFtZTogJ1VzZXInLFxuICAgICAgICBsaWNlbnNlTnVtYmVyOiAnTElDMTIzNDU2JyxcbiAgICAgICAgc3BlY2lhbGl6YXRpb25zOiBbJ2FueGlldHknLCAnZGVwcmVzc2lvbiddLFxuICAgICAgICBlZHVjYXRpb246ICdQaEQgaW4gUHN5Y2hvbG9neScsXG4gICAgICAgIGV4cGVyaWVuY2U6ICc1IHllYXJzJyxcbiAgICAgIH07XG5cbiAgICAgIC8vIFZlcmlmeSBhbGwgcmVxdWlyZWQgZmllbGRzIGFyZSBwcmVzZW50XG4gICAgICBleHBlY3QodmFsaWRBcHBsaWNhdGlvbkRhdGEuZW1haWwpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QodmFsaWRBcHBsaWNhdGlvbkRhdGEuZmlyc3ROYW1lKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHZhbGlkQXBwbGljYXRpb25EYXRhLmxhc3ROYW1lKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHZhbGlkQXBwbGljYXRpb25EYXRhLmxpY2Vuc2VOdW1iZXIpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QodmFsaWRBcHBsaWNhdGlvbkRhdGEuc3BlY2lhbGl6YXRpb25zKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHZhbGlkQXBwbGljYXRpb25EYXRhLmVkdWNhdGlvbikudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdCh2YWxpZEFwcGxpY2F0aW9uRGF0YS5leHBlcmllbmNlKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUmVzcG9uc2UgRm9ybWF0IFZhbGlkYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gY29ycmVjdGx5IGZvcm1hdHRlZCByZWdpc3RyYXRpb24gcmVzcG9uc2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCByZWdpc3RlckR0byA9IHtcbiAgICAgICAgZW1haWw6ICdmb3JtYXRAZXhhbXBsZS5jb20nLFxuICAgICAgICBwYXNzd29yZDogJ1NlY3VyZVBhc3MxMjMhJyxcbiAgICAgICAgZmlyc3ROYW1lOiAnRHIuIEZvcm1hdCcsXG4gICAgICAgIGxhc3ROYW1lOiAnVGVzdCcsXG4gICAgICB9O1xuXG4gICAgICBqZXN0LnNweU9uKHRoZXJhcGlzdEF1dGhTZXJ2aWNlLCAncmVnaXN0ZXJUaGVyYXBpc3QnKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUmVnaXN0cmF0aW9uUmVzdWx0KTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLnJlZ2lzdGVyKHJlZ2lzdGVyRHRvKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgndXNlcicpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ2FjY2Vzc1Rva2VuJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgncmVmcmVzaFRva2VuJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgnZXhwaXJlc0luJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgnbWVzc2FnZScpO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0LnVzZXIpLnRvSGF2ZVByb3BlcnR5KCdpZCcpO1xuICAgICAgZXhwZWN0KHJlc3VsdC51c2VyKS50b0hhdmVQcm9wZXJ0eSgnZW1haWwnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQudXNlcikudG9IYXZlUHJvcGVydHkoJ2ZpcnN0TmFtZScpO1xuICAgICAgZXhwZWN0KHJlc3VsdC51c2VyKS50b0hhdmVQcm9wZXJ0eSgnbGFzdE5hbWUnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQudXNlcikudG9IYXZlUHJvcGVydHkoJ3JvbGUnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQudXNlcikudG9IYXZlUHJvcGVydHkoJ2VtYWlsVmVyaWZpZWQnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvcnJlY3RseSBmb3JtYXR0ZWQgbG9naW4gcmVzcG9uc2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBsb2dpbkR0byA9IHtcbiAgICAgICAgZW1haWw6IFRFU1RfRU1BSUxTLlRIRVJBUElTVCxcbiAgICAgICAgcGFzc3dvcmQ6ICdTZWN1cmVQYXNzMTIzIScsXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBtb2NrUmVxdWVzdCA9IHtcbiAgICAgICAgaXA6ICcxOTIuMTY4LjEuMScsXG4gICAgICAgIGdldDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnVGVzdCBVc2VyIEFnZW50JyksXG4gICAgICB9IGFzIGFueTtcblxuICAgICAgamVzdC5zcHlPbih0aGVyYXBpc3RBdXRoU2VydmljZSwgJ2xvZ2luVGhlcmFwaXN0JykubW9ja1Jlc29sdmVkVmFsdWUobW9ja0xvZ2luUmVzdWx0KTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmxvZ2luKGxvZ2luRHRvLCBtb2NrUmVxdWVzdCk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ3VzZXInKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdhY2Nlc3NUb2tlbicpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ3JlZnJlc2hUb2tlbicpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ2V4cGlyZXNJbicpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkubm90LnRvSGF2ZVByb3BlcnR5KCdtZXNzYWdlJyk7IC8vIExvZ2luIGRvZXNuJ3QgaW5jbHVkZSBtZXNzYWdlXG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBjb3JyZWN0bHkgZm9ybWF0dGVkIGFwcGxpY2F0aW9uIHJlc3BvbnNlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgbW9ja0FwcGxpY2F0aW9uUmVzdWx0ID0ge1xuICAgICAgICBhcHBsaWNhdGlvbjogeyB1c2VySWQ6ICd0ZW1wXzEyMzQ1X3RoZXJhcGlzdF9hdF9leGFtcGxlLmNvbScgfSxcbiAgICAgICAgdXBsb2FkZWRGaWxlczogbW9ja0FwcGxpY2F0aW9uRmlsZXMsXG4gICAgICB9O1xuXG4gICAgICBqZXN0LnNweU9uKHRoZXJhcGlzdEF1dGhTZXJ2aWNlLCAnY3JlYXRlQXBwbGljYXRpb25XaXRoRG9jdW1lbnRzJykubW9ja1Jlc29sdmVkVmFsdWUobW9ja0FwcGxpY2F0aW9uUmVzdWx0KTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmFwcGx5V2l0aERvY3VtZW50cyhcbiAgICAgICAgSlNPTi5zdHJpbmdpZnkobW9ja0FwcGxpY2F0aW9uRGF0YSksXG4gICAgICAgIEpTT04uc3RyaW5naWZ5KHsgJzAnOiAnbGljZW5zZScsICcxJzogJ2RpcGxvbWEnIH0pLFxuICAgICAgICBtb2NrRmlsZXMsXG4gICAgICApO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdzdWNjZXNzJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgnbWVzc2FnZScpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ2FwcGxpY2F0aW9uSWQnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCd1cGxvYWRlZEZpbGVzJyk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQudXBsb2FkZWRGaWxlcykudG9CZUluc3RhbmNlT2YoQXJyYXkpO1xuICAgIH0pO1xuICB9KTtcbn0pOyJdLCJ2ZXJzaW9uIjozfQ==