c4a4766d6eae34547a44b769b35a687b
"use strict";
/**
 * Comprehensive Test Suite for AdminUserController
 * Tests admin functionality for managing users, suspensions, and user queries
 */
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const common_1 = require("@nestjs/common");
const admin_user_controller_1 = require("./admin-user.controller");
const admin_service_1 = require("../admin.service");
const jwt_auth_guard_1 = require("../../auth/guards/jwt-auth.guard");
const admin_auth_guard_1 = require("../../auth/guards/admin-auth.guard");
const enhanced_test_helpers_1 = require("../../test-utils/enhanced-test-helpers");
const index_1 = require("../../test-utils/index");
describe('AdminUserController', () => {
    let controller;
    let adminService;
    let module;
    // Mock AdminService
    const mockAdminService = {
        getAllUsers: jest.fn(),
        getUser: jest.fn(),
        suspendUser: jest.fn(),
        unsuspendUser: jest.fn(),
    };
    // Mock Guards
    const mockJwtAuthGuard = {
        canActivate: jest.fn().mockReturnValue(true),
    };
    const mockAdminAuthGuard = {
        canActivate: jest.fn().mockReturnValue(true),
    };
    // Test data
    const mockUser = {
        id: index_1.TEST_USER_IDS.CLIENT,
        email: index_1.TEST_EMAILS.CLIENT,
        firstName: 'John',
        lastName: 'Doe',
        role: 'client',
        status: 'active',
        isEmailVerified: true,
        lastLoginAt: new Date('2024-02-14T10:00:00Z'),
        createdAt: new Date('2024-01-01T00:00:00Z'),
        updatedAt: new Date('2024-02-14T10:00:00Z'),
        profile: {
            dateOfBirth: new Date('1990-05-15'),
            phoneNumber: '+1234567890',
            emergencyContact: {
                name: 'Jane Doe',
                phone: '+1234567891',
                relationship: 'spouse',
            },
        },
        preferences: {
            therapistGender: 'no-preference',
            sessionType: 'video',
            language: 'english',
        },
        suspensionHistory: [],
    };
    const mockTherapist = {
        id: index_1.TEST_USER_IDS.THERAPIST,
        email: index_1.TEST_EMAILS.THERAPIST,
        firstName: 'Dr. Sarah',
        lastName: 'Smith',
        role: 'therapist',
        status: 'active',
        isEmailVerified: true,
        lastLoginAt: new Date('2024-02-14T08:00:00Z'),
        createdAt: new Date('2024-01-15T00:00:00Z'),
        updatedAt: new Date('2024-02-14T08:00:00Z'),
        profile: {
            licenseNumber: 'PSY123456',
            specializations: ['anxiety', 'depression'],
            yearsOfExperience: 8,
            hourlyRate: 150,
        },
        suspensionHistory: [],
    };
    const mockUsersList = {
        users: [mockUser, mockTherapist],
        pagination: {
            page: 1,
            limit: 20,
            total: 2,
            totalPages: 1,
            hasNext: false,
            hasPrev: false,
        },
        summary: {
            totalUsers: 2,
            activeUsers: 2,
            suspendedUsers: 0,
            roleBreakdown: {
                client: 1,
                therapist: 1,
                moderator: 0,
                admin: 0,
            },
        },
    };
    const mockSuspendedUser = {
        ...mockUser,
        status: 'suspended',
        suspension: {
            reason: 'Policy violation',
            suspendedAt: new Date(),
            suspendedBy: index_1.TEST_USER_IDS.ADMIN,
            duration: 30, // days
            expiresAt: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000),
        },
    };
    beforeEach(async () => {
        module = await testing_1.Test.createTestingModule({
            controllers: [admin_user_controller_1.AdminUserController],
            providers: [
                {
                    provide: admin_service_1.AdminService,
                    useValue: mockAdminService,
                },
            ],
        })
            .overrideGuard(jwt_auth_guard_1.JwtAuthGuard)
            .useValue(mockJwtAuthGuard)
            .overrideGuard(admin_auth_guard_1.AdminAuthGuard)
            .useValue(mockAdminAuthGuard)
            .compile();
        controller = module.get(admin_user_controller_1.AdminUserController);
        adminService = module.get(admin_service_1.AdminService);
    });
    afterEach(() => {
        jest.clearAllMocks();
    });
    describe('Controller Initialization', () => {
        it('should be defined', () => {
            expect(controller).toBeDefined();
        });
        it('should have adminService injected', () => {
            expect(adminService).toBeDefined();
        });
    });
    describe('Security Guards', () => {
        it('should be protected by JwtAuthGuard and AdminAuthGuard', () => {
            const guards = Reflect.getMetadata('__guards__', admin_user_controller_1.AdminUserController);
            expect(guards).toContain(jwt_auth_guard_1.JwtAuthGuard);
            expect(guards).toContain(admin_auth_guard_1.AdminAuthGuard);
        });
        it('should have proper route decorators', () => {
            const controllerMetadata = Reflect.getMetadata('path', admin_user_controller_1.AdminUserController);
            expect(controllerMetadata).toBe('admin/users');
        });
        it('should have AdminOnly decorators on all methods', () => {
            const methods = ['getAllUsers', 'getUser', 'suspendUser', 'unsuspendUser'];
            methods.forEach(method => {
                const metadata = Reflect.getMetadata('admin_only', controller[method]);
                expect(metadata).toBeTruthy();
            });
        });
    });
    describe('GET /admin/users', () => {
        const mockQuery = {
            page: 1,
            limit: 20,
            role: 'client',
            search: 'john',
            status: 'active',
            sortBy: 'createdAt',
            sortOrder: 'desc',
        };
        it('should get all users successfully', async () => {
            mockAdminService.getAllUsers.mockResolvedValue(mockUsersList);
            const result = await controller.getAllUsers(index_1.TEST_USER_IDS.ADMIN, mockQuery);
            expect(result).toEqual(mockUsersList);
            expect(adminService.getAllUsers).toHaveBeenCalledWith({
                role: mockQuery.role,
                page: mockQuery.page,
                limit: mockQuery.limit,
                search: mockQuery.search,
                status: mockQuery.status,
                sortBy: mockQuery.sortBy,
                sortOrder: mockQuery.sortOrder,
            });
        });
        it('should get users without filters', async () => {
            const emptyQuery = {};
            mockAdminService.getAllUsers.mockResolvedValue(mockUsersList);
            const result = await controller.getAllUsers(index_1.TEST_USER_IDS.ADMIN, emptyQuery);
            expect(result).toEqual(mockUsersList);
            expect(adminService.getAllUsers).toHaveBeenCalledWith({
                role: undefined,
                page: undefined,
                limit: undefined,
                search: undefined,
                status: undefined,
                sortBy: undefined,
                sortOrder: undefined,
            });
        });
        it('should filter by role correctly', async () => {
            const roleQueries = ['client', 'therapist', 'moderator', 'admin'];
            for (const role of roleQueries) {
                const query = { role };
                const filteredUsers = {
                    ...mockUsersList,
                    users: mockUsersList.users.filter(user => user.role === role),
                };
                mockAdminService.getAllUsers.mockResolvedValue(filteredUsers);
                const result = await controller.getAllUsers(index_1.TEST_USER_IDS.ADMIN, query);
                expect(result.users.every(user => user.role === role)).toBe(true);
                expect(adminService.getAllUsers).toHaveBeenCalledWith(expect.objectContaining({ role }));
            }
        });
        it('should filter by status correctly', async () => {
            const statusQueries = ['active', 'suspended', 'inactive'];
            for (const status of statusQueries) {
                const query = { status };
                const filteredUsers = {
                    ...mockUsersList,
                    users: mockUsersList.users.filter(user => user.status === status),
                };
                mockAdminService.getAllUsers.mockResolvedValue(filteredUsers);
                const result = await controller.getAllUsers(index_1.TEST_USER_IDS.ADMIN, query);
                expect(adminService.getAllUsers).toHaveBeenCalledWith(expect.objectContaining({ status }));
            }
        });
        it('should handle search functionality', async () => {
            const searchQueries = ['john', 'doe', 'sarah', 'smith', 'test@example.com'];
            for (const search of searchQueries) {
                const query = { search };
                const searchResults = {
                    ...mockUsersList,
                    users: mockUsersList.users.filter(user => user.firstName.toLowerCase().includes(search.toLowerCase()) ||
                        user.lastName.toLowerCase().includes(search.toLowerCase()) ||
                        user.email.toLowerCase().includes(search.toLowerCase())),
                };
                mockAdminService.getAllUsers.mockResolvedValue(searchResults);
                const result = await controller.getAllUsers(index_1.TEST_USER_IDS.ADMIN, query);
                expect(adminService.getAllUsers).toHaveBeenCalledWith(expect.objectContaining({ search }));
            }
        });
        it('should handle pagination correctly', async () => {
            const paginatedQuery = { page: 2, limit: 10 };
            const paginatedResult = {
                ...mockUsersList,
                pagination: {
                    page: 2,
                    limit: 10,
                    total: 50,
                    totalPages: 5,
                    hasNext: true,
                    hasPrev: true,
                },
            };
            mockAdminService.getAllUsers.mockResolvedValue(paginatedResult);
            const result = await controller.getAllUsers(index_1.TEST_USER_IDS.ADMIN, paginatedQuery);
            expect(result.pagination.page).toBe(2);
            expect(result.pagination.limit).toBe(10);
            expect(result.pagination.totalPages).toBe(5);
        });
        it('should handle sorting options', async () => {
            const sortOptions = [
                { sortBy: 'createdAt', sortOrder: 'desc' },
                { sortBy: 'lastLoginAt', sortOrder: 'asc' },
                { sortBy: 'email', sortOrder: 'asc' },
                { sortBy: 'status', sortOrder: 'desc' },
            ];
            for (const sortOption of sortOptions) {
                const query = sortOption;
                mockAdminService.getAllUsers.mockResolvedValue(mockUsersList);
                const result = await controller.getAllUsers(index_1.TEST_USER_IDS.ADMIN, query);
                expect(adminService.getAllUsers).toHaveBeenCalledWith(expect.objectContaining(sortOption));
            }
        });
        it('should handle empty results', async () => {
            const emptyResult = {
                users: [],
                pagination: { page: 1, limit: 20, total: 0, totalPages: 0, hasNext: false, hasPrev: false },
                summary: { totalUsers: 0, activeUsers: 0, suspendedUsers: 0, roleBreakdown: { client: 0, therapist: 0, moderator: 0, admin: 0 } },
            };
            mockAdminService.getAllUsers.mockResolvedValue(emptyResult);
            const result = await controller.getAllUsers(index_1.TEST_USER_IDS.ADMIN, {});
            expect(result.users).toEqual([]);
            expect(result.summary.totalUsers).toBe(0);
        });
        it('should handle service errors', async () => {
            const serviceError = new Error('Database connection failed');
            mockAdminService.getAllUsers.mockRejectedValue(serviceError);
            await expect(controller.getAllUsers(index_1.TEST_USER_IDS.ADMIN, {})).rejects.toThrow(common_1.HttpException);
            await expect(controller.getAllUsers(index_1.TEST_USER_IDS.ADMIN, {})).rejects.toThrow('Failed to retrieve users');
        });
        it('should log admin actions', async () => {
            const logSpy = jest.spyOn(controller['logger'], 'log');
            mockAdminService.getAllUsers.mockResolvedValue(mockUsersList);
            await controller.getAllUsers(index_1.TEST_USER_IDS.ADMIN, {});
            expect(logSpy).toHaveBeenCalledWith(`Admin ${index_1.TEST_USER_IDS.ADMIN} retrieving users`);
        });
    });
    describe('GET /admin/users/:id', () => {
        const userId = index_1.TEST_USER_IDS.CLIENT;
        it('should get user by id successfully', async () => {
            mockAdminService.getUser.mockResolvedValue(mockUser);
            const result = await controller.getUser(index_1.TEST_USER_IDS.ADMIN, userId);
            expect(result).toEqual(mockUser);
            expect(adminService.getUser).toHaveBeenCalledWith(userId);
        });
        it('should handle user not found', async () => {
            mockAdminService.getUser.mockResolvedValue(null);
            await expect(controller.getUser(index_1.TEST_USER_IDS.ADMIN, 'non-existent-id')).rejects.toThrow(common_1.HttpException);
            await expect(controller.getUser(index_1.TEST_USER_IDS.ADMIN, 'non-existent-id')).rejects.toThrow('User not found');
        });
        it('should return complete user details', async () => {
            const detailedUser = {
                ...mockUser,
                sessions: [
                    { id: 'session_1', date: new Date(), status: 'completed' },
                    { id: 'session_2', date: new Date(), status: 'scheduled' },
                ],
                tickets: [
                    { id: 'ticket_1', subject: 'Login issue', status: 'resolved' },
                ],
                activityLog: [
                    { action: 'login', timestamp: new Date(), ip: '192.168.1.1' },
                    { action: 'profile_update', timestamp: new Date(), ip: '192.168.1.1' },
                ],
            };
            mockAdminService.getUser.mockResolvedValue(detailedUser);
            const result = await controller.getUser(index_1.TEST_USER_IDS.ADMIN, userId);
            expect(result.sessions).toBeDefined();
            expect(result.tickets).toBeDefined();
            expect(result.activityLog).toBeDefined();
            expect(Array.isArray(result.sessions)).toBe(true);
            expect(Array.isArray(result.tickets)).toBe(true);
            expect(Array.isArray(result.activityLog)).toBe(true);
        });
        it('should handle service errors gracefully', async () => {
            const serviceError = new Error('Database error');
            mockAdminService.getUser.mockRejectedValue(serviceError);
            await expect(controller.getUser(index_1.TEST_USER_IDS.ADMIN, userId)).rejects.toThrow(common_1.HttpException);
            await expect(controller.getUser(index_1.TEST_USER_IDS.ADMIN, userId)).rejects.toThrow('Failed to retrieve user');
        });
        it('should log admin actions', async () => {
            const logSpy = jest.spyOn(controller['logger'], 'log');
            mockAdminService.getUser.mockResolvedValue(mockUser);
            await controller.getUser(index_1.TEST_USER_IDS.ADMIN, userId);
            expect(logSpy).toHaveBeenCalledWith(`Admin ${index_1.TEST_USER_IDS.ADMIN} retrieving user ${userId}`);
        });
        it('should handle different user roles', async () => {
            const userRoles = ['client', 'therapist', 'moderator', 'admin'];
            for (const role of userRoles) {
                const roleUser = { ...mockUser, role };
                mockAdminService.getUser.mockResolvedValue(roleUser);
                const result = await controller.getUser(index_1.TEST_USER_IDS.ADMIN, userId);
                expect(result.role).toBe(role);
            }
        });
    });
    describe('PUT /admin/users/:id/suspend', () => {
        const userId = index_1.TEST_USER_IDS.CLIENT;
        const suspensionData = {
            reason: 'Policy violation - inappropriate behavior',
            duration: 30, // 30 days
        };
        it('should suspend user successfully', async () => {
            mockAdminService.suspendUser.mockResolvedValue(mockSuspendedUser);
            const result = await controller.suspendUser(index_1.TEST_USER_IDS.ADMIN, userId, suspensionData);
            expect(result).toEqual(mockSuspendedUser);
            expect(result.status).toBe('suspended');
            expect(adminService.suspendUser).toHaveBeenCalledWith(userId, index_1.TEST_USER_IDS.ADMIN, suspensionData.reason, suspensionData.duration);
        });
        it('should suspend user without duration (permanent)', async () => {
            const permanentSuspension = { reason: 'Severe policy violation' };
            const permanentlySuspendedUser = {
                ...mockSuspendedUser,
                suspension: {
                    ...mockSuspendedUser.suspension,
                    duration: null,
                    expiresAt: null,
                },
            };
            mockAdminService.suspendUser.mockResolvedValue(permanentlySuspendedUser);
            const result = await controller.suspendUser(index_1.TEST_USER_IDS.ADMIN, userId, permanentSuspension);
            expect(result.suspension.duration).toBeNull();
            expect(result.suspension.expiresAt).toBeNull();
            expect(adminService.suspendUser).toHaveBeenCalledWith(userId, index_1.TEST_USER_IDS.ADMIN, permanentSuspension.reason, undefined);
        });
        it('should handle different suspension reasons', async () => {
            const suspensionReasons = [
                'Policy violation',
                'Inappropriate behavior',
                'Terms of service violation',
                'Security concerns',
                'Payment issues',
                'Abuse of platform',
            ];
            for (const reason of suspensionReasons) {
                const data = { reason, duration: 15 };
                const suspendedUser = {
                    ...mockSuspendedUser,
                    suspension: { ...mockSuspendedUser.suspension, reason },
                };
                mockAdminService.suspendUser.mockResolvedValue(suspendedUser);
                const result = await controller.suspendUser(index_1.TEST_USER_IDS.ADMIN, userId, data);
                expect(result.suspension.reason).toBe(reason);
            }
        });
        it('should handle different suspension durations', async () => {
            const durations = [1, 7, 14, 30, 90, 365]; // days
            for (const duration of durations) {
                const data = { reason: 'Policy violation', duration };
                const suspendedUser = {
                    ...mockSuspendedUser,
                    suspension: { ...mockSuspendedUser.suspension, duration },
                };
                mockAdminService.suspendUser.mockResolvedValue(suspendedUser);
                const result = await controller.suspendUser(index_1.TEST_USER_IDS.ADMIN, userId, data);
                expect(result.suspension.duration).toBe(duration);
            }
        });
        it('should handle user not found', async () => {
            const notFoundError = new Error('User not found');
            mockAdminService.suspendUser.mockRejectedValue(notFoundError);
            await expect(controller.suspendUser(index_1.TEST_USER_IDS.ADMIN, 'non-existent-id', suspensionData)).rejects.toThrow(common_1.HttpException);
            await expect(controller.suspendUser(index_1.TEST_USER_IDS.ADMIN, 'non-existent-id', suspensionData)).rejects.toThrow('Failed to suspend user');
        });
        it('should handle already suspended user', async () => {
            const alreadySuspendedError = new Error('User is already suspended');
            mockAdminService.suspendUser.mockRejectedValue(alreadySuspendedError);
            await expect(controller.suspendUser(index_1.TEST_USER_IDS.ADMIN, userId, suspensionData)).rejects.toThrow(common_1.HttpException);
        });
        it('should log admin actions', async () => {
            const logSpy = jest.spyOn(controller['logger'], 'log');
            mockAdminService.suspendUser.mockResolvedValue(mockSuspendedUser);
            await controller.suspendUser(index_1.TEST_USER_IDS.ADMIN, userId, suspensionData);
            expect(logSpy).toHaveBeenCalledWith(`Admin ${index_1.TEST_USER_IDS.ADMIN} suspending user ${userId}`);
        });
        it('should handle service errors', async () => {
            const serviceError = new Error('Database transaction failed');
            mockAdminService.suspendUser.mockRejectedValue(serviceError);
            await expect(controller.suspendUser(index_1.TEST_USER_IDS.ADMIN, userId, suspensionData)).rejects.toThrow(common_1.HttpException);
            await expect(controller.suspendUser(index_1.TEST_USER_IDS.ADMIN, userId, suspensionData)).rejects.toThrow('Failed to suspend user');
        });
    });
    describe('PUT /admin/users/:id/unsuspend', () => {
        const userId = index_1.TEST_USER_IDS.CLIENT;
        it('should unsuspend user successfully', async () => {
            const unsuspendedUser = {
                ...mockUser,
                status: 'active',
                suspensionHistory: [{
                        reason: 'Policy violation',
                        suspendedAt: new Date(Date.now() - 86400000), // 1 day ago
                        suspendedBy: index_1.TEST_USER_IDS.ADMIN,
                        unsuspendedAt: new Date(),
                        unsuspendedBy: index_1.TEST_USER_IDS.ADMIN,
                    }],
            };
            mockAdminService.unsuspendUser.mockResolvedValue(unsuspendedUser);
            const result = await controller.unsuspendUser(index_1.TEST_USER_IDS.ADMIN, userId);
            expect(result).toEqual(unsuspendedUser);
            expect(result.status).toBe('active');
            expect(adminService.unsuspendUser).toHaveBeenCalledWith(userId, index_1.TEST_USER_IDS.ADMIN);
        });
        it('should handle user not found', async () => {
            const notFoundError = new Error('User not found');
            mockAdminService.unsuspendUser.mockRejectedValue(notFoundError);
            await expect(controller.unsuspendUser(index_1.TEST_USER_IDS.ADMIN, 'non-existent-id')).rejects.toThrow(common_1.HttpException);
            await expect(controller.unsuspendUser(index_1.TEST_USER_IDS.ADMIN, 'non-existent-id')).rejects.toThrow('Failed to unsuspend user');
        });
        it('should handle user not suspended', async () => {
            const notSuspendedError = new Error('User is not suspended');
            mockAdminService.unsuspendUser.mockRejectedValue(notSuspendedError);
            await expect(controller.unsuspendUser(index_1.TEST_USER_IDS.ADMIN, userId)).rejects.toThrow(common_1.HttpException);
        });
        it('should log admin actions', async () => {
            const logSpy = jest.spyOn(controller['logger'], 'log');
            const unsuspendedUser = { ...mockUser, status: 'active' };
            mockAdminService.unsuspendUser.mockResolvedValue(unsuspendedUser);
            await controller.unsuspendUser(index_1.TEST_USER_IDS.ADMIN, userId);
            expect(logSpy).toHaveBeenCalledWith(`Admin ${index_1.TEST_USER_IDS.ADMIN} unsuspending user ${userId}`);
        });
        it('should handle service errors', async () => {
            const serviceError = new Error('Database update failed');
            mockAdminService.unsuspendUser.mockRejectedValue(serviceError);
            await expect(controller.unsuspendUser(index_1.TEST_USER_IDS.ADMIN, userId)).rejects.toThrow(common_1.HttpException);
            await expect(controller.unsuspendUser(index_1.TEST_USER_IDS.ADMIN, userId)).rejects.toThrow('Failed to unsuspend user');
        });
        it('should restore user privileges after unsuspension', async () => {
            const unsuspendedUser = {
                ...mockUser,
                status: 'active',
                privileges: {
                    canLogin: true,
                    canBookSessions: true,
                    canAccessCommunity: true,
                    canSendMessages: true,
                },
                suspensionHistory: [{
                        reason: 'Policy violation',
                        suspendedAt: new Date(Date.now() - 86400000),
                        suspendedBy: index_1.TEST_USER_IDS.ADMIN,
                        unsuspendedAt: new Date(),
                        unsuspendedBy: index_1.TEST_USER_IDS.ADMIN,
                    }],
            };
            mockAdminService.unsuspendUser.mockResolvedValue(unsuspendedUser);
            const result = await controller.unsuspendUser(index_1.TEST_USER_IDS.ADMIN, userId);
            expect(result.privileges.canLogin).toBe(true);
            expect(result.privileges.canBookSessions).toBe(true);
            expect(result.privileges.canAccessCommunity).toBe(true);
            expect(result.privileges.canSendMessages).toBe(true);
        });
    });
    describe('Error Handling', () => {
        it('should handle service unavailable scenarios', async () => {
            const serviceError = new Error('Service temporarily unavailable');
            mockAdminService.getAllUsers.mockRejectedValue(serviceError);
            await expect(controller.getAllUsers(index_1.TEST_USER_IDS.ADMIN, {})).rejects.toThrow(common_1.HttpException);
        });
        it('should handle database connection errors', async () => {
            const dbError = new Error('Database connection failed');
            mockAdminService.getUser.mockRejectedValue(dbError);
            await expect(controller.getUser(index_1.TEST_USER_IDS.ADMIN, index_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.HttpException);
        });
        it('should handle validation errors', async () => {
            const validationError = new Error('Invalid user data');
            mockAdminService.suspendUser.mockRejectedValue(validationError);
            await expect(controller.suspendUser(index_1.TEST_USER_IDS.ADMIN, index_1.TEST_USER_IDS.CLIENT, { reason: '' })).rejects.toThrow(common_1.HttpException);
        });
        it('should preserve HttpExceptions from service layer', async () => {
            const httpException = new common_1.HttpException('User not found', common_1.HttpStatus.NOT_FOUND);
            mockAdminService.getUser.mockRejectedValue(httpException);
            await expect(controller.getUser(index_1.TEST_USER_IDS.ADMIN, index_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(httpException);
        });
    });
    describe('Response Format Validation', () => {
        it('should return properly formatted users list response', async () => {
            mockAdminService.getAllUsers.mockResolvedValue(mockUsersList);
            const result = await controller.getAllUsers(index_1.TEST_USER_IDS.ADMIN, {});
            expect(result).toHaveProperty('users');
            expect(result).toHaveProperty('pagination');
            expect(result).toHaveProperty('summary');
            expect(Array.isArray(result.users)).toBe(true);
            result.users.forEach((user) => {
                enhanced_test_helpers_1.TestAssertions.expectValidEntity(user, ['id', 'email', 'firstName', 'lastName', 'role', 'status']);
                expect(['client', 'therapist', 'moderator', 'admin']).toContain(user.role);
                expect(['active', 'suspended', 'inactive']).toContain(user.status);
            });
        });
        it('should return properly formatted user details response', async () => {
            mockAdminService.getUser.mockResolvedValue(mockUser);
            const result = await controller.getUser(index_1.TEST_USER_IDS.ADMIN, index_1.TEST_USER_IDS.CLIENT);
            enhanced_test_helpers_1.TestAssertions.expectValidEntity(result, ['id', 'email', 'firstName', 'lastName', 'role', 'status']);
            expect(result.isEmailVerified).toBeDefined();
            expect(typeof result.isEmailVerified).toBe('boolean');
            expect(result.createdAt).toBeInstanceOf(Date);
            expect(result.updatedAt).toBeInstanceOf(Date);
        });
        it('should return properly formatted suspension response', async () => {
            mockAdminService.suspendUser.mockResolvedValue(mockSuspendedUser);
            const result = await controller.suspendUser(index_1.TEST_USER_IDS.ADMIN, index_1.TEST_USER_IDS.CLIENT, {
                reason: 'Policy violation',
                duration: 30,
            });
            expect(result.status).toBe('suspended');
            expect(result.suspension).toBeDefined();
            expect(result.suspension.reason).toBeDefined();
            expect(result.suspension.suspendedAt).toBeInstanceOf(Date);
            expect(result.suspension.suspendedBy).toBe(index_1.TEST_USER_IDS.ADMIN);
        });
    });
    describe('Integration Tests', () => {
        it('should handle complete user management workflow', async () => {
            // Get user details
            mockAdminService.getUser.mockResolvedValue(mockUser);
            const user = await controller.getUser(index_1.TEST_USER_IDS.ADMIN, index_1.TEST_USER_IDS.CLIENT);
            expect(user).toBeDefined();
            expect(user.status).toBe('active');
            // Suspend user
            mockAdminService.suspendUser.mockResolvedValue(mockSuspendedUser);
            const suspendedUser = await controller.suspendUser(index_1.TEST_USER_IDS.ADMIN, index_1.TEST_USER_IDS.CLIENT, {
                reason: 'Policy violation',
                duration: 30,
            });
            expect(suspendedUser.status).toBe('suspended');
            // Unsuspend user
            const unsuspendedUser = { ...mockUser, status: 'active' };
            mockAdminService.unsuspendUser.mockResolvedValue(unsuspendedUser);
            const restoredUser = await controller.unsuspendUser(index_1.TEST_USER_IDS.ADMIN, index_1.TEST_USER_IDS.CLIENT);
            expect(restoredUser.status).toBe('active');
        });
        it('should handle user search and filtering workflow', async () => {
            // Search for users by name
            const searchResults = {
                ...mockUsersList,
                users: [mockUser],
            };
            mockAdminService.getAllUsers.mockResolvedValue(searchResults);
            const searchResult = await controller.getAllUsers(index_1.TEST_USER_IDS.ADMIN, { search: 'john' });
            expect(searchResult.users).toHaveLength(1);
            // Filter by role
            const roleResults = {
                ...mockUsersList,
                users: [mockTherapist],
            };
            mockAdminService.getAllUsers.mockResolvedValue(roleResults);
            const roleResult = await controller.getAllUsers(index_1.TEST_USER_IDS.ADMIN, { role: 'therapist' });
            expect(roleResult.users.every(user => user.role === 'therapist')).toBe(true);
            // Filter by status
            const statusResults = {
                ...mockUsersList,
                users: mockUsersList.users.filter(user => user.status === 'active'),
            };
            mockAdminService.getAllUsers.mockResolvedValue(statusResults);
            const statusResult = await controller.getAllUsers(index_1.TEST_USER_IDS.ADMIN, { status: 'active' });
            expect(statusResult.users.every(user => user.status === 'active')).toBe(true);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL2FkbWluL2NvbnRyb2xsZXJzL2FkbWluLXVzZXIuY29udHJvbGxlci5zcGVjLnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7O0dBR0c7O0FBRUgsNkNBQXNEO0FBQ3RELDJDQUF1SDtBQUN2SCxtRUFBOEQ7QUFDOUQsb0RBQWdEO0FBQ2hELHFFQUFnRTtBQUNoRSx5RUFBb0U7QUFHcEUsa0ZBQXdHO0FBQ3hHLGtEQUFvRTtBQUVwRSxRQUFRLENBQUMscUJBQXFCLEVBQUUsR0FBRyxFQUFFO0lBQ25DLElBQUksVUFBK0IsQ0FBQztJQUNwQyxJQUFJLFlBQTBCLENBQUM7SUFDL0IsSUFBSSxNQUFxQixDQUFDO0lBRTFCLG9CQUFvQjtJQUNwQixNQUFNLGdCQUFnQixHQUFHO1FBQ3ZCLFdBQVcsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ3RCLE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2xCLFdBQVcsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ3RCLGFBQWEsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0tBQ3pCLENBQUM7SUFFRixjQUFjO0lBQ2QsTUFBTSxnQkFBZ0IsR0FBRztRQUN2QixXQUFXLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUM7S0FDN0MsQ0FBQztJQUVGLE1BQU0sa0JBQWtCLEdBQUc7UUFDekIsV0FBVyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDO0tBQzdDLENBQUM7SUFFRixZQUFZO0lBQ1osTUFBTSxRQUFRLEdBQUc7UUFDZixFQUFFLEVBQUUscUJBQWEsQ0FBQyxNQUFNO1FBQ3hCLEtBQUssRUFBRSxtQkFBVyxDQUFDLE1BQU07UUFDekIsU0FBUyxFQUFFLE1BQU07UUFDakIsUUFBUSxFQUFFLEtBQUs7UUFDZixJQUFJLEVBQUUsUUFBUTtRQUNk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QUUsYUFBYSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsTUFBTSxLQUFLLFFBQVEsQ0FBQzthQUNwRSxDQUFDO1lBQ0YsZ0JBQWdCLENBQUMsV0FBVyxDQUFDLGlCQUFpQixDQUFDLGFBQWEsQ0FBQyxDQUFDO1lBQzlELE1BQU0sWUFBWSxHQUFHLE1BQU0sVUFBVSxDQUFDLFdBQVcsQ0FBQyxxQkFBYSxDQUFDLEtBQUssRUFBRSxFQUFFLE1BQU0sRUFBRSxRQUFRLEVBQUUsQ0FBQyxDQUFDO1lBQzdGLE1BQU0sQ0FBQyxZQUFZLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxNQUFNLEtBQUssUUFBUSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDaEYsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9ob21lL3dldG9vYS9Eb2N1bWVudHMvY29kZS9wcm9qZWN0cy9tZW50YXJhL21lbnRhcmEtYXBpL3NyYy9hZG1pbi9jb250cm9sbGVycy9hZG1pbi11c2VyLmNvbnRyb2xsZXIuc3BlYy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvbXByZWhlbnNpdmUgVGVzdCBTdWl0ZSBmb3IgQWRtaW5Vc2VyQ29udHJvbGxlclxuICogVGVzdHMgYWRtaW4gZnVuY3Rpb25hbGl0eSBmb3IgbWFuYWdpbmcgdXNlcnMsIHN1c3BlbnNpb25zLCBhbmQgdXNlciBxdWVyaWVzXG4gKi9cblxuaW1wb3J0IHsgVGVzdCwgVGVzdGluZ01vZHVsZSB9IGZyb20gJ0BuZXN0anMvdGVzdGluZyc7XG5pbXBvcnQgeyBCYWRSZXF1ZXN0RXhjZXB0aW9uLCBOb3RGb3VuZEV4Y2VwdGlvbiwgRm9yYmlkZGVuRXhjZXB0aW9uLCBIdHRwRXhjZXB0aW9uLCBIdHRwU3RhdHVzIH0gZnJvbSAnQG5lc3Rqcy9jb21tb24nO1xuaW1wb3J0IHsgQWRtaW5Vc2VyQ29udHJvbGxlciB9IGZyb20gJy4vYWRtaW4tdXNlci5jb250cm9sbGVyJztcbmltcG9ydCB7IEFkbWluU2VydmljZSB9IGZyb20gJy4uL2FkbWluLnNlcnZpY2UnO1xuaW1wb3J0IHsgSnd0QXV0aEd1YXJkIH0gZnJvbSAnLi4vLi4vYXV0aC9ndWFyZHMvand0LWF1dGguZ3VhcmQnO1xuaW1wb3J0IHsgQWRtaW5BdXRoR3VhcmQgfSBmcm9tICcuLi8uLi9hdXRoL2d1YXJkcy9hZG1pbi1hdXRoLmd1YXJkJztcbmltcG9ydCB7IFpvZFZhbGlkYXRpb25QaXBlIH0gZnJvbSAnLi4vLi4vY29tbW9uL3BpcGVzL3pvZC12YWxpZGF0aW9uLnBpcGUnO1xuaW1wb3J0IHsgU2VjdXJpdHlHdWFyZFRlc3RVdGlscywgUm9sZUJhc2VkVGVzdFV0aWxzIH0gZnJvbSAnLi4vLi4vdGVzdC11dGlscy9hdXRoLXRlc3RpbmctaGVscGVycyc7XG5pbXBvcnQgeyBNb2NrQnVpbGRlciwgVGVzdERhdGFHZW5lcmF0b3IsIFRlc3RBc3NlcnRpb25zIH0gZnJvbSAnLi4vLi4vdGVzdC11dGlscy9lbmhhbmNlZC10ZXN0LWhlbHBlcnMnO1xuaW1wb3J0IHsgVEVTVF9VU0VSX0lEUywgVEVTVF9FTUFJTFMgfSBmcm9tICcuLi8uLi90ZXN0LXV0aWxzL2luZGV4JztcblxuZGVzY3JpYmUoJ0FkbWluVXNlckNvbnRyb2xsZXInLCAoKSA9PiB7XG4gIGxldCBjb250cm9sbGVyOiBBZG1pblVzZXJDb250cm9sbGVyO1xuICBsZXQgYWRtaW5TZXJ2aWNlOiBBZG1pblNlcnZpY2U7XG4gIGxldCBtb2R1bGU6IFRlc3RpbmdNb2R1bGU7XG5cbiAgLy8gTW9jayBBZG1pblNlcnZpY2VcbiAgY29uc3QgbW9ja0FkbWluU2VydmljZSA9IHtcbiAgICBnZXRBbGxVc2VyczogamVzdC5mbigpLFxuICAgIGdldFVzZXI6IGplc3QuZm4oKSxcbiAgICBzdXNwZW5kVXNlcjogamVzdC5mbigpLFxuICAgIHVuc3VzcGVuZFVzZXI6IGplc3QuZm4oKSxcbiAgfTtcblxuICAvLyBNb2NrIEd1YXJkc1xuICBjb25zdCBtb2NrSnd0QXV0aEd1YXJkID0ge1xuICAgIGNhbkFjdGl2YXRlOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHRydWUpLFxuICB9O1xuXG4gIGNvbnN0IG1vY2tBZG1pbkF1dGhHdWFyZCA9IHtcbiAgICBjYW5BY3RpdmF0ZTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh0cnVlKSxcbiAgfTtcblxuICAvLyBUZXN0IGRhdGFcbiAgY29uc3QgbW9ja1VzZXIgPSB7XG4gICAgaWQ6IFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgIGVtYWlsOiBURVNUX0VNQUlMUy5DTElFTlQsXG4gICAgZmlyc3ROYW1lOiAnSm9obicsXG4gICAgbGFzdE5hbWU6ICdEb2UnLFxuICAgIHJvbGU6ICdjbGllbnQnLFxuICAgIHN0YXR1czogJ2FjdGl2ZScsXG4gICAgaXNFbWFpbFZlcmlmaWVkOiB0cnVlLFxuICAgIGxhc3RMb2dpbkF0OiBuZXcgRGF0ZSgnMjAyNC0wMi0xNFQxMDowMDowMFonKSxcbiAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCcyMDI0LTAxLTAxVDAwOjAwOjAwWicpLFxuICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoJzIwMjQtMDItMTRUMTA6MDA6MDBaJyksXG4gICAgcHJvZmlsZToge1xuICAgICAgZGF0ZU9mQmlydGg6IG5ldyBEYXRlKCcxOTkwLTA1LTE1JyksXG4gICAgICBwaG9uZU51bWJlcjogJysxMjM0NTY3ODkwJyxcbiAgICAgIGVtZXJnZW5jeUNvbnRhY3Q6IHtcbiAgICAgICAgbmFtZTogJ0phbmUgRG9lJyxcbiAgICAgICAgcGhvbmU6ICcrMTIzNDU2Nzg5MScsXG4gICAgICAgIHJlbGF0aW9uc2hpcDogJ3Nwb3VzZScsXG4gICAgICB9LFxuICAgIH0sXG4gICAgcHJlZmVyZW5jZXM6IHtcbiAgICAgIHRoZXJhcGlzdEdlbmRlcjogJ25vLXByZWZlcmVuY2UnLFxuICAgICAgc2Vzc2lvblR5cGU6ICd2aWRlbycsXG4gICAgICBsYW5ndWFnZTogJ2VuZ2xpc2gnLFxuICAgIH0sXG4gICAgc3VzcGVuc2lvbkhpc3Rvcnk6IFtdLFxuICB9O1xuXG4gIGNvbnN0IG1vY2tUaGVyYXBpc3QgPSB7XG4gICAgaWQ6IFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNULFxuICAgIGVtYWlsOiBURVNUX0VNQUlMUy5USEVSQVBJU1QsXG4gICAgZmlyc3ROYW1lOiAnRHIuIFNhcmFoJyxcbiAgICBsYXN0TmFtZTogJ1NtaXRoJyxcbiAgICByb2xlOiAndGhlcmFwaXN0JyxcbiAgICBzdGF0dXM6ICdhY3RpdmUnLFxuICAgIGlzRW1haWxWZXJpZmllZDogdHJ1ZSxcbiAgICBsYXN0TG9naW5BdDogbmV3IERhdGUoJzIwMjQtMDItMTRUMDg6MDA6MDBaJyksXG4gICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgnMjAyNC0wMS0xNVQwMDowMDowMFonKSxcbiAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCcyMDI0LTAyLTE0VDA4OjAwOjAwWicpLFxuICAgIHByb2ZpbGU6IHtcbiAgICAgIGxpY2Vuc2VOdW1iZXI6ICdQU1kxMjM0NTYnLFxuICAgICAgc3BlY2lhbGl6YXRpb25zOiBbJ2FueGlldHknLCAnZGVwcmVzc2lvbiddLFxuICAgICAgeWVhcnNPZkV4cGVyaWVuY2U6IDgsXG4gICAgICBob3VybHlSYXRlOiAxNTAsXG4gICAgfSxcbiAgICBzdXNwZW5zaW9uSGlzdG9yeTogW10sXG4gIH07XG5cbiAgY29uc3QgbW9ja1VzZXJzTGlzdCA9IHtcbiAgICB1c2VyczogW21vY2tVc2VyLCBtb2NrVGhlcmFwaXN0XSxcbiAgICBwYWdpbmF0aW9uOiB7XG4gICAgICBwYWdlOiAxLFxuICAgICAgbGltaXQ6IDIwLFxuICAgICAgdG90YWw6IDIsXG4gICAgICB0b3RhbFBhZ2VzOiAxLFxuICAgICAgaGFzTmV4dDogZmFsc2UsXG4gICAgICBoYXNQcmV2OiBmYWxzZSxcbiAgICB9LFxuICAgIHN1bW1hcnk6IHtcbiAgICAgIHRvdGFsVXNlcnM6IDIsXG4gICAgICBhY3RpdmVVc2VyczogMixcbiAgICAgIHN1c3BlbmRlZFVzZXJzOiAwLFxuICAgICAgcm9sZUJyZWFrZG93bjoge1xuICAgICAgICBjbGllbnQ6IDEsXG4gICAgICAgIHRoZXJhcGlzdDogMSxcbiAgICAgICAgbW9kZXJhdG9yOiAwLFxuICAgICAgICBhZG1pbjogMCxcbiAgICAgIH0sXG4gICAgfSxcbiAgfTtcblxuICBjb25zdCBtb2NrU3VzcGVuZGVkVXNlciA9IHtcbiAgICAuLi5tb2NrVXNlcixcbiAgICBzdGF0dXM6ICdzdXNwZW5kZWQnLFxuICAgIHN1c3BlbnNpb246IHtcbiAgICAgIHJlYXNvbjogJ1BvbGljeSB2aW9sYXRpb24nLFxuICAgICAgc3VzcGVuZGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICBzdXNwZW5kZWRCeTogVEVTVF9VU0VSX0lEUy5BRE1JTixcbiAgICAgIGR1cmF0aW9uOiAzMCwgLy8gZGF5c1xuICAgICAgZXhwaXJlc0F0OiBuZXcgRGF0ZShEYXRlLm5vdygpICsgMzAgKiAyNCAqIDYwICogNjAgKiAxMDAwKSxcbiAgICB9LFxuICB9O1xuXG4gIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xuICAgIG1vZHVsZSA9IGF3YWl0IFRlc3QuY3JlYXRlVGVzdGluZ01vZHVsZSh7XG4gICAgICBjb250cm9sbGVyczogW0FkbWluVXNlckNvbnRyb2xsZXJdLFxuICAgICAgcHJvdmlkZXJzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlOiBBZG1pblNlcnZpY2UsXG4gICAgICAgICAgdXNlVmFsdWU6IG1vY2tBZG1pblNlcnZpY2UsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgIH0pXG4gICAgICAub3ZlcnJpZGVHdWFyZChKd3RBdXRoR3VhcmQpXG4gICAgICAudXNlVmFsdWUobW9ja0p3dEF1dGhHdWFyZClcbiAgICAgIC5vdmVycmlkZUd1YXJkKEFkbWluQXV0aEd1YXJkKVxuICAgICAgLnVzZVZhbHVlKG1vY2tBZG1pbkF1dGhHdWFyZClcbiAgICAgIC5jb21waWxlKCk7XG5cbiAgICBjb250cm9sbGVyID0gbW9kdWxlLmdldDxBZG1pblVzZXJDb250cm9sbGVyPihBZG1pblVzZXJDb250cm9sbGVyKTtcbiAgICBhZG1pblNlcnZpY2UgPSBtb2R1bGUuZ2V0PEFkbWluU2VydmljZT4oQWRtaW5TZXJ2aWNlKTtcbiAgfSk7XG5cbiAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0NvbnRyb2xsZXIgSW5pdGlhbGl6YXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBiZSBkZWZpbmVkJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KGNvbnRyb2xsZXIpLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhdmUgYWRtaW5TZXJ2aWNlIGluamVjdGVkJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KGFkbWluU2VydmljZSkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1NlY3VyaXR5IEd1YXJkcycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGJlIHByb3RlY3RlZCBieSBKd3RBdXRoR3VhcmQgYW5kIEFkbWluQXV0aEd1YXJkJywgKCkgPT4ge1xuICAgICAgY29uc3QgZ3VhcmRzID0gUmVmbGVjdC5nZXRNZXRhZGF0YSgnX19ndWFyZHNfXycsIEFkbWluVXNlckNvbnRyb2xsZXIpO1xuICAgICAgZXhwZWN0KGd1YXJkcykudG9Db250YWluKEp3dEF1dGhHdWFyZCk7XG4gICAgICBleHBlY3QoZ3VhcmRzKS50b0NvbnRhaW4oQWRtaW5BdXRoR3VhcmQpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYXZlIHByb3BlciByb3V0ZSBkZWNvcmF0b3JzJywgKCkgPT4ge1xuICAgICAgY29uc3QgY29udHJvbGxlck1ldGFkYXRhID0gUmVmbGVjdC5nZXRNZXRhZGF0YSgncGF0aCcsIEFkbWluVXNlckNvbnRyb2xsZXIpO1xuICAgICAgZXhwZWN0KGNvbnRyb2xsZXJNZXRhZGF0YSkudG9CZSgnYWRtaW4vdXNlcnMnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGF2ZSBBZG1pbk9ubHkgZGVjb3JhdG9ycyBvbiBhbGwgbWV0aG9kcycsICgpID0+IHtcbiAgICAgIGNvbnN0IG1ldGhvZHMgPSBbJ2dldEFsbFVzZXJzJywgJ2dldFVzZXInLCAnc3VzcGVuZFVzZXInLCAndW5zdXNwZW5kVXNlciddO1xuICAgICAgXG4gICAgICBtZXRob2RzLmZvckVhY2gobWV0aG9kID0+IHtcbiAgICAgICAgY29uc3QgbWV0YWRhdGEgPSBSZWZsZWN0LmdldE1ldGFkYXRhKCdhZG1pbl9vbmx5JywgY29udHJvbGxlclttZXRob2QgYXMga2V5b2YgQWRtaW5Vc2VyQ29udHJvbGxlcl0pO1xuICAgICAgICBleHBlY3QobWV0YWRhdGEpLnRvQmVUcnV0aHkoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnR0VUIC9hZG1pbi91c2VycycsICgpID0+IHtcbiAgICBjb25zdCBtb2NrUXVlcnkgPSB7XG4gICAgICBwYWdlOiAxLFxuICAgICAgbGltaXQ6IDIwLFxuICAgICAgcm9sZTogJ2NsaWVudCcgYXMgY29uc3QsXG4gICAgICBzZWFyY2g6ICdqb2huJyxcbiAgICAgIHN0YXR1czogJ2FjdGl2ZScgYXMgY29uc3QsXG4gICAgICBzb3J0Qnk6ICdjcmVhdGVkQXQnIGFzIGNvbnN0LFxuICAgICAgc29ydE9yZGVyOiAnZGVzYycgYXMgY29uc3QsXG4gICAgfTtcblxuICAgIGl0KCdzaG91bGQgZ2V0IGFsbCB1c2VycyBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrQWRtaW5TZXJ2aWNlLmdldEFsbFVzZXJzLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVc2Vyc0xpc3QpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldEFsbFVzZXJzKFRFU1RfVVNFUl9JRFMuQURNSU4sIG1vY2tRdWVyeSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja1VzZXJzTGlzdCk7XG4gICAgICBleHBlY3QoYWRtaW5TZXJ2aWNlLmdldEFsbFVzZXJzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIHJvbGU6IG1vY2tRdWVyeS5yb2xlLFxuICAgICAgICBwYWdlOiBtb2NrUXVlcnkucGFnZSxcbiAgICAgICAgbGltaXQ6IG1vY2tRdWVyeS5saW1pdCxcbiAgICAgICAgc2VhcmNoOiBtb2NrUXVlcnkuc2VhcmNoLFxuICAgICAgICBzdGF0dXM6IG1vY2tRdWVyeS5zdGF0dXMsXG4gICAgICAgIHNvcnRCeTogbW9ja1F1ZXJ5LnNvcnRCeSxcbiAgICAgICAgc29ydE9yZGVyOiBtb2NrUXVlcnkuc29ydE9yZGVyLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGdldCB1c2VycyB3aXRob3V0IGZpbHRlcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBlbXB0eVF1ZXJ5ID0ge307XG4gICAgICBtb2NrQWRtaW5TZXJ2aWNlLmdldEFsbFVzZXJzLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVc2Vyc0xpc3QpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldEFsbFVzZXJzKFRFU1RfVVNFUl9JRFMuQURNSU4sIGVtcHR5UXVlcnkpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKG1vY2tVc2Vyc0xpc3QpO1xuICAgICAgZXhwZWN0KGFkbWluU2VydmljZS5nZXRBbGxVc2VycykudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICByb2xlOiB1bmRlZmluZWQsXG4gICAgICAgIHBhZ2U6IHVuZGVmaW5lZCxcbiAgICAgICAgbGltaXQ6IHVuZGVmaW5lZCxcbiAgICAgICAgc2VhcmNoOiB1bmRlZmluZWQsXG4gICAgICAgIHN0YXR1czogdW5kZWZpbmVkLFxuICAgICAgICBzb3J0Qnk6IHVuZGVmaW5lZCxcbiAgICAgICAgc29ydE9yZGVyOiB1bmRlZmluZWQsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZmlsdGVyIGJ5IHJvbGUgY29ycmVjdGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgcm9sZVF1ZXJpZXMgPSBbJ2NsaWVudCcsICd0aGVyYXBpc3QnLCAnbW9kZXJhdG9yJywgJ2FkbWluJ10gYXMgY29uc3Q7XG4gICAgICBcbiAgICAgIGZvciAoY29uc3Qgcm9sZSBvZiByb2xlUXVlcmllcykge1xuICAgICAgICBjb25zdCBxdWVyeSA9IHsgcm9sZSB9O1xuICAgICAgICBjb25zdCBmaWx0ZXJlZFVzZXJzID0ge1xuICAgICAgICAgIC4uLm1vY2tVc2Vyc0xpc3QsXG4gICAgICAgICAgdXNlcnM6IG1vY2tVc2Vyc0xpc3QudXNlcnMuZmlsdGVyKHVzZXIgPT4gdXNlci5yb2xlID09PSByb2xlKSxcbiAgICAgICAgfTtcbiAgICAgICAgbW9ja0FkbWluU2VydmljZS5nZXRBbGxVc2Vycy5tb2NrUmVzb2x2ZWRWYWx1ZShmaWx0ZXJlZFVzZXJzKTtcblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldEFsbFVzZXJzKFRFU1RfVVNFUl9JRFMuQURNSU4sIHF1ZXJ5KTtcblxuICAgICAgICBleHBlY3QocmVzdWx0LnVzZXJzLmV2ZXJ5KHVzZXIgPT4gdXNlci5yb2xlID09PSByb2xlKSkudG9CZSh0cnVlKTtcbiAgICAgICAgZXhwZWN0KGFkbWluU2VydmljZS5nZXRBbGxVc2VycykudG9IYXZlQmVlbkNhbGxlZFdpdGgoZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoeyByb2xlIH0pKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZmlsdGVyIGJ5IHN0YXR1cyBjb3JyZWN0bHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBzdGF0dXNRdWVyaWVzID0gWydhY3RpdmUnLCAnc3VzcGVuZGVkJywgJ2luYWN0aXZlJ10gYXMgY29uc3Q7XG4gICAgICBcbiAgICAgIGZvciAoY29uc3Qgc3RhdHVzIG9mIHN0YXR1c1F1ZXJpZXMpIHtcbiAgICAgICAgY29uc3QgcXVlcnkgPSB7IHN0YXR1cyB9O1xuICAgICAgICBjb25zdCBmaWx0ZXJlZFVzZXJzID0ge1xuICAgICAgICAgIC4uLm1vY2tVc2Vyc0xpc3QsXG4gICAgICAgICAgdXNlcnM6IG1vY2tVc2Vyc0xpc3QudXNlcnMuZmlsdGVyKHVzZXIgPT4gdXNlci5zdGF0dXMgPT09IHN0YXR1cyksXG4gICAgICAgIH07XG4gICAgICAgIG1vY2tBZG1pblNlcnZpY2UuZ2V0QWxsVXNlcnMubW9ja1Jlc29sdmVkVmFsdWUoZmlsdGVyZWRVc2Vycyk7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRBbGxVc2VycyhURVNUX1VTRVJfSURTLkFETUlOLCBxdWVyeSk7XG5cbiAgICAgICAgZXhwZWN0KGFkbWluU2VydmljZS5nZXRBbGxVc2VycykudG9IYXZlQmVlbkNhbGxlZFdpdGgoZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoeyBzdGF0dXMgfSkpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2VhcmNoIGZ1bmN0aW9uYWxpdHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBzZWFyY2hRdWVyaWVzID0gWydqb2huJywgJ2RvZScsICdzYXJhaCcsICdzbWl0aCcsICd0ZXN0QGV4YW1wbGUuY29tJ107XG4gICAgICBcbiAgICAgIGZvciAoY29uc3Qgc2VhcmNoIG9mIHNlYXJjaFF1ZXJpZXMpIHtcbiAgICAgICAgY29uc3QgcXVlcnkgPSB7IHNlYXJjaCB9O1xuICAgICAgICBjb25zdCBzZWFyY2hSZXN1bHRzID0ge1xuICAgICAgICAgIC4uLm1vY2tVc2Vyc0xpc3QsXG4gICAgICAgICAgdXNlcnM6IG1vY2tVc2Vyc0xpc3QudXNlcnMuZmlsdGVyKHVzZXIgPT4gXG4gICAgICAgICAgICB1c2VyLmZpcnN0TmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHNlYXJjaC50b0xvd2VyQ2FzZSgpKSB8fFxuICAgICAgICAgICAgdXNlci5sYXN0TmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHNlYXJjaC50b0xvd2VyQ2FzZSgpKSB8fFxuICAgICAgICAgICAgdXNlci5lbWFpbC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHNlYXJjaC50b0xvd2VyQ2FzZSgpKVxuICAgICAgICAgICksXG4gICAgICAgIH07XG4gICAgICAgIG1vY2tBZG1pblNlcnZpY2UuZ2V0QWxsVXNlcnMubW9ja1Jlc29sdmVkVmFsdWUoc2VhcmNoUmVzdWx0cyk7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRBbGxVc2VycyhURVNUX1VTRVJfSURTLkFETUlOLCBxdWVyeSk7XG5cbiAgICAgICAgZXhwZWN0KGFkbWluU2VydmljZS5nZXRBbGxVc2VycykudG9IYXZlQmVlbkNhbGxlZFdpdGgoZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoeyBzZWFyY2ggfSkpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgcGFnaW5hdGlvbiBjb3JyZWN0bHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBwYWdpbmF0ZWRRdWVyeSA9IHsgcGFnZTogMiwgbGltaXQ6IDEwIH07XG4gICAgICBjb25zdCBwYWdpbmF0ZWRSZXN1bHQgPSB7XG4gICAgICAgIC4uLm1vY2tVc2Vyc0xpc3QsXG4gICAgICAgIHBhZ2luYXRpb246IHtcbiAgICAgICAgICBwYWdlOiAyLFxuICAgICAgICAgIGxpbWl0OiAxMCxcbiAgICAgICAgICB0b3RhbDogNTAsXG4gICAgICAgICAgdG90YWxQYWdlczogNSxcbiAgICAgICAgICBoYXNOZXh0OiB0cnVlLFxuICAgICAgICAgIGhhc1ByZXY6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICB9O1xuICAgICAgbW9ja0FkbWluU2VydmljZS5nZXRBbGxVc2Vycy5tb2NrUmVzb2x2ZWRWYWx1ZShwYWdpbmF0ZWRSZXN1bHQpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldEFsbFVzZXJzKFRFU1RfVVNFUl9JRFMuQURNSU4sIHBhZ2luYXRlZFF1ZXJ5KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5wYWdpbmF0aW9uLnBhZ2UpLnRvQmUoMik7XG4gICAgICBleHBlY3QocmVzdWx0LnBhZ2luYXRpb24ubGltaXQpLnRvQmUoMTApO1xuICAgICAgZXhwZWN0KHJlc3VsdC5wYWdpbmF0aW9uLnRvdGFsUGFnZXMpLnRvQmUoNSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzb3J0aW5nIG9wdGlvbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBzb3J0T3B0aW9ucyA9IFtcbiAgICAgICAgeyBzb3J0Qnk6ICdjcmVhdGVkQXQnLCBzb3J0T3JkZXI6ICdkZXNjJyB9LFxuICAgICAgICB7IHNvcnRCeTogJ2xhc3RMb2dpbkF0Jywgc29ydE9yZGVyOiAnYXNjJyB9LFxuICAgICAgICB7IHNvcnRCeTogJ2VtYWlsJywgc29ydE9yZGVyOiAnYXNjJyB9LFxuICAgICAgICB7IHNvcnRCeTogJ3N0YXR1cycsIHNvcnRPcmRlcjogJ2Rlc2MnIH0sXG4gICAgICBdIGFzIGNvbnN0O1xuXG4gICAgICBmb3IgKGNvbnN0IHNvcnRPcHRpb24gb2Ygc29ydE9wdGlvbnMpIHtcbiAgICAgICAgY29uc3QgcXVlcnkgPSBzb3J0T3B0aW9uO1xuICAgICAgICBtb2NrQWRtaW5TZXJ2aWNlLmdldEFsbFVzZXJzLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVc2Vyc0xpc3QpO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0QWxsVXNlcnMoVEVTVF9VU0VSX0lEUy5BRE1JTiwgcXVlcnkpO1xuXG4gICAgICAgIGV4cGVjdChhZG1pblNlcnZpY2UuZ2V0QWxsVXNlcnMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGV4cGVjdC5vYmplY3RDb250YWluaW5nKHNvcnRPcHRpb24pKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGVtcHR5IHJlc3VsdHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBlbXB0eVJlc3VsdCA9IHtcbiAgICAgICAgdXNlcnM6IFtdLFxuICAgICAgICBwYWdpbmF0aW9uOiB7IHBhZ2U6IDEsIGxpbWl0OiAyMCwgdG90YWw6IDAsIHRvdGFsUGFnZXM6IDAsIGhhc05leHQ6IGZhbHNlLCBoYXNQcmV2OiBmYWxzZSB9LFxuICAgICAgICBzdW1tYXJ5OiB7IHRvdGFsVXNlcnM6IDAsIGFjdGl2ZVVzZXJzOiAwLCBzdXNwZW5kZWRVc2VyczogMCwgcm9sZUJyZWFrZG93bjogeyBjbGllbnQ6IDAsIHRoZXJhcGlzdDogMCwgbW9kZXJhdG9yOiAwLCBhZG1pbjogMCB9IH0sXG4gICAgICB9O1xuICAgICAgbW9ja0FkbWluU2VydmljZS5nZXRBbGxVc2Vycy5tb2NrUmVzb2x2ZWRWYWx1ZShlbXB0eVJlc3VsdCk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0QWxsVXNlcnMoVEVTVF9VU0VSX0lEUy5BRE1JTiwge30pO1xuXG4gICAgICBleHBlY3QocmVzdWx0LnVzZXJzKS50b0VxdWFsKFtdKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VtbWFyeS50b3RhbFVzZXJzKS50b0JlKDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2VydmljZSBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBzZXJ2aWNlRXJyb3IgPSBuZXcgRXJyb3IoJ0RhdGFiYXNlIGNvbm5lY3Rpb24gZmFpbGVkJyk7XG4gICAgICBtb2NrQWRtaW5TZXJ2aWNlLmdldEFsbFVzZXJzLm1vY2tSZWplY3RlZFZhbHVlKHNlcnZpY2VFcnJvcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChjb250cm9sbGVyLmdldEFsbFVzZXJzKFRFU1RfVVNFUl9JRFMuQURNSU4sIHt9KSkucmVqZWN0cy50b1Rocm93KEh0dHBFeGNlcHRpb24pO1xuICAgICAgYXdhaXQgZXhwZWN0KGNvbnRyb2xsZXIuZ2V0QWxsVXNlcnMoVEVTVF9VU0VSX0lEUy5BRE1JTiwge30pKS5yZWplY3RzLnRvVGhyb3coJ0ZhaWxlZCB0byByZXRyaWV2ZSB1c2VycycpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBsb2cgYWRtaW4gYWN0aW9ucycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGxvZ1NweSA9IGplc3Quc3B5T24oY29udHJvbGxlclsnbG9nZ2VyJ10sICdsb2cnKTtcbiAgICAgIG1vY2tBZG1pblNlcnZpY2UuZ2V0QWxsVXNlcnMubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXJzTGlzdCk7XG5cbiAgICAgIGF3YWl0IGNvbnRyb2xsZXIuZ2V0QWxsVXNlcnMoVEVTVF9VU0VSX0lEUy5BRE1JTiwge30pO1xuXG4gICAgICBleHBlY3QobG9nU3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChgQWRtaW4gJHtURVNUX1VTRVJfSURTLkFETUlOfSByZXRyaWV2aW5nIHVzZXJzYCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdHRVQgL2FkbWluL3VzZXJzLzppZCcsICgpID0+IHtcbiAgICBjb25zdCB1c2VySWQgPSBURVNUX1VTRVJfSURTLkNMSUVOVDtcblxuICAgIGl0KCdzaG91bGQgZ2V0IHVzZXIgYnkgaWQgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0FkbWluU2VydmljZS5nZXRVc2VyLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVc2VyKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRVc2VyKFRFU1RfVVNFUl9JRFMuQURNSU4sIHVzZXJJZCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja1VzZXIpO1xuICAgICAgZXhwZWN0KGFkbWluU2VydmljZS5nZXRVc2VyKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh1c2VySWQpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgdXNlciBub3QgZm91bmQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrQWRtaW5TZXJ2aWNlLmdldFVzZXIubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChjb250cm9sbGVyLmdldFVzZXIoVEVTVF9VU0VSX0lEUy5BRE1JTiwgJ25vbi1leGlzdGVudC1pZCcpKS5yZWplY3RzLnRvVGhyb3coSHR0cEV4Y2VwdGlvbik7XG4gICAgICBhd2FpdCBleHBlY3QoY29udHJvbGxlci5nZXRVc2VyKFRFU1RfVVNFUl9JRFMuQURNSU4sICdub24tZXhpc3RlbnQtaWQnKSkucmVqZWN0cy50b1Rocm93KCdVc2VyIG5vdCBmb3VuZCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gY29tcGxldGUgdXNlciBkZXRhaWxzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZGV0YWlsZWRVc2VyID0ge1xuICAgICAgICAuLi5tb2NrVXNlcixcbiAgICAgICAgc2Vzc2lvbnM6IFtcbiAgICAgICAgICB7IGlkOiAnc2Vzc2lvbl8xJywgZGF0ZTogbmV3IERhdGUoKSwgc3RhdHVzOiAnY29tcGxldGVkJyB9LFxuICAgICAgICAgIHsgaWQ6ICdzZXNzaW9uXzInLCBkYXRlOiBuZXcgRGF0ZSgpLCBzdGF0dXM6ICdzY2hlZHVsZWQnIH0sXG4gICAgICAgIF0sXG4gICAgICAgIHRpY2tldHM6IFtcbiAgICAgICAgICB7IGlkOiAndGlja2V0XzEnLCBzdWJqZWN0OiAnTG9naW4gaXNzdWUnLCBzdGF0dXM6ICdyZXNvbHZlZCcgfSxcbiAgICAgICAgXSxcbiAgICAgICAgYWN0aXZpdHlMb2c6IFtcbiAgICAgICAgICB7IGFjdGlvbjogJ2xvZ2luJywgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLCBpcDogJzE5Mi4xNjguMS4xJyB9LFxuICAgICAgICAgIHsgYWN0aW9uOiAncHJvZmlsZV91cGRhdGUnLCB0aW1lc3RhbXA6IG5ldyBEYXRlKCksIGlwOiAnMTkyLjE2OC4xLjEnIH0sXG4gICAgICAgIF0sXG4gICAgICB9O1xuICAgICAgbW9ja0FkbWluU2VydmljZS5nZXRVc2VyLm1vY2tSZXNvbHZlZFZhbHVlKGRldGFpbGVkVXNlcik7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0VXNlcihURVNUX1VTRVJfSURTLkFETUlOLCB1c2VySWQpO1xuXG4gICAgICBleHBlY3QocmVzdWx0LnNlc3Npb25zKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHJlc3VsdC50aWNrZXRzKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5hY3Rpdml0eUxvZykudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChBcnJheS5pc0FycmF5KHJlc3VsdC5zZXNzaW9ucykpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QoQXJyYXkuaXNBcnJheShyZXN1bHQudGlja2V0cykpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QoQXJyYXkuaXNBcnJheShyZXN1bHQuYWN0aXZpdHlMb2cpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2VydmljZSBlcnJvcnMgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHNlcnZpY2VFcnJvciA9IG5ldyBFcnJvcignRGF0YWJhc2UgZXJyb3InKTtcbiAgICAgIG1vY2tBZG1pblNlcnZpY2UuZ2V0VXNlci5tb2NrUmVqZWN0ZWRWYWx1ZShzZXJ2aWNlRXJyb3IpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoY29udHJvbGxlci5nZXRVc2VyKFRFU1RfVVNFUl9JRFMuQURNSU4sIHVzZXJJZCkpLnJlamVjdHMudG9UaHJvdyhIdHRwRXhjZXB0aW9uKTtcbiAgICAgIGF3YWl0IGV4cGVjdChjb250cm9sbGVyLmdldFVzZXIoVEVTVF9VU0VSX0lEUy5BRE1JTiwgdXNlcklkKSkucmVqZWN0cy50b1Rocm93KCdGYWlsZWQgdG8gcmV0cmlldmUgdXNlcicpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBsb2cgYWRtaW4gYWN0aW9ucycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGxvZ1NweSA9IGplc3Quc3B5T24oY29udHJvbGxlclsnbG9nZ2VyJ10sICdsb2cnKTtcbiAgICAgIG1vY2tBZG1pblNlcnZpY2UuZ2V0VXNlci5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXNlcik7XG5cbiAgICAgIGF3YWl0IGNvbnRyb2xsZXIuZ2V0VXNlcihURVNUX1VTRVJfSURTLkFETUlOLCB1c2VySWQpO1xuXG4gICAgICBleHBlY3QobG9nU3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChgQWRtaW4gJHtURVNUX1VTRVJfSURTLkFETUlOfSByZXRyaWV2aW5nIHVzZXIgJHt1c2VySWR9YCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBkaWZmZXJlbnQgdXNlciByb2xlcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHVzZXJSb2xlcyA9IFsnY2xpZW50JywgJ3RoZXJhcGlzdCcsICdtb2RlcmF0b3InLCAnYWRtaW4nXTtcbiAgICAgIFxuICAgICAgZm9yIChjb25zdCByb2xlIG9mIHVzZXJSb2xlcykge1xuICAgICAgICBjb25zdCByb2xlVXNlciA9IHsgLi4ubW9ja1VzZXIsIHJvbGUgfTtcbiAgICAgICAgbW9ja0FkbWluU2VydmljZS5nZXRVc2VyLm1vY2tSZXNvbHZlZFZhbHVlKHJvbGVVc2VyKTtcblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldFVzZXIoVEVTVF9VU0VSX0lEUy5BRE1JTiwgdXNlcklkKTtcblxuICAgICAgICBleHBlY3QocmVzdWx0LnJvbGUpLnRvQmUocm9sZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdQVVQgL2FkbWluL3VzZXJzLzppZC9zdXNwZW5kJywgKCkgPT4ge1xuICAgIGNvbnN0IHVzZXJJZCA9IFRFU1RfVVNFUl9JRFMuQ0xJRU5UO1xuICAgIGNvbnN0IHN1c3BlbnNpb25EYXRhID0ge1xuICAgICAgcmVhc29uOiAnUG9saWN5IHZpb2xhdGlvbiAtIGluYXBwcm9wcmlhdGUgYmVoYXZpb3InLFxuICAgICAgZHVyYXRpb246IDMwLCAvLyAzMCBkYXlzXG4gICAgfTtcblxuICAgIGl0KCdzaG91bGQgc3VzcGVuZCB1c2VyIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tBZG1pblNlcnZpY2Uuc3VzcGVuZFVzZXIubW9ja1Jlc29sdmVkVmFsdWUobW9ja1N1c3BlbmRlZFVzZXIpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLnN1c3BlbmRVc2VyKFRFU1RfVVNFUl9JRFMuQURNSU4sIHVzZXJJZCwgc3VzcGVuc2lvbkRhdGEpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKG1vY2tTdXNwZW5kZWRVc2VyKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuc3RhdHVzKS50b0JlKCdzdXNwZW5kZWQnKTtcbiAgICAgIGV4cGVjdChhZG1pblNlcnZpY2Uuc3VzcGVuZFVzZXIpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICB1c2VySWQsXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQURNSU4sXG4gICAgICAgIHN1c3BlbnNpb25EYXRhLnJlYXNvbixcbiAgICAgICAgc3VzcGVuc2lvbkRhdGEuZHVyYXRpb24sXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzdXNwZW5kIHVzZXIgd2l0aG91dCBkdXJhdGlvbiAocGVybWFuZW50KScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHBlcm1hbmVudFN1c3BlbnNpb24gPSB7IHJlYXNvbjogJ1NldmVyZSBwb2xpY3kgdmlvbGF0aW9uJyB9O1xuICAgICAgY29uc3QgcGVybWFuZW50bHlTdXNwZW5kZWRVc2VyID0ge1xuICAgICAgICAuLi5tb2NrU3VzcGVuZGVkVXNlcixcbiAgICAgICAgc3VzcGVuc2lvbjoge1xuICAgICAgICAgIC4uLm1vY2tTdXNwZW5kZWRVc2VyLnN1c3BlbnNpb24sXG4gICAgICAgICAgZHVyYXRpb246IG51bGwsXG4gICAgICAgICAgZXhwaXJlc0F0OiBudWxsLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICAgIG1vY2tBZG1pblNlcnZpY2Uuc3VzcGVuZFVzZXIubW9ja1Jlc29sdmVkVmFsdWUocGVybWFuZW50bHlTdXNwZW5kZWRVc2VyKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5zdXNwZW5kVXNlcihURVNUX1VTRVJfSURTLkFETUlOLCB1c2VySWQsIHBlcm1hbmVudFN1c3BlbnNpb24pO1xuXG4gICAgICBleHBlY3QocmVzdWx0LnN1c3BlbnNpb24uZHVyYXRpb24pLnRvQmVOdWxsKCk7XG4gICAgICBleHBlY3QocmVzdWx0LnN1c3BlbnNpb24uZXhwaXJlc0F0KS50b0JlTnVsbCgpO1xuICAgICAgZXhwZWN0KGFkbWluU2VydmljZS5zdXNwZW5kVXNlcikudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIHVzZXJJZCxcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5BRE1JTixcbiAgICAgICAgcGVybWFuZW50U3VzcGVuc2lvbi5yZWFzb24sXG4gICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBkaWZmZXJlbnQgc3VzcGVuc2lvbiByZWFzb25zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgc3VzcGVuc2lvblJlYXNvbnMgPSBbXG4gICAgICAgICdQb2xpY3kgdmlvbGF0aW9uJyxcbiAgICAgICAgJ0luYXBwcm9wcmlhdGUgYmVoYXZpb3InLFxuICAgICAgICAnVGVybXMgb2Ygc2VydmljZSB2aW9sYXRpb24nLFxuICAgICAgICAnU2VjdXJpdHkgY29uY2VybnMnLFxuICAgICAgICAnUGF5bWVudCBpc3N1ZXMnLFxuICAgICAgICAnQWJ1c2Ugb2YgcGxhdGZvcm0nLFxuICAgICAgXTtcblxuICAgICAgZm9yIChjb25zdCByZWFzb24gb2Ygc3VzcGVuc2lvblJlYXNvbnMpIHtcbiAgICAgICAgY29uc3QgZGF0YSA9IHsgcmVhc29uLCBkdXJhdGlvbjogMTUgfTtcbiAgICAgICAgY29uc3Qgc3VzcGVuZGVkVXNlciA9IHtcbiAgICAgICAgICAuLi5tb2NrU3VzcGVuZGVkVXNlcixcbiAgICAgICAgICBzdXNwZW5zaW9uOiB7IC4uLm1vY2tTdXNwZW5kZWRVc2VyLnN1c3BlbnNpb24sIHJlYXNvbiB9LFxuICAgICAgICB9O1xuICAgICAgICBtb2NrQWRtaW5TZXJ2aWNlLnN1c3BlbmRVc2VyLm1vY2tSZXNvbHZlZFZhbHVlKHN1c3BlbmRlZFVzZXIpO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuc3VzcGVuZFVzZXIoVEVTVF9VU0VSX0lEUy5BRE1JTiwgdXNlcklkLCBkYXRhKTtcblxuICAgICAgICBleHBlY3QocmVzdWx0LnN1c3BlbnNpb24ucmVhc29uKS50b0JlKHJlYXNvbik7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBkaWZmZXJlbnQgc3VzcGVuc2lvbiBkdXJhdGlvbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBkdXJhdGlvbnMgPSBbMSwgNywgMTQsIDMwLCA5MCwgMzY1XTsgLy8gZGF5c1xuICAgICAgXG4gICAgICBmb3IgKGNvbnN0IGR1cmF0aW9uIG9mIGR1cmF0aW9ucykge1xuICAgICAgICBjb25zdCBkYXRhID0geyByZWFzb246ICdQb2xpY3kgdmlvbGF0aW9uJywgZHVyYXRpb24gfTtcbiAgICAgICAgY29uc3Qgc3VzcGVuZGVkVXNlciA9IHtcbiAgICAgICAgICAuLi5tb2NrU3VzcGVuZGVkVXNlcixcbiAgICAgICAgICBzdXNwZW5zaW9uOiB7IC4uLm1vY2tTdXNwZW5kZWRVc2VyLnN1c3BlbnNpb24sIGR1cmF0aW9uIH0sXG4gICAgICAgIH07XG4gICAgICAgIG1vY2tBZG1pblNlcnZpY2Uuc3VzcGVuZFVzZXIubW9ja1Jlc29sdmVkVmFsdWUoc3VzcGVuZGVkVXNlcik7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5zdXNwZW5kVXNlcihURVNUX1VTRVJfSURTLkFETUlOLCB1c2VySWQsIGRhdGEpO1xuXG4gICAgICAgIGV4cGVjdChyZXN1bHQuc3VzcGVuc2lvbi5kdXJhdGlvbikudG9CZShkdXJhdGlvbik7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSB1c2VyIG5vdCBmb3VuZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG5vdEZvdW5kRXJyb3IgPSBuZXcgRXJyb3IoJ1VzZXIgbm90IGZvdW5kJyk7XG4gICAgICBtb2NrQWRtaW5TZXJ2aWNlLnN1c3BlbmRVc2VyLm1vY2tSZWplY3RlZFZhbHVlKG5vdEZvdW5kRXJyb3IpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIuc3VzcGVuZFVzZXIoVEVTVF9VU0VSX0lEUy5BRE1JTiwgJ25vbi1leGlzdGVudC1pZCcsIHN1c3BlbnNpb25EYXRhKVxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coSHR0cEV4Y2VwdGlvbik7XG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIuc3VzcGVuZFVzZXIoVEVTVF9VU0VSX0lEUy5BRE1JTiwgJ25vbi1leGlzdGVudC1pZCcsIHN1c3BlbnNpb25EYXRhKVxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coJ0ZhaWxlZCB0byBzdXNwZW5kIHVzZXInKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGFscmVhZHkgc3VzcGVuZGVkIHVzZXInLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBhbHJlYWR5U3VzcGVuZGVkRXJyb3IgPSBuZXcgRXJyb3IoJ1VzZXIgaXMgYWxyZWFkeSBzdXNwZW5kZWQnKTtcbiAgICAgIG1vY2tBZG1pblNlcnZpY2Uuc3VzcGVuZFVzZXIubW9ja1JlamVjdGVkVmFsdWUoYWxyZWFkeVN1c3BlbmRlZEVycm9yKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLnN1c3BlbmRVc2VyKFRFU1RfVVNFUl9JRFMuQURNSU4sIHVzZXJJZCwgc3VzcGVuc2lvbkRhdGEpXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhIdHRwRXhjZXB0aW9uKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbG9nIGFkbWluIGFjdGlvbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBsb2dTcHkgPSBqZXN0LnNweU9uKGNvbnRyb2xsZXJbJ2xvZ2dlciddLCAnbG9nJyk7XG4gICAgICBtb2NrQWRtaW5TZXJ2aWNlLnN1c3BlbmRVc2VyLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tTdXNwZW5kZWRVc2VyKTtcblxuICAgICAgYXdhaXQgY29udHJvbGxlci5zdXNwZW5kVXNlcihURVNUX1VTRVJfSURTLkFETUlOLCB1c2VySWQsIHN1c3BlbnNpb25EYXRhKTtcblxuICAgICAgZXhwZWN0KGxvZ1NweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoYEFkbWluICR7VEVTVF9VU0VSX0lEUy5BRE1JTn0gc3VzcGVuZGluZyB1c2VyICR7dXNlcklkfWApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2VydmljZSBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBzZXJ2aWNlRXJyb3IgPSBuZXcgRXJyb3IoJ0RhdGFiYXNlIHRyYW5zYWN0aW9uIGZhaWxlZCcpO1xuICAgICAgbW9ja0FkbWluU2VydmljZS5zdXNwZW5kVXNlci5tb2NrUmVqZWN0ZWRWYWx1ZShzZXJ2aWNlRXJyb3IpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIuc3VzcGVuZFVzZXIoVEVTVF9VU0VSX0lEUy5BRE1JTiwgdXNlcklkLCBzdXNwZW5zaW9uRGF0YSlcbiAgICAgICkucmVqZWN0cy50b1Rocm93KEh0dHBFeGNlcHRpb24pO1xuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLnN1c3BlbmRVc2VyKFRFU1RfVVNFUl9JRFMuQURNSU4sIHVzZXJJZCwgc3VzcGVuc2lvbkRhdGEpXG4gICAgICApLnJlamVjdHMudG9UaHJvdygnRmFpbGVkIHRvIHN1c3BlbmQgdXNlcicpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUFVUIC9hZG1pbi91c2Vycy86aWQvdW5zdXNwZW5kJywgKCkgPT4ge1xuICAgIGNvbnN0IHVzZXJJZCA9IFRFU1RfVVNFUl9JRFMuQ0xJRU5UO1xuXG4gICAgaXQoJ3Nob3VsZCB1bnN1c3BlbmQgdXNlciBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB1bnN1c3BlbmRlZFVzZXIgPSB7XG4gICAgICAgIC4uLm1vY2tVc2VyLFxuICAgICAgICBzdGF0dXM6ICdhY3RpdmUnLFxuICAgICAgICBzdXNwZW5zaW9uSGlzdG9yeTogW3tcbiAgICAgICAgICByZWFzb246ICdQb2xpY3kgdmlvbGF0aW9uJyxcbiAgICAgICAgICBzdXNwZW5kZWRBdDogbmV3IERhdGUoRGF0ZS5ub3coKSAtIDg2NDAwMDAwKSwgLy8gMSBkYXkgYWdvXG4gICAgICAgICAgc3VzcGVuZGVkQnk6IFRFU1RfVVNFUl9JRFMuQURNSU4sXG4gICAgICAgICAgdW5zdXNwZW5kZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgICB1bnN1c3BlbmRlZEJ5OiBURVNUX1VTRVJfSURTLkFETUlOLFxuICAgICAgICB9XSxcbiAgICAgIH07XG4gICAgICBtb2NrQWRtaW5TZXJ2aWNlLnVuc3VzcGVuZFVzZXIubW9ja1Jlc29sdmVkVmFsdWUodW5zdXNwZW5kZWRVc2VyKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci51bnN1c3BlbmRVc2VyKFRFU1RfVVNFUl9JRFMuQURNSU4sIHVzZXJJZCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwodW5zdXNwZW5kZWRVc2VyKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuc3RhdHVzKS50b0JlKCdhY3RpdmUnKTtcbiAgICAgIGV4cGVjdChhZG1pblNlcnZpY2UudW5zdXNwZW5kVXNlcikudG9IYXZlQmVlbkNhbGxlZFdpdGgodXNlcklkLCBURVNUX1VTRVJfSURTLkFETUlOKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHVzZXIgbm90IGZvdW5kJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgbm90Rm91bmRFcnJvciA9IG5ldyBFcnJvcignVXNlciBub3QgZm91bmQnKTtcbiAgICAgIG1vY2tBZG1pblNlcnZpY2UudW5zdXNwZW5kVXNlci5tb2NrUmVqZWN0ZWRWYWx1ZShub3RGb3VuZEVycm9yKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLnVuc3VzcGVuZFVzZXIoVEVTVF9VU0VSX0lEUy5BRE1JTiwgJ25vbi1leGlzdGVudC1pZCcpXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhIdHRwRXhjZXB0aW9uKTtcbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci51bnN1c3BlbmRVc2VyKFRFU1RfVVNFUl9JRFMuQURNSU4sICdub24tZXhpc3RlbnQtaWQnKVxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coJ0ZhaWxlZCB0byB1bnN1c3BlbmQgdXNlcicpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgdXNlciBub3Qgc3VzcGVuZGVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgbm90U3VzcGVuZGVkRXJyb3IgPSBuZXcgRXJyb3IoJ1VzZXIgaXMgbm90IHN1c3BlbmRlZCcpO1xuICAgICAgbW9ja0FkbWluU2VydmljZS51bnN1c3BlbmRVc2VyLm1vY2tSZWplY3RlZFZhbHVlKG5vdFN1c3BlbmRlZEVycm9yKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLnVuc3VzcGVuZFVzZXIoVEVTVF9VU0VSX0lEUy5BRE1JTiwgdXNlcklkKVxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coSHR0cEV4Y2VwdGlvbik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGxvZyBhZG1pbiBhY3Rpb25zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbG9nU3B5ID0gamVzdC5zcHlPbihjb250cm9sbGVyWydsb2dnZXInXSwgJ2xvZycpO1xuICAgICAgY29uc3QgdW5zdXNwZW5kZWRVc2VyID0geyAuLi5tb2NrVXNlciwgc3RhdHVzOiAnYWN0aXZlJyB9O1xuICAgICAgbW9ja0FkbWluU2VydmljZS51bnN1c3BlbmRVc2VyLm1vY2tSZXNvbHZlZFZhbHVlKHVuc3VzcGVuZGVkVXNlcik7XG5cbiAgICAgIGF3YWl0IGNvbnRyb2xsZXIudW5zdXNwZW5kVXNlcihURVNUX1VTRVJfSURTLkFETUlOLCB1c2VySWQpO1xuXG4gICAgICBleHBlY3QobG9nU3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChgQWRtaW4gJHtURVNUX1VTRVJfSURTLkFETUlOfSB1bnN1c3BlbmRpbmcgdXNlciAke3VzZXJJZH1gKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHNlcnZpY2UgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgc2VydmljZUVycm9yID0gbmV3IEVycm9yKCdEYXRhYmFzZSB1cGRhdGUgZmFpbGVkJyk7XG4gICAgICBtb2NrQWRtaW5TZXJ2aWNlLnVuc3VzcGVuZFVzZXIubW9ja1JlamVjdGVkVmFsdWUoc2VydmljZUVycm9yKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLnVuc3VzcGVuZFVzZXIoVEVTVF9VU0VSX0lEUy5BRE1JTiwgdXNlcklkKVxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coSHR0cEV4Y2VwdGlvbik7XG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIudW5zdXNwZW5kVXNlcihURVNUX1VTRVJfSURTLkFETUlOLCB1c2VySWQpXG4gICAgICApLnJlamVjdHMudG9UaHJvdygnRmFpbGVkIHRvIHVuc3VzcGVuZCB1c2VyJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlc3RvcmUgdXNlciBwcml2aWxlZ2VzIGFmdGVyIHVuc3VzcGVuc2lvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHVuc3VzcGVuZGVkVXNlciA9IHtcbiAgICAgICAgLi4ubW9ja1VzZXIsXG4gICAgICAgIHN0YXR1czogJ2FjdGl2ZScsXG4gICAgICAgIHByaXZpbGVnZXM6IHtcbiAgICAgICAgICBjYW5Mb2dpbjogdHJ1ZSxcbiAgICAgICAgICBjYW5Cb29rU2Vzc2lvbnM6IHRydWUsXG4gICAgICAgICAgY2FuQWNjZXNzQ29tbXVuaXR5OiB0cnVlLFxuICAgICAgICAgIGNhblNlbmRNZXNzYWdlczogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgICAgc3VzcGVuc2lvbkhpc3Rvcnk6IFt7XG4gICAgICAgICAgcmVhc29uOiAnUG9saWN5IHZpb2xhdGlvbicsXG4gICAgICAgICAgc3VzcGVuZGVkQXQ6IG5ldyBEYXRlKERhdGUubm93KCkgLSA4NjQwMDAwMCksXG4gICAgICAgICAgc3VzcGVuZGVkQnk6IFRFU1RfVVNFUl9JRFMuQURNSU4sXG4gICAgICAgICAgdW5zdXNwZW5kZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgICB1bnN1c3BlbmRlZEJ5OiBURVNUX1VTRVJfSURTLkFETUlOLFxuICAgICAgICB9XSxcbiAgICAgIH07XG4gICAgICBtb2NrQWRtaW5TZXJ2aWNlLnVuc3VzcGVuZFVzZXIubW9ja1Jlc29sdmVkVmFsdWUodW5zdXNwZW5kZWRVc2VyKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci51bnN1c3BlbmRVc2VyKFRFU1RfVVNFUl9JRFMuQURNSU4sIHVzZXJJZCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQucHJpdmlsZWdlcy5jYW5Mb2dpbikudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQucHJpdmlsZWdlcy5jYW5Cb29rU2Vzc2lvbnMpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QocmVzdWx0LnByaXZpbGVnZXMuY2FuQWNjZXNzQ29tbXVuaXR5KS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5wcml2aWxlZ2VzLmNhblNlbmRNZXNzYWdlcykudG9CZSh0cnVlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0Vycm9yIEhhbmRsaW5nJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIHNlcnZpY2UgdW5hdmFpbGFibGUgc2NlbmFyaW9zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgc2VydmljZUVycm9yID0gbmV3IEVycm9yKCdTZXJ2aWNlIHRlbXBvcmFyaWx5IHVuYXZhaWxhYmxlJyk7XG4gICAgICBtb2NrQWRtaW5TZXJ2aWNlLmdldEFsbFVzZXJzLm1vY2tSZWplY3RlZFZhbHVlKHNlcnZpY2VFcnJvcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChjb250cm9sbGVyLmdldEFsbFVzZXJzKFRFU1RfVVNFUl9JRFMuQURNSU4sIHt9KSkucmVqZWN0cy50b1Rocm93KEh0dHBFeGNlcHRpb24pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZGF0YWJhc2UgY29ubmVjdGlvbiBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBkYkVycm9yID0gbmV3IEVycm9yKCdEYXRhYmFzZSBjb25uZWN0aW9uIGZhaWxlZCcpO1xuICAgICAgbW9ja0FkbWluU2VydmljZS5nZXRVc2VyLm1vY2tSZWplY3RlZFZhbHVlKGRiRXJyb3IpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoY29udHJvbGxlci5nZXRVc2VyKFRFU1RfVVNFUl9JRFMuQURNSU4sIFRFU1RfVVNFUl9JRFMuQ0xJRU5UKSkucmVqZWN0cy50b1Rocm93KEh0dHBFeGNlcHRpb24pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgdmFsaWRhdGlvbiBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB2YWxpZGF0aW9uRXJyb3IgPSBuZXcgRXJyb3IoJ0ludmFsaWQgdXNlciBkYXRhJyk7XG4gICAgICBtb2NrQWRtaW5TZXJ2aWNlLnN1c3BlbmRVc2VyLm1vY2tSZWplY3RlZFZhbHVlKHZhbGlkYXRpb25FcnJvcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5zdXNwZW5kVXNlcihURVNUX1VTRVJfSURTLkFETUlOLCBURVNUX1VTRVJfSURTLkNMSUVOVCwgeyByZWFzb246ICcnIH0pXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhIdHRwRXhjZXB0aW9uKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcHJlc2VydmUgSHR0cEV4Y2VwdGlvbnMgZnJvbSBzZXJ2aWNlIGxheWVyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgaHR0cEV4Y2VwdGlvbiA9IG5ldyBIdHRwRXhjZXB0aW9uKCdVc2VyIG5vdCBmb3VuZCcsIEh0dHBTdGF0dXMuTk9UX0ZPVU5EKTtcbiAgICAgIG1vY2tBZG1pblNlcnZpY2UuZ2V0VXNlci5tb2NrUmVqZWN0ZWRWYWx1ZShodHRwRXhjZXB0aW9uKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KGNvbnRyb2xsZXIuZ2V0VXNlcihURVNUX1VTRVJfSURTLkFETUlOLCBURVNUX1VTRVJfSURTLkNMSUVOVCkpLnJlamVjdHMudG9UaHJvdyhodHRwRXhjZXB0aW9uKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1Jlc3BvbnNlIEZvcm1hdCBWYWxpZGF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIHByb3Blcmx5IGZvcm1hdHRlZCB1c2VycyBsaXN0IHJlc3BvbnNlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0FkbWluU2VydmljZS5nZXRBbGxVc2Vycy5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXNlcnNMaXN0KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRBbGxVc2VycyhURVNUX1VTRVJfSURTLkFETUlOLCB7fSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCd1c2VycycpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ3BhZ2luYXRpb24nKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdzdW1tYXJ5Jyk7XG4gICAgICBleHBlY3QoQXJyYXkuaXNBcnJheShyZXN1bHQudXNlcnMpKS50b0JlKHRydWUpO1xuICAgICAgcmVzdWx0LnVzZXJzLmZvckVhY2goKHVzZXIpID0+IHtcbiAgICAgICAgVGVzdEFzc2VydGlvbnMuZXhwZWN0VmFsaWRFbnRpdHkodXNlciwgWydpZCcsICdlbWFpbCcsICdmaXJzdE5hbWUnLCAnbGFzdE5hbWUnLCAncm9sZScsICdzdGF0dXMnXSk7XG4gICAgICAgIGV4cGVjdChbJ2NsaWVudCcsICd0aGVyYXBpc3QnLCAnbW9kZXJhdG9yJywgJ2FkbWluJ10pLnRvQ29udGFpbih1c2VyLnJvbGUpO1xuICAgICAgICBleHBlY3QoWydhY3RpdmUnLCAnc3VzcGVuZGVkJywgJ2luYWN0aXZlJ10pLnRvQ29udGFpbih1c2VyLnN0YXR1cyk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIHByb3Blcmx5IGZvcm1hdHRlZCB1c2VyIGRldGFpbHMgcmVzcG9uc2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrQWRtaW5TZXJ2aWNlLmdldFVzZXIubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXIpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldFVzZXIoVEVTVF9VU0VSX0lEUy5BRE1JTiwgVEVTVF9VU0VSX0lEUy5DTElFTlQpO1xuXG4gICAgICBUZXN0QXNzZXJ0aW9ucy5leHBlY3RWYWxpZEVudGl0eShyZXN1bHQsIFsnaWQnLCAnZW1haWwnLCAnZmlyc3ROYW1lJywgJ2xhc3ROYW1lJywgJ3JvbGUnLCAnc3RhdHVzJ10pO1xuICAgICAgZXhwZWN0KHJlc3VsdC5pc0VtYWlsVmVyaWZpZWQpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QodHlwZW9mIHJlc3VsdC5pc0VtYWlsVmVyaWZpZWQpLnRvQmUoJ2Jvb2xlYW4nKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuY3JlYXRlZEF0KS50b0JlSW5zdGFuY2VPZihEYXRlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQudXBkYXRlZEF0KS50b0JlSW5zdGFuY2VPZihEYXRlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIHByb3Blcmx5IGZvcm1hdHRlZCBzdXNwZW5zaW9uIHJlc3BvbnNlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0FkbWluU2VydmljZS5zdXNwZW5kVXNlci5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrU3VzcGVuZGVkVXNlcik7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuc3VzcGVuZFVzZXIoVEVTVF9VU0VSX0lEUy5BRE1JTiwgVEVTVF9VU0VSX0lEUy5DTElFTlQsIHtcbiAgICAgICAgcmVhc29uOiAnUG9saWN5IHZpb2xhdGlvbicsXG4gICAgICAgIGR1cmF0aW9uOiAzMCxcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QocmVzdWx0LnN0YXR1cykudG9CZSgnc3VzcGVuZGVkJyk7XG4gICAgICBleHBlY3QocmVzdWx0LnN1c3BlbnNpb24pLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QocmVzdWx0LnN1c3BlbnNpb24ucmVhc29uKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5zdXNwZW5zaW9uLnN1c3BlbmRlZEF0KS50b0JlSW5zdGFuY2VPZihEYXRlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VzcGVuc2lvbi5zdXNwZW5kZWRCeSkudG9CZShURVNUX1VTRVJfSURTLkFETUlOKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0ludGVncmF0aW9uIFRlc3RzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbXBsZXRlIHVzZXIgbWFuYWdlbWVudCB3b3JrZmxvdycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEdldCB1c2VyIGRldGFpbHNcbiAgICAgIG1vY2tBZG1pblNlcnZpY2UuZ2V0VXNlci5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXNlcik7XG4gICAgICBjb25zdCB1c2VyID0gYXdhaXQgY29udHJvbGxlci5nZXRVc2VyKFRFU1RfVVNFUl9JRFMuQURNSU4sIFRFU1RfVVNFUl9JRFMuQ0xJRU5UKTtcbiAgICAgIGV4cGVjdCh1c2VyKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHVzZXIuc3RhdHVzKS50b0JlKCdhY3RpdmUnKTtcblxuICAgICAgLy8gU3VzcGVuZCB1c2VyXG4gICAgICBtb2NrQWRtaW5TZXJ2aWNlLnN1c3BlbmRVc2VyLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tTdXNwZW5kZWRVc2VyKTtcbiAgICAgIGNvbnN0IHN1c3BlbmRlZFVzZXIgPSBhd2FpdCBjb250cm9sbGVyLnN1c3BlbmRVc2VyKFRFU1RfVVNFUl9JRFMuQURNSU4sIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULCB7XG4gICAgICAgIHJlYXNvbjogJ1BvbGljeSB2aW9sYXRpb24nLFxuICAgICAgICBkdXJhdGlvbjogMzAsXG4gICAgICB9KTtcbiAgICAgIGV4cGVjdChzdXNwZW5kZWRVc2VyLnN0YXR1cykudG9CZSgnc3VzcGVuZGVkJyk7XG5cbiAgICAgIC8vIFVuc3VzcGVuZCB1c2VyXG4gICAgICBjb25zdCB1bnN1c3BlbmRlZFVzZXIgPSB7IC4uLm1vY2tVc2VyLCBzdGF0dXM6ICdhY3RpdmUnIH07XG4gICAgICBtb2NrQWRtaW5TZXJ2aWNlLnVuc3VzcGVuZFVzZXIubW9ja1Jlc29sdmVkVmFsdWUodW5zdXNwZW5kZWRVc2VyKTtcbiAgICAgIGNvbnN0IHJlc3RvcmVkVXNlciA9IGF3YWl0IGNvbnRyb2xsZXIudW5zdXNwZW5kVXNlcihURVNUX1VTRVJfSURTLkFETUlOLCBURVNUX1VTRVJfSURTLkNMSUVOVCk7XG4gICAgICBleHBlY3QocmVzdG9yZWRVc2VyLnN0YXR1cykudG9CZSgnYWN0aXZlJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSB1c2VyIHNlYXJjaCBhbmQgZmlsdGVyaW5nIHdvcmtmbG93JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gU2VhcmNoIGZvciB1c2VycyBieSBuYW1lXG4gICAgICBjb25zdCBzZWFyY2hSZXN1bHRzID0ge1xuICAgICAgICAuLi5tb2NrVXNlcnNMaXN0LFxuICAgICAgICB1c2VyczogW21vY2tVc2VyXSxcbiAgICAgIH07XG4gICAgICBtb2NrQWRtaW5TZXJ2aWNlLmdldEFsbFVzZXJzLm1vY2tSZXNvbHZlZFZhbHVlKHNlYXJjaFJlc3VsdHMpO1xuICAgICAgY29uc3Qgc2VhcmNoUmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRBbGxVc2VycyhURVNUX1VTRVJfSURTLkFETUlOLCB7IHNlYXJjaDogJ2pvaG4nIH0pO1xuICAgICAgZXhwZWN0KHNlYXJjaFJlc3VsdC51c2VycykudG9IYXZlTGVuZ3RoKDEpO1xuXG4gICAgICAvLyBGaWx0ZXIgYnkgcm9sZVxuICAgICAgY29uc3Qgcm9sZVJlc3VsdHMgPSB7XG4gICAgICAgIC4uLm1vY2tVc2Vyc0xpc3QsXG4gICAgICAgIHVzZXJzOiBbbW9ja1RoZXJhcGlzdF0sXG4gICAgICB9O1xuICAgICAgbW9ja0FkbWluU2VydmljZS5nZXRBbGxVc2Vycy5tb2NrUmVzb2x2ZWRWYWx1ZShyb2xlUmVzdWx0cyk7XG4gICAgICBjb25zdCByb2xlUmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRBbGxVc2VycyhURVNUX1VTRVJfSURTLkFETUlOLCB7IHJvbGU6ICd0aGVyYXBpc3QnIH0pO1xuICAgICAgZXhwZWN0KHJvbGVSZXN1bHQudXNlcnMuZXZlcnkodXNlciA9PiB1c2VyLnJvbGUgPT09ICd0aGVyYXBpc3QnKSkudG9CZSh0cnVlKTtcblxuICAgICAgLy8gRmlsdGVyIGJ5IHN0YXR1c1xuICAgICAgY29uc3Qgc3RhdHVzUmVzdWx0cyA9IHtcbiAgICAgICAgLi4ubW9ja1VzZXJzTGlzdCxcbiAgICAgICAgdXNlcnM6IG1vY2tVc2Vyc0xpc3QudXNlcnMuZmlsdGVyKHVzZXIgPT4gdXNlci5zdGF0dXMgPT09ICdhY3RpdmUnKSxcbiAgICAgIH07XG4gICAgICBtb2NrQWRtaW5TZXJ2aWNlLmdldEFsbFVzZXJzLm1vY2tSZXNvbHZlZFZhbHVlKHN0YXR1c1Jlc3VsdHMpO1xuICAgICAgY29uc3Qgc3RhdHVzUmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRBbGxVc2VycyhURVNUX1VTRVJfSURTLkFETUlOLCB7IHN0YXR1czogJ2FjdGl2ZScgfSk7XG4gICAgICBleHBlY3Qoc3RhdHVzUmVzdWx0LnVzZXJzLmV2ZXJ5KHVzZXIgPT4gdXNlci5zdGF0dXMgPT09ICdhY3RpdmUnKSkudG9CZSh0cnVlKTtcbiAgICB9KTtcbiAgfSk7XG59KTsiXSwidmVyc2lvbiI6M30=