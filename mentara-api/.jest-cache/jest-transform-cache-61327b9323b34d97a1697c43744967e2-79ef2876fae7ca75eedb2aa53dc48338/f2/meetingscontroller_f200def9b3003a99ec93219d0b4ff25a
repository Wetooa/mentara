f4898da2ddce16b96b6378dd26d6b2b2
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
var _a, _b, _c, _d, _e;
Object.defineProperty(exports, "__esModule", { value: true });
exports.MeetingsController = void 0;
const common_1 = require("@nestjs/common");
const meetings_service_1 = require("./meetings.service");
const jwt_auth_guard_1 = require("../auth/guards/jwt-auth.guard");
const current_user_id_decorator_1 = require("../auth/decorators/current-user-id.decorator");
let MeetingsController = class MeetingsController {
    meetingsService;
    constructor(meetingsService) {
        this.meetingsService = meetingsService;
    }
    // Specific routes must come before parameterized routes
    async getUpcomingMeetings(userId, limit) {
        return this.meetingsService.getUpcomingMeetings(userId, limit);
    }
    async getCompletedMeetings(userId, limit) {
        return this.meetingsService.getCompletedMeetings(userId, limit);
    }
    async getCancelledMeetings(userId, limit) {
        return this.meetingsService.getCancelledMeetings(userId, limit);
    }
    async getInProgressMeetings(userId, limit) {
        return this.meetingsService.getInProgressMeetings(userId, limit);
    }
    async getMeeting(meetingId, userId) {
        return this.meetingsService.getMeetingById(meetingId, userId);
    }
    async updateMeetingStatus(meetingId, userId, updateStatusDto) {
        return this.meetingsService.updateMeetingStatus(meetingId, userId, updateStatusDto);
    }
    // ===== VIDEO CALL INTEGRATION ENDPOINTS =====
    async createVideoRoom(meetingId, userId, createRoomDto) {
        return this.meetingsService.createVideoRoom(meetingId, userId, createRoomDto);
    }
    async joinVideoRoom(meetingId, userId, joinRoomDto) {
        return this.meetingsService.joinVideoRoom(meetingId, userId, joinRoomDto);
    }
    async getVideoCallStatus(meetingId, userId) {
        return this.meetingsService.getVideoCallStatus(meetingId, userId);
    }
    async endVideoCall(meetingId, userId, endCallDto) {
        return this.meetingsService.endVideoCall(meetingId, userId, endCallDto);
    }
    // Legacy endpoint for backward compatibility
    async generateMeetingRoom(meetingId, userId) {
        // Redirect to new video room creation with default settings
        const defaultCreateDto = {
            meetingId,
            roomType: 'consultation',
            maxParticipants: 2,
            enableRecording: false,
            enableChat: true,
        };
        return this.meetingsService.createVideoRoom(meetingId, userId, defaultCreateDto);
    }
    async getAllMeetings(userId, status, type, limit, offset, dateFrom, dateTo) {
        const queryOptions = {
            status,
            type,
            limit,
            offset,
            dateFrom,
            dateTo,
        };
        return this.meetingsService.getAllMeetings(userId, queryOptions);
    }
    async saveMeetingSession(meetingId, userId, sessionData) {
        // Validate user has access to this meeting
        await this.meetingsService.getMeetingById(meetingId, userId);
        return this.meetingsService.saveMeetingSession(meetingId, userId, sessionData);
    }
    async getTherapistMeetingAnalytics(userId, startDate, endDate) {
        const dateRange = startDate && endDate
            ? {
                start: new Date(startDate),
                end: new Date(endDate),
            }
            : undefined;
        return this.meetingsService.getMeetingAnalytics(userId, dateRange);
    }
    async emergencyTerminate(meetingId, userId, body) {
        return this.meetingsService.emergencyTerminateMeeting(meetingId, body.reason, userId);
    }
};
exports.MeetingsController = MeetingsController;
__decorate([
    (0, common_1.Get)('upcoming'),
    __param(0, (0, current_user_id_decorator_1.CurrentUserId)()),
    __param(1, (0, common_1.Query)('limit', new common_1.ParseIntPipe({ optional: true }))),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, Number]),
    __metadata("design:returntype", Promise)
], MeetingsController.prototype, "getUpcomingMeetings", null);
__decorate([
    (0, common_1.Get)('completed'),
    __param(0, (0, current_user_id_decorator_1.CurrentUserId)()),
    __param(1, (0, common_1.Query)('limit', new common_1.ParseIntPipe({ optional: true }))),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, Number]),
    __metadata("design:returntype", Promise)
], MeetingsController.prototype, "getCompletedMeetings", null);
__decorate([
    (0, common_1.Get)('cancelled'),
    __param(0, (0, current_user_id_decorator_1.CurrentUserId)()),
    __param(1, (0, common_1.Query)('limit', new common_1.ParseIntPipe({ optional: true }))),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, Number]),
    __metadata("design:returntype", Promise)
], MeetingsController.prototype, "getCancelledMeetings", null);
__decorate([
    (0, common_1.Get)('in-progress'),
    __param(0, (0, current_user_id_decorator_1.CurrentUserId)()),
    __param(1, (0, common_1.Query)('limit', new common_1.ParseIntPipe({ optional: true }))),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, Number]),
    __metadata("design:returntype", Promise)
], MeetingsController.prototype, "getInProgressMeetings", null);
__decorate([
    (0, common_1.Get)(':id'),
    __param(0, (0, common_1.Param)('id')),
    __param(1, (0, current_user_id_decorator_1.CurrentUserId)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, String]),
    __metadata("design:returntype", Promise)
], MeetingsController.prototype, "getMeeting", null);
__decorate([
    (0, common_1.Put)(':id/status'),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, common_1.Param)('id')),
    __param(1, (0, current_user_id_decorator_1.CurrentUserId)()),
    __param(2, (0, common_1.Body)( /* validation disabled */)),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, String, Object]),
    __metadata("design:returntype", Promise)
], MeetingsController.prototype, "updateMeetingStatus", null);
__decorate([
    (0, common_1.Post)(':id/video-room'),
    (0, common_1.HttpCode)(common_1.HttpStatus.CREATED),
    __param(0, (0, common_1.Param)('id')),
    __param(1, (0, current_user_id_decorator_1.CurrentUserId)()),
    __param(2, (0, common_1.Body)( /* validation disabled */)),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, String, Object]),
    __metadata("design:returntype", typeof (_b = typeof Promise !== "undefined" && Promise) === "function" ? _b : Object)
], MeetingsController.prototype, "createVideoRoom", null);
__decorate([
    (0, common_1.Post)(':id/join-video'),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, common_1.Param)('id')),
    __param(1, (0, current_user_id_decorator_1.CurrentUserId)()),
    __param(2, (0, common_1.Body)( /* validation disabled */)),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, String, Object]),
    __metadata("design:returntype", typeof (_c = typeof Promise !== "undefined" && Promise) === "function" ? _c : Object)
], MeetingsController.prototype, "joinVideoRoom", null);
__decorate([
    (0, common_1.Get)(':id/video-status'),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, common_1.Param)('id')),
    __param(1, (0, current_user_id_decorator_1.CurrentUserId)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, String]),
    __metadata("design:returntype", typeof (_d = typeof Promise !== "undefined" && Promise) === "function" ? _d : Object)
], MeetingsController.prototype, "getVideoCallStatus", null);
__decorate([
    (0, common_1.Delete)(':id/video-room'),
    (0, common_1.HttpCode)(common_1.HttpStatus.NO_CONTENT),
    __param(0, (0, common_1.Param)('id')),
    __param(1, (0, current_user_id_decorator_1.CurrentUserId)()),
    __param(2, (0, common_1.Body)( /* validation disabled */)),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, String, Object]),
    __metadata("design:returntype", typeof (_e = typeof Promise !== "undefined" && Promise) === "function" ? _e : Object)
], MeetingsController.prototype, "endVideoCall", null);
__decorate([
    (0, common_1.Post)(':id/room'),
    __param(0, (0, common_1.Param)('id')),
    __param(1, (0, current_user_id_decorator_1.CurrentUserId)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, String]),
    __metadata("design:returntype", Promise)
], MeetingsController.prototype, "generateMeetingRoom", null);
__decorate([
    (0, common_1.Get)(),
    __param(0, (0, current_user_id_decorator_1.CurrentUserId)()),
    __param(1, (0, common_1.Query)('status')),
    __param(2, (0, common_1.Query)('type')),
    __param(3, (0, common_1.Query)('limit', new common_1.ParseIntPipe({ optional: true }))),
    __param(4, (0, common_1.Query)('offset', new common_1.ParseIntPipe({ optional: true }))),
    __param(5, (0, common_1.Query)('dateFrom')),
    __param(6, (0, common_1.Query)('dateTo')),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, String, String, Number, Number, String, String]),
    __metadata("design:returntype", Promise)
], MeetingsController.prototype, "getAllMeetings", null);
__decorate([
    (0, common_1.Post)(':id/session'),
    (0, common_1.HttpCode)(common_1.HttpStatus.CREATED),
    __param(0, (0, common_1.Param)('id')),
    __param(1, (0, current_user_id_decorator_1.CurrentUserId)()),
    __param(2, (0, common_1.Body)( /* validation disabled */)),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, String, Object]),
    __metadata("design:returntype", Promise)
], MeetingsController.prototype, "saveMeetingSession", null);
__decorate([
    (0, common_1.Get)('analytics/therapist'),
    __param(0, (0, current_user_id_decorator_1.CurrentUserId)()),
    __param(1, (0, common_1.Query)('startDate')),
    __param(2, (0, common_1.Query)('endDate')),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, String, String]),
    __metadata("design:returntype", Promise)
], MeetingsController.prototype, "getTherapistMeetingAnalytics", null);
__decorate([
    (0, common_1.Post)(':id/emergency-terminate'),
    __param(0, (0, common_1.Param)('id')),
    __param(1, (0, current_user_id_decorator_1.CurrentUserId)()),
    __param(2, (0, common_1.Body)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, String, Object]),
    __metadata("design:returntype", Promise)
], MeetingsController.prototype, "emergencyTerminate", null);
exports.MeetingsController = MeetingsController = __decorate([
    (0, common_1.Controller)('meetings'),
    (0, common_1.UseGuards)(jwt_auth_guard_1.JwtAuthGuard),
    __metadata("design:paramtypes", [typeof (_a = typeof meetings_service_1.MeetingsService !== "undefined" && meetings_service_1.MeetingsService) === "function" ? _a : Object])
], MeetingsController);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL21lZXRpbmdzL21lZXRpbmdzLmNvbnRyb2xsZXIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLDJDQWF3QjtBQUN4Qix5REFBcUQ7QUFDckQsa0VBQTZEO0FBQzdELDRGQUE2RTtBQWN0RSxJQUFNLGtCQUFrQixHQUF4QixNQUFNLGtCQUFrQjtJQUNBO0lBQTdCLFlBQTZCLGVBQWdDO1FBQWhDLG9CQUFlLEdBQWYsZUFBZSxDQUFpQjtJQUFHLENBQUM7SUFFakUsd0RBQXdEO0lBRWxELEFBQU4sS0FBSyxDQUFDLG1CQUFtQixDQUNOLE1BQWMsRUFDdUIsS0FBYztRQUVwRSxPQUFPLElBQUksQ0FBQyxlQUFlLENBQUMsbUJBQW1CLENBQUMsTUFBTSxFQUFFLEtBQUssQ0FBQyxDQUFDO0lBQ2pFLENBQUM7SUFHSyxBQUFOLEtBQUssQ0FBQyxvQkFBb0IsQ0FDUCxNQUFjLEVBQ3VCLEtBQWM7UUFFcEUsT0FBTyxJQUFJLENBQUMsZUFBZSxDQUFDLG9CQUFvQixDQUFDLE1BQU0sRUFBRSxLQUFLLENBQUMsQ0FBQztJQUNsRSxDQUFDO0lBR0ssQUFBTixLQUFLLENBQUMsb0JBQW9CLENBQ1AsTUFBYyxFQUN1QixLQUFjO1FBRXBFLE9BQU8sSUFBSSxDQUFDLGVBQWUsQ0FBQyxvQkFBb0IsQ0FBQyxNQUFNLEVBQUUsS0FBSyxDQUFDLENBQUM7SUFDbEUsQ0FBQztJQUdLLEFBQU4sS0FBSyxDQUFDLHFCQUFxQixDQUNSLE1BQWMsRUFDdUIsS0FBYztRQUVwRSxPQUFPLElBQUksQ0FBQyxlQUFlLENBQUMscUJBQXFCLENBQUMsTUFBTSxFQUFFLEtBQUssQ0FBQyxDQUFDO0lBQ25FLENBQUM7SUFHSyxBQUFOLEtBQUssQ0FBQyxVQUFVLENBQ0QsU0FBaUIsRUFDYixNQUFjO1FBRS9CLE9BQU8sSUFBSSxDQUFDLGVBQWUsQ0FBQyxjQUFjLENBQUMsU0FBUyxFQUFFLE1B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SUFBSSxDQUFDLENBQUE7SUFDWCxXQUFBLElBQUEseUNBQWEsR0FBRSxDQUFBO0lBQ2YsV0FBQSxJQUFBLGFBQUksR0FBQyx5QkFBeUIsQ0FBQyxDQUFBOzs7OzREQVdqQztBQUdLO0lBREwsSUFBQSxZQUFHLEVBQUMscUJBQXFCLENBQUM7SUFFeEIsV0FBQSxJQUFBLHlDQUFhLEdBQUUsQ0FBQTtJQUNmLFdBQUEsSUFBQSxjQUFLLEVBQUMsV0FBVyxDQUFDLENBQUE7SUFDbEIsV0FBQSxJQUFBLGNBQUssRUFBQyxTQUFTLENBQUMsQ0FBQTs7OztzRUFXbEI7QUFHSztJQURMLElBQUEsYUFBSSxFQUFDLHlCQUF5QixDQUFDO0lBRTdCLFdBQUEsSUFBQSxjQUFLLEVBQUMsSUFBSSxDQUFDLENBQUE7SUFDWCxXQUFBLElBQUEseUNBQWEsR0FBRSxDQUFBO0lBQ2YsV0FBQSxJQUFBLGFBQUksR0FBRSxDQUFBOzs7OzREQU9SOzZCQW5NVSxrQkFBa0I7SUFGOUIsSUFBQSxtQkFBVSxFQUFDLFVBQVUsQ0FBQztJQUN0QixJQUFBLGtCQUFTLEVBQUMsNkJBQVksQ0FBQzt5REFFd0Isa0NBQWUsb0JBQWYsa0NBQWU7R0FEbEQsa0JBQWtCLENBb005QiIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS93ZXRvb2EvRG9jdW1lbnRzL2NvZGUvcHJvamVjdHMvbWVudGFyYS9tZW50YXJhLWFwaS9zcmMvbWVldGluZ3MvbWVldGluZ3MuY29udHJvbGxlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBDb250cm9sbGVyLFxuICBHZXQsXG4gIFBvc3QsXG4gIFB1dCxcbiAgRGVsZXRlLFxuICBQYXJhbSxcbiAgQm9keSxcbiAgVXNlR3VhcmRzLFxuICBRdWVyeSxcbiAgSHR0cENvZGUsXG4gIEh0dHBTdGF0dXMsXG4gIFBhcnNlSW50UGlwZSxcbn0gZnJvbSAnQG5lc3Rqcy9jb21tb24nO1xuaW1wb3J0IHsgTWVldGluZ3NTZXJ2aWNlIH0gZnJvbSAnLi9tZWV0aW5ncy5zZXJ2aWNlJztcbmltcG9ydCB7IEp3dEF1dGhHdWFyZCB9IGZyb20gJy4uL2F1dGgvZ3VhcmRzL2p3dC1hdXRoLmd1YXJkJztcbmltcG9ydCB7IEN1cnJlbnRVc2VySWQgfSBmcm9tICcuLi9hdXRoL2RlY29yYXRvcnMvY3VycmVudC11c2VyLWlkLmRlY29yYXRvcic7XG4vLyBUT0RPOiBBZGQgdmFsaWRhdGlvbiBzY2hlbWFzIHdoZW4gbmVlZGVkXG5pbXBvcnQgdHlwZSB7XG4gIENyZWF0ZVZpZGVvUm9vbUR0byxcbiAgSm9pblZpZGVvUm9vbUR0byxcbiAgRW5kVmlkZW9DYWxsRHRvLFxuICBWaWRlb1Jvb21SZXNwb25zZSxcbiAgVmlkZW9DYWxsU3RhdHVzLFxuICBVcGRhdGVNZWV0aW5nU3RhdHVzRHRvLFxuICBTYXZlTWVldGluZ1Nlc3Npb25EdG8sXG59IGZyb20gJy4vdHlwZXMnO1xuXG5AQ29udHJvbGxlcignbWVldGluZ3MnKVxuQFVzZUd1YXJkcyhKd3RBdXRoR3VhcmQpXG5leHBvcnQgY2xhc3MgTWVldGluZ3NDb250cm9sbGVyIHtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSByZWFkb25seSBtZWV0aW5nc1NlcnZpY2U6IE1lZXRpbmdzU2VydmljZSkge31cblxuICAvLyBTcGVjaWZpYyByb3V0ZXMgbXVzdCBjb21lIGJlZm9yZSBwYXJhbWV0ZXJpemVkIHJvdXRlc1xuICBAR2V0KCd1cGNvbWluZycpXG4gIGFzeW5jIGdldFVwY29taW5nTWVldGluZ3MoXG4gICAgQEN1cnJlbnRVc2VySWQoKSB1c2VySWQ6IHN0cmluZyxcbiAgICBAUXVlcnkoJ2xpbWl0JywgbmV3IFBhcnNlSW50UGlwZSh7IG9wdGlvbmFsOiB0cnVlIH0pKSBsaW1pdD86IG51bWJlcixcbiAgKSB7XG4gICAgcmV0dXJuIHRoaXMubWVldGluZ3NTZXJ2aWNlLmdldFVwY29taW5nTWVldGluZ3ModXNlcklkLCBsaW1pdCk7XG4gIH1cblxuICBAR2V0KCdjb21wbGV0ZWQnKVxuICBhc3luYyBnZXRDb21wbGV0ZWRNZWV0aW5ncyhcbiAgICBAQ3VycmVudFVzZXJJZCgpIHVzZXJJZDogc3RyaW5nLFxuICAgIEBRdWVyeSgnbGltaXQnLCBuZXcgUGFyc2VJbnRQaXBlKHsgb3B0aW9uYWw6IHRydWUgfSkpIGxpbWl0PzogbnVtYmVyLFxuICApIHtcbiAgICByZXR1cm4gdGhpcy5tZWV0aW5nc1NlcnZpY2UuZ2V0Q29tcGxldGVkTWVldGluZ3ModXNlcklkLCBsaW1pdCk7XG4gIH1cblxuICBAR2V0KCdjYW5jZWxsZWQnKVxuICBhc3luYyBnZXRDYW5jZWxsZWRNZWV0aW5ncyhcbiAgICBAQ3VycmVudFVzZXJJZCgpIHVzZXJJZDogc3RyaW5nLFxuICAgIEBRdWVyeSgnbGltaXQnLCBuZXcgUGFyc2VJbnRQaXBlKHsgb3B0aW9uYWw6IHRydWUgfSkpIGxpbWl0PzogbnVtYmVyLFxuICApIHtcbiAgICByZXR1cm4gdGhpcy5tZWV0aW5nc1NlcnZpY2UuZ2V0Q2FuY2VsbGVkTWVldGluZ3ModXNlcklkLCBsaW1pdCk7XG4gIH1cblxuICBAR2V0KCdpbi1wcm9ncmVzcycpXG4gIGFzeW5jIGdldEluUHJvZ3Jlc3NNZWV0aW5ncyhcbiAgICBAQ3VycmVudFVzZXJJZCgpIHVzZXJJZDogc3RyaW5nLFxuICAgIEBRdWVyeSgnbGltaXQnLCBuZXcgUGFyc2VJbnRQaXBlKHsgb3B0aW9uYWw6IHRydWUgfSkpIGxpbWl0PzogbnVtYmVyLFxuICApIHtcbiAgICByZXR1cm4gdGhpcy5tZWV0aW5nc1NlcnZpY2UuZ2V0SW5Qcm9ncmVzc01lZXRpbmdzKHVzZXJJZCwgbGltaXQpO1xuICB9XG5cbiAgQEdldCgnOmlkJylcbiAgYXN5bmMgZ2V0TWVldGluZyhcbiAgICBAUGFyYW0oJ2lkJykgbWVldGluZ0lkOiBzdHJpbmcsXG4gICAgQEN1cnJlbnRVc2VySWQoKSB1c2VySWQ6IHN0cmluZyxcbiAgKSB7XG4gICAgcmV0dXJuIHRoaXMubWVldGluZ3NTZXJ2aWNlLmdldE1lZXRpbmdCeUlkKG1lZXRpbmdJZCwgdXNlcklkKTtcbiAgfVxuXG4gIEBQdXQoJzppZC9zdGF0dXMnKVxuICBASHR0cENvZGUoSHR0cFN0YXR1cy5PSylcbiAgYXN5bmMgdXBkYXRlTWVldGluZ1N0YXR1cyhcbiAgICBAUGFyYW0oJ2lkJykgbWVldGluZ0lkOiBzdHJpbmcsXG4gICAgQEN1cnJlbnRVc2VySWQoKSB1c2VySWQ6IHN0cmluZyxcbiAgICBAQm9keSgvKiB2YWxpZGF0aW9uIGRpc2FibGVkICovKVxuICAgIHVwZGF0ZVN0YXR1c0R0bzogVXBkYXRlTWVldGluZ1N0YXR1c0R0byxcbiAgKSB7XG4gICAgcmV0dXJuIHRoaXMubWVldGluZ3NTZXJ2aWNlLnVwZGF0ZU1lZXRpbmdTdGF0dXMoXG4gICAgICBtZWV0aW5nSWQsXG4gICAgICB1c2VySWQsXG4gICAgICB1cGRhdGVTdGF0dXNEdG8sXG4gICAgKTtcbiAgfVxuXG4gIC8vID09PT09IFZJREVPIENBTEwgSU5URUdSQVRJT04gRU5EUE9JTlRTID09PT09XG5cbiAgQFBvc3QoJzppZC92aWRlby1yb29tJylcbiAgQEh0dHBDb2RlKEh0dHBTdGF0dXMuQ1JFQVRFRClcbiAgYXN5bmMgY3JlYXRlVmlkZW9Sb29tKFxuICAgIEBQYXJhbSgnaWQnKSBtZWV0aW5nSWQ6IHN0cmluZyxcbiAgICBAQ3VycmVudFVzZXJJZCgpIHVzZXJJZDogc3RyaW5nLFxuICAgIEBCb2R5KC8qIHZhbGlkYXRpb24gZGlzYWJsZWQgKi8pXG4gICAgY3JlYXRlUm9vbUR0bzogQ3JlYXRlVmlkZW9Sb29tRHRvLFxuICApOiBQcm9taXNlPFZpZGVvUm9vbVJlc3BvbnNlPiB7XG4gICAgcmV0dXJuIHRoaXMubWVldGluZ3NTZXJ2aWNlLmNyZWF0ZVZpZGVvUm9vbShcbiAgICAgIG1lZXRpbmdJZCxcbiAgICAgIHVzZXJJZCxcbiAgICAgIGNyZWF0ZVJvb21EdG8sXG4gICAgKTtcbiAgfVxuXG4gIEBQb3N0KCc6aWQvam9pbi12aWRlbycpXG4gIEBIdHRwQ29kZShIdHRwU3RhdHVzLk9LKVxuICBhc3luYyBqb2luVmlkZW9Sb29tKFxuICAgIEBQYXJhbSgnaWQnKSBtZWV0aW5nSWQ6IHN0cmluZyxcbiAgICBAQ3VycmVudFVzZXJJZCgpIHVzZXJJZDogc3RyaW5nLFxuICAgIEBCb2R5KC8qIHZhbGlkYXRpb24gZGlzYWJsZWQgKi8pXG4gICAgam9pblJvb21EdG86IEpvaW5WaWRlb1Jvb21EdG8sXG4gICk6IFByb21pc2U8VmlkZW9Sb29tUmVzcG9uc2U+IHtcbiAgICByZXR1cm4gdGhpcy5tZWV0aW5nc1NlcnZpY2Uuam9pblZpZGVvUm9vbShtZWV0aW5nSWQsIHVzZXJJZCwgam9pblJvb21EdG8pO1xuICB9XG5cbiAgQEdldCgnOmlkL3ZpZGVvLXN0YXR1cycpXG4gIEBIdHRwQ29kZShIdHRwU3RhdHVzLk9LKVxuICBhc3luYyBnZXRWaWRlb0NhbGxTdGF0dXMoXG4gICAgQFBhcmFtKCdpZCcpIG1lZXRpbmdJZDogc3RyaW5nLFxuICAgIEBDdXJyZW50VXNlcklkKCkgdXNlcklkOiBzdHJpbmcsXG4gICk6IFByb21pc2U8VmlkZW9DYWxsU3RhdHVzPiB7XG4gICAgcmV0dXJuIHRoaXMubWVldGluZ3NTZXJ2aWNlLmdldFZpZGVvQ2FsbFN0YXR1cyhtZWV0aW5nSWQsIHVzZXJJZCk7XG4gIH1cblxuICBARGVsZXRlKCc6aWQvdmlkZW8tcm9vbScpXG4gIEBIdHRwQ29kZShIdHRwU3RhdHVzLk5PX0NPTlRFTlQpXG4gIGFzeW5jIGVuZFZpZGVvQ2FsbChcbiAgICBAUGFyYW0oJ2lkJykgbWVldGluZ0lkOiBzdHJpbmcsXG4gICAgQEN1cnJlbnRVc2VySWQoKSB1c2VySWQ6IHN0cmluZyxcbiAgICBAQm9keSgvKiB2YWxpZGF0aW9uIGRpc2FibGVkICovKVxuICAgIGVuZENhbGxEdG86IEVuZFZpZGVvQ2FsbER0byxcbiAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgcmV0dXJuIHRoaXMubWVldGluZ3NTZXJ2aWNlLmVuZFZpZGVvQ2FsbChtZWV0aW5nSWQsIHVzZXJJZCwgZW5kQ2FsbER0byk7XG4gIH1cblxuICAvLyBMZWdhY3kgZW5kcG9pbnQgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHlcbiAgQFBvc3QoJzppZC9yb29tJylcbiAgYXN5bmMgZ2VuZXJhdGVNZWV0aW5nUm9vbShcbiAgICBAUGFyYW0oJ2lkJykgbWVldGluZ0lkOiBzdHJpbmcsXG4gICAgQEN1cnJlbnRVc2VySWQoKSB1c2VySWQ6IHN0cmluZyxcbiAgKSB7XG4gICAgLy8gUmVkaXJlY3QgdG8gbmV3IHZpZGVvIHJvb20gY3JlYXRpb24gd2l0aCBkZWZhdWx0IHNldHRpbmdzXG4gICAgY29uc3QgZGVmYXVsdENyZWF0ZUR0bzogQ3JlYXRlVmlkZW9Sb29tRHRvID0ge1xuICAgICAgbWVldGluZ0lkLFxuICAgICAgcm9vbVR5cGU6ICdjb25zdWx0YXRpb24nLFxuICAgICAgbWF4UGFydGljaXBhbnRzOiAyLFxuICAgICAgZW5hYmxlUmVjb3JkaW5nOiBmYWxzZSxcbiAgICAgIGVuYWJsZUNoYXQ6IHRydWUsXG4gICAgfTtcbiAgICByZXR1cm4gdGhpcy5tZWV0aW5nc1NlcnZpY2UuY3JlYXRlVmlkZW9Sb29tKFxuICAgICAgbWVldGluZ0lkLFxuICAgICAgdXNlcklkLFxuICAgICAgZGVmYXVsdENyZWF0ZUR0byxcbiAgICApO1xuICB9XG5cbiAgQEdldCgpXG4gIGFzeW5jIGdldEFsbE1lZXRpbmdzKFxuICAgIEBDdXJyZW50VXNlcklkKCkgdXNlcklkOiBzdHJpbmcsXG4gICAgQFF1ZXJ5KCdzdGF0dXMnKSBzdGF0dXM/OiBzdHJpbmcsXG4gICAgQFF1ZXJ5KCd0eXBlJykgdHlwZT86IHN0cmluZyxcbiAgICBAUXVlcnkoJ2xpbWl0JywgbmV3IFBhcnNlSW50UGlwZSh7IG9wdGlvbmFsOiB0cnVlIH0pKSBsaW1pdD86IG51bWJlcixcbiAgICBAUXVlcnkoJ29mZnNldCcsIG5ldyBQYXJzZUludFBpcGUoeyBvcHRpb25hbDogdHJ1ZSB9KSkgb2Zmc2V0PzogbnVtYmVyLFxuICAgIEBRdWVyeSgnZGF0ZUZyb20nKSBkYXRlRnJvbT86IHN0cmluZyxcbiAgICBAUXVlcnkoJ2RhdGVUbycpIGRhdGVUbz86IHN0cmluZyxcbiAgKSB7XG4gICAgY29uc3QgcXVlcnlPcHRpb25zID0ge1xuICAgICAgc3RhdHVzLFxuICAgICAgdHlwZSxcbiAgICAgIGxpbWl0LFxuICAgICAgb2Zmc2V0LFxuICAgICAgZGF0ZUZyb20sXG4gICAgICBkYXRlVG8sXG4gICAgfTtcbiAgICByZXR1cm4gdGhpcy5tZWV0aW5nc1NlcnZpY2UuZ2V0QWxsTWVldGluZ3ModXNlcklkLCBxdWVyeU9wdGlvbnMpO1xuICB9XG5cbiAgQFBvc3QoJzppZC9zZXNzaW9uJylcbiAgQEh0dHBDb2RlKEh0dHBTdGF0dXMuQ1JFQVRFRClcbiAgYXN5bmMgc2F2ZU1lZXRpbmdTZXNzaW9uKFxuICAgIEBQYXJhbSgnaWQnKSBtZWV0aW5nSWQ6IHN0cmluZyxcbiAgICBAQ3VycmVudFVzZXJJZCgpIHVzZXJJZDogc3RyaW5nLFxuICAgIEBCb2R5KC8qIHZhbGlkYXRpb24gZGlzYWJsZWQgKi8pXG4gICAgc2Vzc2lvbkRhdGE6IFNhdmVNZWV0aW5nU2Vzc2lvbkR0byxcbiAgKSB7XG4gICAgLy8gVmFsaWRhdGUgdXNlciBoYXMgYWNjZXNzIHRvIHRoaXMgbWVldGluZ1xuICAgIGF3YWl0IHRoaXMubWVldGluZ3NTZXJ2aWNlLmdldE1lZXRpbmdCeUlkKG1lZXRpbmdJZCwgdXNlcklkKTtcblxuICAgIHJldHVybiB0aGlzLm1lZXRpbmdzU2VydmljZS5zYXZlTWVldGluZ1Nlc3Npb24oXG4gICAgICBtZWV0aW5nSWQsXG4gICAgICB1c2VySWQsXG4gICAgICBzZXNzaW9uRGF0YSxcbiAgICApO1xuICB9XG5cbiAgQEdldCgnYW5hbHl0aWNzL3RoZXJhcGlzdCcpXG4gIGFzeW5jIGdldFRoZXJhcGlzdE1lZXRpbmdBbmFseXRpY3MoXG4gICAgQEN1cnJlbnRVc2VySWQoKSB1c2VySWQ6IHN0cmluZyxcbiAgICBAUXVlcnkoJ3N0YXJ0RGF0ZScpIHN0YXJ0RGF0ZT86IHN0cmluZyxcbiAgICBAUXVlcnkoJ2VuZERhdGUnKSBlbmREYXRlPzogc3RyaW5nLFxuICApIHtcbiAgICBjb25zdCBkYXRlUmFuZ2UgPVxuICAgICAgc3RhcnREYXRlICYmIGVuZERhdGVcbiAgICAgICAgPyB7XG4gICAgICAgICAgICBzdGFydDogbmV3IERhdGUoc3RhcnREYXRlKSxcbiAgICAgICAgICAgIGVuZDogbmV3IERhdGUoZW5kRGF0ZSksXG4gICAgICAgICAgfVxuICAgICAgICA6IHVuZGVmaW5lZDtcblxuICAgIHJldHVybiB0aGlzLm1lZXRpbmdzU2VydmljZS5nZXRNZWV0aW5nQW5hbHl0aWNzKHVzZXJJZCwgZGF0ZVJhbmdlKTtcbiAgfVxuXG4gIEBQb3N0KCc6aWQvZW1lcmdlbmN5LXRlcm1pbmF0ZScpXG4gIGFzeW5jIGVtZXJnZW5jeVRlcm1pbmF0ZShcbiAgICBAUGFyYW0oJ2lkJykgbWVldGluZ0lkOiBzdHJpbmcsXG4gICAgQEN1cnJlbnRVc2VySWQoKSB1c2VySWQ6IHN0cmluZyxcbiAgICBAQm9keSgpIGJvZHk6IHsgcmVhc29uOiBzdHJpbmcgfSxcbiAgKSB7XG4gICAgcmV0dXJuIHRoaXMubWVldGluZ3NTZXJ2aWNlLmVtZXJnZW5jeVRlcm1pbmF0ZU1lZXRpbmcoXG4gICAgICBtZWV0aW5nSWQsXG4gICAgICBib2R5LnJlYXNvbixcbiAgICAgIHVzZXJJZCxcbiAgICApO1xuICB9XG59XG4iXSwidmVyc2lvbiI6M30=