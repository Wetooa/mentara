{"version":3,"names":["cov_237bra5dp2","actualCoverage","common_1","s","require","passport_1","passport_microsoft_1","MicrosoftStrategy","PassportStrategy","Strategy","constructor","f","clientID","process","env","MICROSOFT_CLIENT_ID","clientSecret","MICROSOFT_CLIENT_SECRET","callbackURL","b","MICROSOFT_CALLBACK_URL","scope","validate","accessToken","refreshToken","profile","done","name","emails","user","email","value","firstName","givenName","lastName","familyName","exports","__decorate","Injectable"],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/auth/strategies/microsoft.strategy.ts"],"sourcesContent":["import { Injectable } from '@nestjs/common';\nimport { PassportStrategy } from '@nestjs/passport';\nimport { Strategy, VerifyCallback } from 'passport-microsoft';\n\n@Injectable()\nexport class MicrosoftStrategy extends PassportStrategy(Strategy, 'microsoft') {\n  constructor() {\n    super({\n      clientID: process.env.MICROSOFT_CLIENT_ID,\n      clientSecret: process.env.MICROSOFT_CLIENT_SECRET,\n      callbackURL:\n        process.env.MICROSOFT_CALLBACK_URL || '/auth/microsoft/callback',\n      scope: ['user.read'],\n    });\n  }\n\n  async validate(\n    accessToken: string,\n    refreshToken: string,\n    profile: any,\n    done: VerifyCallback,\n  ): Promise<any> {\n    const { name, emails } = profile;\n    const user = {\n      email: emails[0].value,\n      firstName: name.givenName,\n      lastName: name.familyName,\n      accessToken,\n      refreshToken,\n    };\n    done(null, user);\n  }\n}\n"],"mappings":"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","ignoreList":[]}