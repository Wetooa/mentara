0378c8cae308a55d253315f2d217767d
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var WebSocketEventService_1;
var _a, _b;
Object.defineProperty(exports, "__esModule", { value: true });
exports.WebSocketEventService = void 0;
const common_1 = require("@nestjs/common");
const event_bus_service_1 = require("../../common/events/event-bus.service");
const messaging_gateway_1 = require("../messaging.gateway");
let WebSocketEventService = WebSocketEventService_1 = class WebSocketEventService {
    eventBus;
    messagingGateway;
    logger = new common_1.Logger(WebSocketEventService_1.name);
    constructor(eventBus, messagingGateway) {
        this.eventBus = eventBus;
        this.messagingGateway = messagingGateway;
    }
    onModuleInit() {
        this.subscribeToEvents();
        this.logger.log('WebSocket event handlers initialized successfully');
    }
    subscribeToEvents() {
        // Subscribe to messaging events
        this.subscribeToMessagingEvents();
        // Subscribe to booking events
        this.subscribeToBookingEvents();
        // Subscribe to user events
        this.subscribeToUserEvents();
        // Subscribe to social events
        this.subscribeToSocialEvents();
        this.logger.log('Subscribed to all WebSocket event handlers');
    }
    subscribeToMessagingEvents() {
        // Message sent event - broadcast to conversation participants
        this.eventBus.subscribe('MessageSentEvent', async (event) => {
            const messageEvent = event;
            const { conversationId, messageId, senderId, content, messageType, sentAt, recipientIds, } = messageEvent.eventData;
            // Broadcast message to conversation participants via WebSocket
            this.messagingGateway.broadcastMessage(conversationId, {
                id: messageId,
                conversationId,
                senderId,
                content,
                messageType,
                sentAt,
                eventType: 'message_sent',
            });
            // Send delivery confirmations
            for (const recipientId of recipientIds) {
                this.messagingGateway.server
                    .to(this.getUserSocketRoom(recipientId))
                    .emit('message_delivered', {
                    messageId,
                    conversationId,
                    deliveredAt: new Date(),
                    eventType: 'message_delivered',
                });
            }
            this.logger.debug(`Broadcasted message sent event: ${messageId}`);
        });
        // Message read event - broadcast read receipt
        this.eventBus.subscribe('MessageReadEvent', async (event) => {
            const readEvent = event;
            const { messageId, conversationId, readBy } = readEvent.eventData;
            this.messagingGateway.broadcastReadReceipt(conversationId, messageId, readBy);
            this.logger.debug(`Broadcasted message read event: ${messageId} by ${readBy}`);
        });
        // Conversation created event - notify participants
        this.eventBus.subscribe('ConversationCreatedEvent', async (event) => {
            const conversationEvent = event;
            const { conversationId, createdBy, participantIds, conversationType, title, } = conversationEvent.eventData;
            console.log('LOOK HERE LOL RETARD', event.eventData);
            // Notify all participants about new conversation
            for (const participantId of participantIds) {
                this.messagingGateway.server
                    .to(this.getUserSocketRoom(participantId))
                    .emit('conversation_created', {
                    conversationId,
                    createdBy,
                    conversationType,
                    title,
                    participantIds,
                    eventType: 'conversation_created',
                    timestamp: new Date(),
                });
            }
            this.logger.debug(`Broadcasted conversation created event: ${conversationId}`);
        });
        // Participant joined event - notify conversation
        this.eventBus.subscribe('ParticipantJoinedEvent', async (event) => {
            const joinEvent = event;
            const { conversationId, participantId, addedBy, joinedAt, role } = joinEvent.eventData;
            this.messagingGateway.server
                .to(conversationId)
                .emit('participant_joined', {
                conversationId,
                participantId,
                addedBy,
                joinedAt,
                role,
                eventType: 'participant_joined',
            });
            this.logger.debug(`Broadcasted participant joined event: ${participantId} to ${conversationId}`);
        });
        // Participant left event - notify conversation
        this.eventBus.subscribe('ParticipantLeftEvent', async (event) => {
            const leftEvent = event;
            const { conversationId, participantId, leftAt, leftReason } = leftEvent.eventData;
            this.messagingGateway.server
                .to(conversationId)
                .emit('participant_left', {
                conversationId,
                participantId,
                leftAt,
                leftReason,
                eventType: 'participant_left',
            });
            this.logger.debug(`Broadcasted participant left event: ${participantId} from ${conversationId}`);
        });
        // Typing indicator event - relay to conversation
        this.eventBus.subscribe('TypingIndicatorEvent', async (event) => {
            const typingEvent = event;
            const { conversationId, userId, isTyping, timestamp } = typingEvent.eventData;
            this.messagingGateway.server
                .to(conversationId)
                .emit('typing_indicator', {
                conversationId,
                userId,
                isTyping,
                timestamp,
                eventType: 'typing_indicator',
            });
            this.logger.debug(`Relayed typing indicator: ${userId} in ${conversationId} - ${isTyping}`);
        });
    }
    subscribeToBookingEvents() {
        // Appointment booked event - notify therapist and client
        this.eventBus.subscribe('AppointmentBookedEvent', async (event) => {
            const appointmentEvent = event;
            const { appointmentId, clientId, therapistId, startTime, meetingType, isInitialConsultation, } = appointmentEvent.eventData;
            const appointmentNotification = {
                appointmentId,
                clientId,
                therapistId,
                startTime,
                meetingType,
                isInitialConsultation,
                eventType: 'appointment_booked',
                timestamp: new Date(),
            };
            // Notify client
            this.messagingGateway.server
                .to(this.getUserSocketRoom(clientId))
                .emit('appointment_notification', {
                ...appointmentNotification,
                message: 'Your appointment has been booked and is pending confirmation.',
            });
            // Notify therapist
            this.messagingGateway.server
                .to(this.getUserSocketRoom(therapistId))
                .emit('appointment_notification', {
                ...appointmentNotification,
                message: 'You have a new appointment request that requires confirmation.',
            });
            this.logger.debug(`Broadcasted appointment booked event: ${appointmentId}`);
        });
        // Appointment cancelled event - notify both parties
        this.eventBus.subscribe('AppointmentCancelledEvent', async (event) => {
            const cancelEvent = event;
            const { appointmentId, clientId, therapistId, cancelledBy, cancellationReason, cancelledAt, } = cancelEvent.eventData;
            const cancellationNotification = {
                appointmentId,
                clientId,
                therapistId,
                cancelledBy,
                cancellationReason,
                cancelledAt,
                eventType: 'appointment_cancelled',
                timestamp: new Date(),
            };
            // Determine message based on who cancelled
            const clientMessage = cancelledBy === clientId
                ? 'You have cancelled your appointment.'
                : 'Your appointment has been cancelled by the therapist.';
            const therapistMessage = cancelledBy === therapistId
                ? 'You have cancelled the appointment.'
                : 'The client has cancelled their appointment.';
            // Notify client
            this.messagingGateway.server
                .to(this.getUserSocketRoom(clientId))
                .emit('appointment_notification', {
                ...cancellationNotification,
                message: clientMessage,
            });
            // Notify therapist
            this.messagingGateway.server
                .to(this.getUserSocketRoom(therapistId))
                .emit('appointment_notification', {
                ...cancellationNotification,
                message: therapistMessage,
            });
            this.logger.debug(`Broadcasted appointment cancelled event: ${appointmentId}`);
        });
    }
    subscribeToUserEvents() {
        // User registered event - welcome notification
        this.eventBus.subscribe('UserRegisteredEvent', async (event) => {
            const registrationEvent = event;
            const { userId, firstName, lastName, role } = registrationEvent.eventData;
            // Send welcome notification to the new user
            this.messagingGateway.server
                .to(this.getUserSocketRoom(userId))
                .emit('welcome_notification', {
                userId,
                firstName,
                lastName,
                role,
                eventType: 'user_registered',
                message: `Welcome to Mentara, ${firstName}! Your account has been successfully created.`,
                timestamp: new Date(),
            });
            this.logger.debug(`Sent welcome notification to new user: ${userId}`);
        });
        // User profile updated event - notify relevant connections
        this.eventBus.subscribe('UserProfileUpdatedEvent', async (event) => {
            const profileEvent = event;
            const { userId, updatedFields, newValues } = profileEvent.eventData;
            // Notify conversations where profile info might be displayed
            this.messagingGateway.server.emit('user_profile_updated', {
                userId,
                updatedFields,
                profileData: newValues,
                eventType: 'user_profile_updated',
                timestamp: new Date(),
            });
            this.logger.debug(`Broadcasted user profile update: ${userId}`);
        });
    }
    subscribeToSocialEvents() {
        // Post created event - notify community members
        this.eventBus.subscribe('PostCreatedEvent', async (event) => {
            const postEvent = event;
            const { postId, authorId, communityId, title, content, tags, postType, isAnonymous, } = postEvent.eventData;
            // Broadcast to community room
            if (communityId) {
                this.messagingGateway.server
                    .to(`community_${communityId}`)
                    .emit('new_post', {
                    postId,
                    authorId: isAnonymous ? null : authorId, // Hide author if anonymous
                    communityId,
                    title,
                    content,
                    tags,
                    postType,
                    isAnonymous,
                    eventType: 'post_created',
                    timestamp: new Date(),
                });
            }
            this.logger.debug(`Broadcasted post created event: ${postId}`);
        });
        // Comment added event - notify post author and participants
        this.eventBus.subscribe('CommentAddedEvent', async (event) => {
            const commentEvent = event;
            const { commentId, postId, authorId, content } = commentEvent.eventData;
            // Broadcast to post room
            this.messagingGateway.server
                .to(`post_${postId}`)
                .emit('post_interaction', {
                commentId,
                postId,
                authorId,
                content,
                interactionType: 'comment',
                eventType: 'comment_created',
                message: 'Someone commented on your post',
                timestamp: new Date(),
            });
            // Broadcast to post viewers
            this.messagingGateway.server.to(`post_${postId}`).emit('new_comment', {
                commentId,
                postId,
                authorId,
                content,
                eventType: 'comment_created',
                timestamp: new Date(),
            });
            this.logger.debug(`Broadcasted comment created event: ${commentId} on post ${postId}`);
        });
    }
    /**
     * Helper method to get user socket room name
     */
    getUserSocketRoom(userId) {
        return `user_${userId}`;
    }
    /**
     * Subscribe users to their personal notification rooms
     */
    subscribeUserToPersonalRoom(userId, socketId) {
        const userRoom = this.getUserSocketRoom(userId);
        this.messagingGateway.server.in(socketId).socketsJoin(userRoom);
        this.logger.debug(`User ${userId} subscribed to personal room: ${userRoom}`);
    }
    /**
     * Unsubscribe users from their personal notification rooms
     */
    unsubscribeUserFromPersonalRoom(userId, socketId) {
        const userRoom = this.getUserSocketRoom(userId);
        this.messagingGateway.server.in(socketId).socketsLeave(userRoom);
        this.logger.debug(`User ${userId} unsubscribed from personal room: ${userRoom}`);
    }
    /**
     * Subscribe user to community room for post notifications
     */
    subscribeUserToCommunityRoom(userId, communityId, socketId) {
        const communityRoom = `community_${communityId}`;
        this.messagingGateway.server.in(socketId).socketsJoin(communityRoom);
        this.logger.debug(`User ${userId} subscribed to community room: ${communityRoom}`);
    }
    /**
     * Subscribe user to post room for comment notifications
     */
    subscribeUserToPostRoom(userId, postId, socketId) {
        const postRoom = `post_${postId}`;
        this.messagingGateway.server.in(socketId).socketsJoin(postRoom);
        this.logger.debug(`User ${userId} subscribed to post room: ${postRoom}`);
    }
    /**
     * Get connection statistics
     */
    getConnectionStats() {
        return {
            totalConnections: this.messagingGateway.server.sockets.sockets.size,
            eventSubscriptions: this.eventBus.getEventStats().totalListeners,
        };
    }
    /**
     * Broadcast system-wide announcement
     */
    broadcastSystemAnnouncement(message, priority = 'medium') {
        this.messagingGateway.server.emit('system_announcement', {
            message,
            priority,
            eventType: 'system_announcement',
            timestamp: new Date(),
        });
        this.logger.log(`Broadcasted system announcement: ${message} (priority: ${priority})`);
    }
    /**
     * Send targeted notification to specific users
     */
    sendTargetedNotification(userIds, notification) {
        for (const userId of userIds) {
            this.messagingGateway.server
                .to(this.getUserSocketRoom(userId))
                .emit('targeted_notification', {
                ...notification,
                eventType: 'targeted_notification',
                timestamp: new Date(),
            });
        }
        this.logger.debug(`Sent targeted notification to ${userIds.length} users`);
    }
};
exports.WebSocketEventService = WebSocketEventService;
exports.WebSocketEventService = WebSocketEventService = WebSocketEventService_1 = __decorate([
    (0, common_1.Injectable)(),
    __metadata("design:paramtypes", [typeof (_a = typeof event_bus_service_1.EventBusService !== "undefined" && event_bus_service_1.EventBusService) === "function" ? _a : Object, typeof (_b = typeof messaging_gateway_1.MessagingGateway !== "undefined" && messaging_gateway_1.MessagingGateway) === "function" ? _b : Object])
], WebSocketEventService);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL21lc3NhZ2luZy9zZXJ2aWNlcy93ZWJzb2NrZXQtZXZlbnQuc2VydmljZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFBLDJDQUFrRTtBQUNsRSw2RUFBd0U7QUFzQnhFLDREQUF3RDtBQUdqRCxJQUFNLHFCQUFxQiw2QkFBM0IsTUFBTSxxQkFBcUI7SUFJYjtJQUNBO0lBSkYsTUFBTSxHQUFHLElBQUksZUFBTSxDQUFDLHVCQUFxQixDQUFDLElBQUksQ0FBQyxDQUFDO0lBRWpFLFlBQ21CLFFBQXlCLEVBQ3pCLGdCQUFrQztRQURsQyxhQUFRLEdBQVIsUUFBUSxDQUFpQjtRQUN6QixxQkFBZ0IsR0FBaEIsZ0JBQWdCLENBQWtCO0lBQ2xELENBQUM7SUFFSixZQUFZO1FBQ1YsSUFBSSxDQUFDLGlCQUFpQixFQUFFLENBQUM7UUFDekIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsbURBQW1ELENBQUMsQ0FBQztJQUN2RSxDQUFDO0lBRU8saUJBQWlCO1FBQ3ZCLGdDQUFnQztRQUNoQyxJQUFJLENBQUMsMEJBQTBCLEVBQUUsQ0FBQztRQUVsQyw4QkFBOEI7UUFDOUIsSUFBSSxDQUFDLHdCQUF3QixFQUFFLENBQUM7UUFFaEMsMkJBQTJCO1FBQzNCLElBQUksQ0FBQyxxQkFBcUIsRUFBRSxDQUFDO1FBRTdCLDZCQUE2QjtRQUM3QixJQUFJLENBQUMsdUJBQXVCLEVBQUUsQ0FBQztRQUUvQixJQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyw0Q0FBNEMsQ0FBQyxDQUFDO0lBQ2hFLENBQUM7SUFFTywwQkFBMEI7UUFDaEMsOERBQThEO1FBQzlELElBQUksQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUNyQixrQkFBa0IsRUFDbEIsS0FBSyxFQUFFLEtBQXVCLEVBQUUsRUFBRTtZQUNoQyxNQUFNLFlBQVksR0FBRyxLQUF5QixDQUFDO1lBQy9DLE1BQU0sRUFD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TUFBTSxDQUFDLElBQUksQ0FBQyxxQkFBcUIsRUFBRTtZQUN2RCxPQUFPO1lBQ1AsUUFBUTtZQUNSLFNBQVMsRUFBRSxxQkFBcUI7WUFDaEMsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFO1NBQ3RCLENBQUMsQ0FBQztRQUVILElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUNiLG9DQUFvQyxPQUFPLGVBQWUsUUFBUSxHQUFHLENBQ3RFLENBQUM7SUFDSixDQUFDO0lBRUQ7O09BRUc7SUFDSCx3QkFBd0IsQ0FBQyxPQUFpQixFQUFFLFlBQWlCO1FBQzNELEtBQUssTUFBTSxNQUFNLElBQUksT0FBTyxFQUFFLENBQUM7WUFDN0IsSUFBSSxDQUFDLGdCQUFnQixDQUFDLE1BQU07aUJBQ3pCLEVBQUUsQ0FBQyxJQUFJLENBQUMsaUJBQWlCLENBQUMsTUFBTSxDQUFDLENBQUM7aUJBQ2xDLElBQUksQ0FBQyx1QkFBdUIsRUFBRTtnQkFDN0IsR0FBRyxZQUFZO2dCQUNmLFNBQVMsRUFBRSx1QkFBdUI7Z0JBQ2xDLFNBQVMsRUFBRSxJQUFJLElBQUksRUFBRTthQUN0QixDQUFDLENBQUM7UUFDUCxDQUFDO1FBRUQsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsaUNBQWlDLE9BQU8sQ0FBQyxNQUFNLFFBQVEsQ0FBQyxDQUFDO0lBQzdFLENBQUM7Q0FDRixDQUFBO0FBM2hCWSxzREFBcUI7Z0NBQXJCLHFCQUFxQjtJQURqQyxJQUFBLG1CQUFVLEdBQUU7eURBS2tCLG1DQUFlLG9CQUFmLG1DQUFlLG9EQUNQLG9DQUFnQixvQkFBaEIsb0NBQWdCO0dBTDFDLHFCQUFxQixDQTJoQmpDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9ob21lL3dldG9vYS9Eb2N1bWVudHMvY29kZS9wcm9qZWN0cy9tZW50YXJhL21lbnRhcmEtYXBpL3NyYy9tZXNzYWdpbmcvc2VydmljZXMvd2Vic29ja2V0LWV2ZW50LnNlcnZpY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSwgTG9nZ2VyLCBPbk1vZHVsZUluaXQgfSBmcm9tICdAbmVzdGpzL2NvbW1vbic7XG5pbXBvcnQgeyBFdmVudEJ1c1NlcnZpY2UgfSBmcm9tICcuLi8uLi9jb21tb24vZXZlbnRzL2V2ZW50LWJ1cy5zZXJ2aWNlJztcbmltcG9ydCB7IERvbWFpbkV2ZW50IH0gZnJvbSAnLi4vLi4vY29tbW9uL2V2ZW50cy9pbnRlcmZhY2VzL2RvbWFpbi1ldmVudC5pbnRlcmZhY2UnO1xuaW1wb3J0IHtcbiAgTWVzc2FnZVNlbnRFdmVudCxcbiAgTWVzc2FnZVJlYWRFdmVudCxcbiAgQ29udmVyc2F0aW9uQ3JlYXRlZEV2ZW50LFxuICBQYXJ0aWNpcGFudEpvaW5lZEV2ZW50LFxuICBQYXJ0aWNpcGFudExlZnRFdmVudCxcbiAgVHlwaW5nSW5kaWNhdG9yRXZlbnQsXG59IGZyb20gJy4uLy4uL2NvbW1vbi9ldmVudHMvbWVzc2FnaW5nLWV2ZW50cyc7XG5pbXBvcnQge1xuICBBcHBvaW50bWVudEJvb2tlZEV2ZW50LFxuICBBcHBvaW50bWVudENhbmNlbGxlZEV2ZW50LFxufSBmcm9tICcuLi8uLi9jb21tb24vZXZlbnRzL2Jvb2tpbmctZXZlbnRzJztcbmltcG9ydCB7XG4gIFVzZXJSZWdpc3RlcmVkRXZlbnQsXG4gIFVzZXJQcm9maWxlVXBkYXRlZEV2ZW50LFxufSBmcm9tICcuLi8uLi9jb21tb24vZXZlbnRzL3VzZXItZXZlbnRzJztcbmltcG9ydCB7XG4gIFBvc3RDcmVhdGVkRXZlbnQsXG4gIENvbW1lbnRBZGRlZEV2ZW50LFxufSBmcm9tICcuLi8uLi9jb21tb24vZXZlbnRzL3NvY2lhbC1ldmVudHMnO1xuaW1wb3J0IHsgTWVzc2FnaW5nR2F0ZXdheSB9IGZyb20gJy4uL21lc3NhZ2luZy5nYXRld2F5JztcblxuQEluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIFdlYlNvY2tldEV2ZW50U2VydmljZSBpbXBsZW1lbnRzIE9uTW9kdWxlSW5pdCB7XG4gIHByaXZhdGUgcmVhZG9ubHkgbG9nZ2VyID0gbmV3IExvZ2dlcihXZWJTb2NrZXRFdmVudFNlcnZpY2UubmFtZSk7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSByZWFkb25seSBldmVudEJ1czogRXZlbnRCdXNTZXJ2aWNlLFxuICAgIHByaXZhdGUgcmVhZG9ubHkgbWVzc2FnaW5nR2F0ZXdheTogTWVzc2FnaW5nR2F0ZXdheSxcbiAgKSB7fVxuXG4gIG9uTW9kdWxlSW5pdCgpIHtcbiAgICB0aGlzLnN1YnNjcmliZVRvRXZlbnRzKCk7XG4gICAgdGhpcy5sb2dnZXIubG9nKCdXZWJTb2NrZXQgZXZlbnQgaGFuZGxlcnMgaW5pdGlhbGl6ZWQgc3VjY2Vzc2Z1bGx5Jyk7XG4gIH1cblxuICBwcml2YXRlIHN1YnNjcmliZVRvRXZlbnRzKCk6IHZvaWQge1xuICAgIC8vIFN1YnNjcmliZSB0byBtZXNzYWdpbmcgZXZlbnRzXG4gICAgdGhpcy5zdWJzY3JpYmVUb01lc3NhZ2luZ0V2ZW50cygpO1xuXG4gICAgLy8gU3Vic2NyaWJlIHRvIGJvb2tpbmcgZXZlbnRzXG4gICAgdGhpcy5zdWJzY3JpYmVUb0Jvb2tpbmdFdmVudHMoKTtcblxuICAgIC8vIFN1YnNjcmliZSB0byB1c2VyIGV2ZW50c1xuICAgIHRoaXMuc3Vic2NyaWJlVG9Vc2VyRXZlbnRzKCk7XG5cbiAgICAvLyBTdWJzY3JpYmUgdG8gc29jaWFsIGV2ZW50c1xuICAgIHRoaXMuc3Vic2NyaWJlVG9Tb2NpYWxFdmVudHMoKTtcblxuICAgIHRoaXMubG9nZ2VyLmxvZygnU3Vic2NyaWJlZCB0byBhbGwgV2ViU29ja2V0IGV2ZW50IGhhbmRsZXJzJyk7XG4gIH1cblxuICBwcml2YXRlIHN1YnNjcmliZVRvTWVzc2FnaW5nRXZlbnRzKCk6IHZvaWQge1xuICAgIC8vIE1lc3NhZ2Ugc2VudCBldmVudCAtIGJyb2FkY2FzdCB0byBjb252ZXJzYXRpb24gcGFydGljaXBhbnRzXG4gICAgdGhpcy5ldmVudEJ1cy5zdWJzY3JpYmUoXG4gICAgICAnTWVzc2FnZVNlbnRFdmVudCcsXG4gICAgICBhc3luYyAoZXZlbnQ6IERvbWFpbkV2ZW50PGFueT4pID0+IHtcbiAgICAgICAgY29uc3QgbWVzc2FnZUV2ZW50ID0gZXZlbnQgYXMgTWVzc2FnZVNlbnRFdmVudDtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIGNvbnZlcnNhdGlvbklkLFxuICAgICAgICAgIG1lc3NhZ2VJZCxcbiAgICAgICAgICBzZW5kZXJJZCxcbiAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgIG1lc3NhZ2VUeXBlLFxuICAgICAgICAgIHNlbnRBdCxcbiAgICAgICAgICByZWNpcGllbnRJZHMsXG4gICAgICAgIH0gPSBtZXNzYWdlRXZlbnQuZXZlbnREYXRhO1xuXG4gICAgICAgIC8vIEJyb2FkY2FzdCBtZXNzYWdlIHRvIGNvbnZlcnNhdGlvbiBwYXJ0aWNpcGFudHMgdmlhIFdlYlNvY2tldFxuICAgICAgICB0aGlzLm1lc3NhZ2luZ0dhdGV3YXkuYnJvYWRjYXN0TWVzc2FnZShjb252ZXJzYXRpb25JZCwge1xuICAgICAgICAgIGlkOiBtZXNzYWdlSWQsXG4gICAgICAgICAgY29udmVyc2F0aW9uSWQsXG4gICAgICAgICAgc2VuZGVySWQsXG4gICAgICAgICAgY29udGVudCxcbiAgICAgICAgICBtZXNzYWdlVHlwZSxcbiAgICAgICAgICBzZW50QXQsXG4gICAgICAgICAgZXZlbnRUeXBlOiAnbWVzc2FnZV9zZW50JyxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gU2VuZCBkZWxpdmVyeSBjb25maXJtYXRpb25zXG4gICAgICAgIGZvciAoY29uc3QgcmVjaXBpZW50SWQgb2YgcmVjaXBpZW50SWRzKSB7XG4gICAgICAgICAgdGhpcy5tZXNzYWdpbmdHYXRld2F5LnNlcnZlclxuICAgICAgICAgICAgLnRvKHRoaXMuZ2V0VXNlclNvY2tldFJvb20ocmVjaXBpZW50SWQpKVxuICAgICAgICAgICAgLmVtaXQoJ21lc3NhZ2VfZGVsaXZlcmVkJywge1xuICAgICAgICAgICAgICBtZXNzYWdlSWQsXG4gICAgICAgICAgICAgIGNvbnZlcnNhdGlvbklkLFxuICAgICAgICAgICAgICBkZWxpdmVyZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgICAgICAgZXZlbnRUeXBlOiAnbWVzc2FnZV9kZWxpdmVyZWQnLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmxvZ2dlci5kZWJ1ZyhgQnJvYWRjYXN0ZWQgbWVzc2FnZSBzZW50IGV2ZW50OiAke21lc3NhZ2VJZH1gKTtcbiAgICAgIH0sXG4gICAgKTtcblxuICAgIC8vIE1lc3NhZ2UgcmVhZCBldmVudCAtIGJyb2FkY2FzdCByZWFkIHJlY2VpcHRcbiAgICB0aGlzLmV2ZW50QnVzLnN1YnNjcmliZShcbiAgICAgICdNZXNzYWdlUmVhZEV2ZW50JyxcbiAgICAgIGFzeW5jIChldmVudDogRG9tYWluRXZlbnQ8YW55PikgPT4ge1xuICAgICAgICBjb25zdCByZWFkRXZlbnQgPSBldmVudCBhcyBNZXNzYWdlUmVhZEV2ZW50O1xuICAgICAgICBjb25zdCB7IG1lc3NhZ2VJZCwgY29udmVyc2F0aW9uSWQsIHJlYWRCeSB9ID0gcmVhZEV2ZW50LmV2ZW50RGF0YTtcblxuICAgICAgICB0aGlzLm1lc3NhZ2luZ0dhdGV3YXkuYnJvYWRjYXN0UmVhZFJlY2VpcHQoXG4gICAgICAgICAgY29udmVyc2F0aW9uSWQsXG4gICAgICAgICAgbWVzc2FnZUlkLFxuICAgICAgICAgIHJlYWRCeSxcbiAgICAgICAgKTtcblxuICAgICAgICB0aGlzLmxvZ2dlci5kZWJ1ZyhcbiAgICAgICAgICBgQnJvYWRjYXN0ZWQgbWVzc2FnZSByZWFkIGV2ZW50OiAke21lc3NhZ2VJZH0gYnkgJHtyZWFkQnl9YCxcbiAgICAgICAgKTtcbiAgICAgIH0sXG4gICAgKTtcblxuICAgIC8vIENvbnZlcnNhdGlvbiBjcmVhdGVkIGV2ZW50IC0gbm90aWZ5IHBhcnRpY2lwYW50c1xuICAgIHRoaXMuZXZlbnRCdXMuc3Vic2NyaWJlKFxuICAgICAgJ0NvbnZlcnNhdGlvbkNyZWF0ZWRFdmVudCcsXG4gICAgICBhc3luYyAoZXZlbnQ6IERvbWFpbkV2ZW50PGFueT4pID0+IHtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uRXZlbnQgPSBldmVudCBhcyBDb252ZXJzYXRpb25DcmVhdGVkRXZlbnQ7XG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICBjb252ZXJzYXRpb25JZCxcbiAgICAgICAgICBjcmVhdGVkQnksXG4gICAgICAgICAgcGFydGljaXBhbnRJZHMsXG4gICAgICAgICAgY29udmVyc2F0aW9uVHlwZSxcbiAgICAgICAgICB0aXRsZSxcbiAgICAgICAgfSA9IGNvbnZlcnNhdGlvbkV2ZW50LmV2ZW50RGF0YTtcblxuICAgICAgICBjb25zb2xlLmxvZygnTE9PSyBIRVJFIExPTCBSRVRBUkQnLCBldmVudC5ldmVudERhdGEpO1xuXG4gICAgICAgIC8vIE5vdGlmeSBhbGwgcGFydGljaXBhbnRzIGFib3V0IG5ldyBjb252ZXJzYXRpb25cbiAgICAgICAgZm9yIChjb25zdCBwYXJ0aWNpcGFudElkIG9mIHBhcnRpY2lwYW50SWRzKSB7XG4gICAgICAgICAgdGhpcy5tZXNzYWdpbmdHYXRld2F5LnNlcnZlclxuICAgICAgICAgICAgLnRvKHRoaXMuZ2V0VXNlclNvY2tldFJvb20ocGFydGljaXBhbnRJZCkpXG4gICAgICAgICAgICAuZW1pdCgnY29udmVyc2F0aW9uX2NyZWF0ZWQnLCB7XG4gICAgICAgICAgICAgIGNvbnZlcnNhdGlvbklkLFxuICAgICAgICAgICAgICBjcmVhdGVkQnksXG4gICAgICAgICAgICAgIGNvbnZlcnNhdGlvblR5cGUsXG4gICAgICAgICAgICAgIHRpdGxlLFxuICAgICAgICAgICAgICBwYXJ0aWNpcGFudElkcyxcbiAgICAgICAgICAgICAgZXZlbnRUeXBlOiAnY29udmVyc2F0aW9uX2NyZWF0ZWQnLFxuICAgICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMubG9nZ2VyLmRlYnVnKFxuICAgICAgICAgIGBCcm9hZGNhc3RlZCBjb252ZXJzYXRpb24gY3JlYXRlZCBldmVudDogJHtjb252ZXJzYXRpb25JZH1gLFxuICAgICAgICApO1xuICAgICAgfSxcbiAgICApO1xuXG4gICAgLy8gUGFydGljaXBhbnQgam9pbmVkIGV2ZW50IC0gbm90aWZ5IGNvbnZlcnNhdGlvblxuICAgIHRoaXMuZXZlbnRCdXMuc3Vic2NyaWJlKFxuICAgICAgJ1BhcnRpY2lwYW50Sm9pbmVkRXZlbnQnLFxuICAgICAgYXN5bmMgKGV2ZW50OiBEb21haW5FdmVudDxhbnk+KSA9PiB7XG4gICAgICAgIGNvbnN0IGpvaW5FdmVudCA9IGV2ZW50IGFzIFBhcnRpY2lwYW50Sm9pbmVkRXZlbnQ7XG4gICAgICAgIGNvbnN0IHsgY29udmVyc2F0aW9uSWQsIHBhcnRpY2lwYW50SWQsIGFkZGVkQnksIGpvaW5lZEF0LCByb2xlIH0gPVxuICAgICAgICAgIGpvaW5FdmVudC5ldmVudERhdGE7XG5cbiAgICAgICAgdGhpcy5tZXNzYWdpbmdHYXRld2F5LnNlcnZlclxuICAgICAgICAgIC50byhjb252ZXJzYXRpb25JZClcbiAgICAgICAgICAuZW1pdCgncGFydGljaXBhbnRfam9pbmVkJywge1xuICAgICAgICAgICAgY29udmVyc2F0aW9uSWQsXG4gICAgICAgICAgICBwYXJ0aWNpcGFudElkLFxuICAgICAgICAgICAgYWRkZWRCeSxcbiAgICAgICAgICAgIGpvaW5lZEF0LFxuICAgICAgICAgICAgcm9sZSxcbiAgICAgICAgICAgIGV2ZW50VHlwZTogJ3BhcnRpY2lwYW50X2pvaW5lZCcsXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5sb2dnZXIuZGVidWcoXG4gICAgICAgICAgYEJyb2FkY2FzdGVkIHBhcnRpY2lwYW50IGpvaW5lZCBldmVudDogJHtwYXJ0aWNpcGFudElkfSB0byAke2NvbnZlcnNhdGlvbklkfWAsXG4gICAgICAgICk7XG4gICAgICB9LFxuICAgICk7XG5cbiAgICAvLyBQYXJ0aWNpcGFudCBsZWZ0IGV2ZW50IC0gbm90aWZ5IGNvbnZlcnNhdGlvblxuICAgIHRoaXMuZXZlbnRCdXMuc3Vic2NyaWJlKFxuICAgICAgJ1BhcnRpY2lwYW50TGVmdEV2ZW50JyxcbiAgICAgIGFzeW5jIChldmVudDogRG9tYWluRXZlbnQ8YW55PikgPT4ge1xuICAgICAgICBjb25zdCBsZWZ0RXZlbnQgPSBldmVudCBhcyBQYXJ0aWNpcGFudExlZnRFdmVudDtcbiAgICAgICAgY29uc3QgeyBjb252ZXJzYXRpb25JZCwgcGFydGljaXBhbnRJZCwgbGVmdEF0LCBsZWZ0UmVhc29uIH0gPVxuICAgICAgICAgIGxlZnRFdmVudC5ldmVudERhdGE7XG5cbiAgICAgICAgdGhpcy5tZXNzYWdpbmdHYXRld2F5LnNlcnZlclxuICAgICAgICAgIC50byhjb252ZXJzYXRpb25JZClcbiAgICAgICAgICAuZW1pdCgncGFydGljaXBhbnRfbGVmdCcsIHtcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbklkLFxuICAgICAgICAgICAgcGFydGljaXBhbnRJZCxcbiAgICAgICAgICAgIGxlZnRBdCxcbiAgICAgICAgICAgIGxlZnRSZWFzb24sXG4gICAgICAgICAgICBldmVudFR5cGU6ICdwYXJ0aWNpcGFudF9sZWZ0JyxcbiAgICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmxvZ2dlci5kZWJ1ZyhcbiAgICAgICAgICBgQnJvYWRjYXN0ZWQgcGFydGljaXBhbnQgbGVmdCBldmVudDogJHtwYXJ0aWNpcGFudElkfSBmcm9tICR7Y29udmVyc2F0aW9uSWR9YCxcbiAgICAgICAgKTtcbiAgICAgIH0sXG4gICAgKTtcblxuICAgIC8vIFR5cGluZyBpbmRpY2F0b3IgZXZlbnQgLSByZWxheSB0byBjb252ZXJzYXRpb25cbiAgICB0aGlzLmV2ZW50QnVzLnN1YnNjcmliZShcbiAgICAgICdUeXBpbmdJbmRpY2F0b3JFdmVudCcsXG4gICAgICBhc3luYyAoZXZlbnQ6IERvbWFpbkV2ZW50PGFueT4pID0+IHtcbiAgICAgICAgY29uc3QgdHlwaW5nRXZlbnQgPSBldmVudCBhcyBUeXBpbmdJbmRpY2F0b3JFdmVudDtcbiAgICAgICAgY29uc3QgeyBjb252ZXJzYXRpb25JZCwgdXNlcklkLCBpc1R5cGluZywgdGltZXN0YW1wIH0gPVxuICAgICAgICAgIHR5cGluZ0V2ZW50LmV2ZW50RGF0YTtcblxuICAgICAgICB0aGlzLm1lc3NhZ2luZ0dhdGV3YXkuc2VydmVyXG4gICAgICAgICAgLnRvKGNvbnZlcnNhdGlvbklkKVxuICAgICAgICAgIC5lbWl0KCd0eXBpbmdfaW5kaWNhdG9yJywge1xuICAgICAgICAgICAgY29udmVyc2F0aW9uSWQsXG4gICAgICAgICAgICB1c2VySWQsXG4gICAgICAgICAgICBpc1R5cGluZyxcbiAgICAgICAgICAgIHRpbWVzdGFtcCxcbiAgICAgICAgICAgIGV2ZW50VHlwZTogJ3R5cGluZ19pbmRpY2F0b3InLFxuICAgICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMubG9nZ2VyLmRlYnVnKFxuICAgICAgICAgIGBSZWxheWVkIHR5cGluZyBpbmRpY2F0b3I6ICR7dXNlcklkfSBpbiAke2NvbnZlcnNhdGlvbklkfSAtICR7aXNUeXBpbmd9YCxcbiAgICAgICAgKTtcbiAgICAgIH0sXG4gICAgKTtcbiAgfVxuXG4gIHByaXZhdGUgc3Vic2NyaWJlVG9Cb29raW5nRXZlbnRzKCk6IHZvaWQge1xuICAgIC8vIEFwcG9pbnRtZW50IGJvb2tlZCBldmVudCAtIG5vdGlmeSB0aGVyYXBpc3QgYW5kIGNsaWVudFxuICAgIHRoaXMuZXZlbnRCdXMuc3Vic2NyaWJlKFxuICAgICAgJ0FwcG9pbnRtZW50Qm9va2VkRXZlbnQnLFxuICAgICAgYXN5bmMgKGV2ZW50OiBEb21haW5FdmVudDxhbnk+KSA9PiB7XG4gICAgICAgIGNvbnN0IGFwcG9pbnRtZW50RXZlbnQgPSBldmVudCBhcyBBcHBvaW50bWVudEJvb2tlZEV2ZW50O1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgYXBwb2ludG1lbnRJZCxcbiAgICAgICAgICBjbGllbnRJZCxcbiAgICAgICAgICB0aGVyYXBpc3RJZCxcbiAgICAgICAgICBzdGFydFRpbWUsXG4gICAgICAgICAgbWVldGluZ1R5cGUsXG4gICAgICAgICAgaXNJbml0aWFsQ29uc3VsdGF0aW9uLFxuICAgICAgICB9ID0gYXBwb2ludG1lbnRFdmVudC5ldmVudERhdGE7XG5cbiAgICAgICAgY29uc3QgYXBwb2ludG1lbnROb3RpZmljYXRpb24gPSB7XG4gICAgICAgICAgYXBwb2ludG1lbnRJZCxcbiAgICAgICAgICBjbGllbnRJZCxcbiAgICAgICAgICB0aGVyYXBpc3RJZCxcbiAgICAgICAgICBzdGFydFRpbWUsXG4gICAgICAgICAgbWVldGluZ1R5cGUsXG4gICAgICAgICAgaXNJbml0aWFsQ29uc3VsdGF0aW9uLFxuICAgICAgICAgIGV2ZW50VHlwZTogJ2FwcG9pbnRtZW50X2Jvb2tlZCcsXG4gICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIE5vdGlmeSBjbGllbnRcbiAgICAgICAgdGhpcy5tZXNzYWdpbmdHYXRld2F5LnNlcnZlclxuICAgICAgICAgIC50byh0aGlzLmdldFVzZXJTb2NrZXRSb29tKGNsaWVudElkKSlcbiAgICAgICAgICAuZW1pdCgnYXBwb2ludG1lbnRfbm90aWZpY2F0aW9uJywge1xuICAgICAgICAgICAgLi4uYXBwb2ludG1lbnROb3RpZmljYXRpb24sXG4gICAgICAgICAgICBtZXNzYWdlOlxuICAgICAgICAgICAgICAnWW91ciBhcHBvaW50bWVudCBoYXMgYmVlbiBib29rZWQgYW5kIGlzIHBlbmRpbmcgY29uZmlybWF0aW9uLicsXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gTm90aWZ5IHRoZXJhcGlzdFxuICAgICAgICB0aGlzLm1lc3NhZ2luZ0dhdGV3YXkuc2VydmVyXG4gICAgICAgICAgLnRvKHRoaXMuZ2V0VXNlclNvY2tldFJvb20odGhlcmFwaXN0SWQpKVxuICAgICAgICAgIC5lbWl0KCdhcHBvaW50bWVudF9ub3RpZmljYXRpb24nLCB7XG4gICAgICAgICAgICAuLi5hcHBvaW50bWVudE5vdGlmaWNhdGlvbixcbiAgICAgICAgICAgIG1lc3NhZ2U6XG4gICAgICAgICAgICAgICdZb3UgaGF2ZSBhIG5ldyBhcHBvaW50bWVudCByZXF1ZXN0IHRoYXQgcmVxdWlyZXMgY29uZmlybWF0aW9uLicsXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5sb2dnZXIuZGVidWcoXG4gICAgICAgICAgYEJyb2FkY2FzdGVkIGFwcG9pbnRtZW50IGJvb2tlZCBldmVudDogJHthcHBvaW50bWVudElkfWAsXG4gICAgICAgICk7XG4gICAgICB9LFxuICAgICk7XG5cbiAgICAvLyBBcHBvaW50bWVudCBjYW5jZWxsZWQgZXZlbnQgLSBub3RpZnkgYm90aCBwYXJ0aWVzXG4gICAgdGhpcy5ldmVudEJ1cy5zdWJzY3JpYmUoXG4gICAgICAnQXBwb2ludG1lbnRDYW5jZWxsZWRFdmVudCcsXG4gICAgICBhc3luYyAoZXZlbnQ6IERvbWFpbkV2ZW50PGFueT4pID0+IHtcbiAgICAgICAgY29uc3QgY2FuY2VsRXZlbnQgPSBldmVudCBhcyBBcHBvaW50bWVudENhbmNlbGxlZEV2ZW50O1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgYXBwb2ludG1lbnRJZCxcbiAgICAgICAgICBjbGllbnRJZCxcbiAgICAgICAgICB0aGVyYXBpc3RJZCxcbiAgICAgICAgICBjYW5jZWxsZWRCeSxcbiAgICAgICAgICBjYW5jZWxsYXRpb25SZWFzb24sXG4gICAgICAgICAgY2FuY2VsbGVkQXQsXG4gICAgICAgIH0gPSBjYW5jZWxFdmVudC5ldmVudERhdGE7XG5cbiAgICAgICAgY29uc3QgY2FuY2VsbGF0aW9uTm90aWZpY2F0aW9uID0ge1xuICAgICAgICAgIGFwcG9pbnRtZW50SWQsXG4gICAgICAgICAgY2xpZW50SWQsXG4gICAgICAgICAgdGhlcmFwaXN0SWQsXG4gICAgICAgICAgY2FuY2VsbGVkQnksXG4gICAgICAgICAgY2FuY2VsbGF0aW9uUmVhc29uLFxuICAgICAgICAgIGNhbmNlbGxlZEF0LFxuICAgICAgICAgIGV2ZW50VHlwZTogJ2FwcG9pbnRtZW50X2NhbmNlbGxlZCcsXG4gICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIERldGVybWluZSBtZXNzYWdlIGJhc2VkIG9uIHdobyBjYW5jZWxsZWRcbiAgICAgICAgY29uc3QgY2xpZW50TWVzc2FnZSA9XG4gICAgICAgICAgY2FuY2VsbGVkQnkgPT09IGNsaWVudElkXG4gICAgICAgICAgICA/ICdZb3UgaGF2ZSBjYW5jZWxsZWQgeW91ciBhcHBvaW50bWVudC4nXG4gICAgICAgICAgICA6ICdZb3VyIGFwcG9pbnRtZW50IGhhcyBiZWVuIGNhbmNlbGxlZCBieSB0aGUgdGhlcmFwaXN0Lic7XG5cbiAgICAgICAgY29uc3QgdGhlcmFwaXN0TWVzc2FnZSA9XG4gICAgICAgICAgY2FuY2VsbGVkQnkgPT09IHRoZXJhcGlzdElkXG4gICAgICAgICAgICA/ICdZb3UgaGF2ZSBjYW5jZWxsZWQgdGhlIGFwcG9pbnRtZW50LidcbiAgICAgICAgICAgIDogJ1RoZSBjbGllbnQgaGFzIGNhbmNlbGxlZCB0aGVpciBhcHBvaW50bWVudC4nO1xuXG4gICAgICAgIC8vIE5vdGlmeSBjbGllbnRcbiAgICAgICAgdGhpcy5tZXNzYWdpbmdHYXRld2F5LnNlcnZlclxuICAgICAgICAgIC50byh0aGlzLmdldFVzZXJTb2NrZXRSb29tKGNsaWVudElkKSlcbiAgICAgICAgICAuZW1pdCgnYXBwb2ludG1lbnRfbm90aWZpY2F0aW9uJywge1xuICAgICAgICAgICAgLi4uY2FuY2VsbGF0aW9uTm90aWZpY2F0aW9uLFxuICAgICAgICAgICAgbWVzc2FnZTogY2xpZW50TWVzc2FnZSxcbiAgICAgICAgICB9KTtcblxuICAgICAgICAvLyBOb3RpZnkgdGhlcmFwaXN0XG4gICAgICAgIHRoaXMubWVzc2FnaW5nR2F0ZXdheS5zZXJ2ZXJcbiAgICAgICAgICAudG8odGhpcy5nZXRVc2VyU29ja2V0Um9vbSh0aGVyYXBpc3RJZCkpXG4gICAgICAgICAgLmVtaXQoJ2FwcG9pbnRtZW50X25vdGlmaWNhdGlvbicsIHtcbiAgICAgICAgICAgIC4uLmNhbmNlbGxhdGlvbk5vdGlmaWNhdGlvbixcbiAgICAgICAgICAgIG1lc3NhZ2U6IHRoZXJhcGlzdE1lc3NhZ2UsXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5sb2dnZXIuZGVidWcoXG4gICAgICAgICAgYEJyb2FkY2FzdGVkIGFwcG9pbnRtZW50IGNhbmNlbGxlZCBldmVudDogJHthcHBvaW50bWVudElkfWAsXG4gICAgICAgICk7XG4gICAgICB9LFxuICAgICk7XG4gIH1cblxuICBwcml2YXRlIHN1YnNjcmliZVRvVXNlckV2ZW50cygpOiB2b2lkIHtcbiAgICAvLyBVc2VyIHJlZ2lzdGVyZWQgZXZlbnQgLSB3ZWxjb21lIG5vdGlmaWNhdGlvblxuICAgIHRoaXMuZXZlbnRCdXMuc3Vic2NyaWJlKFxuICAgICAgJ1VzZXJSZWdpc3RlcmVkRXZlbnQnLFxuICAgICAgYXN5bmMgKGV2ZW50OiBEb21haW5FdmVudDxhbnk+KSA9PiB7XG4gICAgICAgIGNvbnN0IHJlZ2lzdHJhdGlvbkV2ZW50ID0gZXZlbnQgYXMgVXNlclJlZ2lzdGVyZWRFdmVudDtcbiAgICAgICAgY29uc3QgeyB1c2VySWQsIGZpcnN0TmFtZSwgbGFzdE5hbWUsIHJvbGUgfSA9XG4gICAgICAgICAgcmVnaXN0cmF0aW9uRXZlbnQuZXZlbnREYXRhO1xuXG4gICAgICAgIC8vIFNlbmQgd2VsY29tZSBub3RpZmljYXRpb24gdG8gdGhlIG5ldyB1c2VyXG4gICAgICAgIHRoaXMubWVzc2FnaW5nR2F0ZXdheS5zZXJ2ZXJcbiAgICAgICAgICAudG8odGhpcy5nZXRVc2VyU29ja2V0Um9vbSh1c2VySWQpKVxuICAgICAgICAgIC5lbWl0KCd3ZWxjb21lX25vdGlmaWNhdGlvbicsIHtcbiAgICAgICAgICAgIHVzZXJJZCxcbiAgICAgICAgICAgIGZpcnN0TmFtZSxcbiAgICAgICAgICAgIGxhc3ROYW1lLFxuICAgICAgICAgICAgcm9sZSxcbiAgICAgICAgICAgIGV2ZW50VHlwZTogJ3VzZXJfcmVnaXN0ZXJlZCcsXG4gICAgICAgICAgICBtZXNzYWdlOiBgV2VsY29tZSB0byBNZW50YXJhLCAke2ZpcnN0TmFtZX0hIFlvdXIgYWNjb3VudCBoYXMgYmVlbiBzdWNjZXNzZnVsbHkgY3JlYXRlZC5gLFxuICAgICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMubG9nZ2VyLmRlYnVnKGBTZW50IHdlbGNvbWUgbm90aWZpY2F0aW9uIHRvIG5ldyB1c2VyOiAke3VzZXJJZH1gKTtcbiAgICAgIH0sXG4gICAgKTtcblxuICAgIC8vIFVzZXIgcHJvZmlsZSB1cGRhdGVkIGV2ZW50IC0gbm90aWZ5IHJlbGV2YW50IGNvbm5lY3Rpb25zXG4gICAgdGhpcy5ldmVudEJ1cy5zdWJzY3JpYmUoXG4gICAgICAnVXNlclByb2ZpbGVVcGRhdGVkRXZlbnQnLFxuICAgICAgYXN5bmMgKGV2ZW50OiBEb21haW5FdmVudDxhbnk+KSA9PiB7XG4gICAgICAgIGNvbnN0IHByb2ZpbGVFdmVudCA9IGV2ZW50IGFzIFVzZXJQcm9maWxlVXBkYXRlZEV2ZW50O1xuICAgICAgICBjb25zdCB7IHVzZXJJZCwgdXBkYXRlZEZpZWxkcywgbmV3VmFsdWVzIH0gPSBwcm9maWxlRXZlbnQuZXZlbnREYXRhO1xuXG4gICAgICAgIC8vIE5vdGlmeSBjb252ZXJzYXRpb25zIHdoZXJlIHByb2ZpbGUgaW5mbyBtaWdodCBiZSBkaXNwbGF5ZWRcbiAgICAgICAgdGhpcy5tZXNzYWdpbmdHYXRld2F5LnNlcnZlci5lbWl0KCd1c2VyX3Byb2ZpbGVfdXBkYXRlZCcsIHtcbiAgICAgICAgICB1c2VySWQsXG4gICAgICAgICAgdXBkYXRlZEZpZWxkcyxcbiAgICAgICAgICBwcm9maWxlRGF0YTogbmV3VmFsdWVzLFxuICAgICAgICAgIGV2ZW50VHlwZTogJ3VzZXJfcHJvZmlsZV91cGRhdGVkJyxcbiAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMubG9nZ2VyLmRlYnVnKGBCcm9hZGNhc3RlZCB1c2VyIHByb2ZpbGUgdXBkYXRlOiAke3VzZXJJZH1gKTtcbiAgICAgIH0sXG4gICAgKTtcbiAgfVxuXG4gIHByaXZhdGUgc3Vic2NyaWJlVG9Tb2NpYWxFdmVudHMoKTogdm9pZCB7XG4gICAgLy8gUG9zdCBjcmVhdGVkIGV2ZW50IC0gbm90aWZ5IGNvbW11bml0eSBtZW1iZXJzXG4gICAgdGhpcy5ldmVudEJ1cy5zdWJzY3JpYmUoXG4gICAgICAnUG9zdENyZWF0ZWRFdmVudCcsXG4gICAgICBhc3luYyAoZXZlbnQ6IERvbWFpbkV2ZW50PGFueT4pID0+IHtcbiAgICAgICAgY29uc3QgcG9zdEV2ZW50ID0gZXZlbnQgYXMgUG9zdENyZWF0ZWRFdmVudDtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIHBvc3RJZCxcbiAgICAgICAgICBhdXRob3JJZCxcbiAgICAgICAgICBjb21tdW5pdHlJZCxcbiAgICAgICAgICB0aXRsZSxcbiAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgIHRhZ3MsXG4gICAgICAgICAgcG9zdFR5cGUsXG4gICAgICAgICAgaXNBbm9ueW1vdXMsXG4gICAgICAgIH0gPSBwb3N0RXZlbnQuZXZlbnREYXRhO1xuXG4gICAgICAgIC8vIEJyb2FkY2FzdCB0byBjb21tdW5pdHkgcm9vbVxuICAgICAgICBpZiAoY29tbXVuaXR5SWQpIHtcbiAgICAgICAgICB0aGlzLm1lc3NhZ2luZ0dhdGV3YXkuc2VydmVyXG4gICAgICAgICAgICAudG8oYGNvbW11bml0eV8ke2NvbW11bml0eUlkfWApXG4gICAgICAgICAgICAuZW1pdCgnbmV3X3Bvc3QnLCB7XG4gICAgICAgICAgICAgIHBvc3RJZCxcbiAgICAgICAgICAgICAgYXV0aG9ySWQ6IGlzQW5vbnltb3VzID8gbnVsbCA6IGF1dGhvcklkLCAvLyBIaWRlIGF1dGhvciBpZiBhbm9ueW1vdXNcbiAgICAgICAgICAgICAgY29tbXVuaXR5SWQsXG4gICAgICAgICAgICAgIHRpdGxlLFxuICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICB0YWdzLFxuICAgICAgICAgICAgICBwb3N0VHlwZSxcbiAgICAgICAgICAgICAgaXNBbm9ueW1vdXMsXG4gICAgICAgICAgICAgIGV2ZW50VHlwZTogJ3Bvc3RfY3JlYXRlZCcsXG4gICAgICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5sb2dnZXIuZGVidWcoYEJyb2FkY2FzdGVkIHBvc3QgY3JlYXRlZCBldmVudDogJHtwb3N0SWR9YCk7XG4gICAgICB9LFxuICAgICk7XG5cbiAgICAvLyBDb21tZW50IGFkZGVkIGV2ZW50IC0gbm90aWZ5IHBvc3QgYXV0aG9yIGFuZCBwYXJ0aWNpcGFudHNcbiAgICB0aGlzLmV2ZW50QnVzLnN1YnNjcmliZShcbiAgICAgICdDb21tZW50QWRkZWRFdmVudCcsXG4gICAgICBhc3luYyAoZXZlbnQ6IERvbWFpbkV2ZW50PGFueT4pID0+IHtcbiAgICAgICAgY29uc3QgY29tbWVudEV2ZW50ID0gZXZlbnQgYXMgQ29tbWVudEFkZGVkRXZlbnQ7XG4gICAgICAgIGNvbnN0IHsgY29tbWVudElkLCBwb3N0SWQsIGF1dGhvcklkLCBjb250ZW50IH0gPSBjb21tZW50RXZlbnQuZXZlbnREYXRhO1xuXG4gICAgICAgIC8vIEJyb2FkY2FzdCB0byBwb3N0IHJvb21cbiAgICAgICAgdGhpcy5tZXNzYWdpbmdHYXRld2F5LnNlcnZlclxuICAgICAgICAgIC50byhgcG9zdF8ke3Bvc3RJZH1gKVxuICAgICAgICAgIC5lbWl0KCdwb3N0X2ludGVyYWN0aW9uJywge1xuICAgICAgICAgICAgY29tbWVudElkLFxuICAgICAgICAgICAgcG9zdElkLFxuICAgICAgICAgICAgYXV0aG9ySWQsXG4gICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgaW50ZXJhY3Rpb25UeXBlOiAnY29tbWVudCcsXG4gICAgICAgICAgICBldmVudFR5cGU6ICdjb21tZW50X2NyZWF0ZWQnLFxuICAgICAgICAgICAgbWVzc2FnZTogJ1NvbWVvbmUgY29tbWVudGVkIG9uIHlvdXIgcG9zdCcsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQnJvYWRjYXN0IHRvIHBvc3Qgdmlld2Vyc1xuICAgICAgICB0aGlzLm1lc3NhZ2luZ0dhdGV3YXkuc2VydmVyLnRvKGBwb3N0XyR7cG9zdElkfWApLmVtaXQoJ25ld19jb21tZW50Jywge1xuICAgICAgICAgIGNvbW1lbnRJZCxcbiAgICAgICAgICBwb3N0SWQsXG4gICAgICAgICAgYXV0aG9ySWQsXG4gICAgICAgICAgY29udGVudCxcbiAgICAgICAgICBldmVudFR5cGU6ICdjb21tZW50X2NyZWF0ZWQnLFxuICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5sb2dnZXIuZGVidWcoXG4gICAgICAgICAgYEJyb2FkY2FzdGVkIGNvbW1lbnQgY3JlYXRlZCBldmVudDogJHtjb21tZW50SWR9IG9uIHBvc3QgJHtwb3N0SWR9YCxcbiAgICAgICAgKTtcbiAgICAgIH0sXG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIZWxwZXIgbWV0aG9kIHRvIGdldCB1c2VyIHNvY2tldCByb29tIG5hbWVcbiAgICovXG4gIHByaXZhdGUgZ2V0VXNlclNvY2tldFJvb20odXNlcklkOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIHJldHVybiBgdXNlcl8ke3VzZXJJZH1gO1xuICB9XG5cbiAgLyoqXG4gICAqIFN1YnNjcmliZSB1c2VycyB0byB0aGVpciBwZXJzb25hbCBub3RpZmljYXRpb24gcm9vbXNcbiAgICovXG4gIHN1YnNjcmliZVVzZXJUb1BlcnNvbmFsUm9vbSh1c2VySWQ6IHN0cmluZywgc29ja2V0SWQ6IHN0cmluZyk6IHZvaWQge1xuICAgIGNvbnN0IHVzZXJSb29tID0gdGhpcy5nZXRVc2VyU29ja2V0Um9vbSh1c2VySWQpO1xuICAgIHRoaXMubWVzc2FnaW5nR2F0ZXdheS5zZXJ2ZXIuaW4oc29ja2V0SWQpLnNvY2tldHNKb2luKHVzZXJSb29tKTtcbiAgICB0aGlzLmxvZ2dlci5kZWJ1ZyhcbiAgICAgIGBVc2VyICR7dXNlcklkfSBzdWJzY3JpYmVkIHRvIHBlcnNvbmFsIHJvb206ICR7dXNlclJvb219YCxcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIFVuc3Vic2NyaWJlIHVzZXJzIGZyb20gdGhlaXIgcGVyc29uYWwgbm90aWZpY2F0aW9uIHJvb21zXG4gICAqL1xuICB1bnN1YnNjcmliZVVzZXJGcm9tUGVyc29uYWxSb29tKHVzZXJJZDogc3RyaW5nLCBzb2NrZXRJZDogc3RyaW5nKTogdm9pZCB7XG4gICAgY29uc3QgdXNlclJvb20gPSB0aGlzLmdldFVzZXJTb2NrZXRSb29tKHVzZXJJZCk7XG4gICAgdGhpcy5tZXNzYWdpbmdHYXRld2F5LnNlcnZlci5pbihzb2NrZXRJZCkuc29ja2V0c0xlYXZlKHVzZXJSb29tKTtcbiAgICB0aGlzLmxvZ2dlci5kZWJ1ZyhcbiAgICAgIGBVc2VyICR7dXNlcklkfSB1bnN1YnNjcmliZWQgZnJvbSBwZXJzb25hbCByb29tOiAke3VzZXJSb29tfWAsXG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTdWJzY3JpYmUgdXNlciB0byBjb21tdW5pdHkgcm9vbSBmb3IgcG9zdCBub3RpZmljYXRpb25zXG4gICAqL1xuICBzdWJzY3JpYmVVc2VyVG9Db21tdW5pdHlSb29tKFxuICAgIHVzZXJJZDogc3RyaW5nLFxuICAgIGNvbW11bml0eUlkOiBzdHJpbmcsXG4gICAgc29ja2V0SWQ6IHN0cmluZyxcbiAgKTogdm9pZCB7XG4gICAgY29uc3QgY29tbXVuaXR5Um9vbSA9IGBjb21tdW5pdHlfJHtjb21tdW5pdHlJZH1gO1xuICAgIHRoaXMubWVzc2FnaW5nR2F0ZXdheS5zZXJ2ZXIuaW4oc29ja2V0SWQpLnNvY2tldHNKb2luKGNvbW11bml0eVJvb20pO1xuICAgIHRoaXMubG9nZ2VyLmRlYnVnKFxuICAgICAgYFVzZXIgJHt1c2VySWR9IHN1YnNjcmliZWQgdG8gY29tbXVuaXR5IHJvb206ICR7Y29tbXVuaXR5Um9vbX1gLFxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogU3Vic2NyaWJlIHVzZXIgdG8gcG9zdCByb29tIGZvciBjb21tZW50IG5vdGlmaWNhdGlvbnNcbiAgICovXG4gIHN1YnNjcmliZVVzZXJUb1Bvc3RSb29tKFxuICAgIHVzZXJJZDogc3RyaW5nLFxuICAgIHBvc3RJZDogc3RyaW5nLFxuICAgIHNvY2tldElkOiBzdHJpbmcsXG4gICk6IHZvaWQge1xuICAgIGNvbnN0IHBvc3RSb29tID0gYHBvc3RfJHtwb3N0SWR9YDtcbiAgICB0aGlzLm1lc3NhZ2luZ0dhdGV3YXkuc2VydmVyLmluKHNvY2tldElkKS5zb2NrZXRzSm9pbihwb3N0Um9vbSk7XG4gICAgdGhpcy5sb2dnZXIuZGVidWcoYFVzZXIgJHt1c2VySWR9IHN1YnNjcmliZWQgdG8gcG9zdCByb29tOiAke3Bvc3RSb29tfWApO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBjb25uZWN0aW9uIHN0YXRpc3RpY3NcbiAgICovXG4gIGdldENvbm5lY3Rpb25TdGF0cygpOiB7XG4gICAgdG90YWxDb25uZWN0aW9uczogbnVtYmVyO1xuICAgIGV2ZW50U3Vic2NyaXB0aW9uczogbnVtYmVyO1xuICB9IHtcbiAgICByZXR1cm4ge1xuICAgICAgdG90YWxDb25uZWN0aW9uczogdGhpcy5tZXNzYWdpbmdHYXRld2F5LnNlcnZlci5zb2NrZXRzLnNvY2tldHMuc2l6ZSxcbiAgICAgIGV2ZW50U3Vic2NyaXB0aW9uczogdGhpcy5ldmVudEJ1cy5nZXRFdmVudFN0YXRzKCkudG90YWxMaXN0ZW5lcnMsXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBCcm9hZGNhc3Qgc3lzdGVtLXdpZGUgYW5ub3VuY2VtZW50XG4gICAqL1xuICBicm9hZGNhc3RTeXN0ZW1Bbm5vdW5jZW1lbnQoXG4gICAgbWVzc2FnZTogc3RyaW5nLFxuICAgIHByaW9yaXR5OiAnbG93JyB8ICdtZWRpdW0nIHwgJ2hpZ2gnID0gJ21lZGl1bScsXG4gICk6IHZvaWQge1xuICAgIHRoaXMubWVzc2FnaW5nR2F0ZXdheS5zZXJ2ZXIuZW1pdCgnc3lzdGVtX2Fubm91bmNlbWVudCcsIHtcbiAgICAgIG1lc3NhZ2UsXG4gICAgICBwcmlvcml0eSxcbiAgICAgIGV2ZW50VHlwZTogJ3N5c3RlbV9hbm5vdW5jZW1lbnQnLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgIH0pO1xuXG4gICAgdGhpcy5sb2dnZXIubG9nKFxuICAgICAgYEJyb2FkY2FzdGVkIHN5c3RlbSBhbm5vdW5jZW1lbnQ6ICR7bWVzc2FnZX0gKHByaW9yaXR5OiAke3ByaW9yaXR5fSlgLFxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogU2VuZCB0YXJnZXRlZCBub3RpZmljYXRpb24gdG8gc3BlY2lmaWMgdXNlcnNcbiAgICovXG4gIHNlbmRUYXJnZXRlZE5vdGlmaWNhdGlvbih1c2VySWRzOiBzdHJpbmdbXSwgbm90aWZpY2F0aW9uOiBhbnkpOiB2b2lkIHtcbiAgICBmb3IgKGNvbnN0IHVzZXJJZCBvZiB1c2VySWRzKSB7XG4gICAgICB0aGlzLm1lc3NhZ2luZ0dhdGV3YXkuc2VydmVyXG4gICAgICAgIC50byh0aGlzLmdldFVzZXJTb2NrZXRSb29tKHVzZXJJZCkpXG4gICAgICAgIC5lbWl0KCd0YXJnZXRlZF9ub3RpZmljYXRpb24nLCB7XG4gICAgICAgICAgLi4ubm90aWZpY2F0aW9uLFxuICAgICAgICAgIGV2ZW50VHlwZTogJ3RhcmdldGVkX25vdGlmaWNhdGlvbicsXG4gICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICB0aGlzLmxvZ2dlci5kZWJ1ZyhgU2VudCB0YXJnZXRlZCBub3RpZmljYXRpb24gdG8gJHt1c2VySWRzLmxlbmd0aH0gdXNlcnNgKTtcbiAgfVxufVxuIl0sInZlcnNpb24iOjN9