691b6d02eaff1f2e3261e5a551647dde
"use strict";
/**
 * Comprehensive Test Suite for StripeWebhookController
 * Tests webhook event processing, idempotency, error handling, and statistics
 */
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const common_1 = require("@nestjs/common");
const event_emitter_1 = require("@nestjs/event-emitter");
const stripe_webhook_controller_1 = require("./stripe-webhook.controller");
const stripe_service_1 = require("../services/stripe.service");
const prisma_client_provider_1 = require("../../providers/prisma-client.provider");
describe('StripeWebhookController', () => {
    let controller;
    let stripeService;
    let prismaService;
    let eventEmitter;
    let module;
    // Mock services
    const mockStripeService = {
        constructWebhookEvent: jest.fn(),
        handleWebhookEvent: jest.fn(),
    };
    const mockPrismaService = {
        stripeWebhookEvent: {
            findUnique: jest.fn(),
            create: jest.fn(),
            update: jest.fn(),
            count: jest.fn(),
            groupBy: jest.fn(),
            findMany: jest.fn(),
        },
    };
    const mockEventEmitter = {
        emit: jest.fn(),
    };
    // Test data
    const mockStripeEvent = {
        id: 'evt_1234567890',
        type: 'invoice.payment_succeeded',
        data: {
            object: {
                id: 'in_1234567890',
                amount_paid: 2999,
                currency: 'usd',
                customer: 'cus_1234567890',
                subscription: 'sub_1234567890',
            },
        },
        created: Math.floor(Date.now() / 1000),
        livemode: false,
        api_version: '2022-11-15',
    };
    const mockWebhookEventRecord = {
        id: 'webhook_123',
        eventId: 'evt_1234567890',
        eventType: 'invoice.payment_succeeded',
        eventData: mockStripeEvent.data,
        livemode: false,
        apiVersion: '2022-11-15',
        created: new Date(),
        processed: false,
        processedAt: null,
        success: null,
        errorMessage: null,
    };
    const mockRequest = {
        rawBody: Buffer.from(JSON.stringify(mockStripeEvent)),
        body: mockStripeEvent,
        params: {},
    };
    beforeEach(async () => {
        module = await testing_1.Test.createTestingModule({
            controllers: [stripe_webhook_controller_1.StripeWebhookController],
            providers: [
                {
                    provide: stripe_service_1.StripeService,
                    useValue: mockStripeService,
                },
                {
                    provide: prisma_client_provider_1.PrismaService,
                    useValue: mockPrismaService,
                },
                {
                    provide: event_emitter_1.EventEmitter2,
                    useValue: mockEventEmitter,
                },
            ],
        }).compile();
        controller = module.get(stripe_webhook_controller_1.StripeWebhookController);
        stripeService = module.get(stripe_service_1.StripeService);
        prismaService = module.get(prisma_client_provider_1.PrismaService);
        eventEmitter = module.get(event_emitter_1.EventEmitter2);
    });
    afterEach(() => {
        jest.clearAllMocks();
    });
    describe('Controller Initialization', () => {
        it('should be defined', () => {
            expect(controller).toBeDefined();
        });
        it('should have all services injected', () => {
            expect(stripeService).toBeDefined();
            expect(prismaService).toBeDefined();
            expect(eventEmitter).toBeDefined();
        });
    });
    describe('POST /billing/stripe/webhooks', () => {
        const validSignature = 't=1234567890,v1=abcdef1234567890';
        beforeEach(() => {
            mockStripeService.constructWebhookEvent.mockReturnValue(mockStripeEvent);
            mockStripeService.handleWebhookEvent.mockResolvedValue(undefined);
            mockPrismaService.stripeWebhookEvent.findUnique.mockResolvedValue(null);
            mockPrismaService.stripeWebhookEvent.create.mockResolvedValue(mockWebhookEventRecord);
            mockPrismaService.stripeWebhookEvent.update.mockResolvedValue({
                ...mockWebhookEventRecord,
                processed: true,
                success: true,
            });
        });
        it('should process webhook successfully', async () => {
            const result = await controller.handleWebhook(mockRequest, mockStripeEvent, validSignature);
            expect(result).toEqual({
                received: true,
                eventId: mockStripeEvent.id,
                eventType: mockStripeEvent.type,
                processingTime: expect.any(Number),
            });
            expect(stripeService.constructWebhookEvent).toHaveBeenCalledWith(mockRequest.rawBody, validSignature);
            expect(stripeService.handleWebhookEvent).toHaveBeenCalledWith(mockStripeEvent);
            expect(eventEmitter.emit).toHaveBeenCalledWith('stripe.webhook.processed', {
                eventId: mockStripeEvent.id,
                eventType: mockStripeEvent.type,
                processingTime: expect.any(Number),
                success: true,
            });
        });
        it('should handle missing signature', async () => {
            await expect(controller.handleWebhook(mockRequest, mockStripeEvent, '')).rejects.toThrow(common_1.BadRequestException);
            expect(stripeService.constructWebhookEvent).not.toHaveBeenCalled();
        });
        it('should handle missing raw body', async () => {
            const requestWithoutRawBody = {
                ...mockRequest,
                rawBody: undefined,
            };
            await expect(controller.handleWebhook(requestWithoutRawBody, mockStripeEvent, validSignature)).rejects.toThrow(common_1.BadRequestException);
            expect(stripeService.constructWebhookEvent).not.toHaveBeenCalled();
        });
        it('should handle idempotent events', async () => {
            // Mock existing event found
            mockPrismaService.stripeWebhookEvent.findUnique.mockResolvedValue(mockWebhookEventRecord);
            const result = await controller.handleWebhook(mockRequest, mockStripeEvent, validSignature);
            expect(result).toEqual({
                received: true,
                eventId: mockStripeEvent.id,
                eventType: mockStripeEvent.type,
                message: 'Event already processed',
            });
            // Should not process the event again
            expect(stripeService.handleWebhookEvent).not.toHaveBeenCalled();
        });
        it('should handle webhook construction errors', async () => {
            const constructionError = new Error('Invalid signature');
            mockStripeService.constructWebhookEvent.mockImplementation(() => {
                throw constructionError;
            });
            await expect(controller.handleWebhook(mockRequest, mockStripeEvent, validSignature)).rejects.toThrow(common_1.InternalServerErrorException);
            expect(eventEmitter.emit).toHaveBeenCalledWith('stripe.webhook.error', {
                eventId: mockStripeEvent.id,
                eventType: mockStripeEvent.type,
                processingTime: expect.any(Number),
                error: constructionError.message,
                success: false,
            });
        });
        it('should handle webhook processing errors', async () => {
            const processingError = new Error('Payment processing failed');
            mockStripeService.handleWebhookEvent.mockRejectedValue(processingError);
            await expect(controller.handleWebhook(mockRequest, mockStripeEvent, validSignature)).rejects.toThrow(common_1.InternalServerErrorException);
            expect(mockPrismaService.stripeWebhookEvent.update).toHaveBeenCalledWith({
                where: { eventId: mockStripeEvent.id },
                data: {
                    processed: true,
                    processedAt: expect.any(Date),
                    success: false,
                    errorMessage: processingError.message,
                },
            });
        });
        it('should handle database recording errors gracefully', async () => {
            const dbError = new Error('Database connection failed');
            mockPrismaService.stripeWebhookEvent.create.mockRejectedValue(dbError);
            // Should still process the webhook despite database error
            const result = await controller.handleWebhook(mockRequest, mockStripeEvent, validSignature);
            expect(result.received).toBe(true);
            expect(stripeService.handleWebhookEvent).toHaveBeenCalled();
        });
        it('should handle malformed request body', async () => {
            const malformedRequest = {
                rawBody: mockRequest.rawBody,
                body: 'invalid json',
            };
            const constructionError = new Error('Invalid webhook payload');
            mockStripeService.constructWebhookEvent.mockImplementation(() => {
                throw constructionError;
            });
            await expect(controller.handleWebhook(malformedRequest, 'invalid', validSignature)).rejects.toThrow(common_1.InternalServerErrorException);
            expect(eventEmitter.emit).toHaveBeenCalledWith('stripe.webhook.error', {
                eventId: 'unknown',
                eventType: 'unknown',
                processingTime: expect.any(Number),
                error: constructionError.message,
                success: false,
            });
        });
        it('should handle different event types', async () => {
            const customerCreatedEvent = {
                ...mockStripeEvent,
                id: 'evt_customer_created',
                type: 'customer.created',
            };
            mockStripeService.constructWebhookEvent.mockReturnValue(customerCreatedEvent);
            const result = await controller.handleWebhook(mockRequest, customerCreatedEvent, validSignature);
            expect(result.eventType).toBe('customer.created');
            expect(stripeService.handleWebhookEvent).toHaveBeenCalledWith(customerCreatedEvent);
        });
    });
    describe('POST /billing/stripe/webhooks/test', () => {
        it('should handle test webhook successfully', async () => {
            const testPayload = { test: 'data', timestamp: new Date().toISOString() };
            const result = await controller.testWebhook(testPayload);
            expect(result).toEqual({
                received: true,
                timestamp: expect.any(String),
                message: 'Test webhook processed successfully',
                body: testPayload,
            });
        });
        it('should handle test webhook errors', async () => {
            // Mock logger error to simulate internal error
            const originalLoggerError = controller['logger'].log;
            controller['logger'].log = jest.fn().mockImplementation(() => {
                throw new Error('Logger error');
            });
            await expect(controller.testWebhook({ test: 'data' })).rejects.toThrow(common_1.InternalServerErrorException);
            // Restore original logger
            controller['logger'].log = originalLoggerError;
        });
    });
    describe('POST /billing/stripe/webhooks/stats', () => {
        it('should return webhook statistics successfully', async () => {
            const mockStats = {
                totalEvents: 100,
                processedEvents: 95,
                failedEvents: 5,
                recentEvents: 20,
                eventsByType: [
                    { eventType: 'invoice.payment_succeeded', _count: { eventType: 30 } },
                    { eventType: 'customer.created', _count: { eventType: 25 } },
                    { eventType: 'subscription.created', _count: { eventType: 15 } },
                ],
            };
            mockPrismaService.stripeWebhookEvent.count
                .mockResolvedValueOnce(mockStats.totalEvents)
                .mockResolvedValueOnce(mockStats.processedEvents)
                .mockResolvedValueOnce(mockStats.failedEvents)
                .mockResolvedValueOnce(mockStats.recentEvents);
            mockPrismaService.stripeWebhookEvent.groupBy.mockResolvedValue(mockStats.eventsByType);
            const result = await controller.getWebhookStats();
            expect(result).toEqual({
                totalEvents: 100,
                processedEvents: 95,
                failedEvents: 5,
                recentEvents: 20,
                successRate: 95,
                eventsByType: [
                    { eventType: 'invoice.payment_succeeded', count: 30 },
                    { eventType: 'customer.created', count: 25 },
                    { eventType: 'subscription.created', count: 15 },
                ],
            });
        });
        it('should handle zero events gracefully', async () => {
            mockPrismaService.stripeWebhookEvent.count.mockResolvedValue(0);
            mockPrismaService.stripeWebhookEvent.groupBy.mockResolvedValue([]);
            const result = await controller.getWebhookStats();
            expect(result.successRate).toBe(0);
            expect(result.eventsByType).toEqual([]);
        });
        it('should handle database errors', async () => {
            const dbError = new Error('Database connection failed');
            mockPrismaService.stripeWebhookEvent.count.mockRejectedValue(dbError);
            await expect(controller.getWebhookStats()).rejects.toThrow(common_1.InternalServerErrorException);
        });
    });
    describe('POST /billing/stripe/webhooks/recent', () => {
        it('should return recent webhook events successfully', async () => {
            const mockRecentEvents = [
                {
                    eventId: 'evt_recent_1',
                    eventType: 'invoice.payment_succeeded',
                    created: new Date(),
                    processed: true,
                    processedAt: new Date(),
                    success: true,
                    errorMessage: null,
                },
                {
                    eventId: 'evt_recent_2',
                    eventType: 'customer.created',
                    created: new Date(),
                    processed: true,
                    processedAt: new Date(),
                    success: false,
                    errorMessage: 'Processing failed',
                },
            ];
            mockPrismaService.stripeWebhookEvent.findMany.mockResolvedValue(mockRecentEvents);
            const result = await controller.getRecentEvents();
            expect(result).toEqual({
                events: mockRecentEvents,
                count: mockRecentEvents.length,
            });
            expect(mockPrismaService.stripeWebhookEvent.findMany).toHaveBeenCalledWith({
                select: {
                    eventId: true,
                    eventType: true,
                    created: true,
                    processed: true,
                    processedAt: true,
                    success: true,
                    errorMessage: true,
                },
                orderBy: { created: 'desc' },
                take: 50,
            });
        });
        it('should handle database errors', async () => {
            const dbError = new Error('Database query failed');
            mockPrismaService.stripeWebhookEvent.findMany.mockRejectedValue(dbError);
            await expect(controller.getRecentEvents()).rejects.toThrow(common_1.InternalServerErrorException);
        });
    });
    describe('POST /billing/stripe/webhooks/retry/:eventId', () => {
        const failedEventId = 'evt_failed_123';
        const failedWebhookEvent = {
            ...mockWebhookEventRecord,
            eventId: failedEventId,
            processed: true,
            success: false,
            errorMessage: 'Original processing failed',
        };
        beforeEach(() => {
            mockRequest.params = { eventId: failedEventId };
        });
        it('should retry failed webhook event successfully', async () => {
            mockPrismaService.stripeWebhookEvent.findUnique.mockResolvedValue(failedWebhookEvent);
            mockStripeService.handleWebhookEvent.mockResolvedValue(undefined);
            mockPrismaService.stripeWebhookEvent.update.mockResolvedValue({
                ...failedWebhookEvent,
                success: true,
                errorMessage: null,
            });
            const result = await controller.retryFailedEvent(mockRequest);
            expect(result).toEqual({
                success: true,
                eventId: failedEventId,
                message: 'Webhook event retried successfully',
            });
            expect(stripeService.handleWebhookEvent).toHaveBeenCalledWith({
                id: failedWebhookEvent.eventId,
                type: failedWebhookEvent.eventType,
                data: failedWebhookEvent.eventData,
                created: expect.any(Number),
                livemode: failedWebhookEvent.livemode,
                api_version: failedWebhookEvent.apiVersion,
            });
        });
        it('should handle event not found', async () => {
            mockPrismaService.stripeWebhookEvent.findUnique.mockResolvedValue(null);
            await expect(controller.retryFailedEvent(mockRequest)).rejects.toThrow(common_1.BadRequestException);
        });
        it('should handle already successful event', async () => {
            const successfulEvent = {
                ...failedWebhookEvent,
                success: true,
            };
            mockPrismaService.stripeWebhookEvent.findUnique.mockResolvedValue(successfulEvent);
            await expect(controller.retryFailedEvent(mockRequest)).rejects.toThrow(common_1.BadRequestException);
        });
        it('should handle retry processing errors', async () => {
            mockPrismaService.stripeWebhookEvent.findUnique.mockResolvedValue(failedWebhookEvent);
            const retryError = new Error('Retry processing failed');
            mockStripeService.handleWebhookEvent.mockRejectedValue(retryError);
            await expect(controller.retryFailedEvent(mockRequest)).rejects.toThrow(common_1.InternalServerErrorException);
        });
        it('should handle database errors during retry', async () => {
            const dbError = new Error('Database error during retry');
            mockPrismaService.stripeWebhookEvent.findUnique.mockRejectedValue(dbError);
            await expect(controller.retryFailedEvent(mockRequest)).rejects.toThrow(common_1.InternalServerErrorException);
        });
    });
    describe('Private Methods', () => {
        describe('checkEventIdempotency', () => {
            it('should return true for existing event', async () => {
                mockPrismaService.stripeWebhookEvent.findUnique.mockResolvedValue(mockWebhookEventRecord);
                const result = await controller['checkEventIdempotency']('evt_existing');
                expect(result).toBe(true);
            });
            it('should return false for non-existing event', async () => {
                mockPrismaService.stripeWebhookEvent.findUnique.mockResolvedValue(null);
                const result = await controller['checkEventIdempotency']('evt_new');
                expect(result).toBe(false);
            });
            it('should return false on database error', async () => {
                mockPrismaService.stripeWebhookEvent.findUnique.mockRejectedValue(new Error('Database error'));
                const result = await controller['checkEventIdempotency']('evt_error');
                expect(result).toBe(false);
            });
        });
        describe('recordWebhookEvent', () => {
            it('should record webhook event successfully', async () => {
                mockPrismaService.stripeWebhookEvent.create.mockResolvedValue(mockWebhookEventRecord);
                await expect(controller['recordWebhookEvent'](mockStripeEvent)).resolves.not.toThrow();
                expect(mockPrismaService.stripeWebhookEvent.create).toHaveBeenCalledWith({
                    data: {
                        eventId: mockStripeEvent.id,
                        eventType: mockStripeEvent.type,
                        eventData: mockStripeEvent.data,
                        livemode: mockStripeEvent.livemode,
                        apiVersion: mockStripeEvent.api_version,
                        created: new Date(mockStripeEvent.created * 1000),
                        processed: false,
                    },
                });
            });
            it('should handle database errors gracefully', async () => {
                mockPrismaService.stripeWebhookEvent.create.mockRejectedValue(new Error('Database error'));
                // Should not throw
                await expect(controller['recordWebhookEvent'](mockStripeEvent)).resolves.not.toThrow();
            });
        });
        describe('markEventProcessed', () => {
            it('should mark event as successful', async () => {
                mockPrismaService.stripeWebhookEvent.update.mockResolvedValue({
                    ...mockWebhookEventRecord,
                    processed: true,
                    success: true,
                });
                await expect(controller['markEventProcessed']('evt_123', true)).resolves.not.toThrow();
                expect(mockPrismaService.stripeWebhookEvent.update).toHaveBeenCalledWith({
                    where: { eventId: 'evt_123' },
                    data: {
                        processed: true,
                        processedAt: expect.any(Date),
                        success: true,
                        errorMessage: null,
                    },
                });
            });
            it('should mark event as failed with error message', async () => {
                const errorMessage = 'Processing failed';
                mockPrismaService.stripeWebhookEvent.update.mockResolvedValue({
                    ...mockWebhookEventRecord,
                    processed: true,
                    success: false,
                    errorMessage,
                });
                await expect(controller['markEventProcessed']('evt_123', false, errorMessage)).resolves.not.toThrow();
                expect(mockPrismaService.stripeWebhookEvent.update).toHaveBeenCalledWith({
                    where: { eventId: 'evt_123' },
                    data: {
                        processed: true,
                        processedAt: expect.any(Date),
                        success: false,
                        errorMessage,
                    },
                });
            });
            it('should handle database errors gracefully', async () => {
                mockPrismaService.stripeWebhookEvent.update.mockRejectedValue(new Error('Database error'));
                // Should not throw
                await expect(controller['markEventProcessed']('evt_123', true)).resolves.not.toThrow();
            });
        });
    });
    describe('Event Emission', () => {
        it('should emit success events', async () => {
            mockStripeService.constructWebhookEvent.mockReturnValue(mockStripeEvent);
            mockStripeService.handleWebhookEvent.mockResolvedValue(undefined);
            mockPrismaService.stripeWebhookEvent.findUnique.mockResolvedValue(null);
            mockPrismaService.stripeWebhookEvent.create.mockResolvedValue(mockWebhookEventRecord);
            mockPrismaService.stripeWebhookEvent.update.mockResolvedValue({
                ...mockWebhookEventRecord,
                processed: true,
                success: true,
            });
            await controller.handleWebhook(mockRequest, mockStripeEvent, 't=1234567890,v1=abcdef1234567890');
            expect(eventEmitter.emit).toHaveBeenCalledWith('stripe.webhook.processed', {
                eventId: mockStripeEvent.id,
                eventType: mockStripeEvent.type,
                processingTime: expect.any(Number),
                success: true,
            });
        });
        it('should emit error events', async () => {
            const processingError = new Error('Processing failed');
            mockStripeService.constructWebhookEvent.mockReturnValue(mockStripeEvent);
            mockStripeService.handleWebhookEvent.mockRejectedValue(processingError);
            mockPrismaService.stripeWebhookEvent.findUnique.mockResolvedValue(null);
            mockPrismaService.stripeWebhookEvent.create.mockResolvedValue(mockWebhookEventRecord);
            mockPrismaService.stripeWebhookEvent.update.mockResolvedValue({
                ...mockWebhookEventRecord,
                processed: true,
                success: false,
            });
            await expect(controller.handleWebhook(mockRequest, mockStripeEvent, 't=1234567890,v1=abcdef1234567890')).rejects.toThrow();
            expect(eventEmitter.emit).toHaveBeenCalledWith('stripe.webhook.error', {
                eventId: mockStripeEvent.id,
                eventType: mockStripeEvent.type,
                processingTime: expect.any(Number),
                error: processingError.message,
                success: false,
            });
        });
    });
    describe('Performance Metrics', () => {
        it('should track processing time for successful webhooks', async () => {
            mockStripeService.constructWebhookEvent.mockReturnValue(mockStripeEvent);
            mockStripeService.handleWebhookEvent.mockResolvedValue(undefined);
            mockPrismaService.stripeWebhookEvent.findUnique.mockResolvedValue(null);
            mockPrismaService.stripeWebhookEvent.create.mockResolvedValue(mockWebhookEventRecord);
            mockPrismaService.stripeWebhookEvent.update.mockResolvedValue({
                ...mockWebhookEventRecord,
                processed: true,
                success: true,
            });
            const result = await controller.handleWebhook(mockRequest, mockStripeEvent, 't=1234567890,v1=abcdef1234567890');
            expect(result.processingTime).toBeGreaterThanOrEqual(0);
            expect(typeof result.processingTime).toBe('number');
        });
        it('should track processing time for failed webhooks', async () => {
            const processingError = new Error('Processing failed');
            mockStripeService.constructWebhookEvent.mockReturnValue(mockStripeEvent);
            mockStripeService.handleWebhookEvent.mockRejectedValue(processingError);
            mockPrismaService.stripeWebhookEvent.findUnique.mockResolvedValue(null);
            mockPrismaService.stripeWebhookEvent.create.mockResolvedValue(mockWebhookEventRecord);
            mockPrismaService.stripeWebhookEvent.update.mockResolvedValue({
                ...mockWebhookEventRecord,
                processed: true,
                success: false,
            });
            await expect(controller.handleWebhook(mockRequest, mockStripeEvent, 't=1234567890,v1=abcdef1234567890')).rejects.toThrow();
            expect(eventEmitter.emit).toHaveBeenCalledWith('stripe.webhook.error', {
                eventId: mockStripeEvent.id,
                eventType: mockStripeEvent.type,
                processingTime: expect.any(Number),
                error: processingError.message,
                success: false,
            });
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL2JpbGxpbmcvY29udHJvbGxlcnMvc3RyaXBlLXdlYmhvb2suY29udHJvbGxlci5zcGVjLnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7O0dBR0c7O0FBRUgsNkNBQXNEO0FBQ3RELDJDQUFtRjtBQUNuRix5REFBc0Q7QUFDdEQsMkVBQXNFO0FBQ3RFLCtEQUEyRDtBQUMzRCxtRkFBdUU7QUFLdkUsUUFBUSxDQUFDLHlCQUF5QixFQUFFLEdBQUcsRUFBRTtJQUN2QyxJQUFJLFVBQW1DLENBQUM7SUFDeEMsSUFBSSxhQUE0QixDQUFDO0lBQ2pDLElBQUksYUFBNEIsQ0FBQztJQUNqQyxJQUFJLFlBQTJCLENBQUM7SUFDaEMsSUFBSSxNQUFxQixDQUFDO0lBRTFCLGdCQUFnQjtJQUNoQixNQUFNLGlCQUFpQixHQUFHO1FBQ3hCLHFCQUFxQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDaEMsa0JBQWtCLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtLQUM5QixDQUFDO0lBRUYsTUFBTSxpQkFBaUIsR0FBRztRQUN4QixrQkFBa0IsRUFBRTtZQUNsQixVQUFVLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUNyQixNQUFNLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUNqQixNQUFNLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUNqQixLQUFLLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUNoQixPQUFPLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUNsQixRQUFRLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtTQUNwQjtLQUNGLENBQUM7SUFFRixNQUFNLGdCQUFnQixHQUFHO1FBQ3ZCLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0tBQ2hCLENBQUM7SUFFRixZQUFZO0lBQ1osTUFBTSxlQUFlLEdBQUc7UUFDdEIsRUFBRSxFQUFFLGdCQUFnQjtRQUNwQixJ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QyxrQkFBa0IsQ0FBQyxVQUFVLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDeEUsaUJBQWlCLENBQUMsa0JBQWtCLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLHNCQUFzQixDQUFDLENBQUM7WUFDdEYsaUJBQWlCLENBQUMsa0JBQWtCLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDO2dCQUM1RCxHQUFHLHNCQUFzQjtnQkFDekIsU0FBUyxFQUFFLElBQUk7Z0JBQ2YsT0FBTyxFQUFFLEtBQUs7YUFDZixDQUFDLENBQUM7WUFFSCxNQUFNLE1BQU0sQ0FDVixVQUFVLENBQUMsYUFBYSxDQUN0QixXQUFrQixFQUNsQixlQUFlLEVBQ2Ysa0NBQWtDLENBQ25DLENBQ0YsQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLENBQUM7WUFFcEIsTUFBTSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxzQkFBc0IsRUFBRTtnQkFDckUsT0FBTyxFQUFFLGVBQWUsQ0FBQyxFQUFFO2dCQUMzQixTQUFTLEVBQUUsZUFBZSxDQUFDLElBQUk7Z0JBQy9CLGNBQWMsRUFBRSxNQUFNLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQztnQkFDbEMsS0FBSyxFQUFFLGVBQWUsQ0FBQyxPQUFPO2dCQUM5QixPQUFPLEVBQUUsS0FBSzthQUNmLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS93ZXRvb2EvRG9jdW1lbnRzL2NvZGUvcHJvamVjdHMvbWVudGFyYS9tZW50YXJhLWFwaS9zcmMvYmlsbGluZy9jb250cm9sbGVycy9zdHJpcGUtd2ViaG9vay5jb250cm9sbGVyLnNwZWMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb21wcmVoZW5zaXZlIFRlc3QgU3VpdGUgZm9yIFN0cmlwZVdlYmhvb2tDb250cm9sbGVyXG4gKiBUZXN0cyB3ZWJob29rIGV2ZW50IHByb2Nlc3NpbmcsIGlkZW1wb3RlbmN5LCBlcnJvciBoYW5kbGluZywgYW5kIHN0YXRpc3RpY3NcbiAqL1xuXG5pbXBvcnQgeyBUZXN0LCBUZXN0aW5nTW9kdWxlIH0gZnJvbSAnQG5lc3Rqcy90ZXN0aW5nJztcbmltcG9ydCB7IEJhZFJlcXVlc3RFeGNlcHRpb24sIEludGVybmFsU2VydmVyRXJyb3JFeGNlcHRpb24gfSBmcm9tICdAbmVzdGpzL2NvbW1vbic7XG5pbXBvcnQgeyBFdmVudEVtaXR0ZXIyIH0gZnJvbSAnQG5lc3Rqcy9ldmVudC1lbWl0dGVyJztcbmltcG9ydCB7IFN0cmlwZVdlYmhvb2tDb250cm9sbGVyIH0gZnJvbSAnLi9zdHJpcGUtd2ViaG9vay5jb250cm9sbGVyJztcbmltcG9ydCB7IFN0cmlwZVNlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy9zdHJpcGUuc2VydmljZSc7XG5pbXBvcnQgeyBQcmlzbWFTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vcHJvdmlkZXJzL3ByaXNtYS1jbGllbnQucHJvdmlkZXInO1xuaW1wb3J0IHsgU2VjdXJpdHlHdWFyZFRlc3RVdGlscywgUm9sZUJhc2VkVGVzdFV0aWxzIH0gZnJvbSAnLi4vLi4vdGVzdC11dGlscy9hdXRoLXRlc3RpbmctaGVscGVycyc7XG5pbXBvcnQgeyBNb2NrQnVpbGRlciwgVGVzdERhdGFHZW5lcmF0b3IsIFRlc3RBc3NlcnRpb25zIH0gZnJvbSAnLi4vLi4vdGVzdC11dGlscy9lbmhhbmNlZC10ZXN0LWhlbHBlcnMnO1xuaW1wb3J0IHsgVEVTVF9VU0VSX0lEUywgVEVTVF9FTUFJTFMgfSBmcm9tICcuLi8uLi90ZXN0LXV0aWxzL2luZGV4JztcblxuZGVzY3JpYmUoJ1N0cmlwZVdlYmhvb2tDb250cm9sbGVyJywgKCkgPT4ge1xuICBsZXQgY29udHJvbGxlcjogU3RyaXBlV2ViaG9va0NvbnRyb2xsZXI7XG4gIGxldCBzdHJpcGVTZXJ2aWNlOiBTdHJpcGVTZXJ2aWNlO1xuICBsZXQgcHJpc21hU2VydmljZTogUHJpc21hU2VydmljZTtcbiAgbGV0IGV2ZW50RW1pdHRlcjogRXZlbnRFbWl0dGVyMjtcbiAgbGV0IG1vZHVsZTogVGVzdGluZ01vZHVsZTtcblxuICAvLyBNb2NrIHNlcnZpY2VzXG4gIGNvbnN0IG1vY2tTdHJpcGVTZXJ2aWNlID0ge1xuICAgIGNvbnN0cnVjdFdlYmhvb2tFdmVudDogamVzdC5mbigpLFxuICAgIGhhbmRsZVdlYmhvb2tFdmVudDogamVzdC5mbigpLFxuICB9O1xuXG4gIGNvbnN0IG1vY2tQcmlzbWFTZXJ2aWNlID0ge1xuICAgIHN0cmlwZVdlYmhvb2tFdmVudDoge1xuICAgICAgZmluZFVuaXF1ZTogamVzdC5mbigpLFxuICAgICAgY3JlYXRlOiBqZXN0LmZuKCksXG4gICAgICB1cGRhdGU6IGplc3QuZm4oKSxcbiAgICAgIGNvdW50OiBqZXN0LmZuKCksXG4gICAgICBncm91cEJ5OiBqZXN0LmZuKCksXG4gICAgICBmaW5kTWFueTogamVzdC5mbigpLFxuICAgIH0sXG4gIH07XG5cbiAgY29uc3QgbW9ja0V2ZW50RW1pdHRlciA9IHtcbiAgICBlbWl0OiBqZXN0LmZuKCksXG4gIH07XG5cbiAgLy8gVGVzdCBkYXRhXG4gIGNvbnN0IG1vY2tTdHJpcGVFdmVudCA9IHtcbiAgICBpZDogJ2V2dF8xMjM0NTY3ODkwJyxcbiAgICB0eXBlOiAnaW52b2ljZS5wYXltZW50X3N1Y2NlZWRlZCcsXG4gICAgZGF0YToge1xuICAgICAgb2JqZWN0OiB7XG4gICAgICAgIGlkOiAnaW5fMTIzNDU2Nzg5MCcsXG4gICAgICAgIGFtb3VudF9wYWlkOiAyOTk5LFxuICAgICAgICBjdXJyZW5jeTogJ3VzZCcsXG4gICAgICAgIGN1c3RvbWVyOiAnY3VzXzEyMzQ1Njc4OTAnLFxuICAgICAgICBzdWJzY3JpcHRpb246ICdzdWJfMTIzNDU2Nzg5MCcsXG4gICAgICB9LFxuICAgIH0sXG4gICAgY3JlYXRlZDogTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMCksXG4gICAgbGl2ZW1vZGU6IGZhbHNlLFxuICAgIGFwaV92ZXJzaW9uOiAnMjAyMi0xMS0xNScsXG4gIH07XG5cbiAgY29uc3QgbW9ja1dlYmhvb2tFdmVudFJlY29yZCA9IHtcbiAgICBpZDogJ3dlYmhvb2tfMTIzJyxcbiAgICBldmVudElkOiAnZXZ0XzEyMzQ1Njc4OTAnLFxuICAgIGV2ZW50VHlwZTogJ2ludm9pY2UucGF5bWVudF9zdWNjZWVkZWQnLFxuICAgIGV2ZW50RGF0YTogbW9ja1N0cmlwZUV2ZW50LmRhdGEsXG4gICAgbGl2ZW1vZGU6IGZhbHNlLFxuICAgIGFwaVZlcnNpb246ICcyMDIyLTExLTE1JyxcbiAgICBjcmVhdGVkOiBuZXcgRGF0ZSgpLFxuICAgIHByb2Nlc3NlZDogZmFsc2UsXG4gICAgcHJvY2Vzc2VkQXQ6IG51bGwsXG4gICAgc3VjY2VzczogbnVsbCxcbiAgICBlcnJvck1lc3NhZ2U6IG51bGwsXG4gIH07XG5cbiAgY29uc3QgbW9ja1JlcXVlc3QgPSB7XG4gICAgcmF3Qm9keTogQnVmZmVyLmZyb20oSlNPTi5zdHJpbmdpZnkobW9ja1N0cmlwZUV2ZW50KSksXG4gICAgYm9keTogbW9ja1N0cmlwZUV2ZW50LFxuICAgIHBhcmFtczoge30sXG4gIH07XG5cbiAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7XG4gICAgbW9kdWxlID0gYXdhaXQgVGVzdC5jcmVhdGVUZXN0aW5nTW9kdWxlKHtcbiAgICAgIGNvbnRyb2xsZXJzOiBbU3RyaXBlV2ViaG9va0NvbnRyb2xsZXJdLFxuICAgICAgcHJvdmlkZXJzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlOiBTdHJpcGVTZXJ2aWNlLFxuICAgICAgICAgIHVzZVZhbHVlOiBtb2NrU3RyaXBlU2VydmljZSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHByb3ZpZGU6IFByaXNtYVNlcnZpY2UsXG4gICAgICAgICAgdXNlVmFsdWU6IG1vY2tQcmlzbWFTZXJ2aWNlLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgcHJvdmlkZTogRXZlbnRFbWl0dGVyMixcbiAgICAgICAgICB1c2VWYWx1ZTogbW9ja0V2ZW50RW1pdHRlcixcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSkuY29tcGlsZSgpO1xuXG4gICAgY29udHJvbGxlciA9IG1vZHVsZS5nZXQ8U3RyaXBlV2ViaG9va0NvbnRyb2xsZXI+KFN0cmlwZVdlYmhvb2tDb250cm9sbGVyKTtcbiAgICBzdHJpcGVTZXJ2aWNlID0gbW9kdWxlLmdldDxTdHJpcGVTZXJ2aWNlPihTdHJpcGVTZXJ2aWNlKTtcbiAgICBwcmlzbWFTZXJ2aWNlID0gbW9kdWxlLmdldDxQcmlzbWFTZXJ2aWNlPihQcmlzbWFTZXJ2aWNlKTtcbiAgICBldmVudEVtaXR0ZXIgPSBtb2R1bGUuZ2V0PEV2ZW50RW1pdHRlcjI+KEV2ZW50RW1pdHRlcjIpO1xuICB9KTtcblxuICBhZnRlckVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICB9KTtcblxuICBkZXNjcmliZSgnQ29udHJvbGxlciBJbml0aWFsaXphdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGJlIGRlZmluZWQnLCAoKSA9PiB7XG4gICAgICBleHBlY3QoY29udHJvbGxlcikudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGF2ZSBhbGwgc2VydmljZXMgaW5qZWN0ZWQnLCAoKSA9PiB7XG4gICAgICBleHBlY3Qoc3RyaXBlU2VydmljZSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChwcmlzbWFTZXJ2aWNlKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGV2ZW50RW1pdHRlcikudG9CZURlZmluZWQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1BPU1QgL2JpbGxpbmcvc3RyaXBlL3dlYmhvb2tzJywgKCkgPT4ge1xuICAgIGNvbnN0IHZhbGlkU2lnbmF0dXJlID0gJ3Q9MTIzNDU2Nzg5MCx2MT1hYmNkZWYxMjM0NTY3ODkwJztcblxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgbW9ja1N0cmlwZVNlcnZpY2UuY29uc3RydWN0V2ViaG9va0V2ZW50Lm1vY2tSZXR1cm5WYWx1ZShtb2NrU3RyaXBlRXZlbnQpO1xuICAgICAgbW9ja1N0cmlwZVNlcnZpY2UuaGFuZGxlV2ViaG9va0V2ZW50Lm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCk7XG4gICAgICBtb2NrUHJpc21hU2VydmljZS5zdHJpcGVXZWJob29rRXZlbnQuZmluZFVuaXF1ZS5tb2NrUmVzb2x2ZWRWYWx1ZShudWxsKTtcbiAgICAgIG1vY2tQcmlzbWFTZXJ2aWNlLnN0cmlwZVdlYmhvb2tFdmVudC5jcmVhdGUubW9ja1Jlc29sdmVkVmFsdWUobW9ja1dlYmhvb2tFdmVudFJlY29yZCk7XG4gICAgICBtb2NrUHJpc21hU2VydmljZS5zdHJpcGVXZWJob29rRXZlbnQudXBkYXRlLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgLi4ubW9ja1dlYmhvb2tFdmVudFJlY29yZCxcbiAgICAgICAgcHJvY2Vzc2VkOiB0cnVlLFxuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHByb2Nlc3Mgd2ViaG9vayBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmhhbmRsZVdlYmhvb2soXG4gICAgICAgIG1vY2tSZXF1ZXN0IGFzIGFueSxcbiAgICAgICAgbW9ja1N0cmlwZUV2ZW50LFxuICAgICAgICB2YWxpZFNpZ25hdHVyZVxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7XG4gICAgICAgIHJlY2VpdmVkOiB0cnVlLFxuICAgICAgICBldmVudElkOiBtb2NrU3RyaXBlRXZlbnQuaWQsXG4gICAgICAgIGV2ZW50VHlwZTogbW9ja1N0cmlwZUV2ZW50LnR5cGUsXG4gICAgICAgIHByb2Nlc3NpbmdUaW1lOiBleHBlY3QuYW55KE51bWJlciksXG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KHN0cmlwZVNlcnZpY2UuY29uc3RydWN0V2ViaG9va0V2ZW50KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgbW9ja1JlcXVlc3QucmF3Qm9keSxcbiAgICAgICAgdmFsaWRTaWduYXR1cmVcbiAgICAgICk7XG4gICAgICBleHBlY3Qoc3RyaXBlU2VydmljZS5oYW5kbGVXZWJob29rRXZlbnQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKG1vY2tTdHJpcGVFdmVudCk7XG4gICAgICBleHBlY3QoZXZlbnRFbWl0dGVyLmVtaXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdzdHJpcGUud2ViaG9vay5wcm9jZXNzZWQnLCB7XG4gICAgICAgIGV2ZW50SWQ6IG1vY2tTdHJpcGVFdmVudC5pZCxcbiAgICAgICAgZXZlbnRUeXBlOiBtb2NrU3RyaXBlRXZlbnQudHlwZSxcbiAgICAgICAgcHJvY2Vzc2luZ1RpbWU6IGV4cGVjdC5hbnkoTnVtYmVyKSxcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbWlzc2luZyBzaWduYXR1cmUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIuaGFuZGxlV2ViaG9vayhtb2NrUmVxdWVzdCBhcyBhbnksIG1vY2tTdHJpcGVFdmVudCwgJycpXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhCYWRSZXF1ZXN0RXhjZXB0aW9uKTtcblxuICAgICAgZXhwZWN0KHN0cmlwZVNlcnZpY2UuY29uc3RydWN0V2ViaG9va0V2ZW50KS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbWlzc2luZyByYXcgYm9keScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlcXVlc3RXaXRob3V0UmF3Qm9keSA9IHtcbiAgICAgICAgLi4ubW9ja1JlcXVlc3QsXG4gICAgICAgIHJhd0JvZHk6IHVuZGVmaW5lZCxcbiAgICAgIH07XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5oYW5kbGVXZWJob29rKHJlcXVlc3RXaXRob3V0UmF3Qm9keSBhcyBhbnksIG1vY2tTdHJpcGVFdmVudCwgdmFsaWRTaWduYXR1cmUpXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhCYWRSZXF1ZXN0RXhjZXB0aW9uKTtcblxuICAgICAgZXhwZWN0KHN0cmlwZVNlcnZpY2UuY29uc3RydWN0V2ViaG9va0V2ZW50KS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgaWRlbXBvdGVudCBldmVudHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIGV4aXN0aW5nIGV2ZW50IGZvdW5kXG4gICAgICBtb2NrUHJpc21hU2VydmljZS5zdHJpcGVXZWJob29rRXZlbnQuZmluZFVuaXF1ZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrV2ViaG9va0V2ZW50UmVjb3JkKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5oYW5kbGVXZWJob29rKFxuICAgICAgICBtb2NrUmVxdWVzdCBhcyBhbnksXG4gICAgICAgIG1vY2tTdHJpcGVFdmVudCxcbiAgICAgICAgdmFsaWRTaWduYXR1cmVcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoe1xuICAgICAgICByZWNlaXZlZDogdHJ1ZSxcbiAgICAgICAgZXZlbnRJZDogbW9ja1N0cmlwZUV2ZW50LmlkLFxuICAgICAgICBldmVudFR5cGU6IG1vY2tTdHJpcGVFdmVudC50eXBlLFxuICAgICAgICBtZXNzYWdlOiAnRXZlbnQgYWxyZWFkeSBwcm9jZXNzZWQnLFxuICAgICAgfSk7XG5cbiAgICAgIC8vIFNob3VsZCBub3QgcHJvY2VzcyB0aGUgZXZlbnQgYWdhaW5cbiAgICAgIGV4cGVjdChzdHJpcGVTZXJ2aWNlLmhhbmRsZVdlYmhvb2tFdmVudCkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHdlYmhvb2sgY29uc3RydWN0aW9uIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbnN0cnVjdGlvbkVycm9yID0gbmV3IEVycm9yKCdJbnZhbGlkIHNpZ25hdHVyZScpO1xuICAgICAgbW9ja1N0cmlwZVNlcnZpY2UuY29uc3RydWN0V2ViaG9va0V2ZW50Lm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7XG4gICAgICAgIHRocm93IGNvbnN0cnVjdGlvbkVycm9yO1xuICAgICAgfSk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5oYW5kbGVXZWJob29rKG1vY2tSZXF1ZXN0IGFzIGFueSwgbW9ja1N0cmlwZUV2ZW50LCB2YWxpZFNpZ25hdHVyZSlcbiAgICAgICkucmVqZWN0cy50b1Rocm93KEludGVybmFsU2VydmVyRXJyb3JFeGNlcHRpb24pO1xuXG4gICAgICBleHBlY3QoZXZlbnRFbWl0dGVyLmVtaXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdzdHJpcGUud2ViaG9vay5lcnJvcicsIHtcbiAgICAgICAgZXZlbnRJZDogbW9ja1N0cmlwZUV2ZW50LmlkLFxuICAgICAgICBldmVudFR5cGU6IG1vY2tTdHJpcGVFdmVudC50eXBlLFxuICAgICAgICBwcm9jZXNzaW5nVGltZTogZXhwZWN0LmFueShOdW1iZXIpLFxuICAgICAgICBlcnJvcjogY29uc3RydWN0aW9uRXJyb3IubWVzc2FnZSxcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHdlYmhvb2sgcHJvY2Vzc2luZyBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBwcm9jZXNzaW5nRXJyb3IgPSBuZXcgRXJyb3IoJ1BheW1lbnQgcHJvY2Vzc2luZyBmYWlsZWQnKTtcbiAgICAgIG1vY2tTdHJpcGVTZXJ2aWNlLmhhbmRsZVdlYmhvb2tFdmVudC5tb2NrUmVqZWN0ZWRWYWx1ZShwcm9jZXNzaW5nRXJyb3IpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIuaGFuZGxlV2ViaG9vayhtb2NrUmVxdWVzdCBhcyBhbnksIG1vY2tTdHJpcGVFdmVudCwgdmFsaWRTaWduYXR1cmUpXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhJbnRlcm5hbFNlcnZlckVycm9yRXhjZXB0aW9uKTtcblxuICAgICAgZXhwZWN0KG1vY2tQcmlzbWFTZXJ2aWNlLnN0cmlwZVdlYmhvb2tFdmVudC51cGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgd2hlcmU6IHsgZXZlbnRJZDogbW9ja1N0cmlwZUV2ZW50LmlkIH0sXG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBwcm9jZXNzZWQ6IHRydWUsXG4gICAgICAgICAgcHJvY2Vzc2VkQXQ6IGV4cGVjdC5hbnkoRGF0ZSksXG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3JNZXNzYWdlOiBwcm9jZXNzaW5nRXJyb3IubWVzc2FnZSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZGF0YWJhc2UgcmVjb3JkaW5nIGVycm9ycyBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZGJFcnJvciA9IG5ldyBFcnJvcignRGF0YWJhc2UgY29ubmVjdGlvbiBmYWlsZWQnKTtcbiAgICAgIG1vY2tQcmlzbWFTZXJ2aWNlLnN0cmlwZVdlYmhvb2tFdmVudC5jcmVhdGUubW9ja1JlamVjdGVkVmFsdWUoZGJFcnJvcik7XG5cbiAgICAgIC8vIFNob3VsZCBzdGlsbCBwcm9jZXNzIHRoZSB3ZWJob29rIGRlc3BpdGUgZGF0YWJhc2UgZXJyb3JcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuaGFuZGxlV2ViaG9vayhcbiAgICAgICAgbW9ja1JlcXVlc3QgYXMgYW55LFxuICAgICAgICBtb2NrU3RyaXBlRXZlbnQsXG4gICAgICAgIHZhbGlkU2lnbmF0dXJlXG4gICAgICApO1xuXG4gICAgICBleHBlY3QocmVzdWx0LnJlY2VpdmVkKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHN0cmlwZVNlcnZpY2UuaGFuZGxlV2ViaG9va0V2ZW50KS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBtYWxmb3JtZWQgcmVxdWVzdCBib2R5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbWFsZm9ybWVkUmVxdWVzdCA9IHtcbiAgICAgICAgcmF3Qm9keTogbW9ja1JlcXVlc3QucmF3Qm9keSxcbiAgICAgICAgYm9keTogJ2ludmFsaWQganNvbicsXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBjb25zdHJ1Y3Rpb25FcnJvciA9IG5ldyBFcnJvcignSW52YWxpZCB3ZWJob29rIHBheWxvYWQnKTtcbiAgICAgIG1vY2tTdHJpcGVTZXJ2aWNlLmNvbnN0cnVjdFdlYmhvb2tFdmVudC5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge1xuICAgICAgICB0aHJvdyBjb25zdHJ1Y3Rpb25FcnJvcjtcbiAgICAgIH0pO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIuaGFuZGxlV2ViaG9vayhtYWxmb3JtZWRSZXF1ZXN0IGFzIGFueSwgJ2ludmFsaWQnLCB2YWxpZFNpZ25hdHVyZSlcbiAgICAgICkucmVqZWN0cy50b1Rocm93KEludGVybmFsU2VydmVyRXJyb3JFeGNlcHRpb24pO1xuXG4gICAgICBleHBlY3QoZXZlbnRFbWl0dGVyLmVtaXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdzdHJpcGUud2ViaG9vay5lcnJvcicsIHtcbiAgICAgICAgZXZlbnRJZDogJ3Vua25vd24nLFxuICAgICAgICBldmVudFR5cGU6ICd1bmtub3duJyxcbiAgICAgICAgcHJvY2Vzc2luZ1RpbWU6IGV4cGVjdC5hbnkoTnVtYmVyKSxcbiAgICAgICAgZXJyb3I6IGNvbnN0cnVjdGlvbkVycm9yLm1lc3NhZ2UsXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBkaWZmZXJlbnQgZXZlbnQgdHlwZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBjdXN0b21lckNyZWF0ZWRFdmVudCA9IHtcbiAgICAgICAgLi4ubW9ja1N0cmlwZUV2ZW50LFxuICAgICAgICBpZDogJ2V2dF9jdXN0b21lcl9jcmVhdGVkJyxcbiAgICAgICAgdHlwZTogJ2N1c3RvbWVyLmNyZWF0ZWQnLFxuICAgICAgfTtcblxuICAgICAgbW9ja1N0cmlwZVNlcnZpY2UuY29uc3RydWN0V2ViaG9va0V2ZW50Lm1vY2tSZXR1cm5WYWx1ZShjdXN0b21lckNyZWF0ZWRFdmVudCk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuaGFuZGxlV2ViaG9vayhcbiAgICAgICAgbW9ja1JlcXVlc3QgYXMgYW55LFxuICAgICAgICBjdXN0b21lckNyZWF0ZWRFdmVudCxcbiAgICAgICAgdmFsaWRTaWduYXR1cmVcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuZXZlbnRUeXBlKS50b0JlKCdjdXN0b21lci5jcmVhdGVkJyk7XG4gICAgICBleHBlY3Qoc3RyaXBlU2VydmljZS5oYW5kbGVXZWJob29rRXZlbnQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGN1c3RvbWVyQ3JlYXRlZEV2ZW50KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1BPU1QgL2JpbGxpbmcvc3RyaXBlL3dlYmhvb2tzL3Rlc3QnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgdGVzdCB3ZWJob29rIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRlc3RQYXlsb2FkID0geyB0ZXN0OiAnZGF0YScsIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpIH07XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIudGVzdFdlYmhvb2sodGVzdFBheWxvYWQpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHtcbiAgICAgICAgcmVjZWl2ZWQ6IHRydWUsXG4gICAgICAgIHRpbWVzdGFtcDogZXhwZWN0LmFueShTdHJpbmcpLFxuICAgICAgICBtZXNzYWdlOiAnVGVzdCB3ZWJob29rIHByb2Nlc3NlZCBzdWNjZXNzZnVsbHknLFxuICAgICAgICBib2R5OiB0ZXN0UGF5bG9hZCxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgdGVzdCB3ZWJob29rIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgbG9nZ2VyIGVycm9yIHRvIHNpbXVsYXRlIGludGVybmFsIGVycm9yXG4gICAgICBjb25zdCBvcmlnaW5hbExvZ2dlckVycm9yID0gY29udHJvbGxlclsnbG9nZ2VyJ10ubG9nO1xuICAgICAgY29udHJvbGxlclsnbG9nZ2VyJ10ubG9nID0gamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTG9nZ2VyIGVycm9yJyk7XG4gICAgICB9KTtcblxuICAgICAgYXdhaXQgZXhwZWN0KGNvbnRyb2xsZXIudGVzdFdlYmhvb2soeyB0ZXN0OiAnZGF0YScgfSkpLnJlamVjdHMudG9UaHJvdyhcbiAgICAgICAgSW50ZXJuYWxTZXJ2ZXJFcnJvckV4Y2VwdGlvblxuICAgICAgKTtcblxuICAgICAgLy8gUmVzdG9yZSBvcmlnaW5hbCBsb2dnZXJcbiAgICAgIGNvbnRyb2xsZXJbJ2xvZ2dlciddLmxvZyA9IG9yaWdpbmFsTG9nZ2VyRXJyb3I7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdQT1NUIC9iaWxsaW5nL3N0cmlwZS93ZWJob29rcy9zdGF0cycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiB3ZWJob29rIHN0YXRpc3RpY3Mgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja1N0YXRzID0ge1xuICAgICAgICB0b3RhbEV2ZW50czogMTAwLFxuICAgICAgICBwcm9jZXNzZWRFdmVudHM6IDk1LFxuICAgICAgICBmYWlsZWRFdmVudHM6IDUsXG4gICAgICAgIHJlY2VudEV2ZW50czogMjAsXG4gICAgICAgIGV2ZW50c0J5VHlwZTogW1xuICAgICAgICAgIHsgZXZlbnRUeXBlOiAnaW52b2ljZS5wYXltZW50X3N1Y2NlZWRlZCcsIF9jb3VudDogeyBldmVudFR5cGU6IDMwIH0gfSxcbiAgICAgICAgICB7IGV2ZW50VHlwZTogJ2N1c3RvbWVyLmNyZWF0ZWQnLCBfY291bnQ6IHsgZXZlbnRUeXBlOiAyNSB9IH0sXG4gICAgICAgICAgeyBldmVudFR5cGU6ICdzdWJzY3JpcHRpb24uY3JlYXRlZCcsIF9jb3VudDogeyBldmVudFR5cGU6IDE1IH0gfSxcbiAgICAgICAgXSxcbiAgICAgIH07XG5cbiAgICAgIG1vY2tQcmlzbWFTZXJ2aWNlLnN0cmlwZVdlYmhvb2tFdmVudC5jb3VudFxuICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKG1vY2tTdGF0cy50b3RhbEV2ZW50cylcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShtb2NrU3RhdHMucHJvY2Vzc2VkRXZlbnRzKVxuICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKG1vY2tTdGF0cy5mYWlsZWRFdmVudHMpXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UobW9ja1N0YXRzLnJlY2VudEV2ZW50cyk7XG5cbiAgICAgIG1vY2tQcmlzbWFTZXJ2aWNlLnN0cmlwZVdlYmhvb2tFdmVudC5ncm91cEJ5Lm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tTdGF0cy5ldmVudHNCeVR5cGUpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldFdlYmhvb2tTdGF0cygpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHtcbiAgICAgICAgdG90YWxFdmVudHM6IDEwMCxcbiAgICAgICAgcHJvY2Vzc2VkRXZlbnRzOiA5NSxcbiAgICAgICAgZmFpbGVkRXZlbnRzOiA1LFxuICAgICAgICByZWNlbnRFdmVudHM6IDIwLFxuICAgICAgICBzdWNjZXNzUmF0ZTogOTUsXG4gICAgICAgIGV2ZW50c0J5VHlwZTogW1xuICAgICAgICAgIHsgZXZlbnRUeXBlOiAnaW52b2ljZS5wYXltZW50X3N1Y2NlZWRlZCcsIGNvdW50OiAzMCB9LFxuICAgICAgICAgIHsgZXZlbnRUeXBlOiAnY3VzdG9tZXIuY3JlYXRlZCcsIGNvdW50OiAyNSB9LFxuICAgICAgICAgIHsgZXZlbnRUeXBlOiAnc3Vic2NyaXB0aW9uLmNyZWF0ZWQnLCBjb3VudDogMTUgfSxcbiAgICAgICAgXSxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgemVybyBldmVudHMgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tQcmlzbWFTZXJ2aWNlLnN0cmlwZVdlYmhvb2tFdmVudC5jb3VudC5tb2NrUmVzb2x2ZWRWYWx1ZSgwKTtcbiAgICAgIG1vY2tQcmlzbWFTZXJ2aWNlLnN0cmlwZVdlYmhvb2tFdmVudC5ncm91cEJ5Lm1vY2tSZXNvbHZlZFZhbHVlKFtdKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRXZWJob29rU3RhdHMoKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzUmF0ZSkudG9CZSgwKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZXZlbnRzQnlUeXBlKS50b0VxdWFsKFtdKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGRhdGFiYXNlIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGRiRXJyb3IgPSBuZXcgRXJyb3IoJ0RhdGFiYXNlIGNvbm5lY3Rpb24gZmFpbGVkJyk7XG4gICAgICBtb2NrUHJpc21hU2VydmljZS5zdHJpcGVXZWJob29rRXZlbnQuY291bnQubW9ja1JlamVjdGVkVmFsdWUoZGJFcnJvcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChjb250cm9sbGVyLmdldFdlYmhvb2tTdGF0cygpKS5yZWplY3RzLnRvVGhyb3coSW50ZXJuYWxTZXJ2ZXJFcnJvckV4Y2VwdGlvbik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdQT1NUIC9iaWxsaW5nL3N0cmlwZS93ZWJob29rcy9yZWNlbnQnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gcmVjZW50IHdlYmhvb2sgZXZlbnRzIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tSZWNlbnRFdmVudHMgPSBbXG4gICAgICAgIHtcbiAgICAgICAgICBldmVudElkOiAnZXZ0X3JlY2VudF8xJyxcbiAgICAgICAgICBldmVudFR5cGU6ICdpbnZvaWNlLnBheW1lbnRfc3VjY2VlZGVkJyxcbiAgICAgICAgICBjcmVhdGVkOiBuZXcgRGF0ZSgpLFxuICAgICAgICAgIHByb2Nlc3NlZDogdHJ1ZSxcbiAgICAgICAgICBwcm9jZXNzZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgIGVycm9yTWVzc2FnZTogbnVsbCxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIGV2ZW50SWQ6ICdldnRfcmVjZW50XzInLFxuICAgICAgICAgIGV2ZW50VHlwZTogJ2N1c3RvbWVyLmNyZWF0ZWQnLFxuICAgICAgICAgIGNyZWF0ZWQ6IG5ldyBEYXRlKCksXG4gICAgICAgICAgcHJvY2Vzc2VkOiB0cnVlLFxuICAgICAgICAgIHByb2Nlc3NlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yTWVzc2FnZTogJ1Byb2Nlc3NpbmcgZmFpbGVkJyxcbiAgICAgICAgfSxcbiAgICAgIF07XG5cbiAgICAgIG1vY2tQcmlzbWFTZXJ2aWNlLnN0cmlwZVdlYmhvb2tFdmVudC5maW5kTWFueS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUmVjZW50RXZlbnRzKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRSZWNlbnRFdmVudHMoKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7XG4gICAgICAgIGV2ZW50czogbW9ja1JlY2VudEV2ZW50cyxcbiAgICAgICAgY291bnQ6IG1vY2tSZWNlbnRFdmVudHMubGVuZ3RoLFxuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChtb2NrUHJpc21hU2VydmljZS5zdHJpcGVXZWJob29rRXZlbnQuZmluZE1hbnkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgZXZlbnRJZDogdHJ1ZSxcbiAgICAgICAgICBldmVudFR5cGU6IHRydWUsXG4gICAgICAgICAgY3JlYXRlZDogdHJ1ZSxcbiAgICAgICAgICBwcm9jZXNzZWQ6IHRydWUsXG4gICAgICAgICAgcHJvY2Vzc2VkQXQ6IHRydWUsXG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICBlcnJvck1lc3NhZ2U6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZDogJ2Rlc2MnIH0sXG4gICAgICAgIHRha2U6IDUwLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBkYXRhYmFzZSBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBkYkVycm9yID0gbmV3IEVycm9yKCdEYXRhYmFzZSBxdWVyeSBmYWlsZWQnKTtcbiAgICAgIG1vY2tQcmlzbWFTZXJ2aWNlLnN0cmlwZVdlYmhvb2tFdmVudC5maW5kTWFueS5tb2NrUmVqZWN0ZWRWYWx1ZShkYkVycm9yKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KGNvbnRyb2xsZXIuZ2V0UmVjZW50RXZlbnRzKCkpLnJlamVjdHMudG9UaHJvdyhJbnRlcm5hbFNlcnZlckVycm9yRXhjZXB0aW9uKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1BPU1QgL2JpbGxpbmcvc3RyaXBlL3dlYmhvb2tzL3JldHJ5LzpldmVudElkJywgKCkgPT4ge1xuICAgIGNvbnN0IGZhaWxlZEV2ZW50SWQgPSAnZXZ0X2ZhaWxlZF8xMjMnO1xuICAgIGNvbnN0IGZhaWxlZFdlYmhvb2tFdmVudCA9IHtcbiAgICAgIC4uLm1vY2tXZWJob29rRXZlbnRSZWNvcmQsXG4gICAgICBldmVudElkOiBmYWlsZWRFdmVudElkLFxuICAgICAgcHJvY2Vzc2VkOiB0cnVlLFxuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvck1lc3NhZ2U6ICdPcmlnaW5hbCBwcm9jZXNzaW5nIGZhaWxlZCcsXG4gICAgfTtcblxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgbW9ja1JlcXVlc3QucGFyYW1zID0geyBldmVudElkOiBmYWlsZWRFdmVudElkIH07XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHJ5IGZhaWxlZCB3ZWJob29rIGV2ZW50IHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tQcmlzbWFTZXJ2aWNlLnN0cmlwZVdlYmhvb2tFdmVudC5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKGZhaWxlZFdlYmhvb2tFdmVudCk7XG4gICAgICBtb2NrU3RyaXBlU2VydmljZS5oYW5kbGVXZWJob29rRXZlbnQubW9ja1Jlc29sdmVkVmFsdWUodW5kZWZpbmVkKTtcbiAgICAgIG1vY2tQcmlzbWFTZXJ2aWNlLnN0cmlwZVdlYmhvb2tFdmVudC51cGRhdGUubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAuLi5mYWlsZWRXZWJob29rRXZlbnQsXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIGVycm9yTWVzc2FnZTogbnVsbCxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLnJldHJ5RmFpbGVkRXZlbnQobW9ja1JlcXVlc3QgYXMgYW55KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIGV2ZW50SWQ6IGZhaWxlZEV2ZW50SWQsXG4gICAgICAgIG1lc3NhZ2U6ICdXZWJob29rIGV2ZW50IHJldHJpZWQgc3VjY2Vzc2Z1bGx5JyxcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3Qoc3RyaXBlU2VydmljZS5oYW5kbGVXZWJob29rRXZlbnQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgaWQ6IGZhaWxlZFdlYmhvb2tFdmVudC5ldmVudElkLFxuICAgICAgICB0eXBlOiBmYWlsZWRXZWJob29rRXZlbnQuZXZlbnRUeXBlLFxuICAgICAgICBkYXRhOiBmYWlsZWRXZWJob29rRXZlbnQuZXZlbnREYXRhLFxuICAgICAgICBjcmVhdGVkOiBleHBlY3QuYW55KE51bWJlciksXG4gICAgICAgIGxpdmVtb2RlOiBmYWlsZWRXZWJob29rRXZlbnQubGl2ZW1vZGUsXG4gICAgICAgIGFwaV92ZXJzaW9uOiBmYWlsZWRXZWJob29rRXZlbnQuYXBpVmVyc2lvbixcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZXZlbnQgbm90IGZvdW5kJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1ByaXNtYVNlcnZpY2Uuc3RyaXBlV2ViaG9va0V2ZW50LmZpbmRVbmlxdWUubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChjb250cm9sbGVyLnJldHJ5RmFpbGVkRXZlbnQobW9ja1JlcXVlc3QgYXMgYW55KSkucmVqZWN0cy50b1Rocm93KFxuICAgICAgICBCYWRSZXF1ZXN0RXhjZXB0aW9uXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgYWxyZWFkeSBzdWNjZXNzZnVsIGV2ZW50JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgc3VjY2Vzc2Z1bEV2ZW50ID0ge1xuICAgICAgICAuLi5mYWlsZWRXZWJob29rRXZlbnQsXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICB9O1xuICAgICAgbW9ja1ByaXNtYVNlcnZpY2Uuc3RyaXBlV2ViaG9va0V2ZW50LmZpbmRVbmlxdWUubW9ja1Jlc29sdmVkVmFsdWUoc3VjY2Vzc2Z1bEV2ZW50KTtcblxuICAgICAgYXdhaXQgZXhwZWN0KGNvbnRyb2xsZXIucmV0cnlGYWlsZWRFdmVudChtb2NrUmVxdWVzdCBhcyBhbnkpKS5yZWplY3RzLnRvVGhyb3coXG4gICAgICAgIEJhZFJlcXVlc3RFeGNlcHRpb25cbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSByZXRyeSBwcm9jZXNzaW5nIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tQcmlzbWFTZXJ2aWNlLnN0cmlwZVdlYmhvb2tFdmVudC5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKGZhaWxlZFdlYmhvb2tFdmVudCk7XG4gICAgICBjb25zdCByZXRyeUVycm9yID0gbmV3IEVycm9yKCdSZXRyeSBwcm9jZXNzaW5nIGZhaWxlZCcpO1xuICAgICAgbW9ja1N0cmlwZVNlcnZpY2UuaGFuZGxlV2ViaG9va0V2ZW50Lm1vY2tSZWplY3RlZFZhbHVlKHJldHJ5RXJyb3IpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoY29udHJvbGxlci5yZXRyeUZhaWxlZEV2ZW50KG1vY2tSZXF1ZXN0IGFzIGFueSkpLnJlamVjdHMudG9UaHJvdyhcbiAgICAgICAgSW50ZXJuYWxTZXJ2ZXJFcnJvckV4Y2VwdGlvblxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGRhdGFiYXNlIGVycm9ycyBkdXJpbmcgcmV0cnknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBkYkVycm9yID0gbmV3IEVycm9yKCdEYXRhYmFzZSBlcnJvciBkdXJpbmcgcmV0cnknKTtcbiAgICAgIG1vY2tQcmlzbWFTZXJ2aWNlLnN0cmlwZVdlYmhvb2tFdmVudC5maW5kVW5pcXVlLm1vY2tSZWplY3RlZFZhbHVlKGRiRXJyb3IpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoY29udHJvbGxlci5yZXRyeUZhaWxlZEV2ZW50KG1vY2tSZXF1ZXN0IGFzIGFueSkpLnJlamVjdHMudG9UaHJvdyhcbiAgICAgICAgSW50ZXJuYWxTZXJ2ZXJFcnJvckV4Y2VwdGlvblxuICAgICAgKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1ByaXZhdGUgTWV0aG9kcycsICgpID0+IHtcbiAgICBkZXNjcmliZSgnY2hlY2tFdmVudElkZW1wb3RlbmN5JywgKCkgPT4ge1xuICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gdHJ1ZSBmb3IgZXhpc3RpbmcgZXZlbnQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIG1vY2tQcmlzbWFTZXJ2aWNlLnN0cmlwZVdlYmhvb2tFdmVudC5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tXZWJob29rRXZlbnRSZWNvcmQpO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXJbJ2NoZWNrRXZlbnRJZGVtcG90ZW5jeSddKCdldnRfZXhpc3RpbmcnKTtcblxuICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlKHRydWUpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgcmV0dXJuIGZhbHNlIGZvciBub24tZXhpc3RpbmcgZXZlbnQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIG1vY2tQcmlzbWFTZXJ2aWNlLnN0cmlwZVdlYmhvb2tFdmVudC5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXJbJ2NoZWNrRXZlbnRJZGVtcG90ZW5jeSddKCdldnRfbmV3Jyk7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZShmYWxzZSk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gZmFsc2Ugb24gZGF0YWJhc2UgZXJyb3InLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIG1vY2tQcmlzbWFTZXJ2aWNlLnN0cmlwZVdlYmhvb2tFdmVudC5maW5kVW5pcXVlLm1vY2tSZWplY3RlZFZhbHVlKFxuICAgICAgICAgIG5ldyBFcnJvcignRGF0YWJhc2UgZXJyb3InKVxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXJbJ2NoZWNrRXZlbnRJZGVtcG90ZW5jeSddKCdldnRfZXJyb3InKTtcblxuICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlKGZhbHNlKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ3JlY29yZFdlYmhvb2tFdmVudCcsICgpID0+IHtcbiAgICAgIGl0KCdzaG91bGQgcmVjb3JkIHdlYmhvb2sgZXZlbnQgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBtb2NrUHJpc21hU2VydmljZS5zdHJpcGVXZWJob29rRXZlbnQuY3JlYXRlLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tXZWJob29rRXZlbnRSZWNvcmQpO1xuXG4gICAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgICBjb250cm9sbGVyWydyZWNvcmRXZWJob29rRXZlbnQnXShtb2NrU3RyaXBlRXZlbnQpXG4gICAgICAgICkucmVzb2x2ZXMubm90LnRvVGhyb3coKTtcblxuICAgICAgICBleHBlY3QobW9ja1ByaXNtYVNlcnZpY2Uuc3RyaXBlV2ViaG9va0V2ZW50LmNyZWF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgIGV2ZW50SWQ6IG1vY2tTdHJpcGVFdmVudC5pZCxcbiAgICAgICAgICAgIGV2ZW50VHlwZTogbW9ja1N0cmlwZUV2ZW50LnR5cGUsXG4gICAgICAgICAgICBldmVudERhdGE6IG1vY2tTdHJpcGVFdmVudC5kYXRhLFxuICAgICAgICAgICAgbGl2ZW1vZGU6IG1vY2tTdHJpcGVFdmVudC5saXZlbW9kZSxcbiAgICAgICAgICAgIGFwaVZlcnNpb246IG1vY2tTdHJpcGVFdmVudC5hcGlfdmVyc2lvbixcbiAgICAgICAgICAgIGNyZWF0ZWQ6IG5ldyBEYXRlKG1vY2tTdHJpcGVFdmVudC5jcmVhdGVkICogMTAwMCksXG4gICAgICAgICAgICBwcm9jZXNzZWQ6IGZhbHNlLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgaGFuZGxlIGRhdGFiYXNlIGVycm9ycyBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBtb2NrUHJpc21hU2VydmljZS5zdHJpcGVXZWJob29rRXZlbnQuY3JlYXRlLm1vY2tSZWplY3RlZFZhbHVlKFxuICAgICAgICAgIG5ldyBFcnJvcignRGF0YWJhc2UgZXJyb3InKVxuICAgICAgICApO1xuXG4gICAgICAgIC8vIFNob3VsZCBub3QgdGhyb3dcbiAgICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICAgIGNvbnRyb2xsZXJbJ3JlY29yZFdlYmhvb2tFdmVudCddKG1vY2tTdHJpcGVFdmVudClcbiAgICAgICAgKS5yZXNvbHZlcy5ub3QudG9UaHJvdygpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnbWFya0V2ZW50UHJvY2Vzc2VkJywgKCkgPT4ge1xuICAgICAgaXQoJ3Nob3VsZCBtYXJrIGV2ZW50IGFzIHN1Y2Nlc3NmdWwnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIG1vY2tQcmlzbWFTZXJ2aWNlLnN0cmlwZVdlYmhvb2tFdmVudC51cGRhdGUubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAgIC4uLm1vY2tXZWJob29rRXZlbnRSZWNvcmQsXG4gICAgICAgICAgcHJvY2Vzc2VkOiB0cnVlLFxuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgICBjb250cm9sbGVyWydtYXJrRXZlbnRQcm9jZXNzZWQnXSgnZXZ0XzEyMycsIHRydWUpXG4gICAgICAgICkucmVzb2x2ZXMubm90LnRvVGhyb3coKTtcblxuICAgICAgICBleHBlY3QobW9ja1ByaXNtYVNlcnZpY2Uuc3RyaXBlV2ViaG9va0V2ZW50LnVwZGF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICAgIHdoZXJlOiB7IGV2ZW50SWQ6ICdldnRfMTIzJyB9LFxuICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgIHByb2Nlc3NlZDogdHJ1ZSxcbiAgICAgICAgICAgIHByb2Nlc3NlZEF0OiBleHBlY3QuYW55KERhdGUpLFxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgIGVycm9yTWVzc2FnZTogbnVsbCxcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIG1hcmsgZXZlbnQgYXMgZmFpbGVkIHdpdGggZXJyb3IgbWVzc2FnZScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gJ1Byb2Nlc3NpbmcgZmFpbGVkJztcbiAgICAgICAgbW9ja1ByaXNtYVNlcnZpY2Uuc3RyaXBlV2ViaG9va0V2ZW50LnVwZGF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgLi4ubW9ja1dlYmhvb2tFdmVudFJlY29yZCxcbiAgICAgICAgICBwcm9jZXNzZWQ6IHRydWUsXG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3JNZXNzYWdlLFxuICAgICAgICB9KTtcblxuICAgICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgICAgY29udHJvbGxlclsnbWFya0V2ZW50UHJvY2Vzc2VkJ10oJ2V2dF8xMjMnLCBmYWxzZSwgZXJyb3JNZXNzYWdlKVxuICAgICAgICApLnJlc29sdmVzLm5vdC50b1Rocm93KCk7XG5cbiAgICAgICAgZXhwZWN0KG1vY2tQcmlzbWFTZXJ2aWNlLnN0cmlwZVdlYmhvb2tFdmVudC51cGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgICB3aGVyZTogeyBldmVudElkOiAnZXZ0XzEyMycgfSxcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBwcm9jZXNzZWQ6IHRydWUsXG4gICAgICAgICAgICBwcm9jZXNzZWRBdDogZXhwZWN0LmFueShEYXRlKSxcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgZXJyb3JNZXNzYWdlLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgaGFuZGxlIGRhdGFiYXNlIGVycm9ycyBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBtb2NrUHJpc21hU2VydmljZS5zdHJpcGVXZWJob29rRXZlbnQudXBkYXRlLm1vY2tSZWplY3RlZFZhbHVlKFxuICAgICAgICAgIG5ldyBFcnJvcignRGF0YWJhc2UgZXJyb3InKVxuICAgICAgICApO1xuXG4gICAgICAgIC8vIFNob3VsZCBub3QgdGhyb3dcbiAgICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICAgIGNvbnRyb2xsZXJbJ21hcmtFdmVudFByb2Nlc3NlZCddKCdldnRfMTIzJywgdHJ1ZSlcbiAgICAgICAgKS5yZXNvbHZlcy5ub3QudG9UaHJvdygpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdFdmVudCBFbWlzc2lvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGVtaXQgc3VjY2VzcyBldmVudHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrU3RyaXBlU2VydmljZS5jb25zdHJ1Y3RXZWJob29rRXZlbnQubW9ja1JldHVyblZhbHVlKG1vY2tTdHJpcGVFdmVudCk7XG4gICAgICBtb2NrU3RyaXBlU2VydmljZS5oYW5kbGVXZWJob29rRXZlbnQubW9ja1Jlc29sdmVkVmFsdWUodW5kZWZpbmVkKTtcbiAgICAgIG1vY2tQcmlzbWFTZXJ2aWNlLnN0cmlwZVdlYmhvb2tFdmVudC5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpO1xuICAgICAgbW9ja1ByaXNtYVNlcnZpY2Uuc3RyaXBlV2ViaG9va0V2ZW50LmNyZWF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrV2ViaG9va0V2ZW50UmVjb3JkKTtcbiAgICAgIG1vY2tQcmlzbWFTZXJ2aWNlLnN0cmlwZVdlYmhvb2tFdmVudC51cGRhdGUubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAuLi5tb2NrV2ViaG9va0V2ZW50UmVjb3JkLFxuICAgICAgICBwcm9jZXNzZWQ6IHRydWUsXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICB9KTtcblxuICAgICAgYXdhaXQgY29udHJvbGxlci5oYW5kbGVXZWJob29rKFxuICAgICAgICBtb2NrUmVxdWVzdCBhcyBhbnksXG4gICAgICAgIG1vY2tTdHJpcGVFdmVudCxcbiAgICAgICAgJ3Q9MTIzNDU2Nzg5MCx2MT1hYmNkZWYxMjM0NTY3ODkwJ1xuICAgICAgKTtcblxuICAgICAgZXhwZWN0KGV2ZW50RW1pdHRlci5lbWl0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnc3RyaXBlLndlYmhvb2sucHJvY2Vzc2VkJywge1xuICAgICAgICBldmVudElkOiBtb2NrU3RyaXBlRXZlbnQuaWQsXG4gICAgICAgIGV2ZW50VHlwZTogbW9ja1N0cmlwZUV2ZW50LnR5cGUsXG4gICAgICAgIHByb2Nlc3NpbmdUaW1lOiBleHBlY3QuYW55KE51bWJlciksXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZW1pdCBlcnJvciBldmVudHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBwcm9jZXNzaW5nRXJyb3IgPSBuZXcgRXJyb3IoJ1Byb2Nlc3NpbmcgZmFpbGVkJyk7XG4gICAgICBtb2NrU3RyaXBlU2VydmljZS5jb25zdHJ1Y3RXZWJob29rRXZlbnQubW9ja1JldHVyblZhbHVlKG1vY2tTdHJpcGVFdmVudCk7XG4gICAgICBtb2NrU3RyaXBlU2VydmljZS5oYW5kbGVXZWJob29rRXZlbnQubW9ja1JlamVjdGVkVmFsdWUocHJvY2Vzc2luZ0Vycm9yKTtcbiAgICAgIG1vY2tQcmlzbWFTZXJ2aWNlLnN0cmlwZVdlYmhvb2tFdmVudC5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpO1xuICAgICAgbW9ja1ByaXNtYVNlcnZpY2Uuc3RyaXBlV2ViaG9va0V2ZW50LmNyZWF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrV2ViaG9va0V2ZW50UmVjb3JkKTtcbiAgICAgIG1vY2tQcmlzbWFTZXJ2aWNlLnN0cmlwZVdlYmhvb2tFdmVudC51cGRhdGUubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAuLi5tb2NrV2ViaG9va0V2ZW50UmVjb3JkLFxuICAgICAgICBwcm9jZXNzZWQ6IHRydWUsXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgfSk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5oYW5kbGVXZWJob29rKFxuICAgICAgICAgIG1vY2tSZXF1ZXN0IGFzIGFueSxcbiAgICAgICAgICBtb2NrU3RyaXBlRXZlbnQsXG4gICAgICAgICAgJ3Q9MTIzNDU2Nzg5MCx2MT1hYmNkZWYxMjM0NTY3ODkwJ1xuICAgICAgICApXG4gICAgICApLnJlamVjdHMudG9UaHJvdygpO1xuXG4gICAgICBleHBlY3QoZXZlbnRFbWl0dGVyLmVtaXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdzdHJpcGUud2ViaG9vay5lcnJvcicsIHtcbiAgICAgICAgZXZlbnRJZDogbW9ja1N0cmlwZUV2ZW50LmlkLFxuICAgICAgICBldmVudFR5cGU6IG1vY2tTdHJpcGVFdmVudC50eXBlLFxuICAgICAgICBwcm9jZXNzaW5nVGltZTogZXhwZWN0LmFueShOdW1iZXIpLFxuICAgICAgICBlcnJvcjogcHJvY2Vzc2luZ0Vycm9yLm1lc3NhZ2UsXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdQZXJmb3JtYW5jZSBNZXRyaWNzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgdHJhY2sgcHJvY2Vzc2luZyB0aW1lIGZvciBzdWNjZXNzZnVsIHdlYmhvb2tzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1N0cmlwZVNlcnZpY2UuY29uc3RydWN0V2ViaG9va0V2ZW50Lm1vY2tSZXR1cm5WYWx1ZShtb2NrU3RyaXBlRXZlbnQpO1xuICAgICAgbW9ja1N0cmlwZVNlcnZpY2UuaGFuZGxlV2ViaG9va0V2ZW50Lm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCk7XG4gICAgICBtb2NrUHJpc21hU2VydmljZS5zdHJpcGVXZWJob29rRXZlbnQuZmluZFVuaXF1ZS5tb2NrUmVzb2x2ZWRWYWx1ZShudWxsKTtcbiAgICAgIG1vY2tQcmlzbWFTZXJ2aWNlLnN0cmlwZVdlYmhvb2tFdmVudC5jcmVhdGUubW9ja1Jlc29sdmVkVmFsdWUobW9ja1dlYmhvb2tFdmVudFJlY29yZCk7XG4gICAgICBtb2NrUHJpc21hU2VydmljZS5zdHJpcGVXZWJob29rRXZlbnQudXBkYXRlLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgLi4ubW9ja1dlYmhvb2tFdmVudFJlY29yZCxcbiAgICAgICAgcHJvY2Vzc2VkOiB0cnVlLFxuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuaGFuZGxlV2ViaG9vayhcbiAgICAgICAgbW9ja1JlcXVlc3QgYXMgYW55LFxuICAgICAgICBtb2NrU3RyaXBlRXZlbnQsXG4gICAgICAgICd0PTEyMzQ1Njc4OTAsdjE9YWJjZGVmMTIzNDU2Nzg5MCdcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQucHJvY2Vzc2luZ1RpbWUpLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwoMCk7XG4gICAgICBleHBlY3QodHlwZW9mIHJlc3VsdC5wcm9jZXNzaW5nVGltZSkudG9CZSgnbnVtYmVyJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRyYWNrIHByb2Nlc3NpbmcgdGltZSBmb3IgZmFpbGVkIHdlYmhvb2tzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcHJvY2Vzc2luZ0Vycm9yID0gbmV3IEVycm9yKCdQcm9jZXNzaW5nIGZhaWxlZCcpO1xuICAgICAgbW9ja1N0cmlwZVNlcnZpY2UuY29uc3RydWN0V2ViaG9va0V2ZW50Lm1vY2tSZXR1cm5WYWx1ZShtb2NrU3RyaXBlRXZlbnQpO1xuICAgICAgbW9ja1N0cmlwZVNlcnZpY2UuaGFuZGxlV2ViaG9va0V2ZW50Lm1vY2tSZWplY3RlZFZhbHVlKHByb2Nlc3NpbmdFcnJvcik7XG4gICAgICBtb2NrUHJpc21hU2VydmljZS5zdHJpcGVXZWJob29rRXZlbnQuZmluZFVuaXF1ZS5tb2NrUmVzb2x2ZWRWYWx1ZShudWxsKTtcbiAgICAgIG1vY2tQcmlzbWFTZXJ2aWNlLnN0cmlwZVdlYmhvb2tFdmVudC5jcmVhdGUubW9ja1Jlc29sdmVkVmFsdWUobW9ja1dlYmhvb2tFdmVudFJlY29yZCk7XG4gICAgICBtb2NrUHJpc21hU2VydmljZS5zdHJpcGVXZWJob29rRXZlbnQudXBkYXRlLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgLi4ubW9ja1dlYmhvb2tFdmVudFJlY29yZCxcbiAgICAgICAgcHJvY2Vzc2VkOiB0cnVlLFxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIH0pO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIuaGFuZGxlV2ViaG9vayhcbiAgICAgICAgICBtb2NrUmVxdWVzdCBhcyBhbnksXG4gICAgICAgICAgbW9ja1N0cmlwZUV2ZW50LFxuICAgICAgICAgICd0PTEyMzQ1Njc4OTAsdjE9YWJjZGVmMTIzNDU2Nzg5MCdcbiAgICAgICAgKVxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coKTtcblxuICAgICAgZXhwZWN0KGV2ZW50RW1pdHRlci5lbWl0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnc3RyaXBlLndlYmhvb2suZXJyb3InLCB7XG4gICAgICAgIGV2ZW50SWQ6IG1vY2tTdHJpcGVFdmVudC5pZCxcbiAgICAgICAgZXZlbnRUeXBlOiBtb2NrU3RyaXBlRXZlbnQudHlwZSxcbiAgICAgICAgcHJvY2Vzc2luZ1RpbWU6IGV4cGVjdC5hbnkoTnVtYmVyKSxcbiAgICAgICAgZXJyb3I6IHByb2Nlc3NpbmdFcnJvci5tZXNzYWdlLFxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcbn0pOyJdLCJ2ZXJzaW9uIjozfQ==