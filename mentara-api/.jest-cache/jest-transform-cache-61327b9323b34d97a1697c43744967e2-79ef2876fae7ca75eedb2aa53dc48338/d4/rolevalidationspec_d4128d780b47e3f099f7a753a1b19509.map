{"file":"/home/wetooa/Documents/code/projects/mentara/mentara-api/src/test-utils/role-validation.spec.ts","mappings":"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","names":[],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/test-utils/role-validation.spec.ts"],"sourcesContent":["import { Test, TestingModule } from '@nestjs/testing';\nimport { ExecutionContext, ForbiddenException } from '@nestjs/common';\nimport { Reflector } from '@nestjs/core';\nimport { RoleBasedAccessGuard } from '../auth/guards/role-based-access.guard';\n\ndescribe('Role-Based Access Control Validation', () => {\n  let guard: RoleBasedAccessGuard;\n  let reflector: Reflector;\n\n  beforeEach(async () => {\n    const module: TestingModule = await Test.createTestingModule({\n      providers: [\n        RoleBasedAccessGuard,\n        {\n          provide: Reflector,\n          useValue: {\n            getAllAndOverride: jest.fn(),\n          },\n        },\n      ],\n    }).compile();\n\n    guard = module.get<RoleBasedAccessGuard>(RoleBasedAccessGuard);\n    reflector = module.get<Reflector>(Reflector);\n  });\n\n  const createMockContext = (user: any): ExecutionContext => {\n    const mockRequest = {\n      user,\n      userRole: user?.role,\n      userId: user?.userId,\n      params: {},\n      body: {},\n      path: '/test',\n    };\n\n    return {\n      switchToHttp: () => ({\n        getRequest: () => mockRequest,\n      }),\n      getHandler: jest.fn(),\n      getClass: jest.fn(),\n    } as any;\n  };\n\n  describe('Client Role Validation', () => {\n    const clientUser = {\n      userId: 'client-123',\n      role: 'client',\n      email: 'client@test.com',\n    };\n\n    it('should allow client to access own resources', () => {\n      const context = createMockContext(clientUser);\n      context.switchToHttp().getRequest().params.id = 'client-123';\n\n      jest.spyOn(reflector, 'getAllAndOverride')\n        .mockReturnValueOnce(['assessments:read:own']) // permissions\n        .mockReturnValueOnce(null) // min_role\n        .mockReturnValueOnce('id'); // resource_owner_param\n\n      expect(guard.canActivate(context)).toBe(true);\n    });\n\n    it('should deny client access to admin functions', () => {\n      const context = createMockContext(clientUser);\n\n      jest.spyOn(reflector, 'getAllAndOverride')\n        .mockReturnValueOnce(['admin:access']) // permissions\n        .mockReturnValueOnce(null) // min_role\n        .mockReturnValueOnce(null); // resource_owner_param\n\n      expect(() => guard.canActivate(context)).toThrow(ForbiddenException);\n    });\n\n    it('should deny client access to other client resources', () => {\n      const context = createMockContext(clientUser);\n      context.switchToHttp().getRequest().params.id = 'other-client-456';\n\n      jest.spyOn(reflector, 'getAllAndOverride')\n        .mockReturnValueOnce(null) // permissions\n        .mockReturnValueOnce(null) // min_role\n        .mockReturnValueOnce('id'); // resource_owner_param\n\n      expect(() => guard.canActivate(context)).toThrow(ForbiddenException);\n    });\n  });\n\n  describe('Therapist Role Validation', () => {\n    const therapistUser = {\n      userId: 'therapist-123',\n      role: 'therapist',\n      email: 'therapist@test.com',\n    };\n\n    it('should allow therapist to access therapist functions', () => {\n      const context = createMockContext(therapistUser);\n\n      jest.spyOn(reflector, 'getAllAndOverride')\n        .mockReturnValueOnce(['sessions:create']) // permissions\n        .mockReturnValueOnce(null) // min_role\n        .mockReturnValueOnce(null); // resource_owner_param\n\n      expect(guard.canActivate(context)).toBe(true);\n    });\n\n    it('should allow therapist to access assigned client data', () => {\n      const context = createMockContext(therapistUser);\n      context.switchToHttp().getRequest().params.clientId = 'client-456';\n\n      jest.spyOn(reflector, 'getAllAndOverride')\n        .mockReturnValueOnce(['assessments:read:assigned']) // permissions\n        .mockReturnValueOnce(null) // min_role\n        .mockReturnValueOnce(null); // resource_owner_param\n\n      expect(guard.canActivate(context)).toBe(true);\n    });\n\n    it('should deny therapist access to admin functions', () => {\n      const context = createMockContext(therapistUser);\n\n      jest.spyOn(reflector, 'getAllAndOverride')\n        .mockReturnValueOnce(['admin:system-config']) // permissions\n        .mockReturnValueOnce(null) // min_role\n        .mockReturnValueOnce(null); // resource_owner_param\n\n      expect(() => guard.canActivate(context)).toThrow(ForbiddenException);\n    });\n  });\n\n  describe('Moderator Role Validation', () => {\n    const moderatorUser = {\n      userId: 'moderator-123',\n      role: 'moderator',\n      email: 'moderator@test.com',\n    };\n\n    it('should allow moderator to access moderation functions', () => {\n      const context = createMockContext(moderatorUser);\n\n      jest.spyOn(reflector, 'getAllAndOverride')\n        .mockReturnValueOnce(['posts:moderate']) // permissions\n        .mockReturnValueOnce(null) // min_role\n        .mockReturnValueOnce(null); // resource_owner_param\n\n      expect(guard.canActivate(context)).toBe(true);\n    });\n\n    it('should allow moderator to access community resources', () => {\n      const context = createMockContext(moderatorUser);\n      context.switchToHttp().getRequest().path = '/communities/123/posts';\n      context.switchToHttp().getRequest().params.id = 'post-456';\n\n      jest.spyOn(reflector, 'getAllAndOverride')\n        .mockReturnValueOnce(null) // permissions\n        .mockReturnValueOnce(null) // min_role\n        .mockReturnValueOnce('id'); // resource_owner_param\n\n      expect(guard.canActivate(context)).toBe(true);\n    });\n\n    it('should deny moderator access to system admin functions', () => {\n      const context = createMockContext(moderatorUser);\n\n      jest.spyOn(reflector, 'getAllAndOverride')\n        .mockReturnValueOnce(['admin:system-config']) // permissions\n        .mockReturnValueOnce(null) // min_role\n        .mockReturnValueOnce(null); // resource_owner_param\n\n      expect(() => guard.canActivate(context)).toThrow(ForbiddenException);\n    });\n  });\n\n  describe('Admin Role Validation', () => {\n    const adminUser = {\n      userId: 'admin-123',\n      role: 'admin',\n      email: 'admin@test.com',\n    };\n\n    it('should allow admin to access all functions', () => {\n      const context = createMockContext(adminUser);\n\n      jest.spyOn(reflector, 'getAllAndOverride')\n        .mockReturnValueOnce(['admin:system-config']) // permissions\n        .mockReturnValueOnce(null) // min_role\n        .mockReturnValueOnce(null); // resource_owner_param\n\n      expect(guard.canActivate(context)).toBe(true);\n    });\n\n    it('should allow admin to access any resource', () => {\n      const context = createMockContext(adminUser);\n      context.switchToHttp().getRequest().params.id = 'any-resource-123';\n\n      jest.spyOn(reflector, 'getAllAndOverride')\n        .mockReturnValueOnce(null) // permissions\n        .mockReturnValueOnce(null) // min_role\n        .mockReturnValueOnce('id'); // resource_owner_param\n\n      expect(guard.canActivate(context)).toBe(true);\n    });\n\n    it('should allow admin minimum role access', () => {\n      const context = createMockContext(adminUser);\n\n      jest.spyOn(reflector, 'getAllAndOverride')\n        .mockReturnValueOnce(null) // permissions\n        .mockReturnValueOnce('admin') // min_role\n        .mockReturnValueOnce(null); // resource_owner_param\n\n      expect(guard.canActivate(context)).toBe(true);\n    });\n  });\n\n  describe('Role Hierarchy Validation', () => {\n    it('should respect role hierarchy for minimum role requirements', () => {\n      const moderatorUser = {\n        userId: 'moderator-123',\n        role: 'moderator',\n        email: 'moderator@test.com',\n      };\n\n      const context = createMockContext(moderatorUser);\n\n      jest.spyOn(reflector, 'getAllAndOverride')\n        .mockReturnValueOnce(null) // permissions\n        .mockReturnValueOnce('therapist') // min_role (moderator > therapist)\n        .mockReturnValueOnce(null); // resource_owner_param\n\n      expect(guard.canActivate(context)).toBe(true);\n    });\n\n    it('should deny access when role is below minimum requirement', () => {\n      const clientUser = {\n        userId: 'client-123',\n        role: 'client',\n        email: 'client@test.com',\n      };\n\n      const context = createMockContext(clientUser);\n\n      jest.spyOn(reflector, 'getAllAndOverride')\n        .mockReturnValueOnce(null) // permissions\n        .mockReturnValueOnce('therapist') // min_role (client < therapist)\n        .mockReturnValueOnce(null); // resource_owner_param\n\n      expect(() => guard.canActivate(context)).toThrow(ForbiddenException);\n    });\n  });\n\n  describe('No Authentication Validation', () => {\n    it('should deny access when no user is provided', () => {\n      const context = createMockContext(null);\n\n      jest.spyOn(reflector, 'getAllAndOverride')\n        .mockReturnValueOnce(['users:read:own']) // permissions\n        .mockReturnValueOnce(null) // min_role\n        .mockReturnValueOnce(null); // resource_owner_param\n\n      expect(guard.canActivate(context)).toBe(false);\n    });\n\n    it('should deny access when user has no role', () => {\n      const userWithoutRole = {\n        userId: 'user-123',\n        email: 'user@test.com',\n      };\n\n      const context = createMockContext(userWithoutRole);\n\n      jest.spyOn(reflector, 'getAllAndOverride')\n        .mockReturnValueOnce(['users:read:own']) // permissions\n        .mockReturnValueOnce(null) // min_role\n        .mockReturnValueOnce(null); // resource_owner_param\n\n      expect(guard.canActivate(context)).toBe(false);\n    });\n  });\n});\n\ndescribe('Permission Helper Functions', () => {\n  describe('getUserPermissions', () => {\n    it('should return correct permissions for client role', () => {\n      const permissions = RoleBasedAccessGuard.getUserPermissions('client');\n      expect(permissions).toContain('assessments:create:own');\n      expect(permissions).toContain('sessions:read:own');\n      expect(permissions).not.toContain('admin:access');\n    });\n\n    it('should return correct permissions for admin role', () => {\n      const permissions = RoleBasedAccessGuard.getUserPermissions('admin');\n      expect(permissions).toContain('admin:access');\n      expect(permissions).toContain('users:delete');\n      expect(permissions.length).toBeGreaterThan(10);\n    });\n  });\n\n  describe('canAccessResource', () => {\n    it('should allow admin to access any resource', () => {\n      const canAccess = RoleBasedAccessGuard.canAccessResource('admin', 'users:delete');\n      expect(canAccess).toBe(true);\n    });\n\n    it('should allow resource owner to access their own resource', () => {\n      const canAccess = RoleBasedAccessGuard.canAccessResource(\n        'client', \n        'assessments:read:own', \n        'user-123', \n        'user-123'\n      );\n      expect(canAccess).toBe(true);\n    });\n\n    it('should deny access to unauthorized resource', () => {\n      const canAccess = RoleBasedAccessGuard.canAccessResource(\n        'client', \n        'admin:access'\n      );\n      expect(canAccess).toBe(false);\n    });\n  });\n});\n\n// Integration test for common scenarios\ndescribe('Role-Based Access Integration Tests', () => {\n  let guard: RoleBasedAccessGuard;\n  let reflector: Reflector;\n\n  beforeEach(async () => {\n    const module: TestingModule = await Test.createTestingModule({\n      providers: [\n        RoleBasedAccessGuard,\n        {\n          provide: Reflector,\n          useValue: {\n            getAllAndOverride: jest.fn(),\n          },\n        },\n      ],\n    }).compile();\n\n    guard = module.get<RoleBasedAccessGuard>(RoleBasedAccessGuard);\n    reflector = module.get<Reflector>(Reflector);\n  });\n\n  const scenarios = [\n    {\n      name: 'Client accessing own assessment',\n      user: { userId: 'client-123', role: 'client' },\n      permissions: ['assessments:read:own'],\n      resourceOwnerParam: 'userId',\n      resourceId: 'client-123',\n      shouldPass: true,\n    },\n    {\n      name: 'Client accessing other client assessment',\n      user: { userId: 'client-123', role: 'client' },\n      permissions: ['assessments:read:own'],\n      resourceOwnerParam: 'userId',\n      resourceId: 'client-456',\n      shouldPass: false,\n    },\n    {\n      name: 'Therapist creating session',\n      user: { userId: 'therapist-123', role: 'therapist' },\n      permissions: ['sessions:create'],\n      resourceOwnerParam: null,\n      resourceId: null,\n      shouldPass: true,\n    },\n    {\n      name: 'Therapist accessing admin functions',\n      user: { userId: 'therapist-123', role: 'therapist' },\n      permissions: ['admin:access'],\n      resourceOwnerParam: null,\n      resourceId: null,\n      shouldPass: false,\n    },\n    {\n      name: 'Moderator accessing moderation functions',\n      user: { userId: 'moderator-123', role: 'moderator' },\n      permissions: ['posts:moderate'],\n      resourceOwnerParam: null,\n      resourceId: null,\n      shouldPass: true,\n    },\n    {\n      name: 'Admin accessing everything',\n      user: { userId: 'admin-123', role: 'admin' },\n      permissions: ['admin:system-config'],\n      resourceOwnerParam: 'id',\n      resourceId: 'any-resource',\n      shouldPass: true,\n    },\n  ];\n\n  scenarios.forEach(scenario => {\n    it(scenario.name, () => {\n      const context = {\n        switchToHttp: () => ({\n          getRequest: () => ({\n            user: scenario.user,\n            userRole: scenario.user.role,\n            userId: scenario.user.userId,\n            params: { [scenario.resourceOwnerParam || 'id']: scenario.resourceId },\n            body: {},\n            path: '/test',\n          }),\n        }),\n        getHandler: jest.fn(),\n        getClass: jest.fn(),\n      } as any;\n\n      jest.spyOn(reflector, 'getAllAndOverride')\n        .mockReturnValueOnce(scenario.permissions)\n        .mockReturnValueOnce(null)\n        .mockReturnValueOnce(scenario.resourceOwnerParam);\n\n      if (scenario.shouldPass) {\n        expect(guard.canActivate(context)).toBe(true);\n      } else {\n        expect(() => guard.canActivate(context)).toThrow(ForbiddenException);\n      }\n    });\n  });\n});"],"version":3}