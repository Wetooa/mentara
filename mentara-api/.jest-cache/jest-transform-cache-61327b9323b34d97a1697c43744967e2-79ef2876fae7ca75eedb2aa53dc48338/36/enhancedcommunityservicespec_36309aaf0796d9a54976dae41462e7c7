898fa3a889d774324d0297afc14a4a64
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const common_1 = require("@nestjs/common");
const event_emitter_1 = require("@nestjs/event-emitter");
const enhanced_community_service_1 = require("./enhanced-community.service");
const prisma_client_provider_1 = require("../../providers/prisma-client.provider");
describe('EnhancedCommunityService', () => {
    let service;
    let prismaService;
    let eventEmitter;
    let loggerSpy;
    // Mock data
    const mockUser = {
        id: 'user-123',
        firstName: 'John',
        lastName: 'Doe',
        avatarUrl: 'avatar.jpg',
        updatedAt: new Date('2024-01-15'),
    };
    const mockModerator = {
        user: mockUser,
    };
    const mockRoom = {
        id: 'room-123',
        name: 'General Discussion',
        order: 1,
        postingRole: 'member',
        roomGroupId: 'roomgroup-123',
        posts: [
            {
                id: 'post-123',
                title: 'Test Post',
                content: 'This is a test post',
                createdAt: new Date('2024-01-10'),
                user: mockUser,
                _count: { comments: 5, hearts: 10 },
            },
            {
                id: 'post-456',
                title: 'Another Post',
                content: 'Another test post',
                createdAt: new Date('2024-01-12'),
                user: mockUser,
                _count: { comments: 3, hearts: 7 },
            },
        ],
        _count: { posts: 2 },
    };
    const mockRoomGroup = {
        id: 'roomgroup-123',
        name: 'General',
        order: 1,
        communityId: 'community-123',
        rooms: [mockRoom],
    };
    const mockCommunityWithDetails = {
        id: 'community-123',
        name: 'Depression Support Network',
        slug: 'depression-support',
        description: 'A supportive community for depression',
        imageUrl: 'depression.jpg',
        createdAt: new Date('2024-01-01'),
        updatedAt: new Date('2024-01-01'),
        _count: { memberships: 45 },
        roomGroups: [mockRoomGroup],
        moderatorCommunities: [
            {
                moderator: mockModerator,
                assignedAt: new Date('2024-01-01'),
            },
        ],
        memberships: [{ role: 'member' }],
    };
    const mockCommunities = [
        {
            id: 'community-123',
            name: 'Depression Support Network',
            slug: 'depression-support',
            description: 'A supportive community for depression',
            imageUrl: 'depression.jpg',
            createdAt: new Date('2024-01-01'),
            updatedAt: new Date('2024-01-01'),
            _count: { memberships: 45 },
            memberships: [{ role: 'member' }],
        },
        {
            id: 'community-456',
            name: 'Anxiety Warriors',
            slug: 'anxiety-warriors',
            description: 'A supportive community for anxiety',
            imageUrl: 'anxiety.jpg',
            createdAt: new Date('2024-01-02'),
            updatedAt: new Date('2024-01-02'),
            _count: { memberships: 30 },
            memberships: [],
        },
        {
            id: 'community-789',
            name: 'Small Support Group',
            slug: 'small-support',
            description: 'A small intimate support group',
            imageUrl: 'small.jpg',
            createdAt: new Date('2024-01-03'),
            updatedAt: new Date('2024-01-03'),
            _count: { memberships: 8 },
            memberships: [],
        },
    ];
    const mockTrendingCommunity = {
        id: 'community-trending',
        name: 'Trending Community',
        slug: 'trending-community',
        description: 'A trending community',
        imageUrl: 'trending.jpg',
        createdAt: new Date('2024-01-01'),
        updatedAt: new Date('2024-01-01'),
        _count: { memberships: 100 },
        memberships: [
            { joinedAt: new Date('2024-01-15') }, // Recent member
            { joinedAt: new Date('2024-01-14') }, // Recent member
        ],
        roomGroups: [
            {
                rooms: [
                    {
                        posts: [
                            {
                                createdAt: new Date('2024-01-15'),
                                _count: { comments: 10, hearts: 20 },
                            },
                            {
                                createdAt: new Date('2024-01-14'),
                                _count: { comments: 5, hearts: 15 },
                            },
                        ],
                    },
                ],
            },
        ],
    };
    const mockTopContributor = {
        id: 'user-contributor',
        firstName: 'Jane',
        lastName: 'Smith',
        avatarUrl: 'jane.jpg',
        _count: { posts: 15, comments: 25 },
    };
    beforeEach(async () => {
        const mockPrismaService = {
            community: {
                findMany: jest.fn(),
                findUnique: jest.fn(),
                count: jest.fn(),
            },
            comment: {
                count: jest.fn(),
            },
            post: {
                count: jest.fn(),
            },
            membership: {
                count: jest.fn(),
                findMany: jest.fn(),
            },
            user: {
                findMany: jest.fn(),
            },
        };
        const mockEventEmitter = {
            emit: jest.fn(),
        };
        const module = await testing_1.Test.createTestingModule({
            providers: [
                enhanced_community_service_1.EnhancedCommunityService,
                {
                    provide: prisma_client_provider_1.PrismaService,
                    useValue: mockPrismaService,
                },
                {
                    provide: event_emitter_1.EventEmitter2,
                    useValue: mockEventEmitter,
                },
            ],
        }).compile();
        service = module.get(enhanced_community_service_1.EnhancedCommunityService);
        prismaService = module.get(prisma_client_provider_1.PrismaService);
        eventEmitter = module.get(event_emitter_1.EventEmitter2);
        // Setup logger spies
        loggerSpy = jest.spyOn(common_1.Logger.prototype, 'log').mockImplementation();
        jest.spyOn(common_1.Logger.prototype, 'warn').mockImplementation();
        jest.spyOn(common_1.Logger.prototype, 'error').mockImplementation();
    });
    afterEach(() => {
        jest.clearAllMocks();
    });
    it('should be defined', () => {
        expect(service).toBeDefined();
    });
    describe('searchCommunities', () => {
        beforeEach(() => {
            prismaService.community.findMany.mockResolvedValue(mockCommunities);
            prismaService.community.count.mockResolvedValue(3);
        });
        it('should search communities with text query', async () => {
            const filters = { query: 'depression' };
            const result = await service.searchCommunities(filters, 'user-123', 1, 10);
            expect(prismaService.community.findMany).toHaveBeenCalledWith({
                where: {
                    OR: [
                        { name: { contains: 'depression', mode: 'insensitive' } },
                        { description: { contains: 'depression', mode: 'insensitive' } },
                    ],
                },
                include: {
                    _count: { select: { memberships: true } },
                    memberships: {
                        where: { userId: 'user-123' },
                        select: { role: true },
                    },
                },
                skip: 0,
                take: 10,
            });
            expect(result).toEqual({
                communities: expect.arrayContaining([
                    expect.objectContaining({
                        id: 'community-123',
                        name: 'Depression Support Network',
                        membershipStatus: 'member',
                    }),
                ]),
                total: 3,
                page: 1,
                limit: 10,
                totalPages: 1,
                facets: expect.objectContaining({
                    memberRanges: expect.any(Array),
                    commonTags: expect.any(Array),
                }),
            });
        });
        it('should search communities without user context', async () => {
            const filters = { query: 'support' };
            const result = await service.searchCommunities(filters, undefined, 1, 10);
            expect(prismaService.community.findMany).toHaveBeenCalledWith({
                where: {
                    OR: [
                        { name: { contains: 'support', mode: 'insensitive' } },
                        { description: { contains: 'support', mode: 'insensitive' } },
                    ],
                },
                include: {
                    _count: { select: { memberships: true } },
                    memberships: false,
                },
                skip: 0,
                take: 10,
            });
            expect(result.communities).toHaveLength(3);
            result.communities.forEach(community => {
                expect(community.membershipStatus).toBe('none');
            });
        });
        it('should filter by description presence', async () => {
            const filters = { hasDescription: true };
            await service.searchCommunities(filters, 'user-123', 1, 10);
            expect(prismaService.community.findMany).toHaveBeenCalledWith(expect.objectContaining({
                where: expect.objectContaining({
                    description: { not: '' },
                }),
            }));
        });
        it('should filter by image presence', async () => {
            const filters = { hasImage: false };
            await service.searchCommunities(filters, 'user-123', 1, 10);
            expect(prismaService.community.findMany).toHaveBeenCalledWith(expect.objectContaining({
                where: expect.objectContaining({
                    imageUrl: '',
                }),
            }));
        });
        it('should filter by member count range', async () => {
            const filters = { minMembers: 20, maxMembers: 50 };
            const result = await service.searchCommunities(filters, 'user-123', 1, 10);
            // Should filter out communities outside range
            result.communities.forEach(community => {
                expect(community.memberCount).toBeGreaterThanOrEqual(20);
                expect(community.memberCount).toBeLessThanOrEqual(50);
            });
        });
        it('should handle pagination correctly', async () => {
            const filters = {};
            await service.searchCommunities(filters, 'user-123', 2, 5);
            expect(prismaService.community.findMany).toHaveBeenCalledWith(expect.objectContaining({
                skip: 5, // (page - 1) * limit = (2 - 1) * 5
                take: 5,
            }));
        });
        it('should sort communities by members count', async () => {
            const filters = { sortBy: 'members', sortOrder: 'desc' };
            const result = await service.searchCommunities(filters, 'user-123', 1, 10);
            // Should be sorted by member count descending
            for (let i = 1; i < result.communities.length; i++) {
                expect(result.communities[i - 1].memberCount).toBeGreaterThanOrEqual(result.communities[i].memberCount);
            }
        });
        it('should sort communities by newest first', async () => {
            const filters = { sortBy: 'newest', sortOrder: 'desc' };
            const result = await service.searchCommunities(filters, 'user-123', 1, 10);
            // Should be sorted by creation date descending
            for (let i = 1; i < result.communities.length; i++) {
                expect(result.communities[i - 1].createdAt.getTime()).toBeGreaterThanOrEqual(result.communities[i].createdAt.getTime());
            }
        });
        it('should sort communities alphabetically', async () => {
            const filters = { sortBy: 'alphabetical', sortOrder: 'asc' };
            const result = await service.searchCommunities(filters, 'user-123', 1, 10);
            // Should be sorted alphabetically
            for (let i = 1; i < result.communities.length; i++) {
                expect(result.communities[i - 1].name.localeCompare(result.communities[i].name))
                    .toBeLessThanOrEqual(0);
            }
        });
        it('should calculate total pages correctly', async () => {
            prismaService.community.count.mockResolvedValue(25);
            const result = await service.searchCommunities({}, 'user-123', 1, 10);
            expect(result.totalPages).toBe(3); // Math.ceil(25/10) = 3
        });
        it('should handle errors gracefully', async () => {
            prismaService.community.findMany.mockRejectedValue(new Error('Database error'));
            const errorSpy = jest.spyOn(common_1.Logger.prototype, 'error').mockImplementation();
            await expect(service.searchCommunities({}, 'user-123')).rejects.toThrow('Database error');
            expect(errorSpy).toHaveBeenCalledWith(expect.stringContaining('Error searching communities'), expect.any(Error));
        });
        it('should set correct membership status based on user memberships', async () => {
            const communitiesWithMemberships = [
                { ...mockCommunities[0], memberships: [{ role: 'member' }] },
                { ...mockCommunities[1], memberships: [] },
            ];
            prismaService.community.findMany.mockResolvedValue(communitiesWithMemberships);
            const result = await service.searchCommunities({}, 'user-123', 1, 10);
            expect(result.communities[0].membershipStatus).toBe('member');
            expect(result.communities[1].membershipStatus).toBe('none');
        });
    });
    describe('getCommunityDetails', () => {
        beforeEach(() => {
            prismaService.community.findUnique.mockResolvedValue(mockCommunityWithDetails);
            prismaService.comment.count.mockResolvedValue(50);
            prismaService.post.count.mockResolvedValue(10);
            prismaService.membership.count
                .mockResolvedValueOnce(5) // weekly posts
                .mockResolvedValueOnce(15) // weekly comments
                .mockResolvedValueOnce(3) // weekly members
                .mockResolvedValueOnce(25); // active members
            prismaService.user.findMany.mockResolvedValue([mockTopContributor]);
        });
        it('should get detailed community information', async () => {
            const result = await service.getCommunityDetails('community-123', 'user-123');
            expect(prismaService.community.findUnique).toHaveBeenCalledWith({
                where: { id: 'community-123' },
                include: expect.objectContaining({
                    _count: { select: { memberships: true } },
                    roomGroups: expect.any(Object),
                    moderatorCommunities: expect.any(Object),
                    memberships: expect.any(Object),
                }),
            });
            expect(result).toEqual({
                id: 'community-123',
                name: 'Depression Support Network',
                slug: 'depression-support',
                description: 'A supportive community for depression',
                imageUrl: 'depression.jpg',
                createdAt: expect.any(Date),
                updatedAt: expect.any(Date),
                memberCount: 45,
                stats: expect.objectContaining({
                    totalPosts: 2,
                    totalComments: 50,
                    activeMembers: 25,
                    recentActivity: expect.objectContaining({
                        postsThisWeek: 10,
                        commentsThisWeek: 15,
                        newMembersThisWeek: 3,
                    }),
                }),
                recentPosts: expect.arrayContaining([
                    expect.objectContaining({
                        id: 'post-456',
                        title: 'Another Post',
                        author: expect.objectContaining({
                            firstName: 'John',
                            lastName: 'Doe',
                        }),
                    }),
                ]),
                topContributors: expect.any(Array),
                moderators: expect.arrayContaining([
                    expect.objectContaining({
                        firstName: 'John',
                        lastName: 'Doe',
                    }),
                ]),
                membershipStatus: 'member',
                userPermissions: expect.objectContaining({
                    canPost: true,
                    canComment: true,
                    canModerate: false,
                }),
            });
        });
        it('should handle community not found', async () => {
            prismaService.community.findUnique.mockResolvedValue(null);
            await expect(service.getCommunityDetails('non-existent')).rejects.toThrow(new common_1.NotFoundException('Community non-existent not found'));
        });
        it('should calculate user permissions for moderator', async () => {
            const moderatorCommunity = {
                ...mockCommunityWithDetails,
                memberships: [{ role: 'moderator' }],
            };
            prismaService.community.findUnique.mockResolvedValue(moderatorCommunity);
            const result = await service.getCommunityDetails('community-123', 'user-123');
            expect(result.userPermissions).toEqual({
                canPost: true,
                canComment: true,
                canModerate: true,
            });
        });
        it('should handle user without membership', async () => {
            const communityWithoutUserMembership = {
                ...mockCommunityWithDetails,
                memberships: [],
            };
            prismaService.community.findUnique.mockResolvedValue(communityWithoutUserMembership);
            const result = await service.getCommunityDetails('community-123', 'user-123');
            expect(result.membershipStatus).toBe('none');
            expect(result.userPermissions).toEqual({
                canPost: false,
                canComment: false,
                canModerate: false,
            });
        });
        it('should handle missing user context', async () => {
            const result = await service.getCommunityDetails('community-123');
            expect(result.membershipStatus).toBe('none');
            expect(result.userPermissions).toEqual({
                canPost: false,
                canComment: false,
                canModerate: false,
            });
        });
        it('should sort recent posts by creation date', async () => {
            const result = await service.getCommunityDetails('community-123', 'user-123');
            // Should be sorted newest first
            for (let i = 1; i < result.recentPosts.length; i++) {
                expect(result.recentPosts[i - 1].createdAt.getTime()).toBeGreaterThanOrEqual(result.recentPosts[i].createdAt.getTime());
            }
        });
        it('should handle posts with missing user data', async () => {
            const communityWithAnonymousPost = {
                ...mockCommunityWithDetails,
                roomGroups: [{
                        ...mockRoomGroup,
                        rooms: [{
                                ...mockRoom,
                                posts: [{
                                        id: 'post-anonymous',
                                        title: 'Anonymous Post',
                                        content: 'Post without user',
                                        createdAt: new Date('2024-01-10'),
                                        user: null,
                                        _count: { comments: 0, hearts: 0 },
                                    }],
                            }],
                    }],
            };
            prismaService.community.findUnique.mockResolvedValue(communityWithAnonymousPost);
            const result = await service.getCommunityDetails('community-123', 'user-123');
            const anonymousPost = result.recentPosts.find(p => p.id === 'post-anonymous');
            expect(anonymousPost?.author).toEqual({
                id: 'unknown',
                firstName: 'Unknown',
                lastName: 'User',
                avatarUrl: undefined,
            });
        });
        it('should handle errors gracefully', async () => {
            prismaService.community.findUnique.mockRejectedValue(new Error('Database error'));
            const errorSpy = jest.spyOn(common_1.Logger.prototype, 'error').mockImplementation();
            await expect(service.getCommunityDetails('community-123')).rejects.toThrow('Database error');
            expect(errorSpy).toHaveBeenCalledWith(expect.stringContaining('Error getting community details for community-123'), expect.any(Error));
        });
    });
    describe('getTrendingCommunities', () => {
        beforeEach(() => {
            prismaService.community.findMany.mockResolvedValue([mockTrendingCommunity]);
            prismaService.membership.count.mockResolvedValue(5); // Previous period members
        });
        it('should get trending communities with default parameters', async () => {
            const result = await service.getTrendingCommunities();
            expect(prismaService.community.findMany).toHaveBeenCalledWith({
                include: expect.objectContaining({
                    _count: { select: { memberships: true } },
                    memberships: expect.objectContaining({
                        where: expect.objectContaining({
                            joinedAt: { gte: expect.any(Date) },
                        }),
                    }),
                    roomGroups: expect.any(Object),
                }),
            });
            expect(result).toBeInstanceOf(Array);
            expect(result.length).toBeLessThanOrEqual(10);
            if (result.length > 0) {
                expect(result[0]).toHaveProperty('trendingData');
                expect(result[0].trendingData).toHaveProperty('growthRate');
                expect(result[0].trendingData).toHaveProperty('activityScore');
                expect(result[0].trendingData).toHaveProperty('engagementRate');
                expect(result[0].trendingData).toHaveProperty('retentionRate');
            }
        });
        it('should get trending communities for month timeframe', async () => {
            await service.getTrendingCommunities(5, 'month');
            expect(prismaService.community.findMany).toHaveBeenCalledWith({
                include: expect.objectContaining({
                    memberships: expect.objectContaining({
                        where: expect.objectContaining({
                            joinedAt: { gte: expect.any(Date) },
                        }),
                    }),
                }),
            });
        });
        it('should limit results to specified limit', async () => {
            const result = await service.getTrendingCommunities(3);
            expect(result.length).toBeLessThanOrEqual(3);
        });
        it('should sort by trending score', async () => {
            // Mock multiple communities with different trending metrics
            const multipleTrendingCommunities = [
                { ...mockTrendingCommunity, id: 'trending-1' },
                { ...mockTrendingCommunity, id: 'trending-2' },
                { ...mockTrendingCommunity, id: 'trending-3' },
            ];
            prismaService.community.findMany.mockResolvedValue(multipleTrendingCommunities);
            const result = await service.getTrendingCommunities();
            // Should be sorted by trending score (combination of metrics)
            for (let i = 1; i < result.length; i++) {
                const scoreA = result[i - 1].trendingData.growthRate * 0.4 +
                    result[i - 1].trendingData.activityScore * 0.4 +
                    result[i - 1].trendingData.engagementRate * 0.2;
                const scoreB = result[i].trendingData.growthRate * 0.4 +
                    result[i].trendingData.activityScore * 0.4 +
                    result[i].trendingData.engagementRate * 0.2;
                expect(scoreA).toBeGreaterThanOrEqual(scoreB);
            }
        });
        it('should handle errors gracefully', async () => {
            prismaService.community.findMany.mockRejectedValue(new Error('Database error'));
            const errorSpy = jest.spyOn(common_1.Logger.prototype, 'error').mockImplementation();
            await expect(service.getTrendingCommunities()).rejects.toThrow('Database error');
            expect(errorSpy).toHaveBeenCalledWith(expect.stringContaining('Error getting trending communities'), expect.any(Error));
        });
        it('should calculate growth rate correctly', async () => {
            const calculateTrendingData = service.calculateTrendingData.bind(service);
            const community = {
                id: 'test-community',
                memberships: [{ joinedAt: new Date() }], // 1 new member
                _count: { memberships: 10 }, // Total 10 members
                posts: [],
            };
            const startDate = new Date('2024-01-15');
            const previousStartDate = new Date('2024-01-08');
            // Mock 5 previous members
            prismaService.membership.count.mockResolvedValue(5);
            const result = await calculateTrendingData(community, startDate, previousStartDate);
            // Growth rate = ((1 - 5) / 5) * 100 = -80% (but should be >= 0)
            expect(result.growthRate).toBeGreaterThanOrEqual(0);
        });
        it('should handle zero previous members', async () => {
            const calculateTrendingData = service.calculateTrendingData.bind(service);
            const community = {
                id: 'test-community',
                memberships: [{ joinedAt: new Date() }], // 1 new member
                _count: { memberships: 1 },
                posts: [],
            };
            // Mock 0 previous members
            prismaService.membership.count.mockResolvedValue(0);
            const result = await calculateTrendingData(community, new Date('2024-01-15'), new Date('2024-01-08'));
            expect(result.growthRate).toBe(100); // 100% growth when starting from 0
        });
    });
    describe('getSimilarCommunities', () => {
        const mockRefCommunity = {
            id: 'ref-community',
            memberships: [
                {
                    user: {
                        memberships: [
                            { communityId: 'similar-1', community: { id: 'similar-1' } },
                            { communityId: 'similar-2', community: { id: 'similar-2' } },
                        ],
                    },
                },
                {
                    user: {
                        memberships: [
                            { communityId: 'similar-1', community: { id: 'similar-1' } },
                            { communityId: 'similar-3', community: { id: 'similar-3' } },
                        ],
                    },
                },
            ],
        };
        const mockSimilarCommunities = [
            {
                id: 'similar-1',
                name: 'Similar Community 1',
                slug: 'similar-1',
                description: 'Similar community',
                imageUrl: 'similar1.jpg',
                createdAt: new Date('2024-01-01'),
                _count: { memberships: 20 },
                roomGroups: [{ rooms: [{ _count: { posts: 5 } }] }],
            },
            {
                id: 'similar-2',
                name: 'Similar Community 2',
                slug: 'similar-2',
                description: 'Another similar community',
                imageUrl: 'similar2.jpg',
                createdAt: new Date('2024-01-02'),
                _count: { memberships: 15 },
                roomGroups: [{ rooms: [{ _count: { posts: 3 } }] }],
            },
        ];
        beforeEach(() => {
            prismaService.community.findUnique
                .mockResolvedValueOnce(mockRefCommunity)
                .mockResolvedValue(null);
            prismaService.community.findMany.mockResolvedValue(mockSimilarCommunities);
            prismaService.membership.findMany.mockResolvedValue([]);
        });
        it('should find similar communities based on member overlap', async () => {
            const context = { userId: 'user-123', maxResults: 5 };
            const result = await service.getSimilarCommunities('ref-community', context);
            expect(prismaService.community.findUnique).toHaveBeenCalledWith({
                where: { id: 'ref-community' },
                include: expect.objectContaining({
                    memberships: expect.any(Object),
                }),
            });
            expect(result).toBeInstanceOf(Array);
            expect(result.length).toBeLessThanOrEqual(5);
            if (result.length > 0) {
                expect(result[0]).toHaveProperty('id');
                expect(result[0]).toHaveProperty('name');
                expect(result[0]).toHaveProperty('membershipStatus');
                expect(result[0].membershipStatus).toBe('none');
            }
        });
        it('should exclude user joined communities when excludeJoined is true', async () => {
            const userMemberships = [{ communityId: 'similar-1' }];
            prismaService.membership.findMany.mockResolvedValue(userMemberships);
            const context = { userId: 'user-123', excludeJoined: true, maxResults: 5 };
            const result = await service.getSimilarCommunities('ref-community', context);
            expect(prismaService.membership.findMany).toHaveBeenCalledWith({
                where: { userId: 'user-123' },
                select: { communityId: true },
            });
            // Should exclude similar-1 since user is already a member
            const excludedCommunity = result.find(c => c.id === 'similar-1');
            expect(excludedCommunity).toBeUndefined();
        });
        it('should include user joined communities when excludeJoined is false', async () => {
            const context = { userId: 'user-123', excludeJoined: false, maxResults: 5 };
            await service.getSimilarCommunities('ref-community', context);
            expect(prismaService.membership.findMany).not.toHaveBeenCalled();
        });
        it('should throw NotFoundException for non-existent reference community', async () => {
            prismaService.community.findUnique.mockResolvedValueOnce(null);
            const context = { userId: 'user-123' };
            await expect(service.getSimilarCommunities('non-existent', context)).rejects.toThrow(new common_1.NotFoundException('Community non-existent not found'));
        });
        it('should handle communities without members', async () => {
            const emptyRefCommunity = { id: 'ref-community', memberships: [] };
            prismaService.community.findUnique.mockResolvedValueOnce(emptyRefCommunity);
            const context = { userId: 'user-123' };
            const result = await service.getSimilarCommunities('ref-community', context);
            expect(result).toEqual([]);
        });
        it('should limit results to maxResults', async () => {
            const context = { userId: 'user-123', maxResults: 1 };
            const result = await service.getSimilarCommunities('ref-community', context);
            expect(result.length).toBeLessThanOrEqual(1);
        });
        it('should handle errors gracefully', async () => {
            prismaService.community.findUnique.mockRejectedValue(new Error('Database error'));
            const errorSpy = jest.spyOn(common_1.Logger.prototype, 'error').mockImplementation();
            const context = { userId: 'user-123' };
            await expect(service.getSimilarCommunities('ref-community', context)).rejects.toThrow('Database error');
            expect(errorSpy).toHaveBeenCalledWith(expect.stringContaining('Error getting similar communities for ref-community'), expect.any(Error));
        });
    });
    describe('applySorting', () => {
        const sampleCommunities = [
            {
                id: '1',
                name: 'Beta Community',
                memberCount: 10,
                recentActivity: { postCount: 5, commentCount: 10, lastActivityAt: null },
                createdAt: new Date('2024-01-02'),
            },
            {
                id: '2',
                name: 'Alpha Community',
                memberCount: 20,
                recentActivity: { postCount: 3, commentCount: 7, lastActivityAt: null },
                createdAt: new Date('2024-01-01'),
            },
        ];
        it('should sort by members descending', () => {
            const applySorting = service.applySorting.bind(service);
            const communities = [...sampleCommunities];
            applySorting(communities, 'members', 'desc');
            expect(communities[0].memberCount).toBe(20);
            expect(communities[1].memberCount).toBe(10);
        });
        it('should sort by members ascending', () => {
            const applySorting = service.applySorting.bind(service);
            const communities = [...sampleCommunities];
            applySorting(communities, 'members', 'asc');
            expect(communities[0].memberCount).toBe(10);
            expect(communities[1].memberCount).toBe(20);
        });
        it('should sort by activity', () => {
            const applySorting = service.applySorting.bind(service);
            const communities = [...sampleCommunities];
            applySorting(communities, 'activity', 'desc');
            // Community 1: 5 + 10 = 15, Community 2: 3 + 7 = 10
            expect(communities[0].id).toBe('1');
            expect(communities[1].id).toBe('2');
        });
        it('should sort by newest', () => {
            const applySorting = service.applySorting.bind(service);
            const communities = [...sampleCommunities];
            applySorting(communities, 'newest', 'desc');
            expect(communities[0].createdAt.getTime()).toBe(new Date('2024-01-02').getTime());
            expect(communities[1].createdAt.getTime()).toBe(new Date('2024-01-01').getTime());
        });
        it('should sort alphabetically', () => {
            const applySorting = service.applySorting.bind(service);
            const communities = [...sampleCommunities];
            applySorting(communities, 'alphabetical', 'asc');
            expect(communities[0].name).toBe('Alpha Community');
            expect(communities[1].name).toBe('Beta Community');
        });
        it('should default to relevance sorting (member count)', () => {
            const applySorting = service.applySorting.bind(service);
            const communities = [...sampleCommunities];
            applySorting(communities, 'relevance', 'desc');
            expect(communities[0].memberCount).toBe(20);
            expect(communities[1].memberCount).toBe(10);
        });
    });
    describe('calculateSearchFacets', () => {
        beforeEach(() => {
            prismaService.community.count
                .mockResolvedValueOnce(5) // 1-10 range
                .mockResolvedValueOnce(3) // 11-50 range
                .mockResolvedValueOnce(2) // 51-100 range
                .mockResolvedValueOnce(1) // 101-500 range
                .mockResolvedValueOnce(0); // 500+ range
        });
        it('should calculate member range facets', async () => {
            const calculateSearchFacets = service.calculateSearchFacets.bind(service);
            const result = await calculateSearchFacets({});
            expect(result).toEqual({
                memberRanges: [
                    { range: '1-10', count: 5 },
                    { range: '11-50', count: 3 },
                    { range: '51-100', count: 2 },
                    { range: '101-500', count: 1 },
                    { range: '500+', count: 0 },
                ],
                commonTags: [],
            });
        });
        it('should handle errors gracefully', async () => {
            prismaService.community.count.mockRejectedValue(new Error('Database error'));
            const calculateSearchFacets = service.calculateSearchFacets.bind(service);
            const errorSpy = jest.spyOn(common_1.Logger.prototype, 'error').mockImplementation();
            const result = await calculateSearchFacets({});
            expect(result).toEqual({
                memberRanges: [],
                commonTags: [],
            });
            expect(errorSpy).toHaveBeenCalledWith('Error calculating search facets:', expect.any(Error));
        });
    });
    describe('getTopContributors', () => {
        beforeEach(() => {
            const mockCommunityForContributors = {
                id: 'community-123',
                roomGroups: [
                    { rooms: [{ id: 'room-1' }, { id: 'room-2' }] },
                ],
            };
            prismaService.community.findUnique.mockResolvedValue(mockCommunityForContributors);
            prismaService.user.findMany.mockResolvedValue([
                {
                    id: 'user-1',
                    firstName: 'Top',
                    lastName: 'Contributor',
                    avatarUrl: 'top.jpg',
                    _count: { posts: 10, comments: 20 },
                },
                {
                    id: 'user-2',
                    firstName: 'Second',
                    lastName: 'Contributor',
                    avatarUrl: 'second.jpg',
                    _count: { posts: 5, comments: 15 },
                },
            ]);
        });
        it('should get top contributors for community', async () => {
            const getTopContributors = service.getTopContributors.bind(service);
            const result = await getTopContributors('community-123', 5);
            expect(prismaService.community.findUnique).toHaveBeenCalledWith({
                where: { id: 'community-123' },
                include: {
                    roomGroups: {
                        include: {
                            rooms: { select: { id: true } },
                        },
                    },
                },
            });
            expect(result).toEqual([
                {
                    id: 'user-1',
                    firstName: 'Top',
                    lastName: 'Contributor',
                    avatarUrl: 'top.jpg',
                    contributionScore: 50, // 10 * 3 + 20 * 1
                    postCount: 10,
                    commentCount: 20,
                },
                {
                    id: 'user-2',
                    firstName: 'Second',
                    lastName: 'Contributor',
                    avatarUrl: 'second.jpg',
                    contributionScore: 30, // 5 * 3 + 15 * 1
                    postCount: 5,
                    commentCount: 15,
                },
            ]);
        });
        it('should return empty array for non-existent community', async () => {
            prismaService.community.findUnique.mockResolvedValue(null);
            const getTopContributors = service.getTopContributors.bind(service);
            const result = await getTopContributors('non-existent', 5);
            expect(result).toEqual([]);
        });
        it('should filter out contributors with zero contributions', async () => {
            prismaService.user.findMany.mockResolvedValue([
                {
                    id: 'user-active',
                    firstName: 'Active',
                    lastName: 'User',
                    avatarUrl: 'active.jpg',
                    _count: { posts: 5, comments: 10 },
                },
                {
                    id: 'user-inactive',
                    firstName: 'Inactive',
                    lastName: 'User',
                    avatarUrl: 'inactive.jpg',
                    _count: { posts: 0, comments: 0 },
                },
            ]);
            const getTopContributors = service.getTopContributors.bind(service);
            const result = await getTopContributors('community-123', 5);
            expect(result).toHaveLength(1);
            expect(result[0].id).toBe('user-active');
        });
        it('should handle errors gracefully', async () => {
            prismaService.community.findUnique.mockRejectedValue(new Error('Database error'));
            const getTopContributors = service.getTopContributors.bind(service);
            const errorSpy = jest.spyOn(common_1.Logger.prototype, 'error').mockImplementation();
            const result = await getTopContributors('community-123', 5);
            expect(result).toEqual([]);
            expect(errorSpy).toHaveBeenCalledWith(expect.stringContaining('Error getting top contributors for community community-123'), expect.any(Error));
        });
        it('should limit results to specified limit', async () => {
            const getTopContributors = service.getTopContributors.bind(service);
            const result = await getTopContributors('community-123', 1);
            expect(result).toHaveLength(1);
        });
        it('should handle missing avatarUrl', async () => {
            prismaService.user.findMany.mockResolvedValue([
                {
                    id: 'user-no-avatar',
                    firstName: 'No',
                    lastName: 'Avatar',
                    avatarUrl: null,
                    _count: { posts: 5, comments: 10 },
                },
            ]);
            const getTopContributors = service.getTopContributors.bind(service);
            const result = await getTopContributors('community-123', 5);
            expect(result[0].avatarUrl).toBeUndefined();
        });
    });
    describe('edge cases and performance', () => {
        it('should handle very large search results efficiently', async () => {
            const largeCommunityList = Array.from({ length: 1000 }, (_, i) => ({
                id: `community-${i}`,
                name: `Community ${i}`,
                slug: `community-${i}`,
                description: `Description ${i}`,
                imageUrl: `image-${i}.jpg`,
                createdAt: new Date('2024-01-01'),
                updatedAt: new Date('2024-01-01'),
                _count: { memberships: i % 100 },
                memberships: [],
            }));
            prismaService.community.findMany.mockResolvedValue(largeCommunityList);
            prismaService.community.count.mockResolvedValue(1000);
            const startTime = Date.now();
            const result = await service.searchCommunities({}, 'user-123', 1, 20);
            const endTime = Date.now();
            expect(result.communities).toHaveLength(20);
            expect(endTime - startTime).toBeLessThan(2000); // Should complete within 2 seconds
        });
        it('should handle missing data gracefully', async () => {
            const communityWithMissingData = {
                id: 'community-missing',
                name: null,
                slug: 'missing-data',
                description: '',
                imageUrl: null,
                createdAt: new Date('2024-01-01'),
                updatedAt: new Date('2024-01-01'),
                _count: { memberships: 0 },
                memberships: [],
            };
            prismaService.community.findMany.mockResolvedValue([communityWithMissingData]);
            prismaService.community.count.mockResolvedValue(1);
            const result = await service.searchCommunities({}, 'user-123', 1, 10);
            expect(result.communities).toHaveLength(1);
            expect(result.communities[0].name).toBeNull();
            expect(result.communities[0].imageUrl).toBeNull();
        });
        it('should handle concurrent requests', async () => {
            prismaService.community.findMany.mockResolvedValue(mockCommunities);
            prismaService.community.count.mockResolvedValue(3);
            const promises = [
                service.searchCommunities({}, 'user-1'),
                service.searchCommunities({}, 'user-2'),
                service.searchCommunities({}, 'user-3'),
            ];
            const results = await Promise.all(promises);
            expect(results).toHaveLength(3);
            results.forEach(result => {
                expect(result.communities).toBeInstanceOf(Array);
            });
        });
        it('should handle malformed filter objects', async () => {
            const malformedFilters = {
                query: null,
                minMembers: 'invalid',
                maxMembers: {},
                sortBy: [],
            };
            prismaService.community.findMany.mockResolvedValue(mockCommunities);
            prismaService.community.count.mockResolvedValue(3);
            // Should not throw error
            const result = await service.searchCommunities(malformedFilters, 'user-123');
            expect(result).toBeDefined();
            expect(result.communities).toBeInstanceOf(Array);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL2NvbW11bml0aWVzL3NlcnZpY2VzL2VuaGFuY2VkLWNvbW11bml0eS5zZXJ2aWNlLnNwZWMudHMiLCJtYXBwaW5ncyI6Ijs7QUFBQSw2Q0FBc0Q7QUFDdEQsMkNBQTJEO0FBQzNELHlEQUFzRDtBQUN0RCw2RUFBd0U7QUFDeEUsbUZBQXVFO0FBRXZFLFFBQVEsQ0FBQywwQkFBMEIsRUFBRSxHQUFHLEVBQUU7SUFDeEMsSUFBSSxPQUFpQyxDQUFDO0lBQ3RDLElBQUksYUFBeUMsQ0FBQztJQUM5QyxJQUFJLFlBQXdDLENBQUM7SUFDN0MsSUFBSSxTQUEyQixDQUFDO0lBRWhDLFlBQVk7SUFDWixNQUFNLFFBQVEsR0FBRztRQUNmLEVBQUUsRUFBRSxVQUFVO1FBQ2QsU0FBUyxFQUFFLE1BQU07UUFDakIsUUFBUSxFQUFFLEtBQUs7UUFDZixTQUFTLEVBQUUsWUFBWTtRQUN2QixTQUFTLEVBQUUsSUFBSSxJQUFJLENBQUMsWUFBWSxDQUFDO0tBQ2xDLENBQUM7SUFFRixNQUFNLGFBQWEsR0FBRztRQUNwQixJQUFJLEVBQUUsUUFBUTtLQUNmLENBQUM7SUFFRixNQUFNLFFBQVEsR0FBRztRQUNmLEVBQUUsRUFBRSxVQUFVO1FBQ2QsSUFBSSxFQUFFLG9CQUFvQjtRQUMxQixLQUFLLEVBQUUsQ0FBQztRQUNSLFdBQVcsRUFBRSxRQUFRO1FBQ3JCLFdBQVcsRUFBRSxlQUFlO1FBQzVCLEtBQUssRUFBRTtZQUNMO2dCQUNFLEVBQUUsRUFBRSxVQUFVO2dCQUNkLEtBQUssRUFBRSxXQUFXO2dCQUNsQixPQUFPLEVBQUUscUJBQXFCO2dCQUM5QixTQUFTLEVBQUUsSUFBSSxJQUFJLENBQUMsWUFBWSxDQUFDO2dCQUNqQyxJQUFJLEVBQUUsUUFBUTtnQkFDZCxNQUFNLEVBQUUsRUFBRSxRQUFRLEVBQUUsQ0FBQyxFQUFFLE1BQU0sRUFBRSxFQUFFLEVBQUU7YUFDcEM7WUFDRDtnQkFDRSxF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QyxFQUFFO2dCQUN2QixNQUFNLENBQUMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxDQUFDLGNBQWMsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUNuRCxDQUFDLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHdDQUF3QyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3RELE1BQU0sZ0JBQWdCLEdBQUc7Z0JBQ3ZCLEtBQUssRUFBRSxJQUFJO2dCQUNYLFVBQVUsRUFBRSxTQUFTO2dCQUNyQixVQUFVLEVBQUUsRUFBRTtnQkFDZCxNQUFNLEVBQUUsRUFBRTthQUNKLENBQUM7WUFFVCxhQUFhLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxpQkFBaUIsQ0FBQyxlQUFlLENBQUMsQ0FBQztZQUNwRSxhQUFhLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUVuRCx5QkFBeUI7WUFDekIsTUFBTSxNQUFNLEdBQUcsTUFBTSxPQUFPLENBQUMsaUJBQWlCLENBQUMsZ0JBQWdCLEVBQUUsVUFBVSxDQUFDLENBQUM7WUFFN0UsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQzdCLE1BQU0sQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUMsY0FBYyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ25ELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS93ZXRvb2EvRG9jdW1lbnRzL2NvZGUvcHJvamVjdHMvbWVudGFyYS9tZW50YXJhLWFwaS9zcmMvY29tbXVuaXRpZXMvc2VydmljZXMvZW5oYW5jZWQtY29tbXVuaXR5LnNlcnZpY2Uuc3BlYy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUZXN0LCBUZXN0aW5nTW9kdWxlIH0gZnJvbSAnQG5lc3Rqcy90ZXN0aW5nJztcbmltcG9ydCB7IExvZ2dlciwgTm90Rm91bmRFeGNlcHRpb24gfSBmcm9tICdAbmVzdGpzL2NvbW1vbic7XG5pbXBvcnQgeyBFdmVudEVtaXR0ZXIyIH0gZnJvbSAnQG5lc3Rqcy9ldmVudC1lbWl0dGVyJztcbmltcG9ydCB7IEVuaGFuY2VkQ29tbXVuaXR5U2VydmljZSB9IGZyb20gJy4vZW5oYW5jZWQtY29tbXVuaXR5LnNlcnZpY2UnO1xuaW1wb3J0IHsgUHJpc21hU2VydmljZSB9IGZyb20gJy4uLy4uL3Byb3ZpZGVycy9wcmlzbWEtY2xpZW50LnByb3ZpZGVyJztcblxuZGVzY3JpYmUoJ0VuaGFuY2VkQ29tbXVuaXR5U2VydmljZScsICgpID0+IHtcbiAgbGV0IHNlcnZpY2U6IEVuaGFuY2VkQ29tbXVuaXR5U2VydmljZTtcbiAgbGV0IHByaXNtYVNlcnZpY2U6IGplc3QuTW9ja2VkPFByaXNtYVNlcnZpY2U+O1xuICBsZXQgZXZlbnRFbWl0dGVyOiBqZXN0Lk1vY2tlZDxFdmVudEVtaXR0ZXIyPjtcbiAgbGV0IGxvZ2dlclNweTogamVzdC5TcHlJbnN0YW5jZTtcblxuICAvLyBNb2NrIGRhdGFcbiAgY29uc3QgbW9ja1VzZXIgPSB7XG4gICAgaWQ6ICd1c2VyLTEyMycsXG4gICAgZmlyc3ROYW1lOiAnSm9obicsXG4gICAgbGFzdE5hbWU6ICdEb2UnLFxuICAgIGF2YXRhclVybDogJ2F2YXRhci5qcGcnLFxuICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoJzIwMjQtMDEtMTUnKSxcbiAgfTtcblxuICBjb25zdCBtb2NrTW9kZXJhdG9yID0ge1xuICAgIHVzZXI6IG1vY2tVc2VyLFxuICB9O1xuXG4gIGNvbnN0IG1vY2tSb29tID0ge1xuICAgIGlkOiAncm9vbS0xMjMnLFxuICAgIG5hbWU6ICdHZW5lcmFsIERpc2N1c3Npb24nLFxuICAgIG9yZGVyOiAxLFxuICAgIHBvc3RpbmdSb2xlOiAnbWVtYmVyJyxcbiAgICByb29tR3JvdXBJZDogJ3Jvb21ncm91cC0xMjMnLFxuICAgIHBvc3RzOiBbXG4gICAgICB7XG4gICAgICAgIGlkOiAncG9zdC0xMjMnLFxuICAgICAgICB0aXRsZTogJ1Rlc3QgUG9zdCcsXG4gICAgICAgIGNvbnRlbnQ6ICdUaGlzIGlzIGEgdGVzdCBwb3N0JyxcbiAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgnMjAyNC0wMS0xMCcpLFxuICAgICAgICB1c2VyOiBtb2NrVXNlcixcbiAgICAgICAgX2NvdW50OiB7IGNvbW1lbnRzOiA1LCBoZWFydHM6IDEwIH0sXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBpZDogJ3Bvc3QtNDU2JyxcbiAgICAgICAgdGl0bGU6ICdBbm90aGVyIFBvc3QnLFxuICAgICAgICBjb250ZW50OiAnQW5vdGhlciB0ZXN0IHBvc3QnLFxuICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCcyMDI0LTAxLTEyJyksXG4gICAgICAgIHVzZXI6IG1vY2tVc2VyLFxuICAgICAgICBfY291bnQ6IHsgY29tbWVudHM6IDMsIGhlYXJ0czogNyB9LFxuICAgICAgfSxcbiAgICBdLFxuICAgIF9jb3VudDogeyBwb3N0czogMiB9LFxuICB9O1xuXG4gIGNvbnN0IG1vY2tSb29tR3JvdXAgPSB7XG4gICAgaWQ6ICdyb29tZ3JvdXAtMTIzJyxcbiAgICBuYW1lOiAnR2VuZXJhbCcsXG4gICAgb3JkZXI6IDEsXG4gICAgY29tbXVuaXR5SWQ6ICdjb21tdW5pdHktMTIzJyxcbiAgICByb29tczogW21vY2tSb29tXSxcbiAgfTtcblxuICBjb25zdCBtb2NrQ29tbXVuaXR5V2l0aERldGFpbHMgPSB7XG4gICAgaWQ6ICdjb21tdW5pdHktMTIzJyxcbiAgICBuYW1lOiAnRGVwcmVzc2lvbiBTdXBwb3J0IE5ldHdvcmsnLFxuICAgIHNsdWc6ICdkZXByZXNzaW9uLXN1cHBvcnQnLFxuICAgIGRlc2NyaXB0aW9uOiAnQSBzdXBwb3J0aXZlIGNvbW11bml0eSBmb3IgZGVwcmVzc2lvbicsXG4gICAgaW1hZ2VVcmw6ICdkZXByZXNzaW9uLmpwZycsXG4gICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgnMjAyNC0wMS0wMScpLFxuICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoJzIwMjQtMDEtMDEnKSxcbiAgICBfY291bnQ6IHsgbWVtYmVyc2hpcHM6IDQ1IH0sXG4gICAgcm9vbUdyb3VwczogW21vY2tSb29tR3JvdXBdLFxuICAgIG1vZGVyYXRvckNvbW11bml0aWVzOiBbXG4gICAgICB7XG4gICAgICAgIG1vZGVyYXRvcjogbW9ja01vZGVyYXRvcixcbiAgICAgICAgYXNzaWduZWRBdDogbmV3IERhdGUoJzIwMjQtMDEtMDEnKSxcbiAgICAgIH0sXG4gICAgXSxcbiAgICBtZW1iZXJzaGlwczogW3sgcm9sZTogJ21lbWJlcicgfV0sXG4gIH07XG5cbiAgY29uc3QgbW9ja0NvbW11bml0aWVzID0gW1xuICAgIHtcbiAgICAgIGlkOiAnY29tbXVuaXR5LTEyMycsXG4gICAgICBuYW1lOiAnRGVwcmVzc2lvbiBTdXBwb3J0IE5ldHdvcmsnLFxuICAgICAgc2x1ZzogJ2RlcHJlc3Npb24tc3VwcG9ydCcsXG4gICAgICBkZXNjcmlwdGlvbjogJ0Egc3VwcG9ydGl2ZSBjb21tdW5pdHkgZm9yIGRlcHJlc3Npb24nLFxuICAgICAgaW1hZ2VVcmw6ICdkZXByZXNzaW9uLmpwZycsXG4gICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCcyMDI0LTAxLTAxJyksXG4gICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCcyMDI0LTAxLTAxJyksXG4gICAgICBfY291bnQ6IHsgbWVtYmVyc2hpcHM6IDQ1IH0sXG4gICAgICBtZW1iZXJzaGlwczogW3sgcm9sZTogJ21lbWJlcicgfV0sXG4gICAgfSxcbiAgICB7XG4gICAgICBpZDogJ2NvbW11bml0eS00NTYnLFxuICAgICAgbmFtZTogJ0FueGlldHkgV2FycmlvcnMnLFxuICAgICAgc2x1ZzogJ2FueGlldHktd2FycmlvcnMnLFxuICAgICAgZGVzY3JpcHRpb246ICdBIHN1cHBvcnRpdmUgY29tbXVuaXR5IGZvciBhbnhpZXR5JyxcbiAgICAgIGltYWdlVXJsOiAnYW54aWV0eS5qcGcnLFxuICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgnMjAyNC0wMS0wMicpLFxuICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgnMjAyNC0wMS0wMicpLFxuICAgICAgX2NvdW50OiB7IG1lbWJlcnNoaXBzOiAzMCB9LFxuICAgICAgbWVtYmVyc2hpcHM6IFtdLFxuICAgIH0sXG4gICAge1xuICAgICAgaWQ6ICdjb21tdW5pdHktNzg5JyxcbiAgICAgIG5hbWU6ICdTbWFsbCBTdXBwb3J0IEdyb3VwJyxcbiAgICAgIHNsdWc6ICdzbWFsbC1zdXBwb3J0JyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnQSBzbWFsbCBpbnRpbWF0ZSBzdXBwb3J0IGdyb3VwJyxcbiAgICAgIGltYWdlVXJsOiAnc21hbGwuanBnJyxcbiAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoJzIwMjQtMDEtMDMnKSxcbiAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoJzIwMjQtMDEtMDMnKSxcbiAgICAgIF9jb3VudDogeyBtZW1iZXJzaGlwczogOCB9LFxuICAgICAgbWVtYmVyc2hpcHM6IFtdLFxuICAgIH0sXG4gIF07XG5cbiAgY29uc3QgbW9ja1RyZW5kaW5nQ29tbXVuaXR5ID0ge1xuICAgIGlkOiAnY29tbXVuaXR5LXRyZW5kaW5nJyxcbiAgICBuYW1lOiAnVHJlbmRpbmcgQ29tbXVuaXR5JyxcbiAgICBzbHVnOiAndHJlbmRpbmctY29tbXVuaXR5JyxcbiAgICBkZXNjcmlwdGlvbjogJ0EgdHJlbmRpbmcgY29tbXVuaXR5JyxcbiAgICBpbWFnZVVybDogJ3RyZW5kaW5nLmpwZycsXG4gICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgnMjAyNC0wMS0wMScpLFxuICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoJzIwMjQtMDEtMDEnKSxcbiAgICBfY291bnQ6IHsgbWVtYmVyc2hpcHM6IDEwMCB9LFxuICAgIG1lbWJlcnNoaXBzOiBbXG4gICAgICB7IGpvaW5lZEF0OiBuZXcgRGF0ZSgnMjAyNC0wMS0xNScpIH0sIC8vIFJlY2VudCBtZW1iZXJcbiAgICAgIHsgam9pbmVkQXQ6IG5ldyBEYXRlKCcyMDI0LTAxLTE0JykgfSwgLy8gUmVjZW50IG1lbWJlclxuICAgIF0sXG4gICAgcm9vbUdyb3VwczogW1xuICAgICAge1xuICAgICAgICByb29tczogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIHBvc3RzOiBbXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCcyMDI0LTAxLTE1JyksXG4gICAgICAgICAgICAgICAgX2NvdW50OiB7IGNvbW1lbnRzOiAxMCwgaGVhcnRzOiAyMCB9LFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgnMjAyNC0wMS0xNCcpLFxuICAgICAgICAgICAgICAgIF9jb3VudDogeyBjb21tZW50czogNSwgaGVhcnRzOiAxNSB9LFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgXSxcbiAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgfSxcbiAgICBdLFxuICB9O1xuXG4gIGNvbnN0IG1vY2tUb3BDb250cmlidXRvciA9IHtcbiAgICBpZDogJ3VzZXItY29udHJpYnV0b3InLFxuICAgIGZpcnN0TmFtZTogJ0phbmUnLFxuICAgIGxhc3ROYW1lOiAnU21pdGgnLFxuICAgIGF2YXRhclVybDogJ2phbmUuanBnJyxcbiAgICBfY291bnQ6IHsgcG9zdHM6IDE1LCBjb21tZW50czogMjUgfSxcbiAgfTtcblxuICBiZWZvcmVFYWNoKGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBtb2NrUHJpc21hU2VydmljZSA9IHtcbiAgICAgIGNvbW11bml0eToge1xuICAgICAgICBmaW5kTWFueTogamVzdC5mbigpLFxuICAgICAgICBmaW5kVW5pcXVlOiBqZXN0LmZuKCksXG4gICAgICAgIGNvdW50OiBqZXN0LmZuKCksXG4gICAgICB9LFxuICAgICAgY29tbWVudDoge1xuICAgICAgICBjb3VudDogamVzdC5mbigpLFxuICAgICAgfSxcbiAgICAgIHBvc3Q6IHtcbiAgICAgICAgY291bnQ6IGplc3QuZm4oKSxcbiAgICAgIH0sXG4gICAgICBtZW1iZXJzaGlwOiB7XG4gICAgICAgIGNvdW50OiBqZXN0LmZuKCksXG4gICAgICAgIGZpbmRNYW55OiBqZXN0LmZuKCksXG4gICAgICB9LFxuICAgICAgdXNlcjoge1xuICAgICAgICBmaW5kTWFueTogamVzdC5mbigpLFxuICAgICAgfSxcbiAgICB9O1xuXG4gICAgY29uc3QgbW9ja0V2ZW50RW1pdHRlciA9IHtcbiAgICAgIGVtaXQ6IGplc3QuZm4oKSxcbiAgICB9O1xuXG4gICAgY29uc3QgbW9kdWxlOiBUZXN0aW5nTW9kdWxlID0gYXdhaXQgVGVzdC5jcmVhdGVUZXN0aW5nTW9kdWxlKHtcbiAgICAgIHByb3ZpZGVyczogW1xuICAgICAgICBFbmhhbmNlZENvbW11bml0eVNlcnZpY2UsXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlOiBQcmlzbWFTZXJ2aWNlLFxuICAgICAgICAgIHVzZVZhbHVlOiBtb2NrUHJpc21hU2VydmljZSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHByb3ZpZGU6IEV2ZW50RW1pdHRlcjIsXG4gICAgICAgICAgdXNlVmFsdWU6IG1vY2tFdmVudEVtaXR0ZXIsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgIH0pLmNvbXBpbGUoKTtcblxuICAgIHNlcnZpY2UgPSBtb2R1bGUuZ2V0PEVuaGFuY2VkQ29tbXVuaXR5U2VydmljZT4oRW5oYW5jZWRDb21tdW5pdHlTZXJ2aWNlKTtcbiAgICBwcmlzbWFTZXJ2aWNlID0gbW9kdWxlLmdldChQcmlzbWFTZXJ2aWNlKTtcbiAgICBldmVudEVtaXR0ZXIgPSBtb2R1bGUuZ2V0KEV2ZW50RW1pdHRlcjIpO1xuXG4gICAgLy8gU2V0dXAgbG9nZ2VyIHNwaWVzXG4gICAgbG9nZ2VyU3B5ID0gamVzdC5zcHlPbihMb2dnZXIucHJvdG90eXBlLCAnbG9nJykubW9ja0ltcGxlbWVudGF0aW9uKCk7XG4gICAgamVzdC5zcHlPbihMb2dnZXIucHJvdG90eXBlLCAnd2FybicpLm1vY2tJbXBsZW1lbnRhdGlvbigpO1xuICAgIGplc3Quc3B5T24oTG9nZ2VyLnByb3RvdHlwZSwgJ2Vycm9yJykubW9ja0ltcGxlbWVudGF0aW9uKCk7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgYmUgZGVmaW5lZCcsICgpID0+IHtcbiAgICBleHBlY3Qoc2VydmljZSkudG9CZURlZmluZWQoKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3NlYXJjaENvbW11bml0aWVzJywgKCkgPT4ge1xuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgcHJpc21hU2VydmljZS5jb21tdW5pdHkuZmluZE1hbnkubW9ja1Jlc29sdmVkVmFsdWUobW9ja0NvbW11bml0aWVzKTtcbiAgICAgIHByaXNtYVNlcnZpY2UuY29tbXVuaXR5LmNvdW50Lm1vY2tSZXNvbHZlZFZhbHVlKDMpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzZWFyY2ggY29tbXVuaXRpZXMgd2l0aCB0ZXh0IHF1ZXJ5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZmlsdGVycyA9IHsgcXVlcnk6ICdkZXByZXNzaW9uJyB9O1xuICAgICAgXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLnNlYXJjaENvbW11bml0aWVzKGZpbHRlcnMsICd1c2VyLTEyMycsIDEsIDEwKTtcblxuICAgICAgZXhwZWN0KHByaXNtYVNlcnZpY2UuY29tbXVuaXR5LmZpbmRNYW55KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgT1I6IFtcbiAgICAgICAgICAgIHsgbmFtZTogeyBjb250YWluczogJ2RlcHJlc3Npb24nLCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfSxcbiAgICAgICAgICAgIHsgZGVzY3JpcHRpb246IHsgY29udGFpbnM6ICdkZXByZXNzaW9uJywgbW9kZTogJ2luc2Vuc2l0aXZlJyB9IH0sXG4gICAgICAgICAgXSxcbiAgICAgICAgfSxcbiAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgIF9jb3VudDogeyBzZWxlY3Q6IHsgbWVtYmVyc2hpcHM6IHRydWUgfSB9LFxuICAgICAgICAgIG1lbWJlcnNoaXBzOiB7XG4gICAgICAgICAgICB3aGVyZTogeyB1c2VySWQ6ICd1c2VyLTEyMycgfSxcbiAgICAgICAgICAgIHNlbGVjdDogeyByb2xlOiB0cnVlIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgc2tpcDogMCxcbiAgICAgICAgdGFrZTogMTAsXG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7XG4gICAgICAgIGNvbW11bml0aWVzOiBleHBlY3QuYXJyYXlDb250YWluaW5nKFtcbiAgICAgICAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgICAgICBpZDogJ2NvbW11bml0eS0xMjMnLFxuICAgICAgICAgICAgbmFtZTogJ0RlcHJlc3Npb24gU3VwcG9ydCBOZXR3b3JrJyxcbiAgICAgICAgICAgIG1lbWJlcnNoaXBTdGF0dXM6ICdtZW1iZXInLFxuICAgICAgICAgIH0pLFxuICAgICAgICBdKSxcbiAgICAgICAgdG90YWw6IDMsXG4gICAgICAgIHBhZ2U6IDEsXG4gICAgICAgIGxpbWl0OiAxMCxcbiAgICAgICAgdG90YWxQYWdlczogMSxcbiAgICAgICAgZmFjZXRzOiBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgICAgbWVtYmVyUmFuZ2VzOiBleHBlY3QuYW55KEFycmF5KSxcbiAgICAgICAgICBjb21tb25UYWdzOiBleHBlY3QuYW55KEFycmF5KSxcbiAgICAgICAgfSksXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc2VhcmNoIGNvbW11bml0aWVzIHdpdGhvdXQgdXNlciBjb250ZXh0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZmlsdGVycyA9IHsgcXVlcnk6ICdzdXBwb3J0JyB9O1xuICAgICAgXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLnNlYXJjaENvbW11bml0aWVzKGZpbHRlcnMsIHVuZGVmaW5lZCwgMSwgMTApO1xuXG4gICAgICBleHBlY3QocHJpc21hU2VydmljZS5jb21tdW5pdHkuZmluZE1hbnkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICBPUjogW1xuICAgICAgICAgICAgeyBuYW1lOiB7IGNvbnRhaW5zOiAnc3VwcG9ydCcsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxuICAgICAgICAgICAgeyBkZXNjcmlwdGlvbjogeyBjb250YWluczogJ3N1cHBvcnQnLCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfSxcbiAgICAgICAgICBdLFxuICAgICAgICB9LFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgX2NvdW50OiB7IHNlbGVjdDogeyBtZW1iZXJzaGlwczogdHJ1ZSB9IH0sXG4gICAgICAgICAgbWVtYmVyc2hpcHM6IGZhbHNlLFxuICAgICAgICB9LFxuICAgICAgICBza2lwOiAwLFxuICAgICAgICB0YWtlOiAxMCxcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QocmVzdWx0LmNvbW11bml0aWVzKS50b0hhdmVMZW5ndGgoMyk7XG4gICAgICByZXN1bHQuY29tbXVuaXRpZXMuZm9yRWFjaChjb21tdW5pdHkgPT4ge1xuICAgICAgICBleHBlY3QoY29tbXVuaXR5Lm1lbWJlcnNoaXBTdGF0dXMpLnRvQmUoJ25vbmUnKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBmaWx0ZXIgYnkgZGVzY3JpcHRpb24gcHJlc2VuY2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBmaWx0ZXJzID0geyBoYXNEZXNjcmlwdGlvbjogdHJ1ZSB9O1xuICAgICAgXG4gICAgICBhd2FpdCBzZXJ2aWNlLnNlYXJjaENvbW11bml0aWVzKGZpbHRlcnMsICd1c2VyLTEyMycsIDEsIDEwKTtcblxuICAgICAgZXhwZWN0KHByaXNtYVNlcnZpY2UuY29tbXVuaXR5LmZpbmRNYW55KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgIHdoZXJlOiBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogeyBub3Q6ICcnIH0sXG4gICAgICAgICAgfSksXG4gICAgICAgIH0pXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBmaWx0ZXIgYnkgaW1hZ2UgcHJlc2VuY2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBmaWx0ZXJzID0geyBoYXNJbWFnZTogZmFsc2UgfTtcbiAgICAgIFxuICAgICAgYXdhaXQgc2VydmljZS5zZWFyY2hDb21tdW5pdGllcyhmaWx0ZXJzLCAndXNlci0xMjMnLCAxLCAxMCk7XG5cbiAgICAgIGV4cGVjdChwcmlzbWFTZXJ2aWNlLmNvbW11bml0eS5maW5kTWFueSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICB3aGVyZTogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgICAgaW1hZ2VVcmw6ICcnLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KVxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZmlsdGVyIGJ5IG1lbWJlciBjb3VudCByYW5nZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGZpbHRlcnMgPSB7IG1pbk1lbWJlcnM6IDIwLCBtYXhNZW1iZXJzOiA1MCB9O1xuICAgICAgXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLnNlYXJjaENvbW11bml0aWVzKGZpbHRlcnMsICd1c2VyLTEyMycsIDEsIDEwKTtcblxuICAgICAgLy8gU2hvdWxkIGZpbHRlciBvdXQgY29tbXVuaXRpZXMgb3V0c2lkZSByYW5nZVxuICAgICAgcmVzdWx0LmNvbW11bml0aWVzLmZvckVhY2goY29tbXVuaXR5ID0+IHtcbiAgICAgICAgZXhwZWN0KGNvbW11bml0eS5tZW1iZXJDb3VudCkudG9CZUdyZWF0ZXJUaGFuT3JFcXVhbCgyMCk7XG4gICAgICAgIGV4cGVjdChjb21tdW5pdHkubWVtYmVyQ291bnQpLnRvQmVMZXNzVGhhbk9yRXF1YWwoNTApO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBwYWdpbmF0aW9uIGNvcnJlY3RseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGZpbHRlcnMgPSB7fTtcbiAgICAgIFxuICAgICAgYXdhaXQgc2VydmljZS5zZWFyY2hDb21tdW5pdGllcyhmaWx0ZXJzLCAndXNlci0xMjMnLCAyLCA1KTtcblxuICAgICAgZXhwZWN0KHByaXNtYVNlcnZpY2UuY29tbXVuaXR5LmZpbmRNYW55KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgIHNraXA6IDUsIC8vIChwYWdlIC0gMSkgKiBsaW1pdCA9ICgyIC0gMSkgKiA1XG4gICAgICAgICAgdGFrZTogNSxcbiAgICAgICAgfSlcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHNvcnQgY29tbXVuaXRpZXMgYnkgbWVtYmVycyBjb3VudCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGZpbHRlcnMgPSB7IHNvcnRCeTogJ21lbWJlcnMnLCBzb3J0T3JkZXI6ICdkZXNjJyB9O1xuICAgICAgXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLnNlYXJjaENvbW11bml0aWVzKGZpbHRlcnMsICd1c2VyLTEyMycsIDEsIDEwKTtcblxuICAgICAgLy8gU2hvdWxkIGJlIHNvcnRlZCBieSBtZW1iZXIgY291bnQgZGVzY2VuZGluZ1xuICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCByZXN1bHQuY29tbXVuaXRpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5jb21tdW5pdGllc1tpLTFdLm1lbWJlckNvdW50KS50b0JlR3JlYXRlclRoYW5PckVxdWFsKFxuICAgICAgICAgIHJlc3VsdC5jb21tdW5pdGllc1tpXS5tZW1iZXJDb3VudFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzb3J0IGNvbW11bml0aWVzIGJ5IG5ld2VzdCBmaXJzdCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGZpbHRlcnMgPSB7IHNvcnRCeTogJ25ld2VzdCcsIHNvcnRPcmRlcjogJ2Rlc2MnIH07XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2Uuc2VhcmNoQ29tbXVuaXRpZXMoZmlsdGVycywgJ3VzZXItMTIzJywgMSwgMTApO1xuXG4gICAgICAvLyBTaG91bGQgYmUgc29ydGVkIGJ5IGNyZWF0aW9uIGRhdGUgZGVzY2VuZGluZ1xuICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCByZXN1bHQuY29tbXVuaXRpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5jb21tdW5pdGllc1tpLTFdLmNyZWF0ZWRBdC5nZXRUaW1lKCkpLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwoXG4gICAgICAgICAgcmVzdWx0LmNvbW11bml0aWVzW2ldLmNyZWF0ZWRBdC5nZXRUaW1lKClcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc29ydCBjb21tdW5pdGllcyBhbHBoYWJldGljYWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGZpbHRlcnMgPSB7IHNvcnRCeTogJ2FscGhhYmV0aWNhbCcsIHNvcnRPcmRlcjogJ2FzYycgfTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5zZWFyY2hDb21tdW5pdGllcyhmaWx0ZXJzLCAndXNlci0xMjMnLCAxLCAxMCk7XG5cbiAgICAgIC8vIFNob3VsZCBiZSBzb3J0ZWQgYWxwaGFiZXRpY2FsbHlcbiAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgcmVzdWx0LmNvbW11bml0aWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuY29tbXVuaXRpZXNbaS0xXS5uYW1lLmxvY2FsZUNvbXBhcmUocmVzdWx0LmNvbW11bml0aWVzW2ldLm5hbWUpKVxuICAgICAgICAgIC50b0JlTGVzc1RoYW5PckVxdWFsKDApO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjYWxjdWxhdGUgdG90YWwgcGFnZXMgY29ycmVjdGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgcHJpc21hU2VydmljZS5jb21tdW5pdHkuY291bnQubW9ja1Jlc29sdmVkVmFsdWUoMjUpO1xuICAgICAgXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLnNlYXJjaENvbW11bml0aWVzKHt9LCAndXNlci0xMjMnLCAxLCAxMCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQudG90YWxQYWdlcykudG9CZSgzKTsgLy8gTWF0aC5jZWlsKDI1LzEwKSA9IDNcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGVycm9ycyBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgcHJpc21hU2VydmljZS5jb21tdW5pdHkuZmluZE1hbnkubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdEYXRhYmFzZSBlcnJvcicpKTtcblxuICAgICAgY29uc3QgZXJyb3JTcHkgPSBqZXN0LnNweU9uKExvZ2dlci5wcm90b3R5cGUsICdlcnJvcicpLm1vY2tJbXBsZW1lbnRhdGlvbigpO1xuXG4gICAgICBhd2FpdCBleHBlY3Qoc2VydmljZS5zZWFyY2hDb21tdW5pdGllcyh7fSwgJ3VzZXItMTIzJykpLnJlamVjdHMudG9UaHJvdygnRGF0YWJhc2UgZXJyb3InKTtcblxuICAgICAgZXhwZWN0KGVycm9yU3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ0Vycm9yIHNlYXJjaGluZyBjb21tdW5pdGllcycpLFxuICAgICAgICBleHBlY3QuYW55KEVycm9yKVxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc2V0IGNvcnJlY3QgbWVtYmVyc2hpcCBzdGF0dXMgYmFzZWQgb24gdXNlciBtZW1iZXJzaGlwcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbW11bml0aWVzV2l0aE1lbWJlcnNoaXBzID0gW1xuICAgICAgICB7IC4uLm1vY2tDb21tdW5pdGllc1swXSwgbWVtYmVyc2hpcHM6IFt7IHJvbGU6ICdtZW1iZXInIH1dIH0sXG4gICAgICAgIHsgLi4ubW9ja0NvbW11bml0aWVzWzFdLCBtZW1iZXJzaGlwczogW10gfSxcbiAgICAgIF07XG4gICAgICBcbiAgICAgIHByaXNtYVNlcnZpY2UuY29tbXVuaXR5LmZpbmRNYW55Lm1vY2tSZXNvbHZlZFZhbHVlKGNvbW11bml0aWVzV2l0aE1lbWJlcnNoaXBzKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5zZWFyY2hDb21tdW5pdGllcyh7fSwgJ3VzZXItMTIzJywgMSwgMTApO1xuXG4gICAgICBleHBlY3QocmVzdWx0LmNvbW11bml0aWVzWzBdLm1lbWJlcnNoaXBTdGF0dXMpLnRvQmUoJ21lbWJlcicpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5jb21tdW5pdGllc1sxXS5tZW1iZXJzaGlwU3RhdHVzKS50b0JlKCdub25lJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdnZXRDb21tdW5pdHlEZXRhaWxzJywgKCkgPT4ge1xuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgcHJpc21hU2VydmljZS5jb21tdW5pdHkuZmluZFVuaXF1ZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrQ29tbXVuaXR5V2l0aERldGFpbHMpO1xuICAgICAgcHJpc21hU2VydmljZS5jb21tZW50LmNvdW50Lm1vY2tSZXNvbHZlZFZhbHVlKDUwKTtcbiAgICAgIHByaXNtYVNlcnZpY2UucG9zdC5jb3VudC5tb2NrUmVzb2x2ZWRWYWx1ZSgxMCk7XG4gICAgICBwcmlzbWFTZXJ2aWNlLm1lbWJlcnNoaXAuY291bnRcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZSg1KSAvLyB3ZWVrbHkgcG9zdHNcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZSgxNSkgLy8gd2Vla2x5IGNvbW1lbnRzXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UoMykgLy8gd2Vla2x5IG1lbWJlcnNcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZSgyNSk7IC8vIGFjdGl2ZSBtZW1iZXJzXG4gICAgICBwcmlzbWFTZXJ2aWNlLnVzZXIuZmluZE1hbnkubW9ja1Jlc29sdmVkVmFsdWUoW21vY2tUb3BDb250cmlidXRvcl0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBnZXQgZGV0YWlsZWQgY29tbXVuaXR5IGluZm9ybWF0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5nZXRDb21tdW5pdHlEZXRhaWxzKCdjb21tdW5pdHktMTIzJywgJ3VzZXItMTIzJyk7XG5cbiAgICAgIGV4cGVjdChwcmlzbWFTZXJ2aWNlLmNvbW11bml0eS5maW5kVW5pcXVlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIHdoZXJlOiB7IGlkOiAnY29tbXVuaXR5LTEyMycgfSxcbiAgICAgICAgaW5jbHVkZTogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgIF9jb3VudDogeyBzZWxlY3Q6IHsgbWVtYmVyc2hpcHM6IHRydWUgfSB9LFxuICAgICAgICAgIHJvb21Hcm91cHM6IGV4cGVjdC5hbnkoT2JqZWN0KSxcbiAgICAgICAgICBtb2RlcmF0b3JDb21tdW5pdGllczogZXhwZWN0LmFueShPYmplY3QpLFxuICAgICAgICAgIG1lbWJlcnNoaXBzOiBleHBlY3QuYW55KE9iamVjdCksXG4gICAgICAgIH0pLFxuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoe1xuICAgICAgICBpZDogJ2NvbW11bml0eS0xMjMnLFxuICAgICAgICBuYW1lOiAnRGVwcmVzc2lvbiBTdXBwb3J0IE5ldHdvcmsnLFxuICAgICAgICBzbHVnOiAnZGVwcmVzc2lvbi1zdXBwb3J0JyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdBIHN1cHBvcnRpdmUgY29tbXVuaXR5IGZvciBkZXByZXNzaW9uJyxcbiAgICAgICAgaW1hZ2VVcmw6ICdkZXByZXNzaW9uLmpwZycsXG4gICAgICAgIGNyZWF0ZWRBdDogZXhwZWN0LmFueShEYXRlKSxcbiAgICAgICAgdXBkYXRlZEF0OiBleHBlY3QuYW55KERhdGUpLFxuICAgICAgICBtZW1iZXJDb3VudDogNDUsXG4gICAgICAgIHN0YXRzOiBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgICAgdG90YWxQb3N0czogMixcbiAgICAgICAgICB0b3RhbENvbW1lbnRzOiA1MCxcbiAgICAgICAgICBhY3RpdmVNZW1iZXJzOiAyNSxcbiAgICAgICAgICByZWNlbnRBY3Rpdml0eTogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgICAgcG9zdHNUaGlzV2VlazogMTAsXG4gICAgICAgICAgICBjb21tZW50c1RoaXNXZWVrOiAxNSxcbiAgICAgICAgICAgIG5ld01lbWJlcnNUaGlzV2VlazogMyxcbiAgICAgICAgICB9KSxcbiAgICAgICAgfSksXG4gICAgICAgIHJlY2VudFBvc3RzOiBleHBlY3QuYXJyYXlDb250YWluaW5nKFtcbiAgICAgICAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgICAgICBpZDogJ3Bvc3QtNDU2JyxcbiAgICAgICAgICAgIHRpdGxlOiAnQW5vdGhlciBQb3N0JyxcbiAgICAgICAgICAgIGF1dGhvcjogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgICAgICBmaXJzdE5hbWU6ICdKb2huJyxcbiAgICAgICAgICAgICAgbGFzdE5hbWU6ICdEb2UnLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgfSksXG4gICAgICAgIF0pLFxuICAgICAgICB0b3BDb250cmlidXRvcnM6IGV4cGVjdC5hbnkoQXJyYXkpLFxuICAgICAgICBtb2RlcmF0b3JzOiBleHBlY3QuYXJyYXlDb250YWluaW5nKFtcbiAgICAgICAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgICAgICBmaXJzdE5hbWU6ICdKb2huJyxcbiAgICAgICAgICAgIGxhc3ROYW1lOiAnRG9lJyxcbiAgICAgICAgICB9KSxcbiAgICAgICAgXSksXG4gICAgICAgIG1lbWJlcnNoaXBTdGF0dXM6ICdtZW1iZXInLFxuICAgICAgICB1c2VyUGVybWlzc2lvbnM6IGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICBjYW5Qb3N0OiB0cnVlLFxuICAgICAgICAgIGNhbkNvbW1lbnQ6IHRydWUsXG4gICAgICAgICAgY2FuTW9kZXJhdGU6IGZhbHNlLFxuICAgICAgICB9KSxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgY29tbXVuaXR5IG5vdCBmb3VuZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIHByaXNtYVNlcnZpY2UuY29tbXVuaXR5LmZpbmRVbmlxdWUubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChzZXJ2aWNlLmdldENvbW11bml0eURldGFpbHMoJ25vbi1leGlzdGVudCcpKS5yZWplY3RzLnRvVGhyb3coXG4gICAgICAgIG5ldyBOb3RGb3VuZEV4Y2VwdGlvbignQ29tbXVuaXR5IG5vbi1leGlzdGVudCBub3QgZm91bmQnKVxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY2FsY3VsYXRlIHVzZXIgcGVybWlzc2lvbnMgZm9yIG1vZGVyYXRvcicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vZGVyYXRvckNvbW11bml0eSA9IHtcbiAgICAgICAgLi4ubW9ja0NvbW11bml0eVdpdGhEZXRhaWxzLFxuICAgICAgICBtZW1iZXJzaGlwczogW3sgcm9sZTogJ21vZGVyYXRvcicgfV0sXG4gICAgICB9O1xuICAgICAgXG4gICAgICBwcmlzbWFTZXJ2aWNlLmNvbW11bml0eS5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKG1vZGVyYXRvckNvbW11bml0eSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuZ2V0Q29tbXVuaXR5RGV0YWlscygnY29tbXVuaXR5LTEyMycsICd1c2VyLTEyMycpO1xuXG4gICAgICBleHBlY3QocmVzdWx0LnVzZXJQZXJtaXNzaW9ucykudG9FcXVhbCh7XG4gICAgICAgIGNhblBvc3Q6IHRydWUsXG4gICAgICAgIGNhbkNvbW1lbnQ6IHRydWUsXG4gICAgICAgIGNhbk1vZGVyYXRlOiB0cnVlLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSB1c2VyIHdpdGhvdXQgbWVtYmVyc2hpcCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbW11bml0eVdpdGhvdXRVc2VyTWVtYmVyc2hpcCA9IHtcbiAgICAgICAgLi4ubW9ja0NvbW11bml0eVdpdGhEZXRhaWxzLFxuICAgICAgICBtZW1iZXJzaGlwczogW10sXG4gICAgICB9O1xuICAgICAgXG4gICAgICBwcmlzbWFTZXJ2aWNlLmNvbW11bml0eS5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKGNvbW11bml0eVdpdGhvdXRVc2VyTWVtYmVyc2hpcCk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuZ2V0Q29tbXVuaXR5RGV0YWlscygnY29tbXVuaXR5LTEyMycsICd1c2VyLTEyMycpO1xuXG4gICAgICBleHBlY3QocmVzdWx0Lm1lbWJlcnNoaXBTdGF0dXMpLnRvQmUoJ25vbmUnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQudXNlclBlcm1pc3Npb25zKS50b0VxdWFsKHtcbiAgICAgICAgY2FuUG9zdDogZmFsc2UsXG4gICAgICAgIGNhbkNvbW1lbnQ6IGZhbHNlLFxuICAgICAgICBjYW5Nb2RlcmF0ZTogZmFsc2UsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG1pc3NpbmcgdXNlciBjb250ZXh0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5nZXRDb21tdW5pdHlEZXRhaWxzKCdjb21tdW5pdHktMTIzJyk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQubWVtYmVyc2hpcFN0YXR1cykudG9CZSgnbm9uZScpO1xuICAgICAgZXhwZWN0KHJlc3VsdC51c2VyUGVybWlzc2lvbnMpLnRvRXF1YWwoe1xuICAgICAgICBjYW5Qb3N0OiBmYWxzZSxcbiAgICAgICAgY2FuQ29tbWVudDogZmFsc2UsXG4gICAgICAgIGNhbk1vZGVyYXRlOiBmYWxzZSxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzb3J0IHJlY2VudCBwb3N0cyBieSBjcmVhdGlvbiBkYXRlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5nZXRDb21tdW5pdHlEZXRhaWxzKCdjb21tdW5pdHktMTIzJywgJ3VzZXItMTIzJyk7XG5cbiAgICAgIC8vIFNob3VsZCBiZSBzb3J0ZWQgbmV3ZXN0IGZpcnN0XG4gICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHJlc3VsdC5yZWNlbnRQb3N0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBleHBlY3QocmVzdWx0LnJlY2VudFBvc3RzW2ktMV0uY3JlYXRlZEF0LmdldFRpbWUoKSkudG9CZUdyZWF0ZXJUaGFuT3JFcXVhbChcbiAgICAgICAgICByZXN1bHQucmVjZW50UG9zdHNbaV0uY3JlYXRlZEF0LmdldFRpbWUoKVxuICAgICAgICApO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgcG9zdHMgd2l0aCBtaXNzaW5nIHVzZXIgZGF0YScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbW11bml0eVdpdGhBbm9ueW1vdXNQb3N0ID0ge1xuICAgICAgICAuLi5tb2NrQ29tbXVuaXR5V2l0aERldGFpbHMsXG4gICAgICAgIHJvb21Hcm91cHM6IFt7XG4gICAgICAgICAgLi4ubW9ja1Jvb21Hcm91cCxcbiAgICAgICAgICByb29tczogW3tcbiAgICAgICAgICAgIC4uLm1vY2tSb29tLFxuICAgICAgICAgICAgcG9zdHM6IFt7XG4gICAgICAgICAgICAgIGlkOiAncG9zdC1hbm9ueW1vdXMnLFxuICAgICAgICAgICAgICB0aXRsZTogJ0Fub255bW91cyBQb3N0JyxcbiAgICAgICAgICAgICAgY29udGVudDogJ1Bvc3Qgd2l0aG91dCB1c2VyJyxcbiAgICAgICAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgnMjAyNC0wMS0xMCcpLFxuICAgICAgICAgICAgICB1c2VyOiBudWxsLFxuICAgICAgICAgICAgICBfY291bnQ6IHsgY29tbWVudHM6IDAsIGhlYXJ0czogMCB9LFxuICAgICAgICAgICAgfV0sXG4gICAgICAgICAgfV0sXG4gICAgICAgIH1dLFxuICAgICAgfTtcbiAgICAgIFxuICAgICAgcHJpc21hU2VydmljZS5jb21tdW5pdHkuZmluZFVuaXF1ZS5tb2NrUmVzb2x2ZWRWYWx1ZShjb21tdW5pdHlXaXRoQW5vbnltb3VzUG9zdCk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuZ2V0Q29tbXVuaXR5RGV0YWlscygnY29tbXVuaXR5LTEyMycsICd1c2VyLTEyMycpO1xuXG4gICAgICBjb25zdCBhbm9ueW1vdXNQb3N0ID0gcmVzdWx0LnJlY2VudFBvc3RzLmZpbmQocCA9PiBwLmlkID09PSAncG9zdC1hbm9ueW1vdXMnKTtcbiAgICAgIGV4cGVjdChhbm9ueW1vdXNQb3N0Py5hdXRob3IpLnRvRXF1YWwoe1xuICAgICAgICBpZDogJ3Vua25vd24nLFxuICAgICAgICBmaXJzdE5hbWU6ICdVbmtub3duJyxcbiAgICAgICAgbGFzdE5hbWU6ICdVc2VyJyxcbiAgICAgICAgYXZhdGFyVXJsOiB1bmRlZmluZWQsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGVycm9ycyBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgcHJpc21hU2VydmljZS5jb21tdW5pdHkuZmluZFVuaXF1ZS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ0RhdGFiYXNlIGVycm9yJykpO1xuXG4gICAgICBjb25zdCBlcnJvclNweSA9IGplc3Quc3B5T24oTG9nZ2VyLnByb3RvdHlwZSwgJ2Vycm9yJykubW9ja0ltcGxlbWVudGF0aW9uKCk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChzZXJ2aWNlLmdldENvbW11bml0eURldGFpbHMoJ2NvbW11bml0eS0xMjMnKSkucmVqZWN0cy50b1Rocm93KCdEYXRhYmFzZSBlcnJvcicpO1xuXG4gICAgICBleHBlY3QoZXJyb3JTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBleHBlY3Quc3RyaW5nQ29udGFpbmluZygnRXJyb3IgZ2V0dGluZyBjb21tdW5pdHkgZGV0YWlscyBmb3IgY29tbXVuaXR5LTEyMycpLFxuICAgICAgICBleHBlY3QuYW55KEVycm9yKVxuICAgICAgKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dldFRyZW5kaW5nQ29tbXVuaXRpZXMnLCAoKSA9PiB7XG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICBwcmlzbWFTZXJ2aWNlLmNvbW11bml0eS5maW5kTWFueS5tb2NrUmVzb2x2ZWRWYWx1ZShbbW9ja1RyZW5kaW5nQ29tbXVuaXR5XSk7XG4gICAgICBwcmlzbWFTZXJ2aWNlLm1lbWJlcnNoaXAuY291bnQubW9ja1Jlc29sdmVkVmFsdWUoNSk7IC8vIFByZXZpb3VzIHBlcmlvZCBtZW1iZXJzXG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGdldCB0cmVuZGluZyBjb21tdW5pdGllcyB3aXRoIGRlZmF1bHQgcGFyYW1ldGVycycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuZ2V0VHJlbmRpbmdDb21tdW5pdGllcygpO1xuXG4gICAgICBleHBlY3QocHJpc21hU2VydmljZS5jb21tdW5pdHkuZmluZE1hbnkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgaW5jbHVkZTogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgIF9jb3VudDogeyBzZWxlY3Q6IHsgbWVtYmVyc2hpcHM6IHRydWUgfSB9LFxuICAgICAgICAgIG1lbWJlcnNoaXBzOiBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgICAgICB3aGVyZTogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgICAgICBqb2luZWRBdDogeyBndGU6IGV4cGVjdC5hbnkoRGF0ZSkgfSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIH0pLFxuICAgICAgICAgIHJvb21Hcm91cHM6IGV4cGVjdC5hbnkoT2JqZWN0KSxcbiAgICAgICAgfSksXG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZUluc3RhbmNlT2YoQXJyYXkpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5sZW5ndGgpLnRvQmVMZXNzVGhhbk9yRXF1YWwoMTApO1xuICAgICAgXG4gICAgICBpZiAocmVzdWx0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgZXhwZWN0KHJlc3VsdFswXSkudG9IYXZlUHJvcGVydHkoJ3RyZW5kaW5nRGF0YScpO1xuICAgICAgICBleHBlY3QocmVzdWx0WzBdLnRyZW5kaW5nRGF0YSkudG9IYXZlUHJvcGVydHkoJ2dyb3d0aFJhdGUnKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdFswXS50cmVuZGluZ0RhdGEpLnRvSGF2ZVByb3BlcnR5KCdhY3Rpdml0eVNjb3JlJyk7XG4gICAgICAgIGV4cGVjdChyZXN1bHRbMF0udHJlbmRpbmdEYXRhKS50b0hhdmVQcm9wZXJ0eSgnZW5nYWdlbWVudFJhdGUnKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdFswXS50cmVuZGluZ0RhdGEpLnRvSGF2ZVByb3BlcnR5KCdyZXRlbnRpb25SYXRlJyk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGdldCB0cmVuZGluZyBjb21tdW5pdGllcyBmb3IgbW9udGggdGltZWZyYW1lJywgYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgc2VydmljZS5nZXRUcmVuZGluZ0NvbW11bml0aWVzKDUsICdtb250aCcpO1xuXG4gICAgICBleHBlY3QocHJpc21hU2VydmljZS5jb21tdW5pdHkuZmluZE1hbnkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgaW5jbHVkZTogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgIG1lbWJlcnNoaXBzOiBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgICAgICB3aGVyZTogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgICAgICBqb2luZWRBdDogeyBndGU6IGV4cGVjdC5hbnkoRGF0ZSkgfSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KSxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBsaW1pdCByZXN1bHRzIHRvIHNwZWNpZmllZCBsaW1pdCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuZ2V0VHJlbmRpbmdDb21tdW5pdGllcygzKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5sZW5ndGgpLnRvQmVMZXNzVGhhbk9yRXF1YWwoMyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHNvcnQgYnkgdHJlbmRpbmcgc2NvcmUnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIG11bHRpcGxlIGNvbW11bml0aWVzIHdpdGggZGlmZmVyZW50IHRyZW5kaW5nIG1ldHJpY3NcbiAgICAgIGNvbnN0IG11bHRpcGxlVHJlbmRpbmdDb21tdW5pdGllcyA9IFtcbiAgICAgICAgeyAuLi5tb2NrVHJlbmRpbmdDb21tdW5pdHksIGlkOiAndHJlbmRpbmctMScgfSxcbiAgICAgICAgeyAuLi5tb2NrVHJlbmRpbmdDb21tdW5pdHksIGlkOiAndHJlbmRpbmctMicgfSxcbiAgICAgICAgeyAuLi5tb2NrVHJlbmRpbmdDb21tdW5pdHksIGlkOiAndHJlbmRpbmctMycgfSxcbiAgICAgIF07XG4gICAgICBcbiAgICAgIHByaXNtYVNlcnZpY2UuY29tbXVuaXR5LmZpbmRNYW55Lm1vY2tSZXNvbHZlZFZhbHVlKG11bHRpcGxlVHJlbmRpbmdDb21tdW5pdGllcyk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuZ2V0VHJlbmRpbmdDb21tdW5pdGllcygpO1xuXG4gICAgICAvLyBTaG91bGQgYmUgc29ydGVkIGJ5IHRyZW5kaW5nIHNjb3JlIChjb21iaW5hdGlvbiBvZiBtZXRyaWNzKVxuICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCByZXN1bHQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3Qgc2NvcmVBID0gcmVzdWx0W2ktMV0udHJlbmRpbmdEYXRhLmdyb3d0aFJhdGUgKiAwLjQgKyBcbiAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFtpLTFdLnRyZW5kaW5nRGF0YS5hY3Rpdml0eVNjb3JlICogMC40ICsgXG4gICAgICAgICAgICAgICAgICAgICByZXN1bHRbaS0xXS50cmVuZGluZ0RhdGEuZW5nYWdlbWVudFJhdGUgKiAwLjI7XG4gICAgICAgIGNvbnN0IHNjb3JlQiA9IHJlc3VsdFtpXS50cmVuZGluZ0RhdGEuZ3Jvd3RoUmF0ZSAqIDAuNCArIFxuICAgICAgICAgICAgICAgICAgICAgcmVzdWx0W2ldLnRyZW5kaW5nRGF0YS5hY3Rpdml0eVNjb3JlICogMC40ICsgXG4gICAgICAgICAgICAgICAgICAgICByZXN1bHRbaV0udHJlbmRpbmdEYXRhLmVuZ2FnZW1lbnRSYXRlICogMC4yO1xuICAgICAgICBleHBlY3Qoc2NvcmVBKS50b0JlR3JlYXRlclRoYW5PckVxdWFsKHNjb3JlQik7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBlcnJvcnMgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIHByaXNtYVNlcnZpY2UuY29tbXVuaXR5LmZpbmRNYW55Lm1vY2tSZWplY3RlZFZhbHVlKG5ldyBFcnJvcignRGF0YWJhc2UgZXJyb3InKSk7XG5cbiAgICAgIGNvbnN0IGVycm9yU3B5ID0gamVzdC5zcHlPbihMb2dnZXIucHJvdG90eXBlLCAnZXJyb3InKS5tb2NrSW1wbGVtZW50YXRpb24oKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KHNlcnZpY2UuZ2V0VHJlbmRpbmdDb21tdW5pdGllcygpKS5yZWplY3RzLnRvVGhyb3coJ0RhdGFiYXNlIGVycm9yJyk7XG5cbiAgICAgIGV4cGVjdChlcnJvclNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCdFcnJvciBnZXR0aW5nIHRyZW5kaW5nIGNvbW11bml0aWVzJyksXG4gICAgICAgIGV4cGVjdC5hbnkoRXJyb3IpXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjYWxjdWxhdGUgZ3Jvd3RoIHJhdGUgY29ycmVjdGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY2FsY3VsYXRlVHJlbmRpbmdEYXRhID0gKHNlcnZpY2UgYXMgYW55KS5jYWxjdWxhdGVUcmVuZGluZ0RhdGEuYmluZChzZXJ2aWNlKTtcbiAgICAgIFxuICAgICAgY29uc3QgY29tbXVuaXR5ID0ge1xuICAgICAgICBpZDogJ3Rlc3QtY29tbXVuaXR5JyxcbiAgICAgICAgbWVtYmVyc2hpcHM6IFt7IGpvaW5lZEF0OiBuZXcgRGF0ZSgpIH1dLCAvLyAxIG5ldyBtZW1iZXJcbiAgICAgICAgX2NvdW50OiB7IG1lbWJlcnNoaXBzOiAxMCB9LCAvLyBUb3RhbCAxMCBtZW1iZXJzXG4gICAgICAgIHBvc3RzOiBbXSxcbiAgICAgIH07XG4gICAgICBcbiAgICAgIGNvbnN0IHN0YXJ0RGF0ZSA9IG5ldyBEYXRlKCcyMDI0LTAxLTE1Jyk7XG4gICAgICBjb25zdCBwcmV2aW91c1N0YXJ0RGF0ZSA9IG5ldyBEYXRlKCcyMDI0LTAxLTA4Jyk7XG4gICAgICBcbiAgICAgIC8vIE1vY2sgNSBwcmV2aW91cyBtZW1iZXJzXG4gICAgICBwcmlzbWFTZXJ2aWNlLm1lbWJlcnNoaXAuY291bnQubW9ja1Jlc29sdmVkVmFsdWUoNSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNhbGN1bGF0ZVRyZW5kaW5nRGF0YShjb21tdW5pdHksIHN0YXJ0RGF0ZSwgcHJldmlvdXNTdGFydERhdGUpO1xuXG4gICAgICAvLyBHcm93dGggcmF0ZSA9ICgoMSAtIDUpIC8gNSkgKiAxMDAgPSAtODAlIChidXQgc2hvdWxkIGJlID49IDApXG4gICAgICBleHBlY3QocmVzdWx0Lmdyb3d0aFJhdGUpLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwoMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSB6ZXJvIHByZXZpb3VzIG1lbWJlcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBjYWxjdWxhdGVUcmVuZGluZ0RhdGEgPSAoc2VydmljZSBhcyBhbnkpLmNhbGN1bGF0ZVRyZW5kaW5nRGF0YS5iaW5kKHNlcnZpY2UpO1xuICAgICAgXG4gICAgICBjb25zdCBjb21tdW5pdHkgPSB7XG4gICAgICAgIGlkOiAndGVzdC1jb21tdW5pdHknLFxuICAgICAgICBtZW1iZXJzaGlwczogW3sgam9pbmVkQXQ6IG5ldyBEYXRlKCkgfV0sIC8vIDEgbmV3IG1lbWJlclxuICAgICAgICBfY291bnQ6IHsgbWVtYmVyc2hpcHM6IDEgfSxcbiAgICAgICAgcG9zdHM6IFtdLFxuICAgICAgfTtcbiAgICAgIFxuICAgICAgLy8gTW9jayAwIHByZXZpb3VzIG1lbWJlcnNcbiAgICAgIHByaXNtYVNlcnZpY2UubWVtYmVyc2hpcC5jb3VudC5tb2NrUmVzb2x2ZWRWYWx1ZSgwKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2FsY3VsYXRlVHJlbmRpbmdEYXRhKFxuICAgICAgICBjb21tdW5pdHksIFxuICAgICAgICBuZXcgRGF0ZSgnMjAyNC0wMS0xNScpLCBcbiAgICAgICAgbmV3IERhdGUoJzIwMjQtMDEtMDgnKVxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5ncm93dGhSYXRlKS50b0JlKDEwMCk7IC8vIDEwMCUgZ3Jvd3RoIHdoZW4gc3RhcnRpbmcgZnJvbSAwXG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdnZXRTaW1pbGFyQ29tbXVuaXRpZXMnLCAoKSA9PiB7XG4gICAgY29uc3QgbW9ja1JlZkNvbW11bml0eSA9IHtcbiAgICAgIGlkOiAncmVmLWNvbW11bml0eScsXG4gICAgICBtZW1iZXJzaGlwczogW1xuICAgICAgICB7XG4gICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgbWVtYmVyc2hpcHM6IFtcbiAgICAgICAgICAgICAgeyBjb21tdW5pdHlJZDogJ3NpbWlsYXItMScsIGNvbW11bml0eTogeyBpZDogJ3NpbWlsYXItMScgfSB9LFxuICAgICAgICAgICAgICB7IGNvbW11bml0eUlkOiAnc2ltaWxhci0yJywgY29tbXVuaXR5OiB7IGlkOiAnc2ltaWxhci0yJyB9IH0sXG4gICAgICAgICAgICBdLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICBtZW1iZXJzaGlwczogW1xuICAgICAgICAgICAgICB7IGNvbW11bml0eUlkOiAnc2ltaWxhci0xJywgY29tbXVuaXR5OiB7IGlkOiAnc2ltaWxhci0xJyB9IH0sXG4gICAgICAgICAgICAgIHsgY29tbXVuaXR5SWQ6ICdzaW1pbGFyLTMnLCBjb21tdW5pdHk6IHsgaWQ6ICdzaW1pbGFyLTMnIH0gfSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfTtcblxuICAgIGNvbnN0IG1vY2tTaW1pbGFyQ29tbXVuaXRpZXMgPSBbXG4gICAgICB7XG4gICAgICAgIGlkOiAnc2ltaWxhci0xJyxcbiAgICAgICAgbmFtZTogJ1NpbWlsYXIgQ29tbXVuaXR5IDEnLFxuICAgICAgICBzbHVnOiAnc2ltaWxhci0xJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdTaW1pbGFyIGNvbW11bml0eScsXG4gICAgICAgIGltYWdlVXJsOiAnc2ltaWxhcjEuanBnJyxcbiAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgnMjAyNC0wMS0wMScpLFxuICAgICAgICBfY291bnQ6IHsgbWVtYmVyc2hpcHM6IDIwIH0sXG4gICAgICAgIHJvb21Hcm91cHM6IFt7IHJvb21zOiBbeyBfY291bnQ6IHsgcG9zdHM6IDUgfSB9XSB9XSxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGlkOiAnc2ltaWxhci0yJyxcbiAgICAgICAgbmFtZTogJ1NpbWlsYXIgQ29tbXVuaXR5IDInLFxuICAgICAgICBzbHVnOiAnc2ltaWxhci0yJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdBbm90aGVyIHNpbWlsYXIgY29tbXVuaXR5JyxcbiAgICAgICAgaW1hZ2VVcmw6ICdzaW1pbGFyMi5qcGcnLFxuICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCcyMDI0LTAxLTAyJyksXG4gICAgICAgIF9jb3VudDogeyBtZW1iZXJzaGlwczogMTUgfSxcbiAgICAgICAgcm9vbUdyb3VwczogW3sgcm9vbXM6IFt7IF9jb3VudDogeyBwb3N0czogMyB9IH1dIH1dLFxuICAgICAgfSxcbiAgICBdO1xuXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICBwcmlzbWFTZXJ2aWNlLmNvbW11bml0eS5maW5kVW5pcXVlXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UobW9ja1JlZkNvbW11bml0eSlcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpO1xuICAgICAgcHJpc21hU2VydmljZS5jb21tdW5pdHkuZmluZE1hbnkubW9ja1Jlc29sdmVkVmFsdWUobW9ja1NpbWlsYXJDb21tdW5pdGllcyk7XG4gICAgICBwcmlzbWFTZXJ2aWNlLm1lbWJlcnNoaXAuZmluZE1hbnkubW9ja1Jlc29sdmVkVmFsdWUoW10pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBmaW5kIHNpbWlsYXIgY29tbXVuaXRpZXMgYmFzZWQgb24gbWVtYmVyIG92ZXJsYXAnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBjb250ZXh0ID0geyB1c2VySWQ6ICd1c2VyLTEyMycsIG1heFJlc3VsdHM6IDUgfTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5nZXRTaW1pbGFyQ29tbXVuaXRpZXMoJ3JlZi1jb21tdW5pdHknLCBjb250ZXh0KTtcblxuICAgICAgZXhwZWN0KHByaXNtYVNlcnZpY2UuY29tbXVuaXR5LmZpbmRVbmlxdWUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6ICdyZWYtY29tbXVuaXR5JyB9LFxuICAgICAgICBpbmNsdWRlOiBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgICAgbWVtYmVyc2hpcHM6IGV4cGVjdC5hbnkoT2JqZWN0KSxcbiAgICAgICAgfSksXG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZUluc3RhbmNlT2YoQXJyYXkpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5sZW5ndGgpLnRvQmVMZXNzVGhhbk9yRXF1YWwoNSk7XG4gICAgICBcbiAgICAgIGlmIChyZXN1bHQubGVuZ3RoID4gMCkge1xuICAgICAgICBleHBlY3QocmVzdWx0WzBdKS50b0hhdmVQcm9wZXJ0eSgnaWQnKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdFswXSkudG9IYXZlUHJvcGVydHkoJ25hbWUnKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdFswXSkudG9IYXZlUHJvcGVydHkoJ21lbWJlcnNoaXBTdGF0dXMnKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdFswXS5tZW1iZXJzaGlwU3RhdHVzKS50b0JlKCdub25lJyk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGV4Y2x1ZGUgdXNlciBqb2luZWQgY29tbXVuaXRpZXMgd2hlbiBleGNsdWRlSm9pbmVkIGlzIHRydWUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB1c2VyTWVtYmVyc2hpcHMgPSBbeyBjb21tdW5pdHlJZDogJ3NpbWlsYXItMScgfV07XG4gICAgICBwcmlzbWFTZXJ2aWNlLm1lbWJlcnNoaXAuZmluZE1hbnkubW9ja1Jlc29sdmVkVmFsdWUodXNlck1lbWJlcnNoaXBzKTtcblxuICAgICAgY29uc3QgY29udGV4dCA9IHsgdXNlcklkOiAndXNlci0xMjMnLCBleGNsdWRlSm9pbmVkOiB0cnVlLCBtYXhSZXN1bHRzOiA1IH07XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuZ2V0U2ltaWxhckNvbW11bml0aWVzKCdyZWYtY29tbXVuaXR5JywgY29udGV4dCk7XG5cbiAgICAgIGV4cGVjdChwcmlzbWFTZXJ2aWNlLm1lbWJlcnNoaXAuZmluZE1hbnkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgd2hlcmU6IHsgdXNlcklkOiAndXNlci0xMjMnIH0sXG4gICAgICAgIHNlbGVjdDogeyBjb21tdW5pdHlJZDogdHJ1ZSB9LFxuICAgICAgfSk7XG5cbiAgICAgIC8vIFNob3VsZCBleGNsdWRlIHNpbWlsYXItMSBzaW5jZSB1c2VyIGlzIGFscmVhZHkgYSBtZW1iZXJcbiAgICAgIGNvbnN0IGV4Y2x1ZGVkQ29tbXVuaXR5ID0gcmVzdWx0LmZpbmQoYyA9PiBjLmlkID09PSAnc2ltaWxhci0xJyk7XG4gICAgICBleHBlY3QoZXhjbHVkZWRDb21tdW5pdHkpLnRvQmVVbmRlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaW5jbHVkZSB1c2VyIGpvaW5lZCBjb21tdW5pdGllcyB3aGVuIGV4Y2x1ZGVKb2luZWQgaXMgZmFsc2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBjb250ZXh0ID0geyB1c2VySWQ6ICd1c2VyLTEyMycsIGV4Y2x1ZGVKb2luZWQ6IGZhbHNlLCBtYXhSZXN1bHRzOiA1IH07XG4gICAgICBcbiAgICAgIGF3YWl0IHNlcnZpY2UuZ2V0U2ltaWxhckNvbW11bml0aWVzKCdyZWYtY29tbXVuaXR5JywgY29udGV4dCk7XG5cbiAgICAgIGV4cGVjdChwcmlzbWFTZXJ2aWNlLm1lbWJlcnNoaXAuZmluZE1hbnkpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IE5vdEZvdW5kRXhjZXB0aW9uIGZvciBub24tZXhpc3RlbnQgcmVmZXJlbmNlIGNvbW11bml0eScsIGFzeW5jICgpID0+IHtcbiAgICAgIHByaXNtYVNlcnZpY2UuY29tbXVuaXR5LmZpbmRVbmlxdWUubW9ja1Jlc29sdmVkVmFsdWVPbmNlKG51bGwpO1xuXG4gICAgICBjb25zdCBjb250ZXh0ID0geyB1c2VySWQ6ICd1c2VyLTEyMycgfTtcblxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBzZXJ2aWNlLmdldFNpbWlsYXJDb21tdW5pdGllcygnbm9uLWV4aXN0ZW50JywgY29udGV4dClcbiAgICAgICkucmVqZWN0cy50b1Rocm93KG5ldyBOb3RGb3VuZEV4Y2VwdGlvbignQ29tbXVuaXR5IG5vbi1leGlzdGVudCBub3QgZm91bmQnKSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBjb21tdW5pdGllcyB3aXRob3V0IG1lbWJlcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBlbXB0eVJlZkNvbW11bml0eSA9IHsgaWQ6ICdyZWYtY29tbXVuaXR5JywgbWVtYmVyc2hpcHM6IFtdIH07XG4gICAgICBwcmlzbWFTZXJ2aWNlLmNvbW11bml0eS5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlT25jZShlbXB0eVJlZkNvbW11bml0eSk7XG5cbiAgICAgIGNvbnN0IGNvbnRleHQgPSB7IHVzZXJJZDogJ3VzZXItMTIzJyB9O1xuICAgICAgXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLmdldFNpbWlsYXJDb21tdW5pdGllcygncmVmLWNvbW11bml0eScsIGNvbnRleHQpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKFtdKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbGltaXQgcmVzdWx0cyB0byBtYXhSZXN1bHRzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY29udGV4dCA9IHsgdXNlcklkOiAndXNlci0xMjMnLCBtYXhSZXN1bHRzOiAxIH07XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuZ2V0U2ltaWxhckNvbW11bml0aWVzKCdyZWYtY29tbXVuaXR5JywgY29udGV4dCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQubGVuZ3RoKS50b0JlTGVzc1RoYW5PckVxdWFsKDEpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZXJyb3JzIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBwcmlzbWFTZXJ2aWNlLmNvbW11bml0eS5maW5kVW5pcXVlLm1vY2tSZWplY3RlZFZhbHVlKG5ldyBFcnJvcignRGF0YWJhc2UgZXJyb3InKSk7XG5cbiAgICAgIGNvbnN0IGVycm9yU3B5ID0gamVzdC5zcHlPbihMb2dnZXIucHJvdG90eXBlLCAnZXJyb3InKS5tb2NrSW1wbGVtZW50YXRpb24oKTtcbiAgICAgIGNvbnN0IGNvbnRleHQgPSB7IHVzZXJJZDogJ3VzZXItMTIzJyB9O1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIHNlcnZpY2UuZ2V0U2ltaWxhckNvbW11bml0aWVzKCdyZWYtY29tbXVuaXR5JywgY29udGV4dClcbiAgICAgICkucmVqZWN0cy50b1Rocm93KCdEYXRhYmFzZSBlcnJvcicpO1xuXG4gICAgICBleHBlY3QoZXJyb3JTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBleHBlY3Quc3RyaW5nQ29udGFpbmluZygnRXJyb3IgZ2V0dGluZyBzaW1pbGFyIGNvbW11bml0aWVzIGZvciByZWYtY29tbXVuaXR5JyksXG4gICAgICAgIGV4cGVjdC5hbnkoRXJyb3IpXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnYXBwbHlTb3J0aW5nJywgKCkgPT4ge1xuICAgIGNvbnN0IHNhbXBsZUNvbW11bml0aWVzID0gW1xuICAgICAge1xuICAgICAgICBpZDogJzEnLFxuICAgICAgICBuYW1lOiAnQmV0YSBDb21tdW5pdHknLFxuICAgICAgICBtZW1iZXJDb3VudDogMTAsXG4gICAgICAgIHJlY2VudEFjdGl2aXR5OiB7IHBvc3RDb3VudDogNSwgY29tbWVudENvdW50OiAxMCwgbGFzdEFjdGl2aXR5QXQ6IG51bGwgfSxcbiAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgnMjAyNC0wMS0wMicpLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgaWQ6ICcyJyxcbiAgICAgICAgbmFtZTogJ0FscGhhIENvbW11bml0eScsXG4gICAgICAgIG1lbWJlckNvdW50OiAyMCxcbiAgICAgICAgcmVjZW50QWN0aXZpdHk6IHsgcG9zdENvdW50OiAzLCBjb21tZW50Q291bnQ6IDcsIGxhc3RBY3Rpdml0eUF0OiBudWxsIH0sXG4gICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoJzIwMjQtMDEtMDEnKSxcbiAgICAgIH0sXG4gICAgXSBhcyBhbnlbXTtcblxuICAgIGl0KCdzaG91bGQgc29ydCBieSBtZW1iZXJzIGRlc2NlbmRpbmcnLCAoKSA9PiB7XG4gICAgICBjb25zdCBhcHBseVNvcnRpbmcgPSAoc2VydmljZSBhcyBhbnkpLmFwcGx5U29ydGluZy5iaW5kKHNlcnZpY2UpO1xuICAgICAgY29uc3QgY29tbXVuaXRpZXMgPSBbLi4uc2FtcGxlQ29tbXVuaXRpZXNdO1xuICAgICAgXG4gICAgICBhcHBseVNvcnRpbmcoY29tbXVuaXRpZXMsICdtZW1iZXJzJywgJ2Rlc2MnKTtcblxuICAgICAgZXhwZWN0KGNvbW11bml0aWVzWzBdLm1lbWJlckNvdW50KS50b0JlKDIwKTtcbiAgICAgIGV4cGVjdChjb21tdW5pdGllc1sxXS5tZW1iZXJDb3VudCkudG9CZSgxMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHNvcnQgYnkgbWVtYmVycyBhc2NlbmRpbmcnLCAoKSA9PiB7XG4gICAgICBjb25zdCBhcHBseVNvcnRpbmcgPSAoc2VydmljZSBhcyBhbnkpLmFwcGx5U29ydGluZy5iaW5kKHNlcnZpY2UpO1xuICAgICAgY29uc3QgY29tbXVuaXRpZXMgPSBbLi4uc2FtcGxlQ29tbXVuaXRpZXNdO1xuICAgICAgXG4gICAgICBhcHBseVNvcnRpbmcoY29tbXVuaXRpZXMsICdtZW1iZXJzJywgJ2FzYycpO1xuXG4gICAgICBleHBlY3QoY29tbXVuaXRpZXNbMF0ubWVtYmVyQ291bnQpLnRvQmUoMTApO1xuICAgICAgZXhwZWN0KGNvbW11bml0aWVzWzFdLm1lbWJlckNvdW50KS50b0JlKDIwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc29ydCBieSBhY3Rpdml0eScsICgpID0+IHtcbiAgICAgIGNvbnN0IGFwcGx5U29ydGluZyA9IChzZXJ2aWNlIGFzIGFueSkuYXBwbHlTb3J0aW5nLmJpbmQoc2VydmljZSk7XG4gICAgICBjb25zdCBjb21tdW5pdGllcyA9IFsuLi5zYW1wbGVDb21tdW5pdGllc107XG4gICAgICBcbiAgICAgIGFwcGx5U29ydGluZyhjb21tdW5pdGllcywgJ2FjdGl2aXR5JywgJ2Rlc2MnKTtcblxuICAgICAgLy8gQ29tbXVuaXR5IDE6IDUgKyAxMCA9IDE1LCBDb21tdW5pdHkgMjogMyArIDcgPSAxMFxuICAgICAgZXhwZWN0KGNvbW11bml0aWVzWzBdLmlkKS50b0JlKCcxJyk7XG4gICAgICBleHBlY3QoY29tbXVuaXRpZXNbMV0uaWQpLnRvQmUoJzInKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc29ydCBieSBuZXdlc3QnLCAoKSA9PiB7XG4gICAgICBjb25zdCBhcHBseVNvcnRpbmcgPSAoc2VydmljZSBhcyBhbnkpLmFwcGx5U29ydGluZy5iaW5kKHNlcnZpY2UpO1xuICAgICAgY29uc3QgY29tbXVuaXRpZXMgPSBbLi4uc2FtcGxlQ29tbXVuaXRpZXNdO1xuICAgICAgXG4gICAgICBhcHBseVNvcnRpbmcoY29tbXVuaXRpZXMsICduZXdlc3QnLCAnZGVzYycpO1xuXG4gICAgICBleHBlY3QoY29tbXVuaXRpZXNbMF0uY3JlYXRlZEF0LmdldFRpbWUoKSkudG9CZShuZXcgRGF0ZSgnMjAyNC0wMS0wMicpLmdldFRpbWUoKSk7XG4gICAgICBleHBlY3QoY29tbXVuaXRpZXNbMV0uY3JlYXRlZEF0LmdldFRpbWUoKSkudG9CZShuZXcgRGF0ZSgnMjAyNC0wMS0wMScpLmdldFRpbWUoKSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHNvcnQgYWxwaGFiZXRpY2FsbHknLCAoKSA9PiB7XG4gICAgICBjb25zdCBhcHBseVNvcnRpbmcgPSAoc2VydmljZSBhcyBhbnkpLmFwcGx5U29ydGluZy5iaW5kKHNlcnZpY2UpO1xuICAgICAgY29uc3QgY29tbXVuaXRpZXMgPSBbLi4uc2FtcGxlQ29tbXVuaXRpZXNdO1xuICAgICAgXG4gICAgICBhcHBseVNvcnRpbmcoY29tbXVuaXRpZXMsICdhbHBoYWJldGljYWwnLCAnYXNjJyk7XG5cbiAgICAgIGV4cGVjdChjb21tdW5pdGllc1swXS5uYW1lKS50b0JlKCdBbHBoYSBDb21tdW5pdHknKTtcbiAgICAgIGV4cGVjdChjb21tdW5pdGllc1sxXS5uYW1lKS50b0JlKCdCZXRhIENvbW11bml0eScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBkZWZhdWx0IHRvIHJlbGV2YW5jZSBzb3J0aW5nIChtZW1iZXIgY291bnQpJywgKCkgPT4ge1xuICAgICAgY29uc3QgYXBwbHlTb3J0aW5nID0gKHNlcnZpY2UgYXMgYW55KS5hcHBseVNvcnRpbmcuYmluZChzZXJ2aWNlKTtcbiAgICAgIGNvbnN0IGNvbW11bml0aWVzID0gWy4uLnNhbXBsZUNvbW11bml0aWVzXTtcbiAgICAgIFxuICAgICAgYXBwbHlTb3J0aW5nKGNvbW11bml0aWVzLCAncmVsZXZhbmNlJywgJ2Rlc2MnKTtcblxuICAgICAgZXhwZWN0KGNvbW11bml0aWVzWzBdLm1lbWJlckNvdW50KS50b0JlKDIwKTtcbiAgICAgIGV4cGVjdChjb21tdW5pdGllc1sxXS5tZW1iZXJDb3VudCkudG9CZSgxMCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdjYWxjdWxhdGVTZWFyY2hGYWNldHMnLCAoKSA9PiB7XG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICBwcmlzbWFTZXJ2aWNlLmNvbW11bml0eS5jb3VudFxuICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKDUpICAvLyAxLTEwIHJhbmdlXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UoMykgIC8vIDExLTUwIHJhbmdlXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UoMikgIC8vIDUxLTEwMCByYW5nZVxuICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKDEpICAvLyAxMDEtNTAwIHJhbmdlXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UoMCk7IC8vIDUwMCsgcmFuZ2VcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY2FsY3VsYXRlIG1lbWJlciByYW5nZSBmYWNldHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBjYWxjdWxhdGVTZWFyY2hGYWNldHMgPSAoc2VydmljZSBhcyBhbnkpLmNhbGN1bGF0ZVNlYXJjaEZhY2V0cy5iaW5kKHNlcnZpY2UpO1xuICAgICAgXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjYWxjdWxhdGVTZWFyY2hGYWNldHMoe30pO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHtcbiAgICAgICAgbWVtYmVyUmFuZ2VzOiBbXG4gICAgICAgICAgeyByYW5nZTogJzEtMTAnLCBjb3VudDogNSB9LFxuICAgICAgICAgIHsgcmFuZ2U6ICcxMS01MCcsIGNvdW50OiAzIH0sXG4gICAgICAgICAgeyByYW5nZTogJzUxLTEwMCcsIGNvdW50OiAyIH0sXG4gICAgICAgICAgeyByYW5nZTogJzEwMS01MDAnLCBjb3VudDogMSB9LFxuICAgICAgICAgIHsgcmFuZ2U6ICc1MDArJywgY291bnQ6IDAgfSxcbiAgICAgICAgXSxcbiAgICAgICAgY29tbW9uVGFnczogW10sXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGVycm9ycyBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgcHJpc21hU2VydmljZS5jb21tdW5pdHkuY291bnQubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdEYXRhYmFzZSBlcnJvcicpKTtcblxuICAgICAgY29uc3QgY2FsY3VsYXRlU2VhcmNoRmFjZXRzID0gKHNlcnZpY2UgYXMgYW55KS5jYWxjdWxhdGVTZWFyY2hGYWNldHMuYmluZChzZXJ2aWNlKTtcbiAgICAgIGNvbnN0IGVycm9yU3B5ID0gamVzdC5zcHlPbihMb2dnZXIucHJvdG90eXBlLCAnZXJyb3InKS5tb2NrSW1wbGVtZW50YXRpb24oKTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2FsY3VsYXRlU2VhcmNoRmFjZXRzKHt9KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7XG4gICAgICAgIG1lbWJlclJhbmdlczogW10sXG4gICAgICAgIGNvbW1vblRhZ3M6IFtdLFxuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChlcnJvclNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICdFcnJvciBjYWxjdWxhdGluZyBzZWFyY2ggZmFjZXRzOicsXG4gICAgICAgIGV4cGVjdC5hbnkoRXJyb3IpXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZ2V0VG9wQ29udHJpYnV0b3JzJywgKCkgPT4ge1xuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja0NvbW11bml0eUZvckNvbnRyaWJ1dG9ycyA9IHtcbiAgICAgICAgaWQ6ICdjb21tdW5pdHktMTIzJyxcbiAgICAgICAgcm9vbUdyb3VwczogW1xuICAgICAgICAgIHsgcm9vbXM6IFt7IGlkOiAncm9vbS0xJyB9LCB7IGlkOiAncm9vbS0yJyB9XSB9LFxuICAgICAgICBdLFxuICAgICAgfTtcbiAgICAgIFxuICAgICAgcHJpc21hU2VydmljZS5jb21tdW5pdHkuZmluZFVuaXF1ZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrQ29tbXVuaXR5Rm9yQ29udHJpYnV0b3JzKTtcbiAgICAgIHByaXNtYVNlcnZpY2UudXNlci5maW5kTWFueS5tb2NrUmVzb2x2ZWRWYWx1ZShbXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogJ3VzZXItMScsXG4gICAgICAgICAgZmlyc3ROYW1lOiAnVG9wJyxcbiAgICAgICAgICBsYXN0TmFtZTogJ0NvbnRyaWJ1dG9yJyxcbiAgICAgICAgICBhdmF0YXJVcmw6ICd0b3AuanBnJyxcbiAgICAgICAgICBfY291bnQ6IHsgcG9zdHM6IDEwLCBjb21tZW50czogMjAgfSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAndXNlci0yJyxcbiAgICAgICAgICBmaXJzdE5hbWU6ICdTZWNvbmQnLFxuICAgICAgICAgIGxhc3ROYW1lOiAnQ29udHJpYnV0b3InLFxuICAgICAgICAgIGF2YXRhclVybDogJ3NlY29uZC5qcGcnLFxuICAgICAgICAgIF9jb3VudDogeyBwb3N0czogNSwgY29tbWVudHM6IDE1IH0sXG4gICAgICAgIH0sXG4gICAgICBdKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZ2V0IHRvcCBjb250cmlidXRvcnMgZm9yIGNvbW11bml0eScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGdldFRvcENvbnRyaWJ1dG9ycyA9IChzZXJ2aWNlIGFzIGFueSkuZ2V0VG9wQ29udHJpYnV0b3JzLmJpbmQoc2VydmljZSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdldFRvcENvbnRyaWJ1dG9ycygnY29tbXVuaXR5LTEyMycsIDUpO1xuXG4gICAgICBleHBlY3QocHJpc21hU2VydmljZS5jb21tdW5pdHkuZmluZFVuaXF1ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICB3aGVyZTogeyBpZDogJ2NvbW11bml0eS0xMjMnIH0sXG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICByb29tR3JvdXBzOiB7XG4gICAgICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgICAgIHJvb21zOiB7IHNlbGVjdDogeyBpZDogdHJ1ZSB9IH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChbXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogJ3VzZXItMScsXG4gICAgICAgICAgZmlyc3ROYW1lOiAnVG9wJyxcbiAgICAgICAgICBsYXN0TmFtZTogJ0NvbnRyaWJ1dG9yJyxcbiAgICAgICAgICBhdmF0YXJVcmw6ICd0b3AuanBnJyxcbiAgICAgICAgICBjb250cmlidXRpb25TY29yZTogNTAsIC8vIDEwICogMyArIDIwICogMVxuICAgICAgICAgIHBvc3RDb3VudDogMTAsXG4gICAgICAgICAgY29tbWVudENvdW50OiAyMCxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAndXNlci0yJyxcbiAgICAgICAgICBmaXJzdE5hbWU6ICdTZWNvbmQnLFxuICAgICAgICAgIGxhc3ROYW1lOiAnQ29udHJpYnV0b3InLFxuICAgICAgICAgIGF2YXRhclVybDogJ3NlY29uZC5qcGcnLFxuICAgICAgICAgIGNvbnRyaWJ1dGlvblNjb3JlOiAzMCwgLy8gNSAqIDMgKyAxNSAqIDFcbiAgICAgICAgICBwb3N0Q291bnQ6IDUsXG4gICAgICAgICAgY29tbWVudENvdW50OiAxNSxcbiAgICAgICAgfSxcbiAgICAgIF0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZW1wdHkgYXJyYXkgZm9yIG5vbi1leGlzdGVudCBjb21tdW5pdHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBwcmlzbWFTZXJ2aWNlLmNvbW11bml0eS5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpO1xuXG4gICAgICBjb25zdCBnZXRUb3BDb250cmlidXRvcnMgPSAoc2VydmljZSBhcyBhbnkpLmdldFRvcENvbnRyaWJ1dG9ycy5iaW5kKHNlcnZpY2UpO1xuICAgICAgXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRUb3BDb250cmlidXRvcnMoJ25vbi1leGlzdGVudCcsIDUpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKFtdKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZmlsdGVyIG91dCBjb250cmlidXRvcnMgd2l0aCB6ZXJvIGNvbnRyaWJ1dGlvbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBwcmlzbWFTZXJ2aWNlLnVzZXIuZmluZE1hbnkubW9ja1Jlc29sdmVkVmFsdWUoW1xuICAgICAgICB7XG4gICAgICAgICAgaWQ6ICd1c2VyLWFjdGl2ZScsXG4gICAgICAgICAgZmlyc3ROYW1lOiAnQWN0aXZlJyxcbiAgICAgICAgICBsYXN0TmFtZTogJ1VzZXInLFxuICAgICAgICAgIGF2YXRhclVybDogJ2FjdGl2ZS5qcGcnLFxuICAgICAgICAgIF9jb3VudDogeyBwb3N0czogNSwgY29tbWVudHM6IDEwIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogJ3VzZXItaW5hY3RpdmUnLFxuICAgICAgICAgIGZpcnN0TmFtZTogJ0luYWN0aXZlJyxcbiAgICAgICAgICBsYXN0TmFtZTogJ1VzZXInLFxuICAgICAgICAgIGF2YXRhclVybDogJ2luYWN0aXZlLmpwZycsXG4gICAgICAgICAgX2NvdW50OiB7IHBvc3RzOiAwLCBjb21tZW50czogMCB9LFxuICAgICAgICB9LFxuICAgICAgXSk7XG5cbiAgICAgIGNvbnN0IGdldFRvcENvbnRyaWJ1dG9ycyA9IChzZXJ2aWNlIGFzIGFueSkuZ2V0VG9wQ29udHJpYnV0b3JzLmJpbmQoc2VydmljZSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdldFRvcENvbnRyaWJ1dG9ycygnY29tbXVuaXR5LTEyMycsIDUpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVMZW5ndGgoMSk7XG4gICAgICBleHBlY3QocmVzdWx0WzBdLmlkKS50b0JlKCd1c2VyLWFjdGl2ZScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZXJyb3JzIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBwcmlzbWFTZXJ2aWNlLmNvbW11bml0eS5maW5kVW5pcXVlLm1vY2tSZWplY3RlZFZhbHVlKG5ldyBFcnJvcignRGF0YWJhc2UgZXJyb3InKSk7XG5cbiAgICAgIGNvbnN0IGdldFRvcENvbnRyaWJ1dG9ycyA9IChzZXJ2aWNlIGFzIGFueSkuZ2V0VG9wQ29udHJpYnV0b3JzLmJpbmQoc2VydmljZSk7XG4gICAgICBjb25zdCBlcnJvclNweSA9IGplc3Quc3B5T24oTG9nZ2VyLnByb3RvdHlwZSwgJ2Vycm9yJykubW9ja0ltcGxlbWVudGF0aW9uKCk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdldFRvcENvbnRyaWJ1dG9ycygnY29tbXVuaXR5LTEyMycsIDUpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKFtdKTtcbiAgICAgIGV4cGVjdChlcnJvclNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCdFcnJvciBnZXR0aW5nIHRvcCBjb250cmlidXRvcnMgZm9yIGNvbW11bml0eSBjb21tdW5pdHktMTIzJyksXG4gICAgICAgIGV4cGVjdC5hbnkoRXJyb3IpXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBsaW1pdCByZXN1bHRzIHRvIHNwZWNpZmllZCBsaW1pdCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGdldFRvcENvbnRyaWJ1dG9ycyA9IChzZXJ2aWNlIGFzIGFueSkuZ2V0VG9wQ29udHJpYnV0b3JzLmJpbmQoc2VydmljZSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdldFRvcENvbnRyaWJ1dG9ycygnY29tbXVuaXR5LTEyMycsIDEpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVMZW5ndGgoMSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBtaXNzaW5nIGF2YXRhclVybCcsIGFzeW5jICgpID0+IHtcbiAgICAgIHByaXNtYVNlcnZpY2UudXNlci5maW5kTWFueS5tb2NrUmVzb2x2ZWRWYWx1ZShbXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogJ3VzZXItbm8tYXZhdGFyJyxcbiAgICAgICAgICBmaXJzdE5hbWU6ICdObycsXG4gICAgICAgICAgbGFzdE5hbWU6ICdBdmF0YXInLFxuICAgICAgICAgIGF2YXRhclVybDogbnVsbCxcbiAgICAgICAgICBfY291bnQ6IHsgcG9zdHM6IDUsIGNvbW1lbnRzOiAxMCB9LFxuICAgICAgICB9LFxuICAgICAgXSk7XG5cbiAgICAgIGNvbnN0IGdldFRvcENvbnRyaWJ1dG9ycyA9IChzZXJ2aWNlIGFzIGFueSkuZ2V0VG9wQ29udHJpYnV0b3JzLmJpbmQoc2VydmljZSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdldFRvcENvbnRyaWJ1dG9ycygnY29tbXVuaXR5LTEyMycsIDUpO1xuXG4gICAgICBleHBlY3QocmVzdWx0WzBdLmF2YXRhclVybCkudG9CZVVuZGVmaW5lZCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZWRnZSBjYXNlcyBhbmQgcGVyZm9ybWFuY2UnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgdmVyeSBsYXJnZSBzZWFyY2ggcmVzdWx0cyBlZmZpY2llbnRseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGxhcmdlQ29tbXVuaXR5TGlzdCA9IEFycmF5LmZyb20oeyBsZW5ndGg6IDEwMDAgfSwgKF8sIGkpID0+ICh7XG4gICAgICAgIGlkOiBgY29tbXVuaXR5LSR7aX1gLFxuICAgICAgICBuYW1lOiBgQ29tbXVuaXR5ICR7aX1gLFxuICAgICAgICBzbHVnOiBgY29tbXVuaXR5LSR7aX1gLFxuICAgICAgICBkZXNjcmlwdGlvbjogYERlc2NyaXB0aW9uICR7aX1gLFxuICAgICAgICBpbWFnZVVybDogYGltYWdlLSR7aX0uanBnYCxcbiAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgnMjAyNC0wMS0wMScpLFxuICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCcyMDI0LTAxLTAxJyksXG4gICAgICAgIF9jb3VudDogeyBtZW1iZXJzaGlwczogaSAlIDEwMCB9LFxuICAgICAgICBtZW1iZXJzaGlwczogW10sXG4gICAgICB9KSk7XG5cbiAgICAgIHByaXNtYVNlcnZpY2UuY29tbXVuaXR5LmZpbmRNYW55Lm1vY2tSZXNvbHZlZFZhbHVlKGxhcmdlQ29tbXVuaXR5TGlzdCk7XG4gICAgICBwcmlzbWFTZXJ2aWNlLmNvbW11bml0eS5jb3VudC5tb2NrUmVzb2x2ZWRWYWx1ZSgxMDAwKTtcblxuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2Uuc2VhcmNoQ29tbXVuaXRpZXMoe30sICd1c2VyLTEyMycsIDEsIDIwKTtcbiAgICAgIGNvbnN0IGVuZFRpbWUgPSBEYXRlLm5vdygpO1xuXG4gICAgICBleHBlY3QocmVzdWx0LmNvbW11bml0aWVzKS50b0hhdmVMZW5ndGgoMjApO1xuICAgICAgZXhwZWN0KGVuZFRpbWUgLSBzdGFydFRpbWUpLnRvQmVMZXNzVGhhbigyMDAwKTsgLy8gU2hvdWxkIGNvbXBsZXRlIHdpdGhpbiAyIHNlY29uZHNcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG1pc3NpbmcgZGF0YSBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY29tbXVuaXR5V2l0aE1pc3NpbmdEYXRhID0ge1xuICAgICAgICBpZDogJ2NvbW11bml0eS1taXNzaW5nJyxcbiAgICAgICAgbmFtZTogbnVsbCxcbiAgICAgICAgc2x1ZzogJ21pc3NpbmctZGF0YScsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnJyxcbiAgICAgICAgaW1hZ2VVcmw6IG51bGwsXG4gICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoJzIwMjQtMDEtMDEnKSxcbiAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgnMjAyNC0wMS0wMScpLFxuICAgICAgICBfY291bnQ6IHsgbWVtYmVyc2hpcHM6IDAgfSxcbiAgICAgICAgbWVtYmVyc2hpcHM6IFtdLFxuICAgICAgfTtcblxuICAgICAgcHJpc21hU2VydmljZS5jb21tdW5pdHkuZmluZE1hbnkubW9ja1Jlc29sdmVkVmFsdWUoW2NvbW11bml0eVdpdGhNaXNzaW5nRGF0YV0pO1xuICAgICAgcHJpc21hU2VydmljZS5jb21tdW5pdHkuY291bnQubW9ja1Jlc29sdmVkVmFsdWUoMSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2Uuc2VhcmNoQ29tbXVuaXRpZXMoe30sICd1c2VyLTEyMycsIDEsIDEwKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5jb21tdW5pdGllcykudG9IYXZlTGVuZ3RoKDEpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5jb21tdW5pdGllc1swXS5uYW1lKS50b0JlTnVsbCgpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5jb21tdW5pdGllc1swXS5pbWFnZVVybCkudG9CZU51bGwoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbmN1cnJlbnQgcmVxdWVzdHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBwcmlzbWFTZXJ2aWNlLmNvbW11bml0eS5maW5kTWFueS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrQ29tbXVuaXRpZXMpO1xuICAgICAgcHJpc21hU2VydmljZS5jb21tdW5pdHkuY291bnQubW9ja1Jlc29sdmVkVmFsdWUoMyk7XG5cbiAgICAgIGNvbnN0IHByb21pc2VzID0gW1xuICAgICAgICBzZXJ2aWNlLnNlYXJjaENvbW11bml0aWVzKHt9LCAndXNlci0xJyksXG4gICAgICAgIHNlcnZpY2Uuc2VhcmNoQ29tbXVuaXRpZXMoe30sICd1c2VyLTInKSxcbiAgICAgICAgc2VydmljZS5zZWFyY2hDb21tdW5pdGllcyh7fSwgJ3VzZXItMycpLFxuICAgICAgXTtcblxuICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IFByb21pc2UuYWxsKHByb21pc2VzKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdHMpLnRvSGF2ZUxlbmd0aCgzKTtcbiAgICAgIHJlc3VsdHMuZm9yRWFjaChyZXN1bHQgPT4ge1xuICAgICAgICBleHBlY3QocmVzdWx0LmNvbW11bml0aWVzKS50b0JlSW5zdGFuY2VPZihBcnJheSk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG1hbGZvcm1lZCBmaWx0ZXIgb2JqZWN0cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1hbGZvcm1lZEZpbHRlcnMgPSB7XG4gICAgICAgIHF1ZXJ5OiBudWxsLFxuICAgICAgICBtaW5NZW1iZXJzOiAnaW52YWxpZCcsXG4gICAgICAgIG1heE1lbWJlcnM6IHt9LFxuICAgICAgICBzb3J0Qnk6IFtdLFxuICAgICAgfSBhcyBhbnk7XG5cbiAgICAgIHByaXNtYVNlcnZpY2UuY29tbXVuaXR5LmZpbmRNYW55Lm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tDb21tdW5pdGllcyk7XG4gICAgICBwcmlzbWFTZXJ2aWNlLmNvbW11bml0eS5jb3VudC5tb2NrUmVzb2x2ZWRWYWx1ZSgzKTtcblxuICAgICAgLy8gU2hvdWxkIG5vdCB0aHJvdyBlcnJvclxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5zZWFyY2hDb21tdW5pdGllcyhtYWxmb3JtZWRGaWx0ZXJzLCAndXNlci0xMjMnKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuY29tbXVuaXRpZXMpLnRvQmVJbnN0YW5jZU9mKEFycmF5KTtcbiAgICB9KTtcbiAgfSk7XG59KTsiXSwidmVyc2lvbiI6M30=