b3fc1d64d813797e1829b1572a863c4b
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var AnalyticsService_1;
var _a;
Object.defineProperty(exports, "__esModule", { value: true });
exports.AnalyticsService = void 0;
const common_1 = require("@nestjs/common");
const prisma_client_provider_1 = require("../providers/prisma-client.provider");
let AnalyticsService = AnalyticsService_1 = class AnalyticsService {
    prisma;
    logger = new common_1.Logger(AnalyticsService_1.name);
    constructor(prisma) {
        this.prisma = prisma;
    }
    async getPlatformAnalytics(startDate, endDate) {
        try {
            const dateFilter = {};
            if (startDate)
                dateFilter['gte'] = startDate;
            if (endDate)
                dateFilter['lte'] = endDate;
            const whereDate = Object.keys(dateFilter).length > 0 ? { createdAt: dateFilter } : {};
            const [totalUsers, newUsers, totalTherapists, newTherapists, totalMeetings, completedMeetings, totalPosts, newPosts, totalCommunities, activeCommunities,] = await Promise.all([
                this.prisma.user.count(),
                this.prisma.user.count({ where: whereDate }),
                this.prisma.therapist.count({ where: { status: 'APPROVED' } }),
                this.prisma.therapist.count({
                    where: {
                        status: 'APPROVED',
                        ...whereDate,
                    },
                }),
                this.prisma.meeting.count(),
                this.prisma.meeting.count({ where: { status: 'COMPLETED' } }),
                this.prisma.post.count(),
                this.prisma.post.count({ where: whereDate }),
                this.prisma.community.count(),
                this.prisma.community.count({
                    where: {
                        roomGroups: {
                            some: {
                                rooms: {
                                    some: {
                                        posts: {
                                            some: whereDate,
                                        },
                                    },
                                },
                            },
                        },
                    },
                }),
            ]);
            const userGrowth = await this.getUserGrowthStats(startDate, endDate);
            const engagementStats = await this.getEngagementStats(startDate, endDate);
            const sessionStats = await this.getSessionStats(startDate, endDate);
            return {
                overview: {
                    totalUsers,
                    newUsers,
                    totalTherapists,
                    newTherapists,
                    totalMeetings,
                    completedMeetings,
                    meetingCompletionRate: totalMeetings > 0 ? (completedMeetings / totalMeetings) * 100 : 0,
                    totalPosts,
                    newPosts,
                    totalCommunities,
                    activeCommunities,
                },
                userGrowth,
                engagement: engagementStats,
                sessions: sessionStats,
            };
        }
        catch (error) {
            this.logger.error(`Failed to get platform analytics: ${String(error)}`);
            throw new common_1.InternalServerErrorException('Failed to retrieve platform analytics');
        }
    }
    async getUserGrowthStats(startDate, endDate) {
        try {
            const dateFilter = {};
            if (startDate)
                dateFilter['gte'] = startDate;
            if (endDate)
                dateFilter['lte'] = endDate;
            const whereDate = Object.keys(dateFilter).length > 0 ? { createdAt: dateFilter } : {};
            const usersByRole = await this.prisma.user.groupBy({
                by: ['role'],
                where: whereDate,
                _count: { role: true },
            });
            const monthlyGrowth = await this.prisma.$queryRaw `
        SELECT 
          DATE_TRUNC('month', "createdAt") as month,
          COUNT(*) as count,
          role
        FROM "User"
        ${whereDate.createdAt ? 'WHERE "createdAt" >= $1 AND "createdAt" <= $2' : ''}
        GROUP BY month, role
        ORDER BY month DESC
        LIMIT 12
      `;
            return {
                byRole: usersByRole,
                monthlyGrowth,
            };
        }
        catch (error) {
            throw new common_1.InternalServerErrorException(`Failed to get user growth stats: ${error instanceof Error ? error.message : String(error)}`);
        }
    }
    async getEngagementStats(startDate, endDate) {
        try {
            const dateFilter = {};
            if (startDate)
                dateFilter['gte'] = startDate;
            if (endDate)
                dateFilter['lte'] = endDate;
            const whereDate = Object.keys(dateFilter).length > 0 ? { createdAt: dateFilter } : {};
            const [totalPosts, totalComments, totalHearts, activeCommunities, activeUsers,] = await Promise.all([
                this.prisma.post.count({ where: whereDate }),
                this.prisma.comment.count({ where: whereDate }),
                this.prisma.postHeart.count({ where: whereDate }),
                this.prisma.community.count({
                    where: {
                        roomGroups: {
                            some: {
                                rooms: {
                                    some: {
                                        posts: {
                                            some: whereDate,
                                        },
                                    },
                                },
                            },
                        },
                    },
                }),
                this.prisma.user.count({
                    where: {
                        OR: [
                            { posts: { some: whereDate } },
                            { comments: { some: whereDate } },
                            { postHearts: { some: whereDate } },
                        ],
                    },
                }),
            ]);
            const topCommunities = await this.prisma.community.findMany({
                include: {
                    _count: {
                        select: {
                            memberships: true,
                        },
                    },
                },
                orderBy: {
                    memberships: {
                        _count: 'desc',
                    },
                },
                take: 10,
            });
            return {
                overview: {
                    totalPosts,
                    totalComments,
                    totalHearts,
                    activeCommunities,
                    activeUsers,
                    engagementRate: activeUsers > 0
                        ? (totalPosts + totalComments + totalHearts) / activeUsers
                        : 0,
                },
                topCommunities,
            };
        }
        catch (error) {
            throw new common_1.InternalServerErrorException(`Failed to get engagement stats: ${error instanceof Error ? error.message : String(error)}`);
        }
    }
    async getSessionStats(startDate, endDate) {
        try {
            const dateFilter = {};
            if (startDate)
                dateFilter['gte'] = startDate;
            if (endDate)
                dateFilter['lte'] = endDate;
            const whereDate = Object.keys(dateFilter).length > 0 ? { startTime: dateFilter } : {};
            const [totalSessions, completedSessions, averageDuration, sessionsByType,] = await Promise.all([
                this.prisma.meeting.count({ where: whereDate }),
                this.prisma.meeting.count({
                    where: { ...whereDate, status: 'COMPLETED' },
                }),
                this.prisma.meeting.aggregate({
                    where: { ...whereDate, status: 'COMPLETED' },
                    _avg: { duration: true },
                }),
                this.prisma.meeting.groupBy({
                    by: ['meetingType'],
                    where: whereDate,
                    _count: { meetingType: true },
                }),
            ]);
            const therapistPerformance = await this.prisma.meeting.groupBy({
                by: ['therapistId'],
                where: { ...whereDate, status: 'COMPLETED' },
                _count: { therapistId: true },
                orderBy: { _count: { therapistId: 'desc' } },
                take: 10,
            });
            return {
                overview: {
                    totalSessions,
                    completedSessions,
                    completionRate: totalSessions > 0 ? (completedSessions / totalSessions) * 100 : 0,
                    averageDuration: averageDuration._avg.duration || 0,
                },
                sessionsByType,
                topTherapists: therapistPerformance,
            };
        }
        catch (error) {
            throw new common_1.InternalServerErrorException(`Failed to get session stats: ${error instanceof Error ? error.message : String(error)}`);
        }
    }
    async getTherapistAnalytics(therapistId, startDate, endDate) {
        try {
            const dateFilter = {};
            if (startDate)
                dateFilter['gte'] = startDate;
            if (endDate)
                dateFilter['lte'] = endDate;
            const whereDate = Object.keys(dateFilter).length > 0 ? { startTime: dateFilter } : {};
            const [totalClients, activeSessions, completedSessions, averageRating, worksheetsAssigned, worksheetsCompleted,] = await Promise.all([
                this.prisma.clientTherapist.count({
                    where: { therapistId },
                }),
                this.prisma.meeting.count({
                    where: { therapistId, ...whereDate },
                }),
                this.prisma.meeting.count({
                    where: { therapistId, status: 'COMPLETED', ...whereDate },
                }),
                this.prisma.review.aggregate({
                    where: {
                        therapistId,
                        ...(startDate || endDate
                            ? {
                                createdAt: {
                                    ...(startDate && { gte: startDate }),
                                    ...(endDate && { lte: endDate }),
                                },
                            }
                            : {})
                    },
                    _avg: { rating: true },
                }),
                this.prisma.worksheet.count({
                    where: {
                        therapistId,
                        ...(startDate || endDate
                            ? {
                                createdAt: {
                                    ...(startDate && { gte: startDate }),
                                    ...(endDate && { lte: endDate }),
                                },
                            }
                            : {}),
                    },
                }),
                this.prisma.worksheet.count({
                    where: {
                        therapistId,
                        status: 'SUBMITTED',
                        ...(startDate || endDate
                            ? {
                                updatedAt: {
                                    ...(startDate && { gte: startDate }),
                                    ...(endDate && { lte: endDate }),
                                },
                            }
                            : {}),
                    },
                }),
            ]);
            // Get recent client activities instead of therapy progress
            const recentClientActivities = await this.prisma.clientTherapist.findMany({
                where: {
                    therapistId,
                },
                include: {
                    client: {
                        include: {
                            user: {
                                select: {
                                    id: true,
                                    firstName: true,
                                    lastName: true,
                                    email: true,
                                }
                            }
                        },
                    },
                },
                orderBy: { assignedAt: 'desc' },
                take: 10,
            });
            return {
                overview: {
                    totalClients,
                    activeSessions,
                    completedSessions,
                    sessionCompletionRate: activeSessions > 0 ? (completedSessions / activeSessions) * 100 : 0,
                    averageRating: averageRating._avg.rating || 0,
                    worksheetsAssigned,
                    worksheetsCompleted,
                    worksheetCompletionRate: worksheetsAssigned > 0
                        ? (worksheetsCompleted / worksheetsAssigned) * 100
                        : 0,
                },
                recentClients: recentClientActivities,
            };
        }
        catch (error) {
            throw new common_1.InternalServerErrorException(`Failed to get therapist analytics: ${error instanceof Error ? error.message : String(error)}`);
        }
    }
    async getClientAnalytics(clientId, startDate, endDate) {
        try {
            const dateFilter = {};
            if (startDate)
                dateFilter['gte'] = startDate;
            if (endDate)
                dateFilter['lte'] = endDate;
            const whereDate = Object.keys(dateFilter).length > 0 ? { startTime: dateFilter } : {};
            const [totalSessions, completedSessions, averageSessionRating, worksheetsAssigned, worksheetsCompleted, communityPosts, communityEngagement,] = await Promise.all([
                this.prisma.meeting.count({
                    where: { clientId, ...whereDate },
                }),
                this.prisma.meeting.count({
                    where: { clientId, status: 'COMPLETED', ...whereDate },
                }),
                this.prisma.review.aggregate({
                    where: {
                        clientId,
                        ...(startDate || endDate
                            ? {
                                createdAt: {
                                    ...(startDate && { gte: startDate }),
                                    ...(endDate && { lte: endDate }),
                                },
                            }
                            : {})
                    },
                    _avg: { rating: true },
                }),
                this.prisma.worksheet.count({
                    where: {
                        clientId,
                        ...(startDate || endDate
                            ? {
                                createdAt: {
                                    ...(startDate && { gte: startDate }),
                                    ...(endDate && { lte: endDate }),
                                },
                            }
                            : {}),
                    },
                }),
                this.prisma.worksheet.count({
                    where: {
                        clientId,
                        status: 'SUBMITTED',
                        ...(startDate || endDate
                            ? {
                                updatedAt: {
                                    ...(startDate && { gte: startDate }),
                                    ...(endDate && { lte: endDate }),
                                },
                            }
                            : {}),
                    },
                }),
                this.prisma.post.count({
                    where: {
                        userId: clientId,
                        ...(startDate || endDate
                            ? {
                                createdAt: {
                                    ...(startDate && { gte: startDate }),
                                    ...(endDate && { lte: endDate }),
                                },
                            }
                            : {}),
                    },
                }),
                this.prisma.comment.count({
                    where: {
                        userId: clientId,
                        ...(startDate || endDate
                            ? {
                                createdAt: {
                                    ...(startDate && { gte: startDate }),
                                    ...(endDate && { lte: endDate }),
                                },
                            }
                            : {}),
                    },
                }),
            ]);
            // Get recent activity history instead of therapy progress
            const recentActivityHistory = await this.prisma.worksheet.findMany({
                where: {
                    clientId,
                    ...(startDate || endDate
                        ? {
                            createdAt: {
                                ...(startDate && { gte: startDate }),
                                ...(endDate && { lte: endDate }),
                            },
                        }
                        : {}),
                },
                include: {
                    therapist: {
                        include: {
                            user: {
                                select: {
                                    id: true,
                                    firstName: true,
                                    lastName: true,
                                }
                            }
                        }
                    },
                    submission: true,
                },
                orderBy: { createdAt: 'desc' },
                take: 10,
            });
            return {
                overview: {
                    totalSessions,
                    completedSessions,
                    sessionCompletionRate: totalSessions > 0 ? (completedSessions / totalSessions) * 100 : 0,
                    averageSessionRating: averageSessionRating._avg.rating || 0,
                    worksheetsAssigned,
                    worksheetsCompleted,
                    worksheetCompletionRate: worksheetsAssigned > 0
                        ? (worksheetsCompleted / worksheetsAssigned) * 100
                        : 0,
                    communityPosts,
                    communityEngagement,
                },
                recentActivity: recentActivityHistory,
            };
        }
        catch (error) {
            throw new common_1.InternalServerErrorException(`Failed to get client analytics: ${error instanceof Error ? error.message : String(error)}`);
        }
    }
};
exports.AnalyticsService = AnalyticsService;
exports.AnalyticsService = AnalyticsService = AnalyticsService_1 = __decorate([
    (0, common_1.Injectable)(),
    __metadata("design:paramtypes", [typeof (_a = typeof prisma_client_provider_1.PrismaService !== "undefined" && prisma_client_provider_1.PrismaService) === "function" ? _a : Object])
], AnalyticsService);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL2FuYWx5dGljcy9hbmFseXRpY3Muc2VydmljZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFBLDJDQUl3QjtBQUN4QixnRkFBb0U7QUFHN0QsSUFBTSxnQkFBZ0Isd0JBQXRCLE1BQU0sZ0JBQWdCO0lBR0U7SUFGWixNQUFNLEdBQUcsSUFBSSxlQUFNLENBQUMsa0JBQWdCLENBQUMsSUFBSSxDQUFDLENBQUM7SUFFNUQsWUFBNkIsTUFBcUI7UUFBckIsV0FBTSxHQUFOLE1BQU0sQ0FBZTtJQUFHLENBQUM7SUFFdEQsS0FBSyxDQUFDLG9CQUFvQixDQUFDLFNBQWdCLEVBQUUsT0FBYztRQUN6RCxJQUFJLENBQUM7WUFDSCxNQUFNLFVBQVUsR0FBRyxFQUFFLENBQUM7WUFDdEIsSUFBSSxTQUFTO2dCQUFFLFVBQVUsQ0FBQyxLQUFLLENBQUMsR0FBRyxTQUFTLENBQUM7WUFDN0MsSUFBSSxPQUFPO2dCQUFFLFVBQVUsQ0FBQyxLQUFLLENBQUMsR0FBRyxPQUFPLENBQUM7WUFFekMsTUFBTSxTQUFTLEdBQ2IsTUFBTSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDO1lBRXRFLE1BQU0sQ0FDSixVQUFVLEVBQ1YsUUFBUSxFQUNSLGVBQWUsRUFDZixhQUFhLEVBQ2IsYUFBYSxFQUNiLGlCQUFpQixFQUNqQixVQUFVLEVBQ1YsUUFBUSxFQUNSLGdCQUFnQixFQUNoQixpQkFBaUIsRUFDbEIsR0FBRyxNQUFNLE9BQU8sQ0FBQyxHQUFHLENBQUM7Z0JBQ3BCLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRTtnQkFDeEIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEVBQUUs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Q0FBQyxDQUFDLENBQUMsQ0FBQyxpQkFBaUIsR0FBRyxhQUFhLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7b0JBQ25FLG9CQUFvQixFQUFFLG9CQUFvQixDQUFDLElBQUksQ0FBQyxNQUFNLElBQUksQ0FBQztvQkFDM0Qsa0JBQWtCO29CQUNsQixtQkFBbUI7b0JBQ25CLHVCQUF1QixFQUNyQixrQkFBa0IsR0FBRyxDQUFDO3dCQUNwQixDQUFDLENBQUMsQ0FBQyxtQkFBbUIsR0FBRyxrQkFBa0IsQ0FBQyxHQUFHLEdBQUc7d0JBQ2xELENBQUMsQ0FBQyxDQUFDO29CQUNQLGNBQWM7b0JBQ2QsbUJBQW1CO2lCQUNwQjtnQkFDRCxjQUFjLEVBQUUscUJBQXFCO2FBQ3RDLENBQUM7UUFDSixDQUFDO1FBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztZQUNmLE1BQU0sSUFBSSxxQ0FBNEIsQ0FDcEMsbUNBQW1DLEtBQUssWUFBWSxLQUFLLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUM1RixDQUFDO1FBQ0osQ0FBQztJQUNILENBQUM7Q0FDRixDQUFBO0FBcGhCWSw0Q0FBZ0I7MkJBQWhCLGdCQUFnQjtJQUQ1QixJQUFBLG1CQUFVLEdBQUU7eURBSTBCLHNDQUFhLG9CQUFiLHNDQUFhO0dBSHZDLGdCQUFnQixDQW9oQjVCIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9ob21lL3dldG9vYS9Eb2N1bWVudHMvY29kZS9wcm9qZWN0cy9tZW50YXJhL21lbnRhcmEtYXBpL3NyYy9hbmFseXRpY3MvYW5hbHl0aWNzLnNlcnZpY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgSW5qZWN0YWJsZSxcbiAgSW50ZXJuYWxTZXJ2ZXJFcnJvckV4Y2VwdGlvbixcbiAgTG9nZ2VyLFxufSBmcm9tICdAbmVzdGpzL2NvbW1vbic7XG5pbXBvcnQgeyBQcmlzbWFTZXJ2aWNlIH0gZnJvbSAnLi4vcHJvdmlkZXJzL3ByaXNtYS1jbGllbnQucHJvdmlkZXInO1xuXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgQW5hbHl0aWNzU2VydmljZSB7XG4gIHByaXZhdGUgcmVhZG9ubHkgbG9nZ2VyID0gbmV3IExvZ2dlcihBbmFseXRpY3NTZXJ2aWNlLm5hbWUpO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgcmVhZG9ubHkgcHJpc21hOiBQcmlzbWFTZXJ2aWNlKSB7fVxuXG4gIGFzeW5jIGdldFBsYXRmb3JtQW5hbHl0aWNzKHN0YXJ0RGF0ZT86IERhdGUsIGVuZERhdGU/OiBEYXRlKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGRhdGVGaWx0ZXIgPSB7fTtcbiAgICAgIGlmIChzdGFydERhdGUpIGRhdGVGaWx0ZXJbJ2d0ZSddID0gc3RhcnREYXRlO1xuICAgICAgaWYgKGVuZERhdGUpIGRhdGVGaWx0ZXJbJ2x0ZSddID0gZW5kRGF0ZTtcblxuICAgICAgY29uc3Qgd2hlcmVEYXRlID1cbiAgICAgICAgT2JqZWN0LmtleXMoZGF0ZUZpbHRlcikubGVuZ3RoID4gMCA/IHsgY3JlYXRlZEF0OiBkYXRlRmlsdGVyIH0gOiB7fTtcblxuICAgICAgY29uc3QgW1xuICAgICAgICB0b3RhbFVzZXJzLFxuICAgICAgICBuZXdVc2VycyxcbiAgICAgICAgdG90YWxUaGVyYXBpc3RzLFxuICAgICAgICBuZXdUaGVyYXBpc3RzLFxuICAgICAgICB0b3RhbE1lZXRpbmdzLFxuICAgICAgICBjb21wbGV0ZWRNZWV0aW5ncyxcbiAgICAgICAgdG90YWxQb3N0cyxcbiAgICAgICAgbmV3UG9zdHMsXG4gICAgICAgIHRvdGFsQ29tbXVuaXRpZXMsXG4gICAgICAgIGFjdGl2ZUNvbW11bml0aWVzLFxuICAgICAgXSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICAgICAgdGhpcy5wcmlzbWEudXNlci5jb3VudCgpLFxuICAgICAgICB0aGlzLnByaXNtYS51c2VyLmNvdW50KHsgd2hlcmU6IHdoZXJlRGF0ZSB9KSxcbiAgICAgICAgdGhpcy5wcmlzbWEudGhlcmFwaXN0LmNvdW50KHsgd2hlcmU6IHsgc3RhdHVzOiAnQVBQUk9WRUQnIH0gfSksXG4gICAgICAgIHRoaXMucHJpc21hLnRoZXJhcGlzdC5jb3VudCh7XG4gICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgIHN0YXR1czogJ0FQUFJPVkVEJyxcbiAgICAgICAgICAgIC4uLndoZXJlRGF0ZSxcbiAgICAgICAgICB9LFxuICAgICAgICB9KSxcbiAgICAgICAgdGhpcy5wcmlzbWEubWVldGluZy5jb3VudCgpLFxuICAgICAgICB0aGlzLnByaXNtYS5tZWV0aW5nLmNvdW50KHsgd2hlcmU6IHsgc3RhdHVzOiAnQ09NUExFVEVEJyB9IH0pLFxuICAgICAgICB0aGlzLnByaXNtYS5wb3N0LmNvdW50KCksXG4gICAgICAgIHRoaXMucHJpc21hLnBvc3QuY291bnQoeyB3aGVyZTogd2hlcmVEYXRlIH0pLFxuICAgICAgICB0aGlzLnByaXNtYS5jb21tdW5pdHkuY291bnQoKSxcbiAgICAgICAgdGhpcy5wcmlzbWEuY29tbXVuaXR5LmNvdW50KHtcbiAgICAgICAgICB3aGVyZToge1xuICAgICAgICAgICAgcm9vbUdyb3Vwczoge1xuICAgICAgICAgICAgICBzb21lOiB7XG4gICAgICAgICAgICAgICAgcm9vbXM6IHtcbiAgICAgICAgICAgICAgICAgIHNvbWU6IHtcbiAgICAgICAgICAgICAgICAgICAgcG9zdHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICBzb21lOiB3aGVyZURhdGUsXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pLFxuICAgICAgXSk7XG5cbiAgICAgIGNvbnN0IHVzZXJHcm93dGggPSBhd2FpdCB0aGlzLmdldFVzZXJHcm93dGhTdGF0cyhzdGFydERhdGUsIGVuZERhdGUpO1xuICAgICAgY29uc3QgZW5nYWdlbWVudFN0YXRzID0gYXdhaXQgdGhpcy5nZXRFbmdhZ2VtZW50U3RhdHMoc3RhcnREYXRlLCBlbmREYXRlKTtcbiAgICAgIGNvbnN0IHNlc3Npb25TdGF0cyA9IGF3YWl0IHRoaXMuZ2V0U2Vzc2lvblN0YXRzKHN0YXJ0RGF0ZSwgZW5kRGF0ZSk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIG92ZXJ2aWV3OiB7XG4gICAgICAgICAgdG90YWxVc2VycyxcbiAgICAgICAgICBuZXdVc2VycyxcbiAgICAgICAgICB0b3RhbFRoZXJhcGlzdHMsXG4gICAgICAgICAgbmV3VGhlcmFwaXN0cyxcbiAgICAgICAgICB0b3RhbE1lZXRpbmdzLFxuICAgICAgICAgIGNvbXBsZXRlZE1lZXRpbmdzLFxuICAgICAgICAgIG1lZXRpbmdDb21wbGV0aW9uUmF0ZTpcbiAgICAgICAgICAgIHRvdGFsTWVldGluZ3MgPiAwID8gKGNvbXBsZXRlZE1lZXRpbmdzIC8gdG90YWxNZWV0aW5ncykgKiAxMDAgOiAwLFxuICAgICAgICAgIHRvdGFsUG9zdHMsXG4gICAgICAgICAgbmV3UG9zdHMsXG4gICAgICAgICAgdG90YWxDb21tdW5pdGllcyxcbiAgICAgICAgICBhY3RpdmVDb21tdW5pdGllcyxcbiAgICAgICAgfSxcbiAgICAgICAgdXNlckdyb3d0aCxcbiAgICAgICAgZW5nYWdlbWVudDogZW5nYWdlbWVudFN0YXRzLFxuICAgICAgICBzZXNzaW9uczogc2Vzc2lvblN0YXRzLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoYEZhaWxlZCB0byBnZXQgcGxhdGZvcm0gYW5hbHl0aWNzOiAke1N0cmluZyhlcnJvcil9YCk7XG4gICAgICB0aHJvdyBuZXcgSW50ZXJuYWxTZXJ2ZXJFcnJvckV4Y2VwdGlvbihcbiAgICAgICAgJ0ZhaWxlZCB0byByZXRyaWV2ZSBwbGF0Zm9ybSBhbmFseXRpY3MnLFxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBnZXRVc2VyR3Jvd3RoU3RhdHMoc3RhcnREYXRlPzogRGF0ZSwgZW5kRGF0ZT86IERhdGUpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgZGF0ZUZpbHRlciA9IHt9O1xuICAgICAgaWYgKHN0YXJ0RGF0ZSkgZGF0ZUZpbHRlclsnZ3RlJ10gPSBzdGFydERhdGU7XG4gICAgICBpZiAoZW5kRGF0ZSkgZGF0ZUZpbHRlclsnbHRlJ10gPSBlbmREYXRlO1xuXG4gICAgICBjb25zdCB3aGVyZURhdGUgPVxuICAgICAgICBPYmplY3Qua2V5cyhkYXRlRmlsdGVyKS5sZW5ndGggPiAwID8geyBjcmVhdGVkQXQ6IGRhdGVGaWx0ZXIgfSA6IHt9O1xuXG4gICAgICBjb25zdCB1c2Vyc0J5Um9sZSA9IGF3YWl0IHRoaXMucHJpc21hLnVzZXIuZ3JvdXBCeSh7XG4gICAgICAgIGJ5OiBbJ3JvbGUnXSxcbiAgICAgICAgd2hlcmU6IHdoZXJlRGF0ZSxcbiAgICAgICAgX2NvdW50OiB7IHJvbGU6IHRydWUgfSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBtb250aGx5R3Jvd3RoID0gYXdhaXQgdGhpcy5wcmlzbWEuJHF1ZXJ5UmF3YFxuICAgICAgICBTRUxFQ1QgXG4gICAgICAgICAgREFURV9UUlVOQygnbW9udGgnLCBcImNyZWF0ZWRBdFwiKSBhcyBtb250aCxcbiAgICAgICAgICBDT1VOVCgqKSBhcyBjb3VudCxcbiAgICAgICAgICByb2xlXG4gICAgICAgIEZST00gXCJVc2VyXCJcbiAgICAgICAgJHt3aGVyZURhdGUuY3JlYXRlZEF0ID8gJ1dIRVJFIFwiY3JlYXRlZEF0XCIgPj0gJDEgQU5EIFwiY3JlYXRlZEF0XCIgPD0gJDInIDogJyd9XG4gICAgICAgIEdST1VQIEJZIG1vbnRoLCByb2xlXG4gICAgICAgIE9SREVSIEJZIG1vbnRoIERFU0NcbiAgICAgICAgTElNSVQgMTJcbiAgICAgIGA7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGJ5Um9sZTogdXNlcnNCeVJvbGUsXG4gICAgICAgIG1vbnRobHlHcm93dGgsXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgSW50ZXJuYWxTZXJ2ZXJFcnJvckV4Y2VwdGlvbihcbiAgICAgICAgYEZhaWxlZCB0byBnZXQgdXNlciBncm93dGggc3RhdHM6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpfWAsXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGdldEVuZ2FnZW1lbnRTdGF0cyhzdGFydERhdGU/OiBEYXRlLCBlbmREYXRlPzogRGF0ZSkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBkYXRlRmlsdGVyID0ge307XG4gICAgICBpZiAoc3RhcnREYXRlKSBkYXRlRmlsdGVyWydndGUnXSA9IHN0YXJ0RGF0ZTtcbiAgICAgIGlmIChlbmREYXRlKSBkYXRlRmlsdGVyWydsdGUnXSA9IGVuZERhdGU7XG5cbiAgICAgIGNvbnN0IHdoZXJlRGF0ZSA9XG4gICAgICAgIE9iamVjdC5rZXlzKGRhdGVGaWx0ZXIpLmxlbmd0aCA+IDAgPyB7IGNyZWF0ZWRBdDogZGF0ZUZpbHRlciB9IDoge307XG5cbiAgICAgIGNvbnN0IFtcbiAgICAgICAgdG90YWxQb3N0cyxcbiAgICAgICAgdG90YWxDb21tZW50cyxcbiAgICAgICAgdG90YWxIZWFydHMsXG4gICAgICAgIGFjdGl2ZUNvbW11bml0aWVzLFxuICAgICAgICBhY3RpdmVVc2VycyxcbiAgICAgIF0gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICAgIHRoaXMucHJpc21hLnBvc3QuY291bnQoeyB3aGVyZTogd2hlcmVEYXRlIH0pLFxuICAgICAgICB0aGlzLnByaXNtYS5jb21tZW50LmNvdW50KHsgd2hlcmU6IHdoZXJlRGF0ZSB9KSxcbiAgICAgICAgdGhpcy5wcmlzbWEucG9zdEhlYXJ0LmNvdW50KHsgd2hlcmU6IHdoZXJlRGF0ZSB9KSxcbiAgICAgICAgdGhpcy5wcmlzbWEuY29tbXVuaXR5LmNvdW50KHtcbiAgICAgICAgICB3aGVyZToge1xuICAgICAgICAgICAgcm9vbUdyb3Vwczoge1xuICAgICAgICAgICAgICBzb21lOiB7XG4gICAgICAgICAgICAgICAgcm9vbXM6IHtcbiAgICAgICAgICAgICAgICAgIHNvbWU6IHtcbiAgICAgICAgICAgICAgICAgICAgcG9zdHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICBzb21lOiB3aGVyZURhdGUsXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pLFxuICAgICAgICB0aGlzLnByaXNtYS51c2VyLmNvdW50KHtcbiAgICAgICAgICB3aGVyZToge1xuICAgICAgICAgICAgT1I6IFtcbiAgICAgICAgICAgICAgeyBwb3N0czogeyBzb21lOiB3aGVyZURhdGUgfSB9LFxuICAgICAgICAgICAgICB7IGNvbW1lbnRzOiB7IHNvbWU6IHdoZXJlRGF0ZSB9IH0sXG4gICAgICAgICAgICAgIHsgcG9zdEhlYXJ0czogeyBzb21lOiB3aGVyZURhdGUgfSB9LFxuICAgICAgICAgICAgXSxcbiAgICAgICAgICB9LFxuICAgICAgICB9KSxcbiAgICAgIF0pO1xuXG4gICAgICBjb25zdCB0b3BDb21tdW5pdGllcyA9IGF3YWl0IHRoaXMucHJpc21hLmNvbW11bml0eS5maW5kTWFueSh7XG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICBfY291bnQ6IHtcbiAgICAgICAgICAgIHNlbGVjdDoge1xuICAgICAgICAgICAgICBtZW1iZXJzaGlwczogdHJ1ZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgb3JkZXJCeToge1xuICAgICAgICAgIG1lbWJlcnNoaXBzOiB7XG4gICAgICAgICAgICBfY291bnQ6ICdkZXNjJyxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICB0YWtlOiAxMCxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBvdmVydmlldzoge1xuICAgICAgICAgIHRvdGFsUG9zdHMsXG4gICAgICAgICAgdG90YWxDb21tZW50cyxcbiAgICAgICAgICB0b3RhbEhlYXJ0cyxcbiAgICAgICAgICBhY3RpdmVDb21tdW5pdGllcyxcbiAgICAgICAgICBhY3RpdmVVc2VycyxcbiAgICAgICAgICBlbmdhZ2VtZW50UmF0ZTpcbiAgICAgICAgICAgIGFjdGl2ZVVzZXJzID4gMFxuICAgICAgICAgICAgICA/ICh0b3RhbFBvc3RzICsgdG90YWxDb21tZW50cyArIHRvdGFsSGVhcnRzKSAvIGFjdGl2ZVVzZXJzXG4gICAgICAgICAgICAgIDogMCxcbiAgICAgICAgfSxcbiAgICAgICAgdG9wQ29tbXVuaXRpZXMsXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgSW50ZXJuYWxTZXJ2ZXJFcnJvckV4Y2VwdGlvbihcbiAgICAgICAgYEZhaWxlZCB0byBnZXQgZW5nYWdlbWVudCBzdGF0czogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcil9YCxcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZ2V0U2Vzc2lvblN0YXRzKHN0YXJ0RGF0ZT86IERhdGUsIGVuZERhdGU/OiBEYXRlKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGRhdGVGaWx0ZXIgPSB7fTtcbiAgICAgIGlmIChzdGFydERhdGUpIGRhdGVGaWx0ZXJbJ2d0ZSddID0gc3RhcnREYXRlO1xuICAgICAgaWYgKGVuZERhdGUpIGRhdGVGaWx0ZXJbJ2x0ZSddID0gZW5kRGF0ZTtcblxuICAgICAgY29uc3Qgd2hlcmVEYXRlID1cbiAgICAgICAgT2JqZWN0LmtleXMoZGF0ZUZpbHRlcikubGVuZ3RoID4gMCA/IHsgc3RhcnRUaW1lOiBkYXRlRmlsdGVyIH0gOiB7fTtcblxuICAgICAgY29uc3QgW1xuICAgICAgICB0b3RhbFNlc3Npb25zLFxuICAgICAgICBjb21wbGV0ZWRTZXNzaW9ucyxcbiAgICAgICAgYXZlcmFnZUR1cmF0aW9uLFxuICAgICAgICBzZXNzaW9uc0J5VHlwZSxcbiAgICAgIF0gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICAgIHRoaXMucHJpc21hLm1lZXRpbmcuY291bnQoeyB3aGVyZTogd2hlcmVEYXRlIH0pLFxuICAgICAgICB0aGlzLnByaXNtYS5tZWV0aW5nLmNvdW50KHtcbiAgICAgICAgICB3aGVyZTogeyAuLi53aGVyZURhdGUsIHN0YXR1czogJ0NPTVBMRVRFRCcgfSxcbiAgICAgICAgfSksXG4gICAgICAgIHRoaXMucHJpc21hLm1lZXRpbmcuYWdncmVnYXRlKHtcbiAgICAgICAgICB3aGVyZTogeyAuLi53aGVyZURhdGUsIHN0YXR1czogJ0NPTVBMRVRFRCcgfSxcbiAgICAgICAgICBfYXZnOiB7IGR1cmF0aW9uOiB0cnVlIH0sXG4gICAgICAgIH0pLFxuICAgICAgICB0aGlzLnByaXNtYS5tZWV0aW5nLmdyb3VwQnkoe1xuICAgICAgICAgIGJ5OiBbJ21lZXRpbmdUeXBlJ10sXG4gICAgICAgICAgd2hlcmU6IHdoZXJlRGF0ZSxcbiAgICAgICAgICBfY291bnQ6IHsgbWVldGluZ1R5cGU6IHRydWUgfSxcbiAgICAgICAgfSksXG4gICAgICBdKTtcblxuICAgICAgY29uc3QgdGhlcmFwaXN0UGVyZm9ybWFuY2UgPSBhd2FpdCB0aGlzLnByaXNtYS5tZWV0aW5nLmdyb3VwQnkoe1xuICAgICAgICBieTogWyd0aGVyYXBpc3RJZCddLFxuICAgICAgICB3aGVyZTogeyAuLi53aGVyZURhdGUsIHN0YXR1czogJ0NPTVBMRVRFRCcgfSxcbiAgICAgICAgX2NvdW50OiB7IHRoZXJhcGlzdElkOiB0cnVlIH0sXG4gICAgICAgIG9yZGVyQnk6IHsgX2NvdW50OiB7IHRoZXJhcGlzdElkOiAnZGVzYycgfSB9LFxuICAgICAgICB0YWtlOiAxMCxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBvdmVydmlldzoge1xuICAgICAgICAgIHRvdGFsU2Vzc2lvbnMsXG4gICAgICAgICAgY29tcGxldGVkU2Vzc2lvbnMsXG4gICAgICAgICAgY29tcGxldGlvblJhdGU6XG4gICAgICAgICAgICB0b3RhbFNlc3Npb25zID4gMCA/IChjb21wbGV0ZWRTZXNzaW9ucyAvIHRvdGFsU2Vzc2lvbnMpICogMTAwIDogMCxcbiAgICAgICAgICBhdmVyYWdlRHVyYXRpb246IGF2ZXJhZ2VEdXJhdGlvbi5fYXZnLmR1cmF0aW9uIHx8IDAsXG4gICAgICAgIH0sXG4gICAgICAgIHNlc3Npb25zQnlUeXBlLFxuICAgICAgICB0b3BUaGVyYXBpc3RzOiB0aGVyYXBpc3RQZXJmb3JtYW5jZSxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRocm93IG5ldyBJbnRlcm5hbFNlcnZlckVycm9yRXhjZXB0aW9uKFxuICAgICAgICBgRmFpbGVkIHRvIGdldCBzZXNzaW9uIHN0YXRzOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKX1gLFxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBnZXRUaGVyYXBpc3RBbmFseXRpY3MoXG4gICAgdGhlcmFwaXN0SWQ6IHN0cmluZyxcbiAgICBzdGFydERhdGU/OiBEYXRlLFxuICAgIGVuZERhdGU/OiBEYXRlLFxuICApIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgZGF0ZUZpbHRlciA9IHt9O1xuICAgICAgaWYgKHN0YXJ0RGF0ZSkgZGF0ZUZpbHRlclsnZ3RlJ10gPSBzdGFydERhdGU7XG4gICAgICBpZiAoZW5kRGF0ZSkgZGF0ZUZpbHRlclsnbHRlJ10gPSBlbmREYXRlO1xuXG4gICAgICBjb25zdCB3aGVyZURhdGUgPVxuICAgICAgICBPYmplY3Qua2V5cyhkYXRlRmlsdGVyKS5sZW5ndGggPiAwID8geyBzdGFydFRpbWU6IGRhdGVGaWx0ZXIgfSA6IHt9O1xuXG4gICAgICBjb25zdCBbXG4gICAgICAgIHRvdGFsQ2xpZW50cyxcbiAgICAgICAgYWN0aXZlU2Vzc2lvbnMsXG4gICAgICAgIGNvbXBsZXRlZFNlc3Npb25zLFxuICAgICAgICBhdmVyYWdlUmF0aW5nLFxuICAgICAgICB3b3Jrc2hlZXRzQXNzaWduZWQsXG4gICAgICAgIHdvcmtzaGVldHNDb21wbGV0ZWQsXG4gICAgICBdID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgICAgICB0aGlzLnByaXNtYS5jbGllbnRUaGVyYXBpc3QuY291bnQoe1xuICAgICAgICAgIHdoZXJlOiB7IHRoZXJhcGlzdElkIH0sXG4gICAgICAgIH0pLFxuICAgICAgICB0aGlzLnByaXNtYS5tZWV0aW5nLmNvdW50KHtcbiAgICAgICAgICB3aGVyZTogeyB0aGVyYXBpc3RJZCwgLi4ud2hlcmVEYXRlIH0sXG4gICAgICAgIH0pLFxuICAgICAgICB0aGlzLnByaXNtYS5tZWV0aW5nLmNvdW50KHtcbiAgICAgICAgICB3aGVyZTogeyB0aGVyYXBpc3RJZCwgc3RhdHVzOiAnQ09NUExFVEVEJywgLi4ud2hlcmVEYXRlIH0sXG4gICAgICAgIH0pLFxuICAgICAgICB0aGlzLnByaXNtYS5yZXZpZXcuYWdncmVnYXRlKHtcbiAgICAgICAgICB3aGVyZTogeyBcbiAgICAgICAgICAgIHRoZXJhcGlzdElkLCBcbiAgICAgICAgICAgIC4uLihzdGFydERhdGUgfHwgZW5kRGF0ZVxuICAgICAgICAgICAgICA/IHtcbiAgICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDoge1xuICAgICAgICAgICAgICAgICAgICAuLi4oc3RhcnREYXRlICYmIHsgZ3RlOiBzdGFydERhdGUgfSksXG4gICAgICAgICAgICAgICAgICAgIC4uLihlbmREYXRlICYmIHsgbHRlOiBlbmREYXRlIH0pLFxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIDoge30pXG4gICAgICAgICAgfSxcbiAgICAgICAgICBfYXZnOiB7IHJhdGluZzogdHJ1ZSB9LFxuICAgICAgICB9KSxcbiAgICAgICAgdGhpcy5wcmlzbWEud29ya3NoZWV0LmNvdW50KHtcbiAgICAgICAgICB3aGVyZToge1xuICAgICAgICAgICAgdGhlcmFwaXN0SWQsXG4gICAgICAgICAgICAuLi4oc3RhcnREYXRlIHx8IGVuZERhdGVcbiAgICAgICAgICAgICAgPyB7XG4gICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHtcbiAgICAgICAgICAgICAgICAgICAgLi4uKHN0YXJ0RGF0ZSAmJiB7IGd0ZTogc3RhcnREYXRlIH0pLFxuICAgICAgICAgICAgICAgICAgICAuLi4oZW5kRGF0ZSAmJiB7IGx0ZTogZW5kRGF0ZSB9KSxcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICA6IHt9KSxcbiAgICAgICAgICB9LFxuICAgICAgICB9KSxcbiAgICAgICAgdGhpcy5wcmlzbWEud29ya3NoZWV0LmNvdW50KHtcbiAgICAgICAgICB3aGVyZToge1xuICAgICAgICAgICAgdGhlcmFwaXN0SWQsXG4gICAgICAgICAgICBzdGF0dXM6ICdTVUJNSVRURUQnLFxuICAgICAgICAgICAgLi4uKHN0YXJ0RGF0ZSB8fCBlbmREYXRlXG4gICAgICAgICAgICAgID8ge1xuICAgICAgICAgICAgICAgICAgdXBkYXRlZEF0OiB7XG4gICAgICAgICAgICAgICAgICAgIC4uLihzdGFydERhdGUgJiYgeyBndGU6IHN0YXJ0RGF0ZSB9KSxcbiAgICAgICAgICAgICAgICAgICAgLi4uKGVuZERhdGUgJiYgeyBsdGU6IGVuZERhdGUgfSksXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgOiB7fSksXG4gICAgICAgICAgfSxcbiAgICAgICAgfSksXG4gICAgICBdKTtcblxuICAgICAgLy8gR2V0IHJlY2VudCBjbGllbnQgYWN0aXZpdGllcyBpbnN0ZWFkIG9mIHRoZXJhcHkgcHJvZ3Jlc3NcbiAgICAgIGNvbnN0IHJlY2VudENsaWVudEFjdGl2aXRpZXMgPSBhd2FpdCB0aGlzLnByaXNtYS5jbGllbnRUaGVyYXBpc3QuZmluZE1hbnkoe1xuICAgICAgICB3aGVyZToge1xuICAgICAgICAgIHRoZXJhcGlzdElkLFxuICAgICAgICB9LFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgY2xpZW50OiB7XG4gICAgICAgICAgICBpbmNsdWRlOiB7IFxuICAgICAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgIGZpcnN0TmFtZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgIGxhc3ROYW1lOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgZW1haWw6IHRydWUsXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIG9yZGVyQnk6IHsgYXNzaWduZWRBdDogJ2Rlc2MnIH0sXG4gICAgICAgIHRha2U6IDEwLFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIG92ZXJ2aWV3OiB7XG4gICAgICAgICAgdG90YWxDbGllbnRzLFxuICAgICAgICAgIGFjdGl2ZVNlc3Npb25zLFxuICAgICAgICAgIGNvbXBsZXRlZFNlc3Npb25zLFxuICAgICAgICAgIHNlc3Npb25Db21wbGV0aW9uUmF0ZTpcbiAgICAgICAgICAgIGFjdGl2ZVNlc3Npb25zID4gMCA/IChjb21wbGV0ZWRTZXNzaW9ucyAvIGFjdGl2ZVNlc3Npb25zKSAqIDEwMCA6IDAsXG4gICAgICAgICAgYXZlcmFnZVJhdGluZzogYXZlcmFnZVJhdGluZy5fYXZnLnJhdGluZyB8fCAwLFxuICAgICAgICAgIHdvcmtzaGVldHNBc3NpZ25lZCxcbiAgICAgICAgICB3b3Jrc2hlZXRzQ29tcGxldGVkLFxuICAgICAgICAgIHdvcmtzaGVldENvbXBsZXRpb25SYXRlOlxuICAgICAgICAgICAgd29ya3NoZWV0c0Fzc2lnbmVkID4gMFxuICAgICAgICAgICAgICA/ICh3b3Jrc2hlZXRzQ29tcGxldGVkIC8gd29ya3NoZWV0c0Fzc2lnbmVkKSAqIDEwMFxuICAgICAgICAgICAgICA6IDAsXG4gICAgICAgIH0sXG4gICAgICAgIHJlY2VudENsaWVudHM6IHJlY2VudENsaWVudEFjdGl2aXRpZXMsXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgSW50ZXJuYWxTZXJ2ZXJFcnJvckV4Y2VwdGlvbihcbiAgICAgICAgYEZhaWxlZCB0byBnZXQgdGhlcmFwaXN0IGFuYWx5dGljczogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcil9YCxcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZ2V0Q2xpZW50QW5hbHl0aWNzKGNsaWVudElkOiBzdHJpbmcsIHN0YXJ0RGF0ZT86IERhdGUsIGVuZERhdGU/OiBEYXRlKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGRhdGVGaWx0ZXIgPSB7fTtcbiAgICAgIGlmIChzdGFydERhdGUpIGRhdGVGaWx0ZXJbJ2d0ZSddID0gc3RhcnREYXRlO1xuICAgICAgaWYgKGVuZERhdGUpIGRhdGVGaWx0ZXJbJ2x0ZSddID0gZW5kRGF0ZTtcblxuICAgICAgY29uc3Qgd2hlcmVEYXRlID1cbiAgICAgICAgT2JqZWN0LmtleXMoZGF0ZUZpbHRlcikubGVuZ3RoID4gMCA/IHsgc3RhcnRUaW1lOiBkYXRlRmlsdGVyIH0gOiB7fTtcblxuICAgICAgY29uc3QgW1xuICAgICAgICB0b3RhbFNlc3Npb25zLFxuICAgICAgICBjb21wbGV0ZWRTZXNzaW9ucyxcbiAgICAgICAgYXZlcmFnZVNlc3Npb25SYXRpbmcsXG4gICAgICAgIHdvcmtzaGVldHNBc3NpZ25lZCxcbiAgICAgICAgd29ya3NoZWV0c0NvbXBsZXRlZCxcbiAgICAgICAgY29tbXVuaXR5UG9zdHMsXG4gICAgICAgIGNvbW11bml0eUVuZ2FnZW1lbnQsXG4gICAgICBdID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgICAgICB0aGlzLnByaXNtYS5tZWV0aW5nLmNvdW50KHtcbiAgICAgICAgICB3aGVyZTogeyBjbGllbnRJZCwgLi4ud2hlcmVEYXRlIH0sXG4gICAgICAgIH0pLFxuICAgICAgICB0aGlzLnByaXNtYS5tZWV0aW5nLmNvdW50KHtcbiAgICAgICAgICB3aGVyZTogeyBjbGllbnRJZCwgc3RhdHVzOiAnQ09NUExFVEVEJywgLi4ud2hlcmVEYXRlIH0sXG4gICAgICAgIH0pLFxuICAgICAgICB0aGlzLnByaXNtYS5yZXZpZXcuYWdncmVnYXRlKHtcbiAgICAgICAgICB3aGVyZTogeyBcbiAgICAgICAgICAgIGNsaWVudElkLCBcbiAgICAgICAgICAgIC4uLihzdGFydERhdGUgfHwgZW5kRGF0ZVxuICAgICAgICAgICAgICA/IHtcbiAgICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDoge1xuICAgICAgICAgICAgICAgICAgICAuLi4oc3RhcnREYXRlICYmIHsgZ3RlOiBzdGFydERhdGUgfSksXG4gICAgICAgICAgICAgICAgICAgIC4uLihlbmREYXRlICYmIHsgbHRlOiBlbmREYXRlIH0pLFxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIDoge30pXG4gICAgICAgICAgfSxcbiAgICAgICAgICBfYXZnOiB7IHJhdGluZzogdHJ1ZSB9LFxuICAgICAgICB9KSxcbiAgICAgICAgdGhpcy5wcmlzbWEud29ya3NoZWV0LmNvdW50KHtcbiAgICAgICAgICB3aGVyZToge1xuICAgICAgICAgICAgY2xpZW50SWQsXG4gICAgICAgICAgICAuLi4oc3RhcnREYXRlIHx8IGVuZERhdGVcbiAgICAgICAgICAgICAgPyB7XG4gICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHtcbiAgICAgICAgICAgICAgICAgICAgLi4uKHN0YXJ0RGF0ZSAmJiB7IGd0ZTogc3RhcnREYXRlIH0pLFxuICAgICAgICAgICAgICAgICAgICAuLi4oZW5kRGF0ZSAmJiB7IGx0ZTogZW5kRGF0ZSB9KSxcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICA6IHt9KSxcbiAgICAgICAgICB9LFxuICAgICAgICB9KSxcbiAgICAgICAgdGhpcy5wcmlzbWEud29ya3NoZWV0LmNvdW50KHtcbiAgICAgICAgICB3aGVyZToge1xuICAgICAgICAgICAgY2xpZW50SWQsXG4gICAgICAgICAgICBzdGF0dXM6ICdTVUJNSVRURUQnLFxuICAgICAgICAgICAgLi4uKHN0YXJ0RGF0ZSB8fCBlbmREYXRlXG4gICAgICAgICAgICAgID8ge1xuICAgICAgICAgICAgICAgICAgdXBkYXRlZEF0OiB7XG4gICAgICAgICAgICAgICAgICAgIC4uLihzdGFydERhdGUgJiYgeyBndGU6IHN0YXJ0RGF0ZSB9KSxcbiAgICAgICAgICAgICAgICAgICAgLi4uKGVuZERhdGUgJiYgeyBsdGU6IGVuZERhdGUgfSksXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgOiB7fSksXG4gICAgICAgICAgfSxcbiAgICAgICAgfSksXG4gICAgICAgIHRoaXMucHJpc21hLnBvc3QuY291bnQoe1xuICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICB1c2VySWQ6IGNsaWVudElkLFxuICAgICAgICAgICAgLi4uKHN0YXJ0RGF0ZSB8fCBlbmREYXRlXG4gICAgICAgICAgICAgID8ge1xuICAgICAgICAgICAgICAgICAgY3JlYXRlZEF0OiB7XG4gICAgICAgICAgICAgICAgICAgIC4uLihzdGFydERhdGUgJiYgeyBndGU6IHN0YXJ0RGF0ZSB9KSxcbiAgICAgICAgICAgICAgICAgICAgLi4uKGVuZERhdGUgJiYgeyBsdGU6IGVuZERhdGUgfSksXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgOiB7fSksXG4gICAgICAgICAgfSxcbiAgICAgICAgfSksXG4gICAgICAgIHRoaXMucHJpc21hLmNvbW1lbnQuY291bnQoe1xuICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICB1c2VySWQ6IGNsaWVudElkLFxuICAgICAgICAgICAgLi4uKHN0YXJ0RGF0ZSB8fCBlbmREYXRlXG4gICAgICAgICAgICAgID8ge1xuICAgICAgICAgICAgICAgICAgY3JlYXRlZEF0OiB7XG4gICAgICAgICAgICAgICAgICAgIC4uLihzdGFydERhdGUgJiYgeyBndGU6IHN0YXJ0RGF0ZSB9KSxcbiAgICAgICAgICAgICAgICAgICAgLi4uKGVuZERhdGUgJiYgeyBsdGU6IGVuZERhdGUgfSksXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgOiB7fSksXG4gICAgICAgICAgfSxcbiAgICAgICAgfSksXG4gICAgICBdKTtcblxuICAgICAgLy8gR2V0IHJlY2VudCBhY3Rpdml0eSBoaXN0b3J5IGluc3RlYWQgb2YgdGhlcmFweSBwcm9ncmVzc1xuICAgICAgY29uc3QgcmVjZW50QWN0aXZpdHlIaXN0b3J5ID0gYXdhaXQgdGhpcy5wcmlzbWEud29ya3NoZWV0LmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICBjbGllbnRJZCxcbiAgICAgICAgICAuLi4oc3RhcnREYXRlIHx8IGVuZERhdGVcbiAgICAgICAgICAgID8ge1xuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDoge1xuICAgICAgICAgICAgICAgICAgLi4uKHN0YXJ0RGF0ZSAmJiB7IGd0ZTogc3RhcnREYXRlIH0pLFxuICAgICAgICAgICAgICAgICAgLi4uKGVuZERhdGUgJiYgeyBsdGU6IGVuZERhdGUgfSksXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgOiB7fSksXG4gICAgICAgIH0sXG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICB0aGVyYXBpc3Q6IHtcbiAgICAgICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgIHNlbGVjdDoge1xuICAgICAgICAgICAgICAgICAgaWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICBmaXJzdE5hbWU6IHRydWUsXG4gICAgICAgICAgICAgICAgICBsYXN0TmFtZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIHN1Ym1pc3Npb246IHRydWUsXG4gICAgICAgIH0sXG4gICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfSxcbiAgICAgICAgdGFrZTogMTAsXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgb3ZlcnZpZXc6IHtcbiAgICAgICAgICB0b3RhbFNlc3Npb25zLFxuICAgICAgICAgIGNvbXBsZXRlZFNlc3Npb25zLFxuICAgICAgICAgIHNlc3Npb25Db21wbGV0aW9uUmF0ZTpcbiAgICAgICAgICAgIHRvdGFsU2Vzc2lvbnMgPiAwID8gKGNvbXBsZXRlZFNlc3Npb25zIC8gdG90YWxTZXNzaW9ucykgKiAxMDAgOiAwLFxuICAgICAgICAgIGF2ZXJhZ2VTZXNzaW9uUmF0aW5nOiBhdmVyYWdlU2Vzc2lvblJhdGluZy5fYXZnLnJhdGluZyB8fCAwLFxuICAgICAgICAgIHdvcmtzaGVldHNBc3NpZ25lZCxcbiAgICAgICAgICB3b3Jrc2hlZXRzQ29tcGxldGVkLFxuICAgICAgICAgIHdvcmtzaGVldENvbXBsZXRpb25SYXRlOlxuICAgICAgICAgICAgd29ya3NoZWV0c0Fzc2lnbmVkID4gMFxuICAgICAgICAgICAgICA/ICh3b3Jrc2hlZXRzQ29tcGxldGVkIC8gd29ya3NoZWV0c0Fzc2lnbmVkKSAqIDEwMFxuICAgICAgICAgICAgICA6IDAsXG4gICAgICAgICAgY29tbXVuaXR5UG9zdHMsXG4gICAgICAgICAgY29tbXVuaXR5RW5nYWdlbWVudCxcbiAgICAgICAgfSxcbiAgICAgICAgcmVjZW50QWN0aXZpdHk6IHJlY2VudEFjdGl2aXR5SGlzdG9yeSxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRocm93IG5ldyBJbnRlcm5hbFNlcnZlckVycm9yRXhjZXB0aW9uKFxuICAgICAgICBgRmFpbGVkIHRvIGdldCBjbGllbnQgYW5hbHl0aWNzOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKX1gLFxuICAgICAgKTtcbiAgICB9XG4gIH1cbn1cbiJdLCJ2ZXJzaW9uIjozfQ==