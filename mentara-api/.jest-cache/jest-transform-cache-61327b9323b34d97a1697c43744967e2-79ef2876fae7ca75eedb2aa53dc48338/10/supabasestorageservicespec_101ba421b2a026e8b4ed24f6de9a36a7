09aceaec3ac57769df645e943c3bf829
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
// Mock axios
jest.mock('axios');
// Mock uuid
jest.mock('uuid');
const testing_1 = require("@nestjs/testing");
const common_1 = require("@nestjs/common");
const config_1 = require("@nestjs/config");
const supabase_storage_service_1 = require("./supabase-storage.service");
const axios_1 = require("axios");
const uuid_1 = require("uuid");
const mockedAxios = axios_1.default;
const mockedUuidv4 = uuid_1.v4;
describe('SupabaseStorageService', () => {
    let service;
    let configService;
    let loggerSpy;
    let loggerDebugSpy;
    let loggerWarnSpy;
    let loggerErrorSpy;
    // Test data constants
    const mockSupabaseUrl = 'https://test-project.supabase.co';
    const mockSupabaseApiKey = 'test-api-key-123';
    const mockBucket = 'test-bucket';
    const mockFilename = 'test-file.jpg';
    const mockUniqueFilename = 'unique-id-123.jpg';
    const createMockFile = (originalname = 'test-file.jpg', buffer = Buffer.from('test file content'), mimetype = 'image/jpeg', size = 1024) => ({
        fieldname: 'file',
        originalname,
        encoding: '7bit',
        mimetype,
        buffer,
        size,
        destination: '',
        filename: '',
        path: '',
        stream: null,
    });
    beforeEach(async () => {
        // Reset all mocks
        jest.clearAllMocks();
        jest.resetAllMocks();
        const module = await testing_1.Test.createTestingModule({
            providers: [
                supabase_storage_service_1.SupabaseStorageService,
                {
                    provide: config_1.ConfigService,
                    useValue: {
                        get: jest.fn(),
                    },
                },
            ],
        }).compile();
        configService = module.get(config_1.ConfigService);
        // Setup default config values
        configService.get.mockImplementation((key) => {
            switch (key) {
                case 'SUPABASE_URL':
                    return mockSupabaseUrl;
                case 'SUPABASE_API_KEY':
                    return mockSupabaseApiKey;
                default:
                    return null;
            }
        });
        service = module.get(supabase_storage_service_1.SupabaseStorageService);
        // Setup logger spies
        loggerSpy = jest.spyOn(common_1.Logger.prototype, 'log').mockImplementation();
        loggerDebugSpy = jest.spyOn(common_1.Logger.prototype, 'debug').mockImplementation();
        loggerWarnSpy = jest.spyOn(common_1.Logger.prototype, 'warn').mockImplementation();
        loggerErrorSpy = jest.spyOn(common_1.Logger.prototype, 'error').mockImplementation();
        // Setup UUID mock
        mockedUuidv4.mockReturnValue('unique-id-123');
    });
    afterEach(() => {
        jest.restoreAllMocks();
    });
    // ===== INITIALIZATION TESTS =====
    describe('Initialization', () => {
        it('should initialize successfully with valid configuration', () => {
            expect(service).toBeDefined();
            expect(configService.get).toHaveBeenCalledWith('SUPABASE_URL');
            expect(configService.get).toHaveBeenCalledWith('SUPABASE_API_KEY');
        });
        it('should throw error when SUPABASE_URL is missing', () => {
            configService.get.mockImplementation((key) => {
                switch (key) {
                    case 'SUPABASE_URL':
                        return null;
                    case 'SUPABASE_API_KEY':
                        return mockSupabaseApiKey;
                    default:
                        return null;
                }
            });
            expect(() => new supabase_storage_service_1.SupabaseStorageService(configService)).toThrow('Supabase configuration is missing. Please set SUPABASE_URL and SUPABASE_API_KEY environment variables.');
        });
        it('should throw error when SUPABASE_API_KEY is missing', () => {
            configService.get.mockImplementation((key) => {
                switch (key) {
                    case 'SUPABASE_URL':
                        return mockSupabaseUrl;
                    case 'SUPABASE_API_KEY':
                        return null;
                    default:
                        return null;
                }
            });
            expect(() => new supabase_storage_service_1.SupabaseStorageService(configService)).toThrow('Supabase configuration is missing. Please set SUPABASE_URL and SUPABASE_API_KEY environment variables.');
        });
        it('should throw error when both SUPABASE_URL and SUPABASE_API_KEY are missing', () => {
            configService.get.mockImplementation((key) => {
                switch (key) {
                    case 'SUPABASE_URL':
                        return '';
                    case 'SUPABASE_API_KEY':
                        return '';
                    default:
                        return null;
                }
            });
            expect(() => new supabase_storage_service_1.SupabaseStorageService(configService)).toThrow('Supabase configuration is missing. Please set SUPABASE_URL and SUPABASE_API_KEY environment variables.');
        });
        it('should handle empty string configuration values', () => {
            configService.get.mockImplementation((key) => {
                switch (key) {
                    case 'SUPABASE_URL':
                        return '   '; // Whitespace only
                    case 'SUPABASE_API_KEY':
                        return ''; // Empty string
                    default:
                        return null;
                }
            });
            expect(() => new supabase_storage_service_1.SupabaseStorageService(configService)).toThrow('Supabase configuration is missing. Please set SUPABASE_URL and SUPABASE_API_KEY environment variables.');
        });
    });
    // ===== SINGLE FILE UPLOAD TESTS =====
    describe('uploadFile', () => {
        beforeEach(() => {
            mockedAxios.post.mockResolvedValue({
                status: 200,
                data: { message: 'File uploaded successfully' },
            });
        });
        it('should upload file successfully', async () => {
            const mockFile = createMockFile();
            const result = await service.uploadFile(mockFile, mockBucket);
            expect(result).toEqual({
                filename: mockUniqueFilename,
                url: `${mockSupabaseUrl}/storage/v1/object/public/${mockBucket}/${mockUniqueFilename}`,
                bucket: mockBucket,
            });
            expect(mockedAxios.post).toHaveBeenCalledWith(`${mockSupabaseUrl}/storage/v1/object/${mockBucket}/${mockUniqueFilename}`, mockFile.buffer, {
                headers: {
                    'Content-Type': mockFile.mimetype,
                    Authorization: `Bearer ${mockSupabaseApiKey}`,
                },
            });
            expect(loggerSpy).toHaveBeenCalledWith(`Uploading file to Supabase: ${mockFile.originalname} (bucket: ${mockBucket})`);
            expect(loggerSpy).toHaveBeenCalledWith(`File uploaded successfully to Supabase: ${mockUniqueFilename}`);
        });
        it('should generate unique filenames for files with same name', async () => {
            const mockFile1 = createMockFile('test.jpg');
            const mockFile2 = createMockFile('test.jpg');
            mockedUuidv4
                .mockReturnValueOnce('unique-id-1')
                .mockReturnValueOnce('unique-id-2');
            const result1 = await service.uploadFile(mockFile1, mockBucket);
            const result2 = await service.uploadFile(mockFile2, mockBucket);
            expect(result1.filename).toBe('unique-id-1.jpg');
            expect(result2.filename).toBe('unique-id-2.jpg');
            expect(result1.filename).not.toBe(result2.filename);
        });
        it('should handle files with no extension', async () => {
            const mockFile = createMockFile('README');
            mockedUuidv4.mockReturnValue('unique-id-no-ext');
            const result = await service.uploadFile(mockFile, mockBucket);
            expect(result.filename).toBe('unique-id-no-ext');
            expect(mockedAxios.post).toHaveBeenCalledWith(`${mockSupabaseUrl}/storage/v1/object/${mockBucket}/unique-id-no-ext`, expect.any(Buffer), expect.any(Object));
        });
        it('should handle files with multiple dots in filename', async () => {
            const mockFile = createMockFile('my.file.with.dots.txt');
            mockedUuidv4.mockReturnValue('unique-id-dots');
            const result = await service.uploadFile(mockFile, mockBucket);
            expect(result.filename).toBe('unique-id-dots.txt');
        });
        it('should handle different file types', async () => {
            const testCases = [
                { filename: 'document.pdf', mimetype: 'application/pdf', extension: '.pdf' },
                { filename: 'image.png', mimetype: 'image/png', extension: '.png' },
                { filename: 'data.csv', mimetype: 'text/csv', extension: '.csv' },
                { filename: 'archive.zip', mimetype: 'application/zip', extension: '.zip' },
            ];
            for (const testCase of testCases) {
                const mockFile = createMockFile(testCase.filename, Buffer.from('content'), testCase.mimetype);
                mockedUuidv4.mockReturnValue(`unique-id-${testCase.extension.substring(1)}`);
                const result = await service.uploadFile(mockFile, mockBucket);
                expect(result.filename).toBe(`unique-id-${testCase.extension.substring(1)}${testCase.extension}`);
                expect(mockedAxios.post).toHaveBeenCalledWith(expect.stringContaining(result.filename), mockFile.buffer, expect.objectContaining({
                    headers: expect.objectContaining({
                        'Content-Type': testCase.mimetype,
                    }),
                }));
            }
        });
        it('should handle 201 status code as success', async () => {
            mockedAxios.post.mockResolvedValue({
                status: 201,
                data: { message: 'File created successfully' },
            });
            const mockFile = createMockFile();
            const result = await service.uploadFile(mockFile, mockBucket);
            expect(result.filename).toBe(mockUniqueFilename);
            expect(loggerDebugSpy).toHaveBeenCalledWith(`File uploaded successfully to Supabase: ${mockUniqueFilename}`);
        });
        it('should handle network errors during upload', async () => {
            const networkError = new Error('Network error');
            mockedAxios.post.mockRejectedValue(networkError);
            const mockFile = createMockFile();
            await expect(service.uploadFile(mockFile, mockBucket)).rejects.toThrow('Failed to upload file to Supabase: Network error');
            expect(loggerErrorSpy).toHaveBeenCalledWith(`Error uploading file to Supabase: ${mockFile.originalname}`, networkError);
        });
        it('should handle HTTP errors with response', async () => {
            const httpError = {
                response: {
                    status: 400,
                    data: { message: 'Invalid file format' },
                    statusText: 'Bad Request',
                },
            };
            mockedAxios.post.mockRejectedValue(httpError);
            const mockFile = createMockFile();
            await expect(service.uploadFile(mockFile, mockBucket)).rejects.toThrow('Failed to upload file to Supabase: Supabase upload failed: Invalid file format');
            expect(loggerErrorSpy).toHaveBeenCalledWith(`Supabase API error: 400 - ${JSON.stringify(httpError.response.data)}`);
        });
        it('should handle HTTP errors without message in response', async () => {
            const httpError = {
                response: {
                    status: 500,
                    data: {},
                    statusText: 'Internal Server Error',
                },
            };
            mockedAxios.post.mockRejectedValue(httpError);
            const mockFile = createMockFile();
            await expect(service.uploadFile(mockFile, mockBucket)).rejects.toThrow('Failed to upload file to Supabase: Supabase upload failed: Internal Server Error');
        });
        it('should handle non-success HTTP status codes', async () => {
            mockedAxios.post.mockResolvedValue({
                status: 404,
                data: { error: 'Bucket not found' },
            });
            const mockFile = createMockFile();
            await expect(service.uploadFile(mockFile, mockBucket)).rejects.toThrow('Failed to upload file to Supabase: Supabase upload failed with status: 404');
            expect(loggerErrorSpy).toHaveBeenCalledWith(expect.stringContaining('Failed to upload file to Supabase. Status: 404'));
        });
        it('should handle large files', async () => {
            const largeBuffer = Buffer.alloc(10 * 1024 * 1024); // 10MB
            const mockFile = createMockFile('large-file.jpg', largeBuffer, 'image/jpeg', 10 * 1024 * 1024);
            const result = await service.uploadFile(mockFile, mockBucket);
            expect(result.filename).toBe(mockUniqueFilename);
            expect(mockedAxios.post).toHaveBeenCalledWith(expect.any(String), largeBuffer, expect.any(Object));
        });
        it('should handle empty files', async () => {
            const emptyBuffer = Buffer.alloc(0);
            const mockFile = createMockFile('empty-file.txt', emptyBuffer, 'text/plain', 0);
            const result = await service.uploadFile(mockFile, mockBucket);
            expect(result.filename).toBe('unique-id-123.txt');
            expect(mockedAxios.post).toHaveBeenCalledWith(expect.any(String), emptyBuffer, expect.any(Object));
        });
    });
    // ===== MULTIPLE FILES UPLOAD TESTS =====
    describe('uploadFiles', () => {
        beforeEach(() => {
            mockedAxios.post.mockResolvedValue({
                status: 200,
                data: { message: 'File uploaded successfully' },
            });
        });
        it('should upload multiple files successfully', async () => {
            const mockFiles = [
                createMockFile('file1.jpg'),
                createMockFile('file2.png'),
                createMockFile('file3.pdf', Buffer.from('pdf content'), 'application/pdf'),
            ];
            mockedUuidv4
                .mockReturnValueOnce('uuid-1')
                .mockReturnValueOnce('uuid-2')
                .mockReturnValueOnce('uuid-3');
            const results = await service.uploadFiles(mockFiles, mockBucket);
            expect(results).toHaveLength(3);
            expect(results[0]).toEqual({
                filename: 'uuid-1.jpg',
                url: `${mockSupabaseUrl}/storage/v1/object/public/${mockBucket}/uuid-1.jpg`,
                bucket: mockBucket,
            });
            expect(results[1]).toEqual({
                filename: 'uuid-2.png',
                url: `${mockSupabaseUrl}/storage/v1/object/public/${mockBucket}/uuid-2.png`,
                bucket: mockBucket,
            });
            expect(results[2]).toEqual({
                filename: 'uuid-3.pdf',
                url: `${mockSupabaseUrl}/storage/v1/object/public/${mockBucket}/uuid-3.pdf`,
                bucket: mockBucket,
            });
            expect(mockedAxios.post).toHaveBeenCalledTimes(3);
            expect(loggerSpy).toHaveBeenCalledWith(`Uploading 3 files to Supabase bucket: ${mockBucket}`);
            expect(loggerSpy).toHaveBeenCalledWith(`Successfully uploaded 3 files to Supabase`);
        });
        it('should return empty array for empty files array', async () => {
            const result = await service.uploadFiles([], mockBucket);
            expect(result).toEqual([]);
            expect(mockedAxios.post).not.toHaveBeenCalled();
        });
        it('should return empty array for null files', async () => {
            const result = await service.uploadFiles(null, mockBucket);
            expect(result).toEqual([]);
            expect(mockedAxios.post).not.toHaveBeenCalled();
        });
        it('should return empty array for undefined files', async () => {
            const result = await service.uploadFiles(undefined, mockBucket);
            expect(result).toEqual([]);
            expect(mockedAxios.post).not.toHaveBeenCalled();
        });
        it('should handle partial failures in batch upload', async () => {
            const mockFiles = [
                createMockFile('file1.jpg'),
                createMockFile('file2.png'),
            ];
            mockedUuidv4
                .mockReturnValueOnce('uuid-1')
                .mockReturnValueOnce('uuid-2');
            // First call succeeds, second call fails
            mockedAxios.post
                .mockResolvedValueOnce({
                status: 200,
                data: { message: 'Success' },
            })
                .mockRejectedValueOnce(new Error('Upload failed'));
            await expect(service.uploadFiles(mockFiles, mockBucket)).rejects.toThrow('Failed to upload files to Supabase: Upload failed');
            expect(mockedAxios.post).toHaveBeenCalledTimes(2);
            expect(loggerErrorSpy).toHaveBeenCalledWith('Error uploading multiple files to Supabase', expect.any(Error));
        });
        it('should handle single file in array', async () => {
            const mockFiles = [createMockFile('single-file.jpg')];
            mockedUuidv4.mockReturnValue('single-uuid');
            const results = await service.uploadFiles(mockFiles, mockBucket);
            expect(results).toHaveLength(1);
            expect(results[0].filename).toBe('single-uuid.jpg');
            expect(mockedAxios.post).toHaveBeenCalledTimes(1);
        });
        it('should handle concurrent upload of many files', async () => {
            const fileCount = 10;
            const mockFiles = Array.from({ length: fileCount }, (_, i) => createMockFile(`file${i}.jpg`));
            mockedUuidv4.mockImplementation(() => `uuid-${Date.now()}-${Math.random()}`);
            const results = await service.uploadFiles(mockFiles, mockBucket);
            expect(results).toHaveLength(fileCount);
            expect(mockedAxios.post).toHaveBeenCalledTimes(fileCount);
            expect(loggerSpy).toHaveBeenCalledWith(`Uploading ${fileCount} files to Supabase bucket: ${mockBucket}`);
            expect(loggerSpy).toHaveBeenCalledWith(`Successfully uploaded ${fileCount} files to Supabase`);
        });
        it('should preserve file order in results', async () => {
            const mockFiles = [
                createMockFile('first.jpg'),
                createMockFile('second.png'),
                createMockFile('third.pdf', Buffer.from('content'), 'application/pdf'),
            ];
            mockedUuidv4
                .mockReturnValueOnce('first-uuid')
                .mockReturnValueOnce('second-uuid')
                .mockReturnValueOnce('third-uuid');
            const results = await service.uploadFiles(mockFiles, mockBucket);
            expect(results[0].filename).toBe('first-uuid.jpg');
            expect(results[1].filename).toBe('second-uuid.png');
            expect(results[2].filename).toBe('third-uuid.pdf');
        });
    });
    // ===== FILE DELETION TESTS =====
    describe('deleteFile', () => {
        it('should delete file successfully', async () => {
            mockedAxios.delete.mockResolvedValue({
                status: 200,
                data: { message: 'File deleted successfully' },
            });
            await service.deleteFile(mockBucket, mockFilename);
            expect(mockedAxios.delete).toHaveBeenCalledWith(`${mockSupabaseUrl}/storage/v1/object/${mockBucket}/${mockFilename}`, {
                headers: {
                    Authorization: `Bearer ${mockSupabaseApiKey}`,
                },
            });
            expect(loggerSpy).toHaveBeenCalledWith(`Deleting file from Supabase: ${mockFilename} (bucket: ${mockBucket})`);
            expect(loggerSpy).toHaveBeenCalledWith(`File deleted successfully from Supabase: ${mockFilename}`);
        });
        it('should handle non-200 status as failure', async () => {
            mockedAxios.delete.mockResolvedValue({
                status: 404,
                data: { error: 'File not found' },
            });
            await expect(service.deleteFile(mockBucket, mockFilename)).rejects.toThrow('Failed to delete file from Supabase: Supabase delete failed with status: 404');
            expect(loggerErrorSpy).toHaveBeenCalledWith(expect.stringContaining('Failed to delete file from Supabase. Status: 404'));
        });
        it('should handle network errors during deletion', async () => {
            const networkError = new Error('Network connection failed');
            mockedAxios.delete.mockRejectedValue(networkError);
            await expect(service.deleteFile(mockBucket, mockFilename)).rejects.toThrow('Failed to delete file from Supabase: Network connection failed');
            expect(loggerErrorSpy).toHaveBeenCalledWith(`Error deleting file from Supabase: ${mockFilename}`, networkError);
        });
        it('should handle HTTP errors with response', async () => {
            const httpError = {
                response: {
                    status: 403,
                    data: { message: 'Access denied' },
                },
                message: 'Request failed with status code 403',
            };
            mockedAxios.delete.mockRejectedValue(httpError);
            await expect(service.deleteFile(mockBucket, mockFilename)).rejects.toThrow('Failed to delete file from Supabase: Request failed with status code 403');
        });
        it('should handle deletion of files with special characters in names', async () => {
            mockedAxios.delete.mockResolvedValue({
                status: 200,
                data: { message: 'Success' },
            });
            const specialFilename = 'file-with-special-chars_123.jpg';
            await service.deleteFile(mockBucket, specialFilename);
            expect(mockedAxios.delete).toHaveBeenCalledWith(`${mockSupabaseUrl}/storage/v1/object/${mockBucket}/${specialFilename}`, expect.any(Object));
        });
        it('should handle deletion of files with long paths', async () => {
            mockedAxios.delete.mockResolvedValue({
                status: 200,
                data: { message: 'Success' },
            });
            const longPath = 'very/long/path/to/nested/directory/structure/file.jpg';
            await service.deleteFile(mockBucket, longPath);
            expect(mockedAxios.delete).toHaveBeenCalledWith(`${mockSupabaseUrl}/storage/v1/object/${mockBucket}/${longPath}`, expect.any(Object));
        });
        it('should handle empty filename', async () => {
            mockedAxios.delete.mockResolvedValue({
                status: 200,
                data: { message: 'Success' },
            });
            await service.deleteFile(mockBucket, '');
            expect(mockedAxios.delete).toHaveBeenCalledWith(`${mockSupabaseUrl}/storage/v1/object/${mockBucket}/`, expect.any(Object));
        });
    });
    // ===== FILE VALIDATION TESTS =====
    describe('validateFile', () => {
        it('should validate valid file with default settings', () => {
            const mockFile = createMockFile('test.jpg', Buffer.from('content'), 'image/jpeg', 1024);
            const result = service.validateFile(mockFile);
            expect(result).toEqual({ isValid: true });
        });
        it('should reject file exceeding size limit', () => {
            const largeBuffer = Buffer.alloc(11 * 1024 * 1024); // 11MB
            const mockFile = createMockFile('large.jpg', largeBuffer, 'image/jpeg', 11 * 1024 * 1024);
            const result = service.validateFile(mockFile);
            expect(result).toEqual({
                isValid: false,
                error: 'File size exceeds 10MB limit',
            });
        });
        it('should validate file with custom size limit', () => {
            const mockFile = createMockFile('test.jpg', Buffer.from('content'), 'image/jpeg', 2 * 1024 * 1024); // 2MB
            const customSizeLimit = 5 * 1024 * 1024; // 5MB
            const result = service.validateFile(mockFile, customSizeLimit);
            expect(result).toEqual({ isValid: true });
        });
        it('should reject file with custom size limit', () => {
            const mockFile = createMockFile('test.jpg', Buffer.from('content'), 'image/jpeg', 6 * 1024 * 1024); // 6MB
            const customSizeLimit = 5 * 1024 * 1024; // 5MB
            const result = service.validateFile(mockFile, customSizeLimit);
            expect(result).toEqual({
                isValid: false,
                error: 'File size exceeds 5MB limit',
            });
        });
        it('should reject file with disallowed MIME type', () => {
            const mockFile = createMockFile('virus.exe', Buffer.from('content'), 'application/x-msdownload', 1024);
            const result = service.validateFile(mockFile);
            expect(result).toEqual({
                isValid: false,
                error: 'File type application/x-msdownload is not allowed',
            });
        });
        it('should validate file with custom allowed MIME types', () => {
            const mockFile = createMockFile('script.js', Buffer.from('content'), 'application/javascript', 1024);
            const customMimeTypes = ['application/javascript', 'text/javascript'];
            const result = service.validateFile(mockFile, 10 * 1024 * 1024, customMimeTypes);
            expect(result).toEqual({ isValid: true });
        });
        it('should validate all default allowed MIME types', () => {
            const defaultMimeTypes = [
                'image/jpeg',
                'image/png',
                'image/gif',
                'image/webp',
                'application/pdf',
                'text/plain',
                'text/csv',
                'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
                'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
                'application/vnd.openxmlformats-officedocument.presentationml.presentation',
                'application/msword',
                'application/vnd.ms-excel',
                'application/vnd.ms-powerpoint',
            ];
            defaultMimeTypes.forEach((mimeType) => {
                const mockFile = createMockFile('test-file', Buffer.from('content'), mimeType, 1024);
                const result = service.validateFile(mockFile);
                expect(result.isValid).toBe(true);
            });
        });
        it('should reject filename with invalid characters', () => {
            const mockFile = createMockFile('file/with\\path.jpg', Buffer.from('content'), 'image/jpeg', 1024);
            const result = service.validateFile(mockFile);
            expect(result).toEqual({
                isValid: false,
                error: 'Filename contains invalid characters',
            });
        });
        it('should reject filename with special characters', () => {
            const invalidFilenames = [
                'file<script>.jpg',
                'file>redirect.jpg',
                'file|pipe.jpg',
                'file:colon.jpg',
                'file"quote.jpg',
                'file*wildcard.jpg',
                'file?question.jpg',
                'file\\backslash.jpg',
                'file/slash.jpg',
            ];
            invalidFilenames.forEach((filename) => {
                const mockFile = createMockFile(filename, Buffer.from('content'), 'image/jpeg', 1024);
                const result = service.validateFile(mockFile);
                expect(result.isValid).toBe(false);
                expect(result.error).toBe('Filename contains invalid characters');
            });
        });
        it('should allow valid filename characters', () => {
            const validFilenames = [
                'normal-file.jpg',
                'file_with_underscores.png',
                'file.with.dots.pdf',
                'file123.txt',
                'UPPERCASE.PDF',
                'MixedCase.TXT',
                'file-name.extension',
            ];
            validFilenames.forEach((filename) => {
                const mockFile = createMockFile(filename, Buffer.from('content'), 'image/jpeg', 1024);
                const result = service.validateFile(mockFile);
                expect(result.isValid).toBe(true);
            });
        });
        it('should handle zero-byte files', () => {
            const mockFile = createMockFile('empty.txt', Buffer.alloc(0), 'text/plain', 0);
            const result = service.validateFile(mockFile);
            expect(result).toEqual({ isValid: true });
        });
        it('should handle files at exact size limit', () => {
            const exactSizeBuffer = Buffer.alloc(10 * 1024 * 1024); // Exactly 10MB
            const mockFile = createMockFile('exact.jpg', exactSizeBuffer, 'image/jpeg', 10 * 1024 * 1024);
            const result = service.validateFile(mockFile);
            expect(result).toEqual({ isValid: true });
        });
        it('should handle files just over size limit', () => {
            const oversizeBuffer = Buffer.alloc(10 * 1024 * 1024 + 1); // 10MB + 1 byte
            const mockFile = createMockFile('oversize.jpg', oversizeBuffer, 'image/jpeg', 10 * 1024 * 1024 + 1);
            const result = service.validateFile(mockFile);
            expect(result).toEqual({
                isValid: false,
                error: 'File size exceeds 10MB limit',
            });
        });
        it('should handle custom size limits correctly', () => {
            const testCases = [
                { size: 1024, limit: 2048, expected: true }, // Below limit
                { size: 2048, limit: 2048, expected: true }, // At limit
                { size: 2049, limit: 2048, expected: false }, // Above limit
            ];
            testCases.forEach(({ size, limit, expected }) => {
                const buffer = Buffer.alloc(size);
                const mockFile = createMockFile('test.jpg', buffer, 'image/jpeg', size);
                const result = service.validateFile(mockFile, limit);
                expect(result.isValid).toBe(expected);
            });
        });
    });
    // ===== SUPPORTED BUCKETS TESTS =====
    describe('getSupportedBuckets', () => {
        it('should return correct bucket configuration', () => {
            const buckets = supabase_storage_service_1.SupabaseStorageService.getSupportedBuckets();
            expect(buckets).toEqual({
                USER_PROFILES: 'user-profiles',
                POST_ATTACHMENTS: 'post-attachments',
                MESSAGES: 'messages',
                DOCUMENTS: 'documents',
                WORKSHEETS: 'worksheets',
            });
        });
        it('should return immutable bucket configuration', () => {
            const buckets1 = supabase_storage_service_1.SupabaseStorageService.getSupportedBuckets();
            const buckets2 = supabase_storage_service_1.SupabaseStorageService.getSupportedBuckets();
            expect(buckets1).toEqual(buckets2);
            // Test that the returned object is the same reference (const assertion)
            expect(Object.isFrozen(buckets1)).toBe(false); // TypeScript const assertion doesn't freeze at runtime
        });
        it('should provide access to all expected bucket types', () => {
            const buckets = supabase_storage_service_1.SupabaseStorageService.getSupportedBuckets();
            expect(buckets.USER_PROFILES).toBeDefined();
            expect(buckets.POST_ATTACHMENTS).toBeDefined();
            expect(buckets.MESSAGES).toBeDefined();
            expect(buckets.DOCUMENTS).toBeDefined();
            expect(buckets.WORKSHEETS).toBeDefined();
        });
    });
    // ===== UTILITY METHODS TESTS =====
    describe('getFileExtension', () => {
        it('should extract file extension correctly', () => {
            // Access private method through service instance
            const extractExtension = (filename) => {
                // We can't directly test private methods, but we can test through upload functionality
                // which uses getFileExtension internally
                return filename.substring(filename.lastIndexOf('.'));
            };
            const testCases = [
                { filename: 'test.jpg', expected: '.jpg' },
                { filename: 'document.pdf', expected: '.pdf' },
                { filename: 'archive.tar.gz', expected: '.gz' },
                { filename: 'file.with.multiple.dots.txt', expected: '.txt' },
                { filename: 'no-extension', expected: 'no-extension' },
                { filename: '.hidden', expected: '.hidden' },
                { filename: 'file.', expected: '.' },
            ];
            testCases.forEach(({ filename, expected }) => {
                if (filename.includes('.')) {
                    expect(extractExtension(filename)).toBe(expected);
                }
            });
        });
        it('should handle edge cases in file extension extraction', async () => {
            // Test through the upload functionality
            const testCases = [
                { filename: '', expectedExtension: '' },
                { filename: '.', expectedExtension: '.' },
                { filename: '..', expectedExtension: '.' },
                { filename: 'file', expectedExtension: '' },
                { filename: 'file.', expectedExtension: '.' },
            ];
            for (const testCase of testCases) {
                mockedUuidv4.mockReturnValue('test-uuid');
                const mockFile = createMockFile(testCase.filename);
                const result = await service.uploadFile(mockFile, mockBucket);
                if (testCase.expectedExtension) {
                    expect(result.filename).toBe(`test-uuid${testCase.expectedExtension}`);
                }
                else {
                    expect(result.filename).toBe('test-uuid');
                }
            }
        });
    });
    // ===== INTEGRATION TESTS =====
    describe('Integration scenarios', () => {
        it('should handle complete upload workflow', async () => {
            mockedAxios.post.mockResolvedValue({
                status: 200,
                data: { message: 'Success' },
            });
            const mockFile = createMockFile('integration-test.jpg', Buffer.from('test content'), 'image/jpeg', 2048);
            // Validate file first
            const validation = service.validateFile(mockFile);
            expect(validation.isValid).toBe(true);
            // Upload file
            const result = await service.uploadFile(mockFile, mockBucket);
            expect(result).toEqual({
                filename: mockUniqueFilename,
                url: `${mockSupabaseUrl}/storage/v1/object/public/${mockBucket}/${mockUniqueFilename}`,
                bucket: mockBucket,
            });
            // Verify the correct API calls
            expect(mockedAxios.post).toHaveBeenCalledWith(`${mockSupabaseUrl}/storage/v1/object/${mockBucket}/${mockUniqueFilename}`, mockFile.buffer, {
                headers: {
                    'Content-Type': 'image/jpeg',
                    Authorization: `Bearer ${mockSupabaseApiKey}`,
                },
            });
        });
        it('should handle upload and delete workflow', async () => {
            mockedAxios.post.mockResolvedValue({
                status: 200,
                data: { message: 'Upload success' },
            });
            mockedAxios.delete.mockResolvedValue({
                status: 200,
                data: { message: 'Delete success' },
            });
            const mockFile = createMockFile('temp-file.jpg');
            // Upload file
            const uploadResult = await service.uploadFile(mockFile, mockBucket);
            expect(uploadResult.filename).toBe(mockUniqueFilename);
            // Delete the uploaded file
            await service.deleteFile(mockBucket, uploadResult.filename);
            expect(mockedAxios.delete).toHaveBeenCalledWith(`${mockSupabaseUrl}/storage/v1/object/${mockBucket}/${uploadResult.filename}`, {
                headers: {
                    Authorization: `Bearer ${mockSupabaseApiKey}`,
                },
            });
        });
        it('should handle batch upload with validation', async () => {
            mockedAxios.post.mockResolvedValue({
                status: 200,
                data: { message: 'Success' },
            });
            const mockFiles = [
                createMockFile('valid1.jpg', Buffer.from('content1'), 'image/jpeg', 1024),
                createMockFile('valid2.png', Buffer.from('content2'), 'image/png', 2048),
                createMockFile('valid3.pdf', Buffer.from('content3'), 'application/pdf', 4096),
            ];
            // Validate all files first
            mockFiles.forEach((file) => {
                const validation = service.validateFile(file);
                expect(validation.isValid).toBe(true);
            });
            mockedUuidv4
                .mockReturnValueOnce('uuid-1')
                .mockReturnValueOnce('uuid-2')
                .mockReturnValueOnce('uuid-3');
            // Upload all files
            const results = await service.uploadFiles(mockFiles, mockBucket);
            expect(results).toHaveLength(3);
            expect(results[0].filename).toBe('uuid-1.jpg');
            expect(results[1].filename).toBe('uuid-2.png');
            expect(results[2].filename).toBe('uuid-3.pdf');
        });
        it('should handle error recovery in batch operations', async () => {
            const mockFiles = [
                createMockFile('file1.jpg'),
                createMockFile('file2.jpg'),
                createMockFile('file3.jpg'),
            ];
            // First upload succeeds, second fails, third would not be reached due to Promise.all
            mockedAxios.post
                .mockResolvedValueOnce({
                status: 200,
                data: { message: 'Success' },
            })
                .mockRejectedValueOnce(new Error('Network error'))
                .mockResolvedValueOnce({
                status: 200,
                data: { message: 'Success' },
            });
            await expect(service.uploadFiles(mockFiles, mockBucket)).rejects.toThrow('Failed to upload files to Supabase: Network error');
            // All uploads should be attempted due to Promise.all
            expect(mockedAxios.post).toHaveBeenCalledTimes(3);
        });
    });
    // ===== PERFORMANCE TESTS =====
    describe('Performance tests', () => {
        it('should handle concurrent file uploads efficiently', async () => {
            mockedAxios.post.mockResolvedValue({
                status: 200,
                data: { message: 'Success' },
            });
            const fileCount = 20;
            const mockFiles = Array.from({ length: fileCount }, (_, i) => createMockFile(`concurrent-file-${i}.jpg`));
            mockedUuidv4.mockImplementation(() => `uuid-${Date.now()}-${Math.random()}`);
            const startTime = Date.now();
            const results = await service.uploadFiles(mockFiles, mockBucket);
            const endTime = Date.now();
            expect(results).toHaveLength(fileCount);
            expect(endTime - startTime).toBeLessThan(5000); // Should complete within 5 seconds
            expect(mockedAxios.post).toHaveBeenCalledTimes(fileCount);
        });
        it('should handle large number of validations efficiently', () => {
            const fileCount = 100;
            const validations = [];
            const startTime = Date.now();
            for (let i = 0; i < fileCount; i++) {
                const mockFile = createMockFile(`file-${i}.jpg`);
                validations.push(service.validateFile(mockFile));
            }
            const endTime = Date.now();
            expect(validations).toHaveLength(fileCount);
            expect(validations.every(v => v.isValid)).toBe(true);
            expect(endTime - startTime).toBeLessThan(1000); // Should complete within 1 second
        });
        it('should handle repeated uploads without memory leaks', async () => {
            mockedAxios.post.mockResolvedValue({
                status: 200,
                data: { message: 'Success' },
            });
            const initialMemory = process.memoryUsage().heapUsed;
            // Perform many uploads
            for (let i = 0; i < 50; i++) {
                const mockFile = createMockFile(`repeated-file-${i}.jpg`);
                mockedUuidv4.mockReturnValue(`uuid-${i}`);
                await service.uploadFile(mockFile, mockBucket);
            }
            // Force garbage collection if available
            if (global.gc) {
                global.gc();
            }
            const finalMemory = process.memoryUsage().heapUsed;
            const memoryIncrease = finalMemory - initialMemory;
            // Memory increase should be reasonable (less than 5MB for 50 uploads)
            expect(memoryIncrease).toBeLessThan(5 * 1024 * 1024);
        });
    });
    // ===== ERROR HANDLING AND EDGE CASES =====
    describe('Error handling and edge cases', () => {
        it('should handle malformed Supabase responses', async () => {
            mockedAxios.post.mockResolvedValue({
                status: 200,
                data: null, // Malformed response
            });
            const mockFile = createMockFile();
            const result = await service.uploadFile(mockFile, mockBucket);
            // Should still work since we only check status code
            expect(result.filename).toBe(mockUniqueFilename);
        });
        it('should handle missing response data', async () => {
            mockedAxios.post.mockResolvedValue({
                status: 200,
                // Missing data property
            });
            const mockFile = createMockFile();
            const result = await service.uploadFile(mockFile, mockBucket);
            expect(result.filename).toBe(mockUniqueFilename);
        });
        it('should handle extremely large filenames', async () => {
            const longFilename = 'a'.repeat(255) + '.jpg';
            const mockFile = createMockFile(longFilename);
            // Should fail validation due to invalid characters from length constraint
            const validation = service.validateFile(mockFile);
            // The validation should still work, just checking for invalid characters
            // Long filenames are typically handled by the file system
            expect(validation.isValid).toBe(true); // Length itself isn't validated, only invalid chars
        });
        it('should handle files with Unicode characters in names', async () => {
            const unicodeFilename = 'файл_测试_ファイル.jpg';
            const mockFile = createMockFile(unicodeFilename);
            const validation = service.validateFile(mockFile);
            // Unicode characters would be replaced by underscores due to regex
            expect(validation.isValid).toBe(false);
            expect(validation.error).toBe('Filename contains invalid characters');
        });
        it('should handle null/undefined file properties', () => {
            const invalidFile = {
                originalname: null,
                buffer: undefined,
                mimetype: '',
                size: NaN,
            };
            expect(() => service.validateFile(invalidFile)).not.toThrow();
            // Should handle gracefully by checking what it can
        });
        it('should handle concurrent operations on same bucket', async () => {
            mockedAxios.post.mockResolvedValue({
                status: 200,
                data: { message: 'Success' },
            });
            mockedAxios.delete.mockResolvedValue({
                status: 200,
                data: { message: 'Success' },
            });
            const uploadPromises = Array.from({ length: 5 }, (_, i) => {
                const mockFile = createMockFile(`concurrent-${i}.jpg`);
                mockedUuidv4.mockReturnValue(`uuid-${i}`);
                return service.uploadFile(mockFile, mockBucket);
            });
            const deletePromises = Array.from({ length: 3 }, (_, i) => service.deleteFile(mockBucket, `file-to-delete-${i}.jpg`));
            // Run uploads and deletes concurrently
            const [uploadResults, deleteResults] = await Promise.all([
                Promise.all(uploadPromises),
                Promise.all(deletePromises),
            ]);
            expect(uploadResults).toHaveLength(5);
            expect(deleteResults).toHaveLength(3);
        });
        it('should handle service configuration edge cases', () => {
            // Test with various edge case configurations
            const edgeCaseConfigs = [
                { url: 'http://localhost', key: 'key' }, // No HTTPS
                { url: 'https://test.com/', key: 'key' }, // Trailing slash
                { url: '  https://test.com  ', key: '  key  ' }, // Whitespace
            ];
            edgeCaseConfigs.forEach(({ url, key }) => {
                configService.get.mockImplementation((configKey) => {
                    switch (configKey) {
                        case 'SUPABASE_URL':
                            return url;
                        case 'SUPABASE_API_KEY':
                            return key;
                        default:
                            return null;
                    }
                });
                // Should initialize without error for non-empty values
                if (url.trim() && key.trim()) {
                    expect(() => new supabase_storage_service_1.SupabaseStorageService(configService)).not.toThrow();
                }
            });
        });
        it('should handle axios timeout scenarios', async () => {
            const timeoutError = {
                code: 'ECONNABORTED',
                message: 'timeout of 30000ms exceeded',
            };
            mockedAxios.post.mockRejectedValue(timeoutError);
            const mockFile = createMockFile();
            await expect(service.uploadFile(mockFile, mockBucket)).rejects.toThrow('Failed to upload file to Supabase: timeout of 30000ms exceeded');
        });
        it('should handle network connectivity issues', async () => {
            const networkError = {
                code: 'ENOTFOUND',
                message: 'getaddrinfo ENOTFOUND test-project.supabase.co',
            };
            mockedAxios.post.mockRejectedValue(networkError);
            const mockFile = createMockFile();
            await expect(service.uploadFile(mockFile, mockBucket)).rejects.toThrow('Failed to upload file to Supabase: getaddrinfo ENOTFOUND test-project.supabase.co');
        });
    });
    // ===== SECURITY TESTS =====
    describe('Security considerations', () => {
        it('should prevent path traversal in filenames', () => {
            const maliciousFilenames = [
                '../../../etc/passwd',
                '..\\..\\windows\\system32',
                '/etc/hosts',
                'C:\\Windows\\System32\\config',
                '%2e%2e%2f%2e%2e%2f',
            ];
            maliciousFilenames.forEach((filename) => {
                const mockFile = createMockFile(filename);
                const validation = service.validateFile(mockFile);
                expect(validation.isValid).toBe(false);
                expect(validation.error).toBe('Filename contains invalid characters');
            });
        });
        it('should sanitize filenames with dangerous characters', () => {
            const dangerousFilenames = [
                '<script>alert("xss")</script>.jpg',
                'file;rm -rf /.jpg',
                'file`whoami`.jpg',
                'file$(command).jpg',
                'file&command&.jpg',
            ];
            dangerousFilenames.forEach((filename) => {
                const mockFile = createMockFile(filename);
                const validation = service.validateFile(mockFile);
                expect(validation.isValid).toBe(false);
                expect(validation.error).toBe('Filename contains invalid characters');
            });
        });
        it('should reject executable file types', () => {
            const executableMimeTypes = [
                'application/x-executable',
                'application/x-msdownload',
                'application/x-msdos-program',
                'application/x-msi',
                'application/x-sh',
                'application/x-bat',
            ];
            executableMimeTypes.forEach((mimetype) => {
                const mockFile = createMockFile('malicious.exe', Buffer.from('content'), mimetype);
                const validation = service.validateFile(mockFile);
                expect(validation.isValid).toBe(false);
                expect(validation.error).toContain('is not allowed');
            });
        });
        it('should handle oversized file attacks', () => {
            const massiveSize = Number.MAX_SAFE_INTEGER;
            const mockFile = createMockFile('huge.jpg', Buffer.alloc(0), 'image/jpeg', massiveSize);
            const validation = service.validateFile(mockFile);
            expect(validation.isValid).toBe(false);
            expect(validation.error).toContain('exceeds');
        });
        it('should handle authorization header correctly', async () => {
            mockedAxios.post.mockResolvedValue({
                status: 200,
                data: { message: 'Success' },
            });
            const mockFile = createMockFile();
            await service.uploadFile(mockFile, mockBucket);
            expect(mockedAxios.post).toHaveBeenCalledWith(expect.any(String), expect.any(Buffer), expect.objectContaining({
                headers: expect.objectContaining({
                    Authorization: `Bearer ${mockSupabaseApiKey}`,
                }),
            }));
            // Verify the API key is not logged or exposed
            expect(loggerSpy).not.toHaveBeenCalledWith(expect.stringContaining(mockSupabaseApiKey));
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL2NvbW1vbi9zZXJ2aWNlcy9zdXBhYmFzZS1zdG9yYWdlLnNlcnZpY2Uuc3BlYy50cyIsIm1hcHBpbmdzIjoiOztBQU9BLGFBQWE7QUFDYixJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0FBR25CLFlBQVk7QUFDWixJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBWmxCLDZDQUFzRDtBQUN0RCwyQ0FBd0M7QUFDeEMsMkNBQStDO0FBQy9DLHlFQUFzRjtBQUN0RixpQ0FBMEI7QUFDMUIsK0JBQW9DO0FBSXBDLE1BQU0sV0FBVyxHQUFHLGVBQWtDLENBQUM7QUFJdkQsTUFBTSxZQUFZLEdBQUcsU0FBNEMsQ0FBQztBQUVsRSxRQUFRLENBQUMsd0JBQXdCLEVBQUUsR0FBRyxFQUFFO0lBQ3RDLElBQUksT0FBK0IsQ0FBQztJQUNwQyxJQUFJLGFBQXlDLENBQUM7SUFDOUMsSUFBSSxTQUEyQixDQUFDO0lBQ2hDLElBQUksY0FBZ0MsQ0FBQztJQUNyQyxJQUFJLGFBQStCLENBQUM7SUFDcEMsSUFBSSxjQUFnQyxDQUFDO0lBRXJDLHNCQUFzQjtJQUN0QixNQUFNLGVBQWUsR0FBRyxrQ0FBa0MsQ0FBQztJQUMzRCxNQUFNLGtCQUFrQixHQUFHLGtCQUFrQixDQUFDO0lBQzlDLE1BQU0sVUFBVSxHQUFHLGFBQWEsQ0FBQztJQUNqQyxNQUFNLFlBQVksR0FBRyxlQUFlLENBQUM7SUFDckMsTUFBTSxrQkFBa0IsR0FBRyxtQkFBbUIsQ0FBQztJQUUvQyxNQUFNLGNBQWMsR0FBRyxDQUNyQixlQUF1QixlQUFlLEVBQ3RDLFNBQWlCLE1BQU0sQ0FBQyxJQUFJLENBQUMsbUJBQW1CLENBQUMsRUFDakQsV0FBbUIsWUFBWSxFQUMvQixPQUFlLElBQUksRUFDRSxFQUFFLENBQUMsQ0FBQztRQUN6QixTQUFTLEVBQUUsTUFBTTtRQUNqQixZQUFZO1FBQ1osUUFB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QUFLLENBQUMsQ0FBQztZQUN2QyxNQUFNLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUNoRCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyw4Q0FBOEMsRUFBRSxLQUFLLElBQUksRUFBRTtZQUM1RCxXQUFXLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDO2dCQUNqQyxNQUFNLEVBQUUsR0FBRztnQkFDWCxJQUFJLEVBQUUsRUFBRSxPQUFPLEVBQUUsU0FBUyxFQUFFO2FBQzdCLENBQUMsQ0FBQztZQUVILE1BQU0sUUFBUSxHQUFHLGNBQWMsRUFBRSxDQUFDO1lBQ2xDLE1BQU0sT0FBTyxDQUFDLFVBQVUsQ0FBQyxRQUFRLEVBQUUsVUFBVSxDQUFDLENBQUM7WUFFL0MsTUFBTSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxvQkFBb0IsQ0FDM0MsTUFBTSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsRUFDbEIsTUFBTSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsRUFDbEIsTUFBTSxDQUFDLGdCQUFnQixDQUFDO2dCQUN0QixPQUFPLEVBQUUsTUFBTSxDQUFDLGdCQUFnQixDQUFDO29CQUMvQixhQUFhLEVBQUUsVUFBVSxrQkFBa0IsRUFBRTtpQkFDOUMsQ0FBQzthQUNILENBQUMsQ0FDSCxDQUFDO1lBRUYsOENBQThDO1lBQzlDLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQyxHQUFHLENBQUMsb0JBQW9CLENBQ3hDLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxrQkFBa0IsQ0FBQyxDQUM1QyxDQUFDO1FBQ0osQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9ob21lL3dldG9vYS9Eb2N1bWVudHMvY29kZS9wcm9qZWN0cy9tZW50YXJhL21lbnRhcmEtYXBpL3NyYy9jb21tb24vc2VydmljZXMvc3VwYWJhc2Utc3RvcmFnZS5zZXJ2aWNlLnNwZWMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVGVzdCwgVGVzdGluZ01vZHVsZSB9IGZyb20gJ0BuZXN0anMvdGVzdGluZyc7XG5pbXBvcnQgeyBMb2dnZXIgfSBmcm9tICdAbmVzdGpzL2NvbW1vbic7XG5pbXBvcnQgeyBDb25maWdTZXJ2aWNlIH0gZnJvbSAnQG5lc3Rqcy9jb25maWcnO1xuaW1wb3J0IHsgU3VwYWJhc2VTdG9yYWdlU2VydmljZSwgRmlsZVVwbG9hZFJlc3VsdCB9IGZyb20gJy4vc3VwYWJhc2Utc3RvcmFnZS5zZXJ2aWNlJztcbmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7XG5pbXBvcnQgeyB2NCBhcyB1dWlkdjQgfSBmcm9tICd1dWlkJztcblxuLy8gTW9jayBheGlvc1xuamVzdC5tb2NrKCdheGlvcycpO1xuY29uc3QgbW9ja2VkQXhpb3MgPSBheGlvcyBhcyBqZXN0Lk1vY2tlZDx0eXBlb2YgYXhpb3M+O1xuXG4vLyBNb2NrIHV1aWRcbmplc3QubW9jaygndXVpZCcpO1xuY29uc3QgbW9ja2VkVXVpZHY0ID0gdXVpZHY0IGFzIGplc3QuTW9ja2VkRnVuY3Rpb248dHlwZW9mIHV1aWR2ND47XG5cbmRlc2NyaWJlKCdTdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlJywgKCkgPT4ge1xuICBsZXQgc2VydmljZTogU3VwYWJhc2VTdG9yYWdlU2VydmljZTtcbiAgbGV0IGNvbmZpZ1NlcnZpY2U6IGplc3QuTW9ja2VkPENvbmZpZ1NlcnZpY2U+O1xuICBsZXQgbG9nZ2VyU3B5OiBqZXN0LlNweUluc3RhbmNlO1xuICBsZXQgbG9nZ2VyRGVidWdTcHk6IGplc3QuU3B5SW5zdGFuY2U7XG4gIGxldCBsb2dnZXJXYXJuU3B5OiBqZXN0LlNweUluc3RhbmNlO1xuICBsZXQgbG9nZ2VyRXJyb3JTcHk6IGplc3QuU3B5SW5zdGFuY2U7XG5cbiAgLy8gVGVzdCBkYXRhIGNvbnN0YW50c1xuICBjb25zdCBtb2NrU3VwYWJhc2VVcmwgPSAnaHR0cHM6Ly90ZXN0LXByb2plY3Quc3VwYWJhc2UuY28nO1xuICBjb25zdCBtb2NrU3VwYWJhc2VBcGlLZXkgPSAndGVzdC1hcGkta2V5LTEyMyc7XG4gIGNvbnN0IG1vY2tCdWNrZXQgPSAndGVzdC1idWNrZXQnO1xuICBjb25zdCBtb2NrRmlsZW5hbWUgPSAndGVzdC1maWxlLmpwZyc7XG4gIGNvbnN0IG1vY2tVbmlxdWVGaWxlbmFtZSA9ICd1bmlxdWUtaWQtMTIzLmpwZyc7XG5cbiAgY29uc3QgY3JlYXRlTW9ja0ZpbGUgPSAoXG4gICAgb3JpZ2luYWxuYW1lOiBzdHJpbmcgPSAndGVzdC1maWxlLmpwZycsXG4gICAgYnVmZmVyOiBCdWZmZXIgPSBCdWZmZXIuZnJvbSgndGVzdCBmaWxlIGNvbnRlbnQnKSxcbiAgICBtaW1ldHlwZTogc3RyaW5nID0gJ2ltYWdlL2pwZWcnLFxuICAgIHNpemU6IG51bWJlciA9IDEwMjQsXG4gICk6IEV4cHJlc3MuTXVsdGVyLkZpbGUgPT4gKHtcbiAgICBmaWVsZG5hbWU6ICdmaWxlJyxcbiAgICBvcmlnaW5hbG5hbWUsXG4gICAgZW5jb2Rpbmc6ICc3Yml0JyxcbiAgICBtaW1ldHlwZSxcbiAgICBidWZmZXIsXG4gICAgc2l6ZSxcbiAgICBkZXN0aW5hdGlvbjogJycsXG4gICAgZmlsZW5hbWU6ICcnLFxuICAgIHBhdGg6ICcnLFxuICAgIHN0cmVhbTogbnVsbCBhcyBhbnksXG4gIH0pO1xuXG4gIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xuICAgIC8vIFJlc2V0IGFsbCBtb2Nrc1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICAgIGplc3QucmVzZXRBbGxNb2NrcygpO1xuXG4gICAgY29uc3QgbW9kdWxlOiBUZXN0aW5nTW9kdWxlID0gYXdhaXQgVGVzdC5jcmVhdGVUZXN0aW5nTW9kdWxlKHtcbiAgICAgIHByb3ZpZGVyczogW1xuICAgICAgICBTdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlLFxuICAgICAgICB7XG4gICAgICAgICAgcHJvdmlkZTogQ29uZmlnU2VydmljZSxcbiAgICAgICAgICB1c2VWYWx1ZToge1xuICAgICAgICAgICAgZ2V0OiBqZXN0LmZuKCksXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSkuY29tcGlsZSgpO1xuXG4gICAgY29uZmlnU2VydmljZSA9IG1vZHVsZS5nZXQoQ29uZmlnU2VydmljZSk7XG4gICAgXG4gICAgLy8gU2V0dXAgZGVmYXVsdCBjb25maWcgdmFsdWVzXG4gICAgY29uZmlnU2VydmljZS5nZXQubW9ja0ltcGxlbWVudGF0aW9uKChrZXk6IHN0cmluZykgPT4ge1xuICAgICAgc3dpdGNoIChrZXkpIHtcbiAgICAgICAgY2FzZSAnU1VQQUJBU0VfVVJMJzpcbiAgICAgICAgICByZXR1cm4gbW9ja1N1cGFiYXNlVXJsO1xuICAgICAgICBjYXNlICdTVVBBQkFTRV9BUElfS0VZJzpcbiAgICAgICAgICByZXR1cm4gbW9ja1N1cGFiYXNlQXBpS2V5O1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgc2VydmljZSA9IG1vZHVsZS5nZXQ8U3VwYWJhc2VTdG9yYWdlU2VydmljZT4oU3VwYWJhc2VTdG9yYWdlU2VydmljZSk7XG5cbiAgICAvLyBTZXR1cCBsb2dnZXIgc3BpZXNcbiAgICBsb2dnZXJTcHkgPSBqZXN0LnNweU9uKExvZ2dlci5wcm90b3R5cGUsICdsb2cnKS5tb2NrSW1wbGVtZW50YXRpb24oKTtcbiAgICBsb2dnZXJEZWJ1Z1NweSA9IGplc3Quc3B5T24oTG9nZ2VyLnByb3RvdHlwZSwgJ2RlYnVnJykubW9ja0ltcGxlbWVudGF0aW9uKCk7XG4gICAgbG9nZ2VyV2FyblNweSA9IGplc3Quc3B5T24oTG9nZ2VyLnByb3RvdHlwZSwgJ3dhcm4nKS5tb2NrSW1wbGVtZW50YXRpb24oKTtcbiAgICBsb2dnZXJFcnJvclNweSA9IGplc3Quc3B5T24oTG9nZ2VyLnByb3RvdHlwZSwgJ2Vycm9yJykubW9ja0ltcGxlbWVudGF0aW9uKCk7XG5cbiAgICAvLyBTZXR1cCBVVUlEIG1vY2tcbiAgICBtb2NrZWRVdWlkdjQubW9ja1JldHVyblZhbHVlKCd1bmlxdWUtaWQtMTIzJyk7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgamVzdC5yZXN0b3JlQWxsTW9ja3MoKTtcbiAgfSk7XG5cbiAgLy8gPT09PT0gSU5JVElBTElaQVRJT04gVEVTVFMgPT09PT1cblxuICBkZXNjcmliZSgnSW5pdGlhbGl6YXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBpbml0aWFsaXplIHN1Y2Nlc3NmdWxseSB3aXRoIHZhbGlkIGNvbmZpZ3VyYXRpb24nLCAoKSA9PiB7XG4gICAgICBleHBlY3Qoc2VydmljZSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChjb25maWdTZXJ2aWNlLmdldCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ1NVUEFCQVNFX1VSTCcpO1xuICAgICAgZXhwZWN0KGNvbmZpZ1NlcnZpY2UuZ2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnU1VQQUJBU0VfQVBJX0tFWScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0aHJvdyBlcnJvciB3aGVuIFNVUEFCQVNFX1VSTCBpcyBtaXNzaW5nJywgKCkgPT4ge1xuICAgICAgY29uZmlnU2VydmljZS5nZXQubW9ja0ltcGxlbWVudGF0aW9uKChrZXk6IHN0cmluZykgPT4ge1xuICAgICAgICBzd2l0Y2ggKGtleSkge1xuICAgICAgICAgIGNhc2UgJ1NVUEFCQVNFX1VSTCc6XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICBjYXNlICdTVVBBQkFTRV9BUElfS0VZJzpcbiAgICAgICAgICAgIHJldHVybiBtb2NrU3VwYWJhc2VBcGlLZXk7XG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KCgpID0+IG5ldyBTdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlKGNvbmZpZ1NlcnZpY2UpKS50b1Rocm93KFxuICAgICAgICAnU3VwYWJhc2UgY29uZmlndXJhdGlvbiBpcyBtaXNzaW5nLiBQbGVhc2Ugc2V0IFNVUEFCQVNFX1VSTCBhbmQgU1VQQUJBU0VfQVBJX0tFWSBlbnZpcm9ubWVudCB2YXJpYWJsZXMuJyxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IGVycm9yIHdoZW4gU1VQQUJBU0VfQVBJX0tFWSBpcyBtaXNzaW5nJywgKCkgPT4ge1xuICAgICAgY29uZmlnU2VydmljZS5nZXQubW9ja0ltcGxlbWVudGF0aW9uKChrZXk6IHN0cmluZykgPT4ge1xuICAgICAgICBzd2l0Y2ggKGtleSkge1xuICAgICAgICAgIGNhc2UgJ1NVUEFCQVNFX1VSTCc6XG4gICAgICAgICAgICByZXR1cm4gbW9ja1N1cGFiYXNlVXJsO1xuICAgICAgICAgIGNhc2UgJ1NVUEFCQVNFX0FQSV9LRVknOlxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KCgpID0+IG5ldyBTdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlKGNvbmZpZ1NlcnZpY2UpKS50b1Rocm93KFxuICAgICAgICAnU3VwYWJhc2UgY29uZmlndXJhdGlvbiBpcyBtaXNzaW5nLiBQbGVhc2Ugc2V0IFNVUEFCQVNFX1VSTCBhbmQgU1VQQUJBU0VfQVBJX0tFWSBlbnZpcm9ubWVudCB2YXJpYWJsZXMuJyxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IGVycm9yIHdoZW4gYm90aCBTVVBBQkFTRV9VUkwgYW5kIFNVUEFCQVNFX0FQSV9LRVkgYXJlIG1pc3NpbmcnLCAoKSA9PiB7XG4gICAgICBjb25maWdTZXJ2aWNlLmdldC5tb2NrSW1wbGVtZW50YXRpb24oKGtleTogc3RyaW5nKSA9PiB7XG4gICAgICAgIHN3aXRjaCAoa2V5KSB7XG4gICAgICAgICAgY2FzZSAnU1VQQUJBU0VfVVJMJzpcbiAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgICBjYXNlICdTVVBBQkFTRV9BUElfS0VZJzpcbiAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QoKCkgPT4gbmV3IFN1cGFiYXNlU3RvcmFnZVNlcnZpY2UoY29uZmlnU2VydmljZSkpLnRvVGhyb3coXG4gICAgICAgICdTdXBhYmFzZSBjb25maWd1cmF0aW9uIGlzIG1pc3NpbmcuIFBsZWFzZSBzZXQgU1VQQUJBU0VfVVJMIGFuZCBTVVBBQkFTRV9BUElfS0VZIGVudmlyb25tZW50IHZhcmlhYmxlcy4nLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGVtcHR5IHN0cmluZyBjb25maWd1cmF0aW9uIHZhbHVlcycsICgpID0+IHtcbiAgICAgIGNvbmZpZ1NlcnZpY2UuZ2V0Lm1vY2tJbXBsZW1lbnRhdGlvbigoa2V5OiBzdHJpbmcpID0+IHtcbiAgICAgICAgc3dpdGNoIChrZXkpIHtcbiAgICAgICAgICBjYXNlICdTVVBBQkFTRV9VUkwnOlxuICAgICAgICAgICAgcmV0dXJuICcgICAnOyAvLyBXaGl0ZXNwYWNlIG9ubHlcbiAgICAgICAgICBjYXNlICdTVVBBQkFTRV9BUElfS0VZJzpcbiAgICAgICAgICAgIHJldHVybiAnJzsgLy8gRW1wdHkgc3RyaW5nXG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KCgpID0+IG5ldyBTdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlKGNvbmZpZ1NlcnZpY2UpKS50b1Rocm93KFxuICAgICAgICAnU3VwYWJhc2UgY29uZmlndXJhdGlvbiBpcyBtaXNzaW5nLiBQbGVhc2Ugc2V0IFNVUEFCQVNFX1VSTCBhbmQgU1VQQUJBU0VfQVBJX0tFWSBlbnZpcm9ubWVudCB2YXJpYWJsZXMuJyxcbiAgICAgICk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIC8vID09PT09IFNJTkdMRSBGSUxFIFVQTE9BRCBURVNUUyA9PT09PVxuXG4gIGRlc2NyaWJlKCd1cGxvYWRGaWxlJywgKCkgPT4ge1xuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgbW9ja2VkQXhpb3MucG9zdC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIHN0YXR1czogMjAwLFxuICAgICAgICBkYXRhOiB7IG1lc3NhZ2U6ICdGaWxlIHVwbG9hZGVkIHN1Y2Nlc3NmdWxseScgfSxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB1cGxvYWQgZmlsZSBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrRmlsZSA9IGNyZWF0ZU1vY2tGaWxlKCk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UudXBsb2FkRmlsZShtb2NrRmlsZSwgbW9ja0J1Y2tldCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoe1xuICAgICAgICBmaWxlbmFtZTogbW9ja1VuaXF1ZUZpbGVuYW1lLFxuICAgICAgICB1cmw6IGAke21vY2tTdXBhYmFzZVVybH0vc3RvcmFnZS92MS9vYmplY3QvcHVibGljLyR7bW9ja0J1Y2tldH0vJHttb2NrVW5pcXVlRmlsZW5hbWV9YCxcbiAgICAgICAgYnVja2V0OiBtb2NrQnVja2V0LFxuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChtb2NrZWRBeGlvcy5wb3N0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgYCR7bW9ja1N1cGFiYXNlVXJsfS9zdG9yYWdlL3YxL29iamVjdC8ke21vY2tCdWNrZXR9LyR7bW9ja1VuaXF1ZUZpbGVuYW1lfWAsXG4gICAgICAgIG1vY2tGaWxlLmJ1ZmZlcixcbiAgICAgICAge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiBtb2NrRmlsZS5taW1ldHlwZSxcbiAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHttb2NrU3VwYWJhc2VBcGlLZXl9YCxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KGxvZ2dlclNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIGBVcGxvYWRpbmcgZmlsZSB0byBTdXBhYmFzZTogJHttb2NrRmlsZS5vcmlnaW5hbG5hbWV9IChidWNrZXQ6ICR7bW9ja0J1Y2tldH0pYCxcbiAgICAgICk7XG4gICAgICBleHBlY3QobG9nZ2VyU3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgYEZpbGUgdXBsb2FkZWQgc3VjY2Vzc2Z1bGx5IHRvIFN1cGFiYXNlOiAke21vY2tVbmlxdWVGaWxlbmFtZX1gLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZ2VuZXJhdGUgdW5pcXVlIGZpbGVuYW1lcyBmb3IgZmlsZXMgd2l0aCBzYW1lIG5hbWUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrRmlsZTEgPSBjcmVhdGVNb2NrRmlsZSgndGVzdC5qcGcnKTtcbiAgICAgIGNvbnN0IG1vY2tGaWxlMiA9IGNyZWF0ZU1vY2tGaWxlKCd0ZXN0LmpwZycpO1xuICAgICAgXG4gICAgICBtb2NrZWRVdWlkdjRcbiAgICAgICAgLm1vY2tSZXR1cm5WYWx1ZU9uY2UoJ3VuaXF1ZS1pZC0xJylcbiAgICAgICAgLm1vY2tSZXR1cm5WYWx1ZU9uY2UoJ3VuaXF1ZS1pZC0yJyk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdDEgPSBhd2FpdCBzZXJ2aWNlLnVwbG9hZEZpbGUobW9ja0ZpbGUxLCBtb2NrQnVja2V0KTtcbiAgICAgIGNvbnN0IHJlc3VsdDIgPSBhd2FpdCBzZXJ2aWNlLnVwbG9hZEZpbGUobW9ja0ZpbGUyLCBtb2NrQnVja2V0KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdDEuZmlsZW5hbWUpLnRvQmUoJ3VuaXF1ZS1pZC0xLmpwZycpO1xuICAgICAgZXhwZWN0KHJlc3VsdDIuZmlsZW5hbWUpLnRvQmUoJ3VuaXF1ZS1pZC0yLmpwZycpO1xuICAgICAgZXhwZWN0KHJlc3VsdDEuZmlsZW5hbWUpLm5vdC50b0JlKHJlc3VsdDIuZmlsZW5hbWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZmlsZXMgd2l0aCBubyBleHRlbnNpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrRmlsZSA9IGNyZWF0ZU1vY2tGaWxlKCdSRUFETUUnKTtcbiAgICAgIG1vY2tlZFV1aWR2NC5tb2NrUmV0dXJuVmFsdWUoJ3VuaXF1ZS1pZC1uby1leHQnKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS51cGxvYWRGaWxlKG1vY2tGaWxlLCBtb2NrQnVja2V0KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5maWxlbmFtZSkudG9CZSgndW5pcXVlLWlkLW5vLWV4dCcpO1xuICAgICAgZXhwZWN0KG1vY2tlZEF4aW9zLnBvc3QpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBgJHttb2NrU3VwYWJhc2VVcmx9L3N0b3JhZ2UvdjEvb2JqZWN0LyR7bW9ja0J1Y2tldH0vdW5pcXVlLWlkLW5vLWV4dGAsXG4gICAgICAgIGV4cGVjdC5hbnkoQnVmZmVyKSxcbiAgICAgICAgZXhwZWN0LmFueShPYmplY3QpLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGZpbGVzIHdpdGggbXVsdGlwbGUgZG90cyBpbiBmaWxlbmFtZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tGaWxlID0gY3JlYXRlTW9ja0ZpbGUoJ215LmZpbGUud2l0aC5kb3RzLnR4dCcpO1xuICAgICAgbW9ja2VkVXVpZHY0Lm1vY2tSZXR1cm5WYWx1ZSgndW5pcXVlLWlkLWRvdHMnKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS51cGxvYWRGaWxlKG1vY2tGaWxlLCBtb2NrQnVja2V0KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5maWxlbmFtZSkudG9CZSgndW5pcXVlLWlkLWRvdHMudHh0Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBkaWZmZXJlbnQgZmlsZSB0eXBlcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRlc3RDYXNlcyA9IFtcbiAgICAgICAgeyBmaWxlbmFtZTogJ2RvY3VtZW50LnBkZicsIG1pbWV0eXBlOiAnYXBwbGljYXRpb24vcGRmJywgZXh0ZW5zaW9uOiAnLnBkZicgfSxcbiAgICAgICAgeyBmaWxlbmFtZTogJ2ltYWdlLnBuZycsIG1pbWV0eXBlOiAnaW1hZ2UvcG5nJywgZXh0ZW5zaW9uOiAnLnBuZycgfSxcbiAgICAgICAgeyBmaWxlbmFtZTogJ2RhdGEuY3N2JywgbWltZXR5cGU6ICd0ZXh0L2NzdicsIGV4dGVuc2lvbjogJy5jc3YnIH0sXG4gICAgICAgIHsgZmlsZW5hbWU6ICdhcmNoaXZlLnppcCcsIG1pbWV0eXBlOiAnYXBwbGljYXRpb24vemlwJywgZXh0ZW5zaW9uOiAnLnppcCcgfSxcbiAgICAgIF07XG5cbiAgICAgIGZvciAoY29uc3QgdGVzdENhc2Ugb2YgdGVzdENhc2VzKSB7XG4gICAgICAgIGNvbnN0IG1vY2tGaWxlID0gY3JlYXRlTW9ja0ZpbGUodGVzdENhc2UuZmlsZW5hbWUsIEJ1ZmZlci5mcm9tKCdjb250ZW50JyksIHRlc3RDYXNlLm1pbWV0eXBlKTtcbiAgICAgICAgbW9ja2VkVXVpZHY0Lm1vY2tSZXR1cm5WYWx1ZShgdW5pcXVlLWlkLSR7dGVzdENhc2UuZXh0ZW5zaW9uLnN1YnN0cmluZygxKX1gKTtcblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLnVwbG9hZEZpbGUobW9ja0ZpbGUsIG1vY2tCdWNrZXQpO1xuXG4gICAgICAgIGV4cGVjdChyZXN1bHQuZmlsZW5hbWUpLnRvQmUoYHVuaXF1ZS1pZC0ke3Rlc3RDYXNlLmV4dGVuc2lvbi5zdWJzdHJpbmcoMSl9JHt0ZXN0Q2FzZS5leHRlbnNpb259YCk7XG4gICAgICAgIGV4cGVjdChtb2NrZWRBeGlvcy5wb3N0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgICBleHBlY3Quc3RyaW5nQ29udGFpbmluZyhyZXN1bHQuZmlsZW5hbWUpLFxuICAgICAgICAgIG1vY2tGaWxlLmJ1ZmZlcixcbiAgICAgICAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgICAgICBoZWFkZXJzOiBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiB0ZXN0Q2FzZS5taW1ldHlwZSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIH0pLFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgMjAxIHN0YXR1cyBjb2RlIGFzIHN1Y2Nlc3MnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrZWRBeGlvcy5wb3N0Lm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgc3RhdHVzOiAyMDEsXG4gICAgICAgIGRhdGE6IHsgbWVzc2FnZTogJ0ZpbGUgY3JlYXRlZCBzdWNjZXNzZnVsbHknIH0sXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgbW9ja0ZpbGUgPSBjcmVhdGVNb2NrRmlsZSgpO1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS51cGxvYWRGaWxlKG1vY2tGaWxlLCBtb2NrQnVja2V0KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5maWxlbmFtZSkudG9CZShtb2NrVW5pcXVlRmlsZW5hbWUpO1xuICAgICAgZXhwZWN0KGxvZ2dlckRlYnVnU3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgYEZpbGUgdXBsb2FkZWQgc3VjY2Vzc2Z1bGx5IHRvIFN1cGFiYXNlOiAke21vY2tVbmlxdWVGaWxlbmFtZX1gLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG5ldHdvcmsgZXJyb3JzIGR1cmluZyB1cGxvYWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBuZXR3b3JrRXJyb3IgPSBuZXcgRXJyb3IoJ05ldHdvcmsgZXJyb3InKTtcbiAgICAgIG1vY2tlZEF4aW9zLnBvc3QubW9ja1JlamVjdGVkVmFsdWUobmV0d29ya0Vycm9yKTtcblxuICAgICAgY29uc3QgbW9ja0ZpbGUgPSBjcmVhdGVNb2NrRmlsZSgpO1xuXG4gICAgICBhd2FpdCBleHBlY3Qoc2VydmljZS51cGxvYWRGaWxlKG1vY2tGaWxlLCBtb2NrQnVja2V0KSkucmVqZWN0cy50b1Rocm93KFxuICAgICAgICAnRmFpbGVkIHRvIHVwbG9hZCBmaWxlIHRvIFN1cGFiYXNlOiBOZXR3b3JrIGVycm9yJyxcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChsb2dnZXJFcnJvclNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIGBFcnJvciB1cGxvYWRpbmcgZmlsZSB0byBTdXBhYmFzZTogJHttb2NrRmlsZS5vcmlnaW5hbG5hbWV9YCxcbiAgICAgICAgbmV0d29ya0Vycm9yLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIEhUVFAgZXJyb3JzIHdpdGggcmVzcG9uc2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBodHRwRXJyb3IgPSB7XG4gICAgICAgIHJlc3BvbnNlOiB7XG4gICAgICAgICAgc3RhdHVzOiA0MDAsXG4gICAgICAgICAgZGF0YTogeyBtZXNzYWdlOiAnSW52YWxpZCBmaWxlIGZvcm1hdCcgfSxcbiAgICAgICAgICBzdGF0dXNUZXh0OiAnQmFkIFJlcXVlc3QnLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICAgIG1vY2tlZEF4aW9zLnBvc3QubW9ja1JlamVjdGVkVmFsdWUoaHR0cEVycm9yKTtcblxuICAgICAgY29uc3QgbW9ja0ZpbGUgPSBjcmVhdGVNb2NrRmlsZSgpO1xuXG4gICAgICBhd2FpdCBleHBlY3Qoc2VydmljZS51cGxvYWRGaWxlKG1vY2tGaWxlLCBtb2NrQnVja2V0KSkucmVqZWN0cy50b1Rocm93KFxuICAgICAgICAnRmFpbGVkIHRvIHVwbG9hZCBmaWxlIHRvIFN1cGFiYXNlOiBTdXBhYmFzZSB1cGxvYWQgZmFpbGVkOiBJbnZhbGlkIGZpbGUgZm9ybWF0JyxcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChsb2dnZXJFcnJvclNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIGBTdXBhYmFzZSBBUEkgZXJyb3I6IDQwMCAtICR7SlNPTi5zdHJpbmdpZnkoaHR0cEVycm9yLnJlc3BvbnNlLmRhdGEpfWAsXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgSFRUUCBlcnJvcnMgd2l0aG91dCBtZXNzYWdlIGluIHJlc3BvbnNlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgaHR0cEVycm9yID0ge1xuICAgICAgICByZXNwb25zZToge1xuICAgICAgICAgIHN0YXR1czogNTAwLFxuICAgICAgICAgIGRhdGE6IHt9LFxuICAgICAgICAgIHN0YXR1c1RleHQ6ICdJbnRlcm5hbCBTZXJ2ZXIgRXJyb3InLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICAgIG1vY2tlZEF4aW9zLnBvc3QubW9ja1JlamVjdGVkVmFsdWUoaHR0cEVycm9yKTtcblxuICAgICAgY29uc3QgbW9ja0ZpbGUgPSBjcmVhdGVNb2NrRmlsZSgpO1xuXG4gICAgICBhd2FpdCBleHBlY3Qoc2VydmljZS51cGxvYWRGaWxlKG1vY2tGaWxlLCBtb2NrQnVja2V0KSkucmVqZWN0cy50b1Rocm93KFxuICAgICAgICAnRmFpbGVkIHRvIHVwbG9hZCBmaWxlIHRvIFN1cGFiYXNlOiBTdXBhYmFzZSB1cGxvYWQgZmFpbGVkOiBJbnRlcm5hbCBTZXJ2ZXIgRXJyb3InLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG5vbi1zdWNjZXNzIEhUVFAgc3RhdHVzIGNvZGVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja2VkQXhpb3MucG9zdC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIHN0YXR1czogNDA0LFxuICAgICAgICBkYXRhOiB7IGVycm9yOiAnQnVja2V0IG5vdCBmb3VuZCcgfSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBtb2NrRmlsZSA9IGNyZWF0ZU1vY2tGaWxlKCk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChzZXJ2aWNlLnVwbG9hZEZpbGUobW9ja0ZpbGUsIG1vY2tCdWNrZXQpKS5yZWplY3RzLnRvVGhyb3coXG4gICAgICAgICdGYWlsZWQgdG8gdXBsb2FkIGZpbGUgdG8gU3VwYWJhc2U6IFN1cGFiYXNlIHVwbG9hZCBmYWlsZWQgd2l0aCBzdGF0dXM6IDQwNCcsXG4gICAgICApO1xuXG4gICAgICBleHBlY3QobG9nZ2VyRXJyb3JTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBleHBlY3Quc3RyaW5nQ29udGFpbmluZygnRmFpbGVkIHRvIHVwbG9hZCBmaWxlIHRvIFN1cGFiYXNlLiBTdGF0dXM6IDQwNCcpLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGxhcmdlIGZpbGVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbGFyZ2VCdWZmZXIgPSBCdWZmZXIuYWxsb2MoMTAgKiAxMDI0ICogMTAyNCk7IC8vIDEwTUJcbiAgICAgIGNvbnN0IG1vY2tGaWxlID0gY3JlYXRlTW9ja0ZpbGUoJ2xhcmdlLWZpbGUuanBnJywgbGFyZ2VCdWZmZXIsICdpbWFnZS9qcGVnJywgMTAgKiAxMDI0ICogMTAyNCk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UudXBsb2FkRmlsZShtb2NrRmlsZSwgbW9ja0J1Y2tldCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuZmlsZW5hbWUpLnRvQmUobW9ja1VuaXF1ZUZpbGVuYW1lKTtcbiAgICAgIGV4cGVjdChtb2NrZWRBeGlvcy5wb3N0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgZXhwZWN0LmFueShTdHJpbmcpLFxuICAgICAgICBsYXJnZUJ1ZmZlcixcbiAgICAgICAgZXhwZWN0LmFueShPYmplY3QpLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGVtcHR5IGZpbGVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZW1wdHlCdWZmZXIgPSBCdWZmZXIuYWxsb2MoMCk7XG4gICAgICBjb25zdCBtb2NrRmlsZSA9IGNyZWF0ZU1vY2tGaWxlKCdlbXB0eS1maWxlLnR4dCcsIGVtcHR5QnVmZmVyLCAndGV4dC9wbGFpbicsIDApO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLnVwbG9hZEZpbGUobW9ja0ZpbGUsIG1vY2tCdWNrZXQpO1xuXG4gICAgICBleHBlY3QocmVzdWx0LmZpbGVuYW1lKS50b0JlKCd1bmlxdWUtaWQtMTIzLnR4dCcpO1xuICAgICAgZXhwZWN0KG1vY2tlZEF4aW9zLnBvc3QpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBleHBlY3QuYW55KFN0cmluZyksXG4gICAgICAgIGVtcHR5QnVmZmVyLFxuICAgICAgICBleHBlY3QuYW55KE9iamVjdCksXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcblxuICAvLyA9PT09PSBNVUxUSVBMRSBGSUxFUyBVUExPQUQgVEVTVFMgPT09PT1cblxuICBkZXNjcmliZSgndXBsb2FkRmlsZXMnLCAoKSA9PiB7XG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICBtb2NrZWRBeGlvcy5wb3N0Lm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgIGRhdGE6IHsgbWVzc2FnZTogJ0ZpbGUgdXBsb2FkZWQgc3VjY2Vzc2Z1bGx5JyB9LFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHVwbG9hZCBtdWx0aXBsZSBmaWxlcyBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrRmlsZXMgPSBbXG4gICAgICAgIGNyZWF0ZU1vY2tGaWxlKCdmaWxlMS5qcGcnKSxcbiAgICAgICAgY3JlYXRlTW9ja0ZpbGUoJ2ZpbGUyLnBuZycpLFxuICAgICAgICBjcmVhdGVNb2NrRmlsZSgnZmlsZTMucGRmJywgQnVmZmVyLmZyb20oJ3BkZiBjb250ZW50JyksICdhcHBsaWNhdGlvbi9wZGYnKSxcbiAgICAgIF07XG5cbiAgICAgIG1vY2tlZFV1aWR2NFxuICAgICAgICAubW9ja1JldHVyblZhbHVlT25jZSgndXVpZC0xJylcbiAgICAgICAgLm1vY2tSZXR1cm5WYWx1ZU9uY2UoJ3V1aWQtMicpXG4gICAgICAgIC5tb2NrUmV0dXJuVmFsdWVPbmNlKCd1dWlkLTMnKTtcblxuICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IHNlcnZpY2UudXBsb2FkRmlsZXMobW9ja0ZpbGVzLCBtb2NrQnVja2V0KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdHMpLnRvSGF2ZUxlbmd0aCgzKTtcbiAgICAgIGV4cGVjdChyZXN1bHRzWzBdKS50b0VxdWFsKHtcbiAgICAgICAgZmlsZW5hbWU6ICd1dWlkLTEuanBnJyxcbiAgICAgICAgdXJsOiBgJHttb2NrU3VwYWJhc2VVcmx9L3N0b3JhZ2UvdjEvb2JqZWN0L3B1YmxpYy8ke21vY2tCdWNrZXR9L3V1aWQtMS5qcGdgLFxuICAgICAgICBidWNrZXQ6IG1vY2tCdWNrZXQsXG4gICAgICB9KTtcbiAgICAgIGV4cGVjdChyZXN1bHRzWzFdKS50b0VxdWFsKHtcbiAgICAgICAgZmlsZW5hbWU6ICd1dWlkLTIucG5nJyxcbiAgICAgICAgdXJsOiBgJHttb2NrU3VwYWJhc2VVcmx9L3N0b3JhZ2UvdjEvb2JqZWN0L3B1YmxpYy8ke21vY2tCdWNrZXR9L3V1aWQtMi5wbmdgLFxuICAgICAgICBidWNrZXQ6IG1vY2tCdWNrZXQsXG4gICAgICB9KTtcbiAgICAgIGV4cGVjdChyZXN1bHRzWzJdKS50b0VxdWFsKHtcbiAgICAgICAgZmlsZW5hbWU6ICd1dWlkLTMucGRmJyxcbiAgICAgICAgdXJsOiBgJHttb2NrU3VwYWJhc2VVcmx9L3N0b3JhZ2UvdjEvb2JqZWN0L3B1YmxpYy8ke21vY2tCdWNrZXR9L3V1aWQtMy5wZGZgLFxuICAgICAgICBidWNrZXQ6IG1vY2tCdWNrZXQsXG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KG1vY2tlZEF4aW9zLnBvc3QpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygzKTtcbiAgICAgIGV4cGVjdChsb2dnZXJTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBgVXBsb2FkaW5nIDMgZmlsZXMgdG8gU3VwYWJhc2UgYnVja2V0OiAke21vY2tCdWNrZXR9YCxcbiAgICAgICk7XG4gICAgICBleHBlY3QobG9nZ2VyU3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgYFN1Y2Nlc3NmdWxseSB1cGxvYWRlZCAzIGZpbGVzIHRvIFN1cGFiYXNlYCxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBlbXB0eSBhcnJheSBmb3IgZW1wdHkgZmlsZXMgYXJyYXknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLnVwbG9hZEZpbGVzKFtdLCBtb2NrQnVja2V0KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChbXSk7XG4gICAgICBleHBlY3QobW9ja2VkQXhpb3MucG9zdCkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGVtcHR5IGFycmF5IGZvciBudWxsIGZpbGVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS51cGxvYWRGaWxlcyhudWxsIGFzIGFueSwgbW9ja0J1Y2tldCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoW10pO1xuICAgICAgZXhwZWN0KG1vY2tlZEF4aW9zLnBvc3QpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBlbXB0eSBhcnJheSBmb3IgdW5kZWZpbmVkIGZpbGVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS51cGxvYWRGaWxlcyh1bmRlZmluZWQgYXMgYW55LCBtb2NrQnVja2V0KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChbXSk7XG4gICAgICBleHBlY3QobW9ja2VkQXhpb3MucG9zdCkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHBhcnRpYWwgZmFpbHVyZXMgaW4gYmF0Y2ggdXBsb2FkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja0ZpbGVzID0gW1xuICAgICAgICBjcmVhdGVNb2NrRmlsZSgnZmlsZTEuanBnJyksXG4gICAgICAgIGNyZWF0ZU1vY2tGaWxlKCdmaWxlMi5wbmcnKSxcbiAgICAgIF07XG5cbiAgICAgIG1vY2tlZFV1aWR2NFxuICAgICAgICAubW9ja1JldHVyblZhbHVlT25jZSgndXVpZC0xJylcbiAgICAgICAgLm1vY2tSZXR1cm5WYWx1ZU9uY2UoJ3V1aWQtMicpO1xuXG4gICAgICAvLyBGaXJzdCBjYWxsIHN1Y2NlZWRzLCBzZWNvbmQgY2FsbCBmYWlsc1xuICAgICAgbW9ja2VkQXhpb3MucG9zdFxuICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHtcbiAgICAgICAgICBzdGF0dXM6IDIwMCxcbiAgICAgICAgICBkYXRhOiB7IG1lc3NhZ2U6ICdTdWNjZXNzJyB9LFxuICAgICAgICB9KVxuICAgICAgICAubW9ja1JlamVjdGVkVmFsdWVPbmNlKG5ldyBFcnJvcignVXBsb2FkIGZhaWxlZCcpKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KHNlcnZpY2UudXBsb2FkRmlsZXMobW9ja0ZpbGVzLCBtb2NrQnVja2V0KSkucmVqZWN0cy50b1Rocm93KFxuICAgICAgICAnRmFpbGVkIHRvIHVwbG9hZCBmaWxlcyB0byBTdXBhYmFzZTogVXBsb2FkIGZhaWxlZCcsXG4gICAgICApO1xuXG4gICAgICBleHBlY3QobW9ja2VkQXhpb3MucG9zdCkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDIpO1xuICAgICAgZXhwZWN0KGxvZ2dlckVycm9yU3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgJ0Vycm9yIHVwbG9hZGluZyBtdWx0aXBsZSBmaWxlcyB0byBTdXBhYmFzZScsXG4gICAgICAgIGV4cGVjdC5hbnkoRXJyb3IpLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHNpbmdsZSBmaWxlIGluIGFycmF5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja0ZpbGVzID0gW2NyZWF0ZU1vY2tGaWxlKCdzaW5nbGUtZmlsZS5qcGcnKV07XG4gICAgICBtb2NrZWRVdWlkdjQubW9ja1JldHVyblZhbHVlKCdzaW5nbGUtdXVpZCcpO1xuXG4gICAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgc2VydmljZS51cGxvYWRGaWxlcyhtb2NrRmlsZXMsIG1vY2tCdWNrZXQpO1xuXG4gICAgICBleHBlY3QocmVzdWx0cykudG9IYXZlTGVuZ3RoKDEpO1xuICAgICAgZXhwZWN0KHJlc3VsdHNbMF0uZmlsZW5hbWUpLnRvQmUoJ3NpbmdsZS11dWlkLmpwZycpO1xuICAgICAgZXhwZWN0KG1vY2tlZEF4aW9zLnBvc3QpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbmN1cnJlbnQgdXBsb2FkIG9mIG1hbnkgZmlsZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBmaWxlQ291bnQgPSAxMDtcbiAgICAgIGNvbnN0IG1vY2tGaWxlcyA9IEFycmF5LmZyb20oeyBsZW5ndGg6IGZpbGVDb3VudCB9LCAoXywgaSkgPT5cbiAgICAgICAgY3JlYXRlTW9ja0ZpbGUoYGZpbGUke2l9LmpwZ2ApLFxuICAgICAgKTtcblxuICAgICAgbW9ja2VkVXVpZHY0Lm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiBgdXVpZC0ke0RhdGUubm93KCl9LSR7TWF0aC5yYW5kb20oKX1gKTtcblxuICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IHNlcnZpY2UudXBsb2FkRmlsZXMobW9ja0ZpbGVzLCBtb2NrQnVja2V0KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdHMpLnRvSGF2ZUxlbmd0aChmaWxlQ291bnQpO1xuICAgICAgZXhwZWN0KG1vY2tlZEF4aW9zLnBvc3QpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcyhmaWxlQ291bnQpO1xuICAgICAgZXhwZWN0KGxvZ2dlclNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIGBVcGxvYWRpbmcgJHtmaWxlQ291bnR9IGZpbGVzIHRvIFN1cGFiYXNlIGJ1Y2tldDogJHttb2NrQnVja2V0fWAsXG4gICAgICApO1xuICAgICAgZXhwZWN0KGxvZ2dlclNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIGBTdWNjZXNzZnVsbHkgdXBsb2FkZWQgJHtmaWxlQ291bnR9IGZpbGVzIHRvIFN1cGFiYXNlYCxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHByZXNlcnZlIGZpbGUgb3JkZXIgaW4gcmVzdWx0cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tGaWxlcyA9IFtcbiAgICAgICAgY3JlYXRlTW9ja0ZpbGUoJ2ZpcnN0LmpwZycpLFxuICAgICAgICBjcmVhdGVNb2NrRmlsZSgnc2Vjb25kLnBuZycpLFxuICAgICAgICBjcmVhdGVNb2NrRmlsZSgndGhpcmQucGRmJywgQnVmZmVyLmZyb20oJ2NvbnRlbnQnKSwgJ2FwcGxpY2F0aW9uL3BkZicpLFxuICAgICAgXTtcblxuICAgICAgbW9ja2VkVXVpZHY0XG4gICAgICAgIC5tb2NrUmV0dXJuVmFsdWVPbmNlKCdmaXJzdC11dWlkJylcbiAgICAgICAgLm1vY2tSZXR1cm5WYWx1ZU9uY2UoJ3NlY29uZC11dWlkJylcbiAgICAgICAgLm1vY2tSZXR1cm5WYWx1ZU9uY2UoJ3RoaXJkLXV1aWQnKTtcblxuICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IHNlcnZpY2UudXBsb2FkRmlsZXMobW9ja0ZpbGVzLCBtb2NrQnVja2V0KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdHNbMF0uZmlsZW5hbWUpLnRvQmUoJ2ZpcnN0LXV1aWQuanBnJyk7XG4gICAgICBleHBlY3QocmVzdWx0c1sxXS5maWxlbmFtZSkudG9CZSgnc2Vjb25kLXV1aWQucG5nJyk7XG4gICAgICBleHBlY3QocmVzdWx0c1syXS5maWxlbmFtZSkudG9CZSgndGhpcmQtdXVpZC5wZGYnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgLy8gPT09PT0gRklMRSBERUxFVElPTiBURVNUUyA9PT09PVxuXG4gIGRlc2NyaWJlKCdkZWxldGVGaWxlJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZGVsZXRlIGZpbGUgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja2VkQXhpb3MuZGVsZXRlLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgIGRhdGE6IHsgbWVzc2FnZTogJ0ZpbGUgZGVsZXRlZCBzdWNjZXNzZnVsbHknIH0sXG4gICAgICB9KTtcblxuICAgICAgYXdhaXQgc2VydmljZS5kZWxldGVGaWxlKG1vY2tCdWNrZXQsIG1vY2tGaWxlbmFtZSk7XG5cbiAgICAgIGV4cGVjdChtb2NrZWRBeGlvcy5kZWxldGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBgJHttb2NrU3VwYWJhc2VVcmx9L3N0b3JhZ2UvdjEvb2JqZWN0LyR7bW9ja0J1Y2tldH0vJHttb2NrRmlsZW5hbWV9YCxcbiAgICAgICAge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHttb2NrU3VwYWJhc2VBcGlLZXl9YCxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KGxvZ2dlclNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIGBEZWxldGluZyBmaWxlIGZyb20gU3VwYWJhc2U6ICR7bW9ja0ZpbGVuYW1lfSAoYnVja2V0OiAke21vY2tCdWNrZXR9KWAsXG4gICAgICApO1xuICAgICAgZXhwZWN0KGxvZ2dlclNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIGBGaWxlIGRlbGV0ZWQgc3VjY2Vzc2Z1bGx5IGZyb20gU3VwYWJhc2U6ICR7bW9ja0ZpbGVuYW1lfWAsXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbm9uLTIwMCBzdGF0dXMgYXMgZmFpbHVyZScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tlZEF4aW9zLmRlbGV0ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIHN0YXR1czogNDA0LFxuICAgICAgICBkYXRhOiB7IGVycm9yOiAnRmlsZSBub3QgZm91bmQnIH0sXG4gICAgICB9KTtcblxuICAgICAgYXdhaXQgZXhwZWN0KHNlcnZpY2UuZGVsZXRlRmlsZShtb2NrQnVja2V0LCBtb2NrRmlsZW5hbWUpKS5yZWplY3RzLnRvVGhyb3coXG4gICAgICAgICdGYWlsZWQgdG8gZGVsZXRlIGZpbGUgZnJvbSBTdXBhYmFzZTogU3VwYWJhc2UgZGVsZXRlIGZhaWxlZCB3aXRoIHN0YXR1czogNDA0JyxcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChsb2dnZXJFcnJvclNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCdGYWlsZWQgdG8gZGVsZXRlIGZpbGUgZnJvbSBTdXBhYmFzZS4gU3RhdHVzOiA0MDQnKSxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBuZXR3b3JrIGVycm9ycyBkdXJpbmcgZGVsZXRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBuZXR3b3JrRXJyb3IgPSBuZXcgRXJyb3IoJ05ldHdvcmsgY29ubmVjdGlvbiBmYWlsZWQnKTtcbiAgICAgIG1vY2tlZEF4aW9zLmRlbGV0ZS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXR3b3JrRXJyb3IpO1xuXG4gICAgICBhd2FpdCBleHBlY3Qoc2VydmljZS5kZWxldGVGaWxlKG1vY2tCdWNrZXQsIG1vY2tGaWxlbmFtZSkpLnJlamVjdHMudG9UaHJvdyhcbiAgICAgICAgJ0ZhaWxlZCB0byBkZWxldGUgZmlsZSBmcm9tIFN1cGFiYXNlOiBOZXR3b3JrIGNvbm5lY3Rpb24gZmFpbGVkJyxcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChsb2dnZXJFcnJvclNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIGBFcnJvciBkZWxldGluZyBmaWxlIGZyb20gU3VwYWJhc2U6ICR7bW9ja0ZpbGVuYW1lfWAsXG4gICAgICAgIG5ldHdvcmtFcnJvcixcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBIVFRQIGVycm9ycyB3aXRoIHJlc3BvbnNlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgaHR0cEVycm9yID0ge1xuICAgICAgICByZXNwb25zZToge1xuICAgICAgICAgIHN0YXR1czogNDAzLFxuICAgICAgICAgIGRhdGE6IHsgbWVzc2FnZTogJ0FjY2VzcyBkZW5pZWQnIH0sXG4gICAgICAgIH0sXG4gICAgICAgIG1lc3NhZ2U6ICdSZXF1ZXN0IGZhaWxlZCB3aXRoIHN0YXR1cyBjb2RlIDQwMycsXG4gICAgICB9O1xuICAgICAgbW9ja2VkQXhpb3MuZGVsZXRlLm1vY2tSZWplY3RlZFZhbHVlKGh0dHBFcnJvcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChzZXJ2aWNlLmRlbGV0ZUZpbGUobW9ja0J1Y2tldCwgbW9ja0ZpbGVuYW1lKSkucmVqZWN0cy50b1Rocm93KFxuICAgICAgICAnRmFpbGVkIHRvIGRlbGV0ZSBmaWxlIGZyb20gU3VwYWJhc2U6IFJlcXVlc3QgZmFpbGVkIHdpdGggc3RhdHVzIGNvZGUgNDAzJyxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBkZWxldGlvbiBvZiBmaWxlcyB3aXRoIHNwZWNpYWwgY2hhcmFjdGVycyBpbiBuYW1lcycsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tlZEF4aW9zLmRlbGV0ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIHN0YXR1czogMjAwLFxuICAgICAgICBkYXRhOiB7IG1lc3NhZ2U6ICdTdWNjZXNzJyB9LFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHNwZWNpYWxGaWxlbmFtZSA9ICdmaWxlLXdpdGgtc3BlY2lhbC1jaGFyc18xMjMuanBnJztcbiAgICAgIGF3YWl0IHNlcnZpY2UuZGVsZXRlRmlsZShtb2NrQnVja2V0LCBzcGVjaWFsRmlsZW5hbWUpO1xuXG4gICAgICBleHBlY3QobW9ja2VkQXhpb3MuZGVsZXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgYCR7bW9ja1N1cGFiYXNlVXJsfS9zdG9yYWdlL3YxL29iamVjdC8ke21vY2tCdWNrZXR9LyR7c3BlY2lhbEZpbGVuYW1lfWAsXG4gICAgICAgIGV4cGVjdC5hbnkoT2JqZWN0KSxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBkZWxldGlvbiBvZiBmaWxlcyB3aXRoIGxvbmcgcGF0aHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrZWRBeGlvcy5kZWxldGUubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBzdGF0dXM6IDIwMCxcbiAgICAgICAgZGF0YTogeyBtZXNzYWdlOiAnU3VjY2VzcycgfSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBsb25nUGF0aCA9ICd2ZXJ5L2xvbmcvcGF0aC90by9uZXN0ZWQvZGlyZWN0b3J5L3N0cnVjdHVyZS9maWxlLmpwZyc7XG4gICAgICBhd2FpdCBzZXJ2aWNlLmRlbGV0ZUZpbGUobW9ja0J1Y2tldCwgbG9uZ1BhdGgpO1xuXG4gICAgICBleHBlY3QobW9ja2VkQXhpb3MuZGVsZXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgYCR7bW9ja1N1cGFiYXNlVXJsfS9zdG9yYWdlL3YxL29iamVjdC8ke21vY2tCdWNrZXR9LyR7bG9uZ1BhdGh9YCxcbiAgICAgICAgZXhwZWN0LmFueShPYmplY3QpLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGVtcHR5IGZpbGVuYW1lJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja2VkQXhpb3MuZGVsZXRlLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgIGRhdGE6IHsgbWVzc2FnZTogJ1N1Y2Nlc3MnIH0sXG4gICAgICB9KTtcblxuICAgICAgYXdhaXQgc2VydmljZS5kZWxldGVGaWxlKG1vY2tCdWNrZXQsICcnKTtcblxuICAgICAgZXhwZWN0KG1vY2tlZEF4aW9zLmRlbGV0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIGAke21vY2tTdXBhYmFzZVVybH0vc3RvcmFnZS92MS9vYmplY3QvJHttb2NrQnVja2V0fS9gLFxuICAgICAgICBleHBlY3QuYW55KE9iamVjdCksXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcblxuICAvLyA9PT09PSBGSUxFIFZBTElEQVRJT04gVEVTVFMgPT09PT1cblxuICBkZXNjcmliZSgndmFsaWRhdGVGaWxlJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgdmFsaWQgZmlsZSB3aXRoIGRlZmF1bHQgc2V0dGluZ3MnLCAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrRmlsZSA9IGNyZWF0ZU1vY2tGaWxlKCd0ZXN0LmpwZycsIEJ1ZmZlci5mcm9tKCdjb250ZW50JyksICdpbWFnZS9qcGVnJywgMTAyNCk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IHNlcnZpY2UudmFsaWRhdGVGaWxlKG1vY2tGaWxlKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7IGlzVmFsaWQ6IHRydWUgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlamVjdCBmaWxlIGV4Y2VlZGluZyBzaXplIGxpbWl0JywgKCkgPT4ge1xuICAgICAgY29uc3QgbGFyZ2VCdWZmZXIgPSBCdWZmZXIuYWxsb2MoMTEgKiAxMDI0ICogMTAyNCk7IC8vIDExTUJcbiAgICAgIGNvbnN0IG1vY2tGaWxlID0gY3JlYXRlTW9ja0ZpbGUoJ2xhcmdlLmpwZycsIGxhcmdlQnVmZmVyLCAnaW1hZ2UvanBlZycsIDExICogMTAyNCAqIDEwMjQpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBzZXJ2aWNlLnZhbGlkYXRlRmlsZShtb2NrRmlsZSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoe1xuICAgICAgICBpc1ZhbGlkOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6ICdGaWxlIHNpemUgZXhjZWVkcyAxME1CIGxpbWl0JyxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBmaWxlIHdpdGggY3VzdG9tIHNpemUgbGltaXQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrRmlsZSA9IGNyZWF0ZU1vY2tGaWxlKCd0ZXN0LmpwZycsIEJ1ZmZlci5mcm9tKCdjb250ZW50JyksICdpbWFnZS9qcGVnJywgMiAqIDEwMjQgKiAxMDI0KTsgLy8gMk1CXG4gICAgICBjb25zdCBjdXN0b21TaXplTGltaXQgPSA1ICogMTAyNCAqIDEwMjQ7IC8vIDVNQlxuXG4gICAgICBjb25zdCByZXN1bHQgPSBzZXJ2aWNlLnZhbGlkYXRlRmlsZShtb2NrRmlsZSwgY3VzdG9tU2l6ZUxpbWl0KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7IGlzVmFsaWQ6IHRydWUgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlamVjdCBmaWxlIHdpdGggY3VzdG9tIHNpemUgbGltaXQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrRmlsZSA9IGNyZWF0ZU1vY2tGaWxlKCd0ZXN0LmpwZycsIEJ1ZmZlci5mcm9tKCdjb250ZW50JyksICdpbWFnZS9qcGVnJywgNiAqIDEwMjQgKiAxMDI0KTsgLy8gNk1CXG4gICAgICBjb25zdCBjdXN0b21TaXplTGltaXQgPSA1ICogMTAyNCAqIDEwMjQ7IC8vIDVNQlxuXG4gICAgICBjb25zdCByZXN1bHQgPSBzZXJ2aWNlLnZhbGlkYXRlRmlsZShtb2NrRmlsZSwgY3VzdG9tU2l6ZUxpbWl0KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7XG4gICAgICAgIGlzVmFsaWQ6IGZhbHNlLFxuICAgICAgICBlcnJvcjogJ0ZpbGUgc2l6ZSBleGNlZWRzIDVNQiBsaW1pdCcsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVqZWN0IGZpbGUgd2l0aCBkaXNhbGxvd2VkIE1JTUUgdHlwZScsICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tGaWxlID0gY3JlYXRlTW9ja0ZpbGUoJ3ZpcnVzLmV4ZScsIEJ1ZmZlci5mcm9tKCdjb250ZW50JyksICdhcHBsaWNhdGlvbi94LW1zZG93bmxvYWQnLCAxMDI0KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gc2VydmljZS52YWxpZGF0ZUZpbGUobW9ja0ZpbGUpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHtcbiAgICAgICAgaXNWYWxpZDogZmFsc2UsXG4gICAgICAgIGVycm9yOiAnRmlsZSB0eXBlIGFwcGxpY2F0aW9uL3gtbXNkb3dubG9hZCBpcyBub3QgYWxsb3dlZCcsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgZmlsZSB3aXRoIGN1c3RvbSBhbGxvd2VkIE1JTUUgdHlwZXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrRmlsZSA9IGNyZWF0ZU1vY2tGaWxlKCdzY3JpcHQuanMnLCBCdWZmZXIuZnJvbSgnY29udGVudCcpLCAnYXBwbGljYXRpb24vamF2YXNjcmlwdCcsIDEwMjQpO1xuICAgICAgY29uc3QgY3VzdG9tTWltZVR5cGVzID0gWydhcHBsaWNhdGlvbi9qYXZhc2NyaXB0JywgJ3RleHQvamF2YXNjcmlwdCddO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBzZXJ2aWNlLnZhbGlkYXRlRmlsZShtb2NrRmlsZSwgMTAgKiAxMDI0ICogMTAyNCwgY3VzdG9tTWltZVR5cGVzKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7IGlzVmFsaWQ6IHRydWUgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIGFsbCBkZWZhdWx0IGFsbG93ZWQgTUlNRSB0eXBlcycsICgpID0+IHtcbiAgICAgIGNvbnN0IGRlZmF1bHRNaW1lVHlwZXMgPSBbXG4gICAgICAgICdpbWFnZS9qcGVnJyxcbiAgICAgICAgJ2ltYWdlL3BuZycsXG4gICAgICAgICdpbWFnZS9naWYnLFxuICAgICAgICAnaW1hZ2Uvd2VicCcsXG4gICAgICAgICdhcHBsaWNhdGlvbi9wZGYnLFxuICAgICAgICAndGV4dC9wbGFpbicsXG4gICAgICAgICd0ZXh0L2NzdicsXG4gICAgICAgICdhcHBsaWNhdGlvbi92bmQub3BlbnhtbGZvcm1hdHMtb2ZmaWNlZG9jdW1lbnQud29yZHByb2Nlc3NpbmdtbC5kb2N1bWVudCcsXG4gICAgICAgICdhcHBsaWNhdGlvbi92bmQub3BlbnhtbGZvcm1hdHMtb2ZmaWNlZG9jdW1lbnQuc3ByZWFkc2hlZXRtbC5zaGVldCcsXG4gICAgICAgICdhcHBsaWNhdGlvbi92bmQub3BlbnhtbGZvcm1hdHMtb2ZmaWNlZG9jdW1lbnQucHJlc2VudGF0aW9ubWwucHJlc2VudGF0aW9uJyxcbiAgICAgICAgJ2FwcGxpY2F0aW9uL21zd29yZCcsXG4gICAgICAgICdhcHBsaWNhdGlvbi92bmQubXMtZXhjZWwnLFxuICAgICAgICAnYXBwbGljYXRpb24vdm5kLm1zLXBvd2VycG9pbnQnLFxuICAgICAgXTtcblxuICAgICAgZGVmYXVsdE1pbWVUeXBlcy5mb3JFYWNoKChtaW1lVHlwZSkgPT4ge1xuICAgICAgICBjb25zdCBtb2NrRmlsZSA9IGNyZWF0ZU1vY2tGaWxlKCd0ZXN0LWZpbGUnLCBCdWZmZXIuZnJvbSgnY29udGVudCcpLCBtaW1lVHlwZSwgMTAyNCk7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHNlcnZpY2UudmFsaWRhdGVGaWxlKG1vY2tGaWxlKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5pc1ZhbGlkKS50b0JlKHRydWUpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlamVjdCBmaWxlbmFtZSB3aXRoIGludmFsaWQgY2hhcmFjdGVycycsICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tGaWxlID0gY3JlYXRlTW9ja0ZpbGUoJ2ZpbGUvd2l0aFxcXFxwYXRoLmpwZycsIEJ1ZmZlci5mcm9tKCdjb250ZW50JyksICdpbWFnZS9qcGVnJywgMTAyNCk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IHNlcnZpY2UudmFsaWRhdGVGaWxlKG1vY2tGaWxlKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7XG4gICAgICAgIGlzVmFsaWQ6IGZhbHNlLFxuICAgICAgICBlcnJvcjogJ0ZpbGVuYW1lIGNvbnRhaW5zIGludmFsaWQgY2hhcmFjdGVycycsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVqZWN0IGZpbGVuYW1lIHdpdGggc3BlY2lhbCBjaGFyYWN0ZXJzJywgKCkgPT4ge1xuICAgICAgY29uc3QgaW52YWxpZEZpbGVuYW1lcyA9IFtcbiAgICAgICAgJ2ZpbGU8c2NyaXB0Pi5qcGcnLFxuICAgICAgICAnZmlsZT5yZWRpcmVjdC5qcGcnLFxuICAgICAgICAnZmlsZXxwaXBlLmpwZycsXG4gICAgICAgICdmaWxlOmNvbG9uLmpwZycsXG4gICAgICAgICdmaWxlXCJxdW90ZS5qcGcnLFxuICAgICAgICAnZmlsZSp3aWxkY2FyZC5qcGcnLFxuICAgICAgICAnZmlsZT9xdWVzdGlvbi5qcGcnLFxuICAgICAgICAnZmlsZVxcXFxiYWNrc2xhc2guanBnJyxcbiAgICAgICAgJ2ZpbGUvc2xhc2guanBnJyxcbiAgICAgIF07XG5cbiAgICAgIGludmFsaWRGaWxlbmFtZXMuZm9yRWFjaCgoZmlsZW5hbWUpID0+IHtcbiAgICAgICAgY29uc3QgbW9ja0ZpbGUgPSBjcmVhdGVNb2NrRmlsZShmaWxlbmFtZSwgQnVmZmVyLmZyb20oJ2NvbnRlbnQnKSwgJ2ltYWdlL2pwZWcnLCAxMDI0KTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gc2VydmljZS52YWxpZGF0ZUZpbGUobW9ja0ZpbGUpO1xuICAgICAgICBleHBlY3QocmVzdWx0LmlzVmFsaWQpLnRvQmUoZmFsc2UpO1xuICAgICAgICBleHBlY3QocmVzdWx0LmVycm9yKS50b0JlKCdGaWxlbmFtZSBjb250YWlucyBpbnZhbGlkIGNoYXJhY3RlcnMnKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhbGxvdyB2YWxpZCBmaWxlbmFtZSBjaGFyYWN0ZXJzJywgKCkgPT4ge1xuICAgICAgY29uc3QgdmFsaWRGaWxlbmFtZXMgPSBbXG4gICAgICAgICdub3JtYWwtZmlsZS5qcGcnLFxuICAgICAgICAnZmlsZV93aXRoX3VuZGVyc2NvcmVzLnBuZycsXG4gICAgICAgICdmaWxlLndpdGguZG90cy5wZGYnLFxuICAgICAgICAnZmlsZTEyMy50eHQnLFxuICAgICAgICAnVVBQRVJDQVNFLlBERicsXG4gICAgICAgICdNaXhlZENhc2UuVFhUJyxcbiAgICAgICAgJ2ZpbGUtbmFtZS5leHRlbnNpb24nLFxuICAgICAgXTtcblxuICAgICAgdmFsaWRGaWxlbmFtZXMuZm9yRWFjaCgoZmlsZW5hbWUpID0+IHtcbiAgICAgICAgY29uc3QgbW9ja0ZpbGUgPSBjcmVhdGVNb2NrRmlsZShmaWxlbmFtZSwgQnVmZmVyLmZyb20oJ2NvbnRlbnQnKSwgJ2ltYWdlL2pwZWcnLCAxMDI0KTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gc2VydmljZS52YWxpZGF0ZUZpbGUobW9ja0ZpbGUpO1xuICAgICAgICBleHBlY3QocmVzdWx0LmlzVmFsaWQpLnRvQmUodHJ1ZSk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHplcm8tYnl0ZSBmaWxlcycsICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tGaWxlID0gY3JlYXRlTW9ja0ZpbGUoJ2VtcHR5LnR4dCcsIEJ1ZmZlci5hbGxvYygwKSwgJ3RleHQvcGxhaW4nLCAwKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gc2VydmljZS52YWxpZGF0ZUZpbGUobW9ja0ZpbGUpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHsgaXNWYWxpZDogdHJ1ZSB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGZpbGVzIGF0IGV4YWN0IHNpemUgbGltaXQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBleGFjdFNpemVCdWZmZXIgPSBCdWZmZXIuYWxsb2MoMTAgKiAxMDI0ICogMTAyNCk7IC8vIEV4YWN0bHkgMTBNQlxuICAgICAgY29uc3QgbW9ja0ZpbGUgPSBjcmVhdGVNb2NrRmlsZSgnZXhhY3QuanBnJywgZXhhY3RTaXplQnVmZmVyLCAnaW1hZ2UvanBlZycsIDEwICogMTAyNCAqIDEwMjQpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBzZXJ2aWNlLnZhbGlkYXRlRmlsZShtb2NrRmlsZSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoeyBpc1ZhbGlkOiB0cnVlIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZmlsZXMganVzdCBvdmVyIHNpemUgbGltaXQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBvdmVyc2l6ZUJ1ZmZlciA9IEJ1ZmZlci5hbGxvYygxMCAqIDEwMjQgKiAxMDI0ICsgMSk7IC8vIDEwTUIgKyAxIGJ5dGVcbiAgICAgIGNvbnN0IG1vY2tGaWxlID0gY3JlYXRlTW9ja0ZpbGUoJ292ZXJzaXplLmpwZycsIG92ZXJzaXplQnVmZmVyLCAnaW1hZ2UvanBlZycsIDEwICogMTAyNCAqIDEwMjQgKyAxKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gc2VydmljZS52YWxpZGF0ZUZpbGUobW9ja0ZpbGUpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHtcbiAgICAgICAgaXNWYWxpZDogZmFsc2UsXG4gICAgICAgIGVycm9yOiAnRmlsZSBzaXplIGV4Y2VlZHMgMTBNQiBsaW1pdCcsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGN1c3RvbSBzaXplIGxpbWl0cyBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgICBjb25zdCB0ZXN0Q2FzZXMgPSBbXG4gICAgICAgIHsgc2l6ZTogMTAyNCwgbGltaXQ6IDIwNDgsIGV4cGVjdGVkOiB0cnVlIH0sIC8vIEJlbG93IGxpbWl0XG4gICAgICAgIHsgc2l6ZTogMjA0OCwgbGltaXQ6IDIwNDgsIGV4cGVjdGVkOiB0cnVlIH0sIC8vIEF0IGxpbWl0XG4gICAgICAgIHsgc2l6ZTogMjA0OSwgbGltaXQ6IDIwNDgsIGV4cGVjdGVkOiBmYWxzZSB9LCAvLyBBYm92ZSBsaW1pdFxuICAgICAgXTtcblxuICAgICAgdGVzdENhc2VzLmZvckVhY2goKHsgc2l6ZSwgbGltaXQsIGV4cGVjdGVkIH0pID0+IHtcbiAgICAgICAgY29uc3QgYnVmZmVyID0gQnVmZmVyLmFsbG9jKHNpemUpO1xuICAgICAgICBjb25zdCBtb2NrRmlsZSA9IGNyZWF0ZU1vY2tGaWxlKCd0ZXN0LmpwZycsIGJ1ZmZlciwgJ2ltYWdlL2pwZWcnLCBzaXplKTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gc2VydmljZS52YWxpZGF0ZUZpbGUobW9ja0ZpbGUsIGxpbWl0KTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5pc1ZhbGlkKS50b0JlKGV4cGVjdGVkKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICAvLyA9PT09PSBTVVBQT1JURUQgQlVDS0VUUyBURVNUUyA9PT09PVxuXG4gIGRlc2NyaWJlKCdnZXRTdXBwb3J0ZWRCdWNrZXRzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvcnJlY3QgYnVja2V0IGNvbmZpZ3VyYXRpb24nLCAoKSA9PiB7XG4gICAgICBjb25zdCBidWNrZXRzID0gU3VwYWJhc2VTdG9yYWdlU2VydmljZS5nZXRTdXBwb3J0ZWRCdWNrZXRzKCk7XG5cbiAgICAgIGV4cGVjdChidWNrZXRzKS50b0VxdWFsKHtcbiAgICAgICAgVVNFUl9QUk9GSUxFUzogJ3VzZXItcHJvZmlsZXMnLFxuICAgICAgICBQT1NUX0FUVEFDSE1FTlRTOiAncG9zdC1hdHRhY2htZW50cycsXG4gICAgICAgIE1FU1NBR0VTOiAnbWVzc2FnZXMnLFxuICAgICAgICBET0NVTUVOVFM6ICdkb2N1bWVudHMnLFxuICAgICAgICBXT1JLU0hFRVRTOiAnd29ya3NoZWV0cycsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGltbXV0YWJsZSBidWNrZXQgY29uZmlndXJhdGlvbicsICgpID0+IHtcbiAgICAgIGNvbnN0IGJ1Y2tldHMxID0gU3VwYWJhc2VTdG9yYWdlU2VydmljZS5nZXRTdXBwb3J0ZWRCdWNrZXRzKCk7XG4gICAgICBjb25zdCBidWNrZXRzMiA9IFN1cGFiYXNlU3RvcmFnZVNlcnZpY2UuZ2V0U3VwcG9ydGVkQnVja2V0cygpO1xuXG4gICAgICBleHBlY3QoYnVja2V0czEpLnRvRXF1YWwoYnVja2V0czIpO1xuICAgICAgXG4gICAgICAvLyBUZXN0IHRoYXQgdGhlIHJldHVybmVkIG9iamVjdCBpcyB0aGUgc2FtZSByZWZlcmVuY2UgKGNvbnN0IGFzc2VydGlvbilcbiAgICAgIGV4cGVjdChPYmplY3QuaXNGcm96ZW4oYnVja2V0czEpKS50b0JlKGZhbHNlKTsgLy8gVHlwZVNjcmlwdCBjb25zdCBhc3NlcnRpb24gZG9lc24ndCBmcmVlemUgYXQgcnVudGltZVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBwcm92aWRlIGFjY2VzcyB0byBhbGwgZXhwZWN0ZWQgYnVja2V0IHR5cGVzJywgKCkgPT4ge1xuICAgICAgY29uc3QgYnVja2V0cyA9IFN1cGFiYXNlU3RvcmFnZVNlcnZpY2UuZ2V0U3VwcG9ydGVkQnVja2V0cygpO1xuXG4gICAgICBleHBlY3QoYnVja2V0cy5VU0VSX1BST0ZJTEVTKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGJ1Y2tldHMuUE9TVF9BVFRBQ0hNRU5UUykudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChidWNrZXRzLk1FU1NBR0VTKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGJ1Y2tldHMuRE9DVU1FTlRTKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGJ1Y2tldHMuV09SS1NIRUVUUykudG9CZURlZmluZWQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgLy8gPT09PT0gVVRJTElUWSBNRVRIT0RTIFRFU1RTID09PT09XG5cbiAgZGVzY3JpYmUoJ2dldEZpbGVFeHRlbnNpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBleHRyYWN0IGZpbGUgZXh0ZW5zaW9uIGNvcnJlY3RseScsICgpID0+IHtcbiAgICAgIC8vIEFjY2VzcyBwcml2YXRlIG1ldGhvZCB0aHJvdWdoIHNlcnZpY2UgaW5zdGFuY2VcbiAgICAgIGNvbnN0IGV4dHJhY3RFeHRlbnNpb24gPSAoZmlsZW5hbWU6IHN0cmluZykgPT4ge1xuICAgICAgICAvLyBXZSBjYW4ndCBkaXJlY3RseSB0ZXN0IHByaXZhdGUgbWV0aG9kcywgYnV0IHdlIGNhbiB0ZXN0IHRocm91Z2ggdXBsb2FkIGZ1bmN0aW9uYWxpdHlcbiAgICAgICAgLy8gd2hpY2ggdXNlcyBnZXRGaWxlRXh0ZW5zaW9uIGludGVybmFsbHlcbiAgICAgICAgcmV0dXJuIGZpbGVuYW1lLnN1YnN0cmluZyhmaWxlbmFtZS5sYXN0SW5kZXhPZignLicpKTtcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHRlc3RDYXNlcyA9IFtcbiAgICAgICAgeyBmaWxlbmFtZTogJ3Rlc3QuanBnJywgZXhwZWN0ZWQ6ICcuanBnJyB9LFxuICAgICAgICB7IGZpbGVuYW1lOiAnZG9jdW1lbnQucGRmJywgZXhwZWN0ZWQ6ICcucGRmJyB9LFxuICAgICAgICB7IGZpbGVuYW1lOiAnYXJjaGl2ZS50YXIuZ3onLCBleHBlY3RlZDogJy5neicgfSxcbiAgICAgICAgeyBmaWxlbmFtZTogJ2ZpbGUud2l0aC5tdWx0aXBsZS5kb3RzLnR4dCcsIGV4cGVjdGVkOiAnLnR4dCcgfSxcbiAgICAgICAgeyBmaWxlbmFtZTogJ25vLWV4dGVuc2lvbicsIGV4cGVjdGVkOiAnbm8tZXh0ZW5zaW9uJyB9LFxuICAgICAgICB7IGZpbGVuYW1lOiAnLmhpZGRlbicsIGV4cGVjdGVkOiAnLmhpZGRlbicgfSxcbiAgICAgICAgeyBmaWxlbmFtZTogJ2ZpbGUuJywgZXhwZWN0ZWQ6ICcuJyB9LFxuICAgICAgXTtcblxuICAgICAgdGVzdENhc2VzLmZvckVhY2goKHsgZmlsZW5hbWUsIGV4cGVjdGVkIH0pID0+IHtcbiAgICAgICAgaWYgKGZpbGVuYW1lLmluY2x1ZGVzKCcuJykpIHtcbiAgICAgICAgICBleHBlY3QoZXh0cmFjdEV4dGVuc2lvbihmaWxlbmFtZSkpLnRvQmUoZXhwZWN0ZWQpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGVkZ2UgY2FzZXMgaW4gZmlsZSBleHRlbnNpb24gZXh0cmFjdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFRlc3QgdGhyb3VnaCB0aGUgdXBsb2FkIGZ1bmN0aW9uYWxpdHlcbiAgICAgIGNvbnN0IHRlc3RDYXNlcyA9IFtcbiAgICAgICAgeyBmaWxlbmFtZTogJycsIGV4cGVjdGVkRXh0ZW5zaW9uOiAnJyB9LFxuICAgICAgICB7IGZpbGVuYW1lOiAnLicsIGV4cGVjdGVkRXh0ZW5zaW9uOiAnLicgfSxcbiAgICAgICAgeyBmaWxlbmFtZTogJy4uJywgZXhwZWN0ZWRFeHRlbnNpb246ICcuJyB9LFxuICAgICAgICB7IGZpbGVuYW1lOiAnZmlsZScsIGV4cGVjdGVkRXh0ZW5zaW9uOiAnJyB9LFxuICAgICAgICB7IGZpbGVuYW1lOiAnZmlsZS4nLCBleHBlY3RlZEV4dGVuc2lvbjogJy4nIH0sXG4gICAgICBdO1xuXG4gICAgICBmb3IgKGNvbnN0IHRlc3RDYXNlIG9mIHRlc3RDYXNlcykge1xuICAgICAgICBtb2NrZWRVdWlkdjQubW9ja1JldHVyblZhbHVlKCd0ZXN0LXV1aWQnKTtcbiAgICAgICAgY29uc3QgbW9ja0ZpbGUgPSBjcmVhdGVNb2NrRmlsZSh0ZXN0Q2FzZS5maWxlbmFtZSk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLnVwbG9hZEZpbGUobW9ja0ZpbGUsIG1vY2tCdWNrZXQpO1xuICAgICAgICBcbiAgICAgICAgaWYgKHRlc3RDYXNlLmV4cGVjdGVkRXh0ZW5zaW9uKSB7XG4gICAgICAgICAgZXhwZWN0KHJlc3VsdC5maWxlbmFtZSkudG9CZShgdGVzdC11dWlkJHt0ZXN0Q2FzZS5leHBlY3RlZEV4dGVuc2lvbn1gKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBleHBlY3QocmVzdWx0LmZpbGVuYW1lKS50b0JlKCd0ZXN0LXV1aWQnKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9KTtcblxuICAvLyA9PT09PSBJTlRFR1JBVElPTiBURVNUUyA9PT09PVxuXG4gIGRlc2NyaWJlKCdJbnRlZ3JhdGlvbiBzY2VuYXJpb3MnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgY29tcGxldGUgdXBsb2FkIHdvcmtmbG93JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja2VkQXhpb3MucG9zdC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIHN0YXR1czogMjAwLFxuICAgICAgICBkYXRhOiB7IG1lc3NhZ2U6ICdTdWNjZXNzJyB9LFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IG1vY2tGaWxlID0gY3JlYXRlTW9ja0ZpbGUoJ2ludGVncmF0aW9uLXRlc3QuanBnJywgQnVmZmVyLmZyb20oJ3Rlc3QgY29udGVudCcpLCAnaW1hZ2UvanBlZycsIDIwNDgpO1xuXG4gICAgICAvLyBWYWxpZGF0ZSBmaWxlIGZpcnN0XG4gICAgICBjb25zdCB2YWxpZGF0aW9uID0gc2VydmljZS52YWxpZGF0ZUZpbGUobW9ja0ZpbGUpO1xuICAgICAgZXhwZWN0KHZhbGlkYXRpb24uaXNWYWxpZCkudG9CZSh0cnVlKTtcblxuICAgICAgLy8gVXBsb2FkIGZpbGVcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UudXBsb2FkRmlsZShtb2NrRmlsZSwgbW9ja0J1Y2tldCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoe1xuICAgICAgICBmaWxlbmFtZTogbW9ja1VuaXF1ZUZpbGVuYW1lLFxuICAgICAgICB1cmw6IGAke21vY2tTdXBhYmFzZVVybH0vc3RvcmFnZS92MS9vYmplY3QvcHVibGljLyR7bW9ja0J1Y2tldH0vJHttb2NrVW5pcXVlRmlsZW5hbWV9YCxcbiAgICAgICAgYnVja2V0OiBtb2NrQnVja2V0LFxuICAgICAgfSk7XG5cbiAgICAgIC8vIFZlcmlmeSB0aGUgY29ycmVjdCBBUEkgY2FsbHNcbiAgICAgIGV4cGVjdChtb2NrZWRBeGlvcy5wb3N0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgYCR7bW9ja1N1cGFiYXNlVXJsfS9zdG9yYWdlL3YxL29iamVjdC8ke21vY2tCdWNrZXR9LyR7bW9ja1VuaXF1ZUZpbGVuYW1lfWAsXG4gICAgICAgIG1vY2tGaWxlLmJ1ZmZlcixcbiAgICAgICAge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnaW1hZ2UvanBlZycsXG4gICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7bW9ja1N1cGFiYXNlQXBpS2V5fWAsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSB1cGxvYWQgYW5kIGRlbGV0ZSB3b3JrZmxvdycsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tlZEF4aW9zLnBvc3QubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBzdGF0dXM6IDIwMCxcbiAgICAgICAgZGF0YTogeyBtZXNzYWdlOiAnVXBsb2FkIHN1Y2Nlc3MnIH0sXG4gICAgICB9KTtcblxuICAgICAgbW9ja2VkQXhpb3MuZGVsZXRlLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgIGRhdGE6IHsgbWVzc2FnZTogJ0RlbGV0ZSBzdWNjZXNzJyB9LFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IG1vY2tGaWxlID0gY3JlYXRlTW9ja0ZpbGUoJ3RlbXAtZmlsZS5qcGcnKTtcblxuICAgICAgLy8gVXBsb2FkIGZpbGVcbiAgICAgIGNvbnN0IHVwbG9hZFJlc3VsdCA9IGF3YWl0IHNlcnZpY2UudXBsb2FkRmlsZShtb2NrRmlsZSwgbW9ja0J1Y2tldCk7XG4gICAgICBleHBlY3QodXBsb2FkUmVzdWx0LmZpbGVuYW1lKS50b0JlKG1vY2tVbmlxdWVGaWxlbmFtZSk7XG5cbiAgICAgIC8vIERlbGV0ZSB0aGUgdXBsb2FkZWQgZmlsZVxuICAgICAgYXdhaXQgc2VydmljZS5kZWxldGVGaWxlKG1vY2tCdWNrZXQsIHVwbG9hZFJlc3VsdC5maWxlbmFtZSk7XG5cbiAgICAgIGV4cGVjdChtb2NrZWRBeGlvcy5kZWxldGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBgJHttb2NrU3VwYWJhc2VVcmx9L3N0b3JhZ2UvdjEvb2JqZWN0LyR7bW9ja0J1Y2tldH0vJHt1cGxvYWRSZXN1bHQuZmlsZW5hbWV9YCxcbiAgICAgICAge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHttb2NrU3VwYWJhc2VBcGlLZXl9YCxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGJhdGNoIHVwbG9hZCB3aXRoIHZhbGlkYXRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrZWRBeGlvcy5wb3N0Lm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgIGRhdGE6IHsgbWVzc2FnZTogJ1N1Y2Nlc3MnIH0sXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgbW9ja0ZpbGVzID0gW1xuICAgICAgICBjcmVhdGVNb2NrRmlsZSgndmFsaWQxLmpwZycsIEJ1ZmZlci5mcm9tKCdjb250ZW50MScpLCAnaW1hZ2UvanBlZycsIDEwMjQpLFxuICAgICAgICBjcmVhdGVNb2NrRmlsZSgndmFsaWQyLnBuZycsIEJ1ZmZlci5mcm9tKCdjb250ZW50MicpLCAnaW1hZ2UvcG5nJywgMjA0OCksXG4gICAgICAgIGNyZWF0ZU1vY2tGaWxlKCd2YWxpZDMucGRmJywgQnVmZmVyLmZyb20oJ2NvbnRlbnQzJyksICdhcHBsaWNhdGlvbi9wZGYnLCA0MDk2KSxcbiAgICAgIF07XG5cbiAgICAgIC8vIFZhbGlkYXRlIGFsbCBmaWxlcyBmaXJzdFxuICAgICAgbW9ja0ZpbGVzLmZvckVhY2goKGZpbGUpID0+IHtcbiAgICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IHNlcnZpY2UudmFsaWRhdGVGaWxlKGZpbGUpO1xuICAgICAgICBleHBlY3QodmFsaWRhdGlvbi5pc1ZhbGlkKS50b0JlKHRydWUpO1xuICAgICAgfSk7XG5cbiAgICAgIG1vY2tlZFV1aWR2NFxuICAgICAgICAubW9ja1JldHVyblZhbHVlT25jZSgndXVpZC0xJylcbiAgICAgICAgLm1vY2tSZXR1cm5WYWx1ZU9uY2UoJ3V1aWQtMicpXG4gICAgICAgIC5tb2NrUmV0dXJuVmFsdWVPbmNlKCd1dWlkLTMnKTtcblxuICAgICAgLy8gVXBsb2FkIGFsbCBmaWxlc1xuICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IHNlcnZpY2UudXBsb2FkRmlsZXMobW9ja0ZpbGVzLCBtb2NrQnVja2V0KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdHMpLnRvSGF2ZUxlbmd0aCgzKTtcbiAgICAgIGV4cGVjdChyZXN1bHRzWzBdLmZpbGVuYW1lKS50b0JlKCd1dWlkLTEuanBnJyk7XG4gICAgICBleHBlY3QocmVzdWx0c1sxXS5maWxlbmFtZSkudG9CZSgndXVpZC0yLnBuZycpO1xuICAgICAgZXhwZWN0KHJlc3VsdHNbMl0uZmlsZW5hbWUpLnRvQmUoJ3V1aWQtMy5wZGYnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGVycm9yIHJlY292ZXJ5IGluIGJhdGNoIG9wZXJhdGlvbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrRmlsZXMgPSBbXG4gICAgICAgIGNyZWF0ZU1vY2tGaWxlKCdmaWxlMS5qcGcnKSxcbiAgICAgICAgY3JlYXRlTW9ja0ZpbGUoJ2ZpbGUyLmpwZycpLFxuICAgICAgICBjcmVhdGVNb2NrRmlsZSgnZmlsZTMuanBnJyksXG4gICAgICBdO1xuXG4gICAgICAvLyBGaXJzdCB1cGxvYWQgc3VjY2VlZHMsIHNlY29uZCBmYWlscywgdGhpcmQgd291bGQgbm90IGJlIHJlYWNoZWQgZHVlIHRvIFByb21pc2UuYWxsXG4gICAgICBtb2NrZWRBeGlvcy5wb3N0XG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICAgIHN0YXR1czogMjAwLFxuICAgICAgICAgIGRhdGE6IHsgbWVzc2FnZTogJ1N1Y2Nlc3MnIH0sXG4gICAgICAgIH0pXG4gICAgICAgIC5tb2NrUmVqZWN0ZWRWYWx1ZU9uY2UobmV3IEVycm9yKCdOZXR3b3JrIGVycm9yJykpXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICAgIHN0YXR1czogMjAwLFxuICAgICAgICAgIGRhdGE6IHsgbWVzc2FnZTogJ1N1Y2Nlc3MnIH0sXG4gICAgICAgIH0pO1xuXG4gICAgICBhd2FpdCBleHBlY3Qoc2VydmljZS51cGxvYWRGaWxlcyhtb2NrRmlsZXMsIG1vY2tCdWNrZXQpKS5yZWplY3RzLnRvVGhyb3coXG4gICAgICAgICdGYWlsZWQgdG8gdXBsb2FkIGZpbGVzIHRvIFN1cGFiYXNlOiBOZXR3b3JrIGVycm9yJyxcbiAgICAgICk7XG5cbiAgICAgIC8vIEFsbCB1cGxvYWRzIHNob3VsZCBiZSBhdHRlbXB0ZWQgZHVlIHRvIFByb21pc2UuYWxsXG4gICAgICBleHBlY3QobW9ja2VkQXhpb3MucG9zdCkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDMpO1xuICAgIH0pO1xuICB9KTtcblxuICAvLyA9PT09PSBQRVJGT1JNQU5DRSBURVNUUyA9PT09PVxuXG4gIGRlc2NyaWJlKCdQZXJmb3JtYW5jZSB0ZXN0cycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBjb25jdXJyZW50IGZpbGUgdXBsb2FkcyBlZmZpY2llbnRseScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tlZEF4aW9zLnBvc3QubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBzdGF0dXM6IDIwMCxcbiAgICAgICAgZGF0YTogeyBtZXNzYWdlOiAnU3VjY2VzcycgfSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBmaWxlQ291bnQgPSAyMDtcbiAgICAgIGNvbnN0IG1vY2tGaWxlcyA9IEFycmF5LmZyb20oeyBsZW5ndGg6IGZpbGVDb3VudCB9LCAoXywgaSkgPT5cbiAgICAgICAgY3JlYXRlTW9ja0ZpbGUoYGNvbmN1cnJlbnQtZmlsZS0ke2l9LmpwZ2ApLFxuICAgICAgKTtcblxuICAgICAgbW9ja2VkVXVpZHY0Lm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiBgdXVpZC0ke0RhdGUubm93KCl9LSR7TWF0aC5yYW5kb20oKX1gKTtcblxuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCBzZXJ2aWNlLnVwbG9hZEZpbGVzKG1vY2tGaWxlcywgbW9ja0J1Y2tldCk7XG4gICAgICBjb25zdCBlbmRUaW1lID0gRGF0ZS5ub3coKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdHMpLnRvSGF2ZUxlbmd0aChmaWxlQ291bnQpO1xuICAgICAgZXhwZWN0KGVuZFRpbWUgLSBzdGFydFRpbWUpLnRvQmVMZXNzVGhhbig1MDAwKTsgLy8gU2hvdWxkIGNvbXBsZXRlIHdpdGhpbiA1IHNlY29uZHNcbiAgICAgIGV4cGVjdChtb2NrZWRBeGlvcy5wb3N0KS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoZmlsZUNvdW50KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGxhcmdlIG51bWJlciBvZiB2YWxpZGF0aW9ucyBlZmZpY2llbnRseScsICgpID0+IHtcbiAgICAgIGNvbnN0IGZpbGVDb3VudCA9IDEwMDtcbiAgICAgIGNvbnN0IHZhbGlkYXRpb25zOiBhbnlbXSA9IFtdO1xuXG4gICAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBmaWxlQ291bnQ7IGkrKykge1xuICAgICAgICBjb25zdCBtb2NrRmlsZSA9IGNyZWF0ZU1vY2tGaWxlKGBmaWxlLSR7aX0uanBnYCk7XG4gICAgICAgIHZhbGlkYXRpb25zLnB1c2goc2VydmljZS52YWxpZGF0ZUZpbGUobW9ja0ZpbGUpKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGVuZFRpbWUgPSBEYXRlLm5vdygpO1xuXG4gICAgICBleHBlY3QodmFsaWRhdGlvbnMpLnRvSGF2ZUxlbmd0aChmaWxlQ291bnQpO1xuICAgICAgZXhwZWN0KHZhbGlkYXRpb25zLmV2ZXJ5KHYgPT4gdi5pc1ZhbGlkKSkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChlbmRUaW1lIC0gc3RhcnRUaW1lKS50b0JlTGVzc1RoYW4oMTAwMCk7IC8vIFNob3VsZCBjb21wbGV0ZSB3aXRoaW4gMSBzZWNvbmRcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHJlcGVhdGVkIHVwbG9hZHMgd2l0aG91dCBtZW1vcnkgbGVha3MnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrZWRBeGlvcy5wb3N0Lm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgIGRhdGE6IHsgbWVzc2FnZTogJ1N1Y2Nlc3MnIH0sXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgaW5pdGlhbE1lbW9yeSA9IHByb2Nlc3MubWVtb3J5VXNhZ2UoKS5oZWFwVXNlZDtcblxuICAgICAgLy8gUGVyZm9ybSBtYW55IHVwbG9hZHNcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNTA7IGkrKykge1xuICAgICAgICBjb25zdCBtb2NrRmlsZSA9IGNyZWF0ZU1vY2tGaWxlKGByZXBlYXRlZC1maWxlLSR7aX0uanBnYCk7XG4gICAgICAgIG1vY2tlZFV1aWR2NC5tb2NrUmV0dXJuVmFsdWUoYHV1aWQtJHtpfWApO1xuICAgICAgICBhd2FpdCBzZXJ2aWNlLnVwbG9hZEZpbGUobW9ja0ZpbGUsIG1vY2tCdWNrZXQpO1xuICAgICAgfVxuXG4gICAgICAvLyBGb3JjZSBnYXJiYWdlIGNvbGxlY3Rpb24gaWYgYXZhaWxhYmxlXG4gICAgICBpZiAoZ2xvYmFsLmdjKSB7XG4gICAgICAgIGdsb2JhbC5nYygpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBmaW5hbE1lbW9yeSA9IHByb2Nlc3MubWVtb3J5VXNhZ2UoKS5oZWFwVXNlZDtcbiAgICAgIGNvbnN0IG1lbW9yeUluY3JlYXNlID0gZmluYWxNZW1vcnkgLSBpbml0aWFsTWVtb3J5O1xuXG4gICAgICAvLyBNZW1vcnkgaW5jcmVhc2Ugc2hvdWxkIGJlIHJlYXNvbmFibGUgKGxlc3MgdGhhbiA1TUIgZm9yIDUwIHVwbG9hZHMpXG4gICAgICBleHBlY3QobWVtb3J5SW5jcmVhc2UpLnRvQmVMZXNzVGhhbig1ICogMTAyNCAqIDEwMjQpO1xuICAgIH0pO1xuICB9KTtcblxuICAvLyA9PT09PSBFUlJPUiBIQU5ETElORyBBTkQgRURHRSBDQVNFUyA9PT09PVxuXG4gIGRlc2NyaWJlKCdFcnJvciBoYW5kbGluZyBhbmQgZWRnZSBjYXNlcycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBtYWxmb3JtZWQgU3VwYWJhc2UgcmVzcG9uc2VzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja2VkQXhpb3MucG9zdC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIHN0YXR1czogMjAwLFxuICAgICAgICBkYXRhOiBudWxsLCAvLyBNYWxmb3JtZWQgcmVzcG9uc2VcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBtb2NrRmlsZSA9IGNyZWF0ZU1vY2tGaWxlKCk7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLnVwbG9hZEZpbGUobW9ja0ZpbGUsIG1vY2tCdWNrZXQpO1xuXG4gICAgICAvLyBTaG91bGQgc3RpbGwgd29yayBzaW5jZSB3ZSBvbmx5IGNoZWNrIHN0YXR1cyBjb2RlXG4gICAgICBleHBlY3QocmVzdWx0LmZpbGVuYW1lKS50b0JlKG1vY2tVbmlxdWVGaWxlbmFtZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBtaXNzaW5nIHJlc3BvbnNlIGRhdGEnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrZWRBeGlvcy5wb3N0Lm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgIC8vIE1pc3NpbmcgZGF0YSBwcm9wZXJ0eVxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IG1vY2tGaWxlID0gY3JlYXRlTW9ja0ZpbGUoKTtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UudXBsb2FkRmlsZShtb2NrRmlsZSwgbW9ja0J1Y2tldCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuZmlsZW5hbWUpLnRvQmUobW9ja1VuaXF1ZUZpbGVuYW1lKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGV4dHJlbWVseSBsYXJnZSBmaWxlbmFtZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBsb25nRmlsZW5hbWUgPSAnYScucmVwZWF0KDI1NSkgKyAnLmpwZyc7XG4gICAgICBjb25zdCBtb2NrRmlsZSA9IGNyZWF0ZU1vY2tGaWxlKGxvbmdGaWxlbmFtZSk7XG5cbiAgICAgIC8vIFNob3VsZCBmYWlsIHZhbGlkYXRpb24gZHVlIHRvIGludmFsaWQgY2hhcmFjdGVycyBmcm9tIGxlbmd0aCBjb25zdHJhaW50XG4gICAgICBjb25zdCB2YWxpZGF0aW9uID0gc2VydmljZS52YWxpZGF0ZUZpbGUobW9ja0ZpbGUpO1xuICAgICAgXG4gICAgICAvLyBUaGUgdmFsaWRhdGlvbiBzaG91bGQgc3RpbGwgd29yaywganVzdCBjaGVja2luZyBmb3IgaW52YWxpZCBjaGFyYWN0ZXJzXG4gICAgICAvLyBMb25nIGZpbGVuYW1lcyBhcmUgdHlwaWNhbGx5IGhhbmRsZWQgYnkgdGhlIGZpbGUgc3lzdGVtXG4gICAgICBleHBlY3QodmFsaWRhdGlvbi5pc1ZhbGlkKS50b0JlKHRydWUpOyAvLyBMZW5ndGggaXRzZWxmIGlzbid0IHZhbGlkYXRlZCwgb25seSBpbnZhbGlkIGNoYXJzXG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBmaWxlcyB3aXRoIFVuaWNvZGUgY2hhcmFjdGVycyBpbiBuYW1lcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHVuaWNvZGVGaWxlbmFtZSA9ICfRhNCw0LnQu1/mtYvor5Vf44OV44Kh44Kk44OrLmpwZyc7XG4gICAgICBjb25zdCBtb2NrRmlsZSA9IGNyZWF0ZU1vY2tGaWxlKHVuaWNvZGVGaWxlbmFtZSk7XG5cbiAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSBzZXJ2aWNlLnZhbGlkYXRlRmlsZShtb2NrRmlsZSk7XG4gICAgICBcbiAgICAgIC8vIFVuaWNvZGUgY2hhcmFjdGVycyB3b3VsZCBiZSByZXBsYWNlZCBieSB1bmRlcnNjb3JlcyBkdWUgdG8gcmVnZXhcbiAgICAgIGV4cGVjdCh2YWxpZGF0aW9uLmlzVmFsaWQpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KHZhbGlkYXRpb24uZXJyb3IpLnRvQmUoJ0ZpbGVuYW1lIGNvbnRhaW5zIGludmFsaWQgY2hhcmFjdGVycycpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbnVsbC91bmRlZmluZWQgZmlsZSBwcm9wZXJ0aWVzJywgKCkgPT4ge1xuICAgICAgY29uc3QgaW52YWxpZEZpbGUgPSB7XG4gICAgICAgIG9yaWdpbmFsbmFtZTogbnVsbCxcbiAgICAgICAgYnVmZmVyOiB1bmRlZmluZWQsXG4gICAgICAgIG1pbWV0eXBlOiAnJyxcbiAgICAgICAgc2l6ZTogTmFOLFxuICAgICAgfSBhcyBhbnk7XG5cbiAgICAgIGV4cGVjdCgoKSA9PiBzZXJ2aWNlLnZhbGlkYXRlRmlsZShpbnZhbGlkRmlsZSkpLm5vdC50b1Rocm93KCk7XG4gICAgICAvLyBTaG91bGQgaGFuZGxlIGdyYWNlZnVsbHkgYnkgY2hlY2tpbmcgd2hhdCBpdCBjYW5cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbmN1cnJlbnQgb3BlcmF0aW9ucyBvbiBzYW1lIGJ1Y2tldCcsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tlZEF4aW9zLnBvc3QubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBzdGF0dXM6IDIwMCxcbiAgICAgICAgZGF0YTogeyBtZXNzYWdlOiAnU3VjY2VzcycgfSxcbiAgICAgIH0pO1xuXG4gICAgICBtb2NrZWRBeGlvcy5kZWxldGUubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBzdGF0dXM6IDIwMCxcbiAgICAgICAgZGF0YTogeyBtZXNzYWdlOiAnU3VjY2VzcycgfSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCB1cGxvYWRQcm9taXNlcyA9IEFycmF5LmZyb20oeyBsZW5ndGg6IDUgfSwgKF8sIGkpID0+IHtcbiAgICAgICAgY29uc3QgbW9ja0ZpbGUgPSBjcmVhdGVNb2NrRmlsZShgY29uY3VycmVudC0ke2l9LmpwZ2ApO1xuICAgICAgICBtb2NrZWRVdWlkdjQubW9ja1JldHVyblZhbHVlKGB1dWlkLSR7aX1gKTtcbiAgICAgICAgcmV0dXJuIHNlcnZpY2UudXBsb2FkRmlsZShtb2NrRmlsZSwgbW9ja0J1Y2tldCk7XG4gICAgICB9KTtcblxuICAgICAgY29uc3QgZGVsZXRlUHJvbWlzZXMgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiAzIH0sIChfLCBpKSA9PlxuICAgICAgICBzZXJ2aWNlLmRlbGV0ZUZpbGUobW9ja0J1Y2tldCwgYGZpbGUtdG8tZGVsZXRlLSR7aX0uanBnYCksXG4gICAgICApO1xuXG4gICAgICAvLyBSdW4gdXBsb2FkcyBhbmQgZGVsZXRlcyBjb25jdXJyZW50bHlcbiAgICAgIGNvbnN0IFt1cGxvYWRSZXN1bHRzLCBkZWxldGVSZXN1bHRzXSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICAgICAgUHJvbWlzZS5hbGwodXBsb2FkUHJvbWlzZXMpLFxuICAgICAgICBQcm9taXNlLmFsbChkZWxldGVQcm9taXNlcyksXG4gICAgICBdKTtcblxuICAgICAgZXhwZWN0KHVwbG9hZFJlc3VsdHMpLnRvSGF2ZUxlbmd0aCg1KTtcbiAgICAgIGV4cGVjdChkZWxldGVSZXN1bHRzKS50b0hhdmVMZW5ndGgoMyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzZXJ2aWNlIGNvbmZpZ3VyYXRpb24gZWRnZSBjYXNlcycsICgpID0+IHtcbiAgICAgIC8vIFRlc3Qgd2l0aCB2YXJpb3VzIGVkZ2UgY2FzZSBjb25maWd1cmF0aW9uc1xuICAgICAgY29uc3QgZWRnZUNhc2VDb25maWdzID0gW1xuICAgICAgICB7IHVybDogJ2h0dHA6Ly9sb2NhbGhvc3QnLCBrZXk6ICdrZXknIH0sIC8vIE5vIEhUVFBTXG4gICAgICAgIHsgdXJsOiAnaHR0cHM6Ly90ZXN0LmNvbS8nLCBrZXk6ICdrZXknIH0sIC8vIFRyYWlsaW5nIHNsYXNoXG4gICAgICAgIHsgdXJsOiAnICBodHRwczovL3Rlc3QuY29tICAnLCBrZXk6ICcgIGtleSAgJyB9LCAvLyBXaGl0ZXNwYWNlXG4gICAgICBdO1xuXG4gICAgICBlZGdlQ2FzZUNvbmZpZ3MuZm9yRWFjaCgoeyB1cmwsIGtleSB9KSA9PiB7XG4gICAgICAgIGNvbmZpZ1NlcnZpY2UuZ2V0Lm1vY2tJbXBsZW1lbnRhdGlvbigoY29uZmlnS2V5OiBzdHJpbmcpID0+IHtcbiAgICAgICAgICBzd2l0Y2ggKGNvbmZpZ0tleSkge1xuICAgICAgICAgICAgY2FzZSAnU1VQQUJBU0VfVVJMJzpcbiAgICAgICAgICAgICAgcmV0dXJuIHVybDtcbiAgICAgICAgICAgIGNhc2UgJ1NVUEFCQVNFX0FQSV9LRVknOlxuICAgICAgICAgICAgICByZXR1cm4ga2V5O1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBTaG91bGQgaW5pdGlhbGl6ZSB3aXRob3V0IGVycm9yIGZvciBub24tZW1wdHkgdmFsdWVzXG4gICAgICAgIGlmICh1cmwudHJpbSgpICYmIGtleS50cmltKCkpIHtcbiAgICAgICAgICBleHBlY3QoKCkgPT4gbmV3IFN1cGFiYXNlU3RvcmFnZVNlcnZpY2UoY29uZmlnU2VydmljZSkpLm5vdC50b1Rocm93KCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgYXhpb3MgdGltZW91dCBzY2VuYXJpb3MnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB0aW1lb3V0RXJyb3IgPSB7XG4gICAgICAgIGNvZGU6ICdFQ09OTkFCT1JURUQnLFxuICAgICAgICBtZXNzYWdlOiAndGltZW91dCBvZiAzMDAwMG1zIGV4Y2VlZGVkJyxcbiAgICAgIH07XG4gICAgICBtb2NrZWRBeGlvcy5wb3N0Lm1vY2tSZWplY3RlZFZhbHVlKHRpbWVvdXRFcnJvcik7XG5cbiAgICAgIGNvbnN0IG1vY2tGaWxlID0gY3JlYXRlTW9ja0ZpbGUoKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KHNlcnZpY2UudXBsb2FkRmlsZShtb2NrRmlsZSwgbW9ja0J1Y2tldCkpLnJlamVjdHMudG9UaHJvdyhcbiAgICAgICAgJ0ZhaWxlZCB0byB1cGxvYWQgZmlsZSB0byBTdXBhYmFzZTogdGltZW91dCBvZiAzMDAwMG1zIGV4Y2VlZGVkJyxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBuZXR3b3JrIGNvbm5lY3Rpdml0eSBpc3N1ZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBuZXR3b3JrRXJyb3IgPSB7XG4gICAgICAgIGNvZGU6ICdFTk9URk9VTkQnLFxuICAgICAgICBtZXNzYWdlOiAnZ2V0YWRkcmluZm8gRU5PVEZPVU5EIHRlc3QtcHJvamVjdC5zdXBhYmFzZS5jbycsXG4gICAgICB9O1xuICAgICAgbW9ja2VkQXhpb3MucG9zdC5tb2NrUmVqZWN0ZWRWYWx1ZShuZXR3b3JrRXJyb3IpO1xuXG4gICAgICBjb25zdCBtb2NrRmlsZSA9IGNyZWF0ZU1vY2tGaWxlKCk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChzZXJ2aWNlLnVwbG9hZEZpbGUobW9ja0ZpbGUsIG1vY2tCdWNrZXQpKS5yZWplY3RzLnRvVGhyb3coXG4gICAgICAgICdGYWlsZWQgdG8gdXBsb2FkIGZpbGUgdG8gU3VwYWJhc2U6IGdldGFkZHJpbmZvIEVOT1RGT1VORCB0ZXN0LXByb2plY3Quc3VwYWJhc2UuY28nLFxuICAgICAgKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgLy8gPT09PT0gU0VDVVJJVFkgVEVTVFMgPT09PT1cblxuICBkZXNjcmliZSgnU2VjdXJpdHkgY29uc2lkZXJhdGlvbnMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBwcmV2ZW50IHBhdGggdHJhdmVyc2FsIGluIGZpbGVuYW1lcycsICgpID0+IHtcbiAgICAgIGNvbnN0IG1hbGljaW91c0ZpbGVuYW1lcyA9IFtcbiAgICAgICAgJy4uLy4uLy4uL2V0Yy9wYXNzd2QnLFxuICAgICAgICAnLi5cXFxcLi5cXFxcd2luZG93c1xcXFxzeXN0ZW0zMicsXG4gICAgICAgICcvZXRjL2hvc3RzJyxcbiAgICAgICAgJ0M6XFxcXFdpbmRvd3NcXFxcU3lzdGVtMzJcXFxcY29uZmlnJyxcbiAgICAgICAgJyUyZSUyZSUyZiUyZSUyZSUyZicsXG4gICAgICBdO1xuXG4gICAgICBtYWxpY2lvdXNGaWxlbmFtZXMuZm9yRWFjaCgoZmlsZW5hbWUpID0+IHtcbiAgICAgICAgY29uc3QgbW9ja0ZpbGUgPSBjcmVhdGVNb2NrRmlsZShmaWxlbmFtZSk7XG4gICAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSBzZXJ2aWNlLnZhbGlkYXRlRmlsZShtb2NrRmlsZSk7XG4gICAgICAgIGV4cGVjdCh2YWxpZGF0aW9uLmlzVmFsaWQpLnRvQmUoZmFsc2UpO1xuICAgICAgICBleHBlY3QodmFsaWRhdGlvbi5lcnJvcikudG9CZSgnRmlsZW5hbWUgY29udGFpbnMgaW52YWxpZCBjaGFyYWN0ZXJzJyk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc2FuaXRpemUgZmlsZW5hbWVzIHdpdGggZGFuZ2Vyb3VzIGNoYXJhY3RlcnMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBkYW5nZXJvdXNGaWxlbmFtZXMgPSBbXG4gICAgICAgICc8c2NyaXB0PmFsZXJ0KFwieHNzXCIpPC9zY3JpcHQ+LmpwZycsXG4gICAgICAgICdmaWxlO3JtIC1yZiAvLmpwZycsXG4gICAgICAgICdmaWxlYHdob2FtaWAuanBnJyxcbiAgICAgICAgJ2ZpbGUkKGNvbW1hbmQpLmpwZycsXG4gICAgICAgICdmaWxlJmNvbW1hbmQmLmpwZycsXG4gICAgICBdO1xuXG4gICAgICBkYW5nZXJvdXNGaWxlbmFtZXMuZm9yRWFjaCgoZmlsZW5hbWUpID0+IHtcbiAgICAgICAgY29uc3QgbW9ja0ZpbGUgPSBjcmVhdGVNb2NrRmlsZShmaWxlbmFtZSk7XG4gICAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSBzZXJ2aWNlLnZhbGlkYXRlRmlsZShtb2NrRmlsZSk7XG4gICAgICAgIGV4cGVjdCh2YWxpZGF0aW9uLmlzVmFsaWQpLnRvQmUoZmFsc2UpO1xuICAgICAgICBleHBlY3QodmFsaWRhdGlvbi5lcnJvcikudG9CZSgnRmlsZW5hbWUgY29udGFpbnMgaW52YWxpZCBjaGFyYWN0ZXJzJyk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVqZWN0IGV4ZWN1dGFibGUgZmlsZSB0eXBlcycsICgpID0+IHtcbiAgICAgIGNvbnN0IGV4ZWN1dGFibGVNaW1lVHlwZXMgPSBbXG4gICAgICAgICdhcHBsaWNhdGlvbi94LWV4ZWN1dGFibGUnLFxuICAgICAgICAnYXBwbGljYXRpb24veC1tc2Rvd25sb2FkJyxcbiAgICAgICAgJ2FwcGxpY2F0aW9uL3gtbXNkb3MtcHJvZ3JhbScsXG4gICAgICAgICdhcHBsaWNhdGlvbi94LW1zaScsXG4gICAgICAgICdhcHBsaWNhdGlvbi94LXNoJyxcbiAgICAgICAgJ2FwcGxpY2F0aW9uL3gtYmF0JyxcbiAgICAgIF07XG5cbiAgICAgIGV4ZWN1dGFibGVNaW1lVHlwZXMuZm9yRWFjaCgobWltZXR5cGUpID0+IHtcbiAgICAgICAgY29uc3QgbW9ja0ZpbGUgPSBjcmVhdGVNb2NrRmlsZSgnbWFsaWNpb3VzLmV4ZScsIEJ1ZmZlci5mcm9tKCdjb250ZW50JyksIG1pbWV0eXBlKTtcbiAgICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IHNlcnZpY2UudmFsaWRhdGVGaWxlKG1vY2tGaWxlKTtcbiAgICAgICAgZXhwZWN0KHZhbGlkYXRpb24uaXNWYWxpZCkudG9CZShmYWxzZSk7XG4gICAgICAgIGV4cGVjdCh2YWxpZGF0aW9uLmVycm9yKS50b0NvbnRhaW4oJ2lzIG5vdCBhbGxvd2VkJyk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG92ZXJzaXplZCBmaWxlIGF0dGFja3MnLCAoKSA9PiB7XG4gICAgICBjb25zdCBtYXNzaXZlU2l6ZSA9IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSO1xuICAgICAgY29uc3QgbW9ja0ZpbGUgPSBjcmVhdGVNb2NrRmlsZSgnaHVnZS5qcGcnLCBCdWZmZXIuYWxsb2MoMCksICdpbWFnZS9qcGVnJywgbWFzc2l2ZVNpemUpO1xuXG4gICAgICBjb25zdCB2YWxpZGF0aW9uID0gc2VydmljZS52YWxpZGF0ZUZpbGUobW9ja0ZpbGUpO1xuICAgICAgZXhwZWN0KHZhbGlkYXRpb24uaXNWYWxpZCkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QodmFsaWRhdGlvbi5lcnJvcikudG9Db250YWluKCdleGNlZWRzJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBhdXRob3JpemF0aW9uIGhlYWRlciBjb3JyZWN0bHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrZWRBeGlvcy5wb3N0Lm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgIGRhdGE6IHsgbWVzc2FnZTogJ1N1Y2Nlc3MnIH0sXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgbW9ja0ZpbGUgPSBjcmVhdGVNb2NrRmlsZSgpO1xuICAgICAgYXdhaXQgc2VydmljZS51cGxvYWRGaWxlKG1vY2tGaWxlLCBtb2NrQnVja2V0KTtcblxuICAgICAgZXhwZWN0KG1vY2tlZEF4aW9zLnBvc3QpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBleHBlY3QuYW55KFN0cmluZyksXG4gICAgICAgIGV4cGVjdC5hbnkoQnVmZmVyKSxcbiAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgIGhlYWRlcnM6IGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHttb2NrU3VwYWJhc2VBcGlLZXl9YCxcbiAgICAgICAgICB9KSxcbiAgICAgICAgfSksXG4gICAgICApO1xuXG4gICAgICAvLyBWZXJpZnkgdGhlIEFQSSBrZXkgaXMgbm90IGxvZ2dlZCBvciBleHBvc2VkXG4gICAgICBleHBlY3QobG9nZ2VyU3B5KS5ub3QudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIGV4cGVjdC5zdHJpbmdDb250YWluaW5nKG1vY2tTdXBhYmFzZUFwaUtleSksXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcbn0pOyJdLCJ2ZXJzaW9uIjozfQ==