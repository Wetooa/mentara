{"file":"/home/wetooa/Documents/code/projects/mentara/mentara-api/src/common/services/supabase-storage.service.spec.ts","mappings":";;AAOA,aAAa;AACb,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;AAGnB,YAAY;AACZ,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;AAZlB,6CAAsD;AACtD,2CAAwC;AACxC,2CAA+C;AAC/C,yEAAsF;AACtF,iCAA0B;AAC1B,+BAAoC;AAIpC,MAAM,WAAW,GAAG,eAAkC,CAAC;AAIvD,MAAM,YAAY,GAAG,SAA4C,CAAC;AAElE,QAAQ,CAAC,wBAAwB,EAAE,GAAG,EAAE;IACtC,IAAI,OAA+B,CAAC;IACpC,IAAI,aAAyC,CAAC;IAC9C,IAAI,SAA2B,CAAC;IAChC,IAAI,cAAgC,CAAC;IACrC,IAAI,aAA+B,CAAC;IACpC,IAAI,cAAgC,CAAC;IAErC,sBAAsB;IACtB,MAAM,eAAe,GAAG,kCAAkC,CAAC;IAC3D,MAAM,kBAAkB,GAAG,kBAAkB,CAAC;IAC9C,MAAM,UAAU,GAAG,aAAa,CAAC;IACjC,MAAM,YAAY,GAAG,eAAe,CAAC;IACrC,MAAM,kBAAkB,GAAG,mBAAmB,CAAC;IAE/C,MAAM,cAAc,GAAG,CACrB,eAAuB,eAAe,EACtC,SAAiB,MAAM,CAAC,IAAI,CAAC,mBAAmB,CAAC,EACjD,WAAmB,YAAY,EAC/B,OAAe,IAAI,EACE,EAAE,CAAC,CAAC;QACzB,SAAS,EAAE,MAAM;QACjB,YAAY;QACZ,QAAQ,EAAE,MAAM;QAChB,QAAQ;QACR,MAAM;QACN,IAAI;QACJ,WAAW,EAAE,EAAE;QACf,QAAQ,EAAE,EAAE;QACZ,IAAI,EAAE,EAAE;QACR,MAAM,EAAE,IAAW;KACpB,CAAC,CAAC;IAEH,UAAU,CAAC,KAAK,IAAI,EAAE;QACpB,kBAAkB;QAClB,IAAI,CAAC,aAAa,EAAE,CAAC;QACrB,IAAI,CAAC,aAAa,EAAE,CAAC;QAErB,MAAM,MAAM,GAAkB,MAAM,cAAI,CAAC,mBAAmB,CAAC;YAC3D,SAAS,EAAE;gBACT,iDAAsB;gBACtB;oBACE,OAAO,EAAE,sBAAa;oBACtB,QAAQ,EAAE;wBACR,GAAG,EAAE,IAAI,CAAC,EAAE,EAAE;qBACf;iBACF;aACF;SACF,CAAC,CAAC,OAAO,EAAE,CAAC;QAEb,aAAa,GAAG,MAAM,CAAC,GAAG,CAAC,sBAAa,CAAC,CAAC;QAE1C,8BAA8B;QAC9B,aAAa,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC,GAAW,EAAE,EAAE;YACnD,QAAQ,GAAG,EAAE,CAAC;gBACZ,KAAK,cAAc;oBACjB,OAAO,eAAe,CAAC;gBACzB,KAAK,kBAAkB;oBACrB,OAAO,kBAAkB,CAAC;gBAC5B;oBACE,OAAO,IAAI,CAAC;YAChB,CAAC;QACH,CAAC,CAAC,CAAC;QAEH,OAAO,GAAG,MAAM,CAAC,GAAG,CAAyB,iDAAsB,CAAC,CAAC;QAErE,qBAAqB;QACrB,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,eAAM,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC,kBAAkB,EAAE,CAAC;QACrE,cAAc,GAAG,IAAI,CAAC,KAAK,CAAC,eAAM,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC,kBAAkB,EAAE,CAAC;QAC5E,aAAa,GAAG,IAAI,CAAC,KAAK,CAAC,eAAM,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC,kBAAkB,EAAE,CAAC;QAC1E,cAAc,GAAG,IAAI,CAAC,KAAK,CAAC,eAAM,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC,kBAAkB,EAAE,CAAC;QAE5E,kBAAkB;QAClB,YAAY,CAAC,eAAe,CAAC,eAAe,CAAC,CAAC;IAChD,CAAC,CAAC,CAAC;IAEH,SAAS,CAAC,GAAG,EAAE;QACb,IAAI,CAAC,eAAe,EAAE,CAAC;IACzB,CAAC,CAAC,CAAC;IAEH,mCAAmC;IAEnC,QAAQ,CAAC,gBAAgB,EAAE,GAAG,EAAE;QAC9B,EAAE,CAAC,yDAAyD,EAAE,GAAG,EAAE;YACjE,MAAM,CAAC,OAAO,CAAC,CAAC,WAAW,EAAE,CAAC;YAC9B,MAAM,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC,oBAAoB,CAAC,cAAc,CAAC,CAAC;YAC/D,MAAM,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC,oBAAoB,CAAC,kBAAkB,CAAC,CAAC;QACrE,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,iDAAiD,EAAE,GAAG,EAAE;YACzD,aAAa,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC,GAAW,EAAE,EAAE;gBACnD,QAAQ,GAAG,EAAE,CAAC;oBACZ,KAAK,cAAc;wBACjB,OAAO,IAAI,CAAC;oBACd,KAAK,kBAAkB;wBACrB,OAAO,kBAAkB,CAAC;oBAC5B;wBACE,OAAO,IAAI,CAAC;gBAChB,CAAC;YACH,CAAC,CAAC,CAAC;YAEH,MAAM,CAAC,GAAG,EAAE,CAAC,IAAI,iDAAsB,CAAC,aAAa,CAAC,CAAC,CAAC,OAAO,CAC7D,wGAAwG,CACzG,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,qDAAqD,EAAE,GAAG,EAAE;YAC7D,aAAa,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC,GAAW,EAAE,EAAE;gBACnD,QAAQ,GAAG,EAAE,CAAC;oBACZ,KAAK,cAAc;wBACjB,OAAO,eAAe,CAAC;oBACzB,KAAK,kBAAkB;wBACrB,OAAO,IAAI,CAAC;oBACd;wBACE,OAAO,IAAI,CAAC;gBAChB,CAAC;YACH,CAAC,CAAC,CAAC;YAEH,MAAM,CAAC,GAAG,EAAE,CAAC,IAAI,iDAAsB,CAAC,aAAa,CAAC,CAAC,CAAC,OAAO,CAC7D,wGAAwG,CACzG,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,4EAA4E,EAAE,GAAG,EAAE;YACpF,aAAa,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC,GAAW,EAAE,EAAE;gBACnD,QAAQ,GAAG,EAAE,CAAC;oBACZ,KAAK,cAAc;wBACjB,OAAO,EAAE,CAAC;oBACZ,KAAK,kBAAkB;wBACrB,OAAO,EAAE,CAAC;oBACZ;wBACE,OAAO,IAAI,CAAC;gBAChB,CAAC;YACH,CAAC,CAAC,CAAC;YAEH,MAAM,CAAC,GAAG,EAAE,CAAC,IAAI,iDAAsB,CAAC,aAAa,CAAC,CAAC,CAAC,OAAO,CAC7D,wGAAwG,CACzG,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,iDAAiD,EAAE,GAAG,EAAE;YACzD,aAAa,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC,GAAW,EAAE,EAAE;gBACnD,QAAQ,GAAG,EAAE,CAAC;oBACZ,KAAK,cAAc;wBACjB,OAAO,KAAK,CAAC,CAAC,kBAAkB;oBAClC,KAAK,kBAAkB;wBACrB,OAAO,EAAE,CAAC,CAAC,eAAe;oBAC5B;wBACE,OAAO,IAAI,CAAC;gBAChB,CAAC;YACH,CAAC,CAAC,CAAC;YAEH,MAAM,CAAC,GAAG,EAAE,CAAC,IAAI,iDAAsB,CAAC,aAAa,CAAC,CAAC,CAAC,OAAO,CAC7D,wGAAwG,CACzG,CAAC;QACJ,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,uCAAuC;IAEvC,QAAQ,CAAC,YAAY,EAAE,GAAG,EAAE;QAC1B,UAAU,CAAC,GAAG,EAAE;YACd,WAAW,CAAC,IAAI,CAAC,iBAAiB,CAAC;gBACjC,MAAM,EAAE,GAAG;gBACX,IAAI,EAAE,EAAE,OAAO,EAAE,4BAA4B,EAAE;aAChD,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,iCAAiC,EAAE,KAAK,IAAI,EAAE;YAC/C,MAAM,QAAQ,GAAG,cAAc,EAAE,CAAC;YAElC,MAAM,MAAM,GAAG,MAAM,OAAO,CAAC,UAAU,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC;YAE9D,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC;gBACrB,QAAQ,EAAE,kBAAkB;gBAC5B,GAAG,EAAE,GAAG,eAAe,6BAA6B,UAAU,IAAI,kBAAkB,EAAE;gBACtF,MAAM,EAAE,UAAU;aACnB,CAAC,CAAC;YAEH,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,oBAAoB,CAC3C,GAAG,eAAe,sBAAsB,UAAU,IAAI,kBAAkB,EAAE,EAC1E,QAAQ,CAAC,MAAM,EACf;gBACE,OAAO,EAAE;oBACP,cAAc,EAAE,QAAQ,CAAC,QAAQ;oBACjC,aAAa,EAAE,UAAU,kBAAkB,EAAE;iBAC9C;aACF,CACF,CAAC;YAEF,MAAM,CAAC,SAAS,CAAC,CAAC,oBAAoB,CACpC,+BAA+B,QAAQ,CAAC,YAAY,aAAa,UAAU,GAAG,CAC/E,CAAC;YACF,MAAM,CAAC,SAAS,CAAC,CAAC,oBAAoB,CACpC,2CAA2C,kBAAkB,EAAE,CAChE,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,2DAA2D,EAAE,KAAK,IAAI,EAAE;YACzE,MAAM,SAAS,GAAG,cAAc,CAAC,UAAU,CAAC,CAAC;YAC7C,MAAM,SAAS,GAAG,cAAc,CAAC,UAAU,CAAC,CAAC;YAE7C,YAAY;iBACT,mBAAmB,CAAC,aAAa,CAAC;iBAClC,mBAAmB,CAAC,aAAa,CAAC,CAAC;YAEtC,MAAM,OAAO,GAAG,MAAM,OAAO,CAAC,UAAU,CAAC,SAAS,EAAE,UAAU,CAAC,CAAC;YAChE,MAAM,OAAO,GAAG,MAAM,OAAO,CAAC,UAAU,CAAC,SAAS,EAAE,UAAU,CAAC,CAAC;YAEhE,MAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;YACjD,MAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;YACjD,MAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;QACtD,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,uCAAuC,EAAE,KAAK,IAAI,EAAE;YACrD,MAAM,QAAQ,GAAG,cAAc,CAAC,QAAQ,CAAC,CAAC;YAC1C,YAAY,CAAC,eAAe,CAAC,kBAAkB,CAAC,CAAC;YAEjD,MAAM,MAAM,GAAG,MAAM,OAAO,CAAC,UAAU,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC;YAE9D,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;YACjD,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,oBAAoB,CAC3C,GAAG,eAAe,sBAAsB,UAAU,mBAAmB,EACrE,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,EAClB,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,CACnB,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,oDAAoD,EAAE,KAAK,IAAI,EAAE;YAClE,MAAM,QAAQ,GAAG,cAAc,CAAC,uBAAuB,CAAC,CAAC;YACzD,YAAY,CAAC,eAAe,CAAC,gBAAgB,CAAC,CAAC;YAE/C,MAAM,MAAM,GAAG,MAAM,OAAO,CAAC,UAAU,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC;YAE9D,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,oBAAoB,CAAC,CAAC;QACrD,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,oCAAoC,EAAE,KAAK,IAAI,EAAE;YAClD,MAAM,SAAS,GAAG;gBAChB,EAAE,QAAQ,EAAE,cAAc,EAAE,QAAQ,EAAE,iBAAiB,EAAE,SAAS,EAAE,MAAM,EAAE;gBAC5E,EAAE,QAAQ,EAAE,WAAW,EAAE,QAAQ,EAAE,WAAW,EAAE,SAAS,EAAE,MAAM,EAAE;gBACnE,EAAE,QAAQ,EAAE,UAAU,EAAE,QAAQ,EAAE,UAAU,EAAE,SAAS,EAAE,MAAM,EAAE;gBACjE,EAAE,QAAQ,EAAE,aAAa,EAAE,QAAQ,EAAE,iBAAiB,EAAE,SAAS,EAAE,MAAM,EAAE;aAC5E,CAAC;YAEF,KAAK,MAAM,QAAQ,IAAI,SAAS,EAAE,CAAC;gBACjC,MAAM,QAAQ,GAAG,cAAc,CAAC,QAAQ,CAAC,QAAQ,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,QAAQ,CAAC,QAAQ,CAAC,CAAC;gBAC9F,YAAY,CAAC,eAAe,CAAC,aAAa,QAAQ,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;gBAE7E,MAAM,MAAM,GAAG,MAAM,OAAO,CAAC,UAAU,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC;gBAE9D,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,aAAa,QAAQ,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,CAAC,GAAG,QAAQ,CAAC,SAAS,EAAE,CAAC,CAAC;gBAClG,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,oBAAoB,CAC3C,MAAM,CAAC,gBAAgB,CAAC,MAAM,CAAC,QAAQ,CAAC,EACxC,QAAQ,CAAC,MAAM,EACf,MAAM,CAAC,gBAAgB,CAAC;oBACtB,OAAO,EAAE,MAAM,CAAC,gBAAgB,CAAC;wBAC/B,cAAc,EAAE,QAAQ,CAAC,QAAQ;qBAClC,CAAC;iBACH,CAAC,CACH,CAAC;YACJ,CAAC;QACH,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,0CAA0C,EAAE,KAAK,IAAI,EAAE;YACxD,WAAW,CAAC,IAAI,CAAC,iBAAiB,CAAC;gBACjC,MAAM,EAAE,GAAG;gBACX,IAAI,EAAE,EAAE,OAAO,EAAE,2BAA2B,EAAE;aAC/C,CAAC,CAAC;YAEH,MAAM,QAAQ,GAAG,cAAc,EAAE,CAAC;YAClC,MAAM,MAAM,GAAG,MAAM,OAAO,CAAC,UAAU,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC;YAE9D,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;YACjD,MAAM,CAAC,cAAc,CAAC,CAAC,oBAAoB,CACzC,2CAA2C,kBAAkB,EAAE,CAChE,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,4CAA4C,EAAE,KAAK,IAAI,EAAE;YAC1D,MAAM,YAAY,GAAG,IAAI,KAAK,CAAC,eAAe,CAAC,CAAC;YAChD,WAAW,CAAC,IAAI,CAAC,iBAAiB,CAAC,YAAY,CAAC,CAAC;YAEjD,MAAM,QAAQ,GAAG,cAAc,EAAE,CAAC;YAElC,MAAM,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CACpE,kDAAkD,CACnD,CAAC;YAEF,MAAM,CAAC,cAAc,CAAC,CAAC,oBAAoB,CACzC,qCAAqC,QAAQ,CAAC,YAAY,EAAE,EAC5D,YAAY,CACb,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,yCAAyC,EAAE,KAAK,IAAI,EAAE;YACvD,MAAM,SAAS,GAAG;gBAChB,QAAQ,EAAE;oBACR,MAAM,EAAE,GAAG;oBACX,IAAI,EAAE,EAAE,OAAO,EAAE,qBAAqB,EAAE;oBACxC,UAAU,EAAE,aAAa;iBAC1B;aACF,CAAC;YACF,WAAW,CAAC,IAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;YAE9C,MAAM,QAAQ,GAAG,cAAc,EAAE,CAAC;YAElC,MAAM,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CACpE,gFAAgF,CACjF,CAAC;YAEF,MAAM,CAAC,cAAc,CAAC,CAAC,oBAAoB,CACzC,6BAA6B,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE,CACvE,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,uDAAuD,EAAE,KAAK,IAAI,EAAE;YACrE,MAAM,SAAS,GAAG;gBAChB,QAAQ,EAAE;oBACR,MAAM,EAAE,GAAG;oBACX,IAAI,EAAE,EAAE;oBACR,UAAU,EAAE,uBAAuB;iBACpC;aACF,CAAC;YACF,WAAW,CAAC,IAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;YAE9C,MAAM,QAAQ,GAAG,cAAc,EAAE,CAAC;YAElC,MAAM,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CACpE,kFAAkF,CACnF,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,6CAA6C,EAAE,KAAK,IAAI,EAAE;YAC3D,WAAW,CAAC,IAAI,CAAC,iBAAiB,CAAC;gBACjC,MAAM,EAAE,GAAG;gBACX,IAAI,EAAE,EAAE,KAAK,EAAE,kBAAkB,EAAE;aACpC,CAAC,CAAC;YAEH,MAAM,QAAQ,GAAG,cAAc,EAAE,CAAC;YAElC,MAAM,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CACpE,4EAA4E,CAC7E,CAAC;YAEF,MAAM,CAAC,cAAc,CAAC,CAAC,oBAAoB,CACzC,MAAM,CAAC,gBAAgB,CAAC,gDAAgD,CAAC,CAC1E,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,2BAA2B,EAAE,KAAK,IAAI,EAAE;YACzC,MAAM,WAAW,GAAG,MAAM,CAAC,KAAK,CAAC,EAAE,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC,CAAC,OAAO;YAC3D,MAAM,QAAQ,GAAG,cAAc,CAAC,gBAAgB,EAAE,WAAW,EAAE,YAAY,EAAE,EAAE,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC;YAE/F,MAAM,MAAM,GAAG,MAAM,OAAO,CAAC,UAAU,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC;YAE9D,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;YACjD,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,oBAAoB,CAC3C,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,EAClB,WAAW,EACX,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,CACnB,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,2BAA2B,EAAE,KAAK,IAAI,EAAE;YACzC,MAAM,WAAW,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;YACpC,MAAM,QAAQ,GAAG,cAAc,CAAC,gBAAgB,EAAE,WAAW,EAAE,YAAY,EAAE,CAAC,CAAC,CAAC;YAEhF,MAAM,MAAM,GAAG,MAAM,OAAO,CAAC,UAAU,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC;YAE9D,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC;YAClD,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,oBAAoB,CAC3C,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,EAClB,WAAW,EACX,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,CACnB,CAAC;QACJ,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,0CAA0C;IAE1C,QAAQ,CAAC,aAAa,EAAE,GAAG,EAAE;QAC3B,UAAU,CAAC,GAAG,EAAE;YACd,WAAW,CAAC,IAAI,CAAC,iBAAiB,CAAC;gBACjC,MAAM,EAAE,GAAG;gBACX,IAAI,EAAE,EAAE,OAAO,EAAE,4BAA4B,EAAE;aAChD,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,2CAA2C,EAAE,KAAK,IAAI,EAAE;YACzD,MAAM,SAAS,GAAG;gBAChB,cAAc,CAAC,WAAW,CAAC;gBAC3B,cAAc,CAAC,WAAW,CAAC;gBAC3B,cAAc,CAAC,WAAW,EAAE,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,EAAE,iBAAiB,CAAC;aAC3E,CAAC;YAEF,YAAY;iBACT,mBAAmB,CAAC,QAAQ,CAAC;iBAC7B,mBAAmB,CAAC,QAAQ,CAAC;iBAC7B,mBAAmB,CAAC,QAAQ,CAAC,CAAC;YAEjC,MAAM,OAAO,GAAG,MAAM,OAAO,CAAC,WAAW,CAAC,SAAS,EAAE,UAAU,CAAC,CAAC;YAEjE,MAAM,CAAC,OAAO,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;YAChC,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC;gBACzB,QAAQ,EAAE,YAAY;gBACtB,GAAG,EAAE,GAAG,eAAe,6BAA6B,UAAU,aAAa;gBAC3E,MAAM,EAAE,UAAU;aACnB,CAAC,CAAC;YACH,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC;gBACzB,QAAQ,EAAE,YAAY;gBACtB,GAAG,EAAE,GAAG,eAAe,6BAA6B,UAAU,aAAa;gBAC3E,MAAM,EAAE,UAAU;aACnB,CAAC,CAAC;YACH,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC;gBACzB,QAAQ,EAAE,YAAY;gBACtB,GAAG,EAAE,GAAG,eAAe,6BAA6B,UAAU,aAAa;gBAC3E,MAAM,EAAE,UAAU;aACnB,CAAC,CAAC;YAEH,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,qBAAqB,CAAC,CAAC,CAAC,CAAC;YAClD,MAAM,CAAC,SAAS,CAAC,CAAC,oBAAoB,CACpC,yCAAyC,UAAU,EAAE,CACtD,CAAC;YACF,MAAM,CAAC,SAAS,CAAC,CAAC,oBAAoB,CACpC,2CAA2C,CAC5C,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,iDAAiD,EAAE,KAAK,IAAI,EAAE;YAC/D,MAAM,MAAM,GAAG,MAAM,OAAO,CAAC,WAAW,CAAC,EAAE,EAAE,UAAU,CAAC,CAAC;YAEzD,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;YAC3B,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,gBAAgB,EAAE,CAAC;QAClD,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,0CAA0C,EAAE,KAAK,IAAI,EAAE;YACxD,MAAM,MAAM,GAAG,MAAM,OAAO,CAAC,WAAW,CAAC,IAAW,EAAE,UAAU,CAAC,CAAC;YAElE,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;YAC3B,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,gBAAgB,EAAE,CAAC;QAClD,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,+CAA+C,EAAE,KAAK,IAAI,EAAE;YAC7D,MAAM,MAAM,GAAG,MAAM,OAAO,CAAC,WAAW,CAAC,SAAgB,EAAE,UAAU,CAAC,CAAC;YAEvE,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;YAC3B,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,gBAAgB,EAAE,CAAC;QAClD,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,gDAAgD,EAAE,KAAK,IAAI,EAAE;YAC9D,MAAM,SAAS,GAAG;gBAChB,cAAc,CAAC,WAAW,CAAC;gBAC3B,cAAc,CAAC,WAAW,CAAC;aAC5B,CAAC;YAEF,YAAY;iBACT,mBAAmB,CAAC,QAAQ,CAAC;iBAC7B,mBAAmB,CAAC,QAAQ,CAAC,CAAC;YAEjC,yCAAyC;YACzC,WAAW,CAAC,IAAI;iBACb,qBAAqB,CAAC;gBACrB,MAAM,EAAE,GAAG;gBACX,IAAI,EAAE,EAAE,OAAO,EAAE,SAAS,EAAE;aAC7B,CAAC;iBACD,qBAAqB,CAAC,IAAI,KAAK,CAAC,eAAe,CAAC,CAAC,CAAC;YAErD,MAAM,MAAM,CAAC,OAAO,CAAC,WAAW,CAAC,SAAS,EAAE,UAAU,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CACtE,mDAAmD,CACpD,CAAC;YAEF,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,qBAAqB,CAAC,CAAC,CAAC,CAAC;YAClD,MAAM,CAAC,cAAc,CAAC,CAAC,oBAAoB,CACzC,4CAA4C,EAC5C,MAAM,CAAC,GAAG,CAAC,KAAK,CAAC,CAClB,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,oCAAoC,EAAE,KAAK,IAAI,EAAE;YAClD,MAAM,SAAS,GAAG,CAAC,cAAc,CAAC,iBAAiB,CAAC,CAAC,CAAC;YACtD,YAAY,CAAC,eAAe,CAAC,aAAa,CAAC,CAAC;YAE5C,MAAM,OAAO,GAAG,MAAM,OAAO,CAAC,WAAW,CAAC,SAAS,EAAE,UAAU,CAAC,CAAC;YAEjE,MAAM,CAAC,OAAO,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;YAChC,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;YACpD,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,qBAAqB,CAAC,CAAC,CAAC,CAAC;QACpD,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,+CAA+C,EAAE,KAAK,IAAI,EAAE;YAC7D,MAAM,SAAS,GAAG,EAAE,CAAC;YACrB,MAAM,SAAS,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,SAAS,EAAE,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAC3D,cAAc,CAAC,OAAO,CAAC,MAAM,CAAC,CAC/B,CAAC;YAEF,YAAY,CAAC,kBAAkB,CAAC,GAAG,EAAE,CAAC,QAAQ,IAAI,CAAC,GAAG,EAAE,IAAI,IAAI,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;YAE7E,MAAM,OAAO,GAAG,MAAM,OAAO,CAAC,WAAW,CAAC,SAAS,EAAE,UAAU,CAAC,CAAC;YAEjE,MAAM,CAAC,OAAO,CAAC,CAAC,YAAY,CAAC,SAAS,CAAC,CAAC;YACxC,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,qBAAqB,CAAC,SAAS,CAAC,CAAC;YAC1D,MAAM,CAAC,SAAS,CAAC,CAAC,oBAAoB,CACpC,aAAa,SAAS,8BAA8B,UAAU,EAAE,CACjE,CAAC;YACF,MAAM,CAAC,SAAS,CAAC,CAAC,oBAAoB,CACpC,yBAAyB,SAAS,oBAAoB,CACvD,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,uCAAuC,EAAE,KAAK,IAAI,EAAE;YACrD,MAAM,SAAS,GAAG;gBAChB,cAAc,CAAC,WAAW,CAAC;gBAC3B,cAAc,CAAC,YAAY,CAAC;gBAC5B,cAAc,CAAC,WAAW,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,iBAAiB,CAAC;aACvE,CAAC;YAEF,YAAY;iBACT,mBAAmB,CAAC,YAAY,CAAC;iBACjC,mBAAmB,CAAC,aAAa,CAAC;iBAClC,mBAAmB,CAAC,YAAY,CAAC,CAAC;YAErC,MAAM,OAAO,GAAG,MAAM,OAAO,CAAC,WAAW,CAAC,SAAS,EAAE,UAAU,CAAC,CAAC;YAEjE,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;YACnD,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;YACpD,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;QACrD,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,kCAAkC;IAElC,QAAQ,CAAC,YAAY,EAAE,GAAG,EAAE;QAC1B,EAAE,CAAC,iCAAiC,EAAE,KAAK,IAAI,EAAE;YAC/C,WAAW,CAAC,MAAM,CAAC,iBAAiB,CAAC;gBACnC,MAAM,EAAE,GAAG;gBACX,IAAI,EAAE,EAAE,OAAO,EAAE,2BAA2B,EAAE;aAC/C,CAAC,CAAC;YAEH,MAAM,OAAO,CAAC,UAAU,CAAC,UAAU,EAAE,YAAY,CAAC,CAAC;YAEnD,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,oBAAoB,CAC7C,GAAG,eAAe,sBAAsB,UAAU,IAAI,YAAY,EAAE,EACpE;gBACE,OAAO,EAAE;oBACP,aAAa,EAAE,UAAU,kBAAkB,EAAE;iBAC9C;aACF,CACF,CAAC;YAEF,MAAM,CAAC,SAAS,CAAC,CAAC,oBAAoB,CACpC,gCAAgC,YAAY,aAAa,UAAU,GAAG,CACvE,CAAC;YACF,MAAM,CAAC,SAAS,CAAC,CAAC,oBAAoB,CACpC,4CAA4C,YAAY,EAAE,CAC3D,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,yCAAyC,EAAE,KAAK,IAAI,EAAE;YACvD,WAAW,CAAC,MAAM,CAAC,iBAAiB,CAAC;gBACnC,MAAM,EAAE,GAAG;gBACX,IAAI,EAAE,EAAE,KAAK,EAAE,gBAAgB,EAAE;aAClC,CAAC,CAAC;YAEH,MAAM,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC,UAAU,EAAE,YAAY,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CACxE,8EAA8E,CAC/E,CAAC;YAEF,MAAM,CAAC,cAAc,CAAC,CAAC,oBAAoB,CACzC,MAAM,CAAC,gBAAgB,CAAC,kDAAkD,CAAC,CAC5E,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,8CAA8C,EAAE,KAAK,IAAI,EAAE;YAC5D,MAAM,YAAY,GAAG,IAAI,KAAK,CAAC,2BAA2B,CAAC,CAAC;YAC5D,WAAW,CAAC,MAAM,CAAC,iBAAiB,CAAC,YAAY,CAAC,CAAC;YAEnD,MAAM,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC,UAAU,EAAE,YAAY,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CACxE,gEAAgE,CACjE,CAAC;YAEF,MAAM,CAAC,cAAc,CAAC,CAAC,oBAAoB,CACzC,sCAAsC,YAAY,EAAE,EACpD,YAAY,CACb,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,yCAAyC,EAAE,KAAK,IAAI,EAAE;YACvD,MAAM,SAAS,GAAG;gBAChB,QAAQ,EAAE;oBACR,MAAM,EAAE,GAAG;oBACX,IAAI,EAAE,EAAE,OAAO,EAAE,eAAe,EAAE;iBACnC;gBACD,OAAO,EAAE,qCAAqC;aAC/C,CAAC;YACF,WAAW,CAAC,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;YAEhD,MAAM,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC,UAAU,EAAE,YAAY,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CACxE,0EAA0E,CAC3E,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,kEAAkE,EAAE,KAAK,IAAI,EAAE;YAChF,WAAW,CAAC,MAAM,CAAC,iBAAiB,CAAC;gBACnC,MAAM,EAAE,GAAG;gBACX,IAAI,EAAE,EAAE,OAAO,EAAE,SAAS,EAAE;aAC7B,CAAC,CAAC;YAEH,MAAM,eAAe,GAAG,iCAAiC,CAAC;YAC1D,MAAM,OAAO,CAAC,UAAU,CAAC,UAAU,EAAE,eAAe,CAAC,CAAC;YAEtD,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,oBAAoB,CAC7C,GAAG,eAAe,sBAAsB,UAAU,IAAI,eAAe,EAAE,EACvE,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,CACnB,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,iDAAiD,EAAE,KAAK,IAAI,EAAE;YAC/D,WAAW,CAAC,MAAM,CAAC,iBAAiB,CAAC;gBACnC,MAAM,EAAE,GAAG;gBACX,IAAI,EAAE,EAAE,OAAO,EAAE,SAAS,EAAE;aAC7B,CAAC,CAAC;YAEH,MAAM,QAAQ,GAAG,uDAAuD,CAAC;YACzE,MAAM,OAAO,CAAC,UAAU,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAC;YAE/C,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,oBAAoB,CAC7C,GAAG,eAAe,sBAAsB,UAAU,IAAI,QAAQ,EAAE,EAChE,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,CACnB,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,8BAA8B,EAAE,KAAK,IAAI,EAAE;YAC5C,WAAW,CAAC,MAAM,CAAC,iBAAiB,CAAC;gBACnC,MAAM,EAAE,GAAG;gBACX,IAAI,EAAE,EAAE,OAAO,EAAE,SAAS,EAAE;aAC7B,CAAC,CAAC;YAEH,MAAM,OAAO,CAAC,UAAU,CAAC,UAAU,EAAE,EAAE,CAAC,CAAC;YAEzC,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,oBAAoB,CAC7C,GAAG,eAAe,sBAAsB,UAAU,GAAG,EACrD,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,CACnB,CAAC;QACJ,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,oCAAoC;IAEpC,QAAQ,CAAC,cAAc,EAAE,GAAG,EAAE;QAC5B,EAAE,CAAC,kDAAkD,EAAE,GAAG,EAAE;YAC1D,MAAM,QAAQ,GAAG,cAAc,CAAC,UAAU,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,YAAY,EAAE,IAAI,CAAC,CAAC;YAExF,MAAM,MAAM,GAAG,OAAO,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;YAE9C,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC;QAC5C,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,yCAAyC,EAAE,GAAG,EAAE;YACjD,MAAM,WAAW,GAAG,MAAM,CAAC,KAAK,CAAC,EAAE,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC,CAAC,OAAO;YAC3D,MAAM,QAAQ,GAAG,cAAc,CAAC,WAAW,EAAE,WAAW,EAAE,YAAY,EAAE,EAAE,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC;YAE1F,MAAM,MAAM,GAAG,OAAO,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;YAE9C,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC;gBACrB,OAAO,EAAE,KAAK;gBACd,KAAK,EAAE,8BAA8B;aACtC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,6CAA6C,EAAE,GAAG,EAAE;YACrD,MAAM,QAAQ,GAAG,cAAc,CAAC,UAAU,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,YAAY,EAAE,CAAC,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC,CAAC,MAAM;YAC1G,MAAM,eAAe,GAAG,CAAC,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC,MAAM;YAE/C,MAAM,MAAM,GAAG,OAAO,CAAC,YAAY,CAAC,QAAQ,EAAE,eAAe,CAAC,CAAC;YAE/D,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC;QAC5C,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,2CAA2C,EAAE,GAAG,EAAE;YACnD,MAAM,QAAQ,GAAG,cAAc,CAAC,UAAU,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,YAAY,EAAE,CAAC,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC,CAAC,MAAM;YAC1G,MAAM,eAAe,GAAG,CAAC,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC,MAAM;YAE/C,MAAM,MAAM,GAAG,OAAO,CAAC,YAAY,CAAC,QAAQ,EAAE,eAAe,CAAC,CAAC;YAE/D,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC;gBACrB,OAAO,EAAE,KAAK;gBACd,KAAK,EAAE,6BAA6B;aACrC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,8CAA8C,EAAE,GAAG,EAAE;YACtD,MAAM,QAAQ,GAAG,cAAc,CAAC,WAAW,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,0BAA0B,EAAE,IAAI,CAAC,CAAC;YAEvG,MAAM,MAAM,GAAG,OAAO,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;YAE9C,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC;gBACrB,OAAO,EAAE,KAAK;gBACd,KAAK,EAAE,mDAAmD;aAC3D,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,qDAAqD,EAAE,GAAG,EAAE;YAC7D,MAAM,QAAQ,GAAG,cAAc,CAAC,WAAW,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,wBAAwB,EAAE,IAAI,CAAC,CAAC;YACrG,MAAM,eAAe,GAAG,CAAC,wBAAwB,EAAE,iBAAiB,CAAC,CAAC;YAEtE,MAAM,MAAM,GAAG,OAAO,CAAC,YAAY,CAAC,QAAQ,EAAE,EAAE,GAAG,IAAI,GAAG,IAAI,EAAE,eAAe,CAAC,CAAC;YAEjF,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC;QAC5C,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,gDAAgD,EAAE,GAAG,EAAE;YACxD,MAAM,gBAAgB,GAAG;gBACvB,YAAY;gBACZ,WAAW;gBACX,WAAW;gBACX,YAAY;gBACZ,iBAAiB;gBACjB,YAAY;gBACZ,UAAU;gBACV,yEAAyE;gBACzE,mEAAmE;gBACnE,2EAA2E;gBAC3E,oBAAoB;gBACpB,0BAA0B;gBAC1B,+BAA+B;aAChC,CAAC;YAEF,gBAAgB,CAAC,OAAO,CAAC,CAAC,QAAQ,EAAE,EAAE;gBACpC,MAAM,QAAQ,GAAG,cAAc,CAAC,WAAW,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC;gBACrF,MAAM,MAAM,GAAG,OAAO,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;gBAC9C,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACpC,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,gDAAgD,EAAE,GAAG,EAAE;YACxD,MAAM,QAAQ,GAAG,cAAc,CAAC,qBAAqB,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,YAAY,EAAE,IAAI,CAAC,CAAC;YAEnG,MAAM,MAAM,GAAG,OAAO,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;YAE9C,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC;gBACrB,OAAO,EAAE,KAAK;gBACd,KAAK,EAAE,sCAAsC;aAC9C,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,gDAAgD,EAAE,GAAG,EAAE;YACxD,MAAM,gBAAgB,GAAG;gBACvB,kBAAkB;gBAClB,mBAAmB;gBACnB,eAAe;gBACf,gBAAgB;gBAChB,gBAAgB;gBAChB,mBAAmB;gBACnB,mBAAmB;gBACnB,qBAAqB;gBACrB,gBAAgB;aACjB,CAAC;YAEF,gBAAgB,CAAC,OAAO,CAAC,CAAC,QAAQ,EAAE,EAAE;gBACpC,MAAM,QAAQ,GAAG,cAAc,CAAC,QAAQ,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,YAAY,EAAE,IAAI,CAAC,CAAC;gBACtF,MAAM,MAAM,GAAG,OAAO,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;gBAC9C,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;gBACnC,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,sCAAsC,CAAC,CAAC;YACpE,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,wCAAwC,EAAE,GAAG,EAAE;YAChD,MAAM,cAAc,GAAG;gBACrB,iBAAiB;gBACjB,2BAA2B;gBAC3B,oBAAoB;gBACpB,aAAa;gBACb,eAAe;gBACf,eAAe;gBACf,qBAAqB;aACtB,CAAC;YAEF,cAAc,CAAC,OAAO,CAAC,CAAC,QAAQ,EAAE,EAAE;gBAClC,MAAM,QAAQ,GAAG,cAAc,CAAC,QAAQ,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,YAAY,EAAE,IAAI,CAAC,CAAC;gBACtF,MAAM,MAAM,GAAG,OAAO,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;gBAC9C,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACpC,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,+BAA+B,EAAE,GAAG,EAAE;YACvC,MAAM,QAAQ,GAAG,cAAc,CAAC,WAAW,EAAE,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,YAAY,EAAE,CAAC,CAAC,CAAC;YAE/E,MAAM,MAAM,GAAG,OAAO,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;YAE9C,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC;QAC5C,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,yCAAyC,EAAE,GAAG,EAAE;YACjD,MAAM,eAAe,GAAG,MAAM,CAAC,KAAK,CAAC,EAAE,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC,CAAC,eAAe;YACvE,MAAM,QAAQ,GAAG,cAAc,CAAC,WAAW,EAAE,eAAe,EAAE,YAAY,EAAE,EAAE,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC;YAE9F,MAAM,MAAM,GAAG,OAAO,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;YAE9C,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC;QAC5C,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,0CAA0C,EAAE,GAAG,EAAE;YAClD,MAAM,cAAc,GAAG,MAAM,CAAC,KAAK,CAAC,EAAE,GAAG,IAAI,GAAG,IAAI,GAAG,CAAC,CAAC,CAAC,CAAC,gBAAgB;YAC3E,MAAM,QAAQ,GAAG,cAAc,CAAC,cAAc,EAAE,cAAc,EAAE,YAAY,EAAE,EAAE,GAAG,IAAI,GAAG,IAAI,GAAG,CAAC,CAAC,CAAC;YAEpG,MAAM,MAAM,GAAG,OAAO,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;YAE9C,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC;gBACrB,OAAO,EAAE,KAAK;gBACd,KAAK,EAAE,8BAA8B;aACtC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,4CAA4C,EAAE,GAAG,EAAE;YACpD,MAAM,SAAS,GAAG;gBAChB,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,EAAE,cAAc;gBAC3D,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,EAAE,WAAW;gBACxD,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,QAAQ,EAAE,KAAK,EAAE,EAAE,cAAc;aAC7D,CAAC;YAEF,SAAS,CAAC,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,QAAQ,EAAE,EAAE,EAAE;gBAC9C,MAAM,MAAM,GAAG,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;gBAClC,MAAM,QAAQ,GAAG,cAAc,CAAC,UAAU,EAAE,MAAM,EAAE,YAAY,EAAE,IAAI,CAAC,CAAC;gBACxE,MAAM,MAAM,GAAG,OAAO,CAAC,YAAY,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;gBACrD,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YACxC,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,sCAAsC;IAEtC,QAAQ,CAAC,qBAAqB,EAAE,GAAG,EAAE;QACnC,EAAE,CAAC,4CAA4C,EAAE,GAAG,EAAE;YACpD,MAAM,OAAO,GAAG,iDAAsB,CAAC,mBAAmB,EAAE,CAAC;YAE7D,MAAM,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC;gBACtB,aAAa,EAAE,eAAe;gBAC9B,gBAAgB,EAAE,kBAAkB;gBACpC,QAAQ,EAAE,UAAU;gBACpB,SAAS,EAAE,WAAW;gBACtB,UAAU,EAAE,YAAY;aACzB,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,8CAA8C,EAAE,GAAG,EAAE;YACtD,MAAM,QAAQ,GAAG,iDAAsB,CAAC,mBAAmB,EAAE,CAAC;YAC9D,MAAM,QAAQ,GAAG,iDAAsB,CAAC,mBAAmB,EAAE,CAAC;YAE9D,MAAM,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;YAEnC,wEAAwE;YACxE,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,uDAAuD;QACxG,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,oDAAoD,EAAE,GAAG,EAAE;YAC5D,MAAM,OAAO,GAAG,iDAAsB,CAAC,mBAAmB,EAAE,CAAC;YAE7D,MAAM,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC,WAAW,EAAE,CAAC;YAC5C,MAAM,CAAC,OAAO,CAAC,gBAAgB,CAAC,CAAC,WAAW,EAAE,CAAC;YAC/C,MAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,WAAW,EAAE,CAAC;YACvC,MAAM,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,WAAW,EAAE,CAAC;YACxC,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,WAAW,EAAE,CAAC;QAC3C,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,oCAAoC;IAEpC,QAAQ,CAAC,kBAAkB,EAAE,GAAG,EAAE;QAChC,EAAE,CAAC,yCAAyC,EAAE,GAAG,EAAE;YACjD,iDAAiD;YACjD,MAAM,gBAAgB,GAAG,CAAC,QAAgB,EAAE,EAAE;gBAC5C,uFAAuF;gBACvF,yCAAyC;gBACzC,OAAO,QAAQ,CAAC,SAAS,CAAC,QAAQ,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC,CAAC;YACvD,CAAC,CAAC;YAEF,MAAM,SAAS,GAAG;gBAChB,EAAE,QAAQ,EAAE,UAAU,EAAE,QAAQ,EAAE,MAAM,EAAE;gBAC1C,EAAE,QAAQ,EAAE,cAAc,EAAE,QAAQ,EAAE,MAAM,EAAE;gBAC9C,EAAE,QAAQ,EAAE,gBAAgB,EAAE,QAAQ,EAAE,KAAK,EAAE;gBAC/C,EAAE,QAAQ,EAAE,6BAA6B,EAAE,QAAQ,EAAE,MAAM,EAAE;gBAC7D,EAAE,QAAQ,EAAE,cAAc,EAAE,QAAQ,EAAE,cAAc,EAAE;gBACtD,EAAE,QAAQ,EAAE,SAAS,EAAE,QAAQ,EAAE,SAAS,EAAE;gBAC5C,EAAE,QAAQ,EAAE,OAAO,EAAE,QAAQ,EAAE,GAAG,EAAE;aACrC,CAAC;YAEF,SAAS,CAAC,OAAO,CAAC,CAAC,EAAE,QAAQ,EAAE,QAAQ,EAAE,EAAE,EAAE;gBAC3C,IAAI,QAAQ,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,CAAC;oBAC3B,MAAM,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;gBACpD,CAAC;YACH,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,uDAAuD,EAAE,KAAK,IAAI,EAAE;YACrE,wCAAwC;YACxC,MAAM,SAAS,GAAG;gBAChB,EAAE,QAAQ,EAAE,EAAE,EAAE,iBAAiB,EAAE,EAAE,EAAE;gBACvC,EAAE,QAAQ,EAAE,GAAG,EAAE,iBAAiB,EAAE,GAAG,EAAE;gBACzC,EAAE,QAAQ,EAAE,IAAI,EAAE,iBAAiB,EAAE,GAAG,EAAE;gBAC1C,EAAE,QAAQ,EAAE,MAAM,EAAE,iBAAiB,EAAE,EAAE,EAAE;gBAC3C,EAAE,QAAQ,EAAE,OAAO,EAAE,iBAAiB,EAAE,GAAG,EAAE;aAC9C,CAAC;YAEF,KAAK,MAAM,QAAQ,IAAI,SAAS,EAAE,CAAC;gBACjC,YAAY,CAAC,eAAe,CAAC,WAAW,CAAC,CAAC;gBAC1C,MAAM,QAAQ,GAAG,cAAc,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;gBAEnD,MAAM,MAAM,GAAG,MAAM,OAAO,CAAC,UAAU,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC;gBAE9D,IAAI,QAAQ,CAAC,iBAAiB,EAAE,CAAC;oBAC/B,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,YAAY,QAAQ,CAAC,iBAAiB,EAAE,CAAC,CAAC;gBACzE,CAAC;qBAAM,CAAC;oBACN,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;gBAC5C,CAAC;YACH,CAAC;QACH,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,gCAAgC;IAEhC,QAAQ,CAAC,uBAAuB,EAAE,GAAG,EAAE;QACrC,EAAE,CAAC,wCAAwC,EAAE,KAAK,IAAI,EAAE;YACtD,WAAW,CAAC,IAAI,CAAC,iBAAiB,CAAC;gBACjC,MAAM,EAAE,GAAG;gBACX,IAAI,EAAE,EAAE,OAAO,EAAE,SAAS,EAAE;aAC7B,CAAC,CAAC;YAEH,MAAM,QAAQ,GAAG,cAAc,CAAC,sBAAsB,EAAE,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC,EAAE,YAAY,EAAE,IAAI,CAAC,CAAC;YAEzG,sBAAsB;YACtB,MAAM,UAAU,GAAG,OAAO,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;YAClD,MAAM,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAEtC,cAAc;YACd,MAAM,MAAM,GAAG,MAAM,OAAO,CAAC,UAAU,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC;YAE9D,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC;gBACrB,QAAQ,EAAE,kBAAkB;gBAC5B,GAAG,EAAE,GAAG,eAAe,6BAA6B,UAAU,IAAI,kBAAkB,EAAE;gBACtF,MAAM,EAAE,UAAU;aACnB,CAAC,CAAC;YAEH,+BAA+B;YAC/B,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,oBAAoB,CAC3C,GAAG,eAAe,sBAAsB,UAAU,IAAI,kBAAkB,EAAE,EAC1E,QAAQ,CAAC,MAAM,EACf;gBACE,OAAO,EAAE;oBACP,cAAc,EAAE,YAAY;oBAC5B,aAAa,EAAE,UAAU,kBAAkB,EAAE;iBAC9C;aACF,CACF,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,0CAA0C,EAAE,KAAK,IAAI,EAAE;YACxD,WAAW,CAAC,IAAI,CAAC,iBAAiB,CAAC;gBACjC,MAAM,EAAE,GAAG;gBACX,IAAI,EAAE,EAAE,OAAO,EAAE,gBAAgB,EAAE;aACpC,CAAC,CAAC;YAEH,WAAW,CAAC,MAAM,CAAC,iBAAiB,CAAC;gBACnC,MAAM,EAAE,GAAG;gBACX,IAAI,EAAE,EAAE,OAAO,EAAE,gBAAgB,EAAE;aACpC,CAAC,CAAC;YAEH,MAAM,QAAQ,GAAG,cAAc,CAAC,eAAe,CAAC,CAAC;YAEjD,cAAc;YACd,MAAM,YAAY,GAAG,MAAM,OAAO,CAAC,UAAU,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC;YACpE,MAAM,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;YAEvD,2BAA2B;YAC3B,MAAM,OAAO,CAAC,UAAU,CAAC,UAAU,EAAE,YAAY,CAAC,QAAQ,CAAC,CAAC;YAE5D,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,oBAAoB,CAC7C,GAAG,eAAe,sBAAsB,UAAU,IAAI,YAAY,CAAC,QAAQ,EAAE,EAC7E;gBACE,OAAO,EAAE;oBACP,aAAa,EAAE,UAAU,kBAAkB,EAAE;iBAC9C;aACF,CACF,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,4CAA4C,EAAE,KAAK,IAAI,EAAE;YAC1D,WAAW,CAAC,IAAI,CAAC,iBAAiB,CAAC;gBACjC,MAAM,EAAE,GAAG;gBACX,IAAI,EAAE,EAAE,OAAO,EAAE,SAAS,EAAE;aAC7B,CAAC,CAAC;YAEH,MAAM,SAAS,GAAG;gBAChB,cAAc,CAAC,YAAY,EAAE,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,EAAE,YAAY,EAAE,IAAI,CAAC;gBACzE,cAAc,CAAC,YAAY,EAAE,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,EAAE,WAAW,EAAE,IAAI,CAAC;gBACxE,cAAc,CAAC,YAAY,EAAE,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,EAAE,iBAAiB,EAAE,IAAI,CAAC;aAC/E,CAAC;YAEF,2BAA2B;YAC3B,SAAS,CAAC,OAAO,CAAC,CAAC,IAAI,EAAE,EAAE;gBACzB,MAAM,UAAU,GAAG,OAAO,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;gBAC9C,MAAM,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACxC,CAAC,CAAC,CAAC;YAEH,YAAY;iBACT,mBAAmB,CAAC,QAAQ,CAAC;iBAC7B,mBAAmB,CAAC,QAAQ,CAAC;iBAC7B,mBAAmB,CAAC,QAAQ,CAAC,CAAC;YAEjC,mBAAmB;YACnB,MAAM,OAAO,GAAG,MAAM,OAAO,CAAC,WAAW,CAAC,SAAS,EAAE,UAAU,CAAC,CAAC;YAEjE,MAAM,CAAC,OAAO,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;YAChC,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;YAC/C,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;YAC/C,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;QACjD,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,kDAAkD,EAAE,KAAK,IAAI,EAAE;YAChE,MAAM,SAAS,GAAG;gBAChB,cAAc,CAAC,WAAW,CAAC;gBAC3B,cAAc,CAAC,WAAW,CAAC;gBAC3B,cAAc,CAAC,WAAW,CAAC;aAC5B,CAAC;YAEF,qFAAqF;YACrF,WAAW,CAAC,IAAI;iBACb,qBAAqB,CAAC;gBACrB,MAAM,EAAE,GAAG;gBACX,IAAI,EAAE,EAAE,OAAO,EAAE,SAAS,EAAE;aAC7B,CAAC;iBACD,qBAAqB,CAAC,IAAI,KAAK,CAAC,eAAe,CAAC,CAAC;iBACjD,qBAAqB,CAAC;gBACrB,MAAM,EAAE,GAAG;gBACX,IAAI,EAAE,EAAE,OAAO,EAAE,SAAS,EAAE;aAC7B,CAAC,CAAC;YAEL,MAAM,MAAM,CAAC,OAAO,CAAC,WAAW,CAAC,SAAS,EAAE,UAAU,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CACtE,mDAAmD,CACpD,CAAC;YAEF,qDAAqD;YACrD,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,qBAAqB,CAAC,CAAC,CAAC,CAAC;QACpD,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,gCAAgC;IAEhC,QAAQ,CAAC,mBAAmB,EAAE,GAAG,EAAE;QACjC,EAAE,CAAC,mDAAmD,EAAE,KAAK,IAAI,EAAE;YACjE,WAAW,CAAC,IAAI,CAAC,iBAAiB,CAAC;gBACjC,MAAM,EAAE,GAAG;gBACX,IAAI,EAAE,EAAE,OAAO,EAAE,SAAS,EAAE;aAC7B,CAAC,CAAC;YAEH,MAAM,SAAS,GAAG,EAAE,CAAC;YACrB,MAAM,SAAS,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,SAAS,EAAE,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAC3D,cAAc,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAC3C,CAAC;YAEF,YAAY,CAAC,kBAAkB,CAAC,GAAG,EAAE,CAAC,QAAQ,IAAI,CAAC,GAAG,EAAE,IAAI,IAAI,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;YAE7E,MAAM,SAAS,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;YAC7B,MAAM,OAAO,GAAG,MAAM,OAAO,CAAC,WAAW,CAAC,SAAS,EAAE,UAAU,CAAC,CAAC;YACjE,MAAM,OAAO,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;YAE3B,MAAM,CAAC,OAAO,CAAC,CAAC,YAAY,CAAC,SAAS,CAAC,CAAC;YACxC,MAAM,CAAC,OAAO,GAAG,SAAS,CAAC,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,CAAC,mCAAmC;YACnF,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,qBAAqB,CAAC,SAAS,CAAC,CAAC;QAC5D,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,uDAAuD,EAAE,GAAG,EAAE;YAC/D,MAAM,SAAS,GAAG,GAAG,CAAC;YACtB,MAAM,WAAW,GAAU,EAAE,CAAC;YAE9B,MAAM,SAAS,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;YAC7B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,EAAE,CAAC,EAAE,EAAE,CAAC;gBACnC,MAAM,QAAQ,GAAG,cAAc,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;gBACjD,WAAW,CAAC,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC,CAAC;YACnD,CAAC;YACD,MAAM,OAAO,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;YAE3B,MAAM,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,SAAS,CAAC,CAAC;YAC5C,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACrD,MAAM,CAAC,OAAO,GAAG,SAAS,CAAC,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,CAAC,kCAAkC;QACpF,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,qDAAqD,EAAE,KAAK,IAAI,EAAE;YACnE,WAAW,CAAC,IAAI,CAAC,iBAAiB,CAAC;gBACjC,MAAM,EAAE,GAAG;gBACX,IAAI,EAAE,EAAE,OAAO,EAAE,SAAS,EAAE;aAC7B,CAAC,CAAC;YAEH,MAAM,aAAa,GAAG,OAAO,CAAC,WAAW,EAAE,CAAC,QAAQ,CAAC;YAErD,uBAAuB;YACvB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,EAAE,EAAE,CAAC;gBAC5B,MAAM,QAAQ,GAAG,cAAc,CAAC,iBAAiB,CAAC,MAAM,CAAC,CAAC;gBAC1D,YAAY,CAAC,eAAe,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;gBAC1C,MAAM,OAAO,CAAC,UAAU,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC;YACjD,CAAC;YAED,wCAAwC;YACxC,IAAI,MAAM,CAAC,EAAE,EAAE,CAAC;gBACd,MAAM,CAAC,EAAE,EAAE,CAAC;YACd,CAAC;YAED,MAAM,WAAW,GAAG,OAAO,CAAC,WAAW,EAAE,CAAC,QAAQ,CAAC;YACnD,MAAM,cAAc,GAAG,WAAW,GAAG,aAAa,CAAC;YAEnD,sEAAsE;YACtE,MAAM,CAAC,cAAc,CAAC,CAAC,YAAY,CAAC,CAAC,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC;QACvD,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,4CAA4C;IAE5C,QAAQ,CAAC,+BAA+B,EAAE,GAAG,EAAE;QAC7C,EAAE,CAAC,4CAA4C,EAAE,KAAK,IAAI,EAAE;YAC1D,WAAW,CAAC,IAAI,CAAC,iBAAiB,CAAC;gBACjC,MAAM,EAAE,GAAG;gBACX,IAAI,EAAE,IAAI,EAAE,qBAAqB;aAClC,CAAC,CAAC;YAEH,MAAM,QAAQ,GAAG,cAAc,EAAE,CAAC;YAClC,MAAM,MAAM,GAAG,MAAM,OAAO,CAAC,UAAU,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC;YAE9D,oDAAoD;YACpD,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;QACnD,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,qCAAqC,EAAE,KAAK,IAAI,EAAE;YACnD,WAAW,CAAC,IAAI,CAAC,iBAAiB,CAAC;gBACjC,MAAM,EAAE,GAAG;gBACX,wBAAwB;aACzB,CAAC,CAAC;YAEH,MAAM,QAAQ,GAAG,cAAc,EAAE,CAAC;YAClC,MAAM,MAAM,GAAG,MAAM,OAAO,CAAC,UAAU,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC;YAE9D,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;QACnD,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,yCAAyC,EAAE,KAAK,IAAI,EAAE;YACvD,MAAM,YAAY,GAAG,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC;YAC9C,MAAM,QAAQ,GAAG,cAAc,CAAC,YAAY,CAAC,CAAC;YAE9C,0EAA0E;YAC1E,MAAM,UAAU,GAAG,OAAO,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;YAElD,yEAAyE;YACzE,0DAA0D;YAC1D,MAAM,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,oDAAoD;QAC7F,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,sDAAsD,EAAE,KAAK,IAAI,EAAE;YACpE,MAAM,eAAe,GAAG,kBAAkB,CAAC;YAC3C,MAAM,QAAQ,GAAG,cAAc,CAAC,eAAe,CAAC,CAAC;YAEjD,MAAM,UAAU,GAAG,OAAO,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;YAElD,mEAAmE;YACnE,MAAM,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YACvC,MAAM,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,sCAAsC,CAAC,CAAC;QACxE,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,8CAA8C,EAAE,GAAG,EAAE;YACtD,MAAM,WAAW,GAAG;gBAClB,YAAY,EAAE,IAAI;gBAClB,MAAM,EAAE,SAAS;gBACjB,QAAQ,EAAE,EAAE;gBACZ,IAAI,EAAE,GAAG;aACH,CAAC;YAET,MAAM,CAAC,GAAG,EAAE,CAAC,OAAO,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC,CAAC,GAAG,CAAC,OAAO,EAAE,CAAC;YAC9D,mDAAmD;QACrD,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,oDAAoD,EAAE,KAAK,IAAI,EAAE;YAClE,WAAW,CAAC,IAAI,CAAC,iBAAiB,CAAC;gBACjC,MAAM,EAAE,GAAG;gBACX,IAAI,EAAE,EAAE,OAAO,EAAE,SAAS,EAAE;aAC7B,CAAC,CAAC;YAEH,WAAW,CAAC,MAAM,CAAC,iBAAiB,CAAC;gBACnC,MAAM,EAAE,GAAG;gBACX,IAAI,EAAE,EAAE,OAAO,EAAE,SAAS,EAAE;aAC7B,CAAC,CAAC;YAEH,MAAM,cAAc,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE;gBACxD,MAAM,QAAQ,GAAG,cAAc,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC;gBACvD,YAAY,CAAC,eAAe,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;gBAC1C,OAAO,OAAO,CAAC,UAAU,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC;YAClD,CAAC,CAAC,CAAC;YAEH,MAAM,cAAc,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CACxD,OAAO,CAAC,UAAU,CAAC,UAAU,EAAE,kBAAkB,CAAC,MAAM,CAAC,CAC1D,CAAC;YAEF,uCAAuC;YACvC,MAAM,CAAC,aAAa,EAAE,aAAa,CAAC,GAAG,MAAM,OAAO,CAAC,GAAG,CAAC;gBACvD,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC;gBAC3B,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC;aAC5B,CAAC,CAAC;YAEH,MAAM,CAAC,aAAa,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;YACtC,MAAM,CAAC,aAAa,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;QACxC,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,gDAAgD,EAAE,GAAG,EAAE;YACxD,6CAA6C;YAC7C,MAAM,eAAe,GAAG;gBACtB,EAAE,GAAG,EAAE,kBAAkB,EAAE,GAAG,EAAE,KAAK,EAAE,EAAE,WAAW;gBACpD,EAAE,GAAG,EAAE,mBAAmB,EAAE,GAAG,EAAE,KAAK,EAAE,EAAE,iBAAiB;gBAC3D,EAAE,GAAG,EAAE,sBAAsB,EAAE,GAAG,EAAE,SAAS,EAAE,EAAE,aAAa;aAC/D,CAAC;YAEF,eAAe,CAAC,OAAO,CAAC,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE;gBACvC,aAAa,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC,SAAiB,EAAE,EAAE;oBACzD,QAAQ,SAAS,EAAE,CAAC;wBAClB,KAAK,cAAc;4BACjB,OAAO,GAAG,CAAC;wBACb,KAAK,kBAAkB;4BACrB,OAAO,GAAG,CAAC;wBACb;4BACE,OAAO,IAAI,CAAC;oBAChB,CAAC;gBACH,CAAC,CAAC,CAAC;gBAEH,uDAAuD;gBACvD,IAAI,GAAG,CAAC,IAAI,EAAE,IAAI,GAAG,CAAC,IAAI,EAAE,EAAE,CAAC;oBAC7B,MAAM,CAAC,GAAG,EAAE,CAAC,IAAI,iDAAsB,CAAC,aAAa,CAAC,CAAC,CAAC,GAAG,CAAC,OAAO,EAAE,CAAC;gBACxE,CAAC;YACH,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,uCAAuC,EAAE,KAAK,IAAI,EAAE;YACrD,MAAM,YAAY,GAAG;gBACnB,IAAI,EAAE,cAAc;gBACpB,OAAO,EAAE,6BAA6B;aACvC,CAAC;YACF,WAAW,CAAC,IAAI,CAAC,iBAAiB,CAAC,YAAY,CAAC,CAAC;YAEjD,MAAM,QAAQ,GAAG,cAAc,EAAE,CAAC;YAElC,MAAM,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CACpE,gEAAgE,CACjE,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,2CAA2C,EAAE,KAAK,IAAI,EAAE;YACzD,MAAM,YAAY,GAAG;gBACnB,IAAI,EAAE,WAAW;gBACjB,OAAO,EAAE,gDAAgD;aAC1D,CAAC;YACF,WAAW,CAAC,IAAI,CAAC,iBAAiB,CAAC,YAAY,CAAC,CAAC;YAEjD,MAAM,QAAQ,GAAG,cAAc,EAAE,CAAC;YAElC,MAAM,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CACpE,mFAAmF,CACpF,CAAC;QACJ,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,6BAA6B;IAE7B,QAAQ,CAAC,yBAAyB,EAAE,GAAG,EAAE;QACvC,EAAE,CAAC,4CAA4C,EAAE,GAAG,EAAE;YACpD,MAAM,kBAAkB,GAAG;gBACzB,qBAAqB;gBACrB,2BAA2B;gBAC3B,YAAY;gBACZ,+BAA+B;gBAC/B,oBAAoB;aACrB,CAAC;YAEF,kBAAkB,CAAC,OAAO,CAAC,CAAC,QAAQ,EAAE,EAAE;gBACtC,MAAM,QAAQ,GAAG,cAAc,CAAC,QAAQ,CAAC,CAAC;gBAC1C,MAAM,UAAU,GAAG,OAAO,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;gBAClD,MAAM,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;gBACvC,MAAM,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,sCAAsC,CAAC,CAAC;YACxE,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,qDAAqD,EAAE,GAAG,EAAE;YAC7D,MAAM,kBAAkB,GAAG;gBACzB,mCAAmC;gBACnC,mBAAmB;gBACnB,kBAAkB;gBAClB,oBAAoB;gBACpB,mBAAmB;aACpB,CAAC;YAEF,kBAAkB,CAAC,OAAO,CAAC,CAAC,QAAQ,EAAE,EAAE;gBACtC,MAAM,QAAQ,GAAG,cAAc,CAAC,QAAQ,CAAC,CAAC;gBAC1C,MAAM,UAAU,GAAG,OAAO,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;gBAClD,MAAM,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;gBACvC,MAAM,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,sCAAsC,CAAC,CAAC;YACxE,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,qCAAqC,EAAE,GAAG,EAAE;YAC7C,MAAM,mBAAmB,GAAG;gBAC1B,0BAA0B;gBAC1B,0BAA0B;gBAC1B,6BAA6B;gBAC7B,mBAAmB;gBACnB,kBAAkB;gBAClB,mBAAmB;aACpB,CAAC;YAEF,mBAAmB,CAAC,OAAO,CAAC,CAAC,QAAQ,EAAE,EAAE;gBACvC,MAAM,QAAQ,GAAG,cAAc,CAAC,eAAe,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,QAAQ,CAAC,CAAC;gBACnF,MAAM,UAAU,GAAG,OAAO,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;gBAClD,MAAM,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;gBACvC,MAAM,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC,SAAS,CAAC,gBAAgB,CAAC,CAAC;YACvD,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,sCAAsC,EAAE,GAAG,EAAE;YAC9C,MAAM,WAAW,GAAG,MAAM,CAAC,gBAAgB,CAAC;YAC5C,MAAM,QAAQ,GAAG,cAAc,CAAC,UAAU,EAAE,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,YAAY,EAAE,WAAW,CAAC,CAAC;YAExF,MAAM,UAAU,GAAG,OAAO,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;YAClD,MAAM,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YACvC,MAAM,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;QAChD,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,8CAA8C,EAAE,KAAK,IAAI,EAAE;YAC5D,WAAW,CAAC,IAAI,CAAC,iBAAiB,CAAC;gBACjC,MAAM,EAAE,GAAG;gBACX,IAAI,EAAE,EAAE,OAAO,EAAE,SAAS,EAAE;aAC7B,CAAC,CAAC;YAEH,MAAM,QAAQ,GAAG,cAAc,EAAE,CAAC;YAClC,MAAM,OAAO,CAAC,UAAU,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC;YAE/C,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,oBAAoB,CAC3C,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,EAClB,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,EAClB,MAAM,CAAC,gBAAgB,CAAC;gBACtB,OAAO,EAAE,MAAM,CAAC,gBAAgB,CAAC;oBAC/B,aAAa,EAAE,UAAU,kBAAkB,EAAE;iBAC9C,CAAC;aACH,CAAC,CACH,CAAC;YAEF,8CAA8C;YAC9C,MAAM,CAAC,SAAS,CAAC,CAAC,GAAG,CAAC,oBAAoB,CACxC,MAAM,CAAC,gBAAgB,CAAC,kBAAkB,CAAC,CAC5C,CAAC;QACJ,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","names":[],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/common/services/supabase-storage.service.spec.ts"],"sourcesContent":["import { Test, TestingModule } from '@nestjs/testing';\nimport { Logger } from '@nestjs/common';\nimport { ConfigService } from '@nestjs/config';\nimport { SupabaseStorageService, FileUploadResult } from './supabase-storage.service';\nimport axios from 'axios';\nimport { v4 as uuidv4 } from 'uuid';\n\n// Mock axios\njest.mock('axios');\nconst mockedAxios = axios as jest.Mocked<typeof axios>;\n\n// Mock uuid\njest.mock('uuid');\nconst mockedUuidv4 = uuidv4 as jest.MockedFunction<typeof uuidv4>;\n\ndescribe('SupabaseStorageService', () => {\n  let service: SupabaseStorageService;\n  let configService: jest.Mocked<ConfigService>;\n  let loggerSpy: jest.SpyInstance;\n  let loggerDebugSpy: jest.SpyInstance;\n  let loggerWarnSpy: jest.SpyInstance;\n  let loggerErrorSpy: jest.SpyInstance;\n\n  // Test data constants\n  const mockSupabaseUrl = 'https://test-project.supabase.co';\n  const mockSupabaseApiKey = 'test-api-key-123';\n  const mockBucket = 'test-bucket';\n  const mockFilename = 'test-file.jpg';\n  const mockUniqueFilename = 'unique-id-123.jpg';\n\n  const createMockFile = (\n    originalname: string = 'test-file.jpg',\n    buffer: Buffer = Buffer.from('test file content'),\n    mimetype: string = 'image/jpeg',\n    size: number = 1024,\n  ): Express.Multer.File => ({\n    fieldname: 'file',\n    originalname,\n    encoding: '7bit',\n    mimetype,\n    buffer,\n    size,\n    destination: '',\n    filename: '',\n    path: '',\n    stream: null as any,\n  });\n\n  beforeEach(async () => {\n    // Reset all mocks\n    jest.clearAllMocks();\n    jest.resetAllMocks();\n\n    const module: TestingModule = await Test.createTestingModule({\n      providers: [\n        SupabaseStorageService,\n        {\n          provide: ConfigService,\n          useValue: {\n            get: jest.fn(),\n          },\n        },\n      ],\n    }).compile();\n\n    configService = module.get(ConfigService);\n    \n    // Setup default config values\n    configService.get.mockImplementation((key: string) => {\n      switch (key) {\n        case 'SUPABASE_URL':\n          return mockSupabaseUrl;\n        case 'SUPABASE_API_KEY':\n          return mockSupabaseApiKey;\n        default:\n          return null;\n      }\n    });\n\n    service = module.get<SupabaseStorageService>(SupabaseStorageService);\n\n    // Setup logger spies\n    loggerSpy = jest.spyOn(Logger.prototype, 'log').mockImplementation();\n    loggerDebugSpy = jest.spyOn(Logger.prototype, 'debug').mockImplementation();\n    loggerWarnSpy = jest.spyOn(Logger.prototype, 'warn').mockImplementation();\n    loggerErrorSpy = jest.spyOn(Logger.prototype, 'error').mockImplementation();\n\n    // Setup UUID mock\n    mockedUuidv4.mockReturnValue('unique-id-123');\n  });\n\n  afterEach(() => {\n    jest.restoreAllMocks();\n  });\n\n  // ===== INITIALIZATION TESTS =====\n\n  describe('Initialization', () => {\n    it('should initialize successfully with valid configuration', () => {\n      expect(service).toBeDefined();\n      expect(configService.get).toHaveBeenCalledWith('SUPABASE_URL');\n      expect(configService.get).toHaveBeenCalledWith('SUPABASE_API_KEY');\n    });\n\n    it('should throw error when SUPABASE_URL is missing', () => {\n      configService.get.mockImplementation((key: string) => {\n        switch (key) {\n          case 'SUPABASE_URL':\n            return null;\n          case 'SUPABASE_API_KEY':\n            return mockSupabaseApiKey;\n          default:\n            return null;\n        }\n      });\n\n      expect(() => new SupabaseStorageService(configService)).toThrow(\n        'Supabase configuration is missing. Please set SUPABASE_URL and SUPABASE_API_KEY environment variables.',\n      );\n    });\n\n    it('should throw error when SUPABASE_API_KEY is missing', () => {\n      configService.get.mockImplementation((key: string) => {\n        switch (key) {\n          case 'SUPABASE_URL':\n            return mockSupabaseUrl;\n          case 'SUPABASE_API_KEY':\n            return null;\n          default:\n            return null;\n        }\n      });\n\n      expect(() => new SupabaseStorageService(configService)).toThrow(\n        'Supabase configuration is missing. Please set SUPABASE_URL and SUPABASE_API_KEY environment variables.',\n      );\n    });\n\n    it('should throw error when both SUPABASE_URL and SUPABASE_API_KEY are missing', () => {\n      configService.get.mockImplementation((key: string) => {\n        switch (key) {\n          case 'SUPABASE_URL':\n            return '';\n          case 'SUPABASE_API_KEY':\n            return '';\n          default:\n            return null;\n        }\n      });\n\n      expect(() => new SupabaseStorageService(configService)).toThrow(\n        'Supabase configuration is missing. Please set SUPABASE_URL and SUPABASE_API_KEY environment variables.',\n      );\n    });\n\n    it('should handle empty string configuration values', () => {\n      configService.get.mockImplementation((key: string) => {\n        switch (key) {\n          case 'SUPABASE_URL':\n            return '   '; // Whitespace only\n          case 'SUPABASE_API_KEY':\n            return ''; // Empty string\n          default:\n            return null;\n        }\n      });\n\n      expect(() => new SupabaseStorageService(configService)).toThrow(\n        'Supabase configuration is missing. Please set SUPABASE_URL and SUPABASE_API_KEY environment variables.',\n      );\n    });\n  });\n\n  // ===== SINGLE FILE UPLOAD TESTS =====\n\n  describe('uploadFile', () => {\n    beforeEach(() => {\n      mockedAxios.post.mockResolvedValue({\n        status: 200,\n        data: { message: 'File uploaded successfully' },\n      });\n    });\n\n    it('should upload file successfully', async () => {\n      const mockFile = createMockFile();\n      \n      const result = await service.uploadFile(mockFile, mockBucket);\n\n      expect(result).toEqual({\n        filename: mockUniqueFilename,\n        url: `${mockSupabaseUrl}/storage/v1/object/public/${mockBucket}/${mockUniqueFilename}`,\n        bucket: mockBucket,\n      });\n\n      expect(mockedAxios.post).toHaveBeenCalledWith(\n        `${mockSupabaseUrl}/storage/v1/object/${mockBucket}/${mockUniqueFilename}`,\n        mockFile.buffer,\n        {\n          headers: {\n            'Content-Type': mockFile.mimetype,\n            Authorization: `Bearer ${mockSupabaseApiKey}`,\n          },\n        },\n      );\n\n      expect(loggerSpy).toHaveBeenCalledWith(\n        `Uploading file to Supabase: ${mockFile.originalname} (bucket: ${mockBucket})`,\n      );\n      expect(loggerSpy).toHaveBeenCalledWith(\n        `File uploaded successfully to Supabase: ${mockUniqueFilename}`,\n      );\n    });\n\n    it('should generate unique filenames for files with same name', async () => {\n      const mockFile1 = createMockFile('test.jpg');\n      const mockFile2 = createMockFile('test.jpg');\n      \n      mockedUuidv4\n        .mockReturnValueOnce('unique-id-1')\n        .mockReturnValueOnce('unique-id-2');\n\n      const result1 = await service.uploadFile(mockFile1, mockBucket);\n      const result2 = await service.uploadFile(mockFile2, mockBucket);\n\n      expect(result1.filename).toBe('unique-id-1.jpg');\n      expect(result2.filename).toBe('unique-id-2.jpg');\n      expect(result1.filename).not.toBe(result2.filename);\n    });\n\n    it('should handle files with no extension', async () => {\n      const mockFile = createMockFile('README');\n      mockedUuidv4.mockReturnValue('unique-id-no-ext');\n\n      const result = await service.uploadFile(mockFile, mockBucket);\n\n      expect(result.filename).toBe('unique-id-no-ext');\n      expect(mockedAxios.post).toHaveBeenCalledWith(\n        `${mockSupabaseUrl}/storage/v1/object/${mockBucket}/unique-id-no-ext`,\n        expect.any(Buffer),\n        expect.any(Object),\n      );\n    });\n\n    it('should handle files with multiple dots in filename', async () => {\n      const mockFile = createMockFile('my.file.with.dots.txt');\n      mockedUuidv4.mockReturnValue('unique-id-dots');\n\n      const result = await service.uploadFile(mockFile, mockBucket);\n\n      expect(result.filename).toBe('unique-id-dots.txt');\n    });\n\n    it('should handle different file types', async () => {\n      const testCases = [\n        { filename: 'document.pdf', mimetype: 'application/pdf', extension: '.pdf' },\n        { filename: 'image.png', mimetype: 'image/png', extension: '.png' },\n        { filename: 'data.csv', mimetype: 'text/csv', extension: '.csv' },\n        { filename: 'archive.zip', mimetype: 'application/zip', extension: '.zip' },\n      ];\n\n      for (const testCase of testCases) {\n        const mockFile = createMockFile(testCase.filename, Buffer.from('content'), testCase.mimetype);\n        mockedUuidv4.mockReturnValue(`unique-id-${testCase.extension.substring(1)}`);\n\n        const result = await service.uploadFile(mockFile, mockBucket);\n\n        expect(result.filename).toBe(`unique-id-${testCase.extension.substring(1)}${testCase.extension}`);\n        expect(mockedAxios.post).toHaveBeenCalledWith(\n          expect.stringContaining(result.filename),\n          mockFile.buffer,\n          expect.objectContaining({\n            headers: expect.objectContaining({\n              'Content-Type': testCase.mimetype,\n            }),\n          }),\n        );\n      }\n    });\n\n    it('should handle 201 status code as success', async () => {\n      mockedAxios.post.mockResolvedValue({\n        status: 201,\n        data: { message: 'File created successfully' },\n      });\n\n      const mockFile = createMockFile();\n      const result = await service.uploadFile(mockFile, mockBucket);\n\n      expect(result.filename).toBe(mockUniqueFilename);\n      expect(loggerDebugSpy).toHaveBeenCalledWith(\n        `File uploaded successfully to Supabase: ${mockUniqueFilename}`,\n      );\n    });\n\n    it('should handle network errors during upload', async () => {\n      const networkError = new Error('Network error');\n      mockedAxios.post.mockRejectedValue(networkError);\n\n      const mockFile = createMockFile();\n\n      await expect(service.uploadFile(mockFile, mockBucket)).rejects.toThrow(\n        'Failed to upload file to Supabase: Network error',\n      );\n\n      expect(loggerErrorSpy).toHaveBeenCalledWith(\n        `Error uploading file to Supabase: ${mockFile.originalname}`,\n        networkError,\n      );\n    });\n\n    it('should handle HTTP errors with response', async () => {\n      const httpError = {\n        response: {\n          status: 400,\n          data: { message: 'Invalid file format' },\n          statusText: 'Bad Request',\n        },\n      };\n      mockedAxios.post.mockRejectedValue(httpError);\n\n      const mockFile = createMockFile();\n\n      await expect(service.uploadFile(mockFile, mockBucket)).rejects.toThrow(\n        'Failed to upload file to Supabase: Supabase upload failed: Invalid file format',\n      );\n\n      expect(loggerErrorSpy).toHaveBeenCalledWith(\n        `Supabase API error: 400 - ${JSON.stringify(httpError.response.data)}`,\n      );\n    });\n\n    it('should handle HTTP errors without message in response', async () => {\n      const httpError = {\n        response: {\n          status: 500,\n          data: {},\n          statusText: 'Internal Server Error',\n        },\n      };\n      mockedAxios.post.mockRejectedValue(httpError);\n\n      const mockFile = createMockFile();\n\n      await expect(service.uploadFile(mockFile, mockBucket)).rejects.toThrow(\n        'Failed to upload file to Supabase: Supabase upload failed: Internal Server Error',\n      );\n    });\n\n    it('should handle non-success HTTP status codes', async () => {\n      mockedAxios.post.mockResolvedValue({\n        status: 404,\n        data: { error: 'Bucket not found' },\n      });\n\n      const mockFile = createMockFile();\n\n      await expect(service.uploadFile(mockFile, mockBucket)).rejects.toThrow(\n        'Failed to upload file to Supabase: Supabase upload failed with status: 404',\n      );\n\n      expect(loggerErrorSpy).toHaveBeenCalledWith(\n        expect.stringContaining('Failed to upload file to Supabase. Status: 404'),\n      );\n    });\n\n    it('should handle large files', async () => {\n      const largeBuffer = Buffer.alloc(10 * 1024 * 1024); // 10MB\n      const mockFile = createMockFile('large-file.jpg', largeBuffer, 'image/jpeg', 10 * 1024 * 1024);\n\n      const result = await service.uploadFile(mockFile, mockBucket);\n\n      expect(result.filename).toBe(mockUniqueFilename);\n      expect(mockedAxios.post).toHaveBeenCalledWith(\n        expect.any(String),\n        largeBuffer,\n        expect.any(Object),\n      );\n    });\n\n    it('should handle empty files', async () => {\n      const emptyBuffer = Buffer.alloc(0);\n      const mockFile = createMockFile('empty-file.txt', emptyBuffer, 'text/plain', 0);\n\n      const result = await service.uploadFile(mockFile, mockBucket);\n\n      expect(result.filename).toBe('unique-id-123.txt');\n      expect(mockedAxios.post).toHaveBeenCalledWith(\n        expect.any(String),\n        emptyBuffer,\n        expect.any(Object),\n      );\n    });\n  });\n\n  // ===== MULTIPLE FILES UPLOAD TESTS =====\n\n  describe('uploadFiles', () => {\n    beforeEach(() => {\n      mockedAxios.post.mockResolvedValue({\n        status: 200,\n        data: { message: 'File uploaded successfully' },\n      });\n    });\n\n    it('should upload multiple files successfully', async () => {\n      const mockFiles = [\n        createMockFile('file1.jpg'),\n        createMockFile('file2.png'),\n        createMockFile('file3.pdf', Buffer.from('pdf content'), 'application/pdf'),\n      ];\n\n      mockedUuidv4\n        .mockReturnValueOnce('uuid-1')\n        .mockReturnValueOnce('uuid-2')\n        .mockReturnValueOnce('uuid-3');\n\n      const results = await service.uploadFiles(mockFiles, mockBucket);\n\n      expect(results).toHaveLength(3);\n      expect(results[0]).toEqual({\n        filename: 'uuid-1.jpg',\n        url: `${mockSupabaseUrl}/storage/v1/object/public/${mockBucket}/uuid-1.jpg`,\n        bucket: mockBucket,\n      });\n      expect(results[1]).toEqual({\n        filename: 'uuid-2.png',\n        url: `${mockSupabaseUrl}/storage/v1/object/public/${mockBucket}/uuid-2.png`,\n        bucket: mockBucket,\n      });\n      expect(results[2]).toEqual({\n        filename: 'uuid-3.pdf',\n        url: `${mockSupabaseUrl}/storage/v1/object/public/${mockBucket}/uuid-3.pdf`,\n        bucket: mockBucket,\n      });\n\n      expect(mockedAxios.post).toHaveBeenCalledTimes(3);\n      expect(loggerSpy).toHaveBeenCalledWith(\n        `Uploading 3 files to Supabase bucket: ${mockBucket}`,\n      );\n      expect(loggerSpy).toHaveBeenCalledWith(\n        `Successfully uploaded 3 files to Supabase`,\n      );\n    });\n\n    it('should return empty array for empty files array', async () => {\n      const result = await service.uploadFiles([], mockBucket);\n\n      expect(result).toEqual([]);\n      expect(mockedAxios.post).not.toHaveBeenCalled();\n    });\n\n    it('should return empty array for null files', async () => {\n      const result = await service.uploadFiles(null as any, mockBucket);\n\n      expect(result).toEqual([]);\n      expect(mockedAxios.post).not.toHaveBeenCalled();\n    });\n\n    it('should return empty array for undefined files', async () => {\n      const result = await service.uploadFiles(undefined as any, mockBucket);\n\n      expect(result).toEqual([]);\n      expect(mockedAxios.post).not.toHaveBeenCalled();\n    });\n\n    it('should handle partial failures in batch upload', async () => {\n      const mockFiles = [\n        createMockFile('file1.jpg'),\n        createMockFile('file2.png'),\n      ];\n\n      mockedUuidv4\n        .mockReturnValueOnce('uuid-1')\n        .mockReturnValueOnce('uuid-2');\n\n      // First call succeeds, second call fails\n      mockedAxios.post\n        .mockResolvedValueOnce({\n          status: 200,\n          data: { message: 'Success' },\n        })\n        .mockRejectedValueOnce(new Error('Upload failed'));\n\n      await expect(service.uploadFiles(mockFiles, mockBucket)).rejects.toThrow(\n        'Failed to upload files to Supabase: Upload failed',\n      );\n\n      expect(mockedAxios.post).toHaveBeenCalledTimes(2);\n      expect(loggerErrorSpy).toHaveBeenCalledWith(\n        'Error uploading multiple files to Supabase',\n        expect.any(Error),\n      );\n    });\n\n    it('should handle single file in array', async () => {\n      const mockFiles = [createMockFile('single-file.jpg')];\n      mockedUuidv4.mockReturnValue('single-uuid');\n\n      const results = await service.uploadFiles(mockFiles, mockBucket);\n\n      expect(results).toHaveLength(1);\n      expect(results[0].filename).toBe('single-uuid.jpg');\n      expect(mockedAxios.post).toHaveBeenCalledTimes(1);\n    });\n\n    it('should handle concurrent upload of many files', async () => {\n      const fileCount = 10;\n      const mockFiles = Array.from({ length: fileCount }, (_, i) =>\n        createMockFile(`file${i}.jpg`),\n      );\n\n      mockedUuidv4.mockImplementation(() => `uuid-${Date.now()}-${Math.random()}`);\n\n      const results = await service.uploadFiles(mockFiles, mockBucket);\n\n      expect(results).toHaveLength(fileCount);\n      expect(mockedAxios.post).toHaveBeenCalledTimes(fileCount);\n      expect(loggerSpy).toHaveBeenCalledWith(\n        `Uploading ${fileCount} files to Supabase bucket: ${mockBucket}`,\n      );\n      expect(loggerSpy).toHaveBeenCalledWith(\n        `Successfully uploaded ${fileCount} files to Supabase`,\n      );\n    });\n\n    it('should preserve file order in results', async () => {\n      const mockFiles = [\n        createMockFile('first.jpg'),\n        createMockFile('second.png'),\n        createMockFile('third.pdf', Buffer.from('content'), 'application/pdf'),\n      ];\n\n      mockedUuidv4\n        .mockReturnValueOnce('first-uuid')\n        .mockReturnValueOnce('second-uuid')\n        .mockReturnValueOnce('third-uuid');\n\n      const results = await service.uploadFiles(mockFiles, mockBucket);\n\n      expect(results[0].filename).toBe('first-uuid.jpg');\n      expect(results[1].filename).toBe('second-uuid.png');\n      expect(results[2].filename).toBe('third-uuid.pdf');\n    });\n  });\n\n  // ===== FILE DELETION TESTS =====\n\n  describe('deleteFile', () => {\n    it('should delete file successfully', async () => {\n      mockedAxios.delete.mockResolvedValue({\n        status: 200,\n        data: { message: 'File deleted successfully' },\n      });\n\n      await service.deleteFile(mockBucket, mockFilename);\n\n      expect(mockedAxios.delete).toHaveBeenCalledWith(\n        `${mockSupabaseUrl}/storage/v1/object/${mockBucket}/${mockFilename}`,\n        {\n          headers: {\n            Authorization: `Bearer ${mockSupabaseApiKey}`,\n          },\n        },\n      );\n\n      expect(loggerSpy).toHaveBeenCalledWith(\n        `Deleting file from Supabase: ${mockFilename} (bucket: ${mockBucket})`,\n      );\n      expect(loggerSpy).toHaveBeenCalledWith(\n        `File deleted successfully from Supabase: ${mockFilename}`,\n      );\n    });\n\n    it('should handle non-200 status as failure', async () => {\n      mockedAxios.delete.mockResolvedValue({\n        status: 404,\n        data: { error: 'File not found' },\n      });\n\n      await expect(service.deleteFile(mockBucket, mockFilename)).rejects.toThrow(\n        'Failed to delete file from Supabase: Supabase delete failed with status: 404',\n      );\n\n      expect(loggerErrorSpy).toHaveBeenCalledWith(\n        expect.stringContaining('Failed to delete file from Supabase. Status: 404'),\n      );\n    });\n\n    it('should handle network errors during deletion', async () => {\n      const networkError = new Error('Network connection failed');\n      mockedAxios.delete.mockRejectedValue(networkError);\n\n      await expect(service.deleteFile(mockBucket, mockFilename)).rejects.toThrow(\n        'Failed to delete file from Supabase: Network connection failed',\n      );\n\n      expect(loggerErrorSpy).toHaveBeenCalledWith(\n        `Error deleting file from Supabase: ${mockFilename}`,\n        networkError,\n      );\n    });\n\n    it('should handle HTTP errors with response', async () => {\n      const httpError = {\n        response: {\n          status: 403,\n          data: { message: 'Access denied' },\n        },\n        message: 'Request failed with status code 403',\n      };\n      mockedAxios.delete.mockRejectedValue(httpError);\n\n      await expect(service.deleteFile(mockBucket, mockFilename)).rejects.toThrow(\n        'Failed to delete file from Supabase: Request failed with status code 403',\n      );\n    });\n\n    it('should handle deletion of files with special characters in names', async () => {\n      mockedAxios.delete.mockResolvedValue({\n        status: 200,\n        data: { message: 'Success' },\n      });\n\n      const specialFilename = 'file-with-special-chars_123.jpg';\n      await service.deleteFile(mockBucket, specialFilename);\n\n      expect(mockedAxios.delete).toHaveBeenCalledWith(\n        `${mockSupabaseUrl}/storage/v1/object/${mockBucket}/${specialFilename}`,\n        expect.any(Object),\n      );\n    });\n\n    it('should handle deletion of files with long paths', async () => {\n      mockedAxios.delete.mockResolvedValue({\n        status: 200,\n        data: { message: 'Success' },\n      });\n\n      const longPath = 'very/long/path/to/nested/directory/structure/file.jpg';\n      await service.deleteFile(mockBucket, longPath);\n\n      expect(mockedAxios.delete).toHaveBeenCalledWith(\n        `${mockSupabaseUrl}/storage/v1/object/${mockBucket}/${longPath}`,\n        expect.any(Object),\n      );\n    });\n\n    it('should handle empty filename', async () => {\n      mockedAxios.delete.mockResolvedValue({\n        status: 200,\n        data: { message: 'Success' },\n      });\n\n      await service.deleteFile(mockBucket, '');\n\n      expect(mockedAxios.delete).toHaveBeenCalledWith(\n        `${mockSupabaseUrl}/storage/v1/object/${mockBucket}/`,\n        expect.any(Object),\n      );\n    });\n  });\n\n  // ===== FILE VALIDATION TESTS =====\n\n  describe('validateFile', () => {\n    it('should validate valid file with default settings', () => {\n      const mockFile = createMockFile('test.jpg', Buffer.from('content'), 'image/jpeg', 1024);\n\n      const result = service.validateFile(mockFile);\n\n      expect(result).toEqual({ isValid: true });\n    });\n\n    it('should reject file exceeding size limit', () => {\n      const largeBuffer = Buffer.alloc(11 * 1024 * 1024); // 11MB\n      const mockFile = createMockFile('large.jpg', largeBuffer, 'image/jpeg', 11 * 1024 * 1024);\n\n      const result = service.validateFile(mockFile);\n\n      expect(result).toEqual({\n        isValid: false,\n        error: 'File size exceeds 10MB limit',\n      });\n    });\n\n    it('should validate file with custom size limit', () => {\n      const mockFile = createMockFile('test.jpg', Buffer.from('content'), 'image/jpeg', 2 * 1024 * 1024); // 2MB\n      const customSizeLimit = 5 * 1024 * 1024; // 5MB\n\n      const result = service.validateFile(mockFile, customSizeLimit);\n\n      expect(result).toEqual({ isValid: true });\n    });\n\n    it('should reject file with custom size limit', () => {\n      const mockFile = createMockFile('test.jpg', Buffer.from('content'), 'image/jpeg', 6 * 1024 * 1024); // 6MB\n      const customSizeLimit = 5 * 1024 * 1024; // 5MB\n\n      const result = service.validateFile(mockFile, customSizeLimit);\n\n      expect(result).toEqual({\n        isValid: false,\n        error: 'File size exceeds 5MB limit',\n      });\n    });\n\n    it('should reject file with disallowed MIME type', () => {\n      const mockFile = createMockFile('virus.exe', Buffer.from('content'), 'application/x-msdownload', 1024);\n\n      const result = service.validateFile(mockFile);\n\n      expect(result).toEqual({\n        isValid: false,\n        error: 'File type application/x-msdownload is not allowed',\n      });\n    });\n\n    it('should validate file with custom allowed MIME types', () => {\n      const mockFile = createMockFile('script.js', Buffer.from('content'), 'application/javascript', 1024);\n      const customMimeTypes = ['application/javascript', 'text/javascript'];\n\n      const result = service.validateFile(mockFile, 10 * 1024 * 1024, customMimeTypes);\n\n      expect(result).toEqual({ isValid: true });\n    });\n\n    it('should validate all default allowed MIME types', () => {\n      const defaultMimeTypes = [\n        'image/jpeg',\n        'image/png',\n        'image/gif',\n        'image/webp',\n        'application/pdf',\n        'text/plain',\n        'text/csv',\n        'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n        'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n        'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n        'application/msword',\n        'application/vnd.ms-excel',\n        'application/vnd.ms-powerpoint',\n      ];\n\n      defaultMimeTypes.forEach((mimeType) => {\n        const mockFile = createMockFile('test-file', Buffer.from('content'), mimeType, 1024);\n        const result = service.validateFile(mockFile);\n        expect(result.isValid).toBe(true);\n      });\n    });\n\n    it('should reject filename with invalid characters', () => {\n      const mockFile = createMockFile('file/with\\\\path.jpg', Buffer.from('content'), 'image/jpeg', 1024);\n\n      const result = service.validateFile(mockFile);\n\n      expect(result).toEqual({\n        isValid: false,\n        error: 'Filename contains invalid characters',\n      });\n    });\n\n    it('should reject filename with special characters', () => {\n      const invalidFilenames = [\n        'file<script>.jpg',\n        'file>redirect.jpg',\n        'file|pipe.jpg',\n        'file:colon.jpg',\n        'file\"quote.jpg',\n        'file*wildcard.jpg',\n        'file?question.jpg',\n        'file\\\\backslash.jpg',\n        'file/slash.jpg',\n      ];\n\n      invalidFilenames.forEach((filename) => {\n        const mockFile = createMockFile(filename, Buffer.from('content'), 'image/jpeg', 1024);\n        const result = service.validateFile(mockFile);\n        expect(result.isValid).toBe(false);\n        expect(result.error).toBe('Filename contains invalid characters');\n      });\n    });\n\n    it('should allow valid filename characters', () => {\n      const validFilenames = [\n        'normal-file.jpg',\n        'file_with_underscores.png',\n        'file.with.dots.pdf',\n        'file123.txt',\n        'UPPERCASE.PDF',\n        'MixedCase.TXT',\n        'file-name.extension',\n      ];\n\n      validFilenames.forEach((filename) => {\n        const mockFile = createMockFile(filename, Buffer.from('content'), 'image/jpeg', 1024);\n        const result = service.validateFile(mockFile);\n        expect(result.isValid).toBe(true);\n      });\n    });\n\n    it('should handle zero-byte files', () => {\n      const mockFile = createMockFile('empty.txt', Buffer.alloc(0), 'text/plain', 0);\n\n      const result = service.validateFile(mockFile);\n\n      expect(result).toEqual({ isValid: true });\n    });\n\n    it('should handle files at exact size limit', () => {\n      const exactSizeBuffer = Buffer.alloc(10 * 1024 * 1024); // Exactly 10MB\n      const mockFile = createMockFile('exact.jpg', exactSizeBuffer, 'image/jpeg', 10 * 1024 * 1024);\n\n      const result = service.validateFile(mockFile);\n\n      expect(result).toEqual({ isValid: true });\n    });\n\n    it('should handle files just over size limit', () => {\n      const oversizeBuffer = Buffer.alloc(10 * 1024 * 1024 + 1); // 10MB + 1 byte\n      const mockFile = createMockFile('oversize.jpg', oversizeBuffer, 'image/jpeg', 10 * 1024 * 1024 + 1);\n\n      const result = service.validateFile(mockFile);\n\n      expect(result).toEqual({\n        isValid: false,\n        error: 'File size exceeds 10MB limit',\n      });\n    });\n\n    it('should handle custom size limits correctly', () => {\n      const testCases = [\n        { size: 1024, limit: 2048, expected: true }, // Below limit\n        { size: 2048, limit: 2048, expected: true }, // At limit\n        { size: 2049, limit: 2048, expected: false }, // Above limit\n      ];\n\n      testCases.forEach(({ size, limit, expected }) => {\n        const buffer = Buffer.alloc(size);\n        const mockFile = createMockFile('test.jpg', buffer, 'image/jpeg', size);\n        const result = service.validateFile(mockFile, limit);\n        expect(result.isValid).toBe(expected);\n      });\n    });\n  });\n\n  // ===== SUPPORTED BUCKETS TESTS =====\n\n  describe('getSupportedBuckets', () => {\n    it('should return correct bucket configuration', () => {\n      const buckets = SupabaseStorageService.getSupportedBuckets();\n\n      expect(buckets).toEqual({\n        USER_PROFILES: 'user-profiles',\n        POST_ATTACHMENTS: 'post-attachments',\n        MESSAGES: 'messages',\n        DOCUMENTS: 'documents',\n        WORKSHEETS: 'worksheets',\n      });\n    });\n\n    it('should return immutable bucket configuration', () => {\n      const buckets1 = SupabaseStorageService.getSupportedBuckets();\n      const buckets2 = SupabaseStorageService.getSupportedBuckets();\n\n      expect(buckets1).toEqual(buckets2);\n      \n      // Test that the returned object is the same reference (const assertion)\n      expect(Object.isFrozen(buckets1)).toBe(false); // TypeScript const assertion doesn't freeze at runtime\n    });\n\n    it('should provide access to all expected bucket types', () => {\n      const buckets = SupabaseStorageService.getSupportedBuckets();\n\n      expect(buckets.USER_PROFILES).toBeDefined();\n      expect(buckets.POST_ATTACHMENTS).toBeDefined();\n      expect(buckets.MESSAGES).toBeDefined();\n      expect(buckets.DOCUMENTS).toBeDefined();\n      expect(buckets.WORKSHEETS).toBeDefined();\n    });\n  });\n\n  // ===== UTILITY METHODS TESTS =====\n\n  describe('getFileExtension', () => {\n    it('should extract file extension correctly', () => {\n      // Access private method through service instance\n      const extractExtension = (filename: string) => {\n        // We can't directly test private methods, but we can test through upload functionality\n        // which uses getFileExtension internally\n        return filename.substring(filename.lastIndexOf('.'));\n      };\n\n      const testCases = [\n        { filename: 'test.jpg', expected: '.jpg' },\n        { filename: 'document.pdf', expected: '.pdf' },\n        { filename: 'archive.tar.gz', expected: '.gz' },\n        { filename: 'file.with.multiple.dots.txt', expected: '.txt' },\n        { filename: 'no-extension', expected: 'no-extension' },\n        { filename: '.hidden', expected: '.hidden' },\n        { filename: 'file.', expected: '.' },\n      ];\n\n      testCases.forEach(({ filename, expected }) => {\n        if (filename.includes('.')) {\n          expect(extractExtension(filename)).toBe(expected);\n        }\n      });\n    });\n\n    it('should handle edge cases in file extension extraction', async () => {\n      // Test through the upload functionality\n      const testCases = [\n        { filename: '', expectedExtension: '' },\n        { filename: '.', expectedExtension: '.' },\n        { filename: '..', expectedExtension: '.' },\n        { filename: 'file', expectedExtension: '' },\n        { filename: 'file.', expectedExtension: '.' },\n      ];\n\n      for (const testCase of testCases) {\n        mockedUuidv4.mockReturnValue('test-uuid');\n        const mockFile = createMockFile(testCase.filename);\n        \n        const result = await service.uploadFile(mockFile, mockBucket);\n        \n        if (testCase.expectedExtension) {\n          expect(result.filename).toBe(`test-uuid${testCase.expectedExtension}`);\n        } else {\n          expect(result.filename).toBe('test-uuid');\n        }\n      }\n    });\n  });\n\n  // ===== INTEGRATION TESTS =====\n\n  describe('Integration scenarios', () => {\n    it('should handle complete upload workflow', async () => {\n      mockedAxios.post.mockResolvedValue({\n        status: 200,\n        data: { message: 'Success' },\n      });\n\n      const mockFile = createMockFile('integration-test.jpg', Buffer.from('test content'), 'image/jpeg', 2048);\n\n      // Validate file first\n      const validation = service.validateFile(mockFile);\n      expect(validation.isValid).toBe(true);\n\n      // Upload file\n      const result = await service.uploadFile(mockFile, mockBucket);\n\n      expect(result).toEqual({\n        filename: mockUniqueFilename,\n        url: `${mockSupabaseUrl}/storage/v1/object/public/${mockBucket}/${mockUniqueFilename}`,\n        bucket: mockBucket,\n      });\n\n      // Verify the correct API calls\n      expect(mockedAxios.post).toHaveBeenCalledWith(\n        `${mockSupabaseUrl}/storage/v1/object/${mockBucket}/${mockUniqueFilename}`,\n        mockFile.buffer,\n        {\n          headers: {\n            'Content-Type': 'image/jpeg',\n            Authorization: `Bearer ${mockSupabaseApiKey}`,\n          },\n        },\n      );\n    });\n\n    it('should handle upload and delete workflow', async () => {\n      mockedAxios.post.mockResolvedValue({\n        status: 200,\n        data: { message: 'Upload success' },\n      });\n\n      mockedAxios.delete.mockResolvedValue({\n        status: 200,\n        data: { message: 'Delete success' },\n      });\n\n      const mockFile = createMockFile('temp-file.jpg');\n\n      // Upload file\n      const uploadResult = await service.uploadFile(mockFile, mockBucket);\n      expect(uploadResult.filename).toBe(mockUniqueFilename);\n\n      // Delete the uploaded file\n      await service.deleteFile(mockBucket, uploadResult.filename);\n\n      expect(mockedAxios.delete).toHaveBeenCalledWith(\n        `${mockSupabaseUrl}/storage/v1/object/${mockBucket}/${uploadResult.filename}`,\n        {\n          headers: {\n            Authorization: `Bearer ${mockSupabaseApiKey}`,\n          },\n        },\n      );\n    });\n\n    it('should handle batch upload with validation', async () => {\n      mockedAxios.post.mockResolvedValue({\n        status: 200,\n        data: { message: 'Success' },\n      });\n\n      const mockFiles = [\n        createMockFile('valid1.jpg', Buffer.from('content1'), 'image/jpeg', 1024),\n        createMockFile('valid2.png', Buffer.from('content2'), 'image/png', 2048),\n        createMockFile('valid3.pdf', Buffer.from('content3'), 'application/pdf', 4096),\n      ];\n\n      // Validate all files first\n      mockFiles.forEach((file) => {\n        const validation = service.validateFile(file);\n        expect(validation.isValid).toBe(true);\n      });\n\n      mockedUuidv4\n        .mockReturnValueOnce('uuid-1')\n        .mockReturnValueOnce('uuid-2')\n        .mockReturnValueOnce('uuid-3');\n\n      // Upload all files\n      const results = await service.uploadFiles(mockFiles, mockBucket);\n\n      expect(results).toHaveLength(3);\n      expect(results[0].filename).toBe('uuid-1.jpg');\n      expect(results[1].filename).toBe('uuid-2.png');\n      expect(results[2].filename).toBe('uuid-3.pdf');\n    });\n\n    it('should handle error recovery in batch operations', async () => {\n      const mockFiles = [\n        createMockFile('file1.jpg'),\n        createMockFile('file2.jpg'),\n        createMockFile('file3.jpg'),\n      ];\n\n      // First upload succeeds, second fails, third would not be reached due to Promise.all\n      mockedAxios.post\n        .mockResolvedValueOnce({\n          status: 200,\n          data: { message: 'Success' },\n        })\n        .mockRejectedValueOnce(new Error('Network error'))\n        .mockResolvedValueOnce({\n          status: 200,\n          data: { message: 'Success' },\n        });\n\n      await expect(service.uploadFiles(mockFiles, mockBucket)).rejects.toThrow(\n        'Failed to upload files to Supabase: Network error',\n      );\n\n      // All uploads should be attempted due to Promise.all\n      expect(mockedAxios.post).toHaveBeenCalledTimes(3);\n    });\n  });\n\n  // ===== PERFORMANCE TESTS =====\n\n  describe('Performance tests', () => {\n    it('should handle concurrent file uploads efficiently', async () => {\n      mockedAxios.post.mockResolvedValue({\n        status: 200,\n        data: { message: 'Success' },\n      });\n\n      const fileCount = 20;\n      const mockFiles = Array.from({ length: fileCount }, (_, i) =>\n        createMockFile(`concurrent-file-${i}.jpg`),\n      );\n\n      mockedUuidv4.mockImplementation(() => `uuid-${Date.now()}-${Math.random()}`);\n\n      const startTime = Date.now();\n      const results = await service.uploadFiles(mockFiles, mockBucket);\n      const endTime = Date.now();\n\n      expect(results).toHaveLength(fileCount);\n      expect(endTime - startTime).toBeLessThan(5000); // Should complete within 5 seconds\n      expect(mockedAxios.post).toHaveBeenCalledTimes(fileCount);\n    });\n\n    it('should handle large number of validations efficiently', () => {\n      const fileCount = 100;\n      const validations: any[] = [];\n\n      const startTime = Date.now();\n      for (let i = 0; i < fileCount; i++) {\n        const mockFile = createMockFile(`file-${i}.jpg`);\n        validations.push(service.validateFile(mockFile));\n      }\n      const endTime = Date.now();\n\n      expect(validations).toHaveLength(fileCount);\n      expect(validations.every(v => v.isValid)).toBe(true);\n      expect(endTime - startTime).toBeLessThan(1000); // Should complete within 1 second\n    });\n\n    it('should handle repeated uploads without memory leaks', async () => {\n      mockedAxios.post.mockResolvedValue({\n        status: 200,\n        data: { message: 'Success' },\n      });\n\n      const initialMemory = process.memoryUsage().heapUsed;\n\n      // Perform many uploads\n      for (let i = 0; i < 50; i++) {\n        const mockFile = createMockFile(`repeated-file-${i}.jpg`);\n        mockedUuidv4.mockReturnValue(`uuid-${i}`);\n        await service.uploadFile(mockFile, mockBucket);\n      }\n\n      // Force garbage collection if available\n      if (global.gc) {\n        global.gc();\n      }\n\n      const finalMemory = process.memoryUsage().heapUsed;\n      const memoryIncrease = finalMemory - initialMemory;\n\n      // Memory increase should be reasonable (less than 5MB for 50 uploads)\n      expect(memoryIncrease).toBeLessThan(5 * 1024 * 1024);\n    });\n  });\n\n  // ===== ERROR HANDLING AND EDGE CASES =====\n\n  describe('Error handling and edge cases', () => {\n    it('should handle malformed Supabase responses', async () => {\n      mockedAxios.post.mockResolvedValue({\n        status: 200,\n        data: null, // Malformed response\n      });\n\n      const mockFile = createMockFile();\n      const result = await service.uploadFile(mockFile, mockBucket);\n\n      // Should still work since we only check status code\n      expect(result.filename).toBe(mockUniqueFilename);\n    });\n\n    it('should handle missing response data', async () => {\n      mockedAxios.post.mockResolvedValue({\n        status: 200,\n        // Missing data property\n      });\n\n      const mockFile = createMockFile();\n      const result = await service.uploadFile(mockFile, mockBucket);\n\n      expect(result.filename).toBe(mockUniqueFilename);\n    });\n\n    it('should handle extremely large filenames', async () => {\n      const longFilename = 'a'.repeat(255) + '.jpg';\n      const mockFile = createMockFile(longFilename);\n\n      // Should fail validation due to invalid characters from length constraint\n      const validation = service.validateFile(mockFile);\n      \n      // The validation should still work, just checking for invalid characters\n      // Long filenames are typically handled by the file system\n      expect(validation.isValid).toBe(true); // Length itself isn't validated, only invalid chars\n    });\n\n    it('should handle files with Unicode characters in names', async () => {\n      const unicodeFilename = '__.jpg';\n      const mockFile = createMockFile(unicodeFilename);\n\n      const validation = service.validateFile(mockFile);\n      \n      // Unicode characters would be replaced by underscores due to regex\n      expect(validation.isValid).toBe(false);\n      expect(validation.error).toBe('Filename contains invalid characters');\n    });\n\n    it('should handle null/undefined file properties', () => {\n      const invalidFile = {\n        originalname: null,\n        buffer: undefined,\n        mimetype: '',\n        size: NaN,\n      } as any;\n\n      expect(() => service.validateFile(invalidFile)).not.toThrow();\n      // Should handle gracefully by checking what it can\n    });\n\n    it('should handle concurrent operations on same bucket', async () => {\n      mockedAxios.post.mockResolvedValue({\n        status: 200,\n        data: { message: 'Success' },\n      });\n\n      mockedAxios.delete.mockResolvedValue({\n        status: 200,\n        data: { message: 'Success' },\n      });\n\n      const uploadPromises = Array.from({ length: 5 }, (_, i) => {\n        const mockFile = createMockFile(`concurrent-${i}.jpg`);\n        mockedUuidv4.mockReturnValue(`uuid-${i}`);\n        return service.uploadFile(mockFile, mockBucket);\n      });\n\n      const deletePromises = Array.from({ length: 3 }, (_, i) =>\n        service.deleteFile(mockBucket, `file-to-delete-${i}.jpg`),\n      );\n\n      // Run uploads and deletes concurrently\n      const [uploadResults, deleteResults] = await Promise.all([\n        Promise.all(uploadPromises),\n        Promise.all(deletePromises),\n      ]);\n\n      expect(uploadResults).toHaveLength(5);\n      expect(deleteResults).toHaveLength(3);\n    });\n\n    it('should handle service configuration edge cases', () => {\n      // Test with various edge case configurations\n      const edgeCaseConfigs = [\n        { url: 'http://localhost', key: 'key' }, // No HTTPS\n        { url: 'https://test.com/', key: 'key' }, // Trailing slash\n        { url: '  https://test.com  ', key: '  key  ' }, // Whitespace\n      ];\n\n      edgeCaseConfigs.forEach(({ url, key }) => {\n        configService.get.mockImplementation((configKey: string) => {\n          switch (configKey) {\n            case 'SUPABASE_URL':\n              return url;\n            case 'SUPABASE_API_KEY':\n              return key;\n            default:\n              return null;\n          }\n        });\n\n        // Should initialize without error for non-empty values\n        if (url.trim() && key.trim()) {\n          expect(() => new SupabaseStorageService(configService)).not.toThrow();\n        }\n      });\n    });\n\n    it('should handle axios timeout scenarios', async () => {\n      const timeoutError = {\n        code: 'ECONNABORTED',\n        message: 'timeout of 30000ms exceeded',\n      };\n      mockedAxios.post.mockRejectedValue(timeoutError);\n\n      const mockFile = createMockFile();\n\n      await expect(service.uploadFile(mockFile, mockBucket)).rejects.toThrow(\n        'Failed to upload file to Supabase: timeout of 30000ms exceeded',\n      );\n    });\n\n    it('should handle network connectivity issues', async () => {\n      const networkError = {\n        code: 'ENOTFOUND',\n        message: 'getaddrinfo ENOTFOUND test-project.supabase.co',\n      };\n      mockedAxios.post.mockRejectedValue(networkError);\n\n      const mockFile = createMockFile();\n\n      await expect(service.uploadFile(mockFile, mockBucket)).rejects.toThrow(\n        'Failed to upload file to Supabase: getaddrinfo ENOTFOUND test-project.supabase.co',\n      );\n    });\n  });\n\n  // ===== SECURITY TESTS =====\n\n  describe('Security considerations', () => {\n    it('should prevent path traversal in filenames', () => {\n      const maliciousFilenames = [\n        '../../../etc/passwd',\n        '..\\\\..\\\\windows\\\\system32',\n        '/etc/hosts',\n        'C:\\\\Windows\\\\System32\\\\config',\n        '%2e%2e%2f%2e%2e%2f',\n      ];\n\n      maliciousFilenames.forEach((filename) => {\n        const mockFile = createMockFile(filename);\n        const validation = service.validateFile(mockFile);\n        expect(validation.isValid).toBe(false);\n        expect(validation.error).toBe('Filename contains invalid characters');\n      });\n    });\n\n    it('should sanitize filenames with dangerous characters', () => {\n      const dangerousFilenames = [\n        '<script>alert(\"xss\")</script>.jpg',\n        'file;rm -rf /.jpg',\n        'file`whoami`.jpg',\n        'file$(command).jpg',\n        'file&command&.jpg',\n      ];\n\n      dangerousFilenames.forEach((filename) => {\n        const mockFile = createMockFile(filename);\n        const validation = service.validateFile(mockFile);\n        expect(validation.isValid).toBe(false);\n        expect(validation.error).toBe('Filename contains invalid characters');\n      });\n    });\n\n    it('should reject executable file types', () => {\n      const executableMimeTypes = [\n        'application/x-executable',\n        'application/x-msdownload',\n        'application/x-msdos-program',\n        'application/x-msi',\n        'application/x-sh',\n        'application/x-bat',\n      ];\n\n      executableMimeTypes.forEach((mimetype) => {\n        const mockFile = createMockFile('malicious.exe', Buffer.from('content'), mimetype);\n        const validation = service.validateFile(mockFile);\n        expect(validation.isValid).toBe(false);\n        expect(validation.error).toContain('is not allowed');\n      });\n    });\n\n    it('should handle oversized file attacks', () => {\n      const massiveSize = Number.MAX_SAFE_INTEGER;\n      const mockFile = createMockFile('huge.jpg', Buffer.alloc(0), 'image/jpeg', massiveSize);\n\n      const validation = service.validateFile(mockFile);\n      expect(validation.isValid).toBe(false);\n      expect(validation.error).toContain('exceeds');\n    });\n\n    it('should handle authorization header correctly', async () => {\n      mockedAxios.post.mockResolvedValue({\n        status: 200,\n        data: { message: 'Success' },\n      });\n\n      const mockFile = createMockFile();\n      await service.uploadFile(mockFile, mockBucket);\n\n      expect(mockedAxios.post).toHaveBeenCalledWith(\n        expect.any(String),\n        expect.any(Buffer),\n        expect.objectContaining({\n          headers: expect.objectContaining({\n            Authorization: `Bearer ${mockSupabaseApiKey}`,\n          }),\n        }),\n      );\n\n      // Verify the API key is not logged or exposed\n      expect(loggerSpy).not.toHaveBeenCalledWith(\n        expect.stringContaining(mockSupabaseApiKey),\n      );\n    });\n  });\n});"],"version":3}