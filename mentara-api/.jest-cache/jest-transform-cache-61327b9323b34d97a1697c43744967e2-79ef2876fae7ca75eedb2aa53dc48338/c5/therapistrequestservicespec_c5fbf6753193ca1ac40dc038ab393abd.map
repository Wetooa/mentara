{"file":"/home/wetooa/Documents/code/projects/mentara/mentara-api/src/therapist/services/therapist-request.service.spec.ts","mappings":"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","names":[],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/therapist/services/therapist-request.service.spec.ts"],"sourcesContent":["import { Test, TestingModule } from '@nestjs/testing';\nimport { TherapistRequestService } from './therapist-request.service';\nimport { PrismaService } from '../../providers/prisma-client.provider';\nimport { NotificationsService } from '../../notifications/notifications.service';\nimport {\n  Logger,\n  NotFoundException,\n  ConflictException,\n  BadRequestException,\n  ForbiddenException,\n} from '@nestjs/common';\nimport {\n  TherapistRequestFiltersDto,\n  TherapistRequestResponseDto,\n  BulkTherapistActionDto,\n} from 'mentara-commons';\n\ndescribe('TherapistRequestService', () => {\n  let service: TherapistRequestService;\n  let prismaService: jest.Mocked<PrismaService>;\n  let notificationsService: jest.Mocked<NotificationsService>;\n  let logger: jest.Mocked<Logger>;\n\n  const mockClientTherapistRequest = {\n    id: 'request-123',\n    clientId: 'client-123',\n    therapistId: 'therapist-123',\n    status: 'PENDING',\n    priority: 'NORMAL',\n    requestedAt: new Date(),\n    respondedAt: null,\n    expiresAt: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000), // 7 days from now\n    therapistResponse: null,\n    client: {\n      id: 'client-123',\n      userId: 'client-user-123',\n      user: {\n        firstName: 'John',\n        lastName: 'Doe',\n        avatarUrl: 'https://example.com/avatar.jpg',\n        createdAt: new Date(),\n      },\n    },\n    therapist: {\n      id: 'therapist-123',\n      userId: 'therapist-user-123',\n      user: {\n        firstName: 'Dr. Jane',\n        lastName: 'Smith',\n      },\n    },\n    createdAt: new Date(),\n    updatedAt: new Date(),\n  };\n\n  const mockTherapist = {\n    id: 'therapist-123',\n    userId: 'therapist-user-123',\n    status: 'approved',\n    user: {\n      isActive: true,\n      firstName: 'Dr. Jane',\n      lastName: 'Smith',\n    },\n    createdAt: new Date(),\n    updatedAt: new Date(),\n  };\n\n  const mockClientTherapistRelationship = {\n    id: 'relationship-123',\n    clientId: 'client-123',\n    therapistId: 'therapist-123',\n    status: 'active',\n    assignedAt: new Date(),\n    notes: 'Relationship started from accepted request.',\n    createdAt: new Date(),\n    updatedAt: new Date(),\n  };\n\n  const mockResponseDto: TherapistRequestResponseDto = {\n    response: 'I would be happy to work with you.',\n    acceptNewClients: true,\n    preferredContactMethod: 'platform',\n    schedulingMessage: 'Please schedule your first session through the platform.',\n  };\n\n  const mockFilters: TherapistRequestFiltersDto = {\n    status: 'PENDING',\n    priority: 'NORMAL',\n    page: 1,\n    limit: 20,\n    sortBy: 'requestedAt',\n    sortOrder: 'desc',\n    includeExpired: false,\n  };\n\n  beforeEach(async () => {\n    const module: TestingModule = await Test.createTestingModule({\n      providers: [\n        TherapistRequestService,\n        {\n          provide: PrismaService,\n          useValue: {\n            clientTherapistRequest: {\n              findMany: jest.fn(),\n              findUnique: jest.fn(),\n              count: jest.fn(),\n              update: jest.fn(),\n              findFirst: jest.fn(),\n            },\n            therapist: {\n              findUnique: jest.fn(),\n            },\n            clientTherapist: {\n              findFirst: jest.fn(),\n              create: jest.fn(),\n              count: jest.fn(),\n            },\n            auditLog: {\n              create: jest.fn(),\n            },\n            $transaction: jest.fn(),\n          },\n        },\n        {\n          provide: NotificationsService,\n          useValue: {\n            create: jest.fn(),\n          },\n        },\n      ],\n    }).compile();\n\n    service = module.get<TherapistRequestService>(TherapistRequestService);\n    prismaService = module.get(PrismaService);\n    notificationsService = module.get(NotificationsService);\n    logger = service['logger'] as jest.Mocked<Logger>;\n\n    // Mock logger methods\n    jest.spyOn(logger, 'log').mockImplementation();\n    jest.spyOn(logger, 'error').mockImplementation();\n    jest.spyOn(logger, 'warn').mockImplementation();\n  });\n\n  afterEach(() => {\n    jest.clearAllMocks();\n  });\n\n  it('should be defined', () => {\n    expect(service).toBeDefined();\n  });\n\n  describe('getTherapistRequests', () => {\n    it('should retrieve therapist requests with filters and pagination', async () => {\n      const mockRequests = [mockClientTherapistRequest];\n      const mockCounts = { total: 1, pending: 1, highPriority: 0 };\n\n      prismaService.clientTherapistRequest.findMany.mockResolvedValue(mockRequests);\n      prismaService.clientTherapistRequest.count.mockResolvedValueOnce(mockCounts.total);\n      prismaService.clientTherapistRequest.count.mockResolvedValueOnce(mockCounts.pending);\n      prismaService.clientTherapistRequest.count.mockResolvedValueOnce(mockCounts.highPriority);\n\n      const result = await service.getTherapistRequests('therapist-123', mockFilters);\n\n      expect(result).toEqual({\n        requests: mockRequests,\n        pagination: {\n          page: 1,\n          limit: 20,\n          totalCount: 1,\n          totalPages: 1,\n        },\n        summary: {\n          pendingCount: 1,\n          highPriorityCount: 0,\n          filteredCount: 1,\n        },\n        filters: mockFilters,\n      });\n\n      expect(prismaService.clientTherapistRequest.findMany).toHaveBeenCalledWith({\n        where: {\n          therapistId: 'therapist-123',\n          status: 'PENDING',\n          priority: 'NORMAL',\n        },\n        skip: 0,\n        take: 20,\n        orderBy: { requestedAt: 'desc' },\n        include: {\n          client: {\n            include: {\n              user: {\n                select: {\n                  firstName: true,\n                  lastName: true,\n                  avatarUrl: true,\n                  createdAt: true,\n                },\n              },\n            },\n          },\n        },\n      });\n    });\n\n    it('should handle date range filters correctly', async () => {\n      const filtersWithDates = {\n        ...mockFilters,\n        requestedAfter: '2023-01-01',\n        requestedBefore: '2023-12-31',\n        respondedAfter: '2023-01-01',\n        respondedBefore: '2023-12-31',\n      };\n\n      prismaService.clientTherapistRequest.findMany.mockResolvedValue([]);\n      prismaService.clientTherapistRequest.count.mockResolvedValue(0);\n\n      await service.getTherapistRequests('therapist-123', filtersWithDates);\n\n      expect(prismaService.clientTherapistRequest.findMany).toHaveBeenCalledWith({\n        where: {\n          therapistId: 'therapist-123',\n          status: 'PENDING',\n          priority: 'NORMAL',\n          requestedAt: {\n            gte: new Date('2023-01-01'),\n            lte: new Date('2023-12-31'),\n          },\n          respondedAt: {\n            gte: new Date('2023-01-01'),\n            lte: new Date('2023-12-31'),\n          },\n        },\n        skip: 0,\n        take: 20,\n        orderBy: { requestedAt: 'desc' },\n        include: expect.any(Object),\n      });\n    });\n\n    it('should include expired requests when includeExpired is true', async () => {\n      const filtersWithExpired = {\n        ...mockFilters,\n        includeExpired: true,\n      };\n\n      prismaService.clientTherapistRequest.findMany.mockResolvedValue([]);\n      prismaService.clientTherapistRequest.count.mockResolvedValue(0);\n\n      await service.getTherapistRequests('therapist-123', filtersWithExpired);\n\n      expect(prismaService.clientTherapistRequest.findMany).toHaveBeenCalledWith({\n        where: {\n          therapistId: 'therapist-123',\n          status: 'PENDING',\n          priority: 'NORMAL',\n        },\n        skip: 0,\n        take: 20,\n        orderBy: { requestedAt: 'desc' },\n        include: expect.any(Object),\n      });\n    });\n\n    it('should exclude expired requests by default', async () => {\n      prismaService.clientTherapistRequest.findMany.mockResolvedValue([]);\n      prismaService.clientTherapistRequest.count.mockResolvedValue(0);\n\n      await service.getTherapistRequests('therapist-123', { ...mockFilters, includeExpired: false });\n\n      expect(prismaService.clientTherapistRequest.findMany).toHaveBeenCalledWith({\n        where: {\n          therapistId: 'therapist-123',\n          status: { not: 'EXPIRED' },\n          priority: 'NORMAL',\n        },\n        skip: 0,\n        take: 20,\n        orderBy: { requestedAt: 'desc' },\n        include: expect.any(Object),\n      });\n    });\n\n    it('should handle pagination correctly', async () => {\n      const filtersWithPagination = {\n        ...mockFilters,\n        page: 2,\n        limit: 10,\n      };\n\n      prismaService.clientTherapistRequest.findMany.mockResolvedValue([]);\n      prismaService.clientTherapistRequest.count.mockResolvedValue(0);\n\n      await service.getTherapistRequests('therapist-123', filtersWithPagination);\n\n      expect(prismaService.clientTherapistRequest.findMany).toHaveBeenCalledWith({\n        where: expect.any(Object),\n        skip: 10, // (page - 1) * limit\n        take: 10,\n        orderBy: { requestedAt: 'desc' },\n        include: expect.any(Object),\n      });\n    });\n\n    it('should handle database errors', async () => {\n      prismaService.clientTherapistRequest.findMany.mockRejectedValue(new Error('Database error'));\n\n      await expect(service.getTherapistRequests('therapist-123', mockFilters)).rejects.toThrow(\n        'Database error',\n      );\n    });\n  });\n\n  describe('acceptClientRequest', () => {\n    it('should accept client request successfully', async () => {\n      const mockTransaction = {\n        clientTherapistRequest: {\n          findUnique: jest.fn().mockResolvedValue(mockClientTherapistRequest),\n          update: jest.fn().mockResolvedValue({ ...mockClientTherapistRequest, status: 'ACCEPTED' }),\n        },\n        therapist: {\n          findUnique: jest.fn().mockResolvedValue(mockTherapist),\n        },\n        clientTherapist: {\n          findFirst: jest.fn().mockResolvedValue(null),\n          create: jest.fn().mockResolvedValue(mockClientTherapistRelationship),\n        },\n        auditLog: {\n          create: jest.fn().mockResolvedValue({}),\n        },\n      };\n\n      prismaService.$transaction.mockImplementation(async (callback) => {\n        return callback(mockTransaction);\n      });\n\n      notificationsService.create.mockResolvedValue({});\n\n      const result = await service.acceptClientRequest(\n        'request-123',\n        'therapist-123',\n        mockResponseDto,\n      );\n\n      expect(result).toEqual({\n        success: true,\n        request: { ...mockClientTherapistRequest, status: 'ACCEPTED' },\n        relationship: mockClientTherapistRelationship,\n        message: 'Client request accepted successfully',\n        nextSteps: {\n          scheduleSession: 'Contact information provided',\n          clientNotified: true,\n          relationshipEstablished: true,\n        },\n      });\n\n      expect(mockTransaction.clientTherapistRequest.update).toHaveBeenCalledWith({\n        where: { id: 'request-123' },\n        data: {\n          status: 'ACCEPTED',\n          respondedAt: expect.any(Date),\n          therapistResponse: mockResponseDto.response,\n        },\n      });\n\n      expect(mockTransaction.clientTherapist.create).toHaveBeenCalledWith({\n        data: {\n          clientId: 'client-123',\n          therapistId: 'therapist-123',\n          status: 'active',\n          assignedAt: expect.any(Date),\n          notes: expect.stringContaining('Relationship started from accepted request'),\n        },\n      });\n\n      expect(notificationsService.create).toHaveBeenCalledTimes(2);\n    });\n\n    it('should throw NotFoundException for non-existent request', async () => {\n      const mockTransaction = {\n        clientTherapistRequest: {\n          findUnique: jest.fn().mockResolvedValue(null),\n        },\n      };\n\n      prismaService.$transaction.mockImplementation(async (callback) => {\n        return callback(mockTransaction);\n      });\n\n      await expect(\n        service.acceptClientRequest('request-123', 'therapist-123', mockResponseDto),\n      ).rejects.toThrow(NotFoundException);\n    });\n\n    it('should throw ForbiddenException for request not belonging to therapist', async () => {\n      const mockTransaction = {\n        clientTherapistRequest: {\n          findUnique: jest.fn().mockResolvedValue({\n            ...mockClientTherapistRequest,\n            therapistId: 'different-therapist',\n          }),\n        },\n      };\n\n      prismaService.$transaction.mockImplementation(async (callback) => {\n        return callback(mockTransaction);\n      });\n\n      await expect(\n        service.acceptClientRequest('request-123', 'therapist-123', mockResponseDto),\n      ).rejects.toThrow(ForbiddenException);\n    });\n\n    it('should throw BadRequestException for non-pending request', async () => {\n      const mockTransaction = {\n        clientTherapistRequest: {\n          findUnique: jest.fn().mockResolvedValue({\n            ...mockClientTherapistRequest,\n            status: 'ACCEPTED',\n          }),\n        },\n      };\n\n      prismaService.$transaction.mockImplementation(async (callback) => {\n        return callback(mockTransaction);\n      });\n\n      await expect(\n        service.acceptClientRequest('request-123', 'therapist-123', mockResponseDto),\n      ).rejects.toThrow(BadRequestException);\n    });\n\n    it('should throw BadRequestException for expired request', async () => {\n      const expiredRequest = {\n        ...mockClientTherapistRequest,\n        expiresAt: new Date(Date.now() - 1000), // 1 second ago\n      };\n\n      const mockTransaction = {\n        clientTherapistRequest: {\n          findUnique: jest.fn().mockResolvedValue(expiredRequest),\n          update: jest.fn().mockResolvedValue({ ...expiredRequest, status: 'EXPIRED' }),\n        },\n      };\n\n      prismaService.$transaction.mockImplementation(async (callback) => {\n        return callback(mockTransaction);\n      });\n\n      await expect(\n        service.acceptClientRequest('request-123', 'therapist-123', mockResponseDto),\n      ).rejects.toThrow(BadRequestException);\n\n      expect(mockTransaction.clientTherapistRequest.update).toHaveBeenCalledWith({\n        where: { id: 'request-123' },\n        data: { status: 'EXPIRED', respondedAt: expect.any(Date) },\n      });\n    });\n\n    it('should throw BadRequestException for inactive therapist', async () => {\n      const inactiveTherapist = {\n        ...mockTherapist,\n        status: 'pending',\n      };\n\n      const mockTransaction = {\n        clientTherapistRequest: {\n          findUnique: jest.fn().mockResolvedValue(mockClientTherapistRequest),\n        },\n        therapist: {\n          findUnique: jest.fn().mockResolvedValue(inactiveTherapist),\n        },\n      };\n\n      prismaService.$transaction.mockImplementation(async (callback) => {\n        return callback(mockTransaction);\n      });\n\n      await expect(\n        service.acceptClientRequest('request-123', 'therapist-123', mockResponseDto),\n      ).rejects.toThrow(BadRequestException);\n    });\n\n    it('should throw ConflictException for existing active relationship', async () => {\n      const mockTransaction = {\n        clientTherapistRequest: {\n          findUnique: jest.fn().mockResolvedValue(mockClientTherapistRequest),\n        },\n        therapist: {\n          findUnique: jest.fn().mockResolvedValue(mockTherapist),\n        },\n        clientTherapist: {\n          findFirst: jest.fn().mockResolvedValue(mockClientTherapistRelationship),\n        },\n      };\n\n      prismaService.$transaction.mockImplementation(async (callback) => {\n        return callback(mockTransaction);\n      });\n\n      await expect(\n        service.acceptClientRequest('request-123', 'therapist-123', mockResponseDto),\n      ).rejects.toThrow(ConflictException);\n    });\n\n    it('should send scheduling notification when provided', async () => {\n      const mockTransaction = {\n        clientTherapistRequest: {\n          findUnique: jest.fn().mockResolvedValue(mockClientTherapistRequest),\n          update: jest.fn().mockResolvedValue({ ...mockClientTherapistRequest, status: 'ACCEPTED' }),\n        },\n        therapist: {\n          findUnique: jest.fn().mockResolvedValue(mockTherapist),\n        },\n        clientTherapist: {\n          findFirst: jest.fn().mockResolvedValue(null),\n          create: jest.fn().mockResolvedValue(mockClientTherapistRelationship),\n        },\n        auditLog: {\n          create: jest.fn().mockResolvedValue({}),\n        },\n      };\n\n      prismaService.$transaction.mockImplementation(async (callback) => {\n        return callback(mockTransaction);\n      });\n\n      notificationsService.create.mockResolvedValue({});\n\n      await service.acceptClientRequest('request-123', 'therapist-123', mockResponseDto);\n\n      expect(notificationsService.create).toHaveBeenCalledWith({\n        userId: 'client-123',\n        title: 'Scheduling Information',\n        message: mockResponseDto.schedulingMessage,\n        type: 'SCHEDULING_INFO',\n        priority: 'NORMAL',\n        actionUrl: '/client/therapists/therapist-123/schedule',\n      });\n    });\n  });\n\n  describe('declineClientRequest', () => {\n    it('should decline client request successfully', async () => {\n      const mockTransaction = {\n        clientTherapistRequest: {\n          findUnique: jest.fn().mockResolvedValue(mockClientTherapistRequest),\n          update: jest.fn().mockResolvedValue({ ...mockClientTherapistRequest, status: 'DECLINED' }),\n        },\n        auditLog: {\n          create: jest.fn().mockResolvedValue({}),\n        },\n      };\n\n      prismaService.$transaction.mockImplementation(async (callback) => {\n        return callback(mockTransaction);\n      });\n\n      notificationsService.create.mockResolvedValue({});\n\n      const result = await service.declineClientRequest(\n        'request-123',\n        'therapist-123',\n        mockResponseDto,\n      );\n\n      expect(result).toEqual({\n        success: true,\n        request: { ...mockClientTherapistRequest, status: 'DECLINED' },\n        message: 'Client request declined',\n        providedAlternatives: false,\n      });\n\n      expect(mockTransaction.clientTherapistRequest.update).toHaveBeenCalledWith({\n        where: { id: 'request-123' },\n        data: {\n          status: 'DECLINED',\n          respondedAt: expect.any(Date),\n          therapistResponse: mockResponseDto.response,\n        },\n      });\n\n      expect(notificationsService.create).toHaveBeenCalledWith({\n        userId: 'client-123',\n        title: 'Therapist Request Update',\n        message: expect.stringContaining('has responded to your therapy request'),\n        type: 'THERAPIST_REQUEST_DECLINED',\n        priority: 'NORMAL',\n        actionUrl: '/client/therapists/browse',\n        data: {\n          requestId: 'request-123',\n          therapistId: 'therapist-123',\n          response: mockResponseDto.response,\n        },\n      });\n    });\n\n    it('should send alternative recommendations when therapist not accepting new clients', async () => {\n      const responseDto = {\n        ...mockResponseDto,\n        acceptNewClients: false,\n      };\n\n      const mockTransaction = {\n        clientTherapistRequest: {\n          findUnique: jest.fn().mockResolvedValue(mockClientTherapistRequest),\n          update: jest.fn().mockResolvedValue({ ...mockClientTherapistRequest, status: 'DECLINED' }),\n        },\n        auditLog: {\n          create: jest.fn().mockResolvedValue({}),\n        },\n      };\n\n      prismaService.$transaction.mockImplementation(async (callback) => {\n        return callback(mockTransaction);\n      });\n\n      notificationsService.create.mockResolvedValue({});\n\n      const result = await service.declineClientRequest('request-123', 'therapist-123', responseDto);\n\n      expect(result.providedAlternatives).toBe(true);\n      expect(notificationsService.create).toHaveBeenCalledWith({\n        userId: 'client-123',\n        title: 'Alternative Therapist Recommendations',\n        message: 'We can help you find other qualified therapists who may be a good fit.',\n        type: 'ALTERNATIVE_RECOMMENDATIONS',\n        priority: 'NORMAL',\n        actionUrl: '/client/therapists/recommendations',\n      });\n    });\n\n    it('should throw NotFoundException for non-existent request', async () => {\n      const mockTransaction = {\n        clientTherapistRequest: {\n          findUnique: jest.fn().mockResolvedValue(null),\n        },\n      };\n\n      prismaService.$transaction.mockImplementation(async (callback) => {\n        return callback(mockTransaction);\n      });\n\n      await expect(\n        service.declineClientRequest('request-123', 'therapist-123', mockResponseDto),\n      ).rejects.toThrow(NotFoundException);\n    });\n\n    it('should throw ForbiddenException for request not belonging to therapist', async () => {\n      const mockTransaction = {\n        clientTherapistRequest: {\n          findUnique: jest.fn().mockResolvedValue({\n            ...mockClientTherapistRequest,\n            therapistId: 'different-therapist',\n          }),\n        },\n      };\n\n      prismaService.$transaction.mockImplementation(async (callback) => {\n        return callback(mockTransaction);\n      });\n\n      await expect(\n        service.declineClientRequest('request-123', 'therapist-123', mockResponseDto),\n      ).rejects.toThrow(ForbiddenException);\n    });\n\n    it('should throw BadRequestException for non-pending request', async () => {\n      const mockTransaction = {\n        clientTherapistRequest: {\n          findUnique: jest.fn().mockResolvedValue({\n            ...mockClientTherapistRequest,\n            status: 'ACCEPTED',\n          }),\n        },\n      };\n\n      prismaService.$transaction.mockImplementation(async (callback) => {\n        return callback(mockTransaction);\n      });\n\n      await expect(\n        service.declineClientRequest('request-123', 'therapist-123', mockResponseDto),\n      ).rejects.toThrow(BadRequestException);\n    });\n  });\n\n  describe('performBulkAction', () => {\n    const mockBulkActionDto: BulkTherapistActionDto = {\n      requestIds: ['request-1', 'request-2'],\n      action: 'accept',\n      response: 'I am happy to work with you all.',\n    };\n\n    it('should perform bulk accept action successfully', async () => {\n      jest.spyOn(service, 'acceptClientRequest').mockResolvedValue({\n        success: true,\n        request: mockClientTherapistRequest,\n        relationship: mockClientTherapistRelationship,\n        message: 'Request accepted',\n        nextSteps: { scheduleSession: 'Schedule first session', clientNotified: true, relationshipEstablished: true },\n      });\n\n      const result = await service.performBulkAction('therapist-123', mockBulkActionDto);\n\n      expect(result).toEqual({\n        success: true,\n        results: {\n          successful: [\n            { requestId: 'request-1', action: 'accept', status: 'completed' },\n            { requestId: 'request-2', action: 'accept', status: 'completed' },\n          ],\n          failed: [],\n          totalProcessed: 2,\n        },\n        summary: {\n          totalRequested: 2,\n          totalProcessed: 2,\n          totalFailed: 0,\n          action: 'accept',\n        },\n      });\n\n      expect(service.acceptClientRequest).toHaveBeenCalledTimes(2);\n    });\n\n    it('should perform bulk decline action successfully', async () => {\n      const declineDto = {\n        ...mockBulkActionDto,\n        action: 'decline' as const,\n      };\n\n      jest.spyOn(service, 'declineClientRequest').mockResolvedValue({\n        success: true,\n        request: mockClientTherapistRequest,\n        message: 'Request declined',\n        providedAlternatives: false,\n      });\n\n      const result = await service.performBulkAction('therapist-123', declineDto);\n\n      expect(result.results.successful).toHaveLength(2);\n      expect(result.results.failed).toHaveLength(0);\n      expect(service.declineClientRequest).toHaveBeenCalledTimes(2);\n    });\n\n    it('should perform bulk mark_reviewed action successfully', async () => {\n      const markReviewedDto = {\n        ...mockBulkActionDto,\n        action: 'mark_reviewed' as const,\n      };\n\n      jest.spyOn(service as any, 'markRequestAsReviewed').mockResolvedValue({\n        success: true,\n        requestId: 'request-1',\n        message: 'Request marked as reviewed',\n      });\n\n      const result = await service.performBulkAction('therapist-123', markReviewedDto);\n\n      expect(result.results.successful).toHaveLength(2);\n      expect(result.results.failed).toHaveLength(0);\n      expect(service['markRequestAsReviewed']).toHaveBeenCalledTimes(2);\n    });\n\n    it('should handle partial failures in bulk actions', async () => {\n      jest.spyOn(service, 'acceptClientRequest')\n        .mockResolvedValueOnce({\n          success: true,\n          request: mockClientTherapistRequest,\n          relationship: mockClientTherapistRelationship,\n          message: 'Request accepted',\n          nextSteps: { scheduleSession: 'Schedule first session', clientNotified: true, relationshipEstablished: true },\n        })\n        .mockRejectedValueOnce(new Error('Request not found'));\n\n      const result = await service.performBulkAction('therapist-123', mockBulkActionDto);\n\n      expect(result.results.successful).toHaveLength(1);\n      expect(result.results.failed).toHaveLength(1);\n      expect(result.results.failed[0]).toEqual({\n        requestId: 'request-2',\n        action: 'accept',\n        error: 'Request not found',\n      });\n    });\n\n    it('should throw BadRequestException for invalid action', async () => {\n      const invalidActionDto = {\n        ...mockBulkActionDto,\n        action: 'invalid_action' as any,\n      };\n\n      const result = await service.performBulkAction('therapist-123', invalidActionDto);\n\n      expect(result.results.successful).toHaveLength(0);\n      expect(result.results.failed).toHaveLength(2);\n      expect(result.results.failed[0].error).toBe('Invalid action: invalid_action');\n    });\n\n    it('should throw BadRequestException for missing response in accept action', async () => {\n      const actionWithoutResponse = {\n        ...mockBulkActionDto,\n        response: undefined,\n      };\n\n      const result = await service.performBulkAction('therapist-123', actionWithoutResponse);\n\n      expect(result.results.successful).toHaveLength(0);\n      expect(result.results.failed).toHaveLength(2);\n      expect(result.results.failed[0].error).toBe('Response message required for accept action');\n    });\n  });\n\n  describe('getTherapistRequestStatistics', () => {\n    it('should calculate statistics correctly', async () => {\n      const mockRecentRequests = [\n        {\n          requestedAt: new Date('2023-01-01T10:00:00Z'),\n          respondedAt: new Date('2023-01-01T12:00:00Z'),\n        },\n        {\n          requestedAt: new Date('2023-01-02T10:00:00Z'),\n          respondedAt: new Date('2023-01-02T14:00:00Z'),\n        },\n      ];\n\n      const mockLastRequest = { requestedAt: new Date('2023-01-03T10:00:00Z') };\n      const mockLastResponse = { respondedAt: new Date('2023-01-03T14:00:00Z') };\n\n      prismaService.clientTherapistRequest.count\n        .mockResolvedValueOnce(10) // totalReceived\n        .mockResolvedValueOnce(3) // pending\n        .mockResolvedValueOnce(5) // accepted\n        .mockResolvedValueOnce(2) // declined\n        .mockResolvedValueOnce(0); // expired\n\n      prismaService.clientTherapistRequest.findMany\n        .mockResolvedValueOnce(mockRecentRequests)\n        .mockResolvedValueOnce([mockLastRequest])\n        .mockResolvedValueOnce([mockLastResponse]);\n\n      prismaService.clientTherapist.count.mockResolvedValue(4); // activeRelationships\n\n      const result = await service.getTherapistRequestStatistics('therapist-123');\n\n      expect(result).toEqual({\n        totalReceived: 10,\n        pending: 3,\n        accepted: 5,\n        declined: 2,\n        expired: 0,\n        activeRelationships: 4,\n        acceptanceRate: 71.43, // 5 / (5 + 2) * 100\n        averageResponseTime: 3, // Average of 2 hours and 4 hours\n        lastRequestAt: mockLastRequest.requestedAt,\n        lastResponseAt: mockLastResponse.respondedAt,\n      });\n    });\n\n    it('should handle empty statistics', async () => {\n      prismaService.clientTherapistRequest.count.mockResolvedValue(0);\n      prismaService.clientTherapistRequest.findMany.mockResolvedValue([]);\n      prismaService.clientTherapist.count.mockResolvedValue(0);\n\n      const result = await service.getTherapistRequestStatistics('therapist-123');\n\n      expect(result).toEqual({\n        totalReceived: 0,\n        pending: 0,\n        accepted: 0,\n        declined: 0,\n        expired: 0,\n        activeRelationships: 0,\n        acceptanceRate: 0,\n        averageResponseTime: 0,\n        lastRequestAt: null,\n        lastResponseAt: null,\n      });\n    });\n\n    it('should handle database errors', async () => {\n      prismaService.clientTherapistRequest.count.mockRejectedValue(new Error('Database error'));\n\n      await expect(service.getTherapistRequestStatistics('therapist-123')).rejects.toThrow(\n        'Database error',\n      );\n    });\n  });\n\n  describe('markRequestAsReviewed', () => {\n    it('should mark request as reviewed successfully', async () => {\n      prismaService.clientTherapistRequest.findUnique.mockResolvedValue(mockClientTherapistRequest);\n      prismaService.auditLog.create.mockResolvedValue({});\n\n      const result = await service['markRequestAsReviewed']('request-123', 'therapist-123');\n\n      expect(result).toEqual({\n        success: true,\n        requestId: 'request-123',\n        message: 'Request marked as reviewed',\n      });\n\n      expect(prismaService.auditLog.create).toHaveBeenCalledWith({\n        data: {\n          userId: 'therapist-123',\n          action: 'REVIEW_CLIENT_REQUEST',\n          entity: 'client_therapist_request',\n          entityId: 'request-123',\n          metadata: {\n            requestId: 'request-123',\n            reviewedAt: expect.any(String),\n          },\n        },\n      });\n    });\n\n    it('should throw NotFoundException for non-existent request', async () => {\n      prismaService.clientTherapistRequest.findUnique.mockResolvedValue(null);\n\n      await expect(\n        service['markRequestAsReviewed']('request-123', 'therapist-123'),\n      ).rejects.toThrow(NotFoundException);\n    });\n\n    it('should throw NotFoundException for request not belonging to therapist', async () => {\n      prismaService.clientTherapistRequest.findUnique.mockResolvedValue({\n        ...mockClientTherapistRequest,\n        therapistId: 'different-therapist',\n      });\n\n      await expect(\n        service['markRequestAsReviewed']('request-123', 'therapist-123'),\n      ).rejects.toThrow(NotFoundException);\n    });\n  });\n\n  describe('integration tests', () => {\n    it('should handle complete request acceptance workflow', async () => {\n      // Mock all transaction operations\n      const mockTransaction = {\n        clientTherapistRequest: {\n          findUnique: jest.fn().mockResolvedValue(mockClientTherapistRequest),\n          update: jest.fn().mockResolvedValue({ ...mockClientTherapistRequest, status: 'ACCEPTED' }),\n        },\n        therapist: {\n          findUnique: jest.fn().mockResolvedValue(mockTherapist),\n        },\n        clientTherapist: {\n          findFirst: jest.fn().mockResolvedValue(null),\n          create: jest.fn().mockResolvedValue(mockClientTherapistRelationship),\n        },\n        auditLog: {\n          create: jest.fn().mockResolvedValue({}),\n        },\n      };\n\n      prismaService.$transaction.mockImplementation(async (callback) => {\n        return callback(mockTransaction);\n      });\n\n      notificationsService.create.mockResolvedValue({});\n\n      const result = await service.acceptClientRequest(\n        'request-123',\n        'therapist-123',\n        mockResponseDto,\n      );\n\n      // Verify all transaction operations were called\n      expect(mockTransaction.clientTherapistRequest.findUnique).toHaveBeenCalled();\n      expect(mockTransaction.therapist.findUnique).toHaveBeenCalled();\n      expect(mockTransaction.clientTherapist.findFirst).toHaveBeenCalled();\n      expect(mockTransaction.clientTherapist.create).toHaveBeenCalled();\n      expect(mockTransaction.auditLog.create).toHaveBeenCalled();\n\n      // Verify notifications were sent\n      expect(notificationsService.create).toHaveBeenCalledTimes(2);\n\n      // Verify result structure\n      expect(result.success).toBe(true);\n      expect(result.request).toBeDefined();\n      expect(result.relationship).toBeDefined();\n      expect(result.nextSteps).toBeDefined();\n    });\n\n    it('should handle complex filtering scenarios', async () => {\n      const complexFilters = {\n        status: 'PENDING',\n        priority: 'HIGH',\n        clientId: 'client-123',\n        requestedAfter: '2023-01-01',\n        requestedBefore: '2023-12-31',\n        page: 2,\n        limit: 5,\n        sortBy: 'priority',\n        sortOrder: 'asc',\n        includeExpired: true,\n      };\n\n      prismaService.clientTherapistRequest.findMany.mockResolvedValue([]);\n      prismaService.clientTherapistRequest.count.mockResolvedValue(0);\n\n      const result = await service.getTherapistRequests('therapist-123', complexFilters);\n\n      expect(result.filters).toEqual(complexFilters);\n      expect(result.pagination.page).toBe(2);\n      expect(result.pagination.limit).toBe(5);\n    });\n  });\n});"],"version":3}