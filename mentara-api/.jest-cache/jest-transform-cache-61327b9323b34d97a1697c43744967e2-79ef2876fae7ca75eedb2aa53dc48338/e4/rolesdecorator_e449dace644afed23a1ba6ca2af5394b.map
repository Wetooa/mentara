{"file":"/home/wetooa/Documents/code/projects/mentara/mentara-api/src/auth/decorators/roles.decorator.ts","mappings":"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","names":[],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/auth/decorators/roles.decorator.ts"],"sourcesContent":["import { SetMetadata } from '@nestjs/common';\n\n// Role-based decorators\nexport const ROLES_KEY = 'roles';\nexport const Roles = (...roles: string[]) => SetMetadata(ROLES_KEY, roles);\n\n// Specific role decorators for convenience\nexport const AdminOnly = () => SetMetadata(ROLES_KEY, ['admin']);\nexport const ModeratorOrAdmin = () =>\n  SetMetadata(ROLES_KEY, ['moderator', 'admin']);\nexport const TherapistOrAdmin = () =>\n  SetMetadata(ROLES_KEY, ['therapist', 'admin']);\nexport const ClientOnly = () => SetMetadata(ROLES_KEY, ['client']);\n\n// Permission-based decorators\nexport const PERMISSIONS_KEY = 'permissions';\nexport const RequirePermissions = (...permissions: string[]) =>\n  SetMetadata(PERMISSIONS_KEY, permissions);\n\n// Resource ownership decorator\nexport const RESOURCE_OWNER_KEY = 'resource_owner';\nexport const AllowResourceOwner = (paramName: string = 'id') =>\n  SetMetadata(RESOURCE_OWNER_KEY, paramName);\n\n// Combined decorators for common scenarios\nexport const AdminOrResourceOwner =\n  (paramName: string = 'id') =>\n  (target: any, propertyKey: string, descriptor: PropertyDescriptor) => {\n    SetMetadata(ROLES_KEY, ['admin'])(target, propertyKey, descriptor);\n    SetMetadata(RESOURCE_OWNER_KEY, paramName)(target, propertyKey, descriptor);\n  };\n\nexport const TherapistOrResourceOwner =\n  (paramName: string = 'id') =>\n  (target: any, propertyKey: string, descriptor: PropertyDescriptor) => {\n    SetMetadata(ROLES_KEY, ['therapist', 'admin'])(\n      target,\n      propertyKey,\n      descriptor,\n    );\n    SetMetadata(RESOURCE_OWNER_KEY, paramName)(target, propertyKey, descriptor);\n  };\n\n// Therapy session access (therapist assigned to client or admin)\nexport const TherapySessionAccess = () =>\n  RequirePermissions('sessions:read:own', 'sessions:read:all');\n\n// Assessment access (client's own assessments, assigned therapist, or admin)\nexport const AssessmentAccess = () =>\n  RequirePermissions(\n    'assessments:read:own',\n    'assessments:read:assigned',\n    'assessments:read:all',\n  );\n\n// Moderation access (moderators and admins)\nexport const ModerationAccess = () =>\n  RequirePermissions(\n    'posts:moderate',\n    'communities:moderate',\n    'messages:moderate',\n  );\n"],"version":3}