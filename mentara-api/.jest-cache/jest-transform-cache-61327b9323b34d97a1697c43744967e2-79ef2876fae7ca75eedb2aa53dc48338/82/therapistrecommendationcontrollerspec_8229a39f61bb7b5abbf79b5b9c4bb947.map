{"file":"/home/wetooa/Documents/code/projects/mentara/mentara-api/src/therapist/therapist-recommendation.controller.spec.ts","mappings":"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","names":[],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/therapist/therapist-recommendation.controller.spec.ts"],"sourcesContent":["/**\n * Comprehensive Test Suite for TherapistRecommendationController\n * Tests all therapist recommendation endpoints with security, validation, and error handling\n */\n\nimport { Test, TestingModule } from '@nestjs/testing';\nimport { NotFoundException, InternalServerErrorException } from '@nestjs/common';\nimport { JwtAuthGuard } from '../auth/guards/jwt-auth.guard';\nimport { TherapistRecommendationController } from './therapist-recommendation.controller';\nimport { TherapistRecommendationService } from './therapist-recommendation.service';\nimport { PrismaService } from '../providers/prisma-client.provider';\nimport { SecurityGuardTestUtils, RoleBasedTestUtils } from '../test-utils/auth-testing-helpers';\nimport { MockBuilder, TestDataGenerator, TestAssertions } from '../test-utils/enhanced-test-helpers';\nimport { TEST_USER_IDS, TEST_EMAILS, createMockPrismaService } from '../test-utils/index';\n\ndescribe('TherapistRecommendationController', () => {\n  let controller: TherapistRecommendationController;\n  let therapistRecommendationService: TherapistRecommendationService;\n  let prismaService: PrismaService;\n  let module: TestingModule;\n\n  // Mock TherapistRecommendationService\n  const mockTherapistRecommendationService = {\n    getRecommendedTherapists: jest.fn(),\n    getCompatibilityAnalysis: jest.fn(),\n  };\n\n  // Mock PrismaService\n  const mockPrismaService = createMockPrismaService();\n\n  // Mock JwtAuthGuard\n  const mockJwtAuthGuard = {\n    canActivate: jest.fn().mockReturnValue(true),\n  };\n\n  // Test data\n  const mockUser = TestDataGenerator.createUser({\n    id: TEST_USER_IDS.CLIENT,\n    email: TEST_EMAILS.CLIENT,\n    firstName: 'John',\n    lastName: 'Doe',\n    role: 'client',\n  });\n\n  const mockClient = {\n    userId: TEST_USER_IDS.CLIENT,\n    hasSeenTherapistRecommendations: false,\n    createdAt: new Date(),\n  };\n\n  const mockTherapistRecommendation = {\n    id: TEST_USER_IDS.THERAPIST,\n    firstName: 'Dr. Jane',\n    lastName: 'Smith',\n    bio: 'Experienced therapist specializing in anxiety and depression',\n    providerType: 'Licensed Clinical Psychologist',\n    areasOfExpertise: ['anxiety', 'depression'],\n    therapeuticApproaches: ['CBT', 'DBT'],\n    hourlyRate: 150.0,\n    rating: 4.8,\n    reviewCount: 25,\n    isActive: true,\n    matchScore: 0.87,\n    compatibilityFactors: ['anxiety_specialization', 'cbt_approach'],\n  };\n\n  const mockRecommendationResponse = {\n    recommendations: [mockTherapistRecommendation],\n    totalCount: 1,\n    page: 1,\n    limit: 10,\n    hasMore: false,\n    matchingCriteria: {\n      userPreferences: ['anxiety', 'depression'],\n      locationBased: true,\n      ratingFilter: 4.0,\n    },\n    algorithmVersion: '2.1.0',\n  };\n\n  const mockCompatibilityAnalysis = {\n    userId: TEST_USER_IDS.CLIENT,\n    therapistId: TEST_USER_IDS.THERAPIST,\n    overallCompatibility: 0.87,\n    compatibilityFactors: [\n      {\n        factor: 'anxiety_specialization',\n        score: 0.95,\n        importance: 'high',\n        explanation: 'Therapist specializes in anxiety treatment',\n      },\n      {\n        factor: 'cbt_approach',\n        score: 0.82,\n        importance: 'medium',\n        explanation: 'CBT approach matches user preferences',\n      },\n    ],\n    recommendations: [\n      'This therapist is highly compatible with your anxiety treatment needs',\n      'Consider scheduling an initial consultation',\n    ],\n    riskFactors: [],\n    lastUpdated: new Date(),\n  };\n\n  beforeEach(async () => {\n    module = await Test.createTestingModule({\n      controllers: [TherapistRecommendationController],\n      providers: [\n        {\n          provide: TherapistRecommendationService,\n          useValue: mockTherapistRecommendationService,\n        },\n        {\n          provide: PrismaService,\n          useValue: mockPrismaService,\n        },\n      ],\n    })\n      .overrideGuard(JwtAuthGuard)\n      .useValue(mockJwtAuthGuard)\n      .compile();\n\n    controller = module.get<TherapistRecommendationController>(TherapistRecommendationController);\n    therapistRecommendationService = module.get<TherapistRecommendationService>(TherapistRecommendationService);\n    prismaService = module.get<PrismaService>(PrismaService);\n  });\n\n  afterEach(() => {\n    jest.clearAllMocks();\n  });\n\n  describe('Controller Initialization', () => {\n    it('should be defined', () => {\n      expect(controller).toBeDefined();\n    });\n\n    it('should have therapistRecommendationService injected', () => {\n      expect(therapistRecommendationService).toBeDefined();\n    });\n\n    it('should have prismaService injected', () => {\n      expect(prismaService).toBeDefined();\n    });\n  });\n\n  describe('Security Guards', () => {\n    it('should be protected by JwtAuthGuard', () => {\n      const guards = Reflect.getMetadata('__guards__', TherapistRecommendationController);\n      expect(guards).toContain(JwtAuthGuard);\n    });\n\n    it('should have proper route decorators', () => {\n      const controllerMetadata = Reflect.getMetadata('path', TherapistRecommendationController);\n      expect(controllerMetadata).toBe('therapist-recommendations');\n    });\n  });\n\n  describe('GET /therapist-recommendations', () => {\n    const query = {\n      limit: 10,\n      includeInactive: false,\n      province: 'Ontario',\n      maxHourlyRate: 200,\n    };\n\n    it('should get recommended therapists successfully', async () => {\n      mockPrismaService.user.findUnique.mockResolvedValue(mockUser);\n      mockTherapistRecommendationService.getRecommendedTherapists.mockResolvedValue(mockRecommendationResponse);\n\n      const result = await controller.getRecommendedTherapists(TEST_USER_IDS.CLIENT, query);\n\n      expect(result).toEqual(mockRecommendationResponse);\n      expect(prismaService.user.findUnique).toHaveBeenCalledWith({\n        where: { id: TEST_USER_IDS.CLIENT },\n      });\n      expect(therapistRecommendationService.getRecommendedTherapists).toHaveBeenCalledWith({\n        userId: TEST_USER_IDS.CLIENT,\n        limit: 10,\n        includeInactive: false,\n        province: 'Ontario',\n        maxHourlyRate: 200,\n      });\n    });\n\n    it('should handle user not found error', async () => {\n      mockPrismaService.user.findUnique.mockResolvedValue(null);\n\n      await TestAssertions.expectToThrowNestException(\n        () => controller.getRecommendedTherapists(TEST_USER_IDS.CLIENT, query),\n        NotFoundException,\n        `User with ID ${TEST_USER_IDS.CLIENT} not found`,\n      );\n    });\n\n    it('should handle service errors', async () => {\n      mockPrismaService.user.findUnique.mockResolvedValue(mockUser);\n      const serviceError = new Error('Recommendation service failed');\n      mockTherapistRecommendationService.getRecommendedTherapists.mockRejectedValue(serviceError);\n\n      await TestAssertions.expectToThrowNestException(\n        () => controller.getRecommendedTherapists(TEST_USER_IDS.CLIENT, query),\n        InternalServerErrorException,\n        'Recommendation service failed',\n      );\n    });\n\n    it('should handle undefined query parameters', async () => {\n      const emptyQuery = {};\n      mockPrismaService.user.findUnique.mockResolvedValue(mockUser);\n      mockTherapistRecommendationService.getRecommendedTherapists.mockResolvedValue(mockRecommendationResponse);\n\n      const result = await controller.getRecommendedTherapists(TEST_USER_IDS.CLIENT, emptyQuery);\n\n      expect(result).toEqual(mockRecommendationResponse);\n      expect(therapistRecommendationService.getRecommendedTherapists).toHaveBeenCalledWith({\n        userId: TEST_USER_IDS.CLIENT,\n        limit: undefined,\n        includeInactive: undefined,\n        province: undefined,\n        maxHourlyRate: undefined,\n      });\n    });\n\n    it('should handle database connection errors', async () => {\n      const dbError = new Error('Database connection failed');\n      mockPrismaService.user.findUnique.mockRejectedValue(dbError);\n\n      await TestAssertions.expectToThrowNestException(\n        () => controller.getRecommendedTherapists(TEST_USER_IDS.CLIENT, query),\n        InternalServerErrorException,\n        'Database connection failed',\n      );\n    });\n  });\n\n  describe('GET /therapist-recommendations/compatibility/:therapistId', () => {\n    const therapistId = TEST_USER_IDS.THERAPIST;\n\n    it('should get compatibility analysis successfully', async () => {\n      mockPrismaService.user.findUnique.mockResolvedValue(mockUser);\n      mockTherapistRecommendationService.getCompatibilityAnalysis.mockResolvedValue(mockCompatibilityAnalysis);\n\n      const result = await controller.getCompatibilityAnalysis(TEST_USER_IDS.CLIENT, therapistId);\n\n      expect(result).toEqual(mockCompatibilityAnalysis);\n      expect(prismaService.user.findUnique).toHaveBeenCalledWith({\n        where: { id: TEST_USER_IDS.CLIENT },\n      });\n      expect(therapistRecommendationService.getCompatibilityAnalysis).toHaveBeenCalledWith(\n        TEST_USER_IDS.CLIENT,\n        therapistId,\n      );\n    });\n\n    it('should handle user not found error', async () => {\n      mockPrismaService.user.findUnique.mockResolvedValue(null);\n\n      await TestAssertions.expectToThrowNestException(\n        () => controller.getCompatibilityAnalysis(TEST_USER_IDS.CLIENT, therapistId),\n        NotFoundException,\n        `User with ID ${TEST_USER_IDS.CLIENT} not found`,\n      );\n    });\n\n    it('should handle service errors', async () => {\n      mockPrismaService.user.findUnique.mockResolvedValue(mockUser);\n      const serviceError = new Error('Compatibility analysis failed');\n      mockTherapistRecommendationService.getCompatibilityAnalysis.mockRejectedValue(serviceError);\n\n      await TestAssertions.expectToThrowNestException(\n        () => controller.getCompatibilityAnalysis(TEST_USER_IDS.CLIENT, therapistId),\n        InternalServerErrorException,\n        'Compatibility analysis failed',\n      );\n    });\n\n    it('should handle therapist not found in service', async () => {\n      mockPrismaService.user.findUnique.mockResolvedValue(mockUser);\n      const notFoundError = new NotFoundException('Therapist not found');\n      mockTherapistRecommendationService.getCompatibilityAnalysis.mockRejectedValue(notFoundError);\n\n      await TestAssertions.expectToThrowNestException(\n        () => controller.getCompatibilityAnalysis(TEST_USER_IDS.CLIENT, therapistId),\n        NotFoundException,\n        'Therapist not found',\n      );\n    });\n\n    it('should handle invalid therapist ID', async () => {\n      const invalidTherapistId = 'invalid-id';\n      mockPrismaService.user.findUnique.mockResolvedValue(mockUser);\n      const serviceError = new Error('Invalid therapist ID');\n      mockTherapistRecommendationService.getCompatibilityAnalysis.mockRejectedValue(serviceError);\n\n      await TestAssertions.expectToThrowNestException(\n        () => controller.getCompatibilityAnalysis(TEST_USER_IDS.CLIENT, invalidTherapistId),\n        InternalServerErrorException,\n        'Invalid therapist ID',\n      );\n    });\n  });\n\n  describe('GET /therapist-recommendations/welcome', () => {\n    const welcomeQuery = {\n      limit: 5,\n      province: 'Ontario',\n      forceRefresh: false,\n    };\n\n    it('should get welcome recommendations for first-time user', async () => {\n      mockPrismaService.user.findUnique.mockResolvedValue(mockUser);\n      mockPrismaService.client.findUnique.mockResolvedValue(mockClient);\n      mockTherapistRecommendationService.getRecommendedTherapists.mockResolvedValue(mockRecommendationResponse);\n\n      const result = await controller.getWelcomeRecommendations(TEST_USER_IDS.CLIENT, welcomeQuery);\n\n      expect(result).toHaveProperty('recommendations');\n      expect(result).toHaveProperty('welcomeMessage');\n      expect(result).toHaveProperty('isFirstTime', true);\n      expect(result).toHaveProperty('userInfo');\n      expect(result).toHaveProperty('nextSteps');\n      expect(result).toHaveProperty('matchingInsights');\n      expect(result.welcomeMessage).toContain('Welcome to Mentara, John!');\n      expect(result.nextSteps.canSendRequests).toBe(true);\n      expect(result.nextSteps.recommendedActions).toHaveLength(4);\n    });\n\n    it('should redirect returning user to regular recommendations', async () => {\n      const returningClient = { ...mockClient, hasSeenTherapistRecommendations: true };\n      mockPrismaService.user.findUnique.mockResolvedValue(mockUser);\n      mockPrismaService.client.findUnique.mockResolvedValue(returningClient);\n\n      const result = await controller.getWelcomeRecommendations(TEST_USER_IDS.CLIENT, welcomeQuery);\n\n      expect(result).toEqual({\n        isFirstTime: false,\n        redirectTo: '/therapist-recommendations',\n        message: 'User has already completed welcome flow',\n        lastSeenAt: returningClient.createdAt,\n      });\n    });\n\n    it('should handle force refresh for returning user', async () => {\n      const returningClient = { ...mockClient, hasSeenTherapistRecommendations: true };\n      const forceRefreshQuery = { ...welcomeQuery, forceRefresh: true };\n      mockPrismaService.user.findUnique.mockResolvedValue(mockUser);\n      mockPrismaService.client.findUnique.mockResolvedValue(returningClient);\n      mockTherapistRecommendationService.getRecommendedTherapists.mockResolvedValue(mockRecommendationResponse);\n\n      const result = await controller.getWelcomeRecommendations(TEST_USER_IDS.CLIENT, forceRefreshQuery);\n\n      expect(result).toHaveProperty('recommendations');\n      expect(result).toHaveProperty('welcomeMessage');\n      expect(result).toHaveProperty('isFirstTime', false);\n      expect(result.welcomeMessage).toContain('Welcome back, John!');\n    });\n\n    it('should handle user not found error', async () => {\n      mockPrismaService.user.findUnique.mockResolvedValue(null);\n      mockPrismaService.client.findUnique.mockResolvedValue(mockClient);\n\n      await TestAssertions.expectToThrowNestException(\n        () => controller.getWelcomeRecommendations(TEST_USER_IDS.CLIENT, welcomeQuery),\n        NotFoundException,\n        `User with ID ${TEST_USER_IDS.CLIENT} not found`,\n      );\n    });\n\n    it('should handle client profile not found error', async () => {\n      mockPrismaService.user.findUnique.mockResolvedValue(mockUser);\n      mockPrismaService.client.findUnique.mockResolvedValue(null);\n\n      await TestAssertions.expectToThrowNestException(\n        () => controller.getWelcomeRecommendations(TEST_USER_IDS.CLIENT, welcomeQuery),\n        NotFoundException,\n        `Client profile not found for user ${TEST_USER_IDS.CLIENT}`,\n      );\n    });\n\n    it('should handle service errors', async () => {\n      mockPrismaService.user.findUnique.mockResolvedValue(mockUser);\n      mockPrismaService.client.findUnique.mockResolvedValue(mockClient);\n      const serviceError = new Error('Recommendation service failed');\n      mockTherapistRecommendationService.getRecommendedTherapists.mockRejectedValue(serviceError);\n\n      await TestAssertions.expectToThrowNestException(\n        () => controller.getWelcomeRecommendations(TEST_USER_IDS.CLIENT, welcomeQuery),\n        InternalServerErrorException,\n        'Recommendation service failed',\n      );\n    });\n\n    it('should handle database query errors', async () => {\n      const dbError = new Error('Database query failed');\n      mockPrismaService.user.findUnique.mockRejectedValue(dbError);\n\n      await TestAssertions.expectToThrowNestException(\n        () => controller.getWelcomeRecommendations(TEST_USER_IDS.CLIENT, welcomeQuery),\n        InternalServerErrorException,\n        'Database query failed',\n      );\n    });\n  });\n\n  describe('Integration Testing', () => {\n    it('should handle complete recommendation workflow', async () => {\n      // Step 1: Get regular recommendations\n      mockPrismaService.user.findUnique.mockResolvedValue(mockUser);\n      mockTherapistRecommendationService.getRecommendedTherapists.mockResolvedValue(mockRecommendationResponse);\n      \n      const recommendations = await controller.getRecommendedTherapists(TEST_USER_IDS.CLIENT, {\n        limit: 10,\n        includeInactive: false,\n      });\n      expect(recommendations).toEqual(mockRecommendationResponse);\n\n      // Step 2: Get compatibility analysis for a specific therapist\n      mockTherapistRecommendationService.getCompatibilityAnalysis.mockResolvedValue(mockCompatibilityAnalysis);\n      \n      const compatibility = await controller.getCompatibilityAnalysis(\n        TEST_USER_IDS.CLIENT,\n        TEST_USER_IDS.THERAPIST,\n      );\n      expect(compatibility).toEqual(mockCompatibilityAnalysis);\n\n      // Step 3: Get welcome recommendations\n      mockPrismaService.client.findUnique.mockResolvedValue(mockClient);\n      \n      const welcome = await controller.getWelcomeRecommendations(TEST_USER_IDS.CLIENT, {\n        limit: 5,\n        forceRefresh: false,\n      });\n      expect(welcome).toHaveProperty('welcomeMessage');\n      expect(welcome).toHaveProperty('isFirstTime', true);\n    });\n\n    it('should handle user journey from welcome to regular recommendations', async () => {\n      // Step 1: First-time user gets welcome recommendations\n      mockPrismaService.user.findUnique.mockResolvedValue(mockUser);\n      mockPrismaService.client.findUnique.mockResolvedValue(mockClient);\n      mockTherapistRecommendationService.getRecommendedTherapists.mockResolvedValue(mockRecommendationResponse);\n      \n      const welcome = await controller.getWelcomeRecommendations(TEST_USER_IDS.CLIENT, {\n        limit: 5,\n        forceRefresh: false,\n      });\n      expect(welcome.isFirstTime).toBe(true);\n\n      // Step 2: Later, user gets regular recommendations\n      const returningClient = { ...mockClient, hasSeenTherapistRecommendations: true };\n      mockPrismaService.client.findUnique.mockResolvedValue(returningClient);\n      \n      const returningWelcome = await controller.getWelcomeRecommendations(TEST_USER_IDS.CLIENT, {\n        limit: 5,\n        forceRefresh: false,\n      });\n      expect(returningWelcome.isFirstTime).toBe(false);\n      expect(returningWelcome.redirectTo).toBe('/therapist-recommendations');\n    });\n  });\n\n  describe('Error Handling', () => {\n    it('should handle service unavailable scenarios', async () => {\n      mockPrismaService.user.findUnique.mockResolvedValue(mockUser);\n      const serviceError = new Error('Service temporarily unavailable');\n      mockTherapistRecommendationService.getRecommendedTherapists.mockRejectedValue(serviceError);\n\n      await TestAssertions.expectToThrowNestException(\n        () => controller.getRecommendedTherapists(TEST_USER_IDS.CLIENT, { limit: 10 }),\n        InternalServerErrorException,\n        'Service temporarily unavailable',\n      );\n    });\n\n    it('should handle concurrent access issues', async () => {\n      mockPrismaService.user.findUnique.mockResolvedValue(mockUser);\n      const concurrencyError = new Error('Resource is locked');\n      mockTherapistRecommendationService.getRecommendedTherapists.mockRejectedValue(concurrencyError);\n\n      await TestAssertions.expectToThrowNestException(\n        () => controller.getRecommendedTherapists(TEST_USER_IDS.CLIENT, { limit: 10 }),\n        InternalServerErrorException,\n        'Resource is locked',\n      );\n    });\n\n    it('should handle malformed query parameters', async () => {\n      const malformedQuery = { invalid: 'data' };\n      mockPrismaService.user.findUnique.mockResolvedValue(mockUser);\n      mockTherapistRecommendationService.getRecommendedTherapists.mockResolvedValue(mockRecommendationResponse);\n\n      const result = await controller.getRecommendedTherapists(TEST_USER_IDS.CLIENT, malformedQuery as any);\n\n      expect(therapistRecommendationService.getRecommendedTherapists).toHaveBeenCalledWith({\n        userId: TEST_USER_IDS.CLIENT,\n        limit: undefined,\n        includeInactive: undefined,\n        province: undefined,\n        maxHourlyRate: undefined,\n      });\n    });\n  });\n\n  describe('Response Format Validation', () => {\n    it('should return properly formatted recommendation response', async () => {\n      mockPrismaService.user.findUnique.mockResolvedValue(mockUser);\n      mockTherapistRecommendationService.getRecommendedTherapists.mockResolvedValue(mockRecommendationResponse);\n\n      const result = await controller.getRecommendedTherapists(TEST_USER_IDS.CLIENT, { limit: 10 });\n\n      expect(result).toHaveProperty('recommendations');\n      expect(result).toHaveProperty('totalCount');\n      expect(result).toHaveProperty('page');\n      expect(result).toHaveProperty('limit');\n      expect(result).toHaveProperty('hasMore');\n      expect(Array.isArray(result.recommendations)).toBe(true);\n      expect(typeof result.totalCount).toBe('number');\n    });\n\n    it('should return properly formatted compatibility analysis response', async () => {\n      mockPrismaService.user.findUnique.mockResolvedValue(mockUser);\n      mockTherapistRecommendationService.getCompatibilityAnalysis.mockResolvedValue(mockCompatibilityAnalysis);\n\n      const result = await controller.getCompatibilityAnalysis(TEST_USER_IDS.CLIENT, TEST_USER_IDS.THERAPIST);\n\n      expect(result).toHaveProperty('userId');\n      expect(result).toHaveProperty('therapistId');\n      expect(result).toHaveProperty('overallCompatibility');\n      expect(result).toHaveProperty('compatibilityFactors');\n      expect(Array.isArray(result.compatibilityFactors)).toBe(true);\n      expect(typeof result.overallCompatibility).toBe('number');\n    });\n\n    it('should return properly formatted welcome response', async () => {\n      mockPrismaService.user.findUnique.mockResolvedValue(mockUser);\n      mockPrismaService.client.findUnique.mockResolvedValue(mockClient);\n      mockTherapistRecommendationService.getRecommendedTherapists.mockResolvedValue(mockRecommendationResponse);\n\n      const result = await controller.getWelcomeRecommendations(TEST_USER_IDS.CLIENT, { limit: 5 });\n\n      expect(result).toHaveProperty('welcomeMessage');\n      expect(result).toHaveProperty('isFirstTime');\n      expect(result).toHaveProperty('userInfo');\n      expect(result).toHaveProperty('nextSteps');\n      expect(result).toHaveProperty('matchingInsights');\n      expect(typeof result.welcomeMessage).toBe('string');\n      expect(typeof result.isFirstTime).toBe('boolean');\n      expect(result.userInfo).toHaveProperty('firstName');\n      expect(result.nextSteps).toHaveProperty('canSendRequests');\n      expect(Array.isArray(result.nextSteps.recommendedActions)).toBe(true);\n    });\n  });\n\n  describe('Private Methods', () => {\n    it('should generate proper welcome message for first-time user', () => {\n      const message = (controller as any).generateWelcomeMessage('John', true);\n      expect(message).toContain('Welcome to Mentara, John!');\n      expect(message).toContain('curated a personalized list');\n    });\n\n    it('should generate proper welcome message for returning user', () => {\n      const message = (controller as any).generateWelcomeMessage('John', false);\n      expect(message).toContain('Welcome back, John!');\n      expect(message).toContain('fresh therapist recommendations');\n    });\n  });\n});"],"version":3}