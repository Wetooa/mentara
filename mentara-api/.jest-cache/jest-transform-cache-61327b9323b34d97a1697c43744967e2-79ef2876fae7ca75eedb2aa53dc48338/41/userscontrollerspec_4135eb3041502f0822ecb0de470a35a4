e20ec93fb5eeafa62d85eed3a201b407
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const common_1 = require("@nestjs/common");
const users_controller_1 = require("./users.controller");
const users_service_1 = require("./users.service");
const jwt_auth_guard_1 = require("../auth/guards/jwt-auth.guard");
const admin_auth_guard_1 = require("../auth/guards/admin-auth.guard");
const supabase_storage_service_1 = require("../common/services/supabase-storage.service");
const role_utils_1 = require("../utils/role-utils");
const zod_validation_pipe_1 = require("../common/pipes/zod-validation.pipe");
const auth_testing_helpers_1 = require("../test-utils/auth-testing-helpers");
const enhanced_test_helpers_1 = require("../test-utils/enhanced-test-helpers");
const index_1 = require("../test-utils/index");
describe('UsersController', () => {
    let controller;
    let usersService;
    let supabaseStorageService;
    let roleUtils;
    let mockJwtAuthGuard;
    let mockAdminAuthGuard;
    // Test data constants
    const mockUser = {
        id: index_1.TEST_USER_IDS.CLIENT,
        email: index_1.TEST_EMAILS.CLIENT,
        firstName: 'John',
        lastName: 'Doe',
        role: 'client',
        bio: 'User bio',
        avatarUrl: 'https://example.com/avatar.jpg',
        coverImageUrl: 'https://example.com/cover.jpg',
        phoneNumber: '+1234567890',
        timezone: 'America/New_York',
        language: 'en',
        theme: 'light',
        createdAt: new Date(),
        updatedAt: new Date(),
        emailVerified: true,
        profileComplete: true,
        isActive: true,
    };
    const mockAdminUser = {
        id: index_1.TEST_USER_IDS.ADMIN,
        email: index_1.TEST_EMAILS.ADMIN,
        firstName: 'Admin',
        lastName: 'User',
        role: 'admin',
        createdAt: new Date(),
        updatedAt: new Date(),
        emailVerified: true,
        profileComplete: true,
        isActive: true,
    };
    const mockUsers = [mockUser, mockAdminUser];
    const mockFile = {
        fieldname: 'avatar',
        originalname: 'avatar.jpg',
        encoding: '7bit',
        mimetype: 'image/jpeg',
        size: 1024,
        buffer: Buffer.from('test file content'),
    };
    const mockUploadResult = {
        url: 'https://example.com/uploaded-avatar.jpg',
        filename: 'avatar.jpg',
        size: 1024,
    };
    beforeEach(async () => {
        // Create mock services
        const mockUsersService = {
            findAll: jest.fn(),
            findAllIncludeInactive: jest.fn(),
            findOne: jest.fn(),
            findOneIncludeInactive: jest.fn(),
            update: jest.fn(),
            remove: jest.fn(),
            deactivate: jest.fn(),
            reactivate: jest.fn(),
        };
        const mockSupabaseStorageService = {
            validateFile: jest.fn(),
            uploadFile: jest.fn(),
            getSupportedBuckets: jest.fn(),
        };
        const mockRoleUtils = {
            isUserAdmin: jest.fn(),
        };
        mockJwtAuthGuard = {
            canActivate: jest.fn().mockReturnValue(true),
        };
        mockAdminAuthGuard = {
            canActivate: jest.fn().mockReturnValue(true),
        };
        // Add static method mock
        supabase_storage_service_1.SupabaseStorageService.getSupportedBuckets = jest.fn().mockReturnValue({
            USER_PROFILES: 'user-profiles',
        });
        const module = await testing_1.Test.createTestingModule({
            controllers: [users_controller_1.UsersController],
            providers: [
                {
                    provide: users_service_1.UsersService,
                    useValue: mockUsersService,
                },
                {
                    provide: supabase_storage_service_1.SupabaseStorageService,
                    useValue: mockSupabaseStorageService,
                },
                {
                    provide: role_utils_1.RoleUtils,
                    useValue: mockRoleUtils,
                },
                {
                    provide: common_1.Logger,
                    useValue: {
                        log: jest.fn(),
                        error: jest.fn(),
                        warn: jest.fn(),
                        debug: jest.fn(),
                    },
                },
            ],
        })
            .overrideGuard(jwt_auth_guard_1.JwtAuthGuard)
            .useValue(mockJwtAuthGuard)
            .overrideGuard(admin_auth_guard_1.AdminAuthGuard)
            .useValue(mockAdminAuthGuard)
            .compile();
        controller = module.get(users_controller_1.UsersController);
        usersService = module.get(users_service_1.UsersService);
        supabaseStorageService = module.get(supabase_storage_service_1.SupabaseStorageService);
        roleUtils = module.get(role_utils_1.RoleUtils);
    });
    afterEach(() => {
        jest.clearAllMocks();
    });
    describe('findAll', () => {
        it('should return all users for admin', async () => {
            // Arrange
            jest.spyOn(usersService, 'findAll').mockResolvedValue(mockUsers);
            // Act
            const result = await controller.findAll(index_1.TEST_USER_IDS.ADMIN);
            // Assert
            expect(usersService.findAll).toHaveBeenCalled();
            expect(result).toEqual(mockUsers);
        });
        it('should handle service errors', async () => {
            // Arrange
            const error = new Error('Database error');
            jest.spyOn(usersService, 'findAll').mockRejectedValue(error);
            // Act & Assert
            await expect(controller.findAll(index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('findAllIncludeInactive', () => {
        it('should return all users including inactive for admin', async () => {
            const mockUsers = [
                enhanced_test_helpers_1.TestDataGenerator.createUser({ isActive: true }),
                enhanced_test_helpers_1.TestDataGenerator.createUser({ isActive: false }),
            ];
            usersService.findAllIncludeInactive.mockResolvedValue(mockUsers);
            const result = await controller.findAllIncludeInactive(index_1.TEST_USER_IDS.ADMIN);
            expect(usersService.findAllIncludeInactive).toHaveBeenCalled();
            expect(result).toEqual(mockUsers);
        });
        it('should handle service errors when fetching all users', async () => {
            usersService.findAllIncludeInactive.mockRejectedValue(new Error('Database connection failed'));
            await expect(controller.findAllIncludeInactive(index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('findOne', () => {
        const mockUser = enhanced_test_helpers_1.TestDataGenerator.createUser({ id: index_1.TEST_USER_IDS.CLIENT });
        it('should allow user to view their own profile', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.findOne.mockResolvedValue(mockUser);
            const result = await controller.findOne({ id: index_1.TEST_USER_IDS.CLIENT }, index_1.TEST_USER_IDS.CLIENT);
            expect(roleUtils.isUserAdmin).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT);
            expect(usersService.findOne).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT);
            expect(result).toEqual(mockUser);
        });
        it('should allow admin to view any user profile', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(true);
            usersService.findOneIncludeInactive.mockResolvedValue(mockUser);
            const result = await controller.findOne({ id: index_1.TEST_USER_IDS.CLIENT }, index_1.TEST_USER_IDS.ADMIN);
            expect(roleUtils.isUserAdmin).toHaveBeenCalledWith(index_1.TEST_USER_IDS.ADMIN);
            expect(usersService.findOneIncludeInactive).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT);
            expect(result).toEqual(mockUser);
        });
        it('should throw ForbiddenException when non-admin tries to view other user', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(false);
            await expect(controller.findOne({ id: index_1.TEST_USER_IDS.THERAPIST }, index_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.ForbiddenException);
            expect(usersService.findOne).not.toHaveBeenCalled();
        });
        it('should throw HttpException when user not found', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.findOne.mockResolvedValue(null);
            await expect(controller.findOne({ id: index_1.TEST_USER_IDS.CLIENT }, index_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('update', () => {
        const updateData = {
            firstName: 'Updated',
            lastName: 'Name',
            bio: 'Updated bio',
        };
        it('should allow user to update their own profile', async () => {
            const updatedUser = { ...enhanced_test_helpers_1.TestDataGenerator.createUser(), ...updateData };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.update.mockResolvedValue(updatedUser);
            const result = await controller.update({ id: index_1.TEST_USER_IDS.CLIENT }, updateData, index_1.TEST_USER_IDS.CLIENT);
            expect(roleUtils.isUserAdmin).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT);
            expect(usersService.update).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, updateData);
            expect(result).toEqual(updatedUser);
        });
        it('should allow admin to update any user with all fields', async () => {
            const adminUpdateData = {
                firstName: 'Admin Updated',
                role: 'moderator',
                isActive: false,
            };
            const updatedUser = {
                ...enhanced_test_helpers_1.TestDataGenerator.createUser(),
                ...adminUpdateData,
            };
            roleUtils.isUserAdmin.mockResolvedValue(true);
            usersService.update.mockResolvedValue(updatedUser);
            const result = await controller.update({ id: index_1.TEST_USER_IDS.CLIENT }, adminUpdateData, index_1.TEST_USER_IDS.ADMIN);
            expect(usersService.update).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, adminUpdateData);
            expect(result).toEqual(updatedUser);
        });
        it('should sanitize non-admin updates to allowed fields only', async () => {
            const unauthorizedData = {
                firstName: 'John',
                role: 'admin', // Should be filtered out
                isActive: false, // Should be filtered out
                bio: 'New bio',
            };
            const sanitizedData = {
                firstName: 'John',
                bio: 'New bio',
            };
            const updatedUser = {
                ...enhanced_test_helpers_1.TestDataGenerator.createUser(),
                ...sanitizedData,
            };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.update.mockResolvedValue(updatedUser);
            const result = await controller.update({ id: index_1.TEST_USER_IDS.CLIENT }, unauthorizedData, index_1.TEST_USER_IDS.CLIENT);
            expect(usersService.update).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, sanitizedData);
            expect(result).toEqual(updatedUser);
        });
        it('should throw ForbiddenException when non-admin tries to update other user', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(false);
            await expect(controller.update({ id: index_1.TEST_USER_IDS.THERAPIST }, updateData, index_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.ForbiddenException);
            expect(usersService.update).not.toHaveBeenCalled();
        });
    });
    describe('remove', () => {
        it('should allow user to deactivate their own account', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.remove.mockResolvedValue({});
            const result = await controller.remove({ id: index_1.TEST_USER_IDS.CLIENT }, index_1.TEST_USER_IDS.CLIENT);
            expect(roleUtils.isUserAdmin).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT);
            expect(usersService.remove).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT);
            expect(result).toEqual({
                message: 'User account deactivated successfully',
            });
        });
        it('should allow admin to deactivate any user account', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(true);
            usersService.remove.mockResolvedValue({});
            const result = await controller.remove({ id: index_1.TEST_USER_IDS.CLIENT }, index_1.TEST_USER_IDS.ADMIN);
            expect(usersService.remove).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT);
            expect(result).toEqual({
                message: 'User account deactivated successfully',
            });
        });
        it('should throw ForbiddenException when non-admin tries to deactivate other user', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(false);
            await expect(controller.remove({ id: index_1.TEST_USER_IDS.THERAPIST }, index_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.ForbiddenException);
            expect(usersService.remove).not.toHaveBeenCalled();
        });
    });
    describe('deactivateUser (admin only)', () => {
        it('should allow admin to deactivate user with reason', async () => {
            const deactivationBody = { reason: 'Policy violation' };
            usersService.deactivate.mockResolvedValue({});
            const result = await controller.deactivateUser({ id: index_1.TEST_USER_IDS.CLIENT }, deactivationBody, index_1.TEST_USER_IDS.ADMIN);
            expect(usersService.deactivate).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, 'Policy violation', index_1.TEST_USER_IDS.ADMIN);
            expect(result).toEqual({
                message: 'User account deactivated by administrator',
            });
        });
        it('should handle deactivation without reason', async () => {
            const deactivationBody = {};
            usersService.deactivate.mockResolvedValue({});
            const result = await controller.deactivateUser({ id: index_1.TEST_USER_IDS.CLIENT }, deactivationBody, index_1.TEST_USER_IDS.ADMIN);
            expect(usersService.deactivate).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, undefined, index_1.TEST_USER_IDS.ADMIN);
            expect(result).toEqual({
                message: 'User account deactivated by administrator',
            });
        });
        it('should handle service errors during deactivation', async () => {
            const deactivationBody = { reason: 'Test reason' };
            usersService.deactivate.mockRejectedValue(new Error('Service error'));
            await expect(controller.deactivateUser({ id: index_1.TEST_USER_IDS.CLIENT }, deactivationBody, index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('reactivateUser (admin only)', () => {
        it('should allow admin to reactivate user', async () => {
            usersService.reactivate.mockResolvedValue({});
            const result = await controller.reactivateUser({ id: index_1.TEST_USER_IDS.CLIENT }, index_1.TEST_USER_IDS.ADMIN);
            expect(usersService.reactivate).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT);
            expect(result).toEqual({
                message: 'User account reactivated successfully',
            });
        });
        it('should handle service errors during reactivation', async () => {
            usersService.reactivate.mockRejectedValue(new Error('Reactivation failed'));
            await expect(controller.reactivateUser({ id: index_1.TEST_USER_IDS.CLIENT }, index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('error handling', () => {
        it('should preserve ForbiddenException from service layer', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(true);
            usersService.findOneIncludeInactive.mockRejectedValue(new common_1.ForbiddenException('Access denied'));
            await expect(controller.findOne({ id: index_1.TEST_USER_IDS.CLIENT }, index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(common_1.ForbiddenException);
        });
        it('should wrap generic errors in HttpException', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.findOne.mockRejectedValue(new Error('Generic error'));
            await expect(controller.findOne({ id: index_1.TEST_USER_IDS.CLIENT }, index_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.HttpException);
        });
        it('should handle role utils errors gracefully', async () => {
            roleUtils.isUserAdmin.mockRejectedValue(new Error('Role check failed'));
            await expect(controller.findOne({ id: index_1.TEST_USER_IDS.CLIENT }, index_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('authorization edge cases', () => {
        it('should handle empty update data for non-admin', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.update.mockResolvedValue(enhanced_test_helpers_1.TestDataGenerator.createUser());
            await controller.update({ id: index_1.TEST_USER_IDS.CLIENT }, {}, index_1.TEST_USER_IDS.CLIENT);
            expect(usersService.update).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, {});
        });
        it('should handle mixed allowed and disallowed fields for non-admin', async () => {
            const mixedData = {
                firstName: 'John', // Allowed
                lastName: 'Doe', // Allowed
                role: 'admin', // Not allowed
                bio: 'New bio', // Allowed
                isActive: false, // Not allowed
                avatarUrl: 'http://example.com/avatar.jpg', // Allowed
            };
            const expectedSanitizedData = {
                firstName: 'John',
                lastName: 'Doe',
                bio: 'New bio',
                avatarUrl: 'http://example.com/avatar.jpg',
            };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.update.mockResolvedValue(enhanced_test_helpers_1.TestDataGenerator.createUser());
            await controller.update({ id: index_1.TEST_USER_IDS.CLIENT }, mixedData, index_1.TEST_USER_IDS.CLIENT);
            expect(usersService.update).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, expectedSanitizedData);
        });
    });
    describe('File Upload Integration', () => {
        it('should handle avatar upload successfully', async () => {
            // Arrange
            const mockFiles = {
                avatar: [mockFile],
            };
            const updateData = {
                firstName: 'John',
                lastName: 'Doe',
            };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            supabaseStorageService.validateFile.mockReturnValue({ isValid: true });
            supabaseStorageService.uploadFile.mockResolvedValue(mockUploadResult);
            usersService.update.mockResolvedValue(enhanced_test_helpers_1.TestDataGenerator.createUser());
            // Act
            await controller.update({ id: index_1.TEST_USER_IDS.CLIENT }, updateData, index_1.TEST_USER_IDS.CLIENT, mockFiles);
            // Assert
            expect(supabaseStorageService.validateFile).toHaveBeenCalledWith(mockFile);
            expect(supabaseStorageService.uploadFile).toHaveBeenCalledWith(mockFile, 'user-profiles');
            expect(usersService.update).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, {
                ...updateData,
                avatarUrl: mockUploadResult.url,
            });
        });
        it('should handle cover image upload successfully', async () => {
            // Arrange
            const mockCoverFile = {
                ...mockFile,
                fieldname: 'cover',
                originalname: 'cover.jpg',
            };
            const mockFiles = {
                cover: [mockCoverFile],
            };
            const updateData = {
                firstName: 'John',
                lastName: 'Doe',
            };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            supabaseStorageService.validateFile.mockReturnValue({ isValid: true });
            supabaseStorageService.uploadFile.mockResolvedValue(mockUploadResult);
            usersService.update.mockResolvedValue(enhanced_test_helpers_1.TestDataGenerator.createUser());
            // Act
            await controller.update({ id: index_1.TEST_USER_IDS.CLIENT }, updateData, index_1.TEST_USER_IDS.CLIENT, mockFiles);
            // Assert
            expect(supabaseStorageService.validateFile).toHaveBeenCalledWith(mockCoverFile);
            expect(supabaseStorageService.uploadFile).toHaveBeenCalledWith(mockCoverFile, 'user-profiles');
            expect(usersService.update).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, {
                ...updateData,
                coverImageUrl: mockUploadResult.url,
            });
        });
        it('should handle multiple file uploads simultaneously', async () => {
            // Arrange
            const mockCoverFile = {
                ...mockFile,
                fieldname: 'cover',
                originalname: 'cover.jpg',
            };
            const mockFiles = {
                avatar: [mockFile],
                cover: [mockCoverFile],
            };
            const updateData = {
                firstName: 'John',
                lastName: 'Doe',
            };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            supabaseStorageService.validateFile.mockReturnValue({ isValid: true });
            supabaseStorageService.uploadFile.mockResolvedValue(mockUploadResult);
            usersService.update.mockResolvedValue(enhanced_test_helpers_1.TestDataGenerator.createUser());
            // Act
            await controller.update({ id: index_1.TEST_USER_IDS.CLIENT }, updateData, index_1.TEST_USER_IDS.CLIENT, mockFiles);
            // Assert
            expect(supabaseStorageService.validateFile).toHaveBeenCalledTimes(2);
            expect(supabaseStorageService.uploadFile).toHaveBeenCalledTimes(2);
            expect(usersService.update).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, {
                ...updateData,
                avatarUrl: mockUploadResult.url,
                coverImageUrl: mockUploadResult.url,
            });
        });
        it('should handle file validation errors', async () => {
            // Arrange
            const mockFiles = {
                avatar: [mockFile],
            };
            const updateData = {
                firstName: 'John',
                lastName: 'Doe',
            };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            supabaseStorageService.validateFile.mockReturnValue({
                isValid: false,
                error: 'File too large',
            });
            // Act & Assert
            await expect(controller.update({ id: index_1.TEST_USER_IDS.CLIENT }, updateData, index_1.TEST_USER_IDS.CLIENT, mockFiles)).rejects.toThrow('Avatar validation failed: File too large');
        });
        it('should handle file upload errors', async () => {
            // Arrange
            const mockFiles = {
                avatar: [mockFile],
            };
            const updateData = {
                firstName: 'John',
                lastName: 'Doe',
            };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            supabaseStorageService.validateFile.mockReturnValue({ isValid: true });
            supabaseStorageService.uploadFile.mockRejectedValue(new Error('Upload failed'));
            // Act & Assert
            await expect(controller.update({ id: index_1.TEST_USER_IDS.CLIENT }, updateData, index_1.TEST_USER_IDS.CLIENT, mockFiles)).rejects.toThrow('Failed to update user: Upload failed');
        });
    });
    describe('Security Tests', () => {
        it('should validate input data through ZodValidationPipe', () => {
            // This tests that the controller uses proper validation
            const validationPipe = new zod_validation_pipe_1.ZodValidationPipe({});
            expect(validationPipe).toBeDefined();
        });
        it('should require authentication for all endpoints', () => {
            // Test that all endpoints have JwtAuthGuard
            const protectedMethods = ['findAll', 'findAllIncludeInactive', 'findOne', 'update', 'remove', 'deactivateUser', 'reactivateUser'];
            protectedMethods.forEach(method => {
                const guards = Reflect.getMetadata('__guards__', users_controller_1.UsersController.prototype[method]);
                expect(guards).toBeDefined();
            });
        });
        it('should enforce admin-only access for admin endpoints', () => {
            // Test that admin endpoints have AdminAuthGuard
            const adminMethods = ['findAll', 'findAllIncludeInactive', 'deactivateUser', 'reactivateUser'];
            adminMethods.forEach(method => {
                const guards = Reflect.getMetadata('__guards__', controller[method]);
                expect(guards).toBeDefined();
            });
        });
        it('should handle JWT token validation', async () => {
            // Test that JWT guard is properly applied
            mockJwtAuthGuard.canActivate.mockReturnValue(false);
            // Mock the actual HTTP exception that would be thrown
            const unauthorizedError = new Error('Unauthorized');
            usersService.findAll.mockRejectedValue(unauthorizedError);
            await expect(controller.findAll(index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow();
        });
        it('should handle admin authorization validation', async () => {
            // Test that admin guard is properly applied
            mockAdminAuthGuard.canActivate.mockReturnValue(false);
            // Mock the actual HTTP exception that would be thrown
            const forbiddenError = new Error('Forbidden');
            usersService.findAll.mockRejectedValue(forbiddenError);
            await expect(controller.findAll(index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow();
        });
        it('should prevent unauthorized access to other user profiles', async () => {
            // Test that users can only access their own profile
            roleUtils.isUserAdmin.mockResolvedValue(false);
            await expect(controller.findOne({ id: index_1.TEST_USER_IDS.THERAPIST }, index_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.ForbiddenException);
        });
    });
    describe('Role-based Access Control', () => {
        it('should test role-based access for admin endpoints', async () => {
            // Test that admin endpoints require admin role
            await auth_testing_helpers_1.RoleBasedTestUtils.testWithRoles(async (userId, role) => {
                try {
                    await controller.findAll(userId);
                    return true;
                }
                catch (error) {
                    return false;
                }
            }, {
                client: false,
                therapist: false,
                admin: true,
                moderator: false,
            });
        });
        it('should validate user-specific functionality', async () => {
            // Test that users can access their own profile
            const userContext = enhanced_test_helpers_1.MockBuilder.createAuthContext('client');
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.findOne.mockResolvedValue(mockUser);
            const result = await controller.findOne({ id: userContext.userId }, userContext.userId);
            expect(result).toBeDefined();
            expect(result.id).toBe(userContext.userId);
        });
        it('should test field sanitization for non-admin users', async () => {
            // Test that non-admin users cannot update sensitive fields
            const sensitiveData = {
                firstName: 'John',
                role: 'admin', // Should be filtered out
                isActive: false, // Should be filtered out
                emailVerified: true, // Should be filtered out
            };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.update.mockResolvedValue(mockUser);
            await controller.update({ id: index_1.TEST_USER_IDS.CLIENT }, sensitiveData, index_1.TEST_USER_IDS.CLIENT);
            expect(usersService.update).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, { firstName: 'John' });
        });
    });
    describe('Integration Tests', () => {
        it('should handle complete user profile update workflow', async () => {
            // Arrange
            const updateData = {
                firstName: 'Updated',
                lastName: 'Name',
                bio: 'Updated bio',
                timezone: 'America/Los_Angeles',
                language: 'en',
                theme: 'dark',
            };
            const updatedUser = { ...mockUser, ...updateData };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.update.mockResolvedValue(updatedUser);
            // Act
            const result = await controller.update({ id: index_1.TEST_USER_IDS.CLIENT }, updateData, index_1.TEST_USER_IDS.CLIENT);
            // Assert
            expect(result).toBeDefined();
            expect(result.firstName).toBe('Updated');
            expect(result.lastName).toBe('Name');
            expect(result.bio).toBe('Updated bio');
            expect(result.timezone).toBe('America/Los_Angeles');
        });
        it('should handle complete admin user management workflow', async () => {
            // Arrange
            roleUtils.isUserAdmin.mockResolvedValue(true);
            usersService.findAll.mockResolvedValue(mockUsers);
            usersService.findAllIncludeInactive.mockResolvedValue(mockUsers);
            usersService.findOneIncludeInactive.mockResolvedValue(mockUser);
            // Act - Get all users
            const allUsers = await controller.findAll(index_1.TEST_USER_IDS.ADMIN);
            // Act - Get all users including inactive
            const allUsersIncludeInactive = await controller.findAllIncludeInactive(index_1.TEST_USER_IDS.ADMIN);
            // Act - View specific user
            const specificUser = await controller.findOne({ id: index_1.TEST_USER_IDS.CLIENT }, index_1.TEST_USER_IDS.ADMIN);
            // Assert
            expect(allUsers).toBeDefined();
            expect(allUsers).toHaveLength(2);
            expect(allUsersIncludeInactive).toBeDefined();
            expect(allUsersIncludeInactive).toHaveLength(2);
            expect(specificUser).toBeDefined();
            expect(specificUser.id).toBe(index_1.TEST_USER_IDS.CLIENT);
        });
        it('should handle complete user deactivation workflow', async () => {
            // Arrange
            usersService.deactivate.mockResolvedValue({});
            // Act
            const result = await controller.deactivateUser({ id: index_1.TEST_USER_IDS.CLIENT }, { reason: 'Policy violation' }, index_1.TEST_USER_IDS.ADMIN);
            // Assert
            expect(result).toBeDefined();
            expect(result.message).toBe('User account deactivated by administrator');
            expect(usersService.deactivate).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, 'Policy violation', index_1.TEST_USER_IDS.ADMIN);
        });
        it('should handle complete user reactivation workflow', async () => {
            // Arrange
            usersService.reactivate.mockResolvedValue({});
            // Act
            const result = await controller.reactivateUser({ id: index_1.TEST_USER_IDS.CLIENT }, index_1.TEST_USER_IDS.ADMIN);
            // Assert
            expect(result).toBeDefined();
            expect(result.message).toBe('User account reactivated successfully');
            expect(usersService.reactivate).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT);
        });
    });
    describe('Data Validation', () => {
        it('should validate user update data structure', () => {
            // Test that we're using the correct DTO structure
            const validUpdateData = {
                firstName: 'John',
                lastName: 'Doe',
                bio: 'User bio',
                avatarUrl: 'https://example.com/avatar.jpg',
                coverImageUrl: 'https://example.com/cover.jpg',
                phoneNumber: '+1234567890',
                timezone: 'America/New_York',
                language: 'en',
                theme: 'light',
            };
            // Verify all fields are defined
            expect(validUpdateData.firstName).toBeDefined();
            expect(validUpdateData.lastName).toBeDefined();
            expect(validUpdateData.bio).toBeDefined();
            expect(validUpdateData.avatarUrl).toBeDefined();
            expect(validUpdateData.coverImageUrl).toBeDefined();
            expect(validUpdateData.phoneNumber).toBeDefined();
            expect(validUpdateData.timezone).toBeDefined();
            expect(validUpdateData.language).toBeDefined();
            expect(validUpdateData.theme).toBeDefined();
        });
        it('should validate deactivation data structure', () => {
            // Test that we're using the correct DTO structure
            const validDeactivationData = {
                reason: 'Policy violation',
            };
            // Verify all fields are defined
            expect(validDeactivationData.reason).toBeDefined();
        });
        it('should validate user ID parameter structure', () => {
            // Test that we're using the correct parameter structure
            const validUserIdParam = {
                id: index_1.TEST_USER_IDS.CLIENT,
            };
            // Verify all fields are defined
            expect(validUserIdParam.id).toBeDefined();
        });
    });
    describe('Response Format Validation', () => {
        it('should return correctly formatted user list response', async () => {
            // Arrange
            roleUtils.isUserAdmin.mockResolvedValue(true);
            usersService.findAll.mockResolvedValue(mockUsers);
            // Act
            const result = await controller.findAll(index_1.TEST_USER_IDS.ADMIN);
            // Assert
            expect(result).toBeInstanceOf(Array);
            expect(result).toHaveLength(2);
            const user = result[0];
            expect(user).toHaveProperty('id');
            expect(user).toHaveProperty('email');
            expect(user).toHaveProperty('firstName');
            expect(user).toHaveProperty('lastName');
            expect(user).toHaveProperty('role');
            expect(user).toHaveProperty('createdAt');
            expect(user).toHaveProperty('isActive');
        });
        it('should return correctly formatted user profile response', async () => {
            // Arrange
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.findOne.mockResolvedValue(mockUser);
            // Act
            const result = await controller.findOne({ id: index_1.TEST_USER_IDS.CLIENT }, index_1.TEST_USER_IDS.CLIENT);
            // Assert
            expect(result).toHaveProperty('id');
            expect(result).toHaveProperty('email');
            expect(result).toHaveProperty('firstName');
            expect(result).toHaveProperty('lastName');
            expect(result).toHaveProperty('role');
            expect(result).toHaveProperty('bio');
            expect(result).toHaveProperty('avatarUrl');
            expect(result).toHaveProperty('coverImageUrl');
            expect(result).toHaveProperty('phoneNumber');
            expect(result).toHaveProperty('timezone');
            expect(result).toHaveProperty('language');
            expect(result).toHaveProperty('theme');
            expect(result).toHaveProperty('createdAt');
            expect(result).toHaveProperty('updatedAt');
        });
        it('should return correctly formatted update response', async () => {
            // Arrange
            const updateData = {
                firstName: 'Updated',
                lastName: 'Name',
            };
            const updatedUser = { ...mockUser, ...updateData };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.update.mockResolvedValue(updatedUser);
            // Act
            const result = await controller.update({ id: index_1.TEST_USER_IDS.CLIENT }, updateData, index_1.TEST_USER_IDS.CLIENT);
            // Assert
            expect(result).toHaveProperty('id');
            expect(result).toHaveProperty('email');
            expect(result).toHaveProperty('firstName');
            expect(result).toHaveProperty('lastName');
            expect(result.firstName).toBe('Updated');
            expect(result.lastName).toBe('Name');
        });
        it('should return correctly formatted deactivation response', async () => {
            // Arrange
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.remove.mockResolvedValue({});
            // Act
            const result = await controller.remove({ id: index_1.TEST_USER_IDS.CLIENT }, index_1.TEST_USER_IDS.CLIENT);
            // Assert
            expect(result).toHaveProperty('message');
            expect(result.message).toBe('User account deactivated successfully');
        });
        it('should return correctly formatted admin deactivation response', async () => {
            // Arrange
            usersService.deactivate.mockResolvedValue({});
            // Act
            const result = await controller.deactivateUser(index_1.TEST_USER_IDS.CLIENT, { reason: 'Policy violation' }, index_1.TEST_USER_IDS.ADMIN);
            // Assert
            expect(result).toHaveProperty('message');
            expect(result.message).toBe('User account deactivated by administrator');
        });
        it('should return correctly formatted reactivation response', async () => {
            // Arrange
            usersService.reactivate.mockResolvedValue({});
            // Act
            const result = await controller.reactivateUser({ id: index_1.TEST_USER_IDS.CLIENT }, index_1.TEST_USER_IDS.ADMIN);
            // Assert
            expect(result).toHaveProperty('message');
            expect(result.message).toBe('User account reactivated successfully');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL3VzZXJzL3VzZXJzLmNvbnRyb2xsZXIuc3BlYy50cyIsIm1hcHBpbmdzIjoiOztBQUFBLDZDQUFzRDtBQUN0RCwyQ0FLd0I7QUFDeEIseURBQXFEO0FBQ3JELG1EQUErQztBQUMvQyxrRUFBNkQ7QUFDN0Qsc0VBQWlFO0FBQ2pFLDBGQUFxRjtBQUNyRixvREFBZ0Q7QUFDaEQsNkVBQXdFO0FBQ3hFLDZFQUc0QztBQUM1QywrRUFJNkM7QUFDN0MsK0NBQWlFO0FBRWpFLFFBQVEsQ0FBQyxpQkFBaUIsRUFBRSxHQUFHLEVBQUU7SUFDL0IsSUFBSSxVQUEyQixDQUFDO0lBQ2hDLElBQUksWUFBMEIsQ0FBQztJQUMvQixJQUFJLHNCQUE4QyxDQUFDO0lBQ25ELElBQUksU0FBb0IsQ0FBQztJQUN6QixJQUFJLGdCQUEyQyxDQUFDO0lBQ2hELElBQUksa0JBQStDLENBQUM7SUFFcEQsc0JBQXNCO0lBQ3RCLE1BQU0sUUFBUSxHQUFHO1FBQ2YsRUFBRSxFQUFFLHFCQUFhLENBQUMsTUFBTTtRQUN4QixLQUFLLEVBQUUsbUJBQVcsQ0FBQyxNQUFNO1FBQ3pCLFNBQVMsRUFBRSxNQUFNO1FBQ2pCLFFBQVEsRUFBRSxLQUFLO1FBQ2YsSUFBSSxFQUFFLFFBQVE7UUFDZCxHQUFHLEVBQUUsVUFBVTtRQUNmLFNBQVMsRUFBRSxnQ0FBZ0M7UUFDM0MsYUFBYSxFQUFFLCtCQUErQjtRQUM5QyxXQUFXLEVBQUUsYUFBYTtRQUMxQixRQUFRLEVBQUUsa0JBQWtCO1FBQzVCLFFBQVEsRUFBRSxJQUFJO1FBQ2QsS0FBSyxFQUFFLE9BQU87UUFDZCxTQUFTLEVBQUUsSUFBSSxJQUFJLEVBQUU7UUFDckIsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFO1FBQ3JCLGFBQWEsRUFBRSxJQUFJO1FBQ25CLGVBQWUsRUFBRSxJQUFJO1FBQ3JCLFFBQVEsRUFBRSxJQUFJO0tBQ2YsQ0FBQztJQUVGLE1BQU0sYUFBYSxHQUFHO1FBQ3BCLEVBQUUsRUFBRSxxQkFBYSxDQUFDLEtBQUs7UUFDdkIsS0FBSyxFQUFFLG1CQUFXLENBQUMsS0FBSztRQUN4QixTQUFTLEVBQUUsT0FBTztRQUNsQixRQUFRLEVBQUUsTUFBTTtRQUNoQixJQUFJLEVBQUUsT0FBTztRQUNiLFNBQVMsRUFBRSxJQUFJLElBQUksRUFBRTtRQUNyQixTQUFTLEVBQUUsSUFBSSxJQUFJLEVBQUU7UUFDckIsYUFBYSxFQUFFLElBQUk7UUFDbkIsZUFBZSxFQUFFLElBQUk7UUFDckIsUUFBUSxFQUFFLElBQUk7S0FDZixDQUFDO0lBRUYsTUFBTSxTQUFTLEdBQUcsQ0FBQyxRQUFRLEVBQUUsYUFBYSxDQUFDLENBQUM7SUFFNUMsTUFBTSxRQUFRLEdBQUc7UUFDZixTQUFTLEVBQUUsUUFBUTtRQUNuQixZQUFZLEVBQUUsWUFBWTtRQUMxQixRQUFRLEVBQUUsTUFBTTtRQUNoQixRQUFRLEVBQUUsWUFBWTtRQUN0QixJQUFJLEVBQUUsSUFBSTtRQUNWLE1BQU0sRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLG1CQUFtQixDQUFDO0tBQ2xCLENBQUM7SUFFekIsTUFBTSxnQkFBZ0IsR0FBRztRQUN2QixHQUFHLEVBQUUseUNBQXlDO1FBQzlDLFFBQVEsRUFBRSxZQUFZO1FBQ3RCLElBQUksRUFBRSxJQUFJO0tBQ1gsQ0FBQztJQUVGLFVBQVUsQ0FBQyxLQUFLLElBQUksRUFBRTtRQUNwQix1QkFBdUI7UUFDdkIsTUFBTSxnQkFBZ0IsR0FBRztZQUN2QixPQUFPLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUNsQixzQkFBc0IsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1lBQ2pDLE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1lBQ2xCLHNCQUFzQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7WUFDakMsTUFBTSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7WUFDakIsTUFBTSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7WUFDakIsVUFBVSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7WUFDckIsVUFBVSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7U0FDdEIsQ0FBQztRQUVGLE1BQU0sMEJBQTBCLEdBQUc7WUFDakMsWUFBWSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7WUFDdkIsVUFBVSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7WUFDckIsbUJBQW1CLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtTQUMvQixDQUFDO1FBRUYsTUFBTSxhQUFhLEdBQUc7WUFDcEIsV0FBVyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7U0FDdkIsQ0FBQztRQUVGLGdCQUFnQixHQUFHO1lBQ2pCLFdBQVcsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQztTQUN0QyxDQUFDO1FBRVQsa0JBQWtCLEdBQUc7WUFDbkIsV0FBVyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDO1NBQ3RDLENBQUM7UUFFVCx5QkFBeUI7UUFDekIsaURBQXNCLENBQUMsbUJBQW1CLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGVBQWUsQ0FBQztZQUNyRSxhQUFhLEVBQUUsZUFBZTtTQUMvQixDQUFDLENBQUM7UUFFSCxNQUFNLE1BQU0sR0FBa0IsTUFBTSxjQUFJLENBQUMsbUJBQW1CLENBQUM7WUFDM0QsV0FBVyxFQUFFLENBQUMsa0NBQWUsQ0FBQztZQUM5QixTQUFTLEVBQUU7Z0JBQ1Q7b0JBQ0UsT0FBTyxFQUFFLDRCQUFZO29CQUNyQixRQUFRLEVBQUUsZ0JBQWdCO2lCQUMzQjtnQkFDRDtvQkFDRSxPQUFPLEVBQUUsaURBQXNCO29CQUMvQixRQUFRLEVBQUUsMEJBQTBCO2lCQUNyQztnQkFDRDtvQkFDRSxPQUFPLEVBQUUsc0JBQVM7b0JBQ2xCLFFBQVEsRUFBRSxhQUFhO2lCQUN4QjtnQkFDRDtvQkFDRSxPQUFPLEVBQUUsZUFBTTtvQkFDZixRQUFRLEVBQUU7d0JBQ1IsR0FBRyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7d0JBQ2QsS0FBSyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7d0JBQ2hCLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO3dCQUNmLEtBQUssRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO3FCQUNqQjtpQkFDRjthQUNGO1NBQ0YsQ0FBQzthQUNDLGFBQWEsQ0FBQyw2QkFBWSxDQUFDO2FBQzNCLFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQzthQUMxQixhQUFhLENBQUMsaUNBQWMsQ0FBQzthQUM3QixRQUFRLENBQUMsa0JBQWtCLENBQUM7YUFDNUIsT0FBTyxFQUFFLENBQUM7UUFFYixVQUFVLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBa0Isa0NBQWUsQ0FBQyxDQUFDO1FBQzFELFlBQVksR0FBRyxNQUFNLENBQUMsR0FBRyxDQUFlLDRCQUFZLENBQUMsQ0FBQztRQUN0RCxzQkFBc0IsR0FBRyxNQUFNLENBQUMsR0FBRyxDQUF5QixpREFBc0IsQ0FBQyxDQUFDO1FBQ3BGLFNBQVMsR0FBRyxNQUFNLENBQUMsR0FBRyxDQUFZLHNCQUFTLENBQUMsQ0FBQztJQUMvQyxDQUFDLENBQUMsQ0FBQztJQUVILFNBQVMsQ0FBQyxHQUFHLEVBQUU7UUFDYixJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7SUFDdkIsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsU0FBUyxFQUFFLEdBQUcsRUFBRTtRQUN2QixFQUFFLENBQUMsbUNBQW1DLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDakQsVUFBVTtZQUNWLElBQUksQ0FBQyxLQUFLLENBQUMsWUFBWSxFQUFFLFNBQVMsQ0FBQyxDQUFDLGlCQUFpQixDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBRWpFLE1BQU07WUFDTixNQUFNLE1BQU0sR0FBRyxNQUFNLFVBQVUsQ0FBQyxPQUFPLENBQUMscUJBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUU3RCxTQUFTO1lBQ1QsTUFBTSxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1lBQ2hELE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDcEMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsOEJBQThCLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDNUMsVUFBVTtZQUNWLE1BQU0sS0FBSyxHQUFHLElBQUksS0FBSyxDQUFDLGdCQUFnQixDQUFDLENBQUM7WUFDMUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxZQUFZLEVBQUUsU0FBUyxDQUFDLENBQUMsaUJBQWlCLENBQUMsS0FBSyxDQUFDLENBQUM7WUFFN0QsZUFBZTtZQUNmLE1BQU0sTUFBTSxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMscUJBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsc0JBQWEsQ0FBQyxDQUFDO1FBQ3ZGLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsd0JBQXdCLEVBQUUsR0FBRyxFQUFFO1FBQ3RDLEVBQUUsQ0FBQyxzREFBc0QsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNwRSxNQUFNLFNBQVMsR0FBRztnQkFDaEIseUNBQWlCLENBQUMsVUFBVSxDQUFDLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxDQUFDO2dCQUNoRCx5Q0FBaUIsQ0FBQyxVQUFVLENBQUMsRUFBRSxRQUFRLEVBQUUsS0FBSyxFQUFFLENBQUM7YUFDbEQsQ0FBQztZQUVGLFlBQVksQ0FBQyxzQkFBc0IsQ0FBQyxpQkFBaUIsQ0FBQyxTQUFnQixDQUFDLENBQUM7WUFFeEUsTUFBTSxNQUFNLEdBQUcsTUFBTSxVQUFVLENBQUMsc0JBQXNCLENBQ3BELHFCQUFhLENBQUMsS0FBSyxDQUNwQixDQUFDO1lBRUYsTUFBTSxDQUFDLFlBQVksQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDLGdCQUFnQixFQUFFLENBQUM7WUFDL0QsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUNwQyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxzREFBc0QsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNwRSxZQUFZLENBQUMsc0JBQXNCLENBQUMsaUJBQWlCLENBQ25ELElBQUksS0FBSyxDQUFDLDRCQUE0QixDQUFDLENBQ3hDLENBQUM7WUFFRixNQUFNLE1BQU0sQ0FDVixVQUFVLENBQUMsc0JBQXNCLENBQUMscUJBQWEsQ0FBQyxLQUFLLENBQUMsQ0FDdkQsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLHNCQUFhLENBQUMsQ0FBQztRQUNuQyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLFNBQVMsRUFBRSxHQUFHLEVBQUU7UUFDdkIsTUFBTSxRQUFRLEdBQUcseUNBQWlCLENBQUMsVUFBVSxDQUFDLEVBQUUsRUFBRSxFQUFFLHFCQUFhLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQztRQUU1RSxFQUFFLENBQUMsNkNBQTZDLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDM0QsU0FBUyxDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUMvQyxZQUFZLENBQUMsT0FBTyxDQUFDLGlCQUFpQixDQUFDLFFBQWUsQ0FBQyxDQUFDO1lBRXhELE1BQU0sTUFBTSxHQUFHLE1BQU0sVUFBVSxDQUFDLE9BQU8sQ0FDckMsRUFBRSxFQUFFLEVBQUUscUJBQWEsQ0FBQyxNQUFNLEVBQUUsRUFDNUIscUJBQWEsQ0FBQyxNQUFNLENBQ3JCLENBQUM7WUFFRixNQUFNLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLHFCQUFhLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDekUsTUFBTSxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxxQkFBYSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQ3hFLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDbkMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsNkNBQTZDLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDM0QsU0FBUyxDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUM5QyxZQUFZLENBQUMsc0JBQXNCLENBQUMsaUJBQWlCLENBQUMsUUFBZSxDQUFDLENBQUM7WUFFdkUsTUFBTSxNQUFNLEdBQUcsTUFBTSxVQUFVLENBQUMsT0FBTyxDQUNyQyxFQUFFLEVBQUUsRUFBRSxxQkFBYSxDQUFDLE1BQU0sRUFBRSxFQUM1QixxQkFBYSxDQUFDLEtBQUssQ0FDcEIsQ0FBQztZQUVGLE1BQU0sQ0FBQyxTQUFTLENBQUMsV0FBVyxDQUFDLENBQUMsb0JBQW9CLENBQUMscUJBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUN4RSxNQUFNLENBQUMsWUFBWSxDQUFDLHNCQUFzQixDQUFDLENBQUMsb0JBQW9CLENBQzlELHFCQUFhLENBQUMsTUFBTSxDQUNyQixDQUFDO1lBQ0YsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUNuQyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyx5RUFBeUUsRUFBRSxLQUFLLElBQUksRUFBRTtZQUN2RixTQUFTLENBQUMsV0FBVyxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFDO1lBRS9DLE1BQU0sTUFBTSxDQUNWLFVBQVUsQ0FBQyxPQUFPLENBQUMsRUFBRSxFQUFFLEVBQUUscUJBQWEsQ0FBQyxTQUFTLEVBQUUsRUFBRSxxQkFBYSxDQUFDLE1BQU0sQ0FBQyxDQUMxRSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsMkJBQWtCLENBQUMsQ0FBQztZQUV0QyxNQUFNLENBQUMsWUFBWSxDQUFDLE9BQU8sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1FBQ3RELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLGdEQUFnRCxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzlELFNBQVMsQ0FBQyxXQUFXLENBQUMsaUJBQWlCLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDL0MsWUFBWSxDQUFDLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUU3QyxNQUFNLE1BQU0sQ0FDVixVQUFVLENBQUMsT0FBTyxDQUFDLEVBQUUsRUFBRSxFQUFFLHFCQUFhLENBQUMsTUFBTSxFQUFFLEVBQUUscUJBQWEsQ0FBQyxNQUFNLENBQUMsQ0FDdkUsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLHNCQUFhLENBQUMsQ0FBQztRQUNuQyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLFFBQVEsRUFBRSxHQUFHLEVBQUU7UUFDdEIsTUFBTSxVQUFVLEdBQUc7WUFDakIsU0FBUyxFQUFFLFNBQVM7WUFDcEIsUUFBUSxFQUFFLE1BQU07WUFDaEIsR0FBRyxFQUFFLGFBQWE7U0FDbkIsQ0FBQztRQUVGLEVBQUUsQ0FBQywrQ0FBK0MsRUFBRSxLQUFLLElBQUksRUFBRTtZQUM3RCxNQUFNLFdBQVcsR0FBRyxFQUFFLEdBQUcseUNBQWlCLENBQUMsVUFBVSxFQUFFLEVBQUUsR0FBRyxVQUFVLEVBQUUsQ0FBQztZQUN6RSxTQUFTLENBQUMsV0FBVyxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQy9DLFlBQVksQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsV0FBa0IsQ0FBQyxDQUFDO1lBRTFELE1BQU0sTUFBTSxHQUFHLE1BQU0sVUFBVSxDQUFDLE1BQU0sQ0FDcEMsRUFBRSxFQUFFLEVBQUUscUJBQWEsQ0FBQyxNQUFNLEVBQUUsRUFDNUIsVUFBVSxFQUNWLHFCQUFhLENBQUMsTUFBTSxDQUNyQixDQUFDO1lBRUYsTUFBTSxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxxQkFBYSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQ3pFLE1BQU0sQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLENBQUMsb0JBQW9CLENBQzlDLHFCQUFhLENBQUMsTUFBTSxFQUNwQixVQUFVLENBQ1gsQ0FBQztZQUNGLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUM7UUFDdEMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsdURBQXVELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDckUsTUFBTSxlQUFlLEdBQUc7Z0JBQ3RCLFNBQVMsRUFBRSxlQUFlO2dCQUMxQixJQUFJLEVBQUUsV0FBVztnQkFDakIsUUFBUSxFQUFFLEtBQUs7YUFDaEIsQ0FBQztZQUNGLE1BQU0sV0FBVyxHQUFHO2dCQUNsQixHQUFHLHlDQUFpQixDQUFDLFVBQVUsRUFBRTtnQkFDakMsR0FBRyxlQUFlO2FBQ25CLENBQUM7WUFFRixTQUFTLENBQUMsV0FBVyxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxDQUFDO1lBQzlDLFlBQVksQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsV0FBa0IsQ0FBQyxDQUFDO1lBRTFELE1BQU0sTUFBTSxHQUFHLE1BQU0sVUFBVSxDQUFDLE1BQU0sQ0FDcEMsRUFBRSxFQUFFLEVBQUUscUJBQWEsQ0FBQyxNQUFNLEVBQUUsRUFDNUIsZUFBZSxFQUNmLHFCQUFhLENBQUMsS0FBSyxDQUNwQixDQUFDO1lBRUYsTUFBTSxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUMsQ0FBQyxvQkFBb0IsQ0FDOUMscUJBQWEsQ0FBQyxNQUFNLEVBQ3BCLGVBQWUsQ0FDaEIsQ0FBQztZQUNGLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUM7UUFDdEMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsMERBQTBELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDeEUsTUFBTSxnQkFBZ0IsR0FBRztnQkFDdkIsU0FBUyxFQUFFLE1BQU07Z0JBQ2pCLElBQUksRUFBRSxPQUFPLEVBQUUseUJBQXlCO2dCQUN4QyxRQUFRLEVBQUUsS0FBSyxFQUFFLHlCQUF5QjtnQkFDMUMsR0FBRyxFQUFFLFNBQVM7YUFDZixDQUFDO1lBQ0YsTUFBTSxhQUFhLEdBQUc7Z0JBQ3BCLFNBQVMsRUFBRSxNQUFNO2dCQUNqQixHQUFHLEVBQUUsU0FBUzthQUNmLENBQUM7WUFDRixNQUFNLFdBQVcsR0FBRztnQkFDbEIsR0FBRyx5Q0FBaUIsQ0FBQyxVQUFVLEVBQUU7Z0JBQ2pDLEdBQUcsYUFBYTthQUNqQixDQUFDO1lBRUYsU0FBUyxDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUMvQyxZQUFZLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLFdBQWtCLENBQUMsQ0FBQztZQUUxRCxNQUFNLE1BQU0sR0FBRyxNQUFNLFVBQVUsQ0FBQyxNQUFNLENBQ3BDLEVBQUUsRUFBRSxFQUFFLHFCQUFhLENBQUMsTUFBTSxFQUFFLEVBQzVCLGdCQUFnQixFQUNoQixxQkFBYSxDQUFDLE1BQU0sQ0FDckIsQ0FBQztZQUVGLE1BQU0sQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLENBQUMsb0JBQW9CLENBQzlDLHFCQUFhLENBQUMsTUFBTSxFQUNwQixhQUFhLENBQ2QsQ0FBQztZQUNGLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUM7UUFDdEMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsMkVBQTJFLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDekYsU0FBUyxDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUUvQyxNQUFNLE1BQU0sQ0FDVixVQUFVLENBQUMsTUFBTSxDQUNmLEVBQUUsRUFBRSxFQUFFLHFCQUFhLENBQUMsU0FBUyxFQUFFLEVBQy9CLFVBQVUsRUFDVixxQkFBYSxDQUFDLE1BQU0sQ0FDckIsQ0FDRixDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsMkJBQWtCLENBQUMsQ0FBQztZQUV0QyxNQUFNLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1FBQ3JELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsUUFBUSxFQUFFLEdBQUcsRUFBRTtRQUN0QixFQUFFLENBQUMsbURBQW1ELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDakUsU0FBUyxDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUMvQyxZQUFZLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLEVBQVMsQ0FBQyxDQUFDO1lBRWpELE1BQU0sTUFBTSxHQUFHLE1BQU0sVUFBVSxDQUFDLE1BQU0sQ0FDcEMsRUFBRSxFQUFFLEVBQUUscUJBQWEsQ0FBQyxNQUFNLEVBQUUsRUFDNUIscUJBQWEsQ0FBQyxNQUFNLENBQ3JCLENBQUM7WUFFRixNQUFNLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLHFCQUFhLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDekUsTUFBTSxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxxQkFBYSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQ3ZFLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUM7Z0JBQ3JCLE9BQU8sRUFBRSx1Q0FBdUM7YUFDakQsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsbURBQW1ELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDakUsU0FBUyxDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUM5QyxZQUFZLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLEVBQVMsQ0FBQyxDQUFDO1lBRWpELE1BQU0sTUFBTSxHQUFHLE1BQU0sVUFBVSxDQUFDLE1BQU0sQ0FDcEMsRUFBRSxFQUFFLEVBQUUscUJBQWEsQ0FBQyxNQUFNLEVBQUUsRUFDNUIscUJBQWEsQ0FBQyxLQUFLLENBQ3BCLENBQUM7WUFFRixNQUFNLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDLG9CQUFvQixDQUFDLHFCQUFhLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDdkUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLE9BQU8sQ0FBQztnQkFDckIsT0FBTyxFQUFFLHVDQUF1QzthQUNqRCxDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQywrRUFBK0UsRUFBRSxLQUFLLElBQUksRUFBRTtZQUM3RixTQUFTLENBQUMsV0FBVyxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFDO1lBRS9DLE1BQU0sTUFBTSxDQUNWLFVBQVUsQ0FBQyxNQUFNLENBQUMsRUFBRSxFQUFFLEVBQUUscUJBQWEsQ0FBQyxTQUFTLEVBQUUsRUFBRSxxQkFBYSxDQUFDLE1BQU0sQ0FBQyxDQUN6RSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsMkJBQWtCLENBQUMsQ0FBQztZQUV0QyxNQUFNLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1FBQ3JELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsNkJBQTZCLEVBQUUsR0FBRyxFQUFFO1FBQzNDLEVBQUUsQ0FBQyxtREFBbUQsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNqRSxNQUFNLGdCQUFnQixHQUFHLEVBQUUsTUFBTSxFQUFFLGtCQUFrQixFQUFFLENBQUM7WUFDeEQsWUFBWSxDQUFDLFVBQVUsQ0FBQyxpQkFBaUIsQ0FBQyxFQUFTLENBQUMsQ0FBQztZQUVyRCxNQUFNLE1BQU0sR0FBRyxNQUFNLFVBQVUsQ0FBQyxjQUFjLENBQzVDLEVBQUUsRUFBRSxFQUFFLHFCQUFhLENBQUMsTUFBTSxFQUFFLEVBQzVCLGdCQUFnQixFQUNoQixxQkFBYSxDQUFDLEtBQUssQ0FDcEIsQ0FBQztZQUVGLE1BQU0sQ0FBQyxZQUFZLENBQUMsVUFBVSxDQUFDLENBQUMsb0JBQW9CLENBQ2xELHFCQUFhLENBQUMsTUFBTSxFQUNwQixrQkFBa0IsRUFDbEIscUJBQWEsQ0FBQyxLQUFLLENBQ3BCLENBQUM7WUFDRixNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsT0FBTyxDQUFDO2dCQUNyQixPQUFPLEVBQUUsMkNBQTJDO2FBQ3JELENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDJDQUEyQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3pELE1BQU0sZ0JBQWdCLEdBQUcsRUFBRSxDQUFDO1lBQzVCLFlBQVksQ0FBQyxVQUFVLENBQUMsaUJBQWlCLENBQUMsRUFBUyxDQUFDLENBQUM7WUFFckQsTUFBTSxNQUFNLEdBQUcsTUFBTSxVQUFVLENBQUMsY0FBYyxDQUM1QyxFQUFFLEVBQUUsRUFBRSxxQkFBYSxDQUFDLE1BQU0sRUFBRSxFQUM1QixnQkFBZ0IsRUFDaEIscUJBQWEsQ0FBQyxLQUFLLENBQ3BCLENBQUM7WUFFRixNQUFNLENBQUMsWUFBWSxDQUFDLFVBQVUsQ0FBQyxDQUFDLG9CQUFvQixDQUNsRCxxQkFBYSxDQUFDLE1BQU0sRUFDcEIsU0FBUyxFQUNULHFCQUFhLENBQUMsS0FBSyxDQUNwQixDQUFDO1lBQ0YsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLE9BQU8sQ0FBQztnQkFDckIsT0FBTyxFQUFFLDJDQUEyQzthQUNyRCxDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxrREFBa0QsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNoRSxNQUFNLGdCQUFnQixHQUFHLEVBQUUsTUFBTSxFQUFFLGFBQWEsRUFBRSxDQUFDO1lBQ25ELFlBQVksQ0FBQyxVQUFVLENBQUMsaUJBQWlCLENBQUMsSUFBSSxLQUFLLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQztZQUV0RSxNQUFNLE1BQU0sQ0FDVixVQUFVLENBQUMsY0FBYyxDQUN2QixFQUFFLEVBQUUsRUFBRSxxQkFBYSxDQUFDLE1BQU0sRUFBRSxFQUM1QixnQkFBZ0IsRUFDaEIscUJBQWEsQ0FBQyxLQUFLLENBQ3BCLENBQ0YsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLHNCQUFhLENBQUMsQ0FBQztRQUNuQyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLDZCQUE2QixFQUFFLEdBQUcsRUFBRTtRQUMzQyxFQUFFLENBQUMsdUNBQXVDLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDckQsWUFBWSxDQUFDLFVBQVUsQ0FBQyxpQkFBaUIsQ0FBQyxFQUFTLENBQUMsQ0FBQztZQUVyRCxNQUFNLE1BQU0sR0FBRyxNQUFNLFVBQVUsQ0FBQyxjQUFjLENBQzVDLEVBQUUsRUFBRSxFQUFFLHFCQUFhLENBQUMsTUFBTSxFQUFFLEVBQzVCLHFCQUFhLENBQUMsS0FBSyxDQUNwQixDQUFDO1lBRUYsTUFBTSxDQUFDLFlBQVksQ0FBQyxVQUFVLENBQUMsQ0FBQyxvQkFBb0IsQ0FDbEQscUJBQWEsQ0FBQyxNQUFNLENBQ3JCLENBQUM7WUFDRixNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsT0FBTyxDQUFDO2dCQUNyQixPQUFPLEVBQUUsdUNBQXVDO2FBQ2pELENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLGtEQUFrRCxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ2hFLFlBQVksQ0FBQyxVQUFVLENBQUMsaUJBQWlCLENBQ3ZDLElBQUksS0FBSyxDQUFDLHFCQUFxQixDQUFDLENBQ2pDLENBQUM7WUFFRixNQUFNLE1BQU0sQ0FDVixVQUFVLENBQUMsY0FBYyxDQUFDLEVBQUUsRUFBRSxFQUFFLHFCQUFhLENBQUMsTUFBTSxFQUFFLEVBQUUscUJBQWEsQ0FBQyxLQUFLLENBQUMsQ0FDN0UsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLHNCQUFhLENBQUMsQ0FBQztRQUNuQyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGdCQUFnQixFQUFFLEdBQUcsRUFBRTtRQUM5QixFQUFFLENBQUMsdURBQXVELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDckUsU0FBUyxDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUM5QyxZQUFZLENBQUMsc0JBQXNCLENBQUMsaUJBQWlCLENBQ25ELElBQUksMkJBQWtCLENBQUMsZUFBZSxDQUFDLENBQ3hDLENBQUM7WUFFRixNQUFNLE1BQU0sQ0FDVixVQUFVLENBQUMsT0FBTyxDQUFDLEVBQUUsRUFBRSxFQUFFLHFCQUFhLENBQUMsTUFBTSxFQUFFLEVBQUUscUJBQWEsQ0FBQyxLQUFLLENBQUMsQ0FDdEUsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLDJCQUFrQixDQUFDLENBQUM7UUFDeEMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsNkNBQTZDLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDM0QsU0FBUyxDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUMvQyxZQUFZLENBQUMsT0FBTyxDQUFDLGlCQUFpQixDQUFDLElBQUksS0FBSyxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUM7WUFFbkUsTUFBTSxNQUFNLENBQ1YsVUFBVSxDQUFDLE9BQU8sQ0FBQyxFQUFFLEVBQUUsRUFBRSxxQkFBYSxDQUFDLE1BQU0sRUFBRSxFQUFFLHFCQUFhLENBQUMsTUFBTSxDQUFDLENBQ3ZFLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxzQkFBYSxDQUFDLENBQUM7UUFDbkMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsNENBQTRDLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDMUQsU0FBUyxDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLEtBQUssQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLENBQUM7WUFFeEUsTUFBTSxNQUFNLENBQ1YsVUFBVSxDQUFDLE9BQU8sQ0FBQyxFQUFFLEVBQUUsRUFBRSxxQkFBYSxDQUFDLE1BQU0sRUFBRSxFQUFFLHFCQUFhLENBQUMsTUFBTSxDQUFDLENBQ3ZFLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxzQkFBYSxDQUFDLENBQUM7UUFDbkMsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQywwQkFBMEIsRUFBRSxHQUFHLEVBQUU7UUFDeEMsRUFBRSxDQUFDLCtDQUErQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzdELFNBQVMsQ0FBQyxXQUFXLENBQUMsaUJBQWlCLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDL0MsWUFBWSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FDbkMseUNBQWlCLENBQUMsVUFBVSxFQUFTLENBQ3RDLENBQUM7WUFFRixNQUFNLFVBQVUsQ0FBQyxNQUFNLENBQUMsRUFBRSxFQUFFLEVBQUUscUJBQWEsQ0FBQyxNQUFNLEVBQUUsRUFBRSxFQUFFLEVBQUUscUJBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUVoRixNQUFNLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDLG9CQUFvQixDQUM5QyxxQkFBYSxDQUFDLE1BQU0sRUFDcEIsRUFBRSxDQUNILENBQUM7UUFDSixDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxpRUFBaUUsRUFBRSxLQUFLLElBQUksRUFBRTtZQUMvRSxNQUFNLFNBQVMsR0FBRztnQkFDaEIsU0FBUyxFQUFFLE1BQU0sRUFBRSxVQUFVO2dCQUM3QixRQUFRLEVBQUUsS0FBSyxFQUFFLFVBQVU7Z0JBQzNCLElBQUksRUFBRSxPQUFPLEVBQUUsY0FBYztnQkFDN0IsR0FBRyxFQUFFLFNBQVMsRUFBRSxVQUFVO2dCQUMxQixRQUFRLEVBQUUsS0FBSyxFQUFFLGNBQWM7Z0JBQy9CLFNBQVMsRUFBRSwrQkFBK0IsRUFBRSxVQUFVO2FBQ3ZELENBQUM7WUFDRixNQUFNLHFCQUFxQixHQUFHO2dCQUM1QixTQUFTLEVBQUUsTUFBTTtnQkFDakIsUUFBUSxFQUFFLEtBQUs7Z0JBQ2YsR0FBRyxFQUFFLFNBQVM7Z0JBQ2QsU0FBUyxFQUFFLCtCQUErQjthQUMzQyxDQUFDO1lBRUYsU0FBUyxDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUMvQyxZQUFZLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUNuQyx5Q0FBaUIsQ0FBQyxVQUFVLEVBQVMsQ0FDdEMsQ0FBQztZQUVGLE1BQU0sVUFBVSxDQUFDLE1BQU0sQ0FDckIsRUFBRSxFQUFFLEVBQUUscUJBQWEsQ0FBQyxNQUFNLEVBQUUsRUFDNUIsU0FBUyxFQUNULHFCQUFhLENBQUMsTUFBTSxDQUNyQixDQUFDO1lBRUYsTUFBTSxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUMsQ0FBQyxvQkFBb0IsQ0FDOUMscUJBQWEsQ0FBQyxNQUFNLEVBQ3BCLHFCQUFxQixDQUN0QixDQUFDO1FBQ0osQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyx5QkFBeUIsRUFBRSxHQUFHLEVBQUU7UUFDdkMsRUFBRSxDQUFDLDBDQUEwQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3hELFVBQVU7WUFDVixNQUFNLFNBQVMsR0FBRztnQkFDaEIsTUFBTSxFQUFFLENBQUMsUUFBUSxDQUFDO2FBQ25CLENBQUM7WUFDRixNQUFNLFVBQVUsR0FBRztnQkFDakIsU0FBUyxFQUFFLE1BQU07Z0JBQ2pCLFFBQVEsRUFBRSxLQUFLO2FBQ2hCLENBQUM7WUFFRixTQUFTLENBQUMsV0FBVyxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQy9DLHNCQUFzQixDQUFDLFlBQVksQ0FBQyxlQUFlLENBQUMsRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztZQUN2RSxzQkFBc0IsQ0FBQyxVQUFVLENBQUMsaUJBQWlCLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztZQUN0RSxZQUFZLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUNuQyx5Q0FBaUIsQ0FBQyxVQUFVLEVBQVMsQ0FDdEMsQ0FBQztZQUVGLE1BQU07WUFDTixNQUFNLFVBQVUsQ0FBQyxNQUFNLENBQ3JCLEVBQUUsRUFBRSxFQUFFLHFCQUFhLENBQUMsTUFBTSxFQUFFLEVBQzVCLFVBQVUsRUFDVixxQkFBYSxDQUFDLE1BQU0sRUFDcEIsU0FBUyxDQUNWLENBQUM7WUFFRixTQUFTO1lBQ1QsTUFBTSxDQUFDLHNCQUFzQixDQUFDLFlBQVksQ0FBQyxDQUFDLG9CQUFvQixDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBQzNFLE1BQU0sQ0FBQyxzQkFBc0IsQ0FBQyxVQUFVLENBQUMsQ0FBQyxvQkFBb0IsQ0FDNUQsUUFBUSxFQUNSLGVBQWUsQ0FDaEIsQ0FBQztZQUNGLE1BQU0sQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLENBQUMsb0JBQW9CLENBQzlDLHFCQUFhLENBQUMsTUFBTSxFQUNwQjtnQkFDRSxHQUFHLFVBQVU7Z0JBQ2IsU0FBUyxFQUFFLGdCQUFnQixDQUFDLEdBQUc7YUFDaEMsQ0FDRixDQUFDO1FBQ0osQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsK0NBQStDLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDN0QsVUFBVTtZQUNWLE1BQU0sYUFBYSxHQUFHO2dCQUNwQixHQUFHLFFBQVE7Z0JBQ1gsU0FBUyxFQUFFLE9BQU87Z0JBQ2xCLFlBQVksRUFBRSxXQUFXO2FBQzFCLENBQUM7WUFDRixNQUFNLFNBQVMsR0FBRztnQkFDaEIsS0FBSyxFQUFFLENBQUMsYUFBYSxDQUFDO2FBQ3ZCLENBQUM7WUFDRixNQUFNLFVBQVUsR0FBRztnQkFDakIsU0FBUyxFQUFFLE1BQU07Z0JBQ2pCLFFBQVEsRUFBRSxLQUFLO2FBQ2hCLENBQUM7WUFFRixTQUFTLENBQUMsV0FBVyxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQy9DLHNCQUFzQixDQUFDLFlBQVksQ0FBQyxlQUFlLENBQUMsRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztZQUN2RSxzQkFBc0IsQ0FBQyxVQUFVLENBQUMsaUJBQWlCLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztZQUN0RSxZQUFZLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUNuQyx5Q0FBaUIsQ0FBQyxVQUFVLEVBQVMsQ0FDdEMsQ0FBQztZQUVGLE1BQU07WUFDTixNQUFNLFVBQVUsQ0FBQyxNQUFNLENBQ3JCLEVBQUUsRUFBRSxFQUFFLHFCQUFhLENBQUMsTUFBTSxFQUFFLEVBQzVCLFVBQVUsRUFDVixxQkFBYSxDQUFDLE1BQU0sRUFDcEIsU0FBUyxDQUNWLENBQUM7WUFFRixTQUFTO1lBQ1QsTUFBTSxDQUFDLHNCQUFzQixDQUFDLFlBQVksQ0FBQyxDQUFDLG9CQUFvQixDQUFDLGFBQWEsQ0FBQyxDQUFDO1lBQ2hGLE1BQU0sQ0FBQyxzQkFBc0IsQ0FBQyxVQUFVLENBQUMsQ0FBQyxvQkFBb0IsQ0FDNUQsYUFBYSxFQUNiLGVBQWUsQ0FDaEIsQ0FBQztZQUNGLE1BQU0sQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLENBQUMsb0JBQW9CLENBQzlDLHFCQUFhLENBQUMsTUFBTSxFQUNwQjtnQkFDRSxHQUFHLFVBQVU7Z0JBQ2IsYUFBYSxFQUFFLGdCQUFnQixDQUFDLEdBQUc7YUFDcEMsQ0FDRixDQUFDO1FBQ0osQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsb0RBQW9ELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDbEUsVUFBVTtZQUNWLE1BQU0sYUFBYSxHQUFHO2dCQUNwQixHQUFHLFFBQVE7Z0JBQ1gsU0FBUyxFQUFFLE9BQU87Z0JBQ2xCLFlBQVksRUFBRSxXQUFXO2FBQzFCLENBQUM7WUFDRixNQUFNLFNBQVMsR0FBRztnQkFDaEIsTUFBTSxFQUFFLENBQUMsUUFBUSxDQUFDO2dCQUNsQixLQUFLLEVBQUUsQ0FBQyxhQUFhLENBQUM7YUFDdkIsQ0FBQztZQUNGLE1BQU0sVUFBVSxHQUFHO2dCQUNqQixTQUFTLEVBQUUsTUFBTTtnQkFDakIsUUFBUSxFQUFFLEtBQUs7YUFDaEIsQ0FBQztZQUVGLFNBQVMsQ0FBQyxXQUFXLENBQUMsaUJBQWlCLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDL0Msc0JBQXNCLENBQUMsWUFBWSxDQUFDLGVBQWUsQ0FBQyxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO1lBQ3ZFLHNCQUFzQixDQUFDLFVBQVUsQ0FBQyxpQkFBaUIsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1lBQ3RFLFlBQVksQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQ25DLHlDQUFpQixDQUFDLFVBQVUsRUFBUyxDQUN0QyxDQUFDO1lBRUYsTUFBTTtZQUNOLE1BQU0sVUFBVSxDQUFDLE1BQU0sQ0FDckIsRUFBRSxFQUFFLEVBQUUscUJBQWEsQ0FBQyxNQUFNLEVBQUUsRUFDNUIsVUFBVSxFQUNWLHFCQUFhLENBQUMsTUFBTSxFQUNwQixTQUFTLENBQ1YsQ0FBQztZQUVGLFNBQVM7WUFDVCxNQUFNLENBQUMsc0JBQXNCLENBQUMsWUFBWSxDQUFDLENBQUMscUJBQXFCLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDckUsTUFBTSxDQUFDLHNCQUFzQixDQUFDLFVBQVUsQ0FBQyxDQUFDLHFCQUFxQixDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ25FLE1BQU0sQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLENBQUMsb0JBQW9CLENBQzlDLHFCQUFhLENBQUMsTUFBTSxFQUNwQjtnQkFDRSxHQUFHLFVBQVU7Z0JBQ2IsU0FBUyxFQUFFLGdCQUFnQixDQUFDLEdBQUc7Z0JBQy9CLGFBQWEsRUFBRSxnQkFBZ0IsQ0FBQyxHQUFHO2FBQ3BDLENBQ0YsQ0FBQztRQUNKLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHNDQUFzQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3BELFVBQVU7WUFDVixNQUFNLFNBQVMsR0FBRztnQkFDaEIsTUFBTSxFQUFFLENBQUMsUUFBUSxDQUFDO2FBQ25CLENBQUM7WUFDRixNQUFNLFVBQVUsR0FBRztnQkFDakIsU0FBUyxFQUFFLE1BQU07Z0JBQ2pCLFFBQVEsRUFBRSxLQUFLO2FBQ2hCLENBQUM7WUFFRixTQUFTLENBQUMsV0FBVyxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQy9DLHNCQUFzQixDQUFDLFlBQVksQ0FBQyxlQUFlLENBQUM7Z0JBQ2xELE9BQU8sRUFBRSxLQUFLO2dCQUNkLEtBQUssRUFBRSxnQkFBZ0I7YUFDeEIsQ0FBQyxDQUFDO1lBRUgsZUFBZTtZQUNmLE1BQU0sTUFBTSxDQUNWLFVBQVUsQ0FBQyxNQUFNLENBQ2YsRUFBRSxFQUFFLEVBQUUscUJBQWEsQ0FBQyxNQUFNLEVBQUUsRUFDNUIsVUFBVSxFQUNWLHFCQUFhLENBQUMsTUFBTSxFQUNwQixTQUFTLENBQ1YsQ0FDRixDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsMENBQTBDLENBQUMsQ0FBQztRQUNoRSxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxrQ0FBa0MsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNoRCxVQUFVO1lBQ1YsTUFBTSxTQUFTLEdBQUc7Z0JBQ2hCLE1BQU0sRUFBRSxDQUFDLFFBQVEsQ0FBQzthQUNuQixDQUFDO1lBQ0YsTUFBTSxVQUFVLEdBQUc7Z0JBQ2pCLFNBQVMsRUFBRSxNQUFNO2dCQUNqQixRQUFRLEVBQUUsS0FBSzthQUNoQixDQUFDO1lBRUYsU0FBUyxDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUMvQyxzQkFBc0IsQ0FBQyxZQUFZLENBQUMsZUFBZSxDQUFDLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7WUFDdkUsc0JBQXNCLENBQUMsVUFBVSxDQUFDLGlCQUFpQixDQUFDLElBQUksS0FBSyxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUM7WUFFaEYsZUFBZTtZQUNmLE1BQU0sTUFBTSxDQUNWLFVBQVUsQ0FBQyxNQUFNLENBQ2YsRUFBRSxFQUFFLEVBQUUscUJBQWEsQ0FBQyxNQUFNLEVBQUUsRUFDNUIsVUFBVSxFQUNWLHFCQUFhLENBQUMsTUFBTSxFQUNwQixTQUFTLENBQ1YsQ0FDRixDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsc0NBQXNDLENBQUMsQ0FBQztRQUM1RCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGdCQUFnQixFQUFFLEdBQUcsRUFBRTtRQUM5QixFQUFFLENBQUMsc0RBQXNELEVBQUUsR0FBRyxFQUFFO1lBQzlELHdEQUF3RDtZQUN4RCxNQUFNLGNBQWMsR0FBRyxJQUFJLHVDQUFpQixDQUFDLEVBQVMsQ0FBQyxDQUFDO1lBQ3hELE1BQU0sQ0FBQyxjQUFjLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUN2QyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxpREFBaUQsRUFBRSxHQUFHLEVBQUU7WUFDekQsNENBQTRDO1lBQzVDLE1BQU0sZ0JBQWdCLEdBQUcsQ0FBQyxTQUFTLEVBQUUsd0JBQXdCLEVBQUUsU0FBUyxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUUsZ0JBQWdCLEVBQUUsZ0JBQWdCLENBQUMsQ0FBQztZQUVsSSxnQkFBZ0IsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLEVBQUU7Z0JBQ2hDLE1BQU0sTUFBTSxHQUFHLE9BQU8sQ0FBQyxXQUFXLENBQUMsWUFBWSxFQUFFLGtDQUFlLENBQUMsU0FBUyxDQUFDLE1BQStCLENBQUMsQ0FBQyxDQUFDO2dCQUM3RyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDL0IsQ0FBQyxDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxzREFBc0QsRUFBRSxHQUFHLEVBQUU7WUFDOUQsZ0RBQWdEO1lBQ2hELE1BQU0sWUFBWSxHQUFHLENBQUMsU0FBUyxFQUFFLHdCQUF3QixFQUFFLGdCQUFnQixFQUFFLGdCQUFnQixDQUFDLENBQUM7WUFFL0YsWUFBWSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsRUFBRTtnQkFDNUIsTUFBTSxNQUFNLEdBQUcsT0FBTyxDQUFDLFdBQVcsQ0FBQyxZQUFZLEVBQUUsVUFBVSxDQUFDLE1BQStCLENBQUMsQ0FBQyxDQUFDO2dCQUM5RixNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDL0IsQ0FBQyxDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxvQ0FBb0MsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNsRCwwQ0FBMEM7WUFDMUMsZ0JBQWdCLENBQUMsV0FBVyxDQUFDLGVBQWUsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUVwRCxzREFBc0Q7WUFDdEQsTUFBTSxpQkFBaUIsR0FBRyxJQUFJLEtBQUssQ0FBQyxjQUFjLENBQUMsQ0FBQztZQUNwRCxZQUFZLENBQUMsT0FBTyxDQUFDLGlCQUFpQixDQUFDLGlCQUFpQixDQUFDLENBQUM7WUFFMUQsTUFBTSxNQUFNLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxxQkFBYSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBQzFFLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDhDQUE4QyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzVELDRDQUE0QztZQUM1QyxrQkFBa0IsQ0FBQyxXQUFXLENBQUMsZUFBZSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBRXRELHNEQUFzRDtZQUN0RCxNQUFNLGNBQWMsR0FBRyxJQUFJLEtBQUssQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUM5QyxZQUFZLENBQUMsT0FBTyxDQUFDLGlCQUFpQixDQUFDLGNBQWMsQ0FBQyxDQUFDO1lBRXZELE1BQU0sTUFBTSxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMscUJBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUMxRSxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQywyREFBMkQsRUFBRSxLQUFLLElBQUksRUFBRTtZQUN6RSxvREFBb0Q7WUFDcEQsU0FBUyxDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUUvQyxNQUFNLE1BQU0sQ0FDVixVQUFVLENBQUMsT0FBTyxDQUFDLEVBQUUsRUFBRSxFQUFFLHFCQUFhLENBQUMsU0FBUyxFQUFFLEVBQUUscUJBQWEsQ0FBQyxNQUFNLENBQUMsQ0FDMUUsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLDJCQUFrQixDQUFDLENBQUM7UUFDeEMsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQywyQkFBMkIsRUFBRSxHQUFHLEVBQUU7UUFDekMsRUFBRSxDQUFDLG1EQUFtRCxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ2pFLCtDQUErQztZQUMvQyxNQUFNLHlDQUFrQixDQUFDLGFBQWEsQ0FDcEMsS0FBSyxFQUFFLE1BQWMsRUFBRSxJQUFZLEVBQUUsRUFBRTtnQkFDckMsSUFBSSxDQUFDO29CQUNILE1BQU0sVUFBVSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQztvQkFDakMsT0FBTyxJQUFJLENBQUM7Z0JBQ2QsQ0FBQztnQkFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO29CQUNmLE9BQU8sS0FBSyxDQUFDO2dCQUNmLENBQUM7WUFDSCxDQUFDLEVBQ0Q7Z0JBQ0UsTUFBTSxFQUFFLEtBQUs7Z0JBQ2IsU0FBUyxFQUFFLEtBQUs7Z0JBQ2hCLEtBQUssRUFBRSxJQUFJO2dCQUNYLFNBQVMsRUFBRSxLQUFLO2FBQ2pCLENBQ0YsQ0FBQztRQUNKLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDZDQUE2QyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzNELCtDQUErQztZQUMvQyxNQUFNLFdBQVcsR0FBRyxtQ0FBVyxDQUFDLGlCQUFpQixDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBRTVELFNBQVMsQ0FBQyxXQUFXLENBQUMsaUJBQWlCLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDL0MsWUFBWSxDQUFDLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyxRQUFlLENBQUMsQ0FBQztZQUV4RCxNQUFNLE1BQU0sR0FBRyxNQUFNLFVBQVUsQ0FBQyxPQUFPLENBQUMsRUFBRSxFQUFFLEVBQUUsV0FBVyxDQUFDLE1BQU0sRUFBRSxFQUFFLFdBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUV4RixNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDN0IsTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQzdDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLG9EQUFvRCxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ2xFLDJEQUEyRDtZQUMzRCxNQUFNLGFBQWEsR0FBRztnQkFDcEIsU0FBUyxFQUFFLE1BQU07Z0JBQ2pCLElBQUksRUFBRSxPQUFPLEVBQUUseUJBQXlCO2dCQUN4QyxRQUFRLEVBQUUsS0FBSyxFQUFFLHlCQUF5QjtnQkFDMUMsYUFBYSxFQUFFLElBQUksRUFBRSx5QkFBeUI7YUFDL0MsQ0FBQztZQUVGLFNBQVMsQ0FBQyxXQUFXLENBQUMsaUJBQWlCLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDL0MsWUFBWSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxRQUFlLENBQUMsQ0FBQztZQUV2RCxNQUFNLFVBQVUsQ0FBQyxNQUFNLENBQUMsRUFBRSxFQUFFLEVBQUUscUJBQWEsQ0FBQyxNQUFNLEVBQUUsRUFBRSxhQUFhLEVBQUUscUJBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUUzRixNQUFNLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDLG9CQUFvQixDQUM5QyxxQkFBYSxDQUFDLE1BQU0sRUFDcEIsRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFFLENBQ3RCLENBQUM7UUFDSixDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLG1CQUFtQixFQUFFLEdBQUcsRUFBRTtRQUNqQyxFQUFFLENBQUMscURBQXFELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDbkUsVUFBVTtZQUNWLE1BQU0sVUFBVSxHQUFHO2dCQUNqQixTQUFTLEVBQUUsU0FBUztnQkFDcEIsUUFBUSxFQUFFLE1BQU07Z0JBQ2hCLEdBQUcsRUFBRSxhQUFhO2dCQUNsQixRQUFRLEVBQUUscUJBQXFCO2dCQUMvQixRQUFRLEVBQUUsSUFBSTtnQkFDZCxLQUFLLEVBQUUsTUFBTTthQUNkLENBQUM7WUFDRixNQUFNLFdBQVcsR0FBRyxFQUFFLEdBQUcsUUFBUSxFQUFFLEdBQUcsVUFBVSxFQUFFLENBQUM7WUFFbkQsU0FBUyxDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUMvQyxZQUFZLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLFdBQWtCLENBQUMsQ0FBQztZQUUxRCxNQUFNO1lBQ04sTUFBTSxNQUFNLEdBQUcsTUFBTSxVQUFVLENBQUMsTUFBTSxDQUNwQyxFQUFFLEVBQUUsRUFBRSxxQkFBYSxDQUFDLE1BQU0sRUFBRSxFQUM1QixVQUFVLEVBQ1YscUJBQWEsQ0FBQyxNQUFNLENBQ3JCLENBQUM7WUFFRixTQUFTO1lBQ1QsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQzdCLE1BQU0sQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQ3pDLE1BQU0sQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQ3JDLE1BQU0sQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDO1lBQ3ZDLE1BQU0sQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsSUFBSSxDQUFDLHFCQUFxQixDQUFDLENBQUM7UUFDdEQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsdURBQXVELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDckUsVUFBVTtZQUNWLFNBQVMsQ0FBQyxXQUFXLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDOUMsWUFBWSxDQUFDLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyxTQUFnQixDQUFDLENBQUM7WUFDekQsWUFBWSxDQUFDLHNCQUFzQixDQUFDLGlCQUFpQixDQUFDLFNBQWdCLENBQUMsQ0FBQztZQUN4RSxZQUFZLENBQUMsc0JBQXNCLENBQUMsaUJBQWlCLENBQUMsUUFBZSxDQUFDLENBQUM7WUFFdkUsc0JBQXNCO1lBQ3RCLE1BQU0sUUFBUSxHQUFHLE1BQU0sVUFBVSxDQUFDLE9BQU8sQ0FBQyxxQkFBYSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBRS9ELHlDQUF5QztZQUN6QyxNQUFNLHVCQUF1QixHQUFHLE1BQU0sVUFBVSxDQUFDLHNCQUFzQixDQUFDLHFCQUFhLENBQUMsS0FBSyxDQUFDLENBQUM7WUFFN0YsMkJBQTJCO1lBQzNCLE1BQU0sWUFBWSxHQUFHLE1BQU0sVUFBVSxDQUFDLE9BQU8sQ0FBQyxFQUFFLEVBQUUsRUFBRSxxQkFBYSxDQUFDLE1BQU0sRUFBRSxFQUFFLHFCQUFhLENBQUMsS0FBSyxDQUFDLENBQUM7WUFFakcsU0FBUztZQUNULE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUMvQixNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBRWpDLE1BQU0sQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQzlDLE1BQU0sQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUVoRCxNQUFNLENBQUMsWUFBWSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDbkMsTUFBTSxDQUFDLFlBQVksQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMscUJBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUNyRCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxtREFBbUQsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNqRSxVQUFVO1lBQ1YsWUFBWSxDQUFDLFVBQVUsQ0FBQyxpQkFBaUIsQ0FBQyxFQUFTLENBQUMsQ0FBQztZQUVyRCxNQUFNO1lBQ04sTUFBTSxNQUFNLEdBQUcsTUFBTSxVQUFVLENBQUMsY0FBYyxDQUM1QyxFQUFFLEVBQUUsRUFBRSxxQkFBYSxDQUFDLE1BQU0sRUFBRSxFQUM1QixFQUFFLE1BQU0sRUFBRSxrQkFBa0IsRUFBRSxFQUM5QixxQkFBYSxDQUFDLEtBQUssQ0FDcEIsQ0FBQztZQUVGLFNBQVM7WUFDVCxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDN0IsTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsMkNBQTJDLENBQUMsQ0FBQztZQUN6RSxNQUFNLENBQUMsWUFBWSxDQUFDLFVBQVUsQ0FBQyxDQUFDLG9CQUFvQixDQUNsRCxxQkFBYSxDQUFDLE1BQU0sRUFDcEIsa0JBQWtCLEVBQ2xCLHFCQUFhLENBQUMsS0FBSyxDQUNwQixDQUFDO1FBQ0osQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsbURBQW1ELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDakUsVUFBVTtZQUNWLFlBQVksQ0FBQyxVQUFVLENBQUMsaUJBQWlCLENBQUMsRUFBUyxDQUFDLENBQUM7WUFFckQsTUFBTTtZQUNOLE1BQU0sTUFBTSxHQUFHLE1BQU0sVUFBVSxDQUFDLGNBQWMsQ0FDNUMsRUFBRSxFQUFFLEVBQUUscUJBQWEsQ0FBQyxNQUFNLEVBQUUsRUFDNUIscUJBQWEsQ0FBQyxLQUFLLENBQ3BCLENBQUM7WUFFRixTQUFTO1lBQ1QsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQzdCLE1BQU0sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLHVDQUF1QyxDQUFDLENBQUM7WUFDckUsTUFBTSxDQUFDLFlBQVksQ0FBQyxVQUFVLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxxQkFBYSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQzdFLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsaUJBQWlCLEVBQUUsR0FBRyxFQUFFO1FBQy9CLEVBQUUsQ0FBQyw0Q0FBNEMsRUFBRSxHQUFHLEVBQUU7WUFDcEQsa0RBQWtEO1lBQ2xELE1BQU0sZUFBZSxHQUFHO2dCQUN0QixTQUFTLEVBQUUsTUFBTTtnQkFDakIsUUFBUSxFQUFFLEtBQUs7Z0JBQ2YsR0FBRyxFQUFFLFVBQVU7Z0JBQ2YsU0FBUyxFQUFFLGdDQUFnQztnQkFDM0MsYUFBYSxFQUFFLCtCQUErQjtnQkFDOUMsV0FBVyxFQUFFLGFBQWE7Z0JBQzFCLFFBQVEsRUFBRSxrQkFBa0I7Z0JBQzVCLFFBQVEsRUFBRSxJQUFJO2dCQUNkLEtBQUssRUFBRSxPQUFPO2FBQ2YsQ0FBQztZQUVGLGdDQUFnQztZQUNoQyxNQUFNLENBQUMsZUFBZSxDQUFDLFNBQVMsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQ2hELE1BQU0sQ0FBQyxlQUFlLENBQUMsUUFBUSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDL0MsTUFBTSxDQUFDLGVBQWUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUMxQyxNQUFNLENBQUMsZUFBZSxDQUFDLFNBQVMsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQ2hELE1BQU0sQ0FBQyxlQUFlLENBQUMsYUFBYSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDcEQsTUFBTSxDQUFDLGVBQWUsQ0FBQyxXQUFXLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUNsRCxNQUFNLENBQUMsZUFBZSxDQUFDLFFBQVEsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQy9DLE1BQU0sQ0FBQyxlQUFlLENBQUMsUUFBUSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDL0MsTUFBTSxDQUFDLGVBQWUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUM5QyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyw2Q0FBNkMsRUFBRSxHQUFHLEVBQUU7WUFDckQsa0RBQWtEO1lBQ2xELE1BQU0scUJBQXFCLEdBQUc7Z0JBQzVCLE1BQU0sRUFBRSxrQkFBa0I7YUFDM0IsQ0FBQztZQUVGLGdDQUFnQztZQUNoQyxNQUFNLENBQUMscUJBQXFCLENBQUMsTUFBTSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDckQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsNkNBQTZDLEVBQUUsR0FBRyxFQUFFO1lBQ3JELHdEQUF3RDtZQUN4RCxNQUFNLGdCQUFnQixHQUFHO2dCQUN2QixFQUFFLEVBQUUscUJBQWEsQ0FBQyxNQUFNO2FBQ3pCLENBQUM7WUFFRixnQ0FBZ0M7WUFDaEMsTUFBTSxDQUFDLGdCQUFnQixDQUFDLEVBQUUsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQzVDLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsNEJBQTRCLEVBQUUsR0FBRyxFQUFFO1FBQzFDLEVBQUUsQ0FBQyxzREFBc0QsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNwRSxVQUFVO1lBQ1YsU0FBUyxDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUM5QyxZQUFZLENBQUMsT0FBTyxDQUFDLGlCQUFpQixDQUFDLFNBQWdCLENBQUMsQ0FBQztZQUV6RCxNQUFNO1lBQ04sTUFBTSxNQUFNLEdBQUcsTUFBTSxVQUFVLENBQUMsT0FBTyxDQUFDLHFCQUFhLENBQUMsS0FBSyxDQUFDLENBQUM7WUFFN0QsU0FBUztZQUNULE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxjQUFjLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDckMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUUvQixNQUFNLElBQUksR0FBRyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDdkIsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUNsQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQ3JDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxjQUFjLENBQUMsV0FBVyxDQUFDLENBQUM7WUFDekMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLGNBQWMsQ0FBQyxVQUFVLENBQUMsQ0FBQztZQUN4QyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsY0FBYyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQ3BDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxjQUFjLENBQUMsV0FBVyxDQUFDLENBQUM7WUFDekMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLGNBQWMsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUMxQyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyx5REFBeUQsRUFBRSxLQUFLLElBQUksRUFBRTtZQUN2RSxVQUFVO1lBQ1YsU0FBUyxDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUMvQyxZQUFZLENBQUMsT0FBTyxDQUFDLGlCQUFpQixDQUFDLFFBQWUsQ0FBQyxDQUFDO1lBRXhELE1BQU07WUFDTixNQUFNLE1BQU0sR0FBRyxNQUFNLFVBQVUsQ0FBQyxPQUFPLENBQUMsRUFBRSxFQUFFLEVBQUUscUJBQWEsQ0FBQyxNQUFNLEVBQUUsRUFBRSxxQkFBYSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBRTVGLFNBQVM7WUFDVCxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ3BDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDdkMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGNBQWMsQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUMzQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsY0FBYyxDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBQzFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxjQUFjLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDdEMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGNBQWMsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUNyQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsY0FBYyxDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBQzNDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxjQUFjLENBQUMsZUFBZSxDQUFDLENBQUM7WUFDL0MsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGNBQWMsQ0FBQyxhQUFhLENBQUMsQ0FBQztZQUM3QyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsY0FBYyxDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBQzFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxjQUFjLENBQUMsVUFBVSxDQUFDLENBQUM7WUFDMUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUMsQ0FBQztZQUN2QyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsY0FBYyxDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBQzNDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxjQUFjLENBQUMsV0FBVyxDQUFDLENBQUM7UUFDN0MsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsbURBQW1ELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDakUsVUFBVTtZQUNWLE1BQU0sVUFBVSxHQUFHO2dCQUNqQixTQUFTLEVBQUUsU0FBUztnQkFDcEIsUUFBUSxFQUFFLE1BQU07YUFDakIsQ0FBQztZQUNGLE1BQU0sV0FBVyxHQUFHLEVBQUUsR0FBRyxRQUFRLEVBQUUsR0FBRyxVQUFVLEVBQUUsQ0FBQztZQUVuRCxTQUFTLENBQUMsV0FBVyxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQy9DLFlBQVksQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsV0FBa0IsQ0FBQyxDQUFDO1lBRTFELE1BQU07WUFDTixNQUFNLE1BQU0sR0FBRyxNQUFNLFVBQVUsQ0FBQyxNQUFNLENBQ3BDLEVBQUUsRUFBRSxFQUFFLHFCQUFhLENBQUMsTUFBTSxFQUFFLEVBQzVCLFVBQVUsRUFDVixxQkFBYSxDQUFDLE1BQU0sQ0FDckIsQ0FBQztZQUVGLFNBQVM7WUFDVCxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ3BDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDdkMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGNBQWMsQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUMzQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsY0FBYyxDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBQzFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQ3pDLE1BQU0sQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ3ZDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHlEQUF5RCxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3ZFLFVBQVU7WUFDVixTQUFTLENBQUMsV0FBVyxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQy9DLFlBQVksQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsRUFBUyxDQUFDLENBQUM7WUFFakQsTUFBTTtZQUNOLE1BQU0sTUFBTSxHQUFHLE1BQU0sVUFBVSxDQUFDLE1BQU0sQ0FBQyxFQUFFLEVBQUUsRUFBRSxxQkFBYSxDQUFDLE1BQU0sRUFBRSxFQUFFLHFCQUFhLENBQUMsTUFBTSxDQUFDLENBQUM7WUFFM0YsU0FBUztZQUNULE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxjQUFjLENBQUMsU0FBUyxDQUFDLENBQUM7WUFDekMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsdUNBQXVDLENBQUMsQ0FBQztRQUN2RSxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQywrREFBK0QsRUFBRSxLQUFLLElBQUksRUFBRTtZQUM3RSxVQUFVO1lBQ1YsWUFBWSxDQUFDLFVBQVUsQ0FBQyxpQkFBaUIsQ0FBQyxFQUFTLENBQUMsQ0FBQztZQUVyRCxNQUFNO1lBQ04sTUFBTSxNQUFNLEdBQUcsTUFBTSxVQUFVLENBQUMsY0FBYyxDQUM1QyxxQkFBYSxDQUFDLE1BQU0sRUFDcEIsRUFBRSxNQUFNLEVBQUUsa0JBQWtCLEVBQUUsRUFDOUIscUJBQWEsQ0FBQyxLQUFLLENBQ3BCLENBQUM7WUFFRixTQUFTO1lBQ1QsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGNBQWMsQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUN6QyxNQUFNLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQywyQ0FBMkMsQ0FBQyxDQUFDO1FBQzNFLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHlEQUF5RCxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3ZFLFVBQVU7WUFDVixZQUFZLENBQUMsVUFBVSxDQUFDLGlCQUFpQixDQUFDLEVBQVMsQ0FBQyxDQUFDO1lBRXJELE1BQU07WUFDTixNQUFNLE1BQU0sR0FBRyxNQUFNLFVBQVUsQ0FBQyxjQUFjLENBQzVDLEVBQUUsRUFBRSxFQUFFLHFCQUFhLENBQUMsTUFBTSxFQUFFLEVBQzVCLHFCQUFhLENBQUMsS0FBSyxDQUNwQixDQUFDO1lBRUYsU0FBUztZQUNULE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxjQUFjLENBQUMsU0FBUyxDQUFDLENBQUM7WUFDekMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsdUNBQXVDLENBQUMsQ0FBQztRQUN2RSxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL3VzZXJzL3VzZXJzLmNvbnRyb2xsZXIuc3BlYy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUZXN0LCBUZXN0aW5nTW9kdWxlIH0gZnJvbSAnQG5lc3Rqcy90ZXN0aW5nJztcbmltcG9ydCB7IFxuICBIdHRwRXhjZXB0aW9uLCBcbiAgSHR0cFN0YXR1cywgXG4gIEZvcmJpZGRlbkV4Y2VwdGlvbiwgXG4gIExvZ2dlciBcbn0gZnJvbSAnQG5lc3Rqcy9jb21tb24nO1xuaW1wb3J0IHsgVXNlcnNDb250cm9sbGVyIH0gZnJvbSAnLi91c2Vycy5jb250cm9sbGVyJztcbmltcG9ydCB7IFVzZXJzU2VydmljZSB9IGZyb20gJy4vdXNlcnMuc2VydmljZSc7XG5pbXBvcnQgeyBKd3RBdXRoR3VhcmQgfSBmcm9tICcuLi9hdXRoL2d1YXJkcy9qd3QtYXV0aC5ndWFyZCc7XG5pbXBvcnQgeyBBZG1pbkF1dGhHdWFyZCB9IGZyb20gJy4uL2F1dGgvZ3VhcmRzL2FkbWluLWF1dGguZ3VhcmQnO1xuaW1wb3J0IHsgU3VwYWJhc2VTdG9yYWdlU2VydmljZSB9IGZyb20gJy4uL2NvbW1vbi9zZXJ2aWNlcy9zdXBhYmFzZS1zdG9yYWdlLnNlcnZpY2UnO1xuaW1wb3J0IHsgUm9sZVV0aWxzIH0gZnJvbSAnLi4vdXRpbHMvcm9sZS11dGlscyc7XG5pbXBvcnQgeyBab2RWYWxpZGF0aW9uUGlwZSB9IGZyb20gJy4uL2NvbW1vbi9waXBlcy96b2QtdmFsaWRhdGlvbi5waXBlJztcbmltcG9ydCB7XG4gIFNlY3VyaXR5R3VhcmRUZXN0VXRpbHMsXG4gIFJvbGVCYXNlZFRlc3RVdGlscyxcbn0gZnJvbSAnLi4vdGVzdC11dGlscy9hdXRoLXRlc3RpbmctaGVscGVycyc7XG5pbXBvcnQge1xuICBNb2NrQnVpbGRlcixcbiAgVGVzdERhdGFHZW5lcmF0b3IsXG4gIFRlc3RBc3NlcnRpb25zLFxufSBmcm9tICcuLi90ZXN0LXV0aWxzL2VuaGFuY2VkLXRlc3QtaGVscGVycyc7XG5pbXBvcnQgeyBURVNUX1VTRVJfSURTLCBURVNUX0VNQUlMUyB9IGZyb20gJy4uL3Rlc3QtdXRpbHMvaW5kZXgnO1xuXG5kZXNjcmliZSgnVXNlcnNDb250cm9sbGVyJywgKCkgPT4ge1xuICBsZXQgY29udHJvbGxlcjogVXNlcnNDb250cm9sbGVyO1xuICBsZXQgdXNlcnNTZXJ2aWNlOiBVc2Vyc1NlcnZpY2U7XG4gIGxldCBzdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlOiBTdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlO1xuICBsZXQgcm9sZVV0aWxzOiBSb2xlVXRpbHM7XG4gIGxldCBtb2NrSnd0QXV0aEd1YXJkOiBqZXN0Lk1vY2tlZDxKd3RBdXRoR3VhcmQ+O1xuICBsZXQgbW9ja0FkbWluQXV0aEd1YXJkOiBqZXN0Lk1vY2tlZDxBZG1pbkF1dGhHdWFyZD47XG5cbiAgLy8gVGVzdCBkYXRhIGNvbnN0YW50c1xuICBjb25zdCBtb2NrVXNlciA9IHtcbiAgICBpZDogVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgZW1haWw6IFRFU1RfRU1BSUxTLkNMSUVOVCxcbiAgICBmaXJzdE5hbWU6ICdKb2huJyxcbiAgICBsYXN0TmFtZTogJ0RvZScsXG4gICAgcm9sZTogJ2NsaWVudCcsXG4gICAgYmlvOiAnVXNlciBiaW8nLFxuICAgIGF2YXRhclVybDogJ2h0dHBzOi8vZXhhbXBsZS5jb20vYXZhdGFyLmpwZycsXG4gICAgY292ZXJJbWFnZVVybDogJ2h0dHBzOi8vZXhhbXBsZS5jb20vY292ZXIuanBnJyxcbiAgICBwaG9uZU51bWJlcjogJysxMjM0NTY3ODkwJyxcbiAgICB0aW1lem9uZTogJ0FtZXJpY2EvTmV3X1lvcmsnLFxuICAgIGxhbmd1YWdlOiAnZW4nLFxuICAgIHRoZW1lOiAnbGlnaHQnLFxuICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgZW1haWxWZXJpZmllZDogdHJ1ZSxcbiAgICBwcm9maWxlQ29tcGxldGU6IHRydWUsXG4gICAgaXNBY3RpdmU6IHRydWUsXG4gIH07XG5cbiAgY29uc3QgbW9ja0FkbWluVXNlciA9IHtcbiAgICBpZDogVEVTVF9VU0VSX0lEUy5BRE1JTixcbiAgICBlbWFpbDogVEVTVF9FTUFJTFMuQURNSU4sXG4gICAgZmlyc3ROYW1lOiAnQWRtaW4nLFxuICAgIGxhc3ROYW1lOiAnVXNlcicsXG4gICAgcm9sZTogJ2FkbWluJyxcbiAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgIGVtYWlsVmVyaWZpZWQ6IHRydWUsXG4gICAgcHJvZmlsZUNvbXBsZXRlOiB0cnVlLFxuICAgIGlzQWN0aXZlOiB0cnVlLFxuICB9O1xuXG4gIGNvbnN0IG1vY2tVc2VycyA9IFttb2NrVXNlciwgbW9ja0FkbWluVXNlcl07XG5cbiAgY29uc3QgbW9ja0ZpbGUgPSB7XG4gICAgZmllbGRuYW1lOiAnYXZhdGFyJyxcbiAgICBvcmlnaW5hbG5hbWU6ICdhdmF0YXIuanBnJyxcbiAgICBlbmNvZGluZzogJzdiaXQnLFxuICAgIG1pbWV0eXBlOiAnaW1hZ2UvanBlZycsXG4gICAgc2l6ZTogMTAyNCxcbiAgICBidWZmZXI6IEJ1ZmZlci5mcm9tKCd0ZXN0IGZpbGUgY29udGVudCcpLFxuICB9IGFzIEV4cHJlc3MuTXVsdGVyLkZpbGU7XG5cbiAgY29uc3QgbW9ja1VwbG9hZFJlc3VsdCA9IHtcbiAgICB1cmw6ICdodHRwczovL2V4YW1wbGUuY29tL3VwbG9hZGVkLWF2YXRhci5qcGcnLFxuICAgIGZpbGVuYW1lOiAnYXZhdGFyLmpwZycsXG4gICAgc2l6ZTogMTAyNCxcbiAgfTtcblxuICBiZWZvcmVFYWNoKGFzeW5jICgpID0+IHtcbiAgICAvLyBDcmVhdGUgbW9jayBzZXJ2aWNlc1xuICAgIGNvbnN0IG1vY2tVc2Vyc1NlcnZpY2UgPSB7XG4gICAgICBmaW5kQWxsOiBqZXN0LmZuKCksXG4gICAgICBmaW5kQWxsSW5jbHVkZUluYWN0aXZlOiBqZXN0LmZuKCksXG4gICAgICBmaW5kT25lOiBqZXN0LmZuKCksXG4gICAgICBmaW5kT25lSW5jbHVkZUluYWN0aXZlOiBqZXN0LmZuKCksXG4gICAgICB1cGRhdGU6IGplc3QuZm4oKSxcbiAgICAgIHJlbW92ZTogamVzdC5mbigpLFxuICAgICAgZGVhY3RpdmF0ZTogamVzdC5mbigpLFxuICAgICAgcmVhY3RpdmF0ZTogamVzdC5mbigpLFxuICAgIH07XG5cbiAgICBjb25zdCBtb2NrU3VwYWJhc2VTdG9yYWdlU2VydmljZSA9IHtcbiAgICAgIHZhbGlkYXRlRmlsZTogamVzdC5mbigpLFxuICAgICAgdXBsb2FkRmlsZTogamVzdC5mbigpLFxuICAgICAgZ2V0U3VwcG9ydGVkQnVja2V0czogamVzdC5mbigpLFxuICAgIH07XG5cbiAgICBjb25zdCBtb2NrUm9sZVV0aWxzID0ge1xuICAgICAgaXNVc2VyQWRtaW46IGplc3QuZm4oKSxcbiAgICB9O1xuXG4gICAgbW9ja0p3dEF1dGhHdWFyZCA9IHtcbiAgICAgIGNhbkFjdGl2YXRlOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHRydWUpLFxuICAgIH0gYXMgYW55O1xuXG4gICAgbW9ja0FkbWluQXV0aEd1YXJkID0ge1xuICAgICAgY2FuQWN0aXZhdGU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUodHJ1ZSksXG4gICAgfSBhcyBhbnk7XG5cbiAgICAvLyBBZGQgc3RhdGljIG1ldGhvZCBtb2NrXG4gICAgU3VwYWJhc2VTdG9yYWdlU2VydmljZS5nZXRTdXBwb3J0ZWRCdWNrZXRzID0gamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICBVU0VSX1BST0ZJTEVTOiAndXNlci1wcm9maWxlcycsXG4gICAgfSk7XG5cbiAgICBjb25zdCBtb2R1bGU6IFRlc3RpbmdNb2R1bGUgPSBhd2FpdCBUZXN0LmNyZWF0ZVRlc3RpbmdNb2R1bGUoe1xuICAgICAgY29udHJvbGxlcnM6IFtVc2Vyc0NvbnRyb2xsZXJdLFxuICAgICAgcHJvdmlkZXJzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlOiBVc2Vyc1NlcnZpY2UsXG4gICAgICAgICAgdXNlVmFsdWU6IG1vY2tVc2Vyc1NlcnZpY2UsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlOiBTdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlLFxuICAgICAgICAgIHVzZVZhbHVlOiBtb2NrU3VwYWJhc2VTdG9yYWdlU2VydmljZSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHByb3ZpZGU6IFJvbGVVdGlscyxcbiAgICAgICAgICB1c2VWYWx1ZTogbW9ja1JvbGVVdGlscyxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHByb3ZpZGU6IExvZ2dlcixcbiAgICAgICAgICB1c2VWYWx1ZToge1xuICAgICAgICAgICAgbG9nOiBqZXN0LmZuKCksXG4gICAgICAgICAgICBlcnJvcjogamVzdC5mbigpLFxuICAgICAgICAgICAgd2FybjogamVzdC5mbigpLFxuICAgICAgICAgICAgZGVidWc6IGplc3QuZm4oKSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICB9KVxuICAgICAgLm92ZXJyaWRlR3VhcmQoSnd0QXV0aEd1YXJkKVxuICAgICAgLnVzZVZhbHVlKG1vY2tKd3RBdXRoR3VhcmQpXG4gICAgICAub3ZlcnJpZGVHdWFyZChBZG1pbkF1dGhHdWFyZClcbiAgICAgIC51c2VWYWx1ZShtb2NrQWRtaW5BdXRoR3VhcmQpXG4gICAgICAuY29tcGlsZSgpO1xuXG4gICAgY29udHJvbGxlciA9IG1vZHVsZS5nZXQ8VXNlcnNDb250cm9sbGVyPihVc2Vyc0NvbnRyb2xsZXIpO1xuICAgIHVzZXJzU2VydmljZSA9IG1vZHVsZS5nZXQ8VXNlcnNTZXJ2aWNlPihVc2Vyc1NlcnZpY2UpO1xuICAgIHN1cGFiYXNlU3RvcmFnZVNlcnZpY2UgPSBtb2R1bGUuZ2V0PFN1cGFiYXNlU3RvcmFnZVNlcnZpY2U+KFN1cGFiYXNlU3RvcmFnZVNlcnZpY2UpO1xuICAgIHJvbGVVdGlscyA9IG1vZHVsZS5nZXQ8Um9sZVV0aWxzPihSb2xlVXRpbHMpO1xuICB9KTtcblxuICBhZnRlckVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICB9KTtcblxuICBkZXNjcmliZSgnZmluZEFsbCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiBhbGwgdXNlcnMgZm9yIGFkbWluJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgamVzdC5zcHlPbih1c2Vyc1NlcnZpY2UsICdmaW5kQWxsJykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXJzKTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmZpbmRBbGwoVEVTVF9VU0VSX0lEUy5BRE1JTik7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHVzZXJzU2VydmljZS5maW5kQWxsKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKG1vY2tVc2Vycyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzZXJ2aWNlIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCdEYXRhYmFzZSBlcnJvcicpO1xuICAgICAgamVzdC5zcHlPbih1c2Vyc1NlcnZpY2UsICdmaW5kQWxsJykubW9ja1JlamVjdGVkVmFsdWUoZXJyb3IpO1xuXG4gICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgIGF3YWl0IGV4cGVjdChjb250cm9sbGVyLmZpbmRBbGwoVEVTVF9VU0VSX0lEUy5BRE1JTikpLnJlamVjdHMudG9UaHJvdyhIdHRwRXhjZXB0aW9uKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2ZpbmRBbGxJbmNsdWRlSW5hY3RpdmUnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gYWxsIHVzZXJzIGluY2x1ZGluZyBpbmFjdGl2ZSBmb3IgYWRtaW4nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrVXNlcnMgPSBbXG4gICAgICAgIFRlc3REYXRhR2VuZXJhdG9yLmNyZWF0ZVVzZXIoeyBpc0FjdGl2ZTogdHJ1ZSB9KSxcbiAgICAgICAgVGVzdERhdGFHZW5lcmF0b3IuY3JlYXRlVXNlcih7IGlzQWN0aXZlOiBmYWxzZSB9KSxcbiAgICAgIF07XG5cbiAgICAgIHVzZXJzU2VydmljZS5maW5kQWxsSW5jbHVkZUluYWN0aXZlLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVc2VycyBhcyBhbnkpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmZpbmRBbGxJbmNsdWRlSW5hY3RpdmUoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQURNSU4sXG4gICAgICApO1xuXG4gICAgICBleHBlY3QodXNlcnNTZXJ2aWNlLmZpbmRBbGxJbmNsdWRlSW5hY3RpdmUpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja1VzZXJzKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHNlcnZpY2UgZXJyb3JzIHdoZW4gZmV0Y2hpbmcgYWxsIHVzZXJzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgdXNlcnNTZXJ2aWNlLmZpbmRBbGxJbmNsdWRlSW5hY3RpdmUubW9ja1JlamVjdGVkVmFsdWUoXG4gICAgICAgIG5ldyBFcnJvcignRGF0YWJhc2UgY29ubmVjdGlvbiBmYWlsZWQnKSxcbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5maW5kQWxsSW5jbHVkZUluYWN0aXZlKFRFU1RfVVNFUl9JRFMuQURNSU4pLFxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coSHR0cEV4Y2VwdGlvbik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdmaW5kT25lJywgKCkgPT4ge1xuICAgIGNvbnN0IG1vY2tVc2VyID0gVGVzdERhdGFHZW5lcmF0b3IuY3JlYXRlVXNlcih7IGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCB9KTtcblxuICAgIGl0KCdzaG91bGQgYWxsb3cgdXNlciB0byB2aWV3IHRoZWlyIG93biBwcm9maWxlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKGZhbHNlKTtcbiAgICAgIHVzZXJzU2VydmljZS5maW5kT25lLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVc2VyIGFzIGFueSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZmluZE9uZShcbiAgICAgICAgeyBpZDogVEVTVF9VU0VSX0lEUy5DTElFTlQgfSxcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICApO1xuXG4gICAgICBleHBlY3Qocm9sZVV0aWxzLmlzVXNlckFkbWluKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChURVNUX1VTRVJfSURTLkNMSUVOVCk7XG4gICAgICBleHBlY3QodXNlcnNTZXJ2aWNlLmZpbmRPbmUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFRFU1RfVVNFUl9JRFMuQ0xJRU5UKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja1VzZXIpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhbGxvdyBhZG1pbiB0byB2aWV3IGFueSB1c2VyIHByb2ZpbGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUodHJ1ZSk7XG4gICAgICB1c2Vyc1NlcnZpY2UuZmluZE9uZUluY2x1ZGVJbmFjdGl2ZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXNlciBhcyBhbnkpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmZpbmRPbmUoXG4gICAgICAgIHsgaWQ6IFRFU1RfVVNFUl9JRFMuQ0xJRU5UIH0sXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQURNSU4sXG4gICAgICApO1xuXG4gICAgICBleHBlY3Qocm9sZVV0aWxzLmlzVXNlckFkbWluKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChURVNUX1VTRVJfSURTLkFETUlOKTtcbiAgICAgIGV4cGVjdCh1c2Vyc1NlcnZpY2UuZmluZE9uZUluY2x1ZGVJbmFjdGl2ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja1VzZXIpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0aHJvdyBGb3JiaWRkZW5FeGNlcHRpb24gd2hlbiBub24tYWRtaW4gdHJpZXMgdG8gdmlldyBvdGhlciB1c2VyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKGZhbHNlKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLmZpbmRPbmUoeyBpZDogVEVTVF9VU0VSX0lEUy5USEVSQVBJU1QgfSwgVEVTVF9VU0VSX0lEUy5DTElFTlQpLFxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coRm9yYmlkZGVuRXhjZXB0aW9uKTtcblxuICAgICAgZXhwZWN0KHVzZXJzU2VydmljZS5maW5kT25lKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0aHJvdyBIdHRwRXhjZXB0aW9uIHdoZW4gdXNlciBub3QgZm91bmQnLCBhc3luYyAoKSA9PiB7XG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoZmFsc2UpO1xuICAgICAgdXNlcnNTZXJ2aWNlLmZpbmRPbmUubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5maW5kT25lKHsgaWQ6IFRFU1RfVVNFUl9JRFMuQ0xJRU5UIH0sIFRFU1RfVVNFUl9JRFMuQ0xJRU5UKSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KEh0dHBFeGNlcHRpb24pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgndXBkYXRlJywgKCkgPT4ge1xuICAgIGNvbnN0IHVwZGF0ZURhdGEgPSB7XG4gICAgICBmaXJzdE5hbWU6ICdVcGRhdGVkJyxcbiAgICAgIGxhc3ROYW1lOiAnTmFtZScsXG4gICAgICBiaW86ICdVcGRhdGVkIGJpbycsXG4gICAgfTtcblxuICAgIGl0KCdzaG91bGQgYWxsb3cgdXNlciB0byB1cGRhdGUgdGhlaXIgb3duIHByb2ZpbGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB1cGRhdGVkVXNlciA9IHsgLi4uVGVzdERhdGFHZW5lcmF0b3IuY3JlYXRlVXNlcigpLCAuLi51cGRhdGVEYXRhIH07XG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoZmFsc2UpO1xuICAgICAgdXNlcnNTZXJ2aWNlLnVwZGF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh1cGRhdGVkVXNlciBhcyBhbnkpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLnVwZGF0ZShcbiAgICAgICAgeyBpZDogVEVTVF9VU0VSX0lEUy5DTElFTlQgfSxcbiAgICAgICAgdXBkYXRlRGF0YSxcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICApO1xuXG4gICAgICBleHBlY3Qocm9sZVV0aWxzLmlzVXNlckFkbWluKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChURVNUX1VTRVJfSURTLkNMSUVOVCk7XG4gICAgICBleHBlY3QodXNlcnNTZXJ2aWNlLnVwZGF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICB1cGRhdGVEYXRhLFxuICAgICAgKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwodXBkYXRlZFVzZXIpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhbGxvdyBhZG1pbiB0byB1cGRhdGUgYW55IHVzZXIgd2l0aCBhbGwgZmllbGRzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgYWRtaW5VcGRhdGVEYXRhID0ge1xuICAgICAgICBmaXJzdE5hbWU6ICdBZG1pbiBVcGRhdGVkJyxcbiAgICAgICAgcm9sZTogJ21vZGVyYXRvcicsXG4gICAgICAgIGlzQWN0aXZlOiBmYWxzZSxcbiAgICAgIH07XG4gICAgICBjb25zdCB1cGRhdGVkVXNlciA9IHtcbiAgICAgICAgLi4uVGVzdERhdGFHZW5lcmF0b3IuY3JlYXRlVXNlcigpLFxuICAgICAgICAuLi5hZG1pblVwZGF0ZURhdGEsXG4gICAgICB9O1xuXG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUodHJ1ZSk7XG4gICAgICB1c2Vyc1NlcnZpY2UudXBkYXRlLm1vY2tSZXNvbHZlZFZhbHVlKHVwZGF0ZWRVc2VyIGFzIGFueSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIudXBkYXRlKFxuICAgICAgICB7IGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCB9LFxuICAgICAgICBhZG1pblVwZGF0ZURhdGEsXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQURNSU4sXG4gICAgICApO1xuXG4gICAgICBleHBlY3QodXNlcnNTZXJ2aWNlLnVwZGF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICBhZG1pblVwZGF0ZURhdGEsXG4gICAgICApO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh1cGRhdGVkVXNlcik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHNhbml0aXplIG5vbi1hZG1pbiB1cGRhdGVzIHRvIGFsbG93ZWQgZmllbGRzIG9ubHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB1bmF1dGhvcml6ZWREYXRhID0ge1xuICAgICAgICBmaXJzdE5hbWU6ICdKb2huJyxcbiAgICAgICAgcm9sZTogJ2FkbWluJywgLy8gU2hvdWxkIGJlIGZpbHRlcmVkIG91dFxuICAgICAgICBpc0FjdGl2ZTogZmFsc2UsIC8vIFNob3VsZCBiZSBmaWx0ZXJlZCBvdXRcbiAgICAgICAgYmlvOiAnTmV3IGJpbycsXG4gICAgICB9O1xuICAgICAgY29uc3Qgc2FuaXRpemVkRGF0YSA9IHtcbiAgICAgICAgZmlyc3ROYW1lOiAnSm9obicsXG4gICAgICAgIGJpbzogJ05ldyBiaW8nLFxuICAgICAgfTtcbiAgICAgIGNvbnN0IHVwZGF0ZWRVc2VyID0ge1xuICAgICAgICAuLi5UZXN0RGF0YUdlbmVyYXRvci5jcmVhdGVVc2VyKCksXG4gICAgICAgIC4uLnNhbml0aXplZERhdGEsXG4gICAgICB9O1xuXG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoZmFsc2UpO1xuICAgICAgdXNlcnNTZXJ2aWNlLnVwZGF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh1cGRhdGVkVXNlciBhcyBhbnkpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLnVwZGF0ZShcbiAgICAgICAgeyBpZDogVEVTVF9VU0VSX0lEUy5DTElFTlQgfSxcbiAgICAgICAgdW5hdXRob3JpemVkRGF0YSxcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICApO1xuXG4gICAgICBleHBlY3QodXNlcnNTZXJ2aWNlLnVwZGF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICBzYW5pdGl6ZWREYXRhLFxuICAgICAgKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwodXBkYXRlZFVzZXIpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0aHJvdyBGb3JiaWRkZW5FeGNlcHRpb24gd2hlbiBub24tYWRtaW4gdHJpZXMgdG8gdXBkYXRlIG90aGVyIHVzZXInLCBhc3luYyAoKSA9PiB7XG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoZmFsc2UpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIudXBkYXRlKFxuICAgICAgICAgIHsgaWQ6IFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNUIH0sXG4gICAgICAgICAgdXBkYXRlRGF0YSxcbiAgICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgKSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KEZvcmJpZGRlbkV4Y2VwdGlvbik7XG5cbiAgICAgIGV4cGVjdCh1c2Vyc1NlcnZpY2UudXBkYXRlKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgncmVtb3ZlJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgYWxsb3cgdXNlciB0byBkZWFjdGl2YXRlIHRoZWlyIG93biBhY2NvdW50JywgYXN5bmMgKCkgPT4ge1xuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKGZhbHNlKTtcbiAgICAgIHVzZXJzU2VydmljZS5yZW1vdmUubW9ja1Jlc29sdmVkVmFsdWUoe30gYXMgYW55KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5yZW1vdmUoXG4gICAgICAgIHsgaWQ6IFRFU1RfVVNFUl9JRFMuQ0xJRU5UIH0sXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHJvbGVVdGlscy5pc1VzZXJBZG1pbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoVEVTVF9VU0VSX0lEUy5DTElFTlQpO1xuICAgICAgZXhwZWN0KHVzZXJzU2VydmljZS5yZW1vdmUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFRFU1RfVVNFUl9JRFMuQ0xJRU5UKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoe1xuICAgICAgICBtZXNzYWdlOiAnVXNlciBhY2NvdW50IGRlYWN0aXZhdGVkIHN1Y2Nlc3NmdWxseScsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYWxsb3cgYWRtaW4gdG8gZGVhY3RpdmF0ZSBhbnkgdXNlciBhY2NvdW50JywgYXN5bmMgKCkgPT4ge1xuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKHRydWUpO1xuICAgICAgdXNlcnNTZXJ2aWNlLnJlbW92ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7fSBhcyBhbnkpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLnJlbW92ZShcbiAgICAgICAgeyBpZDogVEVTVF9VU0VSX0lEUy5DTElFTlQgfSxcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5BRE1JTixcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdCh1c2Vyc1NlcnZpY2UucmVtb3ZlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChURVNUX1VTRVJfSURTLkNMSUVOVCk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHtcbiAgICAgICAgbWVzc2FnZTogJ1VzZXIgYWNjb3VudCBkZWFjdGl2YXRlZCBzdWNjZXNzZnVsbHknLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IEZvcmJpZGRlbkV4Y2VwdGlvbiB3aGVuIG5vbi1hZG1pbiB0cmllcyB0byBkZWFjdGl2YXRlIG90aGVyIHVzZXInLCBhc3luYyAoKSA9PiB7XG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoZmFsc2UpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIucmVtb3ZlKHsgaWQ6IFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNUIH0sIFRFU1RfVVNFUl9JRFMuQ0xJRU5UKSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KEZvcmJpZGRlbkV4Y2VwdGlvbik7XG5cbiAgICAgIGV4cGVjdCh1c2Vyc1NlcnZpY2UucmVtb3ZlKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZGVhY3RpdmF0ZVVzZXIgKGFkbWluIG9ubHkpJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgYWxsb3cgYWRtaW4gdG8gZGVhY3RpdmF0ZSB1c2VyIHdpdGggcmVhc29uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZGVhY3RpdmF0aW9uQm9keSA9IHsgcmVhc29uOiAnUG9saWN5IHZpb2xhdGlvbicgfTtcbiAgICAgIHVzZXJzU2VydmljZS5kZWFjdGl2YXRlLm1vY2tSZXNvbHZlZFZhbHVlKHt9IGFzIGFueSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZGVhY3RpdmF0ZVVzZXIoXG4gICAgICAgIHsgaWQ6IFRFU1RfVVNFUl9JRFMuQ0xJRU5UIH0sXG4gICAgICAgIGRlYWN0aXZhdGlvbkJvZHksXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQURNSU4sXG4gICAgICApO1xuXG4gICAgICBleHBlY3QodXNlcnNTZXJ2aWNlLmRlYWN0aXZhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgJ1BvbGljeSB2aW9sYXRpb24nLFxuICAgICAgICBURVNUX1VTRVJfSURTLkFETUlOLFxuICAgICAgKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoe1xuICAgICAgICBtZXNzYWdlOiAnVXNlciBhY2NvdW50IGRlYWN0aXZhdGVkIGJ5IGFkbWluaXN0cmF0b3InLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBkZWFjdGl2YXRpb24gd2l0aG91dCByZWFzb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBkZWFjdGl2YXRpb25Cb2R5ID0ge307XG4gICAgICB1c2Vyc1NlcnZpY2UuZGVhY3RpdmF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7fSBhcyBhbnkpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmRlYWN0aXZhdGVVc2VyKFxuICAgICAgICB7IGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCB9LFxuICAgICAgICBkZWFjdGl2YXRpb25Cb2R5LFxuICAgICAgICBURVNUX1VTRVJfSURTLkFETUlOLFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHVzZXJzU2VydmljZS5kZWFjdGl2YXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5BRE1JTixcbiAgICAgICk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHtcbiAgICAgICAgbWVzc2FnZTogJ1VzZXIgYWNjb3VudCBkZWFjdGl2YXRlZCBieSBhZG1pbmlzdHJhdG9yJyxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2VydmljZSBlcnJvcnMgZHVyaW5nIGRlYWN0aXZhdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGRlYWN0aXZhdGlvbkJvZHkgPSB7IHJlYXNvbjogJ1Rlc3QgcmVhc29uJyB9O1xuICAgICAgdXNlcnNTZXJ2aWNlLmRlYWN0aXZhdGUubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdTZXJ2aWNlIGVycm9yJykpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIuZGVhY3RpdmF0ZVVzZXIoXG4gICAgICAgICAgeyBpZDogVEVTVF9VU0VSX0lEUy5DTElFTlQgfSxcbiAgICAgICAgICBkZWFjdGl2YXRpb25Cb2R5LFxuICAgICAgICAgIFRFU1RfVVNFUl9JRFMuQURNSU4sXG4gICAgICAgICksXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhIdHRwRXhjZXB0aW9uKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3JlYWN0aXZhdGVVc2VyIChhZG1pbiBvbmx5KScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGFsbG93IGFkbWluIHRvIHJlYWN0aXZhdGUgdXNlcicsIGFzeW5jICgpID0+IHtcbiAgICAgIHVzZXJzU2VydmljZS5yZWFjdGl2YXRlLm1vY2tSZXNvbHZlZFZhbHVlKHt9IGFzIGFueSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIucmVhY3RpdmF0ZVVzZXIoXG4gICAgICAgIHsgaWQ6IFRFU1RfVVNFUl9JRFMuQ0xJRU5UIH0sXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQURNSU4sXG4gICAgICApO1xuXG4gICAgICBleHBlY3QodXNlcnNTZXJ2aWNlLnJlYWN0aXZhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHtcbiAgICAgICAgbWVzc2FnZTogJ1VzZXIgYWNjb3VudCByZWFjdGl2YXRlZCBzdWNjZXNzZnVsbHknLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzZXJ2aWNlIGVycm9ycyBkdXJpbmcgcmVhY3RpdmF0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgdXNlcnNTZXJ2aWNlLnJlYWN0aXZhdGUubW9ja1JlamVjdGVkVmFsdWUoXG4gICAgICAgIG5ldyBFcnJvcignUmVhY3RpdmF0aW9uIGZhaWxlZCcpLFxuICAgICAgKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLnJlYWN0aXZhdGVVc2VyKHsgaWQ6IFRFU1RfVVNFUl9JRFMuQ0xJRU5UIH0sIFRFU1RfVVNFUl9JRFMuQURNSU4pLFxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coSHR0cEV4Y2VwdGlvbik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdlcnJvciBoYW5kbGluZycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHByZXNlcnZlIEZvcmJpZGRlbkV4Y2VwdGlvbiBmcm9tIHNlcnZpY2UgbGF5ZXInLCBhc3luYyAoKSA9PiB7XG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUodHJ1ZSk7XG4gICAgICB1c2Vyc1NlcnZpY2UuZmluZE9uZUluY2x1ZGVJbmFjdGl2ZS5tb2NrUmVqZWN0ZWRWYWx1ZShcbiAgICAgICAgbmV3IEZvcmJpZGRlbkV4Y2VwdGlvbignQWNjZXNzIGRlbmllZCcpLFxuICAgICAgKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLmZpbmRPbmUoeyBpZDogVEVTVF9VU0VSX0lEUy5DTElFTlQgfSwgVEVTVF9VU0VSX0lEUy5BRE1JTiksXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhGb3JiaWRkZW5FeGNlcHRpb24pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB3cmFwIGdlbmVyaWMgZXJyb3JzIGluIEh0dHBFeGNlcHRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoZmFsc2UpO1xuICAgICAgdXNlcnNTZXJ2aWNlLmZpbmRPbmUubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdHZW5lcmljIGVycm9yJykpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIuZmluZE9uZSh7IGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCB9LCBURVNUX1VTRVJfSURTLkNMSUVOVCksXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhIdHRwRXhjZXB0aW9uKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHJvbGUgdXRpbHMgZXJyb3JzIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdSb2xlIGNoZWNrIGZhaWxlZCcpKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLmZpbmRPbmUoeyBpZDogVEVTVF9VU0VSX0lEUy5DTElFTlQgfSwgVEVTVF9VU0VSX0lEUy5DTElFTlQpLFxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coSHR0cEV4Y2VwdGlvbik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdhdXRob3JpemF0aW9uIGVkZ2UgY2FzZXMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgdXBkYXRlIGRhdGEgZm9yIG5vbi1hZG1pbicsIGFzeW5jICgpID0+IHtcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7XG4gICAgICB1c2Vyc1NlcnZpY2UudXBkYXRlLm1vY2tSZXNvbHZlZFZhbHVlKFxuICAgICAgICBUZXN0RGF0YUdlbmVyYXRvci5jcmVhdGVVc2VyKCkgYXMgYW55LFxuICAgICAgKTtcblxuICAgICAgYXdhaXQgY29udHJvbGxlci51cGRhdGUoeyBpZDogVEVTVF9VU0VSX0lEUy5DTElFTlQgfSwge30sIFRFU1RfVVNFUl9JRFMuQ0xJRU5UKTtcblxuICAgICAgZXhwZWN0KHVzZXJzU2VydmljZS51cGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAge30sXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbWl4ZWQgYWxsb3dlZCBhbmQgZGlzYWxsb3dlZCBmaWVsZHMgZm9yIG5vbi1hZG1pbicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1peGVkRGF0YSA9IHtcbiAgICAgICAgZmlyc3ROYW1lOiAnSm9obicsIC8vIEFsbG93ZWRcbiAgICAgICAgbGFzdE5hbWU6ICdEb2UnLCAvLyBBbGxvd2VkXG4gICAgICAgIHJvbGU6ICdhZG1pbicsIC8vIE5vdCBhbGxvd2VkXG4gICAgICAgIGJpbzogJ05ldyBiaW8nLCAvLyBBbGxvd2VkXG4gICAgICAgIGlzQWN0aXZlOiBmYWxzZSwgLy8gTm90IGFsbG93ZWRcbiAgICAgICAgYXZhdGFyVXJsOiAnaHR0cDovL2V4YW1wbGUuY29tL2F2YXRhci5qcGcnLCAvLyBBbGxvd2VkXG4gICAgICB9O1xuICAgICAgY29uc3QgZXhwZWN0ZWRTYW5pdGl6ZWREYXRhID0ge1xuICAgICAgICBmaXJzdE5hbWU6ICdKb2huJyxcbiAgICAgICAgbGFzdE5hbWU6ICdEb2UnLFxuICAgICAgICBiaW86ICdOZXcgYmlvJyxcbiAgICAgICAgYXZhdGFyVXJsOiAnaHR0cDovL2V4YW1wbGUuY29tL2F2YXRhci5qcGcnLFxuICAgICAgfTtcblxuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKGZhbHNlKTtcbiAgICAgIHVzZXJzU2VydmljZS51cGRhdGUubW9ja1Jlc29sdmVkVmFsdWUoXG4gICAgICAgIFRlc3REYXRhR2VuZXJhdG9yLmNyZWF0ZVVzZXIoKSBhcyBhbnksXG4gICAgICApO1xuXG4gICAgICBhd2FpdCBjb250cm9sbGVyLnVwZGF0ZShcbiAgICAgICAgeyBpZDogVEVTVF9VU0VSX0lEUy5DTElFTlQgfSxcbiAgICAgICAgbWl4ZWREYXRhLFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdCh1c2Vyc1NlcnZpY2UudXBkYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgIGV4cGVjdGVkU2FuaXRpemVkRGF0YSxcbiAgICAgICk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdGaWxlIFVwbG9hZCBJbnRlZ3JhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBhdmF0YXIgdXBsb2FkIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IG1vY2tGaWxlcyA9IHtcbiAgICAgICAgYXZhdGFyOiBbbW9ja0ZpbGVdLFxuICAgICAgfTtcbiAgICAgIGNvbnN0IHVwZGF0ZURhdGEgPSB7XG4gICAgICAgIGZpcnN0TmFtZTogJ0pvaG4nLFxuICAgICAgICBsYXN0TmFtZTogJ0RvZScsXG4gICAgICB9O1xuXG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoZmFsc2UpO1xuICAgICAgc3VwYWJhc2VTdG9yYWdlU2VydmljZS52YWxpZGF0ZUZpbGUubW9ja1JldHVyblZhbHVlKHsgaXNWYWxpZDogdHJ1ZSB9KTtcbiAgICAgIHN1cGFiYXNlU3RvcmFnZVNlcnZpY2UudXBsb2FkRmlsZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXBsb2FkUmVzdWx0KTtcbiAgICAgIHVzZXJzU2VydmljZS51cGRhdGUubW9ja1Jlc29sdmVkVmFsdWUoXG4gICAgICAgIFRlc3REYXRhR2VuZXJhdG9yLmNyZWF0ZVVzZXIoKSBhcyBhbnksXG4gICAgICApO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGF3YWl0IGNvbnRyb2xsZXIudXBkYXRlKFxuICAgICAgICB7IGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCB9LFxuICAgICAgICB1cGRhdGVEYXRhLFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgbW9ja0ZpbGVzLFxuICAgICAgKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3Qoc3VwYWJhc2VTdG9yYWdlU2VydmljZS52YWxpZGF0ZUZpbGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKG1vY2tGaWxlKTtcbiAgICAgIGV4cGVjdChzdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlLnVwbG9hZEZpbGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBtb2NrRmlsZSxcbiAgICAgICAgJ3VzZXItcHJvZmlsZXMnLFxuICAgICAgKTtcbiAgICAgIGV4cGVjdCh1c2Vyc1NlcnZpY2UudXBkYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgIHtcbiAgICAgICAgICAuLi51cGRhdGVEYXRhLFxuICAgICAgICAgIGF2YXRhclVybDogbW9ja1VwbG9hZFJlc3VsdC51cmwsXG4gICAgICAgIH0sXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgY292ZXIgaW1hZ2UgdXBsb2FkIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IG1vY2tDb3ZlckZpbGUgPSB7XG4gICAgICAgIC4uLm1vY2tGaWxlLFxuICAgICAgICBmaWVsZG5hbWU6ICdjb3ZlcicsXG4gICAgICAgIG9yaWdpbmFsbmFtZTogJ2NvdmVyLmpwZycsXG4gICAgICB9O1xuICAgICAgY29uc3QgbW9ja0ZpbGVzID0ge1xuICAgICAgICBjb3ZlcjogW21vY2tDb3ZlckZpbGVdLFxuICAgICAgfTtcbiAgICAgIGNvbnN0IHVwZGF0ZURhdGEgPSB7XG4gICAgICAgIGZpcnN0TmFtZTogJ0pvaG4nLFxuICAgICAgICBsYXN0TmFtZTogJ0RvZScsXG4gICAgICB9O1xuXG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoZmFsc2UpO1xuICAgICAgc3VwYWJhc2VTdG9yYWdlU2VydmljZS52YWxpZGF0ZUZpbGUubW9ja1JldHVyblZhbHVlKHsgaXNWYWxpZDogdHJ1ZSB9KTtcbiAgICAgIHN1cGFiYXNlU3RvcmFnZVNlcnZpY2UudXBsb2FkRmlsZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXBsb2FkUmVzdWx0KTtcbiAgICAgIHVzZXJzU2VydmljZS51cGRhdGUubW9ja1Jlc29sdmVkVmFsdWUoXG4gICAgICAgIFRlc3REYXRhR2VuZXJhdG9yLmNyZWF0ZVVzZXIoKSBhcyBhbnksXG4gICAgICApO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGF3YWl0IGNvbnRyb2xsZXIudXBkYXRlKFxuICAgICAgICB7IGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCB9LFxuICAgICAgICB1cGRhdGVEYXRhLFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgbW9ja0ZpbGVzLFxuICAgICAgKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3Qoc3VwYWJhc2VTdG9yYWdlU2VydmljZS52YWxpZGF0ZUZpbGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKG1vY2tDb3ZlckZpbGUpO1xuICAgICAgZXhwZWN0KHN1cGFiYXNlU3RvcmFnZVNlcnZpY2UudXBsb2FkRmlsZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIG1vY2tDb3ZlckZpbGUsXG4gICAgICAgICd1c2VyLXByb2ZpbGVzJyxcbiAgICAgICk7XG4gICAgICBleHBlY3QodXNlcnNTZXJ2aWNlLnVwZGF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICB7XG4gICAgICAgICAgLi4udXBkYXRlRGF0YSxcbiAgICAgICAgICBjb3ZlckltYWdlVXJsOiBtb2NrVXBsb2FkUmVzdWx0LnVybCxcbiAgICAgICAgfSxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBtdWx0aXBsZSBmaWxlIHVwbG9hZHMgc2ltdWx0YW5lb3VzbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBtb2NrQ292ZXJGaWxlID0ge1xuICAgICAgICAuLi5tb2NrRmlsZSxcbiAgICAgICAgZmllbGRuYW1lOiAnY292ZXInLFxuICAgICAgICBvcmlnaW5hbG5hbWU6ICdjb3Zlci5qcGcnLFxuICAgICAgfTtcbiAgICAgIGNvbnN0IG1vY2tGaWxlcyA9IHtcbiAgICAgICAgYXZhdGFyOiBbbW9ja0ZpbGVdLFxuICAgICAgICBjb3ZlcjogW21vY2tDb3ZlckZpbGVdLFxuICAgICAgfTtcbiAgICAgIGNvbnN0IHVwZGF0ZURhdGEgPSB7XG4gICAgICAgIGZpcnN0TmFtZTogJ0pvaG4nLFxuICAgICAgICBsYXN0TmFtZTogJ0RvZScsXG4gICAgICB9O1xuXG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoZmFsc2UpO1xuICAgICAgc3VwYWJhc2VTdG9yYWdlU2VydmljZS52YWxpZGF0ZUZpbGUubW9ja1JldHVyblZhbHVlKHsgaXNWYWxpZDogdHJ1ZSB9KTtcbiAgICAgIHN1cGFiYXNlU3RvcmFnZVNlcnZpY2UudXBsb2FkRmlsZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXBsb2FkUmVzdWx0KTtcbiAgICAgIHVzZXJzU2VydmljZS51cGRhdGUubW9ja1Jlc29sdmVkVmFsdWUoXG4gICAgICAgIFRlc3REYXRhR2VuZXJhdG9yLmNyZWF0ZVVzZXIoKSBhcyBhbnksXG4gICAgICApO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGF3YWl0IGNvbnRyb2xsZXIudXBkYXRlKFxuICAgICAgICB7IGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCB9LFxuICAgICAgICB1cGRhdGVEYXRhLFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgbW9ja0ZpbGVzLFxuICAgICAgKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3Qoc3VwYWJhc2VTdG9yYWdlU2VydmljZS52YWxpZGF0ZUZpbGUpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygyKTtcbiAgICAgIGV4cGVjdChzdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlLnVwbG9hZEZpbGUpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygyKTtcbiAgICAgIGV4cGVjdCh1c2Vyc1NlcnZpY2UudXBkYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgIHtcbiAgICAgICAgICAuLi51cGRhdGVEYXRhLFxuICAgICAgICAgIGF2YXRhclVybDogbW9ja1VwbG9hZFJlc3VsdC51cmwsXG4gICAgICAgICAgY292ZXJJbWFnZVVybDogbW9ja1VwbG9hZFJlc3VsdC51cmwsXG4gICAgICAgIH0sXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZmlsZSB2YWxpZGF0aW9uIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IG1vY2tGaWxlcyA9IHtcbiAgICAgICAgYXZhdGFyOiBbbW9ja0ZpbGVdLFxuICAgICAgfTtcbiAgICAgIGNvbnN0IHVwZGF0ZURhdGEgPSB7XG4gICAgICAgIGZpcnN0TmFtZTogJ0pvaG4nLFxuICAgICAgICBsYXN0TmFtZTogJ0RvZScsXG4gICAgICB9O1xuXG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoZmFsc2UpO1xuICAgICAgc3VwYWJhc2VTdG9yYWdlU2VydmljZS52YWxpZGF0ZUZpbGUubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgaXNWYWxpZDogZmFsc2UsXG4gICAgICAgIGVycm9yOiAnRmlsZSB0b28gbGFyZ2UnLFxuICAgICAgfSk7XG5cbiAgICAgIC8vIEFjdCAmIEFzc2VydFxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLnVwZGF0ZShcbiAgICAgICAgICB7IGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCB9LFxuICAgICAgICAgIHVwZGF0ZURhdGEsXG4gICAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgICAgbW9ja0ZpbGVzLFxuICAgICAgICApLFxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coJ0F2YXRhciB2YWxpZGF0aW9uIGZhaWxlZDogRmlsZSB0b28gbGFyZ2UnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGZpbGUgdXBsb2FkIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IG1vY2tGaWxlcyA9IHtcbiAgICAgICAgYXZhdGFyOiBbbW9ja0ZpbGVdLFxuICAgICAgfTtcbiAgICAgIGNvbnN0IHVwZGF0ZURhdGEgPSB7XG4gICAgICAgIGZpcnN0TmFtZTogJ0pvaG4nLFxuICAgICAgICBsYXN0TmFtZTogJ0RvZScsXG4gICAgICB9O1xuXG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoZmFsc2UpO1xuICAgICAgc3VwYWJhc2VTdG9yYWdlU2VydmljZS52YWxpZGF0ZUZpbGUubW9ja1JldHVyblZhbHVlKHsgaXNWYWxpZDogdHJ1ZSB9KTtcbiAgICAgIHN1cGFiYXNlU3RvcmFnZVNlcnZpY2UudXBsb2FkRmlsZS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ1VwbG9hZCBmYWlsZWQnKSk7XG5cbiAgICAgIC8vIEFjdCAmIEFzc2VydFxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLnVwZGF0ZShcbiAgICAgICAgICB7IGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCB9LFxuICAgICAgICAgIHVwZGF0ZURhdGEsXG4gICAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgICAgbW9ja0ZpbGVzLFxuICAgICAgICApLFxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coJ0ZhaWxlZCB0byB1cGRhdGUgdXNlcjogVXBsb2FkIGZhaWxlZCcpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnU2VjdXJpdHkgVGVzdHMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBpbnB1dCBkYXRhIHRocm91Z2ggWm9kVmFsaWRhdGlvblBpcGUnLCAoKSA9PiB7XG4gICAgICAvLyBUaGlzIHRlc3RzIHRoYXQgdGhlIGNvbnRyb2xsZXIgdXNlcyBwcm9wZXIgdmFsaWRhdGlvblxuICAgICAgY29uc3QgdmFsaWRhdGlvblBpcGUgPSBuZXcgWm9kVmFsaWRhdGlvblBpcGUoe30gYXMgYW55KTtcbiAgICAgIGV4cGVjdCh2YWxpZGF0aW9uUGlwZSkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVxdWlyZSBhdXRoZW50aWNhdGlvbiBmb3IgYWxsIGVuZHBvaW50cycsICgpID0+IHtcbiAgICAgIC8vIFRlc3QgdGhhdCBhbGwgZW5kcG9pbnRzIGhhdmUgSnd0QXV0aEd1YXJkXG4gICAgICBjb25zdCBwcm90ZWN0ZWRNZXRob2RzID0gWydmaW5kQWxsJywgJ2ZpbmRBbGxJbmNsdWRlSW5hY3RpdmUnLCAnZmluZE9uZScsICd1cGRhdGUnLCAncmVtb3ZlJywgJ2RlYWN0aXZhdGVVc2VyJywgJ3JlYWN0aXZhdGVVc2VyJ107XG4gICAgICBcbiAgICAgIHByb3RlY3RlZE1ldGhvZHMuZm9yRWFjaChtZXRob2QgPT4ge1xuICAgICAgICBjb25zdCBndWFyZHMgPSBSZWZsZWN0LmdldE1ldGFkYXRhKCdfX2d1YXJkc19fJywgVXNlcnNDb250cm9sbGVyLnByb3RvdHlwZVttZXRob2QgYXMga2V5b2YgVXNlcnNDb250cm9sbGVyXSk7XG4gICAgICAgIGV4cGVjdChndWFyZHMpLnRvQmVEZWZpbmVkKCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZW5mb3JjZSBhZG1pbi1vbmx5IGFjY2VzcyBmb3IgYWRtaW4gZW5kcG9pbnRzJywgKCkgPT4ge1xuICAgICAgLy8gVGVzdCB0aGF0IGFkbWluIGVuZHBvaW50cyBoYXZlIEFkbWluQXV0aEd1YXJkXG4gICAgICBjb25zdCBhZG1pbk1ldGhvZHMgPSBbJ2ZpbmRBbGwnLCAnZmluZEFsbEluY2x1ZGVJbmFjdGl2ZScsICdkZWFjdGl2YXRlVXNlcicsICdyZWFjdGl2YXRlVXNlciddO1xuICAgICAgXG4gICAgICBhZG1pbk1ldGhvZHMuZm9yRWFjaChtZXRob2QgPT4ge1xuICAgICAgICBjb25zdCBndWFyZHMgPSBSZWZsZWN0LmdldE1ldGFkYXRhKCdfX2d1YXJkc19fJywgY29udHJvbGxlclttZXRob2QgYXMga2V5b2YgVXNlcnNDb250cm9sbGVyXSk7XG4gICAgICAgIGV4cGVjdChndWFyZHMpLnRvQmVEZWZpbmVkKCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIEpXVCB0b2tlbiB2YWxpZGF0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gVGVzdCB0aGF0IEpXVCBndWFyZCBpcyBwcm9wZXJseSBhcHBsaWVkXG4gICAgICBtb2NrSnd0QXV0aEd1YXJkLmNhbkFjdGl2YXRlLm1vY2tSZXR1cm5WYWx1ZShmYWxzZSk7XG4gICAgICBcbiAgICAgIC8vIE1vY2sgdGhlIGFjdHVhbCBIVFRQIGV4Y2VwdGlvbiB0aGF0IHdvdWxkIGJlIHRocm93blxuICAgICAgY29uc3QgdW5hdXRob3JpemVkRXJyb3IgPSBuZXcgRXJyb3IoJ1VuYXV0aG9yaXplZCcpO1xuICAgICAgdXNlcnNTZXJ2aWNlLmZpbmRBbGwubW9ja1JlamVjdGVkVmFsdWUodW5hdXRob3JpemVkRXJyb3IpO1xuICAgICAgXG4gICAgICBhd2FpdCBleHBlY3QoY29udHJvbGxlci5maW5kQWxsKFRFU1RfVVNFUl9JRFMuQURNSU4pKS5yZWplY3RzLnRvVGhyb3coKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGFkbWluIGF1dGhvcml6YXRpb24gdmFsaWRhdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFRlc3QgdGhhdCBhZG1pbiBndWFyZCBpcyBwcm9wZXJseSBhcHBsaWVkXG4gICAgICBtb2NrQWRtaW5BdXRoR3VhcmQuY2FuQWN0aXZhdGUubW9ja1JldHVyblZhbHVlKGZhbHNlKTtcbiAgICAgIFxuICAgICAgLy8gTW9jayB0aGUgYWN0dWFsIEhUVFAgZXhjZXB0aW9uIHRoYXQgd291bGQgYmUgdGhyb3duXG4gICAgICBjb25zdCBmb3JiaWRkZW5FcnJvciA9IG5ldyBFcnJvcignRm9yYmlkZGVuJyk7XG4gICAgICB1c2Vyc1NlcnZpY2UuZmluZEFsbC5tb2NrUmVqZWN0ZWRWYWx1ZShmb3JiaWRkZW5FcnJvcik7XG4gICAgICBcbiAgICAgIGF3YWl0IGV4cGVjdChjb250cm9sbGVyLmZpbmRBbGwoVEVTVF9VU0VSX0lEUy5BRE1JTikpLnJlamVjdHMudG9UaHJvdygpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBwcmV2ZW50IHVuYXV0aG9yaXplZCBhY2Nlc3MgdG8gb3RoZXIgdXNlciBwcm9maWxlcycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFRlc3QgdGhhdCB1c2VycyBjYW4gb25seSBhY2Nlc3MgdGhlaXIgb3duIHByb2ZpbGVcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7XG4gICAgICBcbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5maW5kT25lKHsgaWQ6IFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNUIH0sIFRFU1RfVVNFUl9JRFMuQ0xJRU5UKSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KEZvcmJpZGRlbkV4Y2VwdGlvbik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdSb2xlLWJhc2VkIEFjY2VzcyBDb250cm9sJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgdGVzdCByb2xlLWJhc2VkIGFjY2VzcyBmb3IgYWRtaW4gZW5kcG9pbnRzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gVGVzdCB0aGF0IGFkbWluIGVuZHBvaW50cyByZXF1aXJlIGFkbWluIHJvbGVcbiAgICAgIGF3YWl0IFJvbGVCYXNlZFRlc3RVdGlscy50ZXN0V2l0aFJvbGVzKFxuICAgICAgICBhc3luYyAodXNlcklkOiBzdHJpbmcsIHJvbGU6IHN0cmluZykgPT4ge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCBjb250cm9sbGVyLmZpbmRBbGwodXNlcklkKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgY2xpZW50OiBmYWxzZSxcbiAgICAgICAgICB0aGVyYXBpc3Q6IGZhbHNlLFxuICAgICAgICAgIGFkbWluOiB0cnVlLFxuICAgICAgICAgIG1vZGVyYXRvcjogZmFsc2UsXG4gICAgICAgIH0sXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSB1c2VyLXNwZWNpZmljIGZ1bmN0aW9uYWxpdHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBUZXN0IHRoYXQgdXNlcnMgY2FuIGFjY2VzcyB0aGVpciBvd24gcHJvZmlsZVxuICAgICAgY29uc3QgdXNlckNvbnRleHQgPSBNb2NrQnVpbGRlci5jcmVhdGVBdXRoQ29udGV4dCgnY2xpZW50Jyk7XG4gICAgICBcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7XG4gICAgICB1c2Vyc1NlcnZpY2UuZmluZE9uZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXNlciBhcyBhbnkpO1xuICAgICAgXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmZpbmRPbmUoeyBpZDogdXNlckNvbnRleHQudXNlcklkIH0sIHVzZXJDb250ZXh0LnVzZXJJZCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QocmVzdWx0LmlkKS50b0JlKHVzZXJDb250ZXh0LnVzZXJJZCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRlc3QgZmllbGQgc2FuaXRpemF0aW9uIGZvciBub24tYWRtaW4gdXNlcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBUZXN0IHRoYXQgbm9uLWFkbWluIHVzZXJzIGNhbm5vdCB1cGRhdGUgc2Vuc2l0aXZlIGZpZWxkc1xuICAgICAgY29uc3Qgc2Vuc2l0aXZlRGF0YSA9IHtcbiAgICAgICAgZmlyc3ROYW1lOiAnSm9obicsXG4gICAgICAgIHJvbGU6ICdhZG1pbicsIC8vIFNob3VsZCBiZSBmaWx0ZXJlZCBvdXRcbiAgICAgICAgaXNBY3RpdmU6IGZhbHNlLCAvLyBTaG91bGQgYmUgZmlsdGVyZWQgb3V0XG4gICAgICAgIGVtYWlsVmVyaWZpZWQ6IHRydWUsIC8vIFNob3VsZCBiZSBmaWx0ZXJlZCBvdXRcbiAgICAgIH07XG4gICAgICBcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7XG4gICAgICB1c2Vyc1NlcnZpY2UudXBkYXRlLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVc2VyIGFzIGFueSk7XG4gICAgICBcbiAgICAgIGF3YWl0IGNvbnRyb2xsZXIudXBkYXRlKHsgaWQ6IFRFU1RfVVNFUl9JRFMuQ0xJRU5UIH0sIHNlbnNpdGl2ZURhdGEsIFRFU1RfVVNFUl9JRFMuQ0xJRU5UKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHVzZXJzU2VydmljZS51cGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgeyBmaXJzdE5hbWU6ICdKb2huJyB9LCAvLyBPbmx5IGFsbG93ZWQgZmllbGRzXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnSW50ZWdyYXRpb24gVGVzdHMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgY29tcGxldGUgdXNlciBwcm9maWxlIHVwZGF0ZSB3b3JrZmxvdycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IHVwZGF0ZURhdGEgPSB7XG4gICAgICAgIGZpcnN0TmFtZTogJ1VwZGF0ZWQnLFxuICAgICAgICBsYXN0TmFtZTogJ05hbWUnLFxuICAgICAgICBiaW86ICdVcGRhdGVkIGJpbycsXG4gICAgICAgIHRpbWV6b25lOiAnQW1lcmljYS9Mb3NfQW5nZWxlcycsXG4gICAgICAgIGxhbmd1YWdlOiAnZW4nLFxuICAgICAgICB0aGVtZTogJ2RhcmsnLFxuICAgICAgfTtcbiAgICAgIGNvbnN0IHVwZGF0ZWRVc2VyID0geyAuLi5tb2NrVXNlciwgLi4udXBkYXRlRGF0YSB9O1xuICAgICAgXG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoZmFsc2UpO1xuICAgICAgdXNlcnNTZXJ2aWNlLnVwZGF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh1cGRhdGVkVXNlciBhcyBhbnkpO1xuICAgICAgXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIudXBkYXRlKFxuICAgICAgICB7IGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCB9LFxuICAgICAgICB1cGRhdGVEYXRhLFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICk7XG4gICAgICBcbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZmlyc3ROYW1lKS50b0JlKCdVcGRhdGVkJyk7XG4gICAgICBleHBlY3QocmVzdWx0Lmxhc3ROYW1lKS50b0JlKCdOYW1lJyk7XG4gICAgICBleHBlY3QocmVzdWx0LmJpbykudG9CZSgnVXBkYXRlZCBiaW8nKTtcbiAgICAgIGV4cGVjdChyZXN1bHQudGltZXpvbmUpLnRvQmUoJ0FtZXJpY2EvTG9zX0FuZ2VsZXMnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbXBsZXRlIGFkbWluIHVzZXIgbWFuYWdlbWVudCB3b3JrZmxvdycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZSh0cnVlKTtcbiAgICAgIHVzZXJzU2VydmljZS5maW5kQWxsLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVc2VycyBhcyBhbnkpO1xuICAgICAgdXNlcnNTZXJ2aWNlLmZpbmRBbGxJbmNsdWRlSW5hY3RpdmUubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXJzIGFzIGFueSk7XG4gICAgICB1c2Vyc1NlcnZpY2UuZmluZE9uZUluY2x1ZGVJbmFjdGl2ZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXNlciBhcyBhbnkpO1xuICAgICAgXG4gICAgICAvLyBBY3QgLSBHZXQgYWxsIHVzZXJzXG4gICAgICBjb25zdCBhbGxVc2VycyA9IGF3YWl0IGNvbnRyb2xsZXIuZmluZEFsbChURVNUX1VTRVJfSURTLkFETUlOKTtcbiAgICAgIFxuICAgICAgLy8gQWN0IC0gR2V0IGFsbCB1c2VycyBpbmNsdWRpbmcgaW5hY3RpdmVcbiAgICAgIGNvbnN0IGFsbFVzZXJzSW5jbHVkZUluYWN0aXZlID0gYXdhaXQgY29udHJvbGxlci5maW5kQWxsSW5jbHVkZUluYWN0aXZlKFRFU1RfVVNFUl9JRFMuQURNSU4pO1xuICAgICAgXG4gICAgICAvLyBBY3QgLSBWaWV3IHNwZWNpZmljIHVzZXJcbiAgICAgIGNvbnN0IHNwZWNpZmljVXNlciA9IGF3YWl0IGNvbnRyb2xsZXIuZmluZE9uZSh7IGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCB9LCBURVNUX1VTRVJfSURTLkFETUlOKTtcbiAgICAgIFxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QoYWxsVXNlcnMpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoYWxsVXNlcnMpLnRvSGF2ZUxlbmd0aCgyKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGFsbFVzZXJzSW5jbHVkZUluYWN0aXZlKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGFsbFVzZXJzSW5jbHVkZUluYWN0aXZlKS50b0hhdmVMZW5ndGgoMik7XG4gICAgICBcbiAgICAgIGV4cGVjdChzcGVjaWZpY1VzZXIpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3Qoc3BlY2lmaWNVc2VyLmlkKS50b0JlKFRFU1RfVVNFUl9JRFMuQ0xJRU5UKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbXBsZXRlIHVzZXIgZGVhY3RpdmF0aW9uIHdvcmtmbG93JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgdXNlcnNTZXJ2aWNlLmRlYWN0aXZhdGUubW9ja1Jlc29sdmVkVmFsdWUoe30gYXMgYW55KTtcbiAgICAgIFxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmRlYWN0aXZhdGVVc2VyKFxuICAgICAgICB7IGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCB9LFxuICAgICAgICB7IHJlYXNvbjogJ1BvbGljeSB2aW9sYXRpb24nIH0sXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQURNSU4sXG4gICAgICApO1xuICAgICAgXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QocmVzdWx0Lm1lc3NhZ2UpLnRvQmUoJ1VzZXIgYWNjb3VudCBkZWFjdGl2YXRlZCBieSBhZG1pbmlzdHJhdG9yJyk7XG4gICAgICBleHBlY3QodXNlcnNTZXJ2aWNlLmRlYWN0aXZhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgJ1BvbGljeSB2aW9sYXRpb24nLFxuICAgICAgICBURVNUX1VTRVJfSURTLkFETUlOLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbXBsZXRlIHVzZXIgcmVhY3RpdmF0aW9uIHdvcmtmbG93JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgdXNlcnNTZXJ2aWNlLnJlYWN0aXZhdGUubW9ja1Jlc29sdmVkVmFsdWUoe30gYXMgYW55KTtcbiAgICAgIFxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLnJlYWN0aXZhdGVVc2VyKFxuICAgICAgICB7IGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCB9LFxuICAgICAgICBURVNUX1VTRVJfSURTLkFETUlOLFxuICAgICAgKTtcbiAgICAgIFxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5tZXNzYWdlKS50b0JlKCdVc2VyIGFjY291bnQgcmVhY3RpdmF0ZWQgc3VjY2Vzc2Z1bGx5Jyk7XG4gICAgICBleHBlY3QodXNlcnNTZXJ2aWNlLnJlYWN0aXZhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFRFU1RfVVNFUl9JRFMuQ0xJRU5UKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0RhdGEgVmFsaWRhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIHVzZXIgdXBkYXRlIGRhdGEgc3RydWN0dXJlJywgKCkgPT4ge1xuICAgICAgLy8gVGVzdCB0aGF0IHdlJ3JlIHVzaW5nIHRoZSBjb3JyZWN0IERUTyBzdHJ1Y3R1cmVcbiAgICAgIGNvbnN0IHZhbGlkVXBkYXRlRGF0YSA9IHtcbiAgICAgICAgZmlyc3ROYW1lOiAnSm9obicsXG4gICAgICAgIGxhc3ROYW1lOiAnRG9lJyxcbiAgICAgICAgYmlvOiAnVXNlciBiaW8nLFxuICAgICAgICBhdmF0YXJVcmw6ICdodHRwczovL2V4YW1wbGUuY29tL2F2YXRhci5qcGcnLFxuICAgICAgICBjb3ZlckltYWdlVXJsOiAnaHR0cHM6Ly9leGFtcGxlLmNvbS9jb3Zlci5qcGcnLFxuICAgICAgICBwaG9uZU51bWJlcjogJysxMjM0NTY3ODkwJyxcbiAgICAgICAgdGltZXpvbmU6ICdBbWVyaWNhL05ld19Zb3JrJyxcbiAgICAgICAgbGFuZ3VhZ2U6ICdlbicsXG4gICAgICAgIHRoZW1lOiAnbGlnaHQnLFxuICAgICAgfTtcbiAgICAgIFxuICAgICAgLy8gVmVyaWZ5IGFsbCBmaWVsZHMgYXJlIGRlZmluZWRcbiAgICAgIGV4cGVjdCh2YWxpZFVwZGF0ZURhdGEuZmlyc3ROYW1lKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHZhbGlkVXBkYXRlRGF0YS5sYXN0TmFtZSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdCh2YWxpZFVwZGF0ZURhdGEuYmlvKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHZhbGlkVXBkYXRlRGF0YS5hdmF0YXJVcmwpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QodmFsaWRVcGRhdGVEYXRhLmNvdmVySW1hZ2VVcmwpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QodmFsaWRVcGRhdGVEYXRhLnBob25lTnVtYmVyKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHZhbGlkVXBkYXRlRGF0YS50aW1lem9uZSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdCh2YWxpZFVwZGF0ZURhdGEubGFuZ3VhZ2UpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QodmFsaWRVcGRhdGVEYXRhLnRoZW1lKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBkZWFjdGl2YXRpb24gZGF0YSBzdHJ1Y3R1cmUnLCAoKSA9PiB7XG4gICAgICAvLyBUZXN0IHRoYXQgd2UncmUgdXNpbmcgdGhlIGNvcnJlY3QgRFRPIHN0cnVjdHVyZVxuICAgICAgY29uc3QgdmFsaWREZWFjdGl2YXRpb25EYXRhID0ge1xuICAgICAgICByZWFzb246ICdQb2xpY3kgdmlvbGF0aW9uJyxcbiAgICAgIH07XG4gICAgICBcbiAgICAgIC8vIFZlcmlmeSBhbGwgZmllbGRzIGFyZSBkZWZpbmVkXG4gICAgICBleHBlY3QodmFsaWREZWFjdGl2YXRpb25EYXRhLnJlYXNvbikudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgdXNlciBJRCBwYXJhbWV0ZXIgc3RydWN0dXJlJywgKCkgPT4ge1xuICAgICAgLy8gVGVzdCB0aGF0IHdlJ3JlIHVzaW5nIHRoZSBjb3JyZWN0IHBhcmFtZXRlciBzdHJ1Y3R1cmVcbiAgICAgIGNvbnN0IHZhbGlkVXNlcklkUGFyYW0gPSB7XG4gICAgICAgIGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgIH07XG4gICAgICBcbiAgICAgIC8vIFZlcmlmeSBhbGwgZmllbGRzIGFyZSBkZWZpbmVkXG4gICAgICBleHBlY3QodmFsaWRVc2VySWRQYXJhbS5pZCkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1Jlc3BvbnNlIEZvcm1hdCBWYWxpZGF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvcnJlY3RseSBmb3JtYXR0ZWQgdXNlciBsaXN0IHJlc3BvbnNlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKHRydWUpO1xuICAgICAgdXNlcnNTZXJ2aWNlLmZpbmRBbGwubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXJzIGFzIGFueSk7XG4gICAgICBcbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5maW5kQWxsKFRFU1RfVVNFUl9JRFMuQURNSU4pO1xuICAgICAgXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVJbnN0YW5jZU9mKEFycmF5KTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZUxlbmd0aCgyKTtcbiAgICAgIFxuICAgICAgY29uc3QgdXNlciA9IHJlc3VsdFswXTtcbiAgICAgIGV4cGVjdCh1c2VyKS50b0hhdmVQcm9wZXJ0eSgnaWQnKTtcbiAgICAgIGV4cGVjdCh1c2VyKS50b0hhdmVQcm9wZXJ0eSgnZW1haWwnKTtcbiAgICAgIGV4cGVjdCh1c2VyKS50b0hhdmVQcm9wZXJ0eSgnZmlyc3ROYW1lJyk7XG4gICAgICBleHBlY3QodXNlcikudG9IYXZlUHJvcGVydHkoJ2xhc3ROYW1lJyk7XG4gICAgICBleHBlY3QodXNlcikudG9IYXZlUHJvcGVydHkoJ3JvbGUnKTtcbiAgICAgIGV4cGVjdCh1c2VyKS50b0hhdmVQcm9wZXJ0eSgnY3JlYXRlZEF0Jyk7XG4gICAgICBleHBlY3QodXNlcikudG9IYXZlUHJvcGVydHkoJ2lzQWN0aXZlJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBjb3JyZWN0bHkgZm9ybWF0dGVkIHVzZXIgcHJvZmlsZSByZXNwb25zZScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7XG4gICAgICB1c2Vyc1NlcnZpY2UuZmluZE9uZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXNlciBhcyBhbnkpO1xuICAgICAgXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZmluZE9uZSh7IGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCB9LCBURVNUX1VTRVJfSURTLkNMSUVOVCk7XG4gICAgICBcbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ2lkJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgnZW1haWwnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdmaXJzdE5hbWUnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdsYXN0TmFtZScpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ3JvbGUnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdiaW8nKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdhdmF0YXJVcmwnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdjb3ZlckltYWdlVXJsJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgncGhvbmVOdW1iZXInKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCd0aW1lem9uZScpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ2xhbmd1YWdlJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgndGhlbWUnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdjcmVhdGVkQXQnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCd1cGRhdGVkQXQnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvcnJlY3RseSBmb3JtYXR0ZWQgdXBkYXRlIHJlc3BvbnNlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgdXBkYXRlRGF0YSA9IHtcbiAgICAgICAgZmlyc3ROYW1lOiAnVXBkYXRlZCcsXG4gICAgICAgIGxhc3ROYW1lOiAnTmFtZScsXG4gICAgICB9O1xuICAgICAgY29uc3QgdXBkYXRlZFVzZXIgPSB7IC4uLm1vY2tVc2VyLCAuLi51cGRhdGVEYXRhIH07XG4gICAgICBcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7XG4gICAgICB1c2Vyc1NlcnZpY2UudXBkYXRlLm1vY2tSZXNvbHZlZFZhbHVlKHVwZGF0ZWRVc2VyIGFzIGFueSk7XG4gICAgICBcbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci51cGRhdGUoXG4gICAgICAgIHsgaWQ6IFRFU1RfVVNFUl9JRFMuQ0xJRU5UIH0sXG4gICAgICAgIHVwZGF0ZURhdGEsXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgKTtcbiAgICAgIFxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgnaWQnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdlbWFpbCcpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ2ZpcnN0TmFtZScpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ2xhc3ROYW1lJyk7XG4gICAgICBleHBlY3QocmVzdWx0LmZpcnN0TmFtZSkudG9CZSgnVXBkYXRlZCcpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5sYXN0TmFtZSkudG9CZSgnTmFtZScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gY29ycmVjdGx5IGZvcm1hdHRlZCBkZWFjdGl2YXRpb24gcmVzcG9uc2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoZmFsc2UpO1xuICAgICAgdXNlcnNTZXJ2aWNlLnJlbW92ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7fSBhcyBhbnkpO1xuICAgICAgXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIucmVtb3ZlKHsgaWQ6IFRFU1RfVVNFUl9JRFMuQ0xJRU5UIH0sIFRFU1RfVVNFUl9JRFMuQ0xJRU5UKTtcbiAgICAgIFxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgnbWVzc2FnZScpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5tZXNzYWdlKS50b0JlKCdVc2VyIGFjY291bnQgZGVhY3RpdmF0ZWQgc3VjY2Vzc2Z1bGx5Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBjb3JyZWN0bHkgZm9ybWF0dGVkIGFkbWluIGRlYWN0aXZhdGlvbiByZXNwb25zZScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIHVzZXJzU2VydmljZS5kZWFjdGl2YXRlLm1vY2tSZXNvbHZlZFZhbHVlKHt9IGFzIGFueSk7XG4gICAgICBcbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5kZWFjdGl2YXRlVXNlcihcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgIHsgcmVhc29uOiAnUG9saWN5IHZpb2xhdGlvbicgfSxcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5BRE1JTixcbiAgICAgICk7XG4gICAgICBcbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ21lc3NhZ2UnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQubWVzc2FnZSkudG9CZSgnVXNlciBhY2NvdW50IGRlYWN0aXZhdGVkIGJ5IGFkbWluaXN0cmF0b3InKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvcnJlY3RseSBmb3JtYXR0ZWQgcmVhY3RpdmF0aW9uIHJlc3BvbnNlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgdXNlcnNTZXJ2aWNlLnJlYWN0aXZhdGUubW9ja1Jlc29sdmVkVmFsdWUoe30gYXMgYW55KTtcbiAgICAgIFxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLnJlYWN0aXZhdGVVc2VyKFxuICAgICAgICB7IGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCB9LFxuICAgICAgICBURVNUX1VTRVJfSURTLkFETUlOLFxuICAgICAgKTtcbiAgICAgIFxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgnbWVzc2FnZScpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5tZXNzYWdlKS50b0JlKCdVc2VyIGFjY291bnQgcmVhY3RpdmF0ZWQgc3VjY2Vzc2Z1bGx5Jyk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwidmVyc2lvbiI6M30=