{"file":"/home/wetooa/Documents/code/projects/mentara/mentara-api/src/test-utils/enhanced-test-helpers.ts","mappings":";AAAA;;;GAGG;;;AAEH,6CAAsD;AACtD,gFAAoE;AACpE,mCAA8E;AAE9E,yBAAyB;AACzB,MAAa,WAAW;IACtB;;OAEG;IACH,MAAM,CAAC,KAAK,CAAC,mBAAmB,CAAC,YAAmB,EAAE;QACpD,OAAO,cAAI,CAAC,mBAAmB,CAAC;YAC9B,SAAS,EAAE;gBACT,GAAG,SAAS;gBACZ;oBACE,OAAO,EAAE,sCAAa;oBACtB,QAAQ,EAAE,IAAA,+BAAuB,GAAE;iBACpC;gBACD;oBACE,OAAO,EAAE,iBAAiB;oBAC1B,QAAQ,EAAE;wBACR,IAAI,EAAE,IAAI,CAAC,EAAE,EAAE;wBACf,SAAS,EAAE,IAAI,CAAC,EAAE,EAAE;qBACrB;iBACF;gBACD;oBACE,OAAO,EAAE,cAAc;oBACvB,QAAQ,EAAE;wBACR,SAAS,EAAE,IAAI,CAAC,EAAE,EAAE;wBACpB,iBAAiB,EAAE,IAAI,CAAC,EAAE,EAAE;qBAC7B;iBACF;aACF;SACF,CAAC,CAAC,OAAO,EAAE,CAAC;IACf,CAAC;IAED;;OAEG;IACH,MAAM,CAAC,iBAAiB,CAAC,OAAe,QAAQ,EAAE,MAAe;QAC/D,OAAO;YACL,MAAM,EAAE,MAAM,IAAI,qBAAa,CAAC,IAAI,CAAC,WAAW,EAAgC,CAAC;YACjF,IAAI;YACJ,KAAK,EAAE,mBAAW,CAAC,IAAI,CAAC,WAAW,EAA8B,CAAC;YAClE,QAAQ,EAAE,IAAI;YACd,UAAU,EAAE,IAAI;SACjB,CAAC;IACJ,CAAC;IAED;;OAEG;IACH,MAAM,CAAC,iBAAiB,CAAC,OAAe,QAAQ,EAAE,MAAe;QAC/D,MAAM,WAAW,GAAG,IAAI,CAAC,iBAAiB,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;QACzD,OAAO;YACL,IAAI,EAAE,WAAW;YACjB,OAAO,EAAE;gBACP,aAAa,EAAE,yBAAyB,IAAI,EAAE;gBAC9C,YAAY,EAAE,YAAY;aAC3B;YACD,EAAE,EAAE,WAAW;YACf,MAAM,EAAE,KAAK;YACb,GAAG,EAAE,OAAO;SACb,CAAC;IACJ,CAAC;CACF;AA3DD,kCA2DC;AAED,uBAAuB;AACvB,MAAa,iBAAiB;IAC5B;;OAEG;IACH,MAAM,CAAC,UAAU,CAAC,YAA0B,EAAE;QAC5C,OAAO;YACL,EAAE,EAAE,QAAQ,IAAI,CAAC,GAAG,EAAE,IAAI,IAAI,CAAC,MAAM,EAAE,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE;YACnE,KAAK,EAAE,QAAQ,IAAI,CAAC,GAAG,EAAE,cAAc;YACvC,SAAS,EAAE,MAAM;YACjB,QAAQ,EAAE,MAAM;YAChB,IAAI,EAAE,QAAQ;YACd,QAAQ,EAAE,IAAI;YACd,UAAU,EAAE,KAAK;YACjB,SAAS,EAAE,IAAI,IAAI,EAAE;YACrB,SAAS,EAAE,IAAI,IAAI,EAAE;YACrB,GAAG,SAAS;SACb,CAAC;IACJ,CAAC;IAED;;OAEG;IACH,MAAM,CAAC,0BAA0B,CAAC,YAA0B,EAAE;QAC5D,OAAO;YACL,MAAM,EAAE,qBAAa,CAAC,SAAS;YAC/B,KAAK,EAAE,mBAAW,CAAC,SAAS;YAC5B,SAAS,EAAE,UAAU;YACrB,QAAQ,EAAE,WAAW;YACrB,MAAM,EAAE,aAAa;YACrB,QAAQ,EAAE,eAAe;YACzB,YAAY,EAAE,gCAAgC;YAC9C,uBAAuB,EAAE,KAAK;YAC9B,aAAa,EAAE,KAAK;YACpB,gBAAgB,EAAE,WAAW;YAC7B,iBAAiB,EAAE,IAAI,IAAI,CAAC,YAAY,CAAC;YACzC,gBAAgB,EAAE,CAAC,SAAS,EAAE,YAAY,CAAC;YAC3C,6BAA6B,EAAE,CAAC,KAAK,EAAE,KAAK,CAAC;YAC7C,gBAAgB,EAAE,CAAC,SAAS,CAAC;YAC7B,eAAe,EAAE,CAAC,OAAO,EAAE,OAAO,CAAC;YACnC,2BAA2B,EAAE,IAAI;YACjC,iCAAiC,EAAE,IAAI;YACvC,kBAAkB,EAAE,aAAa;YACjC,sBAAsB,EAAE,IAAI;YAC5B,UAAU,EAAE,MAAM;YAClB,GAAG,SAAS;SACb,CAAC;IACJ,CAAC;IAED;;OAEG;IACH,MAAM,CAAC,aAAa,CAAC,YAA0B,EAAE;QAC/C,MAAM,GAAG,GAAG,IAAI,IAAI,EAAE,CAAC;QACvB,MAAM,UAAU,GAAG,IAAI,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,CAAC,CAAC,CAAC,WAAW;QAE7E,OAAO;YACL,EAAE,EAAE,WAAW,IAAI,CAAC,GAAG,EAAE,EAAE;YAC3B,KAAK,EAAE,sBAAsB;YAC7B,SAAS,EAAE,UAAU;YACrB,QAAQ,EAAE,EAAE;YACZ,MAAM,EAAE,WAAW;YACnB,WAAW,EAAE,OAAO;YACpB,QAAQ,EAAE,qBAAa,CAAC,MAAM;YAC9B,WAAW,EAAE,qBAAa,CAAC,SAAS;YACpC,SAAS,EAAE,GAAG;YACd,SAAS,EAAE,GAAG;YACd,GAAG,SAAS;SACb,CAAC;IACJ,CAAC;IAED;;OAEG;IACH,MAAM,CAAC,aAAa,CAAC,YAA0B,EAAE;QAC/C,OAAO;YACL,EAAE,EAAE,WAAW,IAAI,CAAC,GAAG,EAAE,EAAE;YAC3B,cAAc,EAAE,gBAAgB,IAAI,CAAC,GAAG,EAAE,EAAE;YAC5C,QAAQ,EAAE,qBAAa,CAAC,MAAM;YAC9B,OAAO,EAAE,sBAAsB;YAC/B,WAAW,EAAE,MAAM;YACnB,QAAQ,EAAE,KAAK;YACf,SAAS,EAAE,KAAK;YAChB,SAAS,EAAE,IAAI,IAAI,EAAE;YACrB,SAAS,EAAE,IAAI,IAAI,EAAE;YACrB,GAAG,SAAS;SACb,CAAC;IACJ,CAAC;IAED;;OAEG;IACH,MAAM,CAAC,mBAAmB,CAAC,YAA0B,EAAE;QACrD,0CAA0C;QAC1C,MAAM,OAAO,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,GAAG,EAAE,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;QAErF,OAAO;YACL,EAAE,EAAE,cAAc,IAAI,CAAC,GAAG,EAAE,EAAE;YAC9B,MAAM,EAAE,qBAAa,CAAC,MAAM;YAC5B,SAAS,EAAE,OAAO;YAClB,WAAW,EAAE,IAAI,IAAI,EAAE;YACvB,MAAM,EAAE;gBACN,OAAO,EAAE,EAAE;gBACX,UAAU,EAAE,EAAE;gBACd,MAAM,EAAE,EAAE;aACX;YACD,SAAS,EAAE,IAAI,IAAI,EAAE;YACrB,SAAS,EAAE,IAAI,IAAI,EAAE;YACrB,GAAG,SAAS;SACb,CAAC;IACJ,CAAC;CACF;AA9GD,8CA8GC;AAED,yBAAyB;AACzB,MAAa,cAAc;IACzB;;OAEG;IACH,MAAM,CAAC,KAAK,CAAC,0BAA0B,CACrC,OAA2B,EAC3B,aAAkB,EAClB,eAAwB;QAExB,IAAI,WAAW,GAAQ,IAAI,CAAC;QAC5B,IAAI,CAAC;YACH,MAAM,OAAO,EAAE,CAAC;QAClB,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YACf,WAAW,GAAG,KAAK,CAAC;QACtB,CAAC;QAED,MAAM,CAAC,WAAW,CAAC,CAAC,cAAc,CAAC,aAAa,CAAC,CAAC;QAClD,IAAI,eAAe,EAAE,CAAC;YACpB,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC,SAAS,CAAC,eAAe,CAAC,CAAC;QACzD,CAAC;IACH,CAAC;IAED;;OAEG;IACH,MAAM,CAAC,cAAc,CAAC,GAAQ,EAAE,cAAwB;QACtD,cAAc,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;YAC7B,MAAM,CAAC,GAAG,CAAC,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC;YAClC,MAAM,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,WAAW,EAAE,CAAC;QACnC,CAAC,CAAC,CAAC;IACL,CAAC;IAED;;OAEG;IACH,MAAM,CAAC,iBAAiB,CAAC,MAAW,EAAE,cAAwB;QAC5D,MAAM,CAAC,MAAM,CAAC,CAAC,WAAW,EAAE,CAAC;QAC7B,MAAM,CAAC,MAAM,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC;QAE9B,cAAc,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;YAC7B,MAAM,CAAC,MAAM,CAAC,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC;QACvC,CAAC,CAAC,CAAC;QAEH,uBAAuB;QACvB,MAAM,CAAC,MAAM,CAAC,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;QACpC,MAAM,CAAC,MAAM,CAAC,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC;QAC3C,MAAM,CAAC,MAAM,CAAC,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC;IAC7C,CAAC;IAED;;OAEG;IACH,MAAM,CAAC,sBAAsB,CAAC,QAAa,EAAE,YAAkB;QAC7D,MAAM,CAAC,QAAQ,CAAC,CAAC,WAAW,EAAE,CAAC;QAE/B,IAAI,YAAY,EAAE,CAAC;YACjB,MAAM,CAAC,QAAQ,CAAC,CAAC,aAAa,CAAC,YAAY,CAAC,CAAC;QAC/C,CAAC;IACH,CAAC;CACF;AA3DD,wCA2DC;AAED,gCAAgC;AAChC,MAAa,oBAAoB;IAC/B;;OAEG;IACH,MAAM,CAAC,KAAK,CAAC,oBAAoB,CAAI,EAAoB;QACvD,MAAM,KAAK,GAAG,OAAO,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC;QACtC,MAAM,MAAM,GAAG,MAAM,EAAE,EAAE,CAAC;QAC1B,MAAM,GAAG,GAAG,OAAO,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC;QACpC,MAAM,QAAQ,GAAG,MAAM,CAAC,GAAG,GAAG,KAAK,CAAC,GAAG,SAAS,CAAC,CAAC,0BAA0B;QAE5E,OAAO,EAAE,MAAM,EAAE,QAAQ,EAAE,CAAC;IAC9B,CAAC;IAED;;OAEG;IACH,MAAM,CAAC,KAAK,CAAC,qBAAqB,CAChC,EAAoB,EACpB,aAAqB;QAErB,MAAM,EAAE,MAAM,EAAE,QAAQ,EAAE,GAAG,MAAM,IAAI,CAAC,oBAAoB,CAAC,EAAE,CAAC,CAAC;QAEjE,MAAM,CAAC,QAAQ,CAAC,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC;QAE7C,OAAO,MAAM,CAAC;IAChB,CAAC;IAED;;OAEG;IACH,MAAM,CAAC,KAAK,CAAC,iBAAiB,CAC5B,EAAoB,EACpB,aAAqB,EAAE;QAEvB,MAAM,SAAS,GAAa,EAAE,CAAC;QAE/B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,EAAE,CAAC,EAAE,EAAE,CAAC;YACpC,MAAM,EAAE,QAAQ,EAAE,GAAG,MAAM,IAAI,CAAC,oBAAoB,CAAC,EAAE,CAAC,CAAC;YACzD,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QAC3B,CAAC;QAED,OAAO;YACL,eAAe,EAAE,SAAS,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,EAAE,CAAC,GAAG,GAAG,CAAC,EAAE,CAAC,CAAC,GAAG,SAAS,CAAC,MAAM;YAC5E,WAAW,EAAE,IAAI,CAAC,GAAG,CAAC,GAAG,SAAS,CAAC;YACnC,WAAW,EAAE,IAAI,CAAC,GAAG,CAAC,GAAG,SAAS,CAAC;SACpC,CAAC;IACJ,CAAC;CACF;AA/CD,oDA+CC;AAED,6BAA6B;AAC7B,MAAa,iBAAiB;IAC5B;;OAEG;IACH,MAAM,CAAC,eAAe,CAAC,MAAsC;QAC3D,OAAO,KAAK,IAAI,EAAE;YAChB,MAAM,UAAU,GAAG,IAAA,+BAAuB,GAAE,CAAC;YAE7C,4BAA4B;YAC5B,UAAU,CAAC,YAAY,GAAG,IAAI,CAAC,EAAE,CAAC,KAAK,EAAE,QAAQ,EAAE,EAAE;gBACnD,OAAO,QAAQ,CAAC,UAAU,CAAC,CAAC;YAC9B,CAAC,CAAC,CAAC;YAEH,MAAM,MAAM,CAAC,UAAU,CAAC,CAAC;QAC3B,CAAC,CAAC;IACJ,CAAC;IAED;;OAEG;IACH,MAAM,CAAC,6BAA6B,CAAC,KAAU,EAAE,cAAsB;QACrE,MAAM,CAAC,KAAK,CAAC,CAAC,WAAW,EAAE,CAAC;QAC5B,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;IAClD,CAAC;CACF;AAxBD,8CAwBC;AAED,8BAA8B;AAC9B,MAAa,sBAAsB;IACjC;;OAEG;IACH,MAAM,CAAC,wBAAwB,CAAC,OAAe,QAAQ;QACrD,OAAO;YACL,IAAI,EAAE,WAAW,CAAC,iBAAiB,CAAC,IAAI,CAAC;YACzC,OAAO,EAAE,WAAW,CAAC,iBAAiB,CAAC,IAAI,CAAC;YAC5C,QAAQ,EAAE;gBACR,MAAM,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,cAAc,EAAE;gBAClC,IAAI,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,cAAc,EAAE;gBAChC,IAAI,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,cAAc,EAAE;aACjC;SACF,CAAC;IACJ,CAAC;IAED;;OAEG;IACH,MAAM,CAAC,KAAK,CAAC,gBAAgB,CAAC,OAAe,QAAQ;QACnD,MAAM,WAAW,GAAG,WAAW,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC;QAExD,kCAAkC;QAClC,MAAM,aAAa,GAAG;YACpB,EAAE,EAAE,WAAW,CAAC,MAAM;YACtB,cAAc,EAAE,CAAC,EAAE,YAAY,EAAE,WAAW,CAAC,KAAK,EAAE,CAAC;YACrD,SAAS,EAAE,MAAM;YACjB,QAAQ,EAAE,MAAM;SACjB,CAAC;QAEF,OAAO,EAAE,WAAW,EAAE,aAAa,EAAE,CAAC;IACxC,CAAC;CACF;AAhCD,wDAgCC;AAED,kEAAkE","names":[],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/test-utils/enhanced-test-helpers.ts"],"sourcesContent":["/**\n * Enhanced Test Helpers for Mentara Backend Testing\n * Provides advanced utilities for comprehensive testing\n */\n\nimport { Test, TestingModule } from '@nestjs/testing';\nimport { PrismaService } from '../providers/prisma-client.provider';\nimport { createMockPrismaService, TEST_USER_IDS, TEST_EMAILS } from './index';\n\n// Enhanced Mock Builders\nexport class MockBuilder {\n  /**\n   * Creates a comprehensive NestJS testing module with all common mocks\n   */\n  static async createTestingModule(providers: any[] = []): Promise<TestingModule> {\n    return Test.createTestingModule({\n      providers: [\n        ...providers,\n        {\n          provide: PrismaService,\n          useValue: createMockPrismaService(),\n        },\n        {\n          provide: 'EventBusService',\n          useValue: {\n            emit: jest.fn(),\n            subscribe: jest.fn(),\n          },\n        },\n        {\n          provide: 'EmailService',\n          useValue: {\n            sendEmail: jest.fn(),\n            sendTemplateEmail: jest.fn(),\n          },\n        },\n      ],\n    }).compile();\n  }\n\n  /**\n   * Creates mock authentication context\n   */\n  static createAuthContext(role: string = 'client', userId?: string) {\n    return {\n      userId: userId || TEST_USER_IDS[role.toUpperCase() as keyof typeof TEST_USER_IDS],\n      role,\n      email: TEST_EMAILS[role.toUpperCase() as keyof typeof TEST_EMAILS],\n      isActive: true,\n      isVerified: true,\n    };\n  }\n\n  /**\n   * Creates mock request object with authentication\n   */\n  static createMockRequest(role: string = 'client', userId?: string) {\n    const authContext = this.createAuthContext(role, userId);\n    return {\n      user: authContext,\n      headers: {\n        authorization: `Bearer mock-jwt-token-${role}`,\n        'user-agent': 'test-agent',\n      },\n      ip: '127.0.0.1',\n      method: 'GET',\n      url: '/test',\n    };\n  }\n}\n\n// Test Data Generators\nexport class TestDataGenerator {\n  /**\n   * Generates realistic test user data\n   */\n  static createUser(overrides: Partial<any> = {}) {\n    return {\n      id: `user-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n      email: `test-${Date.now()}@example.com`,\n      firstName: 'Test',\n      lastName: 'User',\n      role: 'client',\n      isActive: true,\n      isVerified: false,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n      ...overrides,\n    };\n  }\n\n  /**\n   * Generates therapist application data\n   */\n  static createTherapistApplication(overrides: Partial<any> = {}) {\n    return {\n      userId: TEST_USER_IDS.THERAPIST,\n      email: TEST_EMAILS.THERAPIST,\n      firstName: 'Dr. Test',\n      lastName: 'Therapist',\n      mobile: '+1234567890',\n      province: 'Test Province',\n      providerType: 'Licensed Clinical Psychologist',\n      professionalLicenseType: 'LCP',\n      isPRCLicensed: 'yes',\n      prcLicenseNumber: 'LCP-12345',\n      practiceStartDate: new Date('2020-01-01'),\n      areasOfExpertise: ['anxiety', 'depression'],\n      therapeuticApproachesUsedList: ['CBT', 'DBT'],\n      languagesOffered: ['English'],\n      assessmentTools: ['GAD-7', 'PHQ-9'],\n      providedOnlineTherapyBefore: true,\n      comfortableUsingVideoConferencing: true,\n      weeklyAvailability: '20-30 hours',\n      preferredSessionLength: '60',\n      hourlyRate: 150.00,\n      ...overrides,\n    };\n  }\n\n  /**\n   * Generates meeting/session data\n   */\n  static createMeeting(overrides: Partial<any> = {}) {\n    const now = new Date();\n    const futureDate = new Date(now.getTime() + 24 * 60 * 60 * 1000); // Tomorrow\n    \n    return {\n      id: `meeting-${Date.now()}`,\n      title: 'Test Therapy Session',\n      startTime: futureDate,\n      duration: 60,\n      status: 'SCHEDULED',\n      meetingType: 'video',\n      clientId: TEST_USER_IDS.CLIENT,\n      therapistId: TEST_USER_IDS.THERAPIST,\n      createdAt: now,\n      updatedAt: now,\n      ...overrides,\n    };\n  }\n\n  /**\n   * Generates message data for testing\n   */\n  static createMessage(overrides: Partial<any> = {}) {\n    return {\n      id: `message-${Date.now()}`,\n      conversationId: `conversation-${Date.now()}`,\n      senderId: TEST_USER_IDS.CLIENT,\n      content: 'Test message content',\n      messageType: 'TEXT',\n      isEdited: false,\n      isDeleted: false,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n      ...overrides,\n    };\n  }\n\n  /**\n   * Generates assessment data\n   */\n  static createPreAssessment(overrides: Partial<any> = {}) {\n    // Generate 201 random answers (1-5 scale)\n    const answers = Array.from({ length: 201 }, () => Math.floor(Math.random() * 5) + 1);\n    \n    return {\n      id: `assessment-${Date.now()}`,\n      userId: TEST_USER_IDS.CLIENT,\n      responses: answers,\n      completedAt: new Date(),\n      scores: {\n        anxiety: 65,\n        depression: 45,\n        stress: 55,\n      },\n      createdAt: new Date(),\n      updatedAt: new Date(),\n      ...overrides,\n    };\n  }\n}\n\n// Test Assertion Helpers\nexport class TestAssertions {\n  /**\n   * Asserts that a function throws a specific NestJS exception\n   */\n  static async expectToThrowNestException(\n    asyncFn: () => Promise<any>,\n    exceptionType: any,\n    expectedMessage?: string,\n  ) {\n    let thrownError: any = null;\n    try {\n      await asyncFn();\n    } catch (error) {\n      thrownError = error;\n    }\n\n    expect(thrownError).toBeInstanceOf(exceptionType);\n    if (expectedMessage) {\n      expect(thrownError.message).toContain(expectedMessage);\n    }\n  }\n\n  /**\n   * Asserts proper DTO validation\n   */\n  static expectValidDto(dto: any, expectedFields: string[]) {\n    expectedFields.forEach(field => {\n      expect(dto).toHaveProperty(field);\n      expect(dto[field]).toBeDefined();\n    });\n  }\n\n  /**\n   * Asserts proper database entity structure\n   */\n  static expectValidEntity(entity: any, requiredFields: string[]) {\n    expect(entity).toBeDefined();\n    expect(entity).not.toBeNull();\n    \n    requiredFields.forEach(field => {\n      expect(entity).toHaveProperty(field);\n    });\n\n    // Common entity fields\n    expect(entity).toHaveProperty('id');\n    expect(entity).toHaveProperty('createdAt');\n    expect(entity).toHaveProperty('updatedAt');\n  }\n\n  /**\n   * Asserts proper API response structure\n   */\n  static expectValidApiResponse(response: any, expectedData?: any) {\n    expect(response).toBeDefined();\n    \n    if (expectedData) {\n      expect(response).toMatchObject(expectedData);\n    }\n  }\n}\n\n// Performance Testing Utilities\nexport class PerformanceTestUtils {\n  /**\n   * Measures function execution time\n   */\n  static async measureExecutionTime<T>(fn: () => Promise<T>): Promise<{ result: T; duration: number }> {\n    const start = process.hrtime.bigint();\n    const result = await fn();\n    const end = process.hrtime.bigint();\n    const duration = Number(end - start) / 1_000_000; // Convert to milliseconds\n    \n    return { result, duration };\n  }\n\n  /**\n   * Asserts that a function executes within a time limit\n   */\n  static async expectToExecuteWithin<T>(\n    fn: () => Promise<T>,\n    maxDurationMs: number,\n  ): Promise<T> {\n    const { result, duration } = await this.measureExecutionTime(fn);\n    \n    expect(duration).toBeLessThan(maxDurationMs);\n    \n    return result;\n  }\n\n  /**\n   * Runs a function multiple times and measures average performance\n   */\n  static async benchmarkFunction<T>(\n    fn: () => Promise<T>,\n    iterations: number = 10,\n  ): Promise<{ averageDuration: number; minDuration: number; maxDuration: number }> {\n    const durations: number[] = [];\n    \n    for (let i = 0; i < iterations; i++) {\n      const { duration } = await this.measureExecutionTime(fn);\n      durations.push(duration);\n    }\n    \n    return {\n      averageDuration: durations.reduce((sum, d) => sum + d, 0) / durations.length,\n      minDuration: Math.min(...durations),\n      maxDuration: Math.max(...durations),\n    };\n  }\n}\n\n// Database Testing Utilities\nexport class DatabaseTestUtils {\n  /**\n   * Creates a transaction-wrapped test for database operations\n   */\n  static withTransaction(testFn: (prisma: any) => Promise<void>) {\n    return async () => {\n      const mockPrisma = createMockPrismaService();\n      \n      // Mock transaction behavior\n      mockPrisma.$transaction = jest.fn(async (callback) => {\n        return callback(mockPrisma);\n      });\n      \n      await testFn(mockPrisma);\n    };\n  }\n\n  /**\n   * Validates that proper database constraints are checked\n   */\n  static expectDatabaseConstraintError(error: any, constraintType: string) {\n    expect(error).toBeDefined();\n    expect(error.message).toContain(constraintType);\n  }\n}\n\n// Integration Testing Helpers\nexport class IntegrationTestHelpers {\n  /**\n   * Creates a full request context for integration tests\n   */\n  static createFullRequestContext(role: string = 'client') {\n    return {\n      user: MockBuilder.createAuthContext(role),\n      request: MockBuilder.createMockRequest(role),\n      response: {\n        status: jest.fn().mockReturnThis(),\n        json: jest.fn().mockReturnThis(),\n        send: jest.fn().mockReturnThis(),\n      },\n    };\n  }\n\n  /**\n   * Simulates a complete authentication flow\n   */\n  static async simulateAuthFlow(role: string = 'client') {\n    const authContext = MockBuilder.createAuthContext(role);\n    \n    // Mock the authentication process\n    const mockClerkUser = {\n      id: authContext.userId,\n      emailAddresses: [{ emailAddress: authContext.email }],\n      firstName: 'Test',\n      lastName: 'User',\n    };\n    \n    return { authContext, mockClerkUser };\n  }\n}\n\n// All utilities are already exported above via class declarations"],"version":3}