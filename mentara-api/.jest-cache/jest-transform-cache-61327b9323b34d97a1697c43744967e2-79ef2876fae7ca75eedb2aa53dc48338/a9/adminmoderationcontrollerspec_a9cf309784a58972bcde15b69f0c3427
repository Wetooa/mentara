0c7a7a3770d08b6bd65fe04571747827
"use strict";
/**
 * Test Suite for AdminModerationController
 * Tests basic admin moderation functionality for content review
 */
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const common_1 = require("@nestjs/common");
const admin_moderation_controller_1 = require("./admin-moderation.controller");
const admin_service_1 = require("../admin.service");
const jwt_auth_guard_1 = require("../../auth/guards/jwt-auth.guard");
const admin_auth_guard_1 = require("../../auth/guards/admin-auth.guard");
describe('AdminModerationController', () => {
    let controller;
    let adminService;
    let module;
    // Mock AdminService
    const mockAdminService = {
        getFlaggedContent: jest.fn(),
        moderateContent: jest.fn(),
    };
    // Mock Guards
    const mockJwtAuthGuard = {
        canActivate: jest.fn().mockReturnValue(true),
    };
    const mockAdminAuthGuard = {
        canActivate: jest.fn().mockReturnValue(true),
    };
    // Test data
    const mockFlaggedContent = {
        content: [
            {
                id: 'post_123456789',
                type: 'post',
                content: 'This post contains inappropriate content',
                authorId: 'user_client_123',
                authorName: 'John Doe',
                communityId: 'community_123',
                communityName: 'Anxiety Support',
                flaggedAt: new Date('2024-02-14T10:00:00Z'),
                flaggedBy: 'user_moderator_123',
                flagReason: 'Inappropriate content',
                flagCount: 3,
                status: 'pending',
                priority: 'medium',
            },
            {
                id: 'comment_987654321',
                type: 'comment',
                content: 'This comment violates community guidelines',
                authorId: 'user_client_456',
                authorName: 'Jane Smith',
                parentPostId: 'post_parent_123',
                flaggedAt: new Date('2024-02-14T11:00:00Z'),
                flaggedBy: 'system',
                flagReason: 'Automated detection',
                flagCount: 1,
                status: 'pending',
                priority: 'high',
            },
        ],
        pagination: {
            page: 1,
            limit: 10,
            total: 2,
            totalPages: 1,
        },
        summary: {
            totalFlagged: 2,
            pendingReview: 2,
            approved: 0,
            removed: 0,
            highPriority: 1,
            mediumPriority: 1,
            lowPriority: 0,
        },
    };
    beforeEach(async () => {
        module = await testing_1.Test.createTestingModule({
            controllers: [admin_moderation_controller_1.AdminModerationController],
            providers: [
                {
                    provide: admin_service_1.AdminService,
                    useValue: mockAdminService,
                },
            ],
        })
            .overrideGuard(jwt_auth_guard_1.JwtAuthGuard)
            .useValue(mockJwtAuthGuard)
            .overrideGuard(admin_auth_guard_1.AdminAuthGuard)
            .useValue(mockAdminAuthGuard)
            .compile();
        controller = module.get(admin_moderation_controller_1.AdminModerationController);
        adminService = module.get(admin_service_1.AdminService);
    });
    afterEach(() => {
        jest.clearAllMocks();
    });
    describe('Controller Initialization', () => {
        it('should be defined', () => {
            expect(controller).toBeDefined();
        });
        it('should have adminService injected', () => {
            expect(adminService).toBeDefined();
        });
    });
    describe('Security Guards', () => {
        it('should be protected by JwtAuthGuard and AdminAuthGuard', () => {
            const guards = Reflect.getMetadata('__guards__', admin_moderation_controller_1.AdminModerationController);
            expect(guards).toContain(jwt_auth_guard_1.JwtAuthGuard);
            expect(guards).toContain(admin_auth_guard_1.AdminAuthGuard);
        });
        it('should have proper route decorators', () => {
            const controllerMetadata = Reflect.getMetadata('path', admin_moderation_controller_1.AdminModerationController);
            expect(controllerMetadata).toBe('admin/moderation');
        });
        it('should have AdminOnly decorators on all methods', () => {
            const methods = [
                'getFlaggedContent',
                'moderateContent',
            ];
            methods.forEach(method => {
                const metadata = Reflect.getMetadata('admin_only', controller[method]);
                expect(metadata).toBeTruthy();
            });
        });
    });
    describe('GET /admin/moderation/flagged', () => {
        it('should get flagged content with default pagination', async () => {
            mockAdminService.getFlaggedContent.mockResolvedValue(mockFlaggedContent);
            const result = await controller.getFlaggedContent('admin_123');
            expect(result).toEqual(mockFlaggedContent);
            expect(adminService.getFlaggedContent).toHaveBeenCalledWith({
                type: undefined,
                page: 1,
                limit: 10,
            });
        });
        it('should get flagged content with custom parameters', async () => {
            mockAdminService.getFlaggedContent.mockResolvedValue(mockFlaggedContent);
            const result = await controller.getFlaggedContent('admin_123', 'post', '2', '20');
            expect(result).toEqual(mockFlaggedContent);
            expect(adminService.getFlaggedContent).toHaveBeenCalledWith({
                type: 'post',
                page: 2,
                limit: 20,
            });
        });
        it('should filter by content type', async () => {
            const contentTypes = ['post', 'comment', 'message', 'profile'];
            for (const type of contentTypes) {
                const filteredContent = {
                    ...mockFlaggedContent,
                    content: mockFlaggedContent.content.filter(item => item.type === type),
                };
                mockAdminService.getFlaggedContent.mockResolvedValue(filteredContent);
                const result = await controller.getFlaggedContent('admin_123', type);
                expect(adminService.getFlaggedContent).toHaveBeenCalledWith(expect.objectContaining({ type }));
            }
        });
        it('should handle invalid pagination parameters', async () => {
            mockAdminService.getFlaggedContent.mockResolvedValue(mockFlaggedContent);
            // Test with invalid string values that should be converted
            const result = await controller.getFlaggedContent('admin_123', undefined, 'invalid', 'invalid');
            expect(adminService.getFlaggedContent).toHaveBeenCalledWith({
                type: undefined,
                page: NaN,
                limit: NaN,
            });
        });
        it('should handle empty flagged content', async () => {
            const emptyContent = {
                content: [],
                pagination: { page: 1, limit: 10, total: 0, totalPages: 0 },
                summary: { totalFlagged: 0, pendingReview: 0, approved: 0, removed: 0, highPriority: 0, mediumPriority: 0, lowPriority: 0 },
            };
            mockAdminService.getFlaggedContent.mockResolvedValue(emptyContent);
            const result = await controller.getFlaggedContent('admin_123');
            expect(result.content).toHaveLength(0);
            expect(result.summary.totalFlagged).toBe(0);
        });
        it('should handle service errors', async () => {
            const serviceError = new Error('Database query failed');
            mockAdminService.getFlaggedContent.mockRejectedValue(serviceError);
            await expect(controller.getFlaggedContent('admin_123')).rejects.toThrow(common_1.HttpException);
            await expect(controller.getFlaggedContent('admin_123')).rejects.toThrow('Failed to retrieve flagged content');
        });
        it('should log admin actions', async () => {
            const logSpy = jest.spyOn(controller['logger'], 'log');
            mockAdminService.getFlaggedContent.mockResolvedValue(mockFlaggedContent);
            await controller.getFlaggedContent('admin_123');
            expect(logSpy).toHaveBeenCalledWith('Admin admin_123 retrieving flagged content');
        });
    });
    describe('PUT /admin/moderation/:contentType/:contentId/moderate', () => {
        const contentType = 'post';
        const contentId = 'post_123456789';
        const moderationData = {
            action: 'remove',
            reason: 'Violates community guidelines',
        };
        it('should moderate content successfully', async () => {
            const moderatedContent = {
                id: contentId,
                type: contentType,
                status: 'removed',
                moderatedBy: 'admin_123',
                moderatedAt: new Date(),
                action: moderationData.action,
                reason: moderationData.reason,
            };
            mockAdminService.moderateContent.mockResolvedValue(moderatedContent);
            const result = await controller.moderateContent('admin_123', contentType, contentId, moderationData);
            expect(result).toEqual(moderatedContent);
            expect(adminService.moderateContent).toHaveBeenCalledWith(contentType, contentId, 'admin_123', moderationData.action, moderationData.reason);
        });
        it('should handle all moderation actions', async () => {
            const actions = ['approve', 'remove', 'flag'];
            for (const action of actions) {
                const data = { action, reason: `Test ${action} action` };
                const moderatedContent = {
                    id: contentId,
                    type: contentType,
                    status: action === 'approve' ? 'approved' : action === 'remove' ? 'removed' : 'flagged',
                    action,
                };
                mockAdminService.moderateContent.mockResolvedValue(moderatedContent);
                const result = await controller.moderateContent('admin_123', contentType, contentId, data);
                expect(result.action).toBe(action);
            }
        });
        it('should handle different content types', async () => {
            const contentTypes = ['post', 'comment', 'message', 'profile'];
            for (const type of contentTypes) {
                const moderatedContent = {
                    id: contentId,
                    type,
                    status: 'approved',
                    action: 'approve',
                };
                mockAdminService.moderateContent.mockResolvedValue(moderatedContent);
                const result = await controller.moderateContent('admin_123', type, contentId, { action: 'approve' });
                expect(result.type).toBe(type);
                expect(adminService.moderateContent).toHaveBeenCalledWith(type, contentId, 'admin_123', 'approve', undefined);
            }
        });
        it('should handle moderation without reason', async () => {
            const dataWithoutReason = { action: 'approve' };
            const moderatedContent = {
                id: contentId,
                type: contentType,
                status: 'approved',
                action: 'approve',
            };
            mockAdminService.moderateContent.mockResolvedValue(moderatedContent);
            const result = await controller.moderateContent('admin_123', contentType, contentId, dataWithoutReason);
            expect(result).toEqual(moderatedContent);
            expect(adminService.moderateContent).toHaveBeenCalledWith(contentType, contentId, 'admin_123', 'approve', undefined);
        });
        it('should handle content not found', async () => {
            const notFoundError = new Error('Content not found');
            mockAdminService.moderateContent.mockRejectedValue(notFoundError);
            await expect(controller.moderateContent('admin_123', contentType, 'non-existent-id', moderationData)).rejects.toThrow(common_1.HttpException);
        });
        it('should log admin actions', async () => {
            const logSpy = jest.spyOn(controller['logger'], 'log');
            const moderatedContent = { id: contentId, status: 'removed' };
            mockAdminService.moderateContent.mockResolvedValue(moderatedContent);
            await controller.moderateContent('admin_123', contentType, contentId, moderationData);
            expect(logSpy).toHaveBeenCalledWith(`Admin admin_123 moderating ${contentType} ${contentId}`);
        });
    });
    describe('Error Handling', () => {
        it('should handle service unavailable scenarios', async () => {
            const serviceError = new Error('Service temporarily unavailable');
            mockAdminService.getFlaggedContent.mockRejectedValue(serviceError);
            await expect(controller.getFlaggedContent('admin_123')).rejects.toThrow(common_1.HttpException);
        });
        it('should handle database errors gracefully', async () => {
            const dbError = new Error('Database connection failed');
            mockAdminService.moderateContent.mockRejectedValue(dbError);
            await expect(controller.moderateContent('admin_123', 'post', 'post_123', { action: 'approve' })).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('Response Format Validation', () => {
        it('should return properly formatted flagged content response', async () => {
            mockAdminService.getFlaggedContent.mockResolvedValue(mockFlaggedContent);
            const result = await controller.getFlaggedContent('admin_123');
            expect(result).toHaveProperty('content');
            expect(result).toHaveProperty('pagination');
            expect(result).toHaveProperty('summary');
            expect(Array.isArray(result.content)).toBe(true);
            result.content.forEach((item) => {
                expect(item).toHaveProperty('id');
                expect(item).toHaveProperty('type');
                expect(item).toHaveProperty('content');
                expect(item).toHaveProperty('authorId');
                expect(item).toHaveProperty('flaggedAt');
                expect(['pending', 'approved', 'removed']).toContain(item.status);
                expect(['low', 'medium', 'high']).toContain(item.priority);
            });
        });
    });
    describe('Integration Tests', () => {
        it('should handle complete moderation workflow', async () => {
            // Get flagged content
            mockAdminService.getFlaggedContent.mockResolvedValue(mockFlaggedContent);
            const flaggedContent = await controller.getFlaggedContent('admin_123');
            expect(flaggedContent.content).toHaveLength(2);
            // Moderate content
            const moderatedContent = { id: 'post_123', status: 'removed' };
            mockAdminService.moderateContent.mockResolvedValue(moderatedContent);
            const moderation = await controller.moderateContent('admin_123', 'post', 'post_123', { action: 'remove', reason: 'Inappropriate content' });
            expect(moderation.status).toBe('removed');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL2FkbWluL2NvbnRyb2xsZXJzL2FkbWluLW1vZGVyYXRpb24uY29udHJvbGxlci5zcGVjLnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7O0dBR0c7O0FBRUgsNkNBQXNEO0FBQ3RELDJDQUEyRDtBQUMzRCwrRUFBMEU7QUFDMUUsb0RBQWdEO0FBQ2hELHFFQUFnRTtBQUNoRSx5RUFBb0U7QUFFcEUsUUFBUSxDQUFDLDJCQUEyQixFQUFFLEdBQUcsRUFBRTtJQUN6QyxJQUFJLFVBQXFDLENBQUM7SUFDMUMsSUFBSSxZQUEwQixDQUFDO0lBQy9CLElBQUksTUFBcUIsQ0FBQztJQUUxQixvQkFBb0I7SUFDcEIsTUFBTSxnQkFBZ0IsR0FBRztRQUN2QixpQkFBaUIsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQzVCLGVBQWUsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0tBQzNCLENBQUM7SUFFRixjQUFjO0lBQ2QsTUFBTSxnQkFBZ0IsR0FBRztRQUN2QixXQUFXLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUM7S0FDN0MsQ0FBQztJQUVGLE1BQU0sa0JBQWtCLEdBQUc7UUFDekIsV0FBVyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDO0tBQzdDLENBQUM7SUFFRixZQUFZO0lBQ1osTUFBTSxrQkFBa0IsR0FBRztRQUN6QixPQUFPLEVBQUU7WUFDUDtnQkFDRSxFQUFFLEVBQUUsZ0JBQWdCO2dCQUNwQixJQUFJLEVBQUUsTUFBTTtnQkFDWixPQUFPLEVBQUUsMENBQTBDO2dCQUNuRCxRQUFRLEVBQUUsaUJBQWlCO2dCQUMzQixVQUFVLEVBQUUsVUFBVTtnQkFDdEIsV0FBVyxFQUFFLGVBQWU7Z0JBQzVCLGFBQWEsRUFBRSxpQkFBaUI7Z0JBQ2hDLFNBQVMsRUFBRSxJQUFJLElBQUksQ0FBQyxzQkFB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WUFFL0MsbUJBQW1CO1lBQ25CLE1BQU0sZ0JBQWdCLEdBQUcsRUFBRSxFQUFFLEVBQUUsVUFBVSxFQUFFLE1BQU0sRUFBRSxTQUFTLEVBQUUsQ0FBQztZQUMvRCxnQkFBZ0IsQ0FBQyxlQUFlLENBQUMsaUJBQWlCLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztZQUNyRSxNQUFNLFVBQVUsR0FBRyxNQUFNLFVBQVUsQ0FBQyxlQUFlLENBQ2pELFdBQVcsRUFDWCxNQUFNLEVBQ04sVUFBVSxFQUNWLEVBQUUsTUFBTSxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsdUJBQXVCLEVBQUUsQ0FDdEQsQ0FBQztZQUNGLE1BQU0sQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQzVDLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS93ZXRvb2EvRG9jdW1lbnRzL2NvZGUvcHJvamVjdHMvbWVudGFyYS9tZW50YXJhLWFwaS9zcmMvYWRtaW4vY29udHJvbGxlcnMvYWRtaW4tbW9kZXJhdGlvbi5jb250cm9sbGVyLnNwZWMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBUZXN0IFN1aXRlIGZvciBBZG1pbk1vZGVyYXRpb25Db250cm9sbGVyXG4gKiBUZXN0cyBiYXNpYyBhZG1pbiBtb2RlcmF0aW9uIGZ1bmN0aW9uYWxpdHkgZm9yIGNvbnRlbnQgcmV2aWV3XG4gKi9cblxuaW1wb3J0IHsgVGVzdCwgVGVzdGluZ01vZHVsZSB9IGZyb20gJ0BuZXN0anMvdGVzdGluZyc7XG5pbXBvcnQgeyBIdHRwRXhjZXB0aW9uLCBIdHRwU3RhdHVzIH0gZnJvbSAnQG5lc3Rqcy9jb21tb24nO1xuaW1wb3J0IHsgQWRtaW5Nb2RlcmF0aW9uQ29udHJvbGxlciB9IGZyb20gJy4vYWRtaW4tbW9kZXJhdGlvbi5jb250cm9sbGVyJztcbmltcG9ydCB7IEFkbWluU2VydmljZSB9IGZyb20gJy4uL2FkbWluLnNlcnZpY2UnO1xuaW1wb3J0IHsgSnd0QXV0aEd1YXJkIH0gZnJvbSAnLi4vLi4vYXV0aC9ndWFyZHMvand0LWF1dGguZ3VhcmQnO1xuaW1wb3J0IHsgQWRtaW5BdXRoR3VhcmQgfSBmcm9tICcuLi8uLi9hdXRoL2d1YXJkcy9hZG1pbi1hdXRoLmd1YXJkJztcblxuZGVzY3JpYmUoJ0FkbWluTW9kZXJhdGlvbkNvbnRyb2xsZXInLCAoKSA9PiB7XG4gIGxldCBjb250cm9sbGVyOiBBZG1pbk1vZGVyYXRpb25Db250cm9sbGVyO1xuICBsZXQgYWRtaW5TZXJ2aWNlOiBBZG1pblNlcnZpY2U7XG4gIGxldCBtb2R1bGU6IFRlc3RpbmdNb2R1bGU7XG5cbiAgLy8gTW9jayBBZG1pblNlcnZpY2VcbiAgY29uc3QgbW9ja0FkbWluU2VydmljZSA9IHtcbiAgICBnZXRGbGFnZ2VkQ29udGVudDogamVzdC5mbigpLFxuICAgIG1vZGVyYXRlQ29udGVudDogamVzdC5mbigpLFxuICB9O1xuXG4gIC8vIE1vY2sgR3VhcmRzXG4gIGNvbnN0IG1vY2tKd3RBdXRoR3VhcmQgPSB7XG4gICAgY2FuQWN0aXZhdGU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUodHJ1ZSksXG4gIH07XG5cbiAgY29uc3QgbW9ja0FkbWluQXV0aEd1YXJkID0ge1xuICAgIGNhbkFjdGl2YXRlOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHRydWUpLFxuICB9O1xuXG4gIC8vIFRlc3QgZGF0YVxuICBjb25zdCBtb2NrRmxhZ2dlZENvbnRlbnQgPSB7XG4gICAgY29udGVudDogW1xuICAgICAge1xuICAgICAgICBpZDogJ3Bvc3RfMTIzNDU2Nzg5JyxcbiAgICAgICAgdHlwZTogJ3Bvc3QnLFxuICAgICAgICBjb250ZW50OiAnVGhpcyBwb3N0IGNvbnRhaW5zIGluYXBwcm9wcmlhdGUgY29udGVudCcsXG4gICAgICAgIGF1dGhvcklkOiAndXNlcl9jbGllbnRfMTIzJyxcbiAgICAgICAgYXV0aG9yTmFtZTogJ0pvaG4gRG9lJyxcbiAgICAgICAgY29tbXVuaXR5SWQ6ICdjb21tdW5pdHlfMTIzJyxcbiAgICAgICAgY29tbXVuaXR5TmFtZTogJ0FueGlldHkgU3VwcG9ydCcsXG4gICAgICAgIGZsYWdnZWRBdDogbmV3IERhdGUoJzIwMjQtMDItMTRUMTA6MDA6MDBaJyksXG4gICAgICAgIGZsYWdnZWRCeTogJ3VzZXJfbW9kZXJhdG9yXzEyMycsXG4gICAgICAgIGZsYWdSZWFzb246ICdJbmFwcHJvcHJpYXRlIGNvbnRlbnQnLFxuICAgICAgICBmbGFnQ291bnQ6IDMsXG4gICAgICAgIHN0YXR1czogJ3BlbmRpbmcnLFxuICAgICAgICBwcmlvcml0eTogJ21lZGl1bScsXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBpZDogJ2NvbW1lbnRfOTg3NjU0MzIxJyxcbiAgICAgICAgdHlwZTogJ2NvbW1lbnQnLFxuICAgICAgICBjb250ZW50OiAnVGhpcyBjb21tZW50IHZpb2xhdGVzIGNvbW11bml0eSBndWlkZWxpbmVzJyxcbiAgICAgICAgYXV0aG9ySWQ6ICd1c2VyX2NsaWVudF80NTYnLFxuICAgICAgICBhdXRob3JOYW1lOiAnSmFuZSBTbWl0aCcsXG4gICAgICAgIHBhcmVudFBvc3RJZDogJ3Bvc3RfcGFyZW50XzEyMycsXG4gICAgICAgIGZsYWdnZWRBdDogbmV3IERhdGUoJzIwMjQtMDItMTRUMTE6MDA6MDBaJyksXG4gICAgICAgIGZsYWdnZWRCeTogJ3N5c3RlbScsXG4gICAgICAgIGZsYWdSZWFzb246ICdBdXRvbWF0ZWQgZGV0ZWN0aW9uJyxcbiAgICAgICAgZmxhZ0NvdW50OiAxLFxuICAgICAgICBzdGF0dXM6ICdwZW5kaW5nJyxcbiAgICAgICAgcHJpb3JpdHk6ICdoaWdoJyxcbiAgICAgIH0sXG4gICAgXSxcbiAgICBwYWdpbmF0aW9uOiB7XG4gICAgICBwYWdlOiAxLFxuICAgICAgbGltaXQ6IDEwLFxuICAgICAgdG90YWw6IDIsXG4gICAgICB0b3RhbFBhZ2VzOiAxLFxuICAgIH0sXG4gICAgc3VtbWFyeToge1xuICAgICAgdG90YWxGbGFnZ2VkOiAyLFxuICAgICAgcGVuZGluZ1JldmlldzogMixcbiAgICAgIGFwcHJvdmVkOiAwLFxuICAgICAgcmVtb3ZlZDogMCxcbiAgICAgIGhpZ2hQcmlvcml0eTogMSxcbiAgICAgIG1lZGl1bVByaW9yaXR5OiAxLFxuICAgICAgbG93UHJpb3JpdHk6IDAsXG4gICAgfSxcbiAgfTtcblxuICBiZWZvcmVFYWNoKGFzeW5jICgpID0+IHtcbiAgICBtb2R1bGUgPSBhd2FpdCBUZXN0LmNyZWF0ZVRlc3RpbmdNb2R1bGUoe1xuICAgICAgY29udHJvbGxlcnM6IFtBZG1pbk1vZGVyYXRpb25Db250cm9sbGVyXSxcbiAgICAgIHByb3ZpZGVyczogW1xuICAgICAgICB7XG4gICAgICAgICAgcHJvdmlkZTogQWRtaW5TZXJ2aWNlLFxuICAgICAgICAgIHVzZVZhbHVlOiBtb2NrQWRtaW5TZXJ2aWNlLFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICB9KVxuICAgICAgLm92ZXJyaWRlR3VhcmQoSnd0QXV0aEd1YXJkKVxuICAgICAgLnVzZVZhbHVlKG1vY2tKd3RBdXRoR3VhcmQpXG4gICAgICAub3ZlcnJpZGVHdWFyZChBZG1pbkF1dGhHdWFyZClcbiAgICAgIC51c2VWYWx1ZShtb2NrQWRtaW5BdXRoR3VhcmQpXG4gICAgICAuY29tcGlsZSgpO1xuXG4gICAgY29udHJvbGxlciA9IG1vZHVsZS5nZXQ8QWRtaW5Nb2RlcmF0aW9uQ29udHJvbGxlcj4oQWRtaW5Nb2RlcmF0aW9uQ29udHJvbGxlcik7XG4gICAgYWRtaW5TZXJ2aWNlID0gbW9kdWxlLmdldDxBZG1pblNlcnZpY2U+KEFkbWluU2VydmljZSk7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdDb250cm9sbGVyIEluaXRpYWxpemF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgYmUgZGVmaW5lZCcsICgpID0+IHtcbiAgICAgIGV4cGVjdChjb250cm9sbGVyKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYXZlIGFkbWluU2VydmljZSBpbmplY3RlZCcsICgpID0+IHtcbiAgICAgIGV4cGVjdChhZG1pblNlcnZpY2UpLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdTZWN1cml0eSBHdWFyZHMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBiZSBwcm90ZWN0ZWQgYnkgSnd0QXV0aEd1YXJkIGFuZCBBZG1pbkF1dGhHdWFyZCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGd1YXJkcyA9IFJlZmxlY3QuZ2V0TWV0YWRhdGEoJ19fZ3VhcmRzX18nLCBBZG1pbk1vZGVyYXRpb25Db250cm9sbGVyKTtcbiAgICAgIGV4cGVjdChndWFyZHMpLnRvQ29udGFpbihKd3RBdXRoR3VhcmQpO1xuICAgICAgZXhwZWN0KGd1YXJkcykudG9Db250YWluKEFkbWluQXV0aEd1YXJkKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGF2ZSBwcm9wZXIgcm91dGUgZGVjb3JhdG9ycycsICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbnRyb2xsZXJNZXRhZGF0YSA9IFJlZmxlY3QuZ2V0TWV0YWRhdGEoJ3BhdGgnLCBBZG1pbk1vZGVyYXRpb25Db250cm9sbGVyKTtcbiAgICAgIGV4cGVjdChjb250cm9sbGVyTWV0YWRhdGEpLnRvQmUoJ2FkbWluL21vZGVyYXRpb24nKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGF2ZSBBZG1pbk9ubHkgZGVjb3JhdG9ycyBvbiBhbGwgbWV0aG9kcycsICgpID0+IHtcbiAgICAgIGNvbnN0IG1ldGhvZHMgPSBbXG4gICAgICAgICdnZXRGbGFnZ2VkQ29udGVudCcsXG4gICAgICAgICdtb2RlcmF0ZUNvbnRlbnQnLFxuICAgICAgXTtcbiAgICAgIFxuICAgICAgbWV0aG9kcy5mb3JFYWNoKG1ldGhvZCA9PiB7XG4gICAgICAgIGNvbnN0IG1ldGFkYXRhID0gUmVmbGVjdC5nZXRNZXRhZGF0YSgnYWRtaW5fb25seScsIGNvbnRyb2xsZXJbbWV0aG9kIGFzIGtleW9mIEFkbWluTW9kZXJhdGlvbkNvbnRyb2xsZXJdKTtcbiAgICAgICAgZXhwZWN0KG1ldGFkYXRhKS50b0JlVHJ1dGh5KCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0dFVCAvYWRtaW4vbW9kZXJhdGlvbi9mbGFnZ2VkJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZ2V0IGZsYWdnZWQgY29udGVudCB3aXRoIGRlZmF1bHQgcGFnaW5hdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tBZG1pblNlcnZpY2UuZ2V0RmxhZ2dlZENvbnRlbnQubW9ja1Jlc29sdmVkVmFsdWUobW9ja0ZsYWdnZWRDb250ZW50KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5nZXRGbGFnZ2VkQ29udGVudCgnYWRtaW5fMTIzJyk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja0ZsYWdnZWRDb250ZW50KTtcbiAgICAgIGV4cGVjdChhZG1pblNlcnZpY2UuZ2V0RmxhZ2dlZENvbnRlbnQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgdHlwZTogdW5kZWZpbmVkLFxuICAgICAgICBwYWdlOiAxLFxuICAgICAgICBsaW1pdDogMTAsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZ2V0IGZsYWdnZWQgY29udGVudCB3aXRoIGN1c3RvbSBwYXJhbWV0ZXJzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0FkbWluU2VydmljZS5nZXRGbGFnZ2VkQ29udGVudC5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrRmxhZ2dlZENvbnRlbnQpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldEZsYWdnZWRDb250ZW50KCdhZG1pbl8xMjMnLCAncG9zdCcsICcyJywgJzIwJyk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja0ZsYWdnZWRDb250ZW50KTtcbiAgICAgIGV4cGVjdChhZG1pblNlcnZpY2UuZ2V0RmxhZ2dlZENvbnRlbnQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgdHlwZTogJ3Bvc3QnLFxuICAgICAgICBwYWdlOiAyLFxuICAgICAgICBsaW1pdDogMjAsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZmlsdGVyIGJ5IGNvbnRlbnQgdHlwZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbnRlbnRUeXBlcyA9IFsncG9zdCcsICdjb21tZW50JywgJ21lc3NhZ2UnLCAncHJvZmlsZSddO1xuICAgICAgXG4gICAgICBmb3IgKGNvbnN0IHR5cGUgb2YgY29udGVudFR5cGVzKSB7XG4gICAgICAgIGNvbnN0IGZpbHRlcmVkQ29udGVudCA9IHtcbiAgICAgICAgICAuLi5tb2NrRmxhZ2dlZENvbnRlbnQsXG4gICAgICAgICAgY29udGVudDogbW9ja0ZsYWdnZWRDb250ZW50LmNvbnRlbnQuZmlsdGVyKGl0ZW0gPT4gaXRlbS50eXBlID09PSB0eXBlKSxcbiAgICAgICAgfTtcbiAgICAgICAgbW9ja0FkbWluU2VydmljZS5nZXRGbGFnZ2VkQ29udGVudC5tb2NrUmVzb2x2ZWRWYWx1ZShmaWx0ZXJlZENvbnRlbnQpO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0RmxhZ2dlZENvbnRlbnQoJ2FkbWluXzEyMycsIHR5cGUpO1xuXG4gICAgICAgIGV4cGVjdChhZG1pblNlcnZpY2UuZ2V0RmxhZ2dlZENvbnRlbnQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHsgdHlwZSB9KVxuICAgICAgICApO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgaW52YWxpZCBwYWdpbmF0aW9uIHBhcmFtZXRlcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrQWRtaW5TZXJ2aWNlLmdldEZsYWdnZWRDb250ZW50Lm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tGbGFnZ2VkQ29udGVudCk7XG5cbiAgICAgIC8vIFRlc3Qgd2l0aCBpbnZhbGlkIHN0cmluZyB2YWx1ZXMgdGhhdCBzaG91bGQgYmUgY29udmVydGVkXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldEZsYWdnZWRDb250ZW50KCdhZG1pbl8xMjMnLCB1bmRlZmluZWQsICdpbnZhbGlkJywgJ2ludmFsaWQnKTtcblxuICAgICAgZXhwZWN0KGFkbWluU2VydmljZS5nZXRGbGFnZ2VkQ29udGVudCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICB0eXBlOiB1bmRlZmluZWQsXG4gICAgICAgIHBhZ2U6IE5hTixcbiAgICAgICAgbGltaXQ6IE5hTixcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgZmxhZ2dlZCBjb250ZW50JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZW1wdHlDb250ZW50ID0ge1xuICAgICAgICBjb250ZW50OiBbXSxcbiAgICAgICAgcGFnaW5hdGlvbjogeyBwYWdlOiAxLCBsaW1pdDogMTAsIHRvdGFsOiAwLCB0b3RhbFBhZ2VzOiAwIH0sXG4gICAgICAgIHN1bW1hcnk6IHsgdG90YWxGbGFnZ2VkOiAwLCBwZW5kaW5nUmV2aWV3OiAwLCBhcHByb3ZlZDogMCwgcmVtb3ZlZDogMCwgaGlnaFByaW9yaXR5OiAwLCBtZWRpdW1Qcmlvcml0eTogMCwgbG93UHJpb3JpdHk6IDAgfSxcbiAgICAgIH07XG4gICAgICBtb2NrQWRtaW5TZXJ2aWNlLmdldEZsYWdnZWRDb250ZW50Lm1vY2tSZXNvbHZlZFZhbHVlKGVtcHR5Q29udGVudCk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0RmxhZ2dlZENvbnRlbnQoJ2FkbWluXzEyMycpO1xuXG4gICAgICBleHBlY3QocmVzdWx0LmNvbnRlbnQpLnRvSGF2ZUxlbmd0aCgwKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VtbWFyeS50b3RhbEZsYWdnZWQpLnRvQmUoMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzZXJ2aWNlIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHNlcnZpY2VFcnJvciA9IG5ldyBFcnJvcignRGF0YWJhc2UgcXVlcnkgZmFpbGVkJyk7XG4gICAgICBtb2NrQWRtaW5TZXJ2aWNlLmdldEZsYWdnZWRDb250ZW50Lm1vY2tSZWplY3RlZFZhbHVlKHNlcnZpY2VFcnJvcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChjb250cm9sbGVyLmdldEZsYWdnZWRDb250ZW50KCdhZG1pbl8xMjMnKSkucmVqZWN0cy50b1Rocm93KEh0dHBFeGNlcHRpb24pO1xuICAgICAgYXdhaXQgZXhwZWN0KGNvbnRyb2xsZXIuZ2V0RmxhZ2dlZENvbnRlbnQoJ2FkbWluXzEyMycpKS5yZWplY3RzLnRvVGhyb3coJ0ZhaWxlZCB0byByZXRyaWV2ZSBmbGFnZ2VkIGNvbnRlbnQnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbG9nIGFkbWluIGFjdGlvbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBsb2dTcHkgPSBqZXN0LnNweU9uKGNvbnRyb2xsZXJbJ2xvZ2dlciddLCAnbG9nJyk7XG4gICAgICBtb2NrQWRtaW5TZXJ2aWNlLmdldEZsYWdnZWRDb250ZW50Lm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tGbGFnZ2VkQ29udGVudCk7XG5cbiAgICAgIGF3YWl0IGNvbnRyb2xsZXIuZ2V0RmxhZ2dlZENvbnRlbnQoJ2FkbWluXzEyMycpO1xuXG4gICAgICBleHBlY3QobG9nU3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnQWRtaW4gYWRtaW5fMTIzIHJldHJpZXZpbmcgZmxhZ2dlZCBjb250ZW50Jyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdQVVQgL2FkbWluL21vZGVyYXRpb24vOmNvbnRlbnRUeXBlLzpjb250ZW50SWQvbW9kZXJhdGUnLCAoKSA9PiB7XG4gICAgY29uc3QgY29udGVudFR5cGUgPSAncG9zdCc7XG4gICAgY29uc3QgY29udGVudElkID0gJ3Bvc3RfMTIzNDU2Nzg5JztcbiAgICBjb25zdCBtb2RlcmF0aW9uRGF0YSA9IHtcbiAgICAgIGFjdGlvbjogJ3JlbW92ZScgYXMgY29uc3QsXG4gICAgICByZWFzb246ICdWaW9sYXRlcyBjb21tdW5pdHkgZ3VpZGVsaW5lcycsXG4gICAgfTtcblxuICAgIGl0KCdzaG91bGQgbW9kZXJhdGUgY29udGVudCBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2RlcmF0ZWRDb250ZW50ID0ge1xuICAgICAgICBpZDogY29udGVudElkLFxuICAgICAgICB0eXBlOiBjb250ZW50VHlwZSxcbiAgICAgICAgc3RhdHVzOiAncmVtb3ZlZCcsXG4gICAgICAgIG1vZGVyYXRlZEJ5OiAnYWRtaW5fMTIzJyxcbiAgICAgICAgbW9kZXJhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICAgIGFjdGlvbjogbW9kZXJhdGlvbkRhdGEuYWN0aW9uLFxuICAgICAgICByZWFzb246IG1vZGVyYXRpb25EYXRhLnJlYXNvbixcbiAgICAgIH07XG4gICAgICBtb2NrQWRtaW5TZXJ2aWNlLm1vZGVyYXRlQ29udGVudC5tb2NrUmVzb2x2ZWRWYWx1ZShtb2RlcmF0ZWRDb250ZW50KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5tb2RlcmF0ZUNvbnRlbnQoXG4gICAgICAgICdhZG1pbl8xMjMnLFxuICAgICAgICBjb250ZW50VHlwZSxcbiAgICAgICAgY29udGVudElkLFxuICAgICAgICBtb2RlcmF0aW9uRGF0YVxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2RlcmF0ZWRDb250ZW50KTtcbiAgICAgIGV4cGVjdChhZG1pblNlcnZpY2UubW9kZXJhdGVDb250ZW50KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgY29udGVudFR5cGUsXG4gICAgICAgIGNvbnRlbnRJZCxcbiAgICAgICAgJ2FkbWluXzEyMycsXG4gICAgICAgIG1vZGVyYXRpb25EYXRhLmFjdGlvbixcbiAgICAgICAgbW9kZXJhdGlvbkRhdGEucmVhc29uXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgYWxsIG1vZGVyYXRpb24gYWN0aW9ucycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGFjdGlvbnMgPSBbJ2FwcHJvdmUnLCAncmVtb3ZlJywgJ2ZsYWcnXSBhcyBjb25zdDtcbiAgICAgIFxuICAgICAgZm9yIChjb25zdCBhY3Rpb24gb2YgYWN0aW9ucykge1xuICAgICAgICBjb25zdCBkYXRhID0geyBhY3Rpb24sIHJlYXNvbjogYFRlc3QgJHthY3Rpb259IGFjdGlvbmAgfTtcbiAgICAgICAgY29uc3QgbW9kZXJhdGVkQ29udGVudCA9IHtcbiAgICAgICAgICBpZDogY29udGVudElkLFxuICAgICAgICAgIHR5cGU6IGNvbnRlbnRUeXBlLFxuICAgICAgICAgIHN0YXR1czogYWN0aW9uID09PSAnYXBwcm92ZScgPyAnYXBwcm92ZWQnIDogYWN0aW9uID09PSAncmVtb3ZlJyA/ICdyZW1vdmVkJyA6ICdmbGFnZ2VkJyxcbiAgICAgICAgICBhY3Rpb24sXG4gICAgICAgIH07XG4gICAgICAgIG1vY2tBZG1pblNlcnZpY2UubW9kZXJhdGVDb250ZW50Lm1vY2tSZXNvbHZlZFZhbHVlKG1vZGVyYXRlZENvbnRlbnQpO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIubW9kZXJhdGVDb250ZW50KFxuICAgICAgICAgICdhZG1pbl8xMjMnLFxuICAgICAgICAgIGNvbnRlbnRUeXBlLFxuICAgICAgICAgIGNvbnRlbnRJZCxcbiAgICAgICAgICBkYXRhXG4gICAgICAgICk7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdC5hY3Rpb24pLnRvQmUoYWN0aW9uKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGRpZmZlcmVudCBjb250ZW50IHR5cGVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY29udGVudFR5cGVzID0gWydwb3N0JywgJ2NvbW1lbnQnLCAnbWVzc2FnZScsICdwcm9maWxlJ107XG4gICAgICBcbiAgICAgIGZvciAoY29uc3QgdHlwZSBvZiBjb250ZW50VHlwZXMpIHtcbiAgICAgICAgY29uc3QgbW9kZXJhdGVkQ29udGVudCA9IHtcbiAgICAgICAgICBpZDogY29udGVudElkLFxuICAgICAgICAgIHR5cGUsXG4gICAgICAgICAgc3RhdHVzOiAnYXBwcm92ZWQnLFxuICAgICAgICAgIGFjdGlvbjogJ2FwcHJvdmUnLFxuICAgICAgICB9O1xuICAgICAgICBtb2NrQWRtaW5TZXJ2aWNlLm1vZGVyYXRlQ29udGVudC5tb2NrUmVzb2x2ZWRWYWx1ZShtb2RlcmF0ZWRDb250ZW50KTtcblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLm1vZGVyYXRlQ29udGVudChcbiAgICAgICAgICAnYWRtaW5fMTIzJyxcbiAgICAgICAgICB0eXBlLFxuICAgICAgICAgIGNvbnRlbnRJZCxcbiAgICAgICAgICB7IGFjdGlvbjogJ2FwcHJvdmUnIH1cbiAgICAgICAgKTtcblxuICAgICAgICBleHBlY3QocmVzdWx0LnR5cGUpLnRvQmUodHlwZSk7XG4gICAgICAgIGV4cGVjdChhZG1pblNlcnZpY2UubW9kZXJhdGVDb250ZW50KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgICB0eXBlLFxuICAgICAgICAgIGNvbnRlbnRJZCxcbiAgICAgICAgICAnYWRtaW5fMTIzJyxcbiAgICAgICAgICAnYXBwcm92ZScsXG4gICAgICAgICAgdW5kZWZpbmVkXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBtb2RlcmF0aW9uIHdpdGhvdXQgcmVhc29uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZGF0YVdpdGhvdXRSZWFzb24gPSB7IGFjdGlvbjogJ2FwcHJvdmUnIGFzIGNvbnN0IH07XG4gICAgICBjb25zdCBtb2RlcmF0ZWRDb250ZW50ID0ge1xuICAgICAgICBpZDogY29udGVudElkLFxuICAgICAgICB0eXBlOiBjb250ZW50VHlwZSxcbiAgICAgICAgc3RhdHVzOiAnYXBwcm92ZWQnLFxuICAgICAgICBhY3Rpb246ICdhcHByb3ZlJyxcbiAgICAgIH07XG4gICAgICBtb2NrQWRtaW5TZXJ2aWNlLm1vZGVyYXRlQ29udGVudC5tb2NrUmVzb2x2ZWRWYWx1ZShtb2RlcmF0ZWRDb250ZW50KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5tb2RlcmF0ZUNvbnRlbnQoXG4gICAgICAgICdhZG1pbl8xMjMnLFxuICAgICAgICBjb250ZW50VHlwZSxcbiAgICAgICAgY29udGVudElkLFxuICAgICAgICBkYXRhV2l0aG91dFJlYXNvblxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2RlcmF0ZWRDb250ZW50KTtcbiAgICAgIGV4cGVjdChhZG1pblNlcnZpY2UubW9kZXJhdGVDb250ZW50KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgY29udGVudFR5cGUsXG4gICAgICAgIGNvbnRlbnRJZCxcbiAgICAgICAgJ2FkbWluXzEyMycsXG4gICAgICAgICdhcHByb3ZlJyxcbiAgICAgICAgdW5kZWZpbmVkXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgY29udGVudCBub3QgZm91bmQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBub3RGb3VuZEVycm9yID0gbmV3IEVycm9yKCdDb250ZW50IG5vdCBmb3VuZCcpO1xuICAgICAgbW9ja0FkbWluU2VydmljZS5tb2RlcmF0ZUNvbnRlbnQubW9ja1JlamVjdGVkVmFsdWUobm90Rm91bmRFcnJvcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5tb2RlcmF0ZUNvbnRlbnQoJ2FkbWluXzEyMycsIGNvbnRlbnRUeXBlLCAnbm9uLWV4aXN0ZW50LWlkJywgbW9kZXJhdGlvbkRhdGEpXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhIdHRwRXhjZXB0aW9uKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbG9nIGFkbWluIGFjdGlvbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBsb2dTcHkgPSBqZXN0LnNweU9uKGNvbnRyb2xsZXJbJ2xvZ2dlciddLCAnbG9nJyk7XG4gICAgICBjb25zdCBtb2RlcmF0ZWRDb250ZW50ID0geyBpZDogY29udGVudElkLCBzdGF0dXM6ICdyZW1vdmVkJyB9O1xuICAgICAgbW9ja0FkbWluU2VydmljZS5tb2RlcmF0ZUNvbnRlbnQubW9ja1Jlc29sdmVkVmFsdWUobW9kZXJhdGVkQ29udGVudCk7XG5cbiAgICAgIGF3YWl0IGNvbnRyb2xsZXIubW9kZXJhdGVDb250ZW50KCdhZG1pbl8xMjMnLCBjb250ZW50VHlwZSwgY29udGVudElkLCBtb2RlcmF0aW9uRGF0YSk7XG5cbiAgICAgIGV4cGVjdChsb2dTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGBBZG1pbiBhZG1pbl8xMjMgbW9kZXJhdGluZyAke2NvbnRlbnRUeXBlfSAke2NvbnRlbnRJZH1gKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0Vycm9yIEhhbmRsaW5nJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIHNlcnZpY2UgdW5hdmFpbGFibGUgc2NlbmFyaW9zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgc2VydmljZUVycm9yID0gbmV3IEVycm9yKCdTZXJ2aWNlIHRlbXBvcmFyaWx5IHVuYXZhaWxhYmxlJyk7XG4gICAgICBtb2NrQWRtaW5TZXJ2aWNlLmdldEZsYWdnZWRDb250ZW50Lm1vY2tSZWplY3RlZFZhbHVlKHNlcnZpY2VFcnJvcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChjb250cm9sbGVyLmdldEZsYWdnZWRDb250ZW50KCdhZG1pbl8xMjMnKSkucmVqZWN0cy50b1Rocm93KEh0dHBFeGNlcHRpb24pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZGF0YWJhc2UgZXJyb3JzIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBkYkVycm9yID0gbmV3IEVycm9yKCdEYXRhYmFzZSBjb25uZWN0aW9uIGZhaWxlZCcpO1xuICAgICAgbW9ja0FkbWluU2VydmljZS5tb2RlcmF0ZUNvbnRlbnQubW9ja1JlamVjdGVkVmFsdWUoZGJFcnJvcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5tb2RlcmF0ZUNvbnRlbnQoJ2FkbWluXzEyMycsICdwb3N0JywgJ3Bvc3RfMTIzJywgeyBhY3Rpb246ICdhcHByb3ZlJyB9KVxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coSHR0cEV4Y2VwdGlvbik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdSZXNwb25zZSBGb3JtYXQgVmFsaWRhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiBwcm9wZXJseSBmb3JtYXR0ZWQgZmxhZ2dlZCBjb250ZW50IHJlc3BvbnNlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0FkbWluU2VydmljZS5nZXRGbGFnZ2VkQ29udGVudC5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrRmxhZ2dlZENvbnRlbnQpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmdldEZsYWdnZWRDb250ZW50KCdhZG1pbl8xMjMnKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ2NvbnRlbnQnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdwYWdpbmF0aW9uJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgnc3VtbWFyeScpO1xuICAgICAgZXhwZWN0KEFycmF5LmlzQXJyYXkocmVzdWx0LmNvbnRlbnQpKS50b0JlKHRydWUpO1xuICAgICAgcmVzdWx0LmNvbnRlbnQuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgICBleHBlY3QoaXRlbSkudG9IYXZlUHJvcGVydHkoJ2lkJyk7XG4gICAgICAgIGV4cGVjdChpdGVtKS50b0hhdmVQcm9wZXJ0eSgndHlwZScpO1xuICAgICAgICBleHBlY3QoaXRlbSkudG9IYXZlUHJvcGVydHkoJ2NvbnRlbnQnKTtcbiAgICAgICAgZXhwZWN0KGl0ZW0pLnRvSGF2ZVByb3BlcnR5KCdhdXRob3JJZCcpO1xuICAgICAgICBleHBlY3QoaXRlbSkudG9IYXZlUHJvcGVydHkoJ2ZsYWdnZWRBdCcpO1xuICAgICAgICBleHBlY3QoWydwZW5kaW5nJywgJ2FwcHJvdmVkJywgJ3JlbW92ZWQnXSkudG9Db250YWluKGl0ZW0uc3RhdHVzKTtcbiAgICAgICAgZXhwZWN0KFsnbG93JywgJ21lZGl1bScsICdoaWdoJ10pLnRvQ29udGFpbihpdGVtLnByaW9yaXR5KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnSW50ZWdyYXRpb24gVGVzdHMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgY29tcGxldGUgbW9kZXJhdGlvbiB3b3JrZmxvdycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEdldCBmbGFnZ2VkIGNvbnRlbnRcbiAgICAgIG1vY2tBZG1pblNlcnZpY2UuZ2V0RmxhZ2dlZENvbnRlbnQubW9ja1Jlc29sdmVkVmFsdWUobW9ja0ZsYWdnZWRDb250ZW50KTtcbiAgICAgIGNvbnN0IGZsYWdnZWRDb250ZW50ID0gYXdhaXQgY29udHJvbGxlci5nZXRGbGFnZ2VkQ29udGVudCgnYWRtaW5fMTIzJyk7XG4gICAgICBleHBlY3QoZmxhZ2dlZENvbnRlbnQuY29udGVudCkudG9IYXZlTGVuZ3RoKDIpO1xuXG4gICAgICAvLyBNb2RlcmF0ZSBjb250ZW50XG4gICAgICBjb25zdCBtb2RlcmF0ZWRDb250ZW50ID0geyBpZDogJ3Bvc3RfMTIzJywgc3RhdHVzOiAncmVtb3ZlZCcgfTtcbiAgICAgIG1vY2tBZG1pblNlcnZpY2UubW9kZXJhdGVDb250ZW50Lm1vY2tSZXNvbHZlZFZhbHVlKG1vZGVyYXRlZENvbnRlbnQpO1xuICAgICAgY29uc3QgbW9kZXJhdGlvbiA9IGF3YWl0IGNvbnRyb2xsZXIubW9kZXJhdGVDb250ZW50KFxuICAgICAgICAnYWRtaW5fMTIzJyxcbiAgICAgICAgJ3Bvc3QnLFxuICAgICAgICAncG9zdF8xMjMnLFxuICAgICAgICB7IGFjdGlvbjogJ3JlbW92ZScsIHJlYXNvbjogJ0luYXBwcm9wcmlhdGUgY29udGVudCcgfVxuICAgICAgKTtcbiAgICAgIGV4cGVjdChtb2RlcmF0aW9uLnN0YXR1cykudG9CZSgncmVtb3ZlZCcpO1xuICAgIH0pO1xuICB9KTtcbn0pOyJdLCJ2ZXJzaW9uIjozfQ==