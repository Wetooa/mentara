{"file":"/home/wetooa/Documents/code/projects/mentara/mentara-api/src/admin/controllers/admin-therapist.controller.ts","mappings":"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","names":[],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/admin/controllers/admin-therapist.controller.ts"],"sourcesContent":["import {\n  Controller,\n  Get,\n  Post,\n  Put,\n  Param,\n  Body,\n  Query,\n  UseGuards,\n  HttpCode,\n  HttpStatus,\n  Logger,\n  NotFoundException,\n  BadRequestException,\n} from '@nestjs/common';\nimport { JwtAuthGuard } from '../../auth/guards/jwt-auth.guard';\nimport { AdminAuthGuard } from '../../auth/guards/admin-auth.guard';\nimport { AdminOnly } from '../../auth/decorators/admin-only.decorator';\nimport { CurrentUserId } from '../../auth/decorators/current-user-id.decorator';\nimport { ZodValidationPipe } from '../../common/pipes/zod-validation.pipe';\nimport {\n  ApproveTherapistDtoSchema,\n  RejectTherapistDtoSchema,\n  UpdateTherapistStatusDtoSchema,\n  PendingTherapistFiltersDtoSchema,\n  type ApproveTherapistDto,\n  type RejectTherapistDto,\n  type UpdateTherapistStatusDto,\n  type PendingTherapistFiltersDto,\n} from 'mentara-commons';\nimport { AdminTherapistService } from '../services/admin-therapist.service';\nimport {\n  ApiTags,\n  ApiOperation,\n  ApiResponse,\n  ApiBody,\n  ApiBearerAuth,\n  ApiParam,\n  ApiQuery,\n} from '@nestjs/swagger';\n\n@ApiTags('admin-therapist')\n@ApiBearerAuth('JWT-auth')\n@Controller('admin/therapists')\n@UseGuards(JwtAuthGuard, AdminAuthGuard)\n@AdminOnly()\nexport class AdminTherapistController {\n  private readonly logger = new Logger(AdminTherapistController.name);\n\n  constructor(private readonly adminTherapistService: AdminTherapistService) {}\n\n  @Get('pending')\n  @ApiOperation({\n    summary: 'Retrieve get pending applications',\n\n    description: 'Retrieve get pending applications',\n  })\n  @ApiResponse({\n    status: 200,\n\n    description: 'Retrieved successfully',\n  })\n  @ApiResponse({ status: 401, description: 'Unauthorized' })\n  @HttpCode(HttpStatus.OK)\n  async getPendingApplications(\n    @Query(new ZodValidationPipe(PendingTherapistFiltersDtoSchema))\n    filters: PendingTherapistFiltersDto,\n    @CurrentUserId() adminId: string,\n  ) {\n    this.logger.log(`Admin ${adminId} fetching pending therapist applications`);\n    return this.adminTherapistService.getPendingApplications(filters);\n  }\n\n  @Get('applications')\n  @ApiOperation({\n    summary: 'Retrieve get all applications',\n\n    description: 'Retrieve get all applications',\n  })\n  @ApiResponse({\n    status: 200,\n\n    description: 'Retrieved successfully',\n  })\n  @ApiResponse({ status: 401, description: 'Unauthorized' })\n  @HttpCode(HttpStatus.OK)\n  async getAllApplications(\n    @Query(new ZodValidationPipe(PendingTherapistFiltersDtoSchema))\n    filters: PendingTherapistFiltersDto,\n    @CurrentUserId() adminId: string,\n  ) {\n    this.logger.log(`Admin ${adminId} fetching all therapist applications`);\n    return this.adminTherapistService.getPendingApplications(filters);\n  }\n\n  @Get(':id/details')\n  @ApiOperation({\n    summary: 'Retrieve get application details',\n\n    description: 'Retrieve get application details',\n  })\n  @ApiResponse({\n    status: 200,\n\n    description: 'Retrieved successfully',\n  })\n  @ApiResponse({ status: 401, description: 'Unauthorized' })\n  @HttpCode(HttpStatus.OK)\n  async getApplicationDetails(\n    @Param('id') therapistId: string,\n    @CurrentUserId() adminId: string,\n  ) {\n    this.logger.log(\n      `Admin ${adminId} viewing therapist application ${therapistId}`,\n    );\n    return this.adminTherapistService.getApplicationDetails(therapistId);\n  }\n\n  @Post(':id/approve')\n  @ApiOperation({\n    summary: 'Create approve therapist',\n\n    description: 'Create approve therapist',\n  })\n  @ApiResponse({\n    status: 201,\n\n    description: 'Created successfully',\n  })\n  @ApiResponse({ status: 401, description: 'Unauthorized' })\n  @HttpCode(HttpStatus.OK)\n  async approveTherapist(\n    @Param('id') therapistId: string,\n    @Body(new ZodValidationPipe(ApproveTherapistDtoSchema))\n    approvalDto: ApproveTherapistDto,\n    @CurrentUserId() adminId: string,\n  ) {\n    this.logger.log(`Admin ${adminId} approving therapist ${therapistId}`);\n    return this.adminTherapistService.approveTherapist(\n      therapistId,\n      adminId,\n      approvalDto,\n    );\n  }\n\n  @Post(':id/reject')\n  @ApiOperation({\n    summary: 'Create reject therapist',\n\n    description: 'Create reject therapist',\n  })\n  @ApiResponse({\n    status: 201,\n\n    description: 'Created successfully',\n  })\n  @ApiResponse({ status: 401, description: 'Unauthorized' })\n  @HttpCode(HttpStatus.OK)\n  async rejectTherapist(\n    @Param('id') therapistId: string,\n    @Body(new ZodValidationPipe(RejectTherapistDtoSchema))\n    rejectionDto: RejectTherapistDto,\n    @CurrentUserId() adminId: string,\n  ) {\n    this.logger.log(`Admin ${adminId} rejecting therapist ${therapistId}`);\n    return this.adminTherapistService.rejectTherapist(\n      therapistId,\n      adminId,\n      rejectionDto,\n    );\n  }\n\n  @Put(':id/status')\n  @ApiOperation({\n    summary: 'Update update therapist status',\n\n    description: 'Update update therapist status',\n  })\n  @ApiResponse({\n    status: 200,\n\n    description: 'Updated successfully',\n  })\n  @ApiResponse({ status: 401, description: 'Unauthorized' })\n  @HttpCode(HttpStatus.OK)\n  async updateTherapistStatus(\n    @Param('id') therapistId: string,\n    @Body(new ZodValidationPipe(UpdateTherapistStatusDtoSchema))\n    statusDto: UpdateTherapistStatusDto,\n    @CurrentUserId() adminId: string,\n  ) {\n    this.logger.log(\n      `Admin ${adminId} updating therapist ${therapistId} status to ${statusDto.status}`,\n    );\n    return this.adminTherapistService.updateTherapistStatus(\n      therapistId,\n      adminId,\n      statusDto,\n    );\n  }\n\n  @Get('metrics')\n  @ApiOperation({\n    summary: 'Retrieve get therapist application metrics',\n\n    description: 'Retrieve get therapist application metrics',\n  })\n  @ApiResponse({\n    status: 200,\n\n    description: 'Retrieved successfully',\n  })\n  @ApiResponse({ status: 401, description: 'Unauthorized' })\n  @HttpCode(HttpStatus.OK)\n  async getTherapistApplicationMetrics(\n    @Query('startDate') startDate?: string,\n    @Query('endDate') endDate?: string,\n    @CurrentUserId() adminId?: string,\n  ) {\n    this.logger.log(`Admin ${adminId} fetching therapist application metrics`);\n    return this.adminTherapistService.getTherapistApplicationMetrics(\n      startDate,\n      endDate,\n    );\n  }\n}\n"],"version":3}