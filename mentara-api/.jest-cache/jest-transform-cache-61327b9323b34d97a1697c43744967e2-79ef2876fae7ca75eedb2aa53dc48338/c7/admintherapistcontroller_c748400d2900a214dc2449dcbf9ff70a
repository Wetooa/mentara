fa231a992d22a09f467a69e595bfe486
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
var AdminTherapistController_1;
var _a;
Object.defineProperty(exports, "__esModule", { value: true });
exports.AdminTherapistController = void 0;
const common_1 = require("@nestjs/common");
const jwt_auth_guard_1 = require("../../auth/guards/jwt-auth.guard");
const admin_auth_guard_1 = require("../../auth/guards/admin-auth.guard");
const admin_only_decorator_1 = require("../../auth/decorators/admin-only.decorator");
const current_user_id_decorator_1 = require("../../auth/decorators/current-user-id.decorator");
const zod_validation_pipe_1 = require("../../common/pipes/zod-validation.pipe");
const mentara_commons_1 = require("mentara-commons");
const admin_therapist_service_1 = require("../services/admin-therapist.service");
const swagger_1 = require("@nestjs/swagger");
let AdminTherapistController = AdminTherapistController_1 = class AdminTherapistController {
    adminTherapistService;
    logger = new common_1.Logger(AdminTherapistController_1.name);
    constructor(adminTherapistService) {
        this.adminTherapistService = adminTherapistService;
    }
    async getPendingApplications(filters, adminId) {
        this.logger.log(`Admin ${adminId} fetching pending therapist applications`);
        return this.adminTherapistService.getPendingApplications(filters);
    }
    async getAllApplications(filters, adminId) {
        this.logger.log(`Admin ${adminId} fetching all therapist applications`);
        return this.adminTherapistService.getPendingApplications(filters);
    }
    async getApplicationDetails(therapistId, adminId) {
        this.logger.log(`Admin ${adminId} viewing therapist application ${therapistId}`);
        return this.adminTherapistService.getApplicationDetails(therapistId);
    }
    async approveTherapist(therapistId, approvalDto, adminId) {
        this.logger.log(`Admin ${adminId} approving therapist ${therapistId}`);
        return this.adminTherapistService.approveTherapist(therapistId, adminId, approvalDto);
    }
    async rejectTherapist(therapistId, rejectionDto, adminId) {
        this.logger.log(`Admin ${adminId} rejecting therapist ${therapistId}`);
        return this.adminTherapistService.rejectTherapist(therapistId, adminId, rejectionDto);
    }
    async updateTherapistStatus(therapistId, statusDto, adminId) {
        this.logger.log(`Admin ${adminId} updating therapist ${therapistId} status to ${statusDto.status}`);
        return this.adminTherapistService.updateTherapistStatus(therapistId, adminId, statusDto);
    }
    async getTherapistApplicationMetrics(startDate, endDate, adminId) {
        this.logger.log(`Admin ${adminId} fetching therapist application metrics`);
        return this.adminTherapistService.getTherapistApplicationMetrics(startDate, endDate);
    }
};
exports.AdminTherapistController = AdminTherapistController;
__decorate([
    (0, common_1.Get)('pending'),
    (0, swagger_1.ApiOperation)({
        summary: 'Retrieve get pending applications',
        description: 'Retrieve get pending applications',
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Retrieved successfully',
    }),
    (0, swagger_1.ApiResponse)({ status: 401, description: 'Unauthorized' }),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, common_1.Query)(new zod_validation_pipe_1.ZodValidationPipe(mentara_commons_1.PendingTherapistFiltersDtoSchema))),
    __param(1, (0, current_user_id_decorator_1.CurrentUserId)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object, String]),
    __metadata("design:returntype", Promise)
], AdminTherapistController.prototype, "getPendingApplications", null);
__decorate([
    (0, common_1.Get)('applications'),
    (0, swagger_1.ApiOperation)({
        summary: 'Retrieve get all applications',
        description: 'Retrieve get all applications',
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Retrieved successfully',
    }),
    (0, swagger_1.ApiResponse)({ status: 401, description: 'Unauthorized' }),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, common_1.Query)(new zod_validation_pipe_1.ZodValidationPipe(mentara_commons_1.PendingTherapistFiltersDtoSchema))),
    __param(1, (0, current_user_id_decorator_1.CurrentUserId)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object, String]),
    __metadata("design:returntype", Promise)
], AdminTherapistController.prototype, "getAllApplications", null);
__decorate([
    (0, common_1.Get)(':id/details'),
    (0, swagger_1.ApiOperation)({
        summary: 'Retrieve get application details',
        description: 'Retrieve get application details',
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Retrieved successfully',
    }),
    (0, swagger_1.ApiResponse)({ status: 401, description: 'Unauthorized' }),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, common_1.Param)('id')),
    __param(1, (0, current_user_id_decorator_1.CurrentUserId)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, String]),
    __metadata("design:returntype", Promise)
], AdminTherapistController.prototype, "getApplicationDetails", null);
__decorate([
    (0, common_1.Post)(':id/approve'),
    (0, swagger_1.ApiOperation)({
        summary: 'Create approve therapist',
        description: 'Create approve therapist',
    }),
    (0, swagger_1.ApiResponse)({
        status: 201,
        description: 'Created successfully',
    }),
    (0, swagger_1.ApiResponse)({ status: 401, description: 'Unauthorized' }),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, common_1.Param)('id')),
    __param(1, (0, common_1.Body)(new zod_validation_pipe_1.ZodValidationPipe(mentara_commons_1.ApproveTherapistDtoSchema))),
    __param(2, (0, current_user_id_decorator_1.CurrentUserId)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, Object, String]),
    __metadata("design:returntype", Promise)
], AdminTherapistController.prototype, "approveTherapist", null);
__decorate([
    (0, common_1.Post)(':id/reject'),
    (0, swagger_1.ApiOperation)({
        summary: 'Create reject therapist',
        description: 'Create reject therapist',
    }),
    (0, swagger_1.ApiResponse)({
        status: 201,
        description: 'Created successfully',
    }),
    (0, swagger_1.ApiResponse)({ status: 401, description: 'Unauthorized' }),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, common_1.Param)('id')),
    __param(1, (0, common_1.Body)(new zod_validation_pipe_1.ZodValidationPipe(mentara_commons_1.RejectTherapistDtoSchema))),
    __param(2, (0, current_user_id_decorator_1.CurrentUserId)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, Object, String]),
    __metadata("design:returntype", Promise)
], AdminTherapistController.prototype, "rejectTherapist", null);
__decorate([
    (0, common_1.Put)(':id/status'),
    (0, swagger_1.ApiOperation)({
        summary: 'Update update therapist status',
        description: 'Update update therapist status',
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Updated successfully',
    }),
    (0, swagger_1.ApiResponse)({ status: 401, description: 'Unauthorized' }),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, common_1.Param)('id')),
    __param(1, (0, common_1.Body)(new zod_validation_pipe_1.ZodValidationPipe(mentara_commons_1.UpdateTherapistStatusDtoSchema))),
    __param(2, (0, current_user_id_decorator_1.CurrentUserId)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, Object, String]),
    __metadata("design:returntype", Promise)
], AdminTherapistController.prototype, "updateTherapistStatus", null);
__decorate([
    (0, common_1.Get)('metrics'),
    (0, swagger_1.ApiOperation)({
        summary: 'Retrieve get therapist application metrics',
        description: 'Retrieve get therapist application metrics',
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Retrieved successfully',
    }),
    (0, swagger_1.ApiResponse)({ status: 401, description: 'Unauthorized' }),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, common_1.Query)('startDate')),
    __param(1, (0, common_1.Query)('endDate')),
    __param(2, (0, current_user_id_decorator_1.CurrentUserId)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, String, String]),
    __metadata("design:returntype", Promise)
], AdminTherapistController.prototype, "getTherapistApplicationMetrics", null);
exports.AdminTherapistController = AdminTherapistController = AdminTherapistController_1 = __decorate([
    (0, swagger_1.ApiTags)('admin-therapist'),
    (0, swagger_1.ApiBearerAuth)('JWT-auth'),
    (0, common_1.Controller)('admin/therapists'),
    (0, common_1.UseGuards)(jwt_auth_guard_1.JwtAuthGuard, admin_auth_guard_1.AdminAuthGuard),
    (0, admin_only_decorator_1.AdminOnly)(),
    __metadata("design:paramtypes", [typeof (_a = typeof admin_therapist_service_1.AdminTherapistService !== "undefined" && admin_therapist_service_1.AdminTherapistService) === "function" ? _a : Object])
], AdminTherapistController);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL2FkbWluL2NvbnRyb2xsZXJzL2FkbWluLXRoZXJhcGlzdC5jb250cm9sbGVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsMkNBY3dCO0FBQ3hCLHFFQUFnRTtBQUNoRSx5RUFBb0U7QUFDcEUscUZBQXVFO0FBQ3ZFLCtGQUFnRjtBQUNoRixnRkFBMkU7QUFDM0UscURBU3lCO0FBQ3pCLGlGQUE0RTtBQUM1RSw2Q0FReUI7QUFPbEIsSUFBTSx3QkFBd0IsZ0NBQTlCLE1BQU0sd0JBQXdCO0lBR047SUFGWixNQUFNLEdBQUcsSUFBSSxlQUFNLENBQUMsMEJBQXdCLENBQUMsSUFBSSxDQUFDLENBQUM7SUFFcEUsWUFBNkIscUJBQTRDO1FBQTVDLDBCQUFxQixHQUFyQixxQkFBcUIsQ0FBdUI7SUFBRyxDQUFDO0lBZXZFLEFBQU4sS0FBSyxDQUFDLHNCQUFzQixDQUUxQixPQUFtQyxFQUNsQixPQUFlO1FBRWhDLElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLFNBQVMsT0FBTywwQ0FBMEMsQ0FBQyxDQUFDO1FBQzVFLE9BQU8sSUFBSSxDQUFDLHFCQUFxQixDQUFDLHNCQUFzQixDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ3BFLENBQUM7SUFlSyxBQUFOLEtBQUssQ0FBQyxrQkFBa0IsQ0FFdEIsT0FBbUMsRUFDbEIsT0FBZTtRQUVoQyxJQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxTQUFTLE9BQU8sc0NBQXNDLENBQUMsQ0FBQztRQUN4RSxPQUFPLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxzQkFBc0IsQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUNwRSxDQUFDO0lBZUssQUFBTixLQUFLLENBQUMscUJBQXFCLENBQ1osV0FBbUIsRUFDZixPQUFlO1FBRWhDLElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUNiLFNBQVMsT0FBTyxrQ0FBa0MsV0FBVyxF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QUM7UUFDWixPQUFPLEVBQUUsNENBQTRDO1FBRXJELFdBQVcsRUFBRSw0Q0FBNEM7S0FDMUQsQ0FBQztJQUNELElBQUEscUJBQVcsRUFBQztRQUNYLE1BQU0sRUFBRSxHQUFHO1FBRVgsV0FBVyxFQUFFLHdCQUF3QjtLQUN0QyxDQUFDO0lBQ0QsSUFBQSxxQkFBVyxFQUFDLEVBQUUsTUFBTSxFQUFFLEdBQUcsRUFBRSxXQUFXLEVBQUUsY0FBYyxFQUFFLENBQUM7SUFDekQsSUFBQSxpQkFBUSxFQUFDLG1CQUFVLENBQUMsRUFBRSxDQUFDO0lBRXJCLFdBQUEsSUFBQSxjQUFLLEVBQUMsV0FBVyxDQUFDLENBQUE7SUFDbEIsV0FBQSxJQUFBLGNBQUssRUFBQyxTQUFTLENBQUMsQ0FBQTtJQUNoQixXQUFBLElBQUEseUNBQWEsR0FBRSxDQUFBOzs7OzhFQU9qQjttQ0FsTFUsd0JBQXdCO0lBTHBDLElBQUEsaUJBQU8sRUFBQyxpQkFBaUIsQ0FBQztJQUMxQixJQUFBLHVCQUFhLEVBQUMsVUFBVSxDQUFDO0lBQ3pCLElBQUEsbUJBQVUsRUFBQyxrQkFBa0IsQ0FBQztJQUM5QixJQUFBLGtCQUFTLEVBQUMsNkJBQVksRUFBRSxpQ0FBYyxDQUFDO0lBQ3ZDLElBQUEsZ0NBQVMsR0FBRTt5REFJMEMsK0NBQXFCLG9CQUFyQiwrQ0FBcUI7R0FIOUQsd0JBQXdCLENBbUxwQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS93ZXRvb2EvRG9jdW1lbnRzL2NvZGUvcHJvamVjdHMvbWVudGFyYS9tZW50YXJhLWFwaS9zcmMvYWRtaW4vY29udHJvbGxlcnMvYWRtaW4tdGhlcmFwaXN0LmNvbnRyb2xsZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQ29udHJvbGxlcixcbiAgR2V0LFxuICBQb3N0LFxuICBQdXQsXG4gIFBhcmFtLFxuICBCb2R5LFxuICBRdWVyeSxcbiAgVXNlR3VhcmRzLFxuICBIdHRwQ29kZSxcbiAgSHR0cFN0YXR1cyxcbiAgTG9nZ2VyLFxuICBOb3RGb3VuZEV4Y2VwdGlvbixcbiAgQmFkUmVxdWVzdEV4Y2VwdGlvbixcbn0gZnJvbSAnQG5lc3Rqcy9jb21tb24nO1xuaW1wb3J0IHsgSnd0QXV0aEd1YXJkIH0gZnJvbSAnLi4vLi4vYXV0aC9ndWFyZHMvand0LWF1dGguZ3VhcmQnO1xuaW1wb3J0IHsgQWRtaW5BdXRoR3VhcmQgfSBmcm9tICcuLi8uLi9hdXRoL2d1YXJkcy9hZG1pbi1hdXRoLmd1YXJkJztcbmltcG9ydCB7IEFkbWluT25seSB9IGZyb20gJy4uLy4uL2F1dGgvZGVjb3JhdG9ycy9hZG1pbi1vbmx5LmRlY29yYXRvcic7XG5pbXBvcnQgeyBDdXJyZW50VXNlcklkIH0gZnJvbSAnLi4vLi4vYXV0aC9kZWNvcmF0b3JzL2N1cnJlbnQtdXNlci1pZC5kZWNvcmF0b3InO1xuaW1wb3J0IHsgWm9kVmFsaWRhdGlvblBpcGUgfSBmcm9tICcuLi8uLi9jb21tb24vcGlwZXMvem9kLXZhbGlkYXRpb24ucGlwZSc7XG5pbXBvcnQge1xuICBBcHByb3ZlVGhlcmFwaXN0RHRvU2NoZW1hLFxuICBSZWplY3RUaGVyYXBpc3REdG9TY2hlbWEsXG4gIFVwZGF0ZVRoZXJhcGlzdFN0YXR1c0R0b1NjaGVtYSxcbiAgUGVuZGluZ1RoZXJhcGlzdEZpbHRlcnNEdG9TY2hlbWEsXG4gIHR5cGUgQXBwcm92ZVRoZXJhcGlzdER0byxcbiAgdHlwZSBSZWplY3RUaGVyYXBpc3REdG8sXG4gIHR5cGUgVXBkYXRlVGhlcmFwaXN0U3RhdHVzRHRvLFxuICB0eXBlIFBlbmRpbmdUaGVyYXBpc3RGaWx0ZXJzRHRvLFxufSBmcm9tICdtZW50YXJhLWNvbW1vbnMnO1xuaW1wb3J0IHsgQWRtaW5UaGVyYXBpc3RTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvYWRtaW4tdGhlcmFwaXN0LnNlcnZpY2UnO1xuaW1wb3J0IHtcbiAgQXBpVGFncyxcbiAgQXBpT3BlcmF0aW9uLFxuICBBcGlSZXNwb25zZSxcbiAgQXBpQm9keSxcbiAgQXBpQmVhcmVyQXV0aCxcbiAgQXBpUGFyYW0sXG4gIEFwaVF1ZXJ5LFxufSBmcm9tICdAbmVzdGpzL3N3YWdnZXInO1xuXG5AQXBpVGFncygnYWRtaW4tdGhlcmFwaXN0JylcbkBBcGlCZWFyZXJBdXRoKCdKV1QtYXV0aCcpXG5AQ29udHJvbGxlcignYWRtaW4vdGhlcmFwaXN0cycpXG5AVXNlR3VhcmRzKEp3dEF1dGhHdWFyZCwgQWRtaW5BdXRoR3VhcmQpXG5AQWRtaW5Pbmx5KClcbmV4cG9ydCBjbGFzcyBBZG1pblRoZXJhcGlzdENvbnRyb2xsZXIge1xuICBwcml2YXRlIHJlYWRvbmx5IGxvZ2dlciA9IG5ldyBMb2dnZXIoQWRtaW5UaGVyYXBpc3RDb250cm9sbGVyLm5hbWUpO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgcmVhZG9ubHkgYWRtaW5UaGVyYXBpc3RTZXJ2aWNlOiBBZG1pblRoZXJhcGlzdFNlcnZpY2UpIHt9XG5cbiAgQEdldCgncGVuZGluZycpXG4gIEBBcGlPcGVyYXRpb24oe1xuICAgIHN1bW1hcnk6ICdSZXRyaWV2ZSBnZXQgcGVuZGluZyBhcHBsaWNhdGlvbnMnLFxuXG4gICAgZGVzY3JpcHRpb246ICdSZXRyaWV2ZSBnZXQgcGVuZGluZyBhcHBsaWNhdGlvbnMnLFxuICB9KVxuICBAQXBpUmVzcG9uc2Uoe1xuICAgIHN0YXR1czogMjAwLFxuXG4gICAgZGVzY3JpcHRpb246ICdSZXRyaWV2ZWQgc3VjY2Vzc2Z1bGx5JyxcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHsgc3RhdHVzOiA0MDEsIGRlc2NyaXB0aW9uOiAnVW5hdXRob3JpemVkJyB9KVxuICBASHR0cENvZGUoSHR0cFN0YXR1cy5PSylcbiAgYXN5bmMgZ2V0UGVuZGluZ0FwcGxpY2F0aW9ucyhcbiAgICBAUXVlcnkobmV3IFpvZFZhbGlkYXRpb25QaXBlKFBlbmRpbmdUaGVyYXBpc3RGaWx0ZXJzRHRvU2NoZW1hKSlcbiAgICBmaWx0ZXJzOiBQZW5kaW5nVGhlcmFwaXN0RmlsdGVyc0R0byxcbiAgICBAQ3VycmVudFVzZXJJZCgpIGFkbWluSWQ6IHN0cmluZyxcbiAgKSB7XG4gICAgdGhpcy5sb2dnZXIubG9nKGBBZG1pbiAke2FkbWluSWR9IGZldGNoaW5nIHBlbmRpbmcgdGhlcmFwaXN0IGFwcGxpY2F0aW9uc2ApO1xuICAgIHJldHVybiB0aGlzLmFkbWluVGhlcmFwaXN0U2VydmljZS5nZXRQZW5kaW5nQXBwbGljYXRpb25zKGZpbHRlcnMpO1xuICB9XG5cbiAgQEdldCgnYXBwbGljYXRpb25zJylcbiAgQEFwaU9wZXJhdGlvbih7XG4gICAgc3VtbWFyeTogJ1JldHJpZXZlIGdldCBhbGwgYXBwbGljYXRpb25zJyxcblxuICAgIGRlc2NyaXB0aW9uOiAnUmV0cmlldmUgZ2V0IGFsbCBhcHBsaWNhdGlvbnMnLFxuICB9KVxuICBAQXBpUmVzcG9uc2Uoe1xuICAgIHN0YXR1czogMjAwLFxuXG4gICAgZGVzY3JpcHRpb246ICdSZXRyaWV2ZWQgc3VjY2Vzc2Z1bGx5JyxcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHsgc3RhdHVzOiA0MDEsIGRlc2NyaXB0aW9uOiAnVW5hdXRob3JpemVkJyB9KVxuICBASHR0cENvZGUoSHR0cFN0YXR1cy5PSylcbiAgYXN5bmMgZ2V0QWxsQXBwbGljYXRpb25zKFxuICAgIEBRdWVyeShuZXcgWm9kVmFsaWRhdGlvblBpcGUoUGVuZGluZ1RoZXJhcGlzdEZpbHRlcnNEdG9TY2hlbWEpKVxuICAgIGZpbHRlcnM6IFBlbmRpbmdUaGVyYXBpc3RGaWx0ZXJzRHRvLFxuICAgIEBDdXJyZW50VXNlcklkKCkgYWRtaW5JZDogc3RyaW5nLFxuICApIHtcbiAgICB0aGlzLmxvZ2dlci5sb2coYEFkbWluICR7YWRtaW5JZH0gZmV0Y2hpbmcgYWxsIHRoZXJhcGlzdCBhcHBsaWNhdGlvbnNgKTtcbiAgICByZXR1cm4gdGhpcy5hZG1pblRoZXJhcGlzdFNlcnZpY2UuZ2V0UGVuZGluZ0FwcGxpY2F0aW9ucyhmaWx0ZXJzKTtcbiAgfVxuXG4gIEBHZXQoJzppZC9kZXRhaWxzJylcbiAgQEFwaU9wZXJhdGlvbih7XG4gICAgc3VtbWFyeTogJ1JldHJpZXZlIGdldCBhcHBsaWNhdGlvbiBkZXRhaWxzJyxcblxuICAgIGRlc2NyaXB0aW9uOiAnUmV0cmlldmUgZ2V0IGFwcGxpY2F0aW9uIGRldGFpbHMnLFxuICB9KVxuICBAQXBpUmVzcG9uc2Uoe1xuICAgIHN0YXR1czogMjAwLFxuXG4gICAgZGVzY3JpcHRpb246ICdSZXRyaWV2ZWQgc3VjY2Vzc2Z1bGx5JyxcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHsgc3RhdHVzOiA0MDEsIGRlc2NyaXB0aW9uOiAnVW5hdXRob3JpemVkJyB9KVxuICBASHR0cENvZGUoSHR0cFN0YXR1cy5PSylcbiAgYXN5bmMgZ2V0QXBwbGljYXRpb25EZXRhaWxzKFxuICAgIEBQYXJhbSgnaWQnKSB0aGVyYXBpc3RJZDogc3RyaW5nLFxuICAgIEBDdXJyZW50VXNlcklkKCkgYWRtaW5JZDogc3RyaW5nLFxuICApIHtcbiAgICB0aGlzLmxvZ2dlci5sb2coXG4gICAgICBgQWRtaW4gJHthZG1pbklkfSB2aWV3aW5nIHRoZXJhcGlzdCBhcHBsaWNhdGlvbiAke3RoZXJhcGlzdElkfWAsXG4gICAgKTtcbiAgICByZXR1cm4gdGhpcy5hZG1pblRoZXJhcGlzdFNlcnZpY2UuZ2V0QXBwbGljYXRpb25EZXRhaWxzKHRoZXJhcGlzdElkKTtcbiAgfVxuXG4gIEBQb3N0KCc6aWQvYXBwcm92ZScpXG4gIEBBcGlPcGVyYXRpb24oe1xuICAgIHN1bW1hcnk6ICdDcmVhdGUgYXBwcm92ZSB0aGVyYXBpc3QnLFxuXG4gICAgZGVzY3JpcHRpb246ICdDcmVhdGUgYXBwcm92ZSB0aGVyYXBpc3QnLFxuICB9KVxuICBAQXBpUmVzcG9uc2Uoe1xuICAgIHN0YXR1czogMjAxLFxuXG4gICAgZGVzY3JpcHRpb246ICdDcmVhdGVkIHN1Y2Nlc3NmdWxseScsXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7IHN0YXR1czogNDAxLCBkZXNjcmlwdGlvbjogJ1VuYXV0aG9yaXplZCcgfSlcbiAgQEh0dHBDb2RlKEh0dHBTdGF0dXMuT0spXG4gIGFzeW5jIGFwcHJvdmVUaGVyYXBpc3QoXG4gICAgQFBhcmFtKCdpZCcpIHRoZXJhcGlzdElkOiBzdHJpbmcsXG4gICAgQEJvZHkobmV3IFpvZFZhbGlkYXRpb25QaXBlKEFwcHJvdmVUaGVyYXBpc3REdG9TY2hlbWEpKVxuICAgIGFwcHJvdmFsRHRvOiBBcHByb3ZlVGhlcmFwaXN0RHRvLFxuICAgIEBDdXJyZW50VXNlcklkKCkgYWRtaW5JZDogc3RyaW5nLFxuICApIHtcbiAgICB0aGlzLmxvZ2dlci5sb2coYEFkbWluICR7YWRtaW5JZH0gYXBwcm92aW5nIHRoZXJhcGlzdCAke3RoZXJhcGlzdElkfWApO1xuICAgIHJldHVybiB0aGlzLmFkbWluVGhlcmFwaXN0U2VydmljZS5hcHByb3ZlVGhlcmFwaXN0KFxuICAgICAgdGhlcmFwaXN0SWQsXG4gICAgICBhZG1pbklkLFxuICAgICAgYXBwcm92YWxEdG8sXG4gICAgKTtcbiAgfVxuXG4gIEBQb3N0KCc6aWQvcmVqZWN0JylcbiAgQEFwaU9wZXJhdGlvbih7XG4gICAgc3VtbWFyeTogJ0NyZWF0ZSByZWplY3QgdGhlcmFwaXN0JyxcblxuICAgIGRlc2NyaXB0aW9uOiAnQ3JlYXRlIHJlamVjdCB0aGVyYXBpc3QnLFxuICB9KVxuICBAQXBpUmVzcG9uc2Uoe1xuICAgIHN0YXR1czogMjAxLFxuXG4gICAgZGVzY3JpcHRpb246ICdDcmVhdGVkIHN1Y2Nlc3NmdWxseScsXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7IHN0YXR1czogNDAxLCBkZXNjcmlwdGlvbjogJ1VuYXV0aG9yaXplZCcgfSlcbiAgQEh0dHBDb2RlKEh0dHBTdGF0dXMuT0spXG4gIGFzeW5jIHJlamVjdFRoZXJhcGlzdChcbiAgICBAUGFyYW0oJ2lkJykgdGhlcmFwaXN0SWQ6IHN0cmluZyxcbiAgICBAQm9keShuZXcgWm9kVmFsaWRhdGlvblBpcGUoUmVqZWN0VGhlcmFwaXN0RHRvU2NoZW1hKSlcbiAgICByZWplY3Rpb25EdG86IFJlamVjdFRoZXJhcGlzdER0byxcbiAgICBAQ3VycmVudFVzZXJJZCgpIGFkbWluSWQ6IHN0cmluZyxcbiAgKSB7XG4gICAgdGhpcy5sb2dnZXIubG9nKGBBZG1pbiAke2FkbWluSWR9IHJlamVjdGluZyB0aGVyYXBpc3QgJHt0aGVyYXBpc3RJZH1gKTtcbiAgICByZXR1cm4gdGhpcy5hZG1pblRoZXJhcGlzdFNlcnZpY2UucmVqZWN0VGhlcmFwaXN0KFxuICAgICAgdGhlcmFwaXN0SWQsXG4gICAgICBhZG1pbklkLFxuICAgICAgcmVqZWN0aW9uRHRvLFxuICAgICk7XG4gIH1cblxuICBAUHV0KCc6aWQvc3RhdHVzJylcbiAgQEFwaU9wZXJhdGlvbih7XG4gICAgc3VtbWFyeTogJ1VwZGF0ZSB1cGRhdGUgdGhlcmFwaXN0IHN0YXR1cycsXG5cbiAgICBkZXNjcmlwdGlvbjogJ1VwZGF0ZSB1cGRhdGUgdGhlcmFwaXN0IHN0YXR1cycsXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiAyMDAsXG5cbiAgICBkZXNjcmlwdGlvbjogJ1VwZGF0ZWQgc3VjY2Vzc2Z1bGx5JyxcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHsgc3RhdHVzOiA0MDEsIGRlc2NyaXB0aW9uOiAnVW5hdXRob3JpemVkJyB9KVxuICBASHR0cENvZGUoSHR0cFN0YXR1cy5PSylcbiAgYXN5bmMgdXBkYXRlVGhlcmFwaXN0U3RhdHVzKFxuICAgIEBQYXJhbSgnaWQnKSB0aGVyYXBpc3RJZDogc3RyaW5nLFxuICAgIEBCb2R5KG5ldyBab2RWYWxpZGF0aW9uUGlwZShVcGRhdGVUaGVyYXBpc3RTdGF0dXNEdG9TY2hlbWEpKVxuICAgIHN0YXR1c0R0bzogVXBkYXRlVGhlcmFwaXN0U3RhdHVzRHRvLFxuICAgIEBDdXJyZW50VXNlcklkKCkgYWRtaW5JZDogc3RyaW5nLFxuICApIHtcbiAgICB0aGlzLmxvZ2dlci5sb2coXG4gICAgICBgQWRtaW4gJHthZG1pbklkfSB1cGRhdGluZyB0aGVyYXBpc3QgJHt0aGVyYXBpc3RJZH0gc3RhdHVzIHRvICR7c3RhdHVzRHRvLnN0YXR1c31gLFxuICAgICk7XG4gICAgcmV0dXJuIHRoaXMuYWRtaW5UaGVyYXBpc3RTZXJ2aWNlLnVwZGF0ZVRoZXJhcGlzdFN0YXR1cyhcbiAgICAgIHRoZXJhcGlzdElkLFxuICAgICAgYWRtaW5JZCxcbiAgICAgIHN0YXR1c0R0byxcbiAgICApO1xuICB9XG5cbiAgQEdldCgnbWV0cmljcycpXG4gIEBBcGlPcGVyYXRpb24oe1xuICAgIHN1bW1hcnk6ICdSZXRyaWV2ZSBnZXQgdGhlcmFwaXN0IGFwcGxpY2F0aW9uIG1ldHJpY3MnLFxuXG4gICAgZGVzY3JpcHRpb246ICdSZXRyaWV2ZSBnZXQgdGhlcmFwaXN0IGFwcGxpY2F0aW9uIG1ldHJpY3MnLFxuICB9KVxuICBAQXBpUmVzcG9uc2Uoe1xuICAgIHN0YXR1czogMjAwLFxuXG4gICAgZGVzY3JpcHRpb246ICdSZXRyaWV2ZWQgc3VjY2Vzc2Z1bGx5JyxcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHsgc3RhdHVzOiA0MDEsIGRlc2NyaXB0aW9uOiAnVW5hdXRob3JpemVkJyB9KVxuICBASHR0cENvZGUoSHR0cFN0YXR1cy5PSylcbiAgYXN5bmMgZ2V0VGhlcmFwaXN0QXBwbGljYXRpb25NZXRyaWNzKFxuICAgIEBRdWVyeSgnc3RhcnREYXRlJykgc3RhcnREYXRlPzogc3RyaW5nLFxuICAgIEBRdWVyeSgnZW5kRGF0ZScpIGVuZERhdGU/OiBzdHJpbmcsXG4gICAgQEN1cnJlbnRVc2VySWQoKSBhZG1pbklkPzogc3RyaW5nLFxuICApIHtcbiAgICB0aGlzLmxvZ2dlci5sb2coYEFkbWluICR7YWRtaW5JZH0gZmV0Y2hpbmcgdGhlcmFwaXN0IGFwcGxpY2F0aW9uIG1ldHJpY3NgKTtcbiAgICByZXR1cm4gdGhpcy5hZG1pblRoZXJhcGlzdFNlcnZpY2UuZ2V0VGhlcmFwaXN0QXBwbGljYXRpb25NZXRyaWNzKFxuICAgICAgc3RhcnREYXRlLFxuICAgICAgZW5kRGF0ZSxcbiAgICApO1xuICB9XG59XG4iXSwidmVyc2lvbiI6M30=