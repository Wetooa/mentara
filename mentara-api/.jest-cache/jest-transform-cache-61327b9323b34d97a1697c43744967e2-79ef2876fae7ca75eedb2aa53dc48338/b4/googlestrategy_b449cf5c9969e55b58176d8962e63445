a050cff775c95d6d58e991ecdbec2e75
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.GoogleStrategy = void 0;
const common_1 = require("@nestjs/common");
const passport_1 = require("@nestjs/passport");
const passport_google_oauth20_1 = require("passport-google-oauth20");
let GoogleStrategy = class GoogleStrategy extends (0, passport_1.PassportStrategy)(passport_google_oauth20_1.Strategy, 'google') {
    constructor() {
        super({
            clientID: process.env.GOOGLE_CLIENT_ID || 'placeholder-client-id',
            clientSecret: process.env.GOOGLE_CLIENT_SECRET || 'placeholder-client-secret',
            callbackURL: process.env.GOOGLE_CALLBACK_URL || '/auth/google/callback',
            scope: ['email', 'profile'],
        });
    }
    async validate(accessToken, refreshToken, profile, done) {
        const { name, emails, photos } = profile;
        const user = {
            email: emails[0].value,
            firstName: name.givenName,
            lastName: name.familyName,
            picture: photos[0].value,
            accessToken,
            refreshToken,
        };
        done(null, user);
    }
};
exports.GoogleStrategy = GoogleStrategy;
exports.GoogleStrategy = GoogleStrategy = __decorate([
    (0, common_1.Injectable)(),
    __metadata("design:paramtypes", [])
], GoogleStrategy);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL2F1dGgvc3RyYXRlZ2llcy9nb29nbGUuc3RyYXRlZ3kudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQUEsMkNBQTRDO0FBQzVDLCtDQUFvRDtBQUNwRCxxRUFBbUU7QUFHNUQsSUFBTSxjQUFjLEdBQXBCLE1BQU0sY0FBZSxTQUFRLElBQUEsMkJBQWdCLEVBQUMsa0NBQVEsRUFBRSxRQUFRLENBQUM7SUFDdEU7UUFDRSxLQUFLLENBQUM7WUFDSixRQUFRLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxnQkFBZ0IsSUFBSSx1QkFBdUI7WUFDakUsWUFBWSxFQUNWLE9BQU8sQ0FBQyxHQUFHLENBQUMsb0JBQW9CLElBQUksMkJBQTJCO1lBQ2pFLFdBQVcsRUFBRSxPQUFPLENBQUMsR0FBRyxDQUFDLG1CQUFtQixJQUFJLHVCQUF1QjtZQUN2RSxLQUFLLEVBQUUsQ0FBQyxPQUFPLEVBQUUsU0FBUyxDQUFDO1NBQzVCLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRCxLQUFLLENBQUMsUUFBUSxDQUNaLFdBQW1CLEVBQ25CLFlBQW9CLEVBQ3BCLE9BQVksRUFDWixJQUFvQjtRQUVwQixNQUFNLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsR0FBRyxPQUFPLENBQUM7UUFDekMsTUFBTSxJQUFJLEdBQUc7WUFDWCxLQUFLLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUs7WUFDdEIsU0FBUyxFQUFFLElBQUksQ0FBQyxTQUFTO1lBQ3pCLFFBQVEsRUFBRSxJQUFJLENBQUMsVUFBVTtZQUN6QixPQUFPLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUs7WUFDeEIsV0FBVztZQUNYLFlBQVk7U0FDYixDQUFDO1FBQ0YsSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztJQUNuQixDQUFDO0NBQ0YsQ0FBQTtBQTVCWSx3Q0FBYzt5QkFBZCxjQUFjO0lBRDFCLElBQUEsbUJBQVUsR0FBRTs7R0FDQSxjQUFjLENBNEIxQiIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS93ZXRvb2EvRG9jdW1lbnRzL2NvZGUvcHJvamVjdHMvbWVudGFyYS9tZW50YXJhLWFwaS9zcmMvYXV0aC9zdHJhdGVnaWVzL2dvb2dsZS5zdHJhdGVneS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQG5lc3Rqcy9jb21tb24nO1xuaW1wb3J0IHsgUGFzc3BvcnRTdHJhdGVneSB9IGZyb20gJ0BuZXN0anMvcGFzc3BvcnQnO1xuaW1wb3J0IHsgU3RyYXRlZ3ksIFZlcmlmeUNhbGxiYWNrIH0gZnJvbSAncGFzc3BvcnQtZ29vZ2xlLW9hdXRoMjAnO1xuXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgR29vZ2xlU3RyYXRlZ3kgZXh0ZW5kcyBQYXNzcG9ydFN0cmF0ZWd5KFN0cmF0ZWd5LCAnZ29vZ2xlJykge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcih7XG4gICAgICBjbGllbnRJRDogcHJvY2Vzcy5lbnYuR09PR0xFX0NMSUVOVF9JRCB8fCAncGxhY2Vob2xkZXItY2xpZW50LWlkJyxcbiAgICAgIGNsaWVudFNlY3JldDpcbiAgICAgICAgcHJvY2Vzcy5lbnYuR09PR0xFX0NMSUVOVF9TRUNSRVQgfHwgJ3BsYWNlaG9sZGVyLWNsaWVudC1zZWNyZXQnLFxuICAgICAgY2FsbGJhY2tVUkw6IHByb2Nlc3MuZW52LkdPT0dMRV9DQUxMQkFDS19VUkwgfHwgJy9hdXRoL2dvb2dsZS9jYWxsYmFjaycsXG4gICAgICBzY29wZTogWydlbWFpbCcsICdwcm9maWxlJ10sXG4gICAgfSk7XG4gIH1cblxuICBhc3luYyB2YWxpZGF0ZShcbiAgICBhY2Nlc3NUb2tlbjogc3RyaW5nLFxuICAgIHJlZnJlc2hUb2tlbjogc3RyaW5nLFxuICAgIHByb2ZpbGU6IGFueSxcbiAgICBkb25lOiBWZXJpZnlDYWxsYmFjayxcbiAgKTogUHJvbWlzZTxhbnk+IHtcbiAgICBjb25zdCB7IG5hbWUsIGVtYWlscywgcGhvdG9zIH0gPSBwcm9maWxlO1xuICAgIGNvbnN0IHVzZXIgPSB7XG4gICAgICBlbWFpbDogZW1haWxzWzBdLnZhbHVlLFxuICAgICAgZmlyc3ROYW1lOiBuYW1lLmdpdmVuTmFtZSxcbiAgICAgIGxhc3ROYW1lOiBuYW1lLmZhbWlseU5hbWUsXG4gICAgICBwaWN0dXJlOiBwaG90b3NbMF0udmFsdWUsXG4gICAgICBhY2Nlc3NUb2tlbixcbiAgICAgIHJlZnJlc2hUb2tlbixcbiAgICB9O1xuICAgIGRvbmUobnVsbCwgdXNlcik7XG4gIH1cbn1cbiJdLCJ2ZXJzaW9uIjozfQ==