{"file":"/home/wetooa/Documents/code/projects/mentara/mentara-api/src/onboarding/onboarding.controller.ts","mappings":"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","names":[],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/onboarding/onboarding.controller.ts"],"sourcesContent":["import {\n  Controller,\n  Get,\n  Post,\n  Param,\n  UseGuards,\n  HttpException,\n  HttpStatus,\n  Logger,\n} from '@nestjs/common';\nimport { OnboardingService, OnboardingStatus } from './onboarding.service';\nimport { JwtAuthGuard } from '../auth/guards/jwt-auth.guard';\nimport { AdminAuthGuard } from '../auth/guards/admin-auth.guard';\nimport { CurrentUserId } from '../auth/decorators/current-user-id.decorator';\nimport { AdminOnly } from '../auth/decorators/admin-only.decorator';\nimport {\n  ApiTags,\n  ApiOperation,\n  ApiResponse,\n  ApiBody,\n  ApiBearerAuth,\n  ApiParam,\n  ApiQuery,\n} from '@nestjs/swagger';\n\n@ApiTags('onboarding')\n@ApiBearerAuth('JWT-auth')\n@Controller('onboarding')\n@UseGuards(JwtAuthGuard)\nexport class OnboardingController {\n  private readonly logger = new Logger(OnboardingController.name);\n\n  constructor(private readonly onboardingService: OnboardingService) {}\n\n  @Get('status')\n  @ApiOperation({\n    summary: 'Retrieve get my onboarding status',\n\n    description: 'Retrieve get my onboarding status',\n  })\n  @ApiResponse({\n    status: 200,\n\n    description: 'Retrieved successfully',\n  })\n  @ApiResponse({ status: 401, description: 'Unauthorized' })\n  async getMyOnboardingStatus(\n    @CurrentUserId() userId: string,\n  ): Promise<OnboardingStatus> {\n    try {\n      return await this.onboardingService.getOnboardingStatus(userId);\n    } catch (error) {\n      this.logger.error(\n        `Failed to get onboarding status for user ${userId}:`,\n        error,\n      );\n      throw new HttpException(\n        'Failed to retrieve onboarding status',\n        HttpStatus.INTERNAL_SERVER_ERROR,\n      );\n    }\n  }\n\n  @Get('status/:userId')\n  @ApiOperation({\n    summary: 'Retrieve get user onboarding status',\n\n    description: 'Retrieve get user onboarding status',\n  })\n  @ApiResponse({\n    status: 200,\n\n    description: 'Retrieved successfully',\n  })\n  @ApiResponse({ status: 401, description: 'Unauthorized' })\n  @UseGuards(AdminAuthGuard)\n  @AdminOnly()\n  async getUserOnboardingStatus(\n    @Param('userId') userId: string,\n  ): Promise<OnboardingStatus> {\n    try {\n      return await this.onboardingService.getOnboardingStatus(userId);\n    } catch (error) {\n      this.logger.error(\n        `Failed to get onboarding status for user ${userId}:`,\n        error,\n      );\n      if (error instanceof HttpException) {\n        throw error;\n      }\n      throw new HttpException(\n        'Failed to retrieve onboarding status',\n        HttpStatus.INTERNAL_SERVER_ERROR,\n      );\n    }\n  }\n\n  @Post('complete-step/:stepName')\n  @ApiOperation({\n    summary: 'Create complete step',\n\n    description: 'Create complete step',\n  })\n  @ApiResponse({\n    status: 201,\n\n    description: 'Created successfully',\n  })\n  @ApiResponse({ status: 401, description: 'Unauthorized' })\n  async completeStep(\n    @CurrentUserId() userId: string,\n    @Param('stepName') stepName: string,\n  ): Promise<OnboardingStatus> {\n    try {\n      return await this.onboardingService.markStepCompleted(userId, stepName);\n    } catch (error) {\n      this.logger.error(\n        `Failed to complete step ${stepName} for user ${userId}:`,\n        error,\n      );\n      throw new HttpException(\n        'Failed to complete onboarding step',\n        HttpStatus.INTERNAL_SERVER_ERROR,\n      );\n    }\n  }\n\n  @Get('validate')\n  @ApiOperation({\n    summary: 'Retrieve validate onboarding',\n\n    description: 'Retrieve validate onboarding',\n  })\n  @ApiResponse({\n    status: 200,\n\n    description: 'Retrieved successfully',\n  })\n  @ApiResponse({ status: 401, description: 'Unauthorized' })\n  async validateOnboarding(@CurrentUserId() userId: string) {\n    try {\n      return await this.onboardingService.validateOnboardingCompleteness(\n        userId,\n      );\n    } catch (error) {\n      this.logger.error(\n        `Failed to validate onboarding for user ${userId}:`,\n        error,\n      );\n      throw new HttpException(\n        'Failed to validate onboarding completeness',\n        HttpStatus.INTERNAL_SERVER_ERROR,\n      );\n    }\n  }\n\n  @Get('insights')\n  @ApiOperation({\n    summary: 'Retrieve get onboarding insights',\n\n    description: 'Retrieve get onboarding insights',\n  })\n  @ApiResponse({\n    status: 200,\n\n    description: 'Retrieved successfully',\n  })\n  @ApiResponse({ status: 401, description: 'Unauthorized' })\n  @UseGuards(AdminAuthGuard)\n  @AdminOnly()\n  async getOnboardingInsights() {\n    try {\n      return await this.onboardingService.getOnboardingInsights();\n    } catch (error) {\n      this.logger.error('Failed to get onboarding insights:', error);\n      throw new HttpException(\n        'Failed to retrieve onboarding insights',\n        HttpStatus.INTERNAL_SERVER_ERROR,\n      );\n    }\n  }\n}\n"],"version":3}