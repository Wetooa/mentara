{"file":"/home/wetooa/Documents/code/projects/mentara/mentara-api/src/comments/comments.service.spec.ts","mappings":"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","names":[],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/comments/comments.service.spec.ts"],"sourcesContent":["import { Test, TestingModule } from '@nestjs/testing';\nimport {\n  NotFoundException,\n  ForbiddenException,\n  InternalServerErrorException,\n} from '@nestjs/common';\nimport { CommentsService } from './comments.service';\nimport { PrismaService } from '../providers/prisma-client.provider';\nimport { AttachmentEntityType, AttachmentPurpose } from '@prisma/client';\nimport { createMockPrismaService, TEST_USER_IDS } from '../test-utils';\n\ndescribe('CommentsService', () => {\n  let service: CommentsService;\n  let prismaService: jest.Mocked<PrismaService>;\n\n  beforeEach(async () => {\n    const mockPrisma = createMockPrismaService();\n\n    const module: TestingModule = await Test.createTestingModule({\n      providers: [\n        CommentsService,\n        {\n          provide: PrismaService,\n          useValue: mockPrisma,\n        },\n      ],\n    }).compile();\n\n    service = module.get<CommentsService>(CommentsService);\n    prismaService = module.get(PrismaService);\n  });\n\n  afterEach(() => {\n    jest.clearAllMocks();\n  });\n\n  describe('findUserById', () => {\n    it('should return user when found', async () => {\n      const mockUser = {\n        id: TEST_USER_IDS.CLIENT,\n        firstName: 'John',\n        lastName: 'Doe',\n        email: 'john@example.com',\n      };\n\n      (prismaService.user.findUnique as jest.Mock).mockResolvedValue(mockUser);\n\n      const result = await service.findUserById(TEST_USER_IDS.CLIENT);\n\n      expect(result).toEqual(mockUser);\n      expect(prismaService.user.findUnique).toHaveBeenCalledWith({\n        where: { id: TEST_USER_IDS.CLIENT },\n      });\n    });\n\n    it('should return null when user not found', async () => {\n      (prismaService.user.findUnique as jest.Mock).mockResolvedValue(null);\n\n      const result = await service.findUserById('non-existent-id');\n\n      expect(result).toBeNull();\n    });\n\n    it('should re-throw NotFoundException', async () => {\n      (prismaService.user.findUnique as jest.Mock).mockRejectedValue(\n        new NotFoundException('User not found'),\n      );\n\n      await expect(service.findUserById(TEST_USER_IDS.CLIENT)).rejects.toThrow(\n        NotFoundException,\n      );\n    });\n\n    it('should wrap database errors in InternalServerErrorException', async () => {\n      (prismaService.user.findUnique as jest.Mock).mockRejectedValue(\n        new Error('Database error'),\n      );\n\n      await expect(service.findUserById(TEST_USER_IDS.CLIENT)).rejects.toThrow(\n        InternalServerErrorException,\n      );\n    });\n  });\n\n  describe('findAll', () => {\n    const mockComments = [\n      {\n        id: 'comment-1',\n        content: 'First comment',\n        userId: TEST_USER_IDS.CLIENT,\n        postId: 'post-1',\n        user: {\n          id: TEST_USER_IDS.CLIENT,\n          firstName: 'John',\n          lastName: 'Doe',\n          avatarUrl: 'avatar.jpg',\n        },\n        post: {\n          id: 'post-1',\n          title: 'Test Post',\n        },\n        replies: [],\n        hearts: [],\n        _count: {\n          replies: 0,\n          hearts: 2,\n        },\n      },\n    ];\n\n    it('should return all comments without user hearts when no userId provided', async () => {\n      (prismaService.comment.findMany as jest.Mock).mockResolvedValue(\n        mockComments,\n      );\n\n      const result = await service.findAll();\n\n      expect(result).toEqual(mockComments);\n      expect(prismaService.comment.findMany).toHaveBeenCalledWith({\n        include: {\n          user: {\n            select: {\n              id: true,\n              firstName: true,\n              lastName: true,\n              avatarUrl: true,\n            },\n          },\n          post: {\n            select: {\n              id: true,\n              title: true,\n            },\n          },\n          replies: {\n            include: {\n              user: {\n                select: {\n                  id: true,\n                  firstName: true,\n                  lastName: true,\n                  avatarUrl: true,\n                },\n              },\n            },\n            orderBy: {\n              createdAt: 'asc',\n            },\n          },\n          hearts: false,\n          _count: {\n            select: {\n              replies: true,\n              hearts: true,\n            },\n          },\n        },\n        orderBy: {\n          createdAt: 'desc',\n        },\n      });\n    });\n\n    it('should return comments with user hearts when userId provided', async () => {\n      (prismaService.comment.findMany as jest.Mock).mockResolvedValue(\n        mockComments,\n      );\n\n      const result = await service.findAll(TEST_USER_IDS.CLIENT);\n\n      expect(result).toEqual(mockComments);\n      expect(prismaService.comment.findMany).toHaveBeenCalledWith({\n        include: expect.objectContaining({\n          hearts: {\n            where: {\n              userId: TEST_USER_IDS.CLIENT,\n            },\n          },\n        }),\n        orderBy: {\n          createdAt: 'desc',\n        },\n      });\n    });\n\n    it('should handle database errors', async () => {\n      (prismaService.comment.findMany as jest.Mock).mockRejectedValue(\n        new Error('Database error'),\n      );\n\n      await expect(service.findAll()).rejects.toThrow(\n        InternalServerErrorException,\n      );\n    });\n  });\n\n  describe('findOne', () => {\n    const mockComment = {\n      id: 'comment-1',\n      content: 'Test comment',\n      userId: TEST_USER_IDS.CLIENT,\n      user: {\n        id: TEST_USER_IDS.CLIENT,\n        firstName: 'John',\n        lastName: 'Doe',\n      },\n      replies: [],\n      hearts: [\n        { id: 'heart-1', userId: TEST_USER_IDS.CLIENT },\n        { id: 'heart-2', userId: 'user-2' },\n      ],\n    };\n\n    it('should return comment with hearts count and files', async () => {\n      const mockFiles = [\n        {\n          id: 'attachment-1',\n          commentId: 'comment-1',\n          url: '/api/files/file-1',\n          type: 'image/jpeg',\n        },\n      ];\n\n      (prismaService.comment.findUnique as jest.Mock).mockResolvedValue(\n        mockComment,\n      );\n      jest.spyOn(service, 'getCommentAttachments').mockResolvedValue(mockFiles);\n\n      const result = await service.findOne('comment-1');\n\n      expect(result).toEqual({\n        ...mockComment,\n        hearts: 2, // Count instead of array\n        files: mockFiles,\n      });\n      expect(service.getCommentAttachments).toHaveBeenCalledWith('comment-1');\n    });\n\n    it('should throw NotFoundException when comment not found', async () => {\n      (prismaService.comment.findUnique as jest.Mock).mockResolvedValue(null);\n\n      await expect(service.findOne('non-existent-id')).rejects.toThrow(\n        NotFoundException,\n      );\n    });\n\n    it('should handle database errors', async () => {\n      (prismaService.comment.findUnique as jest.Mock).mockRejectedValue(\n        new Error('Database error'),\n      );\n\n      await expect(service.findOne('comment-1')).rejects.toThrow(\n        InternalServerErrorException,\n      );\n    });\n  });\n\n  describe('findByPostId', () => {\n    const mockComments = [\n      {\n        id: 'comment-1',\n        content: 'Comment on post',\n        postId: 'post-1',\n        user: { firstName: 'John', lastName: 'Doe' },\n        replies: [],\n        hearts: [],\n        _count: { replies: 0, hearts: 1 },\n      },\n    ];\n\n    it('should return comments for specific post', async () => {\n      (prismaService.comment.findMany as jest.Mock).mockResolvedValue(\n        mockComments,\n      );\n\n      const result = await service.findByPostId('post-1');\n\n      expect(result).toEqual(mockComments);\n      expect(prismaService.comment.findMany).toHaveBeenCalledWith({\n        where: { postId: 'post-1' },\n        include: expect.objectContaining({\n          hearts: false,\n        }),\n        orderBy: { createdAt: 'desc' },\n      });\n    });\n\n    it('should include user hearts when userId provided', async () => {\n      (prismaService.comment.findMany as jest.Mock).mockResolvedValue(\n        mockComments,\n      );\n\n      await service.findByPostId('post-1', TEST_USER_IDS.CLIENT);\n\n      expect(prismaService.comment.findMany).toHaveBeenCalledWith({\n        where: { postId: 'post-1' },\n        include: expect.objectContaining({\n          hearts: {\n            where: { userId: TEST_USER_IDS.CLIENT },\n          },\n        }),\n        orderBy: { createdAt: 'desc' },\n      });\n    });\n  });\n\n  describe('create', () => {\n    const mockCommentData = {\n      postId: 'post-1',\n      content: 'New comment',\n    };\n\n    const mockCreatedComment = {\n      id: 'comment-1',\n      content: 'New comment',\n      userId: TEST_USER_IDS.CLIENT,\n      postId: 'post-1',\n      user: {\n        id: TEST_USER_IDS.CLIENT,\n        firstName: 'John',\n        lastName: 'Doe',\n      },\n      hearts: [],\n    };\n\n    it('should create comment successfully', async () => {\n      const mockFiles = [];\n\n      (prismaService.comment.create as jest.Mock).mockResolvedValue(\n        mockCreatedComment,\n      );\n      jest.spyOn(service, 'getCommentAttachments').mockResolvedValue(mockFiles);\n\n      const result = await service.create(\n        mockCommentData,\n        TEST_USER_IDS.CLIENT,\n      );\n\n      expect(result).toEqual({\n        ...mockCreatedComment,\n        hearts: 0, // Count instead of array\n        files: mockFiles,\n      });\n      expect(prismaService.comment.create).toHaveBeenCalledWith({\n        data: {\n          userId: TEST_USER_IDS.CLIENT,\n          postId: 'post-1',\n          content: 'New comment',\n        },\n        include: {\n          user: true,\n          hearts: true,\n        },\n      });\n    });\n\n    it('should handle creation errors', async () => {\n      (prismaService.comment.create as jest.Mock).mockRejectedValue(\n        new Error('Creation failed'),\n      );\n\n      await expect(\n        service.create(mockCommentData, TEST_USER_IDS.CLIENT),\n      ).rejects.toThrow(InternalServerErrorException);\n    });\n  });\n\n  describe('update', () => {\n    const mockUpdateData = {\n      postId: 'post-1',\n      content: 'Updated comment',\n    };\n\n    const mockComment = {\n      id: 'comment-1',\n      userId: TEST_USER_IDS.CLIENT,\n    };\n\n    const mockUpdatedComment = {\n      id: 'comment-1',\n      content: 'Updated comment',\n      userId: TEST_USER_IDS.CLIENT,\n      user: {\n        id: TEST_USER_IDS.CLIENT,\n        firstName: 'John',\n        lastName: 'Doe',\n        avatarUrl: 'avatar.jpg',\n      },\n      hearts: [],\n    };\n\n    it('should update comment successfully', async () => {\n      const mockFiles = [];\n\n      (prismaService.comment.findUnique as jest.Mock).mockResolvedValue(\n        mockComment,\n      );\n      (prismaService.comment.update as jest.Mock).mockResolvedValue(\n        mockUpdatedComment,\n      );\n      jest.spyOn(service, 'getCommentAttachments').mockResolvedValue(mockFiles);\n\n      const result = await service.update(\n        'comment-1',\n        mockUpdateData,\n        TEST_USER_IDS.CLIENT,\n      );\n\n      expect(result).toEqual({\n        ...mockUpdatedComment,\n        hearts: 0,\n        files: mockFiles,\n      });\n      expect(prismaService.comment.update).toHaveBeenCalledWith({\n        where: { id: 'comment-1', userId: TEST_USER_IDS.CLIENT },\n        data: { content: 'Updated comment' },\n        include: {\n          user: {\n            select: {\n              id: true,\n              firstName: true,\n              lastName: true,\n              avatarUrl: true,\n            },\n          },\n          hearts: true,\n        },\n      });\n    });\n\n    it('should throw NotFoundException when comment not found', async () => {\n      (prismaService.comment.findUnique as jest.Mock).mockResolvedValue(null);\n\n      await expect(\n        service.update('non-existent-id', mockUpdateData, TEST_USER_IDS.CLIENT),\n      ).rejects.toThrow(NotFoundException);\n    });\n\n    it('should throw ForbiddenException when user is not comment owner', async () => {\n      const otherUserComment = {\n        id: 'comment-1',\n        userId: 'other-user-id',\n      };\n\n      (prismaService.comment.findUnique as jest.Mock).mockResolvedValue(\n        otherUserComment,\n      );\n\n      await expect(\n        service.update('comment-1', mockUpdateData, TEST_USER_IDS.CLIENT),\n      ).rejects.toThrow(ForbiddenException);\n    });\n  });\n\n  describe('remove', () => {\n    const mockComment = {\n      id: 'comment-1',\n      userId: TEST_USER_IDS.CLIENT,\n    };\n\n    const mockDeletedComment = {\n      id: 'comment-1',\n      content: 'Deleted comment',\n      userId: TEST_USER_IDS.CLIENT,\n    };\n\n    it('should delete comment successfully', async () => {\n      (prismaService.comment.findUnique as jest.Mock).mockResolvedValue(\n        mockComment,\n      );\n      (prismaService.comment.delete as jest.Mock).mockResolvedValue(\n        mockDeletedComment,\n      );\n\n      const result = await service.remove('comment-1', TEST_USER_IDS.CLIENT);\n\n      expect(result).toEqual(mockDeletedComment);\n      expect(prismaService.comment.delete).toHaveBeenCalledWith({\n        where: { id: 'comment-1' },\n      });\n    });\n\n    it('should throw NotFoundException when comment not found', async () => {\n      (prismaService.comment.findUnique as jest.Mock).mockResolvedValue(null);\n\n      await expect(\n        service.remove('non-existent-id', TEST_USER_IDS.CLIENT),\n      ).rejects.toThrow(NotFoundException);\n    });\n\n    it('should throw ForbiddenException when user is not comment owner', async () => {\n      const otherUserComment = {\n        id: 'comment-1',\n        userId: 'other-user-id',\n      };\n\n      (prismaService.comment.findUnique as jest.Mock).mockResolvedValue(\n        otherUserComment,\n      );\n\n      await expect(\n        service.remove('comment-1', TEST_USER_IDS.CLIENT),\n      ).rejects.toThrow(ForbiddenException);\n    });\n  });\n\n  describe('findByUserId', () => {\n    const mockUserComments = [\n      {\n        id: 'comment-1',\n        content: 'User comment',\n        userId: TEST_USER_IDS.CLIENT,\n        user: { firstName: 'John', lastName: 'Doe' },\n        post: { id: 'post-1', title: 'Test Post' },\n        replies: [],\n        _count: { replies: 0, hearts: 1 },\n      },\n    ];\n\n    it('should return comments by user ID', async () => {\n      (prismaService.comment.findMany as jest.Mock).mockResolvedValue(\n        mockUserComments,\n      );\n\n      const result = await service.findByUserId(TEST_USER_IDS.CLIENT);\n\n      expect(result).toEqual(mockUserComments);\n      expect(prismaService.comment.findMany).toHaveBeenCalledWith({\n        where: { userId: TEST_USER_IDS.CLIENT },\n        include: expect.objectContaining({\n          user: { select: expect.any(Object) },\n          post: { select: expect.any(Object) },\n          replies: { include: expect.any(Object) },\n          _count: { select: expect.any(Object) },\n        }),\n        orderBy: { createdAt: 'desc' },\n      });\n    });\n  });\n\n  describe('Heart functionality', () => {\n    describe('heartComment', () => {\n      it('should add heart when not already hearted', async () => {\n        (prismaService.commentHeart.findUnique as jest.Mock).mockResolvedValue(\n          null,\n        );\n        (prismaService.commentHeart.create as jest.Mock).mockResolvedValue({\n          id: 'heart-1',\n          commentId: 'comment-1',\n          userId: TEST_USER_IDS.CLIENT,\n        });\n\n        const result = await service.heartComment(\n          'comment-1',\n          TEST_USER_IDS.CLIENT,\n        );\n\n        expect(result).toEqual({ hearted: true });\n        expect(prismaService.commentHeart.create).toHaveBeenCalledWith({\n          data: {\n            commentId: 'comment-1',\n            userId: TEST_USER_IDS.CLIENT,\n          },\n        });\n      });\n\n      it('should remove heart when already hearted', async () => {\n        const existingHeart = {\n          id: 'heart-1',\n          commentId: 'comment-1',\n          userId: TEST_USER_IDS.CLIENT,\n        };\n\n        (prismaService.commentHeart.findUnique as jest.Mock).mockResolvedValue(\n          existingHeart,\n        );\n        (prismaService.commentHeart.delete as jest.Mock).mockResolvedValue(\n          existingHeart,\n        );\n\n        const result = await service.heartComment(\n          'comment-1',\n          TEST_USER_IDS.CLIENT,\n        );\n\n        expect(result).toEqual({ hearted: false });\n        expect(prismaService.commentHeart.delete).toHaveBeenCalledWith({\n          where: {\n            commentId_userId: {\n              commentId: 'comment-1',\n              userId: TEST_USER_IDS.CLIENT,\n            },\n          },\n        });\n      });\n\n      it('should handle database errors', async () => {\n        (prismaService.commentHeart.findUnique as jest.Mock).mockRejectedValue(\n          new Error('Database error'),\n        );\n\n        await expect(\n          service.heartComment('comment-1', TEST_USER_IDS.CLIENT),\n        ).rejects.toThrow(InternalServerErrorException);\n      });\n    });\n\n    describe('isCommentHeartedByUser', () => {\n      it('should return true when comment is hearted', async () => {\n        const existingHeart = {\n          id: 'heart-1',\n          commentId: 'comment-1',\n          userId: TEST_USER_IDS.CLIENT,\n        };\n\n        (prismaService.commentHeart.findUnique as jest.Mock).mockResolvedValue(\n          existingHeart,\n        );\n\n        const result = await service.isCommentHeartedByUser(\n          'comment-1',\n          TEST_USER_IDS.CLIENT,\n        );\n\n        expect(result).toBe(true);\n      });\n\n      it('should return false when comment is not hearted', async () => {\n        (prismaService.commentHeart.findUnique as jest.Mock).mockResolvedValue(\n          null,\n        );\n\n        const result = await service.isCommentHeartedByUser(\n          'comment-1',\n          TEST_USER_IDS.CLIENT,\n        );\n\n        expect(result).toBe(false);\n      });\n    });\n  });\n\n  describe('Reply functionality', () => {\n    describe('createReply', () => {\n      const mockReplyData = {\n        content: 'Test reply',\n        userId: TEST_USER_IDS.CLIENT,\n        commentId: 'comment-1',\n      };\n\n      const mockCreatedReply = {\n        id: 'reply-1',\n        content: 'Test reply',\n        userId: TEST_USER_IDS.CLIENT,\n        commentId: 'comment-1',\n        user: {\n          id: TEST_USER_IDS.CLIENT,\n          firstName: 'John',\n          lastName: 'Doe',\n          avatarUrl: 'avatar.jpg',\n        },\n        comment: {\n          id: 'comment-1',\n          content: 'Original comment',\n        },\n        hearts: [],\n      };\n\n      it('should create reply successfully', async () => {\n        (prismaService.reply.create as jest.Mock).mockResolvedValue(\n          mockCreatedReply,\n        );\n\n        const result = await service.createReply(mockReplyData);\n\n        expect(result).toEqual(mockCreatedReply);\n        expect(prismaService.reply.create).toHaveBeenCalledWith({\n          data: mockReplyData,\n          include: {\n            user: {\n              select: {\n                id: true,\n                firstName: true,\n                lastName: true,\n                avatarUrl: true,\n              },\n            },\n            comment: true,\n            hearts: true,\n          },\n        });\n      });\n\n      it('should handle creation errors', async () => {\n        (prismaService.reply.create as jest.Mock).mockRejectedValue(\n          new Error('Creation failed'),\n        );\n\n        await expect(service.createReply(mockReplyData)).rejects.toThrow(\n          InternalServerErrorException,\n        );\n      });\n    });\n\n    describe('findRepliesByCommentId', () => {\n      const mockReplies = [\n        {\n          id: 'reply-1',\n          content: 'First reply',\n          commentId: 'comment-1',\n          user: { firstName: 'John', lastName: 'Doe' },\n          hearts: [],\n          _count: { hearts: 0 },\n        },\n      ];\n\n      it('should return replies without user hearts when no userId provided', async () => {\n        (prismaService.reply.findMany as jest.Mock).mockResolvedValue(\n          mockReplies,\n        );\n\n        const result = await service.findRepliesByCommentId('comment-1');\n\n        expect(result).toEqual(mockReplies);\n        expect(prismaService.reply.findMany).toHaveBeenCalledWith({\n          where: { commentId: 'comment-1' },\n          include: {\n            user: {\n              select: {\n                id: true,\n                firstName: true,\n                lastName: true,\n                avatarUrl: true,\n              },\n            },\n            hearts: true,\n            _count: {\n              select: { hearts: true },\n            },\n          },\n          orderBy: { createdAt: 'asc' },\n        });\n      });\n\n      it('should return replies with user hearts when userId provided', async () => {\n        (prismaService.reply.findMany as jest.Mock).mockResolvedValue(\n          mockReplies,\n        );\n\n        await service.findRepliesByCommentId('comment-1', TEST_USER_IDS.CLIENT);\n\n        expect(prismaService.reply.findMany).toHaveBeenCalledWith({\n          where: { commentId: 'comment-1' },\n          include: expect.objectContaining({\n            hearts: {\n              where: { userId: TEST_USER_IDS.CLIENT },\n            },\n          }),\n          orderBy: { createdAt: 'asc' },\n        });\n      });\n    });\n\n    describe('heartReply', () => {\n      it('should add heart to reply when not already hearted', async () => {\n        (prismaService.replyHeart.findUnique as jest.Mock).mockResolvedValue(\n          null,\n        );\n        (prismaService.replyHeart.create as jest.Mock).mockResolvedValue({\n          id: 'heart-1',\n          replyId: 'reply-1',\n          userId: TEST_USER_IDS.CLIENT,\n        });\n\n        const result = await service.heartReply(\n          'reply-1',\n          TEST_USER_IDS.CLIENT,\n        );\n\n        expect(result).toEqual({ hearted: true });\n        expect(prismaService.replyHeart.create).toHaveBeenCalledWith({\n          data: {\n            replyId: 'reply-1',\n            userId: TEST_USER_IDS.CLIENT,\n          },\n        });\n      });\n\n      it('should remove heart from reply when already hearted', async () => {\n        const existingHeart = {\n          id: 'heart-1',\n          replyId: 'reply-1',\n          userId: TEST_USER_IDS.CLIENT,\n        };\n\n        (prismaService.replyHeart.findUnique as jest.Mock).mockResolvedValue(\n          existingHeart,\n        );\n        (prismaService.replyHeart.delete as jest.Mock).mockResolvedValue(\n          existingHeart,\n        );\n\n        const result = await service.heartReply(\n          'reply-1',\n          TEST_USER_IDS.CLIENT,\n        );\n\n        expect(result).toEqual({ hearted: false });\n        expect(prismaService.replyHeart.delete).toHaveBeenCalledWith({\n          where: {\n            replyId_userId: {\n              replyId: 'reply-1',\n              userId: TEST_USER_IDS.CLIENT,\n            },\n          },\n        });\n      });\n    });\n\n    describe('isReplyHeartedByUser', () => {\n      it('should return true when reply is hearted', async () => {\n        const existingHeart = {\n          id: 'heart-1',\n          replyId: 'reply-1',\n          userId: TEST_USER_IDS.CLIENT,\n        };\n\n        (prismaService.replyHeart.findUnique as jest.Mock).mockResolvedValue(\n          existingHeart,\n        );\n\n        const result = await service.isReplyHeartedByUser(\n          'reply-1',\n          TEST_USER_IDS.CLIENT,\n        );\n\n        expect(result).toBe(true);\n      });\n\n      it('should return false when reply is not hearted', async () => {\n        (prismaService.replyHeart.findUnique as jest.Mock).mockResolvedValue(\n          null,\n        );\n\n        const result = await service.isReplyHeartedByUser(\n          'reply-1',\n          TEST_USER_IDS.CLIENT,\n        );\n\n        expect(result).toBe(false);\n      });\n    });\n  });\n\n  describe('File attachment functionality', () => {\n    describe('Comment attachments', () => {\n      describe('attachFilesToComment', () => {\n        it('should attach files to comment with default purpose', async () => {\n          const fileIds = ['file-1', 'file-2'];\n          const expectedData = [\n            {\n              fileId: 'file-1',\n              entityType: AttachmentEntityType.COMMENT,\n              entityId: 'comment-1',\n              purpose: AttachmentPurpose.MEDIA,\n              order: 0,\n            },\n            {\n              fileId: 'file-2',\n              entityType: AttachmentEntityType.COMMENT,\n              entityId: 'comment-1',\n              purpose: AttachmentPurpose.MEDIA,\n              order: 1,\n            },\n          ];\n\n          (\n            prismaService.fileAttachment.createMany as jest.Mock\n          ).mockResolvedValue({\n            count: 2,\n          });\n\n          const result = await service.attachFilesToComment(\n            'comment-1',\n            fileIds,\n          );\n\n          expect(result).toEqual({ count: 2 });\n          expect(prismaService.fileAttachment.createMany).toHaveBeenCalledWith({\n            data: expectedData,\n          });\n        });\n\n        it('should attach files with custom purpose', async () => {\n          const fileIds = ['file-1'];\n\n          await service.attachFilesToComment(\n            'comment-1',\n            fileIds,\n            AttachmentPurpose.DOCUMENT,\n          );\n\n          expect(prismaService.fileAttachment.createMany).toHaveBeenCalledWith({\n            data: [\n              expect.objectContaining({\n                purpose: AttachmentPurpose.DOCUMENT,\n              }),\n            ],\n          });\n        });\n      });\n\n      describe('getCommentAttachments', () => {\n        it('should return formatted comment attachments', async () => {\n          const mockAttachments = [\n            {\n              id: 'attachment-1',\n              entityId: 'comment-1',\n              file: {\n                id: 'file-1',\n                storageUrl: 'https://storage.com/file-1.jpg',\n                mimeType: 'image/jpeg',\n              },\n            },\n            {\n              id: 'attachment-2',\n              entityId: 'comment-1',\n              file: {\n                id: 'file-2',\n                storageUrl: null,\n                mimeType: 'image/png',\n              },\n            },\n          ];\n\n          (\n            prismaService.fileAttachment.findMany as jest.Mock\n          ).mockResolvedValue(mockAttachments);\n\n          const result = await service.getCommentAttachments('comment-1');\n\n          expect(result).toEqual([\n            {\n              id: 'attachment-1',\n              commentId: 'comment-1',\n              url: 'https://storage.com/file-1.jpg',\n              type: 'image/jpeg',\n            },\n            {\n              id: 'attachment-2',\n              commentId: 'comment-1',\n              url: '/api/files/file-2',\n              type: 'image/png',\n            },\n          ]);\n\n          expect(prismaService.fileAttachment.findMany).toHaveBeenCalledWith({\n            where: {\n              entityType: AttachmentEntityType.COMMENT,\n              entityId: 'comment-1',\n            },\n            include: {\n              file: true,\n            },\n            orderBy: { order: 'asc' },\n          });\n        });\n      });\n\n      describe('removeCommentAttachment', () => {\n        it('should remove comment attachment', async () => {\n          (\n            prismaService.fileAttachment.deleteMany as jest.Mock\n          ).mockResolvedValue({\n            count: 1,\n          });\n\n          const result = await service.removeCommentAttachment(\n            'comment-1',\n            'file-1',\n          );\n\n          expect(result).toEqual({ count: 1 });\n          expect(prismaService.fileAttachment.deleteMany).toHaveBeenCalledWith({\n            where: {\n              entityType: AttachmentEntityType.COMMENT,\n              entityId: 'comment-1',\n              fileId: 'file-1',\n            },\n          });\n        });\n      });\n    });\n\n    describe('Reply attachments', () => {\n      describe('attachFilesToReply', () => {\n        it('should attach files to reply', async () => {\n          const fileIds = ['file-1'];\n          const expectedData = [\n            {\n              fileId: 'file-1',\n              entityType: AttachmentEntityType.REPLY,\n              entityId: 'reply-1',\n              purpose: AttachmentPurpose.MEDIA,\n              order: 0,\n            },\n          ];\n\n          (\n            prismaService.fileAttachment.createMany as jest.Mock\n          ).mockResolvedValue({\n            count: 1,\n          });\n\n          const result = await service.attachFilesToReply('reply-1', fileIds);\n\n          expect(result).toEqual({ count: 1 });\n          expect(prismaService.fileAttachment.createMany).toHaveBeenCalledWith({\n            data: expectedData,\n          });\n        });\n      });\n\n      describe('getReplyAttachments', () => {\n        it('should return reply attachments', async () => {\n          const mockAttachments = [\n            {\n              id: 'attachment-1',\n              entityId: 'reply-1',\n              file: {\n                id: 'file-1',\n                storageUrl: 'storage-url',\n                mimeType: 'image/jpeg',\n              },\n            },\n          ];\n\n          (\n            prismaService.fileAttachment.findMany as jest.Mock\n          ).mockResolvedValue(mockAttachments);\n\n          const result = await service.getReplyAttachments('reply-1');\n\n          expect(result).toEqual(mockAttachments);\n          expect(prismaService.fileAttachment.findMany).toHaveBeenCalledWith({\n            where: {\n              entityType: AttachmentEntityType.REPLY,\n              entityId: 'reply-1',\n            },\n            include: {\n              file: true,\n            },\n            orderBy: { order: 'asc' },\n          });\n        });\n      });\n\n      describe('removeReplyAttachment', () => {\n        it('should remove reply attachment', async () => {\n          (\n            prismaService.fileAttachment.deleteMany as jest.Mock\n          ).mockResolvedValue({\n            count: 1,\n          });\n\n          const result = await service.removeReplyAttachment(\n            'reply-1',\n            'file-1',\n          );\n\n          expect(result).toEqual({ count: 1 });\n          expect(prismaService.fileAttachment.deleteMany).toHaveBeenCalledWith({\n            where: {\n              entityType: AttachmentEntityType.REPLY,\n              entityId: 'reply-1',\n              fileId: 'file-1',\n            },\n          });\n        });\n      });\n    });\n  });\n\n  describe('Error handling', () => {\n    it('should handle non-Error objects in catch blocks', async () => {\n      (prismaService.comment.findMany as jest.Mock).mockRejectedValue(\n        'String error',\n      );\n\n      await expect(service.findAll()).rejects.toThrow(\n        InternalServerErrorException,\n      );\n    });\n\n    it('should re-throw ForbiddenException from database operations', async () => {\n      (prismaService.comment.findMany as jest.Mock).mockRejectedValue(\n        new ForbiddenException('Access denied'),\n      );\n\n      await expect(service.findAll()).rejects.toThrow(ForbiddenException);\n    });\n\n    it('should handle complex database operations errors', async () => {\n      (prismaService.reply.create as jest.Mock).mockRejectedValue(\n        new Error('Complex database error'),\n      );\n\n      await expect(\n        service.createReply({\n          content: 'Test',\n          userId: TEST_USER_IDS.CLIENT,\n          commentId: 'comment-1',\n        }),\n      ).rejects.toThrow(InternalServerErrorException);\n    });\n  });\n});\n"],"version":3}