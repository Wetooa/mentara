36ba84e82d967df2bd4b709b4804b700
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const common_1 = require("@nestjs/common");
const users_controller_1 = require("./users.controller");
const users_service_1 = require("./users.service");
const jwt_auth_guard_1 = require("../auth/guards/jwt-auth.guard");
const admin_auth_guard_1 = require("../auth/guards/admin-auth.guard");
const supabase_storage_service_1 = require("../common/services/supabase-storage.service");
const role_utils_1 = require("../utils/role-utils");
const zod_validation_pipe_1 = require("../common/pipes/zod-validation.pipe");
const auth_testing_helpers_1 = require("../test-utils/auth-testing-helpers");
const enhanced_test_helpers_1 = require("../test-utils/enhanced-test-helpers");
const index_1 = require("../test-utils/index");
describe('UsersController', () => {
    let controller;
    let usersService;
    let supabaseStorageService;
    let roleUtils;
    let mockJwtAuthGuard;
    let mockAdminAuthGuard;
    // Test data constants
    const mockUser = {
        id: index_1.TEST_USER_IDS.CLIENT,
        email: index_1.TEST_EMAILS.CLIENT,
        firstName: 'John',
        lastName: 'Doe',
        role: 'client',
        bio: 'User bio',
        avatarUrl: 'https://example.com/avatar.jpg',
        coverImageUrl: 'https://example.com/cover.jpg',
        phoneNumber: '+1234567890',
        timezone: 'America/New_York',
        language: 'en',
        theme: 'light',
        createdAt: new Date(),
        updatedAt: new Date(),
        emailVerified: true,
        profileComplete: true,
        isActive: true,
    };
    const mockAdminUser = {
        id: index_1.TEST_USER_IDS.ADMIN,
        email: index_1.TEST_EMAILS.ADMIN,
        firstName: 'Admin',
        lastName: 'User',
        role: 'admin',
        createdAt: new Date(),
        updatedAt: new Date(),
        emailVerified: true,
        profileComplete: true,
        isActive: true,
    };
    const mockUsers = [mockUser, mockAdminUser];
    const mockFile = {
        fieldname: 'avatar',
        originalname: 'avatar.jpg',
        encoding: '7bit',
        mimetype: 'image/jpeg',
        size: 1024,
        buffer: Buffer.from('test file content'),
    };
    const mockUploadResult = {
        url: 'https://example.com/uploaded-avatar.jpg',
        filename: 'avatar.jpg',
        size: 1024,
    };
    beforeEach(async () => {
        // Create mock services
        const mockUsersService = {
            findAll: jest.fn(),
            findAllIncludeInactive: jest.fn(),
            findOne: jest.fn(),
            findOneIncludeInactive: jest.fn(),
            update: jest.fn(),
            remove: jest.fn(),
            deactivate: jest.fn(),
            reactivate: jest.fn(),
        };
        const mockSupabaseStorageService = {
            validateFile: jest.fn(),
            uploadFile: jest.fn(),
            getSupportedBuckets: jest.fn(),
        };
        const mockRoleUtils = {
            isUserAdmin: jest.fn(),
        };
        mockJwtAuthGuard = {
            canActivate: jest.fn().mockReturnValue(true),
        };
        mockAdminAuthGuard = {
            canActivate: jest.fn().mockReturnValue(true),
        };
        // Add static method mock
        supabase_storage_service_1.SupabaseStorageService.getSupportedBuckets = jest.fn().mockReturnValue({
            USER_PROFILES: 'user-profiles',
        });
        const module = await testing_1.Test.createTestingModule({
            controllers: [users_controller_1.UsersController],
            providers: [
                {
                    provide: users_service_1.UsersService,
                    useValue: mockUsersService,
                },
                {
                    provide: supabase_storage_service_1.SupabaseStorageService,
                    useValue: mockSupabaseStorageService,
                },
                {
                    provide: role_utils_1.RoleUtils,
                    useValue: mockRoleUtils,
                },
                {
                    provide: common_1.Logger,
                    useValue: {
                        log: jest.fn(),
                        error: jest.fn(),
                        warn: jest.fn(),
                        debug: jest.fn(),
                    },
                },
            ],
        })
            .overrideGuard(jwt_auth_guard_1.JwtAuthGuard)
            .useValue(mockJwtAuthGuard)
            .overrideGuard(admin_auth_guard_1.AdminAuthGuard)
            .useValue(mockAdminAuthGuard)
            .compile();
        controller = module.get(users_controller_1.UsersController);
        usersService = module.get(users_service_1.UsersService);
        supabaseStorageService = module.get(supabase_storage_service_1.SupabaseStorageService);
        roleUtils = module.get(role_utils_1.RoleUtils);
    });
    afterEach(() => {
        jest.clearAllMocks();
    });
    describe('findAll', () => {
        it('should return all users for admin', async () => {
            // Arrange
            jest.spyOn(usersService, 'findAll').mockResolvedValue(mockUsers);
            // Act
            const result = await controller.findAll(index_1.TEST_USER_IDS.ADMIN);
            // Assert
            expect(usersService.findAll).toHaveBeenCalled();
            expect(result).toEqual(mockUsers);
        });
        it('should handle service errors', async () => {
            // Arrange
            const error = new Error('Database error');
            jest.spyOn(usersService, 'findAll').mockRejectedValue(error);
            // Act & Assert
            await expect(controller.findAll(index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('findAllIncludeInactive', () => {
        it('should return all users including inactive for admin', async () => {
            const mockUsers = [
                enhanced_test_helpers_1.TestDataGenerator.createUser({ isActive: true }),
                enhanced_test_helpers_1.TestDataGenerator.createUser({ isActive: false }),
            ];
            usersService.findAllIncludeInactive.mockResolvedValue(mockUsers);
            const result = await controller.findAllIncludeInactive(index_1.TEST_USER_IDS.ADMIN);
            expect(usersService.findAllIncludeInactive).toHaveBeenCalled();
            expect(result).toEqual(mockUsers);
        });
        it('should handle service errors when fetching all users', async () => {
            usersService.findAllIncludeInactive.mockRejectedValue(new Error('Database connection failed'));
            await expect(controller.findAllIncludeInactive(index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('findOne', () => {
        const mockUser = enhanced_test_helpers_1.TestDataGenerator.createUser({ id: index_1.TEST_USER_IDS.CLIENT });
        it('should allow user to view their own profile', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.findOne.mockResolvedValue(mockUser);
            const result = await controller.findOne(index_1.TEST_USER_IDS.CLIENT, index_1.TEST_USER_IDS.CLIENT);
            expect(roleUtils.isUserAdmin).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT);
            expect(usersService.findOne).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT);
            expect(result).toEqual(mockUser);
        });
        it('should allow admin to view any user profile', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(true);
            usersService.findOneIncludeInactive.mockResolvedValue(mockUser);
            const result = await controller.findOne(index_1.TEST_USER_IDS.CLIENT, index_1.TEST_USER_IDS.ADMIN);
            expect(roleUtils.isUserAdmin).toHaveBeenCalledWith(index_1.TEST_USER_IDS.ADMIN);
            expect(usersService.findOneIncludeInactive).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT);
            expect(result).toEqual(mockUser);
        });
        it('should throw ForbiddenException when non-admin tries to view other user', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(false);
            await expect(controller.findOne({ id: index_1.TEST_USER_IDS.THERAPIST }, index_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.ForbiddenException);
            expect(usersService.findOne).not.toHaveBeenCalled();
        });
        it('should throw HttpException when user not found', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.findOne.mockResolvedValue(null);
            await expect(controller.findOne({ id: index_1.TEST_USER_IDS.CLIENT }, index_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('update', () => {
        const updateData = {
            firstName: 'Updated',
            lastName: 'Name',
            bio: 'Updated bio',
        };
        it('should allow user to update their own profile', async () => {
            const updatedUser = { ...enhanced_test_helpers_1.TestDataGenerator.createUser(), ...updateData };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.update.mockResolvedValue(updatedUser);
            const result = await controller.update({ id: index_1.TEST_USER_IDS.CLIENT }, updateData, index_1.TEST_USER_IDS.CLIENT);
            expect(roleUtils.isUserAdmin).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT);
            expect(usersService.update).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, updateData);
            expect(result).toEqual(updatedUser);
        });
        it('should allow admin to update any user with all fields', async () => {
            const adminUpdateData = {
                firstName: 'Admin Updated',
                role: 'moderator',
                isActive: false,
            };
            const updatedUser = {
                ...enhanced_test_helpers_1.TestDataGenerator.createUser(),
                ...adminUpdateData,
            };
            roleUtils.isUserAdmin.mockResolvedValue(true);
            usersService.update.mockResolvedValue(updatedUser);
            const result = await controller.update({ id: index_1.TEST_USER_IDS.CLIENT }, adminUpdateData, index_1.TEST_USER_IDS.ADMIN);
            expect(usersService.update).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, adminUpdateData);
            expect(result).toEqual(updatedUser);
        });
        it('should sanitize non-admin updates to allowed fields only', async () => {
            const unauthorizedData = {
                firstName: 'John',
                role: 'admin', // Should be filtered out
                isActive: false, // Should be filtered out
                bio: 'New bio',
            };
            const sanitizedData = {
                firstName: 'John',
                bio: 'New bio',
            };
            const updatedUser = {
                ...enhanced_test_helpers_1.TestDataGenerator.createUser(),
                ...sanitizedData,
            };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.update.mockResolvedValue(updatedUser);
            const result = await controller.update({ id: index_1.TEST_USER_IDS.CLIENT }, unauthorizedData, index_1.TEST_USER_IDS.CLIENT);
            expect(usersService.update).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, sanitizedData);
            expect(result).toEqual(updatedUser);
        });
        it('should throw ForbiddenException when non-admin tries to update other user', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(false);
            await expect(controller.update({ id: index_1.TEST_USER_IDS.THERAPIST }, updateData, index_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.ForbiddenException);
            expect(usersService.update).not.toHaveBeenCalled();
        });
    });
    describe('remove', () => {
        it('should allow user to deactivate their own account', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.remove.mockResolvedValue({});
            const result = await controller.remove({ id: index_1.TEST_USER_IDS.CLIENT }, index_1.TEST_USER_IDS.CLIENT);
            expect(roleUtils.isUserAdmin).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT);
            expect(usersService.remove).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT);
            expect(result).toEqual({
                message: 'User account deactivated successfully',
            });
        });
        it('should allow admin to deactivate any user account', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(true);
            usersService.remove.mockResolvedValue({});
            const result = await controller.remove(index_1.TEST_USER_IDS.CLIENT, index_1.TEST_USER_IDS.ADMIN);
            expect(usersService.remove).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT);
            expect(result).toEqual({
                message: 'User account deactivated successfully',
            });
        });
        it('should throw ForbiddenException when non-admin tries to deactivate other user', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(false);
            await expect(controller.remove({ id: index_1.TEST_USER_IDS.THERAPIST }, index_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.ForbiddenException);
            expect(usersService.remove).not.toHaveBeenCalled();
        });
    });
    describe('deactivateUser (admin only)', () => {
        it('should allow admin to deactivate user with reason', async () => {
            const deactivationBody = { reason: 'Policy violation' };
            usersService.deactivate.mockResolvedValue({});
            const result = await controller.deactivateUser({ id: index_1.TEST_USER_IDS.CLIENT }, deactivationBody, index_1.TEST_USER_IDS.ADMIN);
            expect(usersService.deactivate).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, 'Policy violation', index_1.TEST_USER_IDS.ADMIN);
            expect(result).toEqual({
                message: 'User account deactivated by administrator',
            });
        });
        it('should handle deactivation without reason', async () => {
            const deactivationBody = {};
            usersService.deactivate.mockResolvedValue({});
            const result = await controller.deactivateUser({ id: index_1.TEST_USER_IDS.CLIENT }, deactivationBody, index_1.TEST_USER_IDS.ADMIN);
            expect(usersService.deactivate).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, undefined, index_1.TEST_USER_IDS.ADMIN);
            expect(result).toEqual({
                message: 'User account deactivated by administrator',
            });
        });
        it('should handle service errors during deactivation', async () => {
            const deactivationBody = { reason: 'Test reason' };
            usersService.deactivate.mockRejectedValue(new Error('Service error'));
            await expect(controller.deactivateUser({ id: index_1.TEST_USER_IDS.CLIENT }, deactivationBody, index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('reactivateUser (admin only)', () => {
        it('should allow admin to reactivate user', async () => {
            usersService.reactivate.mockResolvedValue({});
            const result = await controller.reactivateUser({ id: index_1.TEST_USER_IDS.CLIENT }, index_1.TEST_USER_IDS.ADMIN);
            expect(usersService.reactivate).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT);
            expect(result).toEqual({
                message: 'User account reactivated successfully',
            });
        });
        it('should handle service errors during reactivation', async () => {
            usersService.reactivate.mockRejectedValue(new Error('Reactivation failed'));
            await expect(controller.reactivateUser({ id: index_1.TEST_USER_IDS.CLIENT }, index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('error handling', () => {
        it('should preserve ForbiddenException from service layer', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(true);
            usersService.findOneIncludeInactive.mockRejectedValue(new common_1.ForbiddenException('Access denied'));
            await expect(controller.findOne({ id: index_1.TEST_USER_IDS.CLIENT }, index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow(common_1.ForbiddenException);
        });
        it('should wrap generic errors in HttpException', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.findOne.mockRejectedValue(new Error('Generic error'));
            await expect(controller.findOne({ id: index_1.TEST_USER_IDS.CLIENT }, index_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.HttpException);
        });
        it('should handle role utils errors gracefully', async () => {
            roleUtils.isUserAdmin.mockRejectedValue(new Error('Role check failed'));
            await expect(controller.findOne({ id: index_1.TEST_USER_IDS.CLIENT }, index_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.HttpException);
        });
    });
    describe('authorization edge cases', () => {
        it('should handle empty update data for non-admin', async () => {
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.update.mockResolvedValue(enhanced_test_helpers_1.TestDataGenerator.createUser());
            await controller.update({ id: index_1.TEST_USER_IDS.CLIENT }, {}, index_1.TEST_USER_IDS.CLIENT);
            expect(usersService.update).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, {});
        });
        it('should handle mixed allowed and disallowed fields for non-admin', async () => {
            const mixedData = {
                firstName: 'John', // Allowed
                lastName: 'Doe', // Allowed
                role: 'admin', // Not allowed
                bio: 'New bio', // Allowed
                isActive: false, // Not allowed
                avatarUrl: 'http://example.com/avatar.jpg', // Allowed
            };
            const expectedSanitizedData = {
                firstName: 'John',
                lastName: 'Doe',
                bio: 'New bio',
                avatarUrl: 'http://example.com/avatar.jpg',
            };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.update.mockResolvedValue(enhanced_test_helpers_1.TestDataGenerator.createUser());
            await controller.update({ id: index_1.TEST_USER_IDS.CLIENT }, mixedData, index_1.TEST_USER_IDS.CLIENT);
            expect(usersService.update).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, expectedSanitizedData);
        });
    });
    describe('File Upload Integration', () => {
        it('should handle avatar upload successfully', async () => {
            // Arrange
            const mockFiles = {
                avatar: [mockFile],
            };
            const updateData = {
                firstName: 'John',
                lastName: 'Doe',
            };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            supabaseStorageService.validateFile.mockReturnValue({ isValid: true });
            supabaseStorageService.uploadFile.mockResolvedValue(mockUploadResult);
            usersService.update.mockResolvedValue(enhanced_test_helpers_1.TestDataGenerator.createUser());
            // Act
            await controller.update({ id: index_1.TEST_USER_IDS.CLIENT }, updateData, index_1.TEST_USER_IDS.CLIENT, mockFiles);
            // Assert
            expect(supabaseStorageService.validateFile).toHaveBeenCalledWith(mockFile);
            expect(supabaseStorageService.uploadFile).toHaveBeenCalledWith(mockFile, 'user-profiles');
            expect(usersService.update).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, {
                ...updateData,
                avatarUrl: mockUploadResult.url,
            });
        });
        it('should handle cover image upload successfully', async () => {
            // Arrange
            const mockCoverFile = {
                ...mockFile,
                fieldname: 'cover',
                originalname: 'cover.jpg',
            };
            const mockFiles = {
                cover: [mockCoverFile],
            };
            const updateData = {
                firstName: 'John',
                lastName: 'Doe',
            };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            supabaseStorageService.validateFile.mockReturnValue({ isValid: true });
            supabaseStorageService.uploadFile.mockResolvedValue(mockUploadResult);
            usersService.update.mockResolvedValue(enhanced_test_helpers_1.TestDataGenerator.createUser());
            // Act
            await controller.update({ id: index_1.TEST_USER_IDS.CLIENT }, updateData, index_1.TEST_USER_IDS.CLIENT, mockFiles);
            // Assert
            expect(supabaseStorageService.validateFile).toHaveBeenCalledWith(mockCoverFile);
            expect(supabaseStorageService.uploadFile).toHaveBeenCalledWith(mockCoverFile, 'user-profiles');
            expect(usersService.update).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, {
                ...updateData,
                coverImageUrl: mockUploadResult.url,
            });
        });
        it('should handle multiple file uploads simultaneously', async () => {
            // Arrange
            const mockCoverFile = {
                ...mockFile,
                fieldname: 'cover',
                originalname: 'cover.jpg',
            };
            const mockFiles = {
                avatar: [mockFile],
                cover: [mockCoverFile],
            };
            const updateData = {
                firstName: 'John',
                lastName: 'Doe',
            };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            supabaseStorageService.validateFile.mockReturnValue({ isValid: true });
            supabaseStorageService.uploadFile.mockResolvedValue(mockUploadResult);
            usersService.update.mockResolvedValue(enhanced_test_helpers_1.TestDataGenerator.createUser());
            // Act
            await controller.update({ id: index_1.TEST_USER_IDS.CLIENT }, updateData, index_1.TEST_USER_IDS.CLIENT, mockFiles);
            // Assert
            expect(supabaseStorageService.validateFile).toHaveBeenCalledTimes(2);
            expect(supabaseStorageService.uploadFile).toHaveBeenCalledTimes(2);
            expect(usersService.update).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, {
                ...updateData,
                avatarUrl: mockUploadResult.url,
                coverImageUrl: mockUploadResult.url,
            });
        });
        it('should handle file validation errors', async () => {
            // Arrange
            const mockFiles = {
                avatar: [mockFile],
            };
            const updateData = {
                firstName: 'John',
                lastName: 'Doe',
            };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            supabaseStorageService.validateFile.mockReturnValue({
                isValid: false,
                error: 'File too large',
            });
            // Act & Assert
            await expect(controller.update({ id: index_1.TEST_USER_IDS.CLIENT }, updateData, index_1.TEST_USER_IDS.CLIENT, mockFiles)).rejects.toThrow('Avatar validation failed: File too large');
        });
        it('should handle file upload errors', async () => {
            // Arrange
            const mockFiles = {
                avatar: [mockFile],
            };
            const updateData = {
                firstName: 'John',
                lastName: 'Doe',
            };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            supabaseStorageService.validateFile.mockReturnValue({ isValid: true });
            supabaseStorageService.uploadFile.mockRejectedValue(new Error('Upload failed'));
            // Act & Assert
            await expect(controller.update({ id: index_1.TEST_USER_IDS.CLIENT }, updateData, index_1.TEST_USER_IDS.CLIENT, mockFiles)).rejects.toThrow('Failed to update user: Upload failed');
        });
    });
    describe('Security Tests', () => {
        it('should validate input data through ZodValidationPipe', () => {
            // This tests that the controller uses proper validation
            const validationPipe = new zod_validation_pipe_1.ZodValidationPipe({});
            expect(validationPipe).toBeDefined();
        });
        it('should require authentication for all endpoints', () => {
            // Test that all endpoints have JwtAuthGuard
            const protectedMethods = ['findAll', 'findAllIncludeInactive', 'findOne', 'update', 'remove', 'deactivateUser', 'reactivateUser'];
            protectedMethods.forEach(method => {
                const guards = Reflect.getMetadata('__guards__', controller[method]);
                expect(guards).toBeDefined();
            });
        });
        it('should enforce admin-only access for admin endpoints', () => {
            // Test that admin endpoints have AdminAuthGuard
            const adminMethods = ['findAll', 'findAllIncludeInactive', 'deactivateUser', 'reactivateUser'];
            adminMethods.forEach(method => {
                const guards = Reflect.getMetadata('__guards__', controller[method]);
                expect(guards).toBeDefined();
            });
        });
        it('should handle JWT token validation', async () => {
            // Test that JWT guard is properly applied
            mockJwtAuthGuard.canActivate.mockReturnValue(false);
            // Mock the actual HTTP exception that would be thrown
            const unauthorizedError = new Error('Unauthorized');
            usersService.findAll.mockRejectedValue(unauthorizedError);
            await expect(controller.findAll(index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow();
        });
        it('should handle admin authorization validation', async () => {
            // Test that admin guard is properly applied
            mockAdminAuthGuard.canActivate.mockReturnValue(false);
            // Mock the actual HTTP exception that would be thrown
            const forbiddenError = new Error('Forbidden');
            usersService.findAll.mockRejectedValue(forbiddenError);
            await expect(controller.findAll(index_1.TEST_USER_IDS.ADMIN)).rejects.toThrow();
        });
        it('should prevent unauthorized access to other user profiles', async () => {
            // Test that users can only access their own profile
            roleUtils.isUserAdmin.mockResolvedValue(false);
            await expect(controller.findOne({ id: index_1.TEST_USER_IDS.THERAPIST }, index_1.TEST_USER_IDS.CLIENT)).rejects.toThrow(common_1.ForbiddenException);
        });
    });
    describe('Role-based Access Control', () => {
        it('should test role-based access for admin endpoints', async () => {
            // Test that admin endpoints require admin role
            await auth_testing_helpers_1.RoleBasedTestUtils.testWithRoles(async (userId, role) => {
                try {
                    await controller.findAll(userId);
                    return true;
                }
                catch (error) {
                    return false;
                }
            }, {
                client: false,
                therapist: false,
                admin: true,
                moderator: false,
            });
        });
        it('should validate user-specific functionality', async () => {
            // Test that users can access their own profile
            const userContext = enhanced_test_helpers_1.MockBuilder.createAuthContext('client');
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.findOne.mockResolvedValue(mockUser);
            const result = await controller.findOne(userContext.userId, userContext.userId);
            expect(result).toBeDefined();
            expect(result.id).toBe(userContext.userId);
        });
        it('should test field sanitization for non-admin users', async () => {
            // Test that non-admin users cannot update sensitive fields
            const sensitiveData = {
                firstName: 'John',
                role: 'admin', // Should be filtered out
                isActive: false, // Should be filtered out
                emailVerified: true, // Should be filtered out
            };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.update.mockResolvedValue(mockUser);
            await controller.update({ id: index_1.TEST_USER_IDS.CLIENT }, sensitiveData, index_1.TEST_USER_IDS.CLIENT);
            expect(usersService.update).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, { firstName: 'John' });
        });
    });
    describe('Integration Tests', () => {
        it('should handle complete user profile update workflow', async () => {
            // Arrange
            const updateData = {
                firstName: 'Updated',
                lastName: 'Name',
                bio: 'Updated bio',
                timezone: 'America/Los_Angeles',
                language: 'en',
                theme: 'dark',
            };
            const updatedUser = { ...mockUser, ...updateData };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.update.mockResolvedValue(updatedUser);
            // Act
            const result = await controller.update({ id: index_1.TEST_USER_IDS.CLIENT }, updateData, index_1.TEST_USER_IDS.CLIENT);
            // Assert
            expect(result).toBeDefined();
            expect(result.firstName).toBe('Updated');
            expect(result.lastName).toBe('Name');
            expect(result.bio).toBe('Updated bio');
            expect(result.timezone).toBe('America/Los_Angeles');
        });
        it('should handle complete admin user management workflow', async () => {
            // Arrange
            roleUtils.isUserAdmin.mockResolvedValue(true);
            usersService.findAll.mockResolvedValue(mockUsers);
            usersService.findAllIncludeInactive.mockResolvedValue(mockUsers);
            usersService.findOneIncludeInactive.mockResolvedValue(mockUser);
            // Act - Get all users
            const allUsers = await controller.findAll(index_1.TEST_USER_IDS.ADMIN);
            // Act - Get all users including inactive
            const allUsersIncludeInactive = await controller.findAllIncludeInactive(index_1.TEST_USER_IDS.ADMIN);
            // Act - View specific user
            const specificUser = await controller.findOne({ id: index_1.TEST_USER_IDS.CLIENT }, index_1.TEST_USER_IDS.ADMIN);
            // Assert
            expect(allUsers).toBeDefined();
            expect(allUsers).toHaveLength(2);
            expect(allUsersIncludeInactive).toBeDefined();
            expect(allUsersIncludeInactive).toHaveLength(2);
            expect(specificUser).toBeDefined();
            expect(specificUser.id).toBe(index_1.TEST_USER_IDS.CLIENT);
        });
        it('should handle complete user deactivation workflow', async () => {
            // Arrange
            usersService.deactivate.mockResolvedValue({});
            // Act
            const result = await controller.deactivateUser({ id: index_1.TEST_USER_IDS.CLIENT }, { reason: 'Policy violation' }, index_1.TEST_USER_IDS.ADMIN);
            // Assert
            expect(result).toBeDefined();
            expect(result.message).toBe('User account deactivated by administrator');
            expect(usersService.deactivate).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT, 'Policy violation', index_1.TEST_USER_IDS.ADMIN);
        });
        it('should handle complete user reactivation workflow', async () => {
            // Arrange
            usersService.reactivate.mockResolvedValue({});
            // Act
            const result = await controller.reactivateUser({ id: index_1.TEST_USER_IDS.CLIENT }, index_1.TEST_USER_IDS.ADMIN);
            // Assert
            expect(result).toBeDefined();
            expect(result.message).toBe('User account reactivated successfully');
            expect(usersService.reactivate).toHaveBeenCalledWith(index_1.TEST_USER_IDS.CLIENT);
        });
    });
    describe('Data Validation', () => {
        it('should validate user update data structure', () => {
            // Test that we're using the correct DTO structure
            const validUpdateData = {
                firstName: 'John',
                lastName: 'Doe',
                bio: 'User bio',
                avatarUrl: 'https://example.com/avatar.jpg',
                coverImageUrl: 'https://example.com/cover.jpg',
                phoneNumber: '+1234567890',
                timezone: 'America/New_York',
                language: 'en',
                theme: 'light',
            };
            // Verify all fields are defined
            expect(validUpdateData.firstName).toBeDefined();
            expect(validUpdateData.lastName).toBeDefined();
            expect(validUpdateData.bio).toBeDefined();
            expect(validUpdateData.avatarUrl).toBeDefined();
            expect(validUpdateData.coverImageUrl).toBeDefined();
            expect(validUpdateData.phoneNumber).toBeDefined();
            expect(validUpdateData.timezone).toBeDefined();
            expect(validUpdateData.language).toBeDefined();
            expect(validUpdateData.theme).toBeDefined();
        });
        it('should validate deactivation data structure', () => {
            // Test that we're using the correct DTO structure
            const validDeactivationData = {
                reason: 'Policy violation',
            };
            // Verify all fields are defined
            expect(validDeactivationData.reason).toBeDefined();
        });
        it('should validate user ID parameter structure', () => {
            // Test that we're using the correct parameter structure
            const validUserIdParam = {
                id: index_1.TEST_USER_IDS.CLIENT,
            };
            // Verify all fields are defined
            expect(validUserIdParam.id).toBeDefined();
        });
    });
    describe('Response Format Validation', () => {
        it('should return correctly formatted user list response', async () => {
            // Arrange
            roleUtils.isUserAdmin.mockResolvedValue(true);
            usersService.findAll.mockResolvedValue(mockUsers);
            // Act
            const result = await controller.findAll(index_1.TEST_USER_IDS.ADMIN);
            // Assert
            expect(result).toBeInstanceOf(Array);
            expect(result).toHaveLength(2);
            const user = result[0];
            expect(user).toHaveProperty('id');
            expect(user).toHaveProperty('email');
            expect(user).toHaveProperty('firstName');
            expect(user).toHaveProperty('lastName');
            expect(user).toHaveProperty('role');
            expect(user).toHaveProperty('createdAt');
            expect(user).toHaveProperty('isActive');
        });
        it('should return correctly formatted user profile response', async () => {
            // Arrange
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.findOne.mockResolvedValue(mockUser);
            // Act
            const result = await controller.findOne({ id: index_1.TEST_USER_IDS.CLIENT }, index_1.TEST_USER_IDS.CLIENT);
            // Assert
            expect(result).toHaveProperty('id');
            expect(result).toHaveProperty('email');
            expect(result).toHaveProperty('firstName');
            expect(result).toHaveProperty('lastName');
            expect(result).toHaveProperty('role');
            expect(result).toHaveProperty('bio');
            expect(result).toHaveProperty('avatarUrl');
            expect(result).toHaveProperty('coverImageUrl');
            expect(result).toHaveProperty('phoneNumber');
            expect(result).toHaveProperty('timezone');
            expect(result).toHaveProperty('language');
            expect(result).toHaveProperty('theme');
            expect(result).toHaveProperty('createdAt');
            expect(result).toHaveProperty('updatedAt');
        });
        it('should return correctly formatted update response', async () => {
            // Arrange
            const updateData = {
                firstName: 'Updated',
                lastName: 'Name',
            };
            const updatedUser = { ...mockUser, ...updateData };
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.update.mockResolvedValue(updatedUser);
            // Act
            const result = await controller.update({ id: index_1.TEST_USER_IDS.CLIENT }, updateData, index_1.TEST_USER_IDS.CLIENT);
            // Assert
            expect(result).toHaveProperty('id');
            expect(result).toHaveProperty('email');
            expect(result).toHaveProperty('firstName');
            expect(result).toHaveProperty('lastName');
            expect(result.firstName).toBe('Updated');
            expect(result.lastName).toBe('Name');
        });
        it('should return correctly formatted deactivation response', async () => {
            // Arrange
            roleUtils.isUserAdmin.mockResolvedValue(false);
            usersService.remove.mockResolvedValue({});
            // Act
            const result = await controller.remove({ id: index_1.TEST_USER_IDS.CLIENT }, index_1.TEST_USER_IDS.CLIENT);
            // Assert
            expect(result).toHaveProperty('message');
            expect(result.message).toBe('User account deactivated successfully');
        });
        it('should return correctly formatted admin deactivation response', async () => {
            // Arrange
            usersService.deactivate.mockResolvedValue({});
            // Act
            const result = await controller.deactivateUser(index_1.TEST_USER_IDS.CLIENT, { reason: 'Policy violation' }, index_1.TEST_USER_IDS.ADMIN);
            // Assert
            expect(result).toHaveProperty('message');
            expect(result.message).toBe('User account deactivated by administrator');
        });
        it('should return correctly formatted reactivation response', async () => {
            // Arrange
            usersService.reactivate.mockResolvedValue({});
            // Act
            const result = await controller.reactivateUser({ id: index_1.TEST_USER_IDS.CLIENT }, index_1.TEST_USER_IDS.ADMIN);
            // Assert
            expect(result).toHaveProperty('message');
            expect(result.message).toBe('User account reactivated successfully');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL3VzZXJzL3VzZXJzLmNvbnRyb2xsZXIuc3BlYy50cyIsIm1hcHBpbmdzIjoiOztBQUFBLDZDQUFzRDtBQUN0RCwyQ0FLd0I7QUFDeEIseURBQXFEO0FBQ3JELG1EQUErQztBQUMvQyxrRUFBNkQ7QUFDN0Qsc0VBQWlFO0FBQ2pFLDBGQUFxRjtBQUNyRixvREFBZ0Q7QUFDaEQsNkVBQXdFO0FBQ3hFLDZFQUc0QztBQUM1QywrRUFJNkM7QUFDN0MsK0NBQWlFO0FBRWpFLFFBQVEsQ0FBQyxpQkFBaUIsRUFBRSxHQUFHLEVBQUU7SUFDL0IsSUFBSSxVQUEyQixDQUFDO0lBQ2hDLElBQUksWUFBMEIsQ0FBQztJQUMvQixJQUFJLHNCQUE4QyxDQUFDO0lBQ25ELElBQUksU0FBb0IsQ0FBQztJQUN6QixJQUFJLGdCQUEyQyxDQUFDO0lBQ2hELElBQUksa0JBQStDLENBQUM7SUFFcEQsc0JBQXNCO0lBQ3RCLE1BQU0sUUFBUSxHQUFHO1FBQ2YsRUFBRSxFQUFFLHFCQUFhLENBQUMsTUFBTTtRQUN4QixLQUFLLEVBQUUsbUJBQVcsQ0FBQyxNQUFNO1FBQ3pCLFNBQVMsRUFBRSxNQUFNO1FBQ2pCLFFBQVEsRUFBRSxLQUFLO1FBQ2YsSUFBSSxFQUFFLFFBQVE7UUFDZCxHQUFHLEVBQUUsVUFBVTtRQUNmLFNBQVMsRUFBRSxnQ0FBZ0M7UUFDM0MsYUFBYSxFQUFFLCtCQUErQjtRQUM5QyxXQUFXLEVBQUUsYUFBYTtRQUMxQixRQUFRLEVBQUUsa0JBQWtCO1FBQzVCLFFBQVEsRUFBRSxJQUFJO1FBQ2QsS0FBSyxFQUFFLE9BQU87UUFDZCxTQUFTLEVBQUUsSUFBSSxJQUFJLEVBQUU7UUFDckIsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFO1FBQ3JCLGFBQWEsRUFBRSxJQUFJO1FBQ25CLGVBQWUsRUFBRSxJQUFJO1FBQ3JCLFFBQVEsRUFBRSxJQUFJO0tBQ2YsQ0FBQztJQUVGLE1BQU0sYUFB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LE1BQU0sRUFBRSxrQkFBa0IsRUFBRSxFQUM5QixxQkFBYSxDQUFDLEtBQUssQ0FDcEIsQ0FBQztZQUVGLFNBQVM7WUFDVCxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsY0FBYyxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQ3pDLE1BQU0sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLDJDQUEyQyxDQUFDLENBQUM7UUFDM0UsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMseURBQXlELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDdkUsVUFBVTtZQUNWLFlBQVksQ0FBQyxVQUFVLENBQUMsaUJBQWlCLENBQUMsRUFBUyxDQUFDLENBQUM7WUFFckQsTUFBTTtZQUNOLE1BQU0sTUFBTSxHQUFHLE1BQU0sVUFBVSxDQUFDLGNBQWMsQ0FDNUMsRUFBRSxFQUFFLEVBQUUscUJBQWEsQ0FBQyxNQUFNLEVBQUUsRUFDNUIscUJBQWEsQ0FBQyxLQUFLLENBQ3BCLENBQUM7WUFFRixTQUFTO1lBQ1QsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGNBQWMsQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUN6QyxNQUFNLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyx1Q0FBdUMsQ0FBQyxDQUFDO1FBQ3ZFLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS93ZXRvb2EvRG9jdW1lbnRzL2NvZGUvcHJvamVjdHMvbWVudGFyYS9tZW50YXJhLWFwaS9zcmMvdXNlcnMvdXNlcnMuY29udHJvbGxlci5zcGVjLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFRlc3QsIFRlc3RpbmdNb2R1bGUgfSBmcm9tICdAbmVzdGpzL3Rlc3RpbmcnO1xuaW1wb3J0IHsgXG4gIEh0dHBFeGNlcHRpb24sIFxuICBIdHRwU3RhdHVzLCBcbiAgRm9yYmlkZGVuRXhjZXB0aW9uLCBcbiAgTG9nZ2VyIFxufSBmcm9tICdAbmVzdGpzL2NvbW1vbic7XG5pbXBvcnQgeyBVc2Vyc0NvbnRyb2xsZXIgfSBmcm9tICcuL3VzZXJzLmNvbnRyb2xsZXInO1xuaW1wb3J0IHsgVXNlcnNTZXJ2aWNlIH0gZnJvbSAnLi91c2Vycy5zZXJ2aWNlJztcbmltcG9ydCB7IEp3dEF1dGhHdWFyZCB9IGZyb20gJy4uL2F1dGgvZ3VhcmRzL2p3dC1hdXRoLmd1YXJkJztcbmltcG9ydCB7IEFkbWluQXV0aEd1YXJkIH0gZnJvbSAnLi4vYXV0aC9ndWFyZHMvYWRtaW4tYXV0aC5ndWFyZCc7XG5pbXBvcnQgeyBTdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlIH0gZnJvbSAnLi4vY29tbW9uL3NlcnZpY2VzL3N1cGFiYXNlLXN0b3JhZ2Uuc2VydmljZSc7XG5pbXBvcnQgeyBSb2xlVXRpbHMgfSBmcm9tICcuLi91dGlscy9yb2xlLXV0aWxzJztcbmltcG9ydCB7IFpvZFZhbGlkYXRpb25QaXBlIH0gZnJvbSAnLi4vY29tbW9uL3BpcGVzL3pvZC12YWxpZGF0aW9uLnBpcGUnO1xuaW1wb3J0IHtcbiAgU2VjdXJpdHlHdWFyZFRlc3RVdGlscyxcbiAgUm9sZUJhc2VkVGVzdFV0aWxzLFxufSBmcm9tICcuLi90ZXN0LXV0aWxzL2F1dGgtdGVzdGluZy1oZWxwZXJzJztcbmltcG9ydCB7XG4gIE1vY2tCdWlsZGVyLFxuICBUZXN0RGF0YUdlbmVyYXRvcixcbiAgVGVzdEFzc2VydGlvbnMsXG59IGZyb20gJy4uL3Rlc3QtdXRpbHMvZW5oYW5jZWQtdGVzdC1oZWxwZXJzJztcbmltcG9ydCB7IFRFU1RfVVNFUl9JRFMsIFRFU1RfRU1BSUxTIH0gZnJvbSAnLi4vdGVzdC11dGlscy9pbmRleCc7XG5cbmRlc2NyaWJlKCdVc2Vyc0NvbnRyb2xsZXInLCAoKSA9PiB7XG4gIGxldCBjb250cm9sbGVyOiBVc2Vyc0NvbnRyb2xsZXI7XG4gIGxldCB1c2Vyc1NlcnZpY2U6IFVzZXJzU2VydmljZTtcbiAgbGV0IHN1cGFiYXNlU3RvcmFnZVNlcnZpY2U6IFN1cGFiYXNlU3RvcmFnZVNlcnZpY2U7XG4gIGxldCByb2xlVXRpbHM6IFJvbGVVdGlscztcbiAgbGV0IG1vY2tKd3RBdXRoR3VhcmQ6IGplc3QuTW9ja2VkPEp3dEF1dGhHdWFyZD47XG4gIGxldCBtb2NrQWRtaW5BdXRoR3VhcmQ6IGplc3QuTW9ja2VkPEFkbWluQXV0aEd1YXJkPjtcblxuICAvLyBUZXN0IGRhdGEgY29uc3RhbnRzXG4gIGNvbnN0IG1vY2tVc2VyID0ge1xuICAgIGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICBlbWFpbDogVEVTVF9FTUFJTFMuQ0xJRU5ULFxuICAgIGZpcnN0TmFtZTogJ0pvaG4nLFxuICAgIGxhc3ROYW1lOiAnRG9lJyxcbiAgICByb2xlOiAnY2xpZW50JyxcbiAgICBiaW86ICdVc2VyIGJpbycsXG4gICAgYXZhdGFyVXJsOiAnaHR0cHM6Ly9leGFtcGxlLmNvbS9hdmF0YXIuanBnJyxcbiAgICBjb3ZlckltYWdlVXJsOiAnaHR0cHM6Ly9leGFtcGxlLmNvbS9jb3Zlci5qcGcnLFxuICAgIHBob25lTnVtYmVyOiAnKzEyMzQ1Njc4OTAnLFxuICAgIHRpbWV6b25lOiAnQW1lcmljYS9OZXdfWW9yaycsXG4gICAgbGFuZ3VhZ2U6ICdlbicsXG4gICAgdGhlbWU6ICdsaWdodCcsXG4gICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICBlbWFpbFZlcmlmaWVkOiB0cnVlLFxuICAgIHByb2ZpbGVDb21wbGV0ZTogdHJ1ZSxcbiAgICBpc0FjdGl2ZTogdHJ1ZSxcbiAgfTtcblxuICBjb25zdCBtb2NrQWRtaW5Vc2VyID0ge1xuICAgIGlkOiBURVNUX1VTRVJfSURTLkFETUlOLFxuICAgIGVtYWlsOiBURVNUX0VNQUlMUy5BRE1JTixcbiAgICBmaXJzdE5hbWU6ICdBZG1pbicsXG4gICAgbGFzdE5hbWU6ICdVc2VyJyxcbiAgICByb2xlOiAnYWRtaW4nLFxuICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgZW1haWxWZXJpZmllZDogdHJ1ZSxcbiAgICBwcm9maWxlQ29tcGxldGU6IHRydWUsXG4gICAgaXNBY3RpdmU6IHRydWUsXG4gIH07XG5cbiAgY29uc3QgbW9ja1VzZXJzID0gW21vY2tVc2VyLCBtb2NrQWRtaW5Vc2VyXTtcblxuICBjb25zdCBtb2NrRmlsZSA9IHtcbiAgICBmaWVsZG5hbWU6ICdhdmF0YXInLFxuICAgIG9yaWdpbmFsbmFtZTogJ2F2YXRhci5qcGcnLFxuICAgIGVuY29kaW5nOiAnN2JpdCcsXG4gICAgbWltZXR5cGU6ICdpbWFnZS9qcGVnJyxcbiAgICBzaXplOiAxMDI0LFxuICAgIGJ1ZmZlcjogQnVmZmVyLmZyb20oJ3Rlc3QgZmlsZSBjb250ZW50JyksXG4gIH0gYXMgRXhwcmVzcy5NdWx0ZXIuRmlsZTtcblxuICBjb25zdCBtb2NrVXBsb2FkUmVzdWx0ID0ge1xuICAgIHVybDogJ2h0dHBzOi8vZXhhbXBsZS5jb20vdXBsb2FkZWQtYXZhdGFyLmpwZycsXG4gICAgZmlsZW5hbWU6ICdhdmF0YXIuanBnJyxcbiAgICBzaXplOiAxMDI0LFxuICB9O1xuXG4gIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xuICAgIC8vIENyZWF0ZSBtb2NrIHNlcnZpY2VzXG4gICAgY29uc3QgbW9ja1VzZXJzU2VydmljZSA9IHtcbiAgICAgIGZpbmRBbGw6IGplc3QuZm4oKSxcbiAgICAgIGZpbmRBbGxJbmNsdWRlSW5hY3RpdmU6IGplc3QuZm4oKSxcbiAgICAgIGZpbmRPbmU6IGplc3QuZm4oKSxcbiAgICAgIGZpbmRPbmVJbmNsdWRlSW5hY3RpdmU6IGplc3QuZm4oKSxcbiAgICAgIHVwZGF0ZTogamVzdC5mbigpLFxuICAgICAgcmVtb3ZlOiBqZXN0LmZuKCksXG4gICAgICBkZWFjdGl2YXRlOiBqZXN0LmZuKCksXG4gICAgICByZWFjdGl2YXRlOiBqZXN0LmZuKCksXG4gICAgfTtcblxuICAgIGNvbnN0IG1vY2tTdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlID0ge1xuICAgICAgdmFsaWRhdGVGaWxlOiBqZXN0LmZuKCksXG4gICAgICB1cGxvYWRGaWxlOiBqZXN0LmZuKCksXG4gICAgICBnZXRTdXBwb3J0ZWRCdWNrZXRzOiBqZXN0LmZuKCksXG4gICAgfTtcblxuICAgIGNvbnN0IG1vY2tSb2xlVXRpbHMgPSB7XG4gICAgICBpc1VzZXJBZG1pbjogamVzdC5mbigpLFxuICAgIH07XG5cbiAgICBtb2NrSnd0QXV0aEd1YXJkID0ge1xuICAgICAgY2FuQWN0aXZhdGU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUodHJ1ZSksXG4gICAgfSBhcyBhbnk7XG5cbiAgICBtb2NrQWRtaW5BdXRoR3VhcmQgPSB7XG4gICAgICBjYW5BY3RpdmF0ZTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh0cnVlKSxcbiAgICB9IGFzIGFueTtcblxuICAgIC8vIEFkZCBzdGF0aWMgbWV0aG9kIG1vY2tcbiAgICBTdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlLmdldFN1cHBvcnRlZEJ1Y2tldHMgPSBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgIFVTRVJfUFJPRklMRVM6ICd1c2VyLXByb2ZpbGVzJyxcbiAgICB9KTtcblxuICAgIGNvbnN0IG1vZHVsZTogVGVzdGluZ01vZHVsZSA9IGF3YWl0IFRlc3QuY3JlYXRlVGVzdGluZ01vZHVsZSh7XG4gICAgICBjb250cm9sbGVyczogW1VzZXJzQ29udHJvbGxlcl0sXG4gICAgICBwcm92aWRlcnM6IFtcbiAgICAgICAge1xuICAgICAgICAgIHByb3ZpZGU6IFVzZXJzU2VydmljZSxcbiAgICAgICAgICB1c2VWYWx1ZTogbW9ja1VzZXJzU2VydmljZSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHByb3ZpZGU6IFN1cGFiYXNlU3RvcmFnZVNlcnZpY2UsXG4gICAgICAgICAgdXNlVmFsdWU6IG1vY2tTdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgcHJvdmlkZTogUm9sZVV0aWxzLFxuICAgICAgICAgIHVzZVZhbHVlOiBtb2NrUm9sZVV0aWxzLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgcHJvdmlkZTogTG9nZ2VyLFxuICAgICAgICAgIHVzZVZhbHVlOiB7XG4gICAgICAgICAgICBsb2c6IGplc3QuZm4oKSxcbiAgICAgICAgICAgIGVycm9yOiBqZXN0LmZuKCksXG4gICAgICAgICAgICB3YXJuOiBqZXN0LmZuKCksXG4gICAgICAgICAgICBkZWJ1ZzogamVzdC5mbigpLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgIH0pXG4gICAgICAub3ZlcnJpZGVHdWFyZChKd3RBdXRoR3VhcmQpXG4gICAgICAudXNlVmFsdWUobW9ja0p3dEF1dGhHdWFyZClcbiAgICAgIC5vdmVycmlkZUd1YXJkKEFkbWluQXV0aEd1YXJkKVxuICAgICAgLnVzZVZhbHVlKG1vY2tBZG1pbkF1dGhHdWFyZClcbiAgICAgIC5jb21waWxlKCk7XG5cbiAgICBjb250cm9sbGVyID0gbW9kdWxlLmdldDxVc2Vyc0NvbnRyb2xsZXI+KFVzZXJzQ29udHJvbGxlcik7XG4gICAgdXNlcnNTZXJ2aWNlID0gbW9kdWxlLmdldDxVc2Vyc1NlcnZpY2U+KFVzZXJzU2VydmljZSk7XG4gICAgc3VwYWJhc2VTdG9yYWdlU2VydmljZSA9IG1vZHVsZS5nZXQ8U3VwYWJhc2VTdG9yYWdlU2VydmljZT4oU3VwYWJhc2VTdG9yYWdlU2VydmljZSk7XG4gICAgcm9sZVV0aWxzID0gbW9kdWxlLmdldDxSb2xlVXRpbHM+KFJvbGVVdGlscyk7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdmaW5kQWxsJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIGFsbCB1c2VycyBmb3IgYWRtaW4nLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBqZXN0LnNweU9uKHVzZXJzU2VydmljZSwgJ2ZpbmRBbGwnKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXNlcnMpO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZmluZEFsbChURVNUX1VTRVJfSURTLkFETUlOKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QodXNlcnNTZXJ2aWNlLmZpbmRBbGwpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja1VzZXJzKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHNlcnZpY2UgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ0RhdGFiYXNlIGVycm9yJyk7XG4gICAgICBqZXN0LnNweU9uKHVzZXJzU2VydmljZSwgJ2ZpbmRBbGwnKS5tb2NrUmVqZWN0ZWRWYWx1ZShlcnJvcik7XG5cbiAgICAgIC8vIEFjdCAmIEFzc2VydFxuICAgICAgYXdhaXQgZXhwZWN0KGNvbnRyb2xsZXIuZmluZEFsbChURVNUX1VTRVJfSURTLkFETUlOKSkucmVqZWN0cy50b1Rocm93KEh0dHBFeGNlcHRpb24pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZmluZEFsbEluY2x1ZGVJbmFjdGl2ZScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiBhbGwgdXNlcnMgaW5jbHVkaW5nIGluYWN0aXZlIGZvciBhZG1pbicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tVc2VycyA9IFtcbiAgICAgICAgVGVzdERhdGFHZW5lcmF0b3IuY3JlYXRlVXNlcih7IGlzQWN0aXZlOiB0cnVlIH0pLFxuICAgICAgICBUZXN0RGF0YUdlbmVyYXRvci5jcmVhdGVVc2VyKHsgaXNBY3RpdmU6IGZhbHNlIH0pLFxuICAgICAgXTtcblxuICAgICAgdXNlcnNTZXJ2aWNlLmZpbmRBbGxJbmNsdWRlSW5hY3RpdmUubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXJzIGFzIGFueSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZmluZEFsbEluY2x1ZGVJbmFjdGl2ZShcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5BRE1JTixcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdCh1c2Vyc1NlcnZpY2UuZmluZEFsbEluY2x1ZGVJbmFjdGl2ZSkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2NrVXNlcnMpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2VydmljZSBlcnJvcnMgd2hlbiBmZXRjaGluZyBhbGwgdXNlcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICB1c2Vyc1NlcnZpY2UuZmluZEFsbEluY2x1ZGVJbmFjdGl2ZS5tb2NrUmVqZWN0ZWRWYWx1ZShcbiAgICAgICAgbmV3IEVycm9yKCdEYXRhYmFzZSBjb25uZWN0aW9uIGZhaWxlZCcpLFxuICAgICAgKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLmZpbmRBbGxJbmNsdWRlSW5hY3RpdmUoVEVTVF9VU0VSX0lEUy5BRE1JTiksXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhIdHRwRXhjZXB0aW9uKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2ZpbmRPbmUnLCAoKSA9PiB7XG4gICAgY29uc3QgbW9ja1VzZXIgPSBUZXN0RGF0YUdlbmVyYXRvci5jcmVhdGVVc2VyKHsgaWQ6IFRFU1RfVVNFUl9JRFMuQ0xJRU5UIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhbGxvdyB1c2VyIHRvIHZpZXcgdGhlaXIgb3duIHByb2ZpbGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoZmFsc2UpO1xuICAgICAgdXNlcnNTZXJ2aWNlLmZpbmRPbmUubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXIgYXMgYW55KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5maW5kT25lKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICApO1xuXG4gICAgICBleHBlY3Qocm9sZVV0aWxzLmlzVXNlckFkbWluKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChURVNUX1VTRVJfSURTLkNMSUVOVCk7XG4gICAgICBleHBlY3QodXNlcnNTZXJ2aWNlLmZpbmRPbmUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFRFU1RfVVNFUl9JRFMuQ0xJRU5UKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja1VzZXIpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhbGxvdyBhZG1pbiB0byB2aWV3IGFueSB1c2VyIHByb2ZpbGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUodHJ1ZSk7XG4gICAgICB1c2Vyc1NlcnZpY2UuZmluZE9uZUluY2x1ZGVJbmFjdGl2ZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXNlciBhcyBhbnkpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmZpbmRPbmUoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICBURVNUX1VTRVJfSURTLkFETUlOLFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHJvbGVVdGlscy5pc1VzZXJBZG1pbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoVEVTVF9VU0VSX0lEUy5BRE1JTik7XG4gICAgICBleHBlY3QodXNlcnNTZXJ2aWNlLmZpbmRPbmVJbmNsdWRlSW5hY3RpdmUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKG1vY2tVc2VyKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdGhyb3cgRm9yYmlkZGVuRXhjZXB0aW9uIHdoZW4gbm9uLWFkbWluIHRyaWVzIHRvIHZpZXcgb3RoZXIgdXNlcicsIGFzeW5jICgpID0+IHtcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5maW5kT25lKHsgaWQ6IFRFU1RfVVNFUl9JRFMuVEhFUkFQSVNUIH0sIFRFU1RfVVNFUl9JRFMuQ0xJRU5UKSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KEZvcmJpZGRlbkV4Y2VwdGlvbik7XG5cbiAgICAgIGV4cGVjdCh1c2Vyc1NlcnZpY2UuZmluZE9uZSkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdGhyb3cgSHR0cEV4Y2VwdGlvbiB3aGVuIHVzZXIgbm90IGZvdW5kJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKGZhbHNlKTtcbiAgICAgIHVzZXJzU2VydmljZS5maW5kT25lLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIuZmluZE9uZSh7IGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCB9LCBURVNUX1VTRVJfSURTLkNMSUVOVCksXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhIdHRwRXhjZXB0aW9uKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3VwZGF0ZScsICgpID0+IHtcbiAgICBjb25zdCB1cGRhdGVEYXRhID0ge1xuICAgICAgZmlyc3ROYW1lOiAnVXBkYXRlZCcsXG4gICAgICBsYXN0TmFtZTogJ05hbWUnLFxuICAgICAgYmlvOiAnVXBkYXRlZCBiaW8nLFxuICAgIH07XG5cbiAgICBpdCgnc2hvdWxkIGFsbG93IHVzZXIgdG8gdXBkYXRlIHRoZWlyIG93biBwcm9maWxlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdXBkYXRlZFVzZXIgPSB7IC4uLlRlc3REYXRhR2VuZXJhdG9yLmNyZWF0ZVVzZXIoKSwgLi4udXBkYXRlRGF0YSB9O1xuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKGZhbHNlKTtcbiAgICAgIHVzZXJzU2VydmljZS51cGRhdGUubW9ja1Jlc29sdmVkVmFsdWUodXBkYXRlZFVzZXIgYXMgYW55KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci51cGRhdGUoXG4gICAgICAgIHsgaWQ6IFRFU1RfVVNFUl9JRFMuQ0xJRU5UIH0sXG4gICAgICAgIHVwZGF0ZURhdGEsXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHJvbGVVdGlscy5pc1VzZXJBZG1pbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoVEVTVF9VU0VSX0lEUy5DTElFTlQpO1xuICAgICAgZXhwZWN0KHVzZXJzU2VydmljZS51cGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgdXBkYXRlRGF0YSxcbiAgICAgICk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHVwZGF0ZWRVc2VyKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYWxsb3cgYWRtaW4gdG8gdXBkYXRlIGFueSB1c2VyIHdpdGggYWxsIGZpZWxkcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGFkbWluVXBkYXRlRGF0YSA9IHtcbiAgICAgICAgZmlyc3ROYW1lOiAnQWRtaW4gVXBkYXRlZCcsXG4gICAgICAgIHJvbGU6ICdtb2RlcmF0b3InLFxuICAgICAgICBpc0FjdGl2ZTogZmFsc2UsXG4gICAgICB9O1xuICAgICAgY29uc3QgdXBkYXRlZFVzZXIgPSB7XG4gICAgICAgIC4uLlRlc3REYXRhR2VuZXJhdG9yLmNyZWF0ZVVzZXIoKSxcbiAgICAgICAgLi4uYWRtaW5VcGRhdGVEYXRhLFxuICAgICAgfTtcblxuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKHRydWUpO1xuICAgICAgdXNlcnNTZXJ2aWNlLnVwZGF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh1cGRhdGVkVXNlciBhcyBhbnkpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLnVwZGF0ZShcbiAgICAgICAgeyBpZDogVEVTVF9VU0VSX0lEUy5DTElFTlQgfSxcbiAgICAgICAgYWRtaW5VcGRhdGVEYXRhLFxuICAgICAgICBURVNUX1VTRVJfSURTLkFETUlOLFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHVzZXJzU2VydmljZS51cGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgYWRtaW5VcGRhdGVEYXRhLFxuICAgICAgKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwodXBkYXRlZFVzZXIpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzYW5pdGl6ZSBub24tYWRtaW4gdXBkYXRlcyB0byBhbGxvd2VkIGZpZWxkcyBvbmx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdW5hdXRob3JpemVkRGF0YSA9IHtcbiAgICAgICAgZmlyc3ROYW1lOiAnSm9obicsXG4gICAgICAgIHJvbGU6ICdhZG1pbicsIC8vIFNob3VsZCBiZSBmaWx0ZXJlZCBvdXRcbiAgICAgICAgaXNBY3RpdmU6IGZhbHNlLCAvLyBTaG91bGQgYmUgZmlsdGVyZWQgb3V0XG4gICAgICAgIGJpbzogJ05ldyBiaW8nLFxuICAgICAgfTtcbiAgICAgIGNvbnN0IHNhbml0aXplZERhdGEgPSB7XG4gICAgICAgIGZpcnN0TmFtZTogJ0pvaG4nLFxuICAgICAgICBiaW86ICdOZXcgYmlvJyxcbiAgICAgIH07XG4gICAgICBjb25zdCB1cGRhdGVkVXNlciA9IHtcbiAgICAgICAgLi4uVGVzdERhdGFHZW5lcmF0b3IuY3JlYXRlVXNlcigpLFxuICAgICAgICAuLi5zYW5pdGl6ZWREYXRhLFxuICAgICAgfTtcblxuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKGZhbHNlKTtcbiAgICAgIHVzZXJzU2VydmljZS51cGRhdGUubW9ja1Jlc29sdmVkVmFsdWUodXBkYXRlZFVzZXIgYXMgYW55KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci51cGRhdGUoXG4gICAgICAgIHsgaWQ6IFRFU1RfVVNFUl9JRFMuQ0xJRU5UIH0sXG4gICAgICAgIHVuYXV0aG9yaXplZERhdGEsXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHVzZXJzU2VydmljZS51cGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgc2FuaXRpemVkRGF0YSxcbiAgICAgICk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHVwZGF0ZWRVc2VyKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdGhyb3cgRm9yYmlkZGVuRXhjZXB0aW9uIHdoZW4gbm9uLWFkbWluIHRyaWVzIHRvIHVwZGF0ZSBvdGhlciB1c2VyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKGZhbHNlKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLnVwZGF0ZShcbiAgICAgICAgICB7IGlkOiBURVNUX1VTRVJfSURTLlRIRVJBUElTVCB9LFxuICAgICAgICAgIHVwZGF0ZURhdGEsXG4gICAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgICksXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhGb3JiaWRkZW5FeGNlcHRpb24pO1xuXG4gICAgICBleHBlY3QodXNlcnNTZXJ2aWNlLnVwZGF0ZSkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3JlbW92ZScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGFsbG93IHVzZXIgdG8gZGVhY3RpdmF0ZSB0aGVpciBvd24gYWNjb3VudCcsIGFzeW5jICgpID0+IHtcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7XG4gICAgICB1c2Vyc1NlcnZpY2UucmVtb3ZlLm1vY2tSZXNvbHZlZFZhbHVlKHt9IGFzIGFueSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIucmVtb3ZlKFxuICAgICAgICB7IGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCB9LFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyb2xlVXRpbHMuaXNVc2VyQWRtaW4pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFRFU1RfVVNFUl9JRFMuQ0xJRU5UKTtcbiAgICAgIGV4cGVjdCh1c2Vyc1NlcnZpY2UucmVtb3ZlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChURVNUX1VTRVJfSURTLkNMSUVOVCk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHtcbiAgICAgICAgbWVzc2FnZTogJ1VzZXIgYWNjb3VudCBkZWFjdGl2YXRlZCBzdWNjZXNzZnVsbHknLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFsbG93IGFkbWluIHRvIGRlYWN0aXZhdGUgYW55IHVzZXIgYWNjb3VudCcsIGFzeW5jICgpID0+IHtcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZSh0cnVlKTtcbiAgICAgIHVzZXJzU2VydmljZS5yZW1vdmUubW9ja1Jlc29sdmVkVmFsdWUoe30gYXMgYW55KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5yZW1vdmUoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICBURVNUX1VTRVJfSURTLkFETUlOLFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHVzZXJzU2VydmljZS5yZW1vdmUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFRFU1RfVVNFUl9JRFMuQ0xJRU5UKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoe1xuICAgICAgICBtZXNzYWdlOiAnVXNlciBhY2NvdW50IGRlYWN0aXZhdGVkIHN1Y2Nlc3NmdWxseScsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdGhyb3cgRm9yYmlkZGVuRXhjZXB0aW9uIHdoZW4gbm9uLWFkbWluIHRyaWVzIHRvIGRlYWN0aXZhdGUgb3RoZXIgdXNlcicsIGFzeW5jICgpID0+IHtcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5yZW1vdmUoeyBpZDogVEVTVF9VU0VSX0lEUy5USEVSQVBJU1QgfSwgVEVTVF9VU0VSX0lEUy5DTElFTlQpLFxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coRm9yYmlkZGVuRXhjZXB0aW9uKTtcblxuICAgICAgZXhwZWN0KHVzZXJzU2VydmljZS5yZW1vdmUpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdkZWFjdGl2YXRlVXNlciAoYWRtaW4gb25seSknLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBhbGxvdyBhZG1pbiB0byBkZWFjdGl2YXRlIHVzZXIgd2l0aCByZWFzb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBkZWFjdGl2YXRpb25Cb2R5ID0geyByZWFzb246ICdQb2xpY3kgdmlvbGF0aW9uJyB9O1xuICAgICAgdXNlcnNTZXJ2aWNlLmRlYWN0aXZhdGUubW9ja1Jlc29sdmVkVmFsdWUoe30gYXMgYW55KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5kZWFjdGl2YXRlVXNlcihcbiAgICAgICAgeyBpZDogVEVTVF9VU0VSX0lEUy5DTElFTlQgfSxcbiAgICAgICAgZGVhY3RpdmF0aW9uQm9keSxcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5BRE1JTixcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdCh1c2Vyc1NlcnZpY2UuZGVhY3RpdmF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICAnUG9saWN5IHZpb2xhdGlvbicsXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQURNSU4sXG4gICAgICApO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7XG4gICAgICAgIG1lc3NhZ2U6ICdVc2VyIGFjY291bnQgZGVhY3RpdmF0ZWQgYnkgYWRtaW5pc3RyYXRvcicsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGRlYWN0aXZhdGlvbiB3aXRob3V0IHJlYXNvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGRlYWN0aXZhdGlvbkJvZHkgPSB7fTtcbiAgICAgIHVzZXJzU2VydmljZS5kZWFjdGl2YXRlLm1vY2tSZXNvbHZlZFZhbHVlKHt9IGFzIGFueSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZGVhY3RpdmF0ZVVzZXIoXG4gICAgICAgIHsgaWQ6IFRFU1RfVVNFUl9JRFMuQ0xJRU5UIH0sXG4gICAgICAgIGRlYWN0aXZhdGlvbkJvZHksXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQURNSU4sXG4gICAgICApO1xuXG4gICAgICBleHBlY3QodXNlcnNTZXJ2aWNlLmRlYWN0aXZhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgdW5kZWZpbmVkLFxuICAgICAgICBURVNUX1VTRVJfSURTLkFETUlOLFxuICAgICAgKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoe1xuICAgICAgICBtZXNzYWdlOiAnVXNlciBhY2NvdW50IGRlYWN0aXZhdGVkIGJ5IGFkbWluaXN0cmF0b3InLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzZXJ2aWNlIGVycm9ycyBkdXJpbmcgZGVhY3RpdmF0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZGVhY3RpdmF0aW9uQm9keSA9IHsgcmVhc29uOiAnVGVzdCByZWFzb24nIH07XG4gICAgICB1c2Vyc1NlcnZpY2UuZGVhY3RpdmF0ZS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ1NlcnZpY2UgZXJyb3InKSk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5kZWFjdGl2YXRlVXNlcihcbiAgICAgICAgICB7IGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCB9LFxuICAgICAgICAgIGRlYWN0aXZhdGlvbkJvZHksXG4gICAgICAgICAgVEVTVF9VU0VSX0lEUy5BRE1JTixcbiAgICAgICAgKSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KEh0dHBFeGNlcHRpb24pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgncmVhY3RpdmF0ZVVzZXIgKGFkbWluIG9ubHkpJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgYWxsb3cgYWRtaW4gdG8gcmVhY3RpdmF0ZSB1c2VyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgdXNlcnNTZXJ2aWNlLnJlYWN0aXZhdGUubW9ja1Jlc29sdmVkVmFsdWUoe30gYXMgYW55KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5yZWFjdGl2YXRlVXNlcihcbiAgICAgICAgeyBpZDogVEVTVF9VU0VSX0lEUy5DTElFTlQgfSxcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5BRE1JTixcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdCh1c2Vyc1NlcnZpY2UucmVhY3RpdmF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoe1xuICAgICAgICBtZXNzYWdlOiAnVXNlciBhY2NvdW50IHJlYWN0aXZhdGVkIHN1Y2Nlc3NmdWxseScsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHNlcnZpY2UgZXJyb3JzIGR1cmluZyByZWFjdGl2YXRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICB1c2Vyc1NlcnZpY2UucmVhY3RpdmF0ZS5tb2NrUmVqZWN0ZWRWYWx1ZShcbiAgICAgICAgbmV3IEVycm9yKCdSZWFjdGl2YXRpb24gZmFpbGVkJyksXG4gICAgICApO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIucmVhY3RpdmF0ZVVzZXIoeyBpZDogVEVTVF9VU0VSX0lEUy5DTElFTlQgfSwgVEVTVF9VU0VSX0lEUy5BRE1JTiksXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhIdHRwRXhjZXB0aW9uKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2Vycm9yIGhhbmRsaW5nJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcHJlc2VydmUgRm9yYmlkZGVuRXhjZXB0aW9uIGZyb20gc2VydmljZSBsYXllcicsIGFzeW5jICgpID0+IHtcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZSh0cnVlKTtcbiAgICAgIHVzZXJzU2VydmljZS5maW5kT25lSW5jbHVkZUluYWN0aXZlLm1vY2tSZWplY3RlZFZhbHVlKFxuICAgICAgICBuZXcgRm9yYmlkZGVuRXhjZXB0aW9uKCdBY2Nlc3MgZGVuaWVkJyksXG4gICAgICApO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIuZmluZE9uZSh7IGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCB9LCBURVNUX1VTRVJfSURTLkFETUlOKSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KEZvcmJpZGRlbkV4Y2VwdGlvbik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHdyYXAgZ2VuZXJpYyBlcnJvcnMgaW4gSHR0cEV4Y2VwdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7XG4gICAgICB1c2Vyc1NlcnZpY2UuZmluZE9uZS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ0dlbmVyaWMgZXJyb3InKSk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29udHJvbGxlci5maW5kT25lKHsgaWQ6IFRFU1RfVVNFUl9JRFMuQ0xJRU5UIH0sIFRFU1RfVVNFUl9JRFMuQ0xJRU5UKSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KEh0dHBFeGNlcHRpb24pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgcm9sZSB1dGlscyBlcnJvcnMgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ1JvbGUgY2hlY2sgZmFpbGVkJykpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIuZmluZE9uZSh7IGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCB9LCBURVNUX1VTRVJfSURTLkNMSUVOVCksXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhIdHRwRXhjZXB0aW9uKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2F1dGhvcml6YXRpb24gZWRnZSBjYXNlcycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBlbXB0eSB1cGRhdGUgZGF0YSBmb3Igbm9uLWFkbWluJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKGZhbHNlKTtcbiAgICAgIHVzZXJzU2VydmljZS51cGRhdGUubW9ja1Jlc29sdmVkVmFsdWUoXG4gICAgICAgIFRlc3REYXRhR2VuZXJhdG9yLmNyZWF0ZVVzZXIoKSBhcyBhbnksXG4gICAgICApO1xuXG4gICAgICBhd2FpdCBjb250cm9sbGVyLnVwZGF0ZSh7IGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCB9LCB7fSwgVEVTVF9VU0VSX0lEUy5DTElFTlQpO1xuXG4gICAgICBleHBlY3QodXNlcnNTZXJ2aWNlLnVwZGF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICB7fSxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBtaXhlZCBhbGxvd2VkIGFuZCBkaXNhbGxvd2VkIGZpZWxkcyBmb3Igbm9uLWFkbWluJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbWl4ZWREYXRhID0ge1xuICAgICAgICBmaXJzdE5hbWU6ICdKb2huJywgLy8gQWxsb3dlZFxuICAgICAgICBsYXN0TmFtZTogJ0RvZScsIC8vIEFsbG93ZWRcbiAgICAgICAgcm9sZTogJ2FkbWluJywgLy8gTm90IGFsbG93ZWRcbiAgICAgICAgYmlvOiAnTmV3IGJpbycsIC8vIEFsbG93ZWRcbiAgICAgICAgaXNBY3RpdmU6IGZhbHNlLCAvLyBOb3QgYWxsb3dlZFxuICAgICAgICBhdmF0YXJVcmw6ICdodHRwOi8vZXhhbXBsZS5jb20vYXZhdGFyLmpwZycsIC8vIEFsbG93ZWRcbiAgICAgIH07XG4gICAgICBjb25zdCBleHBlY3RlZFNhbml0aXplZERhdGEgPSB7XG4gICAgICAgIGZpcnN0TmFtZTogJ0pvaG4nLFxuICAgICAgICBsYXN0TmFtZTogJ0RvZScsXG4gICAgICAgIGJpbzogJ05ldyBiaW8nLFxuICAgICAgICBhdmF0YXJVcmw6ICdodHRwOi8vZXhhbXBsZS5jb20vYXZhdGFyLmpwZycsXG4gICAgICB9O1xuXG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoZmFsc2UpO1xuICAgICAgdXNlcnNTZXJ2aWNlLnVwZGF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZShcbiAgICAgICAgVGVzdERhdGFHZW5lcmF0b3IuY3JlYXRlVXNlcigpIGFzIGFueSxcbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IGNvbnRyb2xsZXIudXBkYXRlKFxuICAgICAgICB7IGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCB9LFxuICAgICAgICBtaXhlZERhdGEsXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHVzZXJzU2VydmljZS51cGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgZXhwZWN0ZWRTYW5pdGl6ZWREYXRhLFxuICAgICAgKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0ZpbGUgVXBsb2FkIEludGVncmF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIGF2YXRhciB1cGxvYWQgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgbW9ja0ZpbGVzID0ge1xuICAgICAgICBhdmF0YXI6IFttb2NrRmlsZV0sXG4gICAgICB9O1xuICAgICAgY29uc3QgdXBkYXRlRGF0YSA9IHtcbiAgICAgICAgZmlyc3ROYW1lOiAnSm9obicsXG4gICAgICAgIGxhc3ROYW1lOiAnRG9lJyxcbiAgICAgIH07XG5cbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7XG4gICAgICBzdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlLnZhbGlkYXRlRmlsZS5tb2NrUmV0dXJuVmFsdWUoeyBpc1ZhbGlkOiB0cnVlIH0pO1xuICAgICAgc3VwYWJhc2VTdG9yYWdlU2VydmljZS51cGxvYWRGaWxlLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVcGxvYWRSZXN1bHQpO1xuICAgICAgdXNlcnNTZXJ2aWNlLnVwZGF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZShcbiAgICAgICAgVGVzdERhdGFHZW5lcmF0b3IuY3JlYXRlVXNlcigpIGFzIGFueSxcbiAgICAgICk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgYXdhaXQgY29udHJvbGxlci51cGRhdGUoXG4gICAgICAgIHsgaWQ6IFRFU1RfVVNFUl9JRFMuQ0xJRU5UIH0sXG4gICAgICAgIHVwZGF0ZURhdGEsXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICBtb2NrRmlsZXMsXG4gICAgICApO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChzdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlLnZhbGlkYXRlRmlsZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgobW9ja0ZpbGUpO1xuICAgICAgZXhwZWN0KHN1cGFiYXNlU3RvcmFnZVNlcnZpY2UudXBsb2FkRmlsZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIG1vY2tGaWxlLFxuICAgICAgICAndXNlci1wcm9maWxlcycsXG4gICAgICApO1xuICAgICAgZXhwZWN0KHVzZXJzU2VydmljZS51cGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAge1xuICAgICAgICAgIC4uLnVwZGF0ZURhdGEsXG4gICAgICAgICAgYXZhdGFyVXJsOiBtb2NrVXBsb2FkUmVzdWx0LnVybCxcbiAgICAgICAgfSxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBjb3ZlciBpbWFnZSB1cGxvYWQgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgbW9ja0NvdmVyRmlsZSA9IHtcbiAgICAgICAgLi4ubW9ja0ZpbGUsXG4gICAgICAgIGZpZWxkbmFtZTogJ2NvdmVyJyxcbiAgICAgICAgb3JpZ2luYWxuYW1lOiAnY292ZXIuanBnJyxcbiAgICAgIH07XG4gICAgICBjb25zdCBtb2NrRmlsZXMgPSB7XG4gICAgICAgIGNvdmVyOiBbbW9ja0NvdmVyRmlsZV0sXG4gICAgICB9O1xuICAgICAgY29uc3QgdXBkYXRlRGF0YSA9IHtcbiAgICAgICAgZmlyc3ROYW1lOiAnSm9obicsXG4gICAgICAgIGxhc3ROYW1lOiAnRG9lJyxcbiAgICAgIH07XG5cbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7XG4gICAgICBzdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlLnZhbGlkYXRlRmlsZS5tb2NrUmV0dXJuVmFsdWUoeyBpc1ZhbGlkOiB0cnVlIH0pO1xuICAgICAgc3VwYWJhc2VTdG9yYWdlU2VydmljZS51cGxvYWRGaWxlLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVcGxvYWRSZXN1bHQpO1xuICAgICAgdXNlcnNTZXJ2aWNlLnVwZGF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZShcbiAgICAgICAgVGVzdERhdGFHZW5lcmF0b3IuY3JlYXRlVXNlcigpIGFzIGFueSxcbiAgICAgICk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgYXdhaXQgY29udHJvbGxlci51cGRhdGUoXG4gICAgICAgIHsgaWQ6IFRFU1RfVVNFUl9JRFMuQ0xJRU5UIH0sXG4gICAgICAgIHVwZGF0ZURhdGEsXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICBtb2NrRmlsZXMsXG4gICAgICApO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChzdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlLnZhbGlkYXRlRmlsZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgobW9ja0NvdmVyRmlsZSk7XG4gICAgICBleHBlY3Qoc3VwYWJhc2VTdG9yYWdlU2VydmljZS51cGxvYWRGaWxlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgbW9ja0NvdmVyRmlsZSxcbiAgICAgICAgJ3VzZXItcHJvZmlsZXMnLFxuICAgICAgKTtcbiAgICAgIGV4cGVjdCh1c2Vyc1NlcnZpY2UudXBkYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgIHtcbiAgICAgICAgICAuLi51cGRhdGVEYXRhLFxuICAgICAgICAgIGNvdmVySW1hZ2VVcmw6IG1vY2tVcGxvYWRSZXN1bHQudXJsLFxuICAgICAgICB9LFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG11bHRpcGxlIGZpbGUgdXBsb2FkcyBzaW11bHRhbmVvdXNseScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IG1vY2tDb3ZlckZpbGUgPSB7XG4gICAgICAgIC4uLm1vY2tGaWxlLFxuICAgICAgICBmaWVsZG5hbWU6ICdjb3ZlcicsXG4gICAgICAgIG9yaWdpbmFsbmFtZTogJ2NvdmVyLmpwZycsXG4gICAgICB9O1xuICAgICAgY29uc3QgbW9ja0ZpbGVzID0ge1xuICAgICAgICBhdmF0YXI6IFttb2NrRmlsZV0sXG4gICAgICAgIGNvdmVyOiBbbW9ja0NvdmVyRmlsZV0sXG4gICAgICB9O1xuICAgICAgY29uc3QgdXBkYXRlRGF0YSA9IHtcbiAgICAgICAgZmlyc3ROYW1lOiAnSm9obicsXG4gICAgICAgIGxhc3ROYW1lOiAnRG9lJyxcbiAgICAgIH07XG5cbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7XG4gICAgICBzdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlLnZhbGlkYXRlRmlsZS5tb2NrUmV0dXJuVmFsdWUoeyBpc1ZhbGlkOiB0cnVlIH0pO1xuICAgICAgc3VwYWJhc2VTdG9yYWdlU2VydmljZS51cGxvYWRGaWxlLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVcGxvYWRSZXN1bHQpO1xuICAgICAgdXNlcnNTZXJ2aWNlLnVwZGF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZShcbiAgICAgICAgVGVzdERhdGFHZW5lcmF0b3IuY3JlYXRlVXNlcigpIGFzIGFueSxcbiAgICAgICk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgYXdhaXQgY29udHJvbGxlci51cGRhdGUoXG4gICAgICAgIHsgaWQ6IFRFU1RfVVNFUl9JRFMuQ0xJRU5UIH0sXG4gICAgICAgIHVwZGF0ZURhdGEsXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgICBtb2NrRmlsZXMsXG4gICAgICApO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChzdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlLnZhbGlkYXRlRmlsZSkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDIpO1xuICAgICAgZXhwZWN0KHN1cGFiYXNlU3RvcmFnZVNlcnZpY2UudXBsb2FkRmlsZSkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDIpO1xuICAgICAgZXhwZWN0KHVzZXJzU2VydmljZS51cGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAge1xuICAgICAgICAgIC4uLnVwZGF0ZURhdGEsXG4gICAgICAgICAgYXZhdGFyVXJsOiBtb2NrVXBsb2FkUmVzdWx0LnVybCxcbiAgICAgICAgICBjb3ZlckltYWdlVXJsOiBtb2NrVXBsb2FkUmVzdWx0LnVybCxcbiAgICAgICAgfSxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBmaWxlIHZhbGlkYXRpb24gZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgbW9ja0ZpbGVzID0ge1xuICAgICAgICBhdmF0YXI6IFttb2NrRmlsZV0sXG4gICAgICB9O1xuICAgICAgY29uc3QgdXBkYXRlRGF0YSA9IHtcbiAgICAgICAgZmlyc3ROYW1lOiAnSm9obicsXG4gICAgICAgIGxhc3ROYW1lOiAnRG9lJyxcbiAgICAgIH07XG5cbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7XG4gICAgICBzdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlLnZhbGlkYXRlRmlsZS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICBpc1ZhbGlkOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6ICdGaWxlIHRvbyBsYXJnZScsXG4gICAgICB9KTtcblxuICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIudXBkYXRlKFxuICAgICAgICAgIHsgaWQ6IFRFU1RfVVNFUl9JRFMuQ0xJRU5UIH0sXG4gICAgICAgICAgdXBkYXRlRGF0YSxcbiAgICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgICBtb2NrRmlsZXMsXG4gICAgICAgICksXG4gICAgICApLnJlamVjdHMudG9UaHJvdygnQXZhdGFyIHZhbGlkYXRpb24gZmFpbGVkOiBGaWxlIHRvbyBsYXJnZScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZmlsZSB1cGxvYWQgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgbW9ja0ZpbGVzID0ge1xuICAgICAgICBhdmF0YXI6IFttb2NrRmlsZV0sXG4gICAgICB9O1xuICAgICAgY29uc3QgdXBkYXRlRGF0YSA9IHtcbiAgICAgICAgZmlyc3ROYW1lOiAnSm9obicsXG4gICAgICAgIGxhc3ROYW1lOiAnRG9lJyxcbiAgICAgIH07XG5cbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7XG4gICAgICBzdXBhYmFzZVN0b3JhZ2VTZXJ2aWNlLnZhbGlkYXRlRmlsZS5tb2NrUmV0dXJuVmFsdWUoeyBpc1ZhbGlkOiB0cnVlIH0pO1xuICAgICAgc3VwYWJhc2VTdG9yYWdlU2VydmljZS51cGxvYWRGaWxlLm1vY2tSZWplY3RlZFZhbHVlKG5ldyBFcnJvcignVXBsb2FkIGZhaWxlZCcpKTtcblxuICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIGNvbnRyb2xsZXIudXBkYXRlKFxuICAgICAgICAgIHsgaWQ6IFRFU1RfVVNFUl9JRFMuQ0xJRU5UIH0sXG4gICAgICAgICAgdXBkYXRlRGF0YSxcbiAgICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgICBtb2NrRmlsZXMsXG4gICAgICAgICksXG4gICAgICApLnJlamVjdHMudG9UaHJvdygnRmFpbGVkIHRvIHVwZGF0ZSB1c2VyOiBVcGxvYWQgZmFpbGVkJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdTZWN1cml0eSBUZXN0cycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIGlucHV0IGRhdGEgdGhyb3VnaCBab2RWYWxpZGF0aW9uUGlwZScsICgpID0+IHtcbiAgICAgIC8vIFRoaXMgdGVzdHMgdGhhdCB0aGUgY29udHJvbGxlciB1c2VzIHByb3BlciB2YWxpZGF0aW9uXG4gICAgICBjb25zdCB2YWxpZGF0aW9uUGlwZSA9IG5ldyBab2RWYWxpZGF0aW9uUGlwZSh7fSBhcyBhbnkpO1xuICAgICAgZXhwZWN0KHZhbGlkYXRpb25QaXBlKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXF1aXJlIGF1dGhlbnRpY2F0aW9uIGZvciBhbGwgZW5kcG9pbnRzJywgKCkgPT4ge1xuICAgICAgLy8gVGVzdCB0aGF0IGFsbCBlbmRwb2ludHMgaGF2ZSBKd3RBdXRoR3VhcmRcbiAgICAgIGNvbnN0IHByb3RlY3RlZE1ldGhvZHMgPSBbJ2ZpbmRBbGwnLCAnZmluZEFsbEluY2x1ZGVJbmFjdGl2ZScsICdmaW5kT25lJywgJ3VwZGF0ZScsICdyZW1vdmUnLCAnZGVhY3RpdmF0ZVVzZXInLCAncmVhY3RpdmF0ZVVzZXInXTtcbiAgICAgIFxuICAgICAgcHJvdGVjdGVkTWV0aG9kcy5mb3JFYWNoKG1ldGhvZCA9PiB7XG4gICAgICAgIGNvbnN0IGd1YXJkcyA9IFJlZmxlY3QuZ2V0TWV0YWRhdGEoJ19fZ3VhcmRzX18nLCBjb250cm9sbGVyW21ldGhvZCBhcyBrZXlvZiBVc2Vyc0NvbnRyb2xsZXJdKTtcbiAgICAgICAgZXhwZWN0KGd1YXJkcykudG9CZURlZmluZWQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBlbmZvcmNlIGFkbWluLW9ubHkgYWNjZXNzIGZvciBhZG1pbiBlbmRwb2ludHMnLCAoKSA9PiB7XG4gICAgICAvLyBUZXN0IHRoYXQgYWRtaW4gZW5kcG9pbnRzIGhhdmUgQWRtaW5BdXRoR3VhcmRcbiAgICAgIGNvbnN0IGFkbWluTWV0aG9kcyA9IFsnZmluZEFsbCcsICdmaW5kQWxsSW5jbHVkZUluYWN0aXZlJywgJ2RlYWN0aXZhdGVVc2VyJywgJ3JlYWN0aXZhdGVVc2VyJ107XG4gICAgICBcbiAgICAgIGFkbWluTWV0aG9kcy5mb3JFYWNoKG1ldGhvZCA9PiB7XG4gICAgICAgIGNvbnN0IGd1YXJkcyA9IFJlZmxlY3QuZ2V0TWV0YWRhdGEoJ19fZ3VhcmRzX18nLCBjb250cm9sbGVyW21ldGhvZCBhcyBrZXlvZiBVc2Vyc0NvbnRyb2xsZXJdKTtcbiAgICAgICAgZXhwZWN0KGd1YXJkcykudG9CZURlZmluZWQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgSldUIHRva2VuIHZhbGlkYXRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBUZXN0IHRoYXQgSldUIGd1YXJkIGlzIHByb3Blcmx5IGFwcGxpZWRcbiAgICAgIG1vY2tKd3RBdXRoR3VhcmQuY2FuQWN0aXZhdGUubW9ja1JldHVyblZhbHVlKGZhbHNlKTtcbiAgICAgIFxuICAgICAgLy8gTW9jayB0aGUgYWN0dWFsIEhUVFAgZXhjZXB0aW9uIHRoYXQgd291bGQgYmUgdGhyb3duXG4gICAgICBjb25zdCB1bmF1dGhvcml6ZWRFcnJvciA9IG5ldyBFcnJvcignVW5hdXRob3JpemVkJyk7XG4gICAgICB1c2Vyc1NlcnZpY2UuZmluZEFsbC5tb2NrUmVqZWN0ZWRWYWx1ZSh1bmF1dGhvcml6ZWRFcnJvcik7XG4gICAgICBcbiAgICAgIGF3YWl0IGV4cGVjdChjb250cm9sbGVyLmZpbmRBbGwoVEVTVF9VU0VSX0lEUy5BRE1JTikpLnJlamVjdHMudG9UaHJvdygpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgYWRtaW4gYXV0aG9yaXphdGlvbiB2YWxpZGF0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gVGVzdCB0aGF0IGFkbWluIGd1YXJkIGlzIHByb3Blcmx5IGFwcGxpZWRcbiAgICAgIG1vY2tBZG1pbkF1dGhHdWFyZC5jYW5BY3RpdmF0ZS5tb2NrUmV0dXJuVmFsdWUoZmFsc2UpO1xuICAgICAgXG4gICAgICAvLyBNb2NrIHRoZSBhY3R1YWwgSFRUUCBleGNlcHRpb24gdGhhdCB3b3VsZCBiZSB0aHJvd25cbiAgICAgIGNvbnN0IGZvcmJpZGRlbkVycm9yID0gbmV3IEVycm9yKCdGb3JiaWRkZW4nKTtcbiAgICAgIHVzZXJzU2VydmljZS5maW5kQWxsLm1vY2tSZWplY3RlZFZhbHVlKGZvcmJpZGRlbkVycm9yKTtcbiAgICAgIFxuICAgICAgYXdhaXQgZXhwZWN0KGNvbnRyb2xsZXIuZmluZEFsbChURVNUX1VTRVJfSURTLkFETUlOKSkucmVqZWN0cy50b1Rocm93KCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHByZXZlbnQgdW5hdXRob3JpemVkIGFjY2VzcyB0byBvdGhlciB1c2VyIHByb2ZpbGVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gVGVzdCB0aGF0IHVzZXJzIGNhbiBvbmx5IGFjY2VzcyB0aGVpciBvd24gcHJvZmlsZVxuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKGZhbHNlKTtcbiAgICAgIFxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb250cm9sbGVyLmZpbmRPbmUoeyBpZDogVEVTVF9VU0VSX0lEUy5USEVSQVBJU1QgfSwgVEVTVF9VU0VSX0lEUy5DTElFTlQpLFxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coRm9yYmlkZGVuRXhjZXB0aW9uKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1JvbGUtYmFzZWQgQWNjZXNzIENvbnRyb2wnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCB0ZXN0IHJvbGUtYmFzZWQgYWNjZXNzIGZvciBhZG1pbiBlbmRwb2ludHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBUZXN0IHRoYXQgYWRtaW4gZW5kcG9pbnRzIHJlcXVpcmUgYWRtaW4gcm9sZVxuICAgICAgYXdhaXQgUm9sZUJhc2VkVGVzdFV0aWxzLnRlc3RXaXRoUm9sZXMoXG4gICAgICAgIGFzeW5jICh1c2VySWQ6IHN0cmluZywgcm9sZTogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IGNvbnRyb2xsZXIuZmluZEFsbCh1c2VySWQpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBjbGllbnQ6IGZhbHNlLFxuICAgICAgICAgIHRoZXJhcGlzdDogZmFsc2UsXG4gICAgICAgICAgYWRtaW46IHRydWUsXG4gICAgICAgICAgbW9kZXJhdG9yOiBmYWxzZSxcbiAgICAgICAgfSxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIHVzZXItc3BlY2lmaWMgZnVuY3Rpb25hbGl0eScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFRlc3QgdGhhdCB1c2VycyBjYW4gYWNjZXNzIHRoZWlyIG93biBwcm9maWxlXG4gICAgICBjb25zdCB1c2VyQ29udGV4dCA9IE1vY2tCdWlsZGVyLmNyZWF0ZUF1dGhDb250ZXh0KCdjbGllbnQnKTtcbiAgICAgIFxuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKGZhbHNlKTtcbiAgICAgIHVzZXJzU2VydmljZS5maW5kT25lLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVc2VyIGFzIGFueSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZmluZE9uZSh1c2VyQ29udGV4dC51c2VySWQsIHVzZXJDb250ZXh0LnVzZXJJZCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QocmVzdWx0LmlkKS50b0JlKHVzZXJDb250ZXh0LnVzZXJJZCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRlc3QgZmllbGQgc2FuaXRpemF0aW9uIGZvciBub24tYWRtaW4gdXNlcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBUZXN0IHRoYXQgbm9uLWFkbWluIHVzZXJzIGNhbm5vdCB1cGRhdGUgc2Vuc2l0aXZlIGZpZWxkc1xuICAgICAgY29uc3Qgc2Vuc2l0aXZlRGF0YSA9IHtcbiAgICAgICAgZmlyc3ROYW1lOiAnSm9obicsXG4gICAgICAgIHJvbGU6ICdhZG1pbicsIC8vIFNob3VsZCBiZSBmaWx0ZXJlZCBvdXRcbiAgICAgICAgaXNBY3RpdmU6IGZhbHNlLCAvLyBTaG91bGQgYmUgZmlsdGVyZWQgb3V0XG4gICAgICAgIGVtYWlsVmVyaWZpZWQ6IHRydWUsIC8vIFNob3VsZCBiZSBmaWx0ZXJlZCBvdXRcbiAgICAgIH07XG4gICAgICBcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7XG4gICAgICB1c2Vyc1NlcnZpY2UudXBkYXRlLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVc2VyIGFzIGFueSk7XG4gICAgICBcbiAgICAgIGF3YWl0IGNvbnRyb2xsZXIudXBkYXRlKHsgaWQ6IFRFU1RfVVNFUl9JRFMuQ0xJRU5UIH0sIHNlbnNpdGl2ZURhdGEsIFRFU1RfVVNFUl9JRFMuQ0xJRU5UKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHVzZXJzU2VydmljZS51cGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgeyBmaXJzdE5hbWU6ICdKb2huJyB9LCAvLyBPbmx5IGFsbG93ZWQgZmllbGRzXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnSW50ZWdyYXRpb24gVGVzdHMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgY29tcGxldGUgdXNlciBwcm9maWxlIHVwZGF0ZSB3b3JrZmxvdycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IHVwZGF0ZURhdGEgPSB7XG4gICAgICAgIGZpcnN0TmFtZTogJ1VwZGF0ZWQnLFxuICAgICAgICBsYXN0TmFtZTogJ05hbWUnLFxuICAgICAgICBiaW86ICdVcGRhdGVkIGJpbycsXG4gICAgICAgIHRpbWV6b25lOiAnQW1lcmljYS9Mb3NfQW5nZWxlcycsXG4gICAgICAgIGxhbmd1YWdlOiAnZW4nLFxuICAgICAgICB0aGVtZTogJ2RhcmsnLFxuICAgICAgfTtcbiAgICAgIGNvbnN0IHVwZGF0ZWRVc2VyID0geyAuLi5tb2NrVXNlciwgLi4udXBkYXRlRGF0YSB9O1xuICAgICAgXG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoZmFsc2UpO1xuICAgICAgdXNlcnNTZXJ2aWNlLnVwZGF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh1cGRhdGVkVXNlciBhcyBhbnkpO1xuICAgICAgXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIudXBkYXRlKFxuICAgICAgICB7IGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCB9LFxuICAgICAgICB1cGRhdGVEYXRhLFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICk7XG4gICAgICBcbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZmlyc3ROYW1lKS50b0JlKCdVcGRhdGVkJyk7XG4gICAgICBleHBlY3QocmVzdWx0Lmxhc3ROYW1lKS50b0JlKCdOYW1lJyk7XG4gICAgICBleHBlY3QocmVzdWx0LmJpbykudG9CZSgnVXBkYXRlZCBiaW8nKTtcbiAgICAgIGV4cGVjdChyZXN1bHQudGltZXpvbmUpLnRvQmUoJ0FtZXJpY2EvTG9zX0FuZ2VsZXMnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbXBsZXRlIGFkbWluIHVzZXIgbWFuYWdlbWVudCB3b3JrZmxvdycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZSh0cnVlKTtcbiAgICAgIHVzZXJzU2VydmljZS5maW5kQWxsLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVc2VycyBhcyBhbnkpO1xuICAgICAgdXNlcnNTZXJ2aWNlLmZpbmRBbGxJbmNsdWRlSW5hY3RpdmUubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXJzIGFzIGFueSk7XG4gICAgICB1c2Vyc1NlcnZpY2UuZmluZE9uZUluY2x1ZGVJbmFjdGl2ZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXNlciBhcyBhbnkpO1xuICAgICAgXG4gICAgICAvLyBBY3QgLSBHZXQgYWxsIHVzZXJzXG4gICAgICBjb25zdCBhbGxVc2VycyA9IGF3YWl0IGNvbnRyb2xsZXIuZmluZEFsbChURVNUX1VTRVJfSURTLkFETUlOKTtcbiAgICAgIFxuICAgICAgLy8gQWN0IC0gR2V0IGFsbCB1c2VycyBpbmNsdWRpbmcgaW5hY3RpdmVcbiAgICAgIGNvbnN0IGFsbFVzZXJzSW5jbHVkZUluYWN0aXZlID0gYXdhaXQgY29udHJvbGxlci5maW5kQWxsSW5jbHVkZUluYWN0aXZlKFRFU1RfVVNFUl9JRFMuQURNSU4pO1xuICAgICAgXG4gICAgICAvLyBBY3QgLSBWaWV3IHNwZWNpZmljIHVzZXJcbiAgICAgIGNvbnN0IHNwZWNpZmljVXNlciA9IGF3YWl0IGNvbnRyb2xsZXIuZmluZE9uZSh7IGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCB9LCBURVNUX1VTRVJfSURTLkFETUlOKTtcbiAgICAgIFxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QoYWxsVXNlcnMpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoYWxsVXNlcnMpLnRvSGF2ZUxlbmd0aCgyKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGFsbFVzZXJzSW5jbHVkZUluYWN0aXZlKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGFsbFVzZXJzSW5jbHVkZUluYWN0aXZlKS50b0hhdmVMZW5ndGgoMik7XG4gICAgICBcbiAgICAgIGV4cGVjdChzcGVjaWZpY1VzZXIpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3Qoc3BlY2lmaWNVc2VyLmlkKS50b0JlKFRFU1RfVVNFUl9JRFMuQ0xJRU5UKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbXBsZXRlIHVzZXIgZGVhY3RpdmF0aW9uIHdvcmtmbG93JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgdXNlcnNTZXJ2aWNlLmRlYWN0aXZhdGUubW9ja1Jlc29sdmVkVmFsdWUoe30gYXMgYW55KTtcbiAgICAgIFxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLmRlYWN0aXZhdGVVc2VyKFxuICAgICAgICB7IGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCB9LFxuICAgICAgICB7IHJlYXNvbjogJ1BvbGljeSB2aW9sYXRpb24nIH0sXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQURNSU4sXG4gICAgICApO1xuICAgICAgXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QocmVzdWx0Lm1lc3NhZ2UpLnRvQmUoJ1VzZXIgYWNjb3VudCBkZWFjdGl2YXRlZCBieSBhZG1pbmlzdHJhdG9yJyk7XG4gICAgICBleHBlY3QodXNlcnNTZXJ2aWNlLmRlYWN0aXZhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgICAgJ1BvbGljeSB2aW9sYXRpb24nLFxuICAgICAgICBURVNUX1VTRVJfSURTLkFETUlOLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbXBsZXRlIHVzZXIgcmVhY3RpdmF0aW9uIHdvcmtmbG93JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgdXNlcnNTZXJ2aWNlLnJlYWN0aXZhdGUubW9ja1Jlc29sdmVkVmFsdWUoe30gYXMgYW55KTtcbiAgICAgIFxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLnJlYWN0aXZhdGVVc2VyKFxuICAgICAgICB7IGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCB9LFxuICAgICAgICBURVNUX1VTRVJfSURTLkFETUlOLFxuICAgICAgKTtcbiAgICAgIFxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5tZXNzYWdlKS50b0JlKCdVc2VyIGFjY291bnQgcmVhY3RpdmF0ZWQgc3VjY2Vzc2Z1bGx5Jyk7XG4gICAgICBleHBlY3QodXNlcnNTZXJ2aWNlLnJlYWN0aXZhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFRFU1RfVVNFUl9JRFMuQ0xJRU5UKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0RhdGEgVmFsaWRhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIHVzZXIgdXBkYXRlIGRhdGEgc3RydWN0dXJlJywgKCkgPT4ge1xuICAgICAgLy8gVGVzdCB0aGF0IHdlJ3JlIHVzaW5nIHRoZSBjb3JyZWN0IERUTyBzdHJ1Y3R1cmVcbiAgICAgIGNvbnN0IHZhbGlkVXBkYXRlRGF0YSA9IHtcbiAgICAgICAgZmlyc3ROYW1lOiAnSm9obicsXG4gICAgICAgIGxhc3ROYW1lOiAnRG9lJyxcbiAgICAgICAgYmlvOiAnVXNlciBiaW8nLFxuICAgICAgICBhdmF0YXJVcmw6ICdodHRwczovL2V4YW1wbGUuY29tL2F2YXRhci5qcGcnLFxuICAgICAgICBjb3ZlckltYWdlVXJsOiAnaHR0cHM6Ly9leGFtcGxlLmNvbS9jb3Zlci5qcGcnLFxuICAgICAgICBwaG9uZU51bWJlcjogJysxMjM0NTY3ODkwJyxcbiAgICAgICAgdGltZXpvbmU6ICdBbWVyaWNhL05ld19Zb3JrJyxcbiAgICAgICAgbGFuZ3VhZ2U6ICdlbicsXG4gICAgICAgIHRoZW1lOiAnbGlnaHQnLFxuICAgICAgfTtcbiAgICAgIFxuICAgICAgLy8gVmVyaWZ5IGFsbCBmaWVsZHMgYXJlIGRlZmluZWRcbiAgICAgIGV4cGVjdCh2YWxpZFVwZGF0ZURhdGEuZmlyc3ROYW1lKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHZhbGlkVXBkYXRlRGF0YS5sYXN0TmFtZSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdCh2YWxpZFVwZGF0ZURhdGEuYmlvKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHZhbGlkVXBkYXRlRGF0YS5hdmF0YXJVcmwpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QodmFsaWRVcGRhdGVEYXRhLmNvdmVySW1hZ2VVcmwpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QodmFsaWRVcGRhdGVEYXRhLnBob25lTnVtYmVyKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHZhbGlkVXBkYXRlRGF0YS50aW1lem9uZSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdCh2YWxpZFVwZGF0ZURhdGEubGFuZ3VhZ2UpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QodmFsaWRVcGRhdGVEYXRhLnRoZW1lKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBkZWFjdGl2YXRpb24gZGF0YSBzdHJ1Y3R1cmUnLCAoKSA9PiB7XG4gICAgICAvLyBUZXN0IHRoYXQgd2UncmUgdXNpbmcgdGhlIGNvcnJlY3QgRFRPIHN0cnVjdHVyZVxuICAgICAgY29uc3QgdmFsaWREZWFjdGl2YXRpb25EYXRhID0ge1xuICAgICAgICByZWFzb246ICdQb2xpY3kgdmlvbGF0aW9uJyxcbiAgICAgIH07XG4gICAgICBcbiAgICAgIC8vIFZlcmlmeSBhbGwgZmllbGRzIGFyZSBkZWZpbmVkXG4gICAgICBleHBlY3QodmFsaWREZWFjdGl2YXRpb25EYXRhLnJlYXNvbikudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgdXNlciBJRCBwYXJhbWV0ZXIgc3RydWN0dXJlJywgKCkgPT4ge1xuICAgICAgLy8gVGVzdCB0aGF0IHdlJ3JlIHVzaW5nIHRoZSBjb3JyZWN0IHBhcmFtZXRlciBzdHJ1Y3R1cmVcbiAgICAgIGNvbnN0IHZhbGlkVXNlcklkUGFyYW0gPSB7XG4gICAgICAgIGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCxcbiAgICAgIH07XG4gICAgICBcbiAgICAgIC8vIFZlcmlmeSBhbGwgZmllbGRzIGFyZSBkZWZpbmVkXG4gICAgICBleHBlY3QodmFsaWRVc2VySWRQYXJhbS5pZCkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1Jlc3BvbnNlIEZvcm1hdCBWYWxpZGF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvcnJlY3RseSBmb3JtYXR0ZWQgdXNlciBsaXN0IHJlc3BvbnNlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgcm9sZVV0aWxzLmlzVXNlckFkbWluLm1vY2tSZXNvbHZlZFZhbHVlKHRydWUpO1xuICAgICAgdXNlcnNTZXJ2aWNlLmZpbmRBbGwubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXJzIGFzIGFueSk7XG4gICAgICBcbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5maW5kQWxsKFRFU1RfVVNFUl9JRFMuQURNSU4pO1xuICAgICAgXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVJbnN0YW5jZU9mKEFycmF5KTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZUxlbmd0aCgyKTtcbiAgICAgIFxuICAgICAgY29uc3QgdXNlciA9IHJlc3VsdFswXTtcbiAgICAgIGV4cGVjdCh1c2VyKS50b0hhdmVQcm9wZXJ0eSgnaWQnKTtcbiAgICAgIGV4cGVjdCh1c2VyKS50b0hhdmVQcm9wZXJ0eSgnZW1haWwnKTtcbiAgICAgIGV4cGVjdCh1c2VyKS50b0hhdmVQcm9wZXJ0eSgnZmlyc3ROYW1lJyk7XG4gICAgICBleHBlY3QodXNlcikudG9IYXZlUHJvcGVydHkoJ2xhc3ROYW1lJyk7XG4gICAgICBleHBlY3QodXNlcikudG9IYXZlUHJvcGVydHkoJ3JvbGUnKTtcbiAgICAgIGV4cGVjdCh1c2VyKS50b0hhdmVQcm9wZXJ0eSgnY3JlYXRlZEF0Jyk7XG4gICAgICBleHBlY3QodXNlcikudG9IYXZlUHJvcGVydHkoJ2lzQWN0aXZlJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBjb3JyZWN0bHkgZm9ybWF0dGVkIHVzZXIgcHJvZmlsZSByZXNwb25zZScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7XG4gICAgICB1c2Vyc1NlcnZpY2UuZmluZE9uZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXNlciBhcyBhbnkpO1xuICAgICAgXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIuZmluZE9uZSh7IGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCB9LCBURVNUX1VTRVJfSURTLkNMSUVOVCk7XG4gICAgICBcbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ2lkJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgnZW1haWwnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdmaXJzdE5hbWUnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdsYXN0TmFtZScpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ3JvbGUnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdiaW8nKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdhdmF0YXJVcmwnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdjb3ZlckltYWdlVXJsJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgncGhvbmVOdW1iZXInKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCd0aW1lem9uZScpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ2xhbmd1YWdlJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgndGhlbWUnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdjcmVhdGVkQXQnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCd1cGRhdGVkQXQnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvcnJlY3RseSBmb3JtYXR0ZWQgdXBkYXRlIHJlc3BvbnNlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgdXBkYXRlRGF0YSA9IHtcbiAgICAgICAgZmlyc3ROYW1lOiAnVXBkYXRlZCcsXG4gICAgICAgIGxhc3ROYW1lOiAnTmFtZScsXG4gICAgICB9O1xuICAgICAgY29uc3QgdXBkYXRlZFVzZXIgPSB7IC4uLm1vY2tVc2VyLCAuLi51cGRhdGVEYXRhIH07XG4gICAgICBcbiAgICAgIHJvbGVVdGlscy5pc1VzZXJBZG1pbi5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7XG4gICAgICB1c2Vyc1NlcnZpY2UudXBkYXRlLm1vY2tSZXNvbHZlZFZhbHVlKHVwZGF0ZWRVc2VyIGFzIGFueSk7XG4gICAgICBcbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci51cGRhdGUoXG4gICAgICAgIHsgaWQ6IFRFU1RfVVNFUl9JRFMuQ0xJRU5UIH0sXG4gICAgICAgIHVwZGF0ZURhdGEsXG4gICAgICAgIFRFU1RfVVNFUl9JRFMuQ0xJRU5ULFxuICAgICAgKTtcbiAgICAgIFxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgnaWQnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdlbWFpbCcpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ2ZpcnN0TmFtZScpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ2xhc3ROYW1lJyk7XG4gICAgICBleHBlY3QocmVzdWx0LmZpcnN0TmFtZSkudG9CZSgnVXBkYXRlZCcpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5sYXN0TmFtZSkudG9CZSgnTmFtZScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gY29ycmVjdGx5IGZvcm1hdHRlZCBkZWFjdGl2YXRpb24gcmVzcG9uc2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICByb2xlVXRpbHMuaXNVc2VyQWRtaW4ubW9ja1Jlc29sdmVkVmFsdWUoZmFsc2UpO1xuICAgICAgdXNlcnNTZXJ2aWNlLnJlbW92ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7fSBhcyBhbnkpO1xuICAgICAgXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbnRyb2xsZXIucmVtb3ZlKHsgaWQ6IFRFU1RfVVNFUl9JRFMuQ0xJRU5UIH0sIFRFU1RfVVNFUl9JRFMuQ0xJRU5UKTtcbiAgICAgIFxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgnbWVzc2FnZScpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5tZXNzYWdlKS50b0JlKCdVc2VyIGFjY291bnQgZGVhY3RpdmF0ZWQgc3VjY2Vzc2Z1bGx5Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBjb3JyZWN0bHkgZm9ybWF0dGVkIGFkbWluIGRlYWN0aXZhdGlvbiByZXNwb25zZScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIHVzZXJzU2VydmljZS5kZWFjdGl2YXRlLm1vY2tSZXNvbHZlZFZhbHVlKHt9IGFzIGFueSk7XG4gICAgICBcbiAgICAgIC8vIEFjdFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29udHJvbGxlci5kZWFjdGl2YXRlVXNlcihcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5DTElFTlQsXG4gICAgICAgIHsgcmVhc29uOiAnUG9saWN5IHZpb2xhdGlvbicgfSxcbiAgICAgICAgVEVTVF9VU0VSX0lEUy5BRE1JTixcbiAgICAgICk7XG4gICAgICBcbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ21lc3NhZ2UnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQubWVzc2FnZSkudG9CZSgnVXNlciBhY2NvdW50IGRlYWN0aXZhdGVkIGJ5IGFkbWluaXN0cmF0b3InKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvcnJlY3RseSBmb3JtYXR0ZWQgcmVhY3RpdmF0aW9uIHJlc3BvbnNlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgdXNlcnNTZXJ2aWNlLnJlYWN0aXZhdGUubW9ja1Jlc29sdmVkVmFsdWUoe30gYXMgYW55KTtcbiAgICAgIFxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb250cm9sbGVyLnJlYWN0aXZhdGVVc2VyKFxuICAgICAgICB7IGlkOiBURVNUX1VTRVJfSURTLkNMSUVOVCB9LFxuICAgICAgICBURVNUX1VTRVJfSURTLkFETUlOLFxuICAgICAgKTtcbiAgICAgIFxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgnbWVzc2FnZScpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5tZXNzYWdlKS50b0JlKCdVc2VyIGFjY291bnQgcmVhY3RpdmF0ZWQgc3VjY2Vzc2Z1bGx5Jyk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwidmVyc2lvbiI6M30=