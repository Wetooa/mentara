{"file":"/home/wetooa/Documents/code/projects/mentara/mentara-api/src/pre-assessment/analysis/therapeutic-recommendations.service.ts","mappings":"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","names":[],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/pre-assessment/analysis/therapeutic-recommendations.service.ts"],"sourcesContent":["import { Injectable, Logger } from '@nestjs/common';\nimport {\n  ClinicalInsight,\n  ClinicalProfile,\n  TreatmentRecommendation,\n} from './clinical-insights.service';\n\nexport interface TherapistMatchCriteria {\n  requiredSpecializations: string[];\n  preferredApproaches: string[];\n  experienceLevel: 'any' | 'intermediate' | 'senior' | 'expert';\n  urgencyLevel: 'immediate' | 'high' | 'moderate' | 'routine';\n  treatmentModality: 'individual' | 'group' | 'family' | 'couples' | 'any';\n  sessionFrequency: 'multiple_weekly' | 'weekly' | 'biweekly' | 'monthly';\n  estimatedDuration: string;\n  specialRequirements: string[];\n}\n\nexport interface InterventionRecommendation {\n  type:\n    | 'therapy'\n    | 'psychiatric_eval'\n    | 'crisis_intervention'\n    | 'support_group'\n    | 'self_help';\n  priority: number;\n  urgency: 'immediate' | 'high' | 'moderate' | 'routine';\n  description: string;\n  provider: string;\n  duration: string;\n  frequency: string;\n  goals: string[];\n}\n\nexport interface PersonalizedTreatmentPlan {\n  overallStrategy: string;\n  phaseBasedPlan: TreatmentPhase[];\n  therapistCriteria: TherapistMatchCriteria;\n  interventionRecommendations: InterventionRecommendation[];\n  selfCareRecommendations: SelfCareRecommendation[];\n  monitoringPlan: MonitoringPlan;\n  contingencyPlan: ContingencyPlan;\n  successMetrics: SuccessMetric[];\n}\n\nexport interface TreatmentPhase {\n  phase: number;\n  name: string;\n  duration: string;\n  goals: string[];\n  approaches: string[];\n  focus: string[];\n  successCriteria: string[];\n}\n\nexport interface SelfCareRecommendation {\n  category: 'lifestyle' | 'mindfulness' | 'social' | 'physical' | 'emotional';\n  priority: 'high' | 'medium' | 'low';\n  recommendation: string;\n  frequency: string;\n  rationale: string;\n}\n\nexport interface MonitoringPlan {\n  assessmentSchedule: string;\n  keyMetrics: string[];\n  warningSigns: string[];\n  reviewPoints: string[];\n}\n\nexport interface ContingencyPlan {\n  crisisContacts: string[];\n  emergencySteps: string[];\n  escalationTriggers: string[];\n  safetyResources: string[];\n}\n\nexport interface SuccessMetric {\n  metric: string;\n  targetImprovement: string;\n  timeframe: string;\n  measurementMethod: string;\n}\n\n@Injectable()\nexport class TherapeuticRecommendationsService {\n  private readonly logger = new Logger(TherapeuticRecommendationsService.name);\n\n  /**\n   * Generate comprehensive personalized treatment plan\n   */\n  async generatePersonalizedTreatmentPlan(\n    clinicalProfile: ClinicalProfile,\n  ): Promise<PersonalizedTreatmentPlan> {\n    this.logger.log('Generating personalized treatment plan');\n\n    try {\n      const overallStrategy = this.determineOverallStrategy(clinicalProfile);\n      const phaseBasedPlan = this.createPhaseBasedPlan(clinicalProfile);\n      const therapistCriteria = this.generateTherapistCriteria(clinicalProfile);\n      const interventionRecommendations =\n        this.generateInterventionRecommendations(clinicalProfile);\n      const selfCareRecommendations =\n        this.generateSelfCareRecommendations(clinicalProfile);\n      const monitoringPlan = this.createMonitoringPlan(clinicalProfile);\n      const contingencyPlan = this.createContingencyPlan(clinicalProfile);\n      const successMetrics = this.defineSuccessMetrics(clinicalProfile);\n\n      return {\n        overallStrategy,\n        phaseBasedPlan,\n        therapistCriteria,\n        interventionRecommendations,\n        selfCareRecommendations,\n        monitoringPlan,\n        contingencyPlan,\n        successMetrics,\n      };\n    } catch (error) {\n      this.logger.error('Error generating treatment plan:', error);\n      throw new Error('Failed to generate personalized treatment plan');\n    }\n  }\n\n  /**\n   * Determine overall treatment strategy based on clinical profile\n   */\n  private determineOverallStrategy(clinicalProfile: ClinicalProfile): string {\n    const { primaryConditions, riskFactors, overallRiskLevel } =\n      clinicalProfile;\n\n    if (overallRiskLevel === 'critical') {\n      return 'Crisis stabilization followed by intensive therapeutic intervention with coordinated care team approach';\n    }\n\n    if (overallRiskLevel === 'high') {\n      return 'Immediate therapeutic intervention with frequent monitoring and structured treatment approach';\n    }\n\n    if (primaryConditions.length > 2) {\n      return 'Integrated treatment approach addressing multiple conditions with prioritized intervention sequence';\n    }\n\n    if (primaryConditions.length === 1) {\n      const condition = primaryConditions[0];\n      return `Focused ${condition.condition.toLowerCase()} treatment using evidence-based approaches with gradual skill building`;\n    }\n\n    return 'Preventive intervention with skill-building and monitoring approach';\n  }\n\n  /**\n   * Create phase-based treatment plan\n   */\n  private createPhaseBasedPlan(\n    clinicalProfile: ClinicalProfile,\n  ): TreatmentPhase[] {\n    const phases: TreatmentPhase[] = [];\n    const { primaryConditions, overallRiskLevel, riskFactors } =\n      clinicalProfile;\n\n    // Phase 1: Stabilization (if needed)\n    if (overallRiskLevel === 'critical' || overallRiskLevel === 'high') {\n      phases.push({\n        phase: 1,\n        name: 'Crisis Stabilization and Safety',\n        duration: '2-4 weeks',\n        goals: [\n          'Ensure immediate safety',\n          'Stabilize acute symptoms',\n          'Establish therapeutic rapport',\n          'Create safety plan',\n        ],\n        approaches: [\n          'Crisis Intervention',\n          'Safety Planning',\n          'Supportive Therapy',\n        ],\n        focus: ['Safety', 'Symptom stabilization', 'Crisis management'],\n        successCriteria: [\n          'No safety concerns',\n          'Reduced acute distress',\n          'Engagement in treatment',\n          'Functioning safety plan',\n        ],\n      });\n    }\n\n    // Phase 2: Core Treatment\n    const corePhase = phases.length + 1;\n    const primaryCondition = primaryConditions[0];\n\n    phases.push({\n      phase: corePhase,\n      name: `Core ${primaryCondition?.condition || 'Therapeutic'} Treatment`,\n      duration: this.estimateCoreTreatmentDuration(primaryCondition),\n      goals: this.getCorePhaseGoals(primaryCondition),\n      approaches: this.getCorePhaseApproaches(primaryCondition),\n      focus: this.getCorePhaseAreas(primaryCondition),\n      successCriteria: this.getCorePhaseSuccessCriteria(primaryCondition),\n    });\n\n    // Phase 3: Integration and Maintenance\n    phases.push({\n      phase: phases.length + 1,\n      name: 'Integration and Relapse Prevention',\n      duration: '4-8 weeks',\n      goals: [\n        'Consolidate therapeutic gains',\n        'Develop long-term coping strategies',\n        'Plan for maintenance and follow-up',\n        'Address remaining secondary issues',\n      ],\n      approaches: [\n        'Relapse Prevention',\n        'Maintenance Therapy',\n        'Skill Consolidation',\n      ],\n      focus: [\n        'Skill integration',\n        'Long-term planning',\n        'Maintenance strategies',\n      ],\n      successCriteria: [\n        'Sustained symptom improvement',\n        'Independent coping skills',\n        'Functional improvement maintained',\n        'Comprehensive relapse prevention plan',\n      ],\n    });\n\n    return phases;\n  }\n\n  /**\n   * Generate specific therapist matching criteria\n   */\n  private generateTherapistCriteria(\n    clinicalProfile: ClinicalProfile,\n  ): TherapistMatchCriteria {\n    const { primaryConditions, overallRiskLevel, treatmentRecommendations } =\n      clinicalProfile;\n\n    const requiredSpecializations =\n      this.getRequiredSpecializations(primaryConditions);\n    const preferredApproaches = this.getPreferredApproaches(primaryConditions);\n    const experienceLevel = this.determineRequiredExperienceLevel(\n      overallRiskLevel,\n      primaryConditions,\n    );\n    const urgencyLevel = this.mapRiskToUrgency(overallRiskLevel);\n    const sessionFrequency = this.determineSessionFrequency(\n      overallRiskLevel,\n      primaryConditions,\n    );\n    const specialRequirements = this.getSpecialRequirements(primaryConditions);\n\n    return {\n      requiredSpecializations,\n      preferredApproaches,\n      experienceLevel,\n      urgencyLevel,\n      treatmentModality: 'individual', // Default to individual therapy\n      sessionFrequency,\n      estimatedDuration:\n        this.estimateOverallTreatmentDuration(primaryConditions),\n      specialRequirements,\n    };\n  }\n\n  /**\n   * Get required specializations based on conditions\n   */\n  private getRequiredSpecializations(\n    primaryConditions: ClinicalInsight[],\n  ): string[] {\n    const specializations = new Set<string>();\n\n    primaryConditions.forEach((condition) => {\n      switch (condition.condition) {\n        case 'Depression':\n          specializations.add('Depression Treatment');\n          specializations.add('Mood Disorders');\n          break;\n        case 'Anxiety':\n          specializations.add('Anxiety Disorders');\n          specializations.add('Stress Management');\n          break;\n        case 'Post-traumatic stress disorder (PTSD)':\n          specializations.add('Trauma Therapy');\n          specializations.add('PTSD Treatment');\n          specializations.add('EMDR');\n          break;\n        case 'Bipolar disorder (BD)':\n          specializations.add('Bipolar Disorder');\n          specializations.add('Mood Disorders');\n          break;\n        case 'Obsessive compulsive disorder (OCD)':\n          specializations.add('OCD Treatment');\n          specializations.add('Anxiety Disorders');\n          break;\n        case 'ADD / ADHD':\n          specializations.add('ADHD Treatment');\n          specializations.add('Attention Disorders');\n          break;\n        default:\n          specializations.add('General Clinical Psychology');\n      }\n    });\n\n    return Array.from(specializations);\n  }\n\n  /**\n   * Get preferred therapeutic approaches\n   */\n  private getPreferredApproaches(\n    primaryConditions: ClinicalInsight[],\n  ): string[] {\n    const approaches = new Set<string>();\n\n    primaryConditions.forEach((condition) => {\n      switch (condition.condition) {\n        case 'Depression':\n          approaches.add('Cognitive Behavioral Therapy (CBT)');\n          approaches.add('Interpersonal Therapy (IPT)');\n          approaches.add('Mindfulness-Based Cognitive Therapy (MBCT)');\n          break;\n        case 'Anxiety':\n          approaches.add('Cognitive Behavioral Therapy (CBT)');\n          approaches.add('Acceptance and Commitment Therapy (ACT)');\n          approaches.add('Exposure Therapy');\n          break;\n        case 'Post-traumatic stress disorder (PTSD)':\n          approaches.add(\n            'Eye Movement Desensitization and Reprocessing (EMDR)',\n          );\n          approaches.add('Cognitive Processing Therapy (CPT)');\n          approaches.add('Prolonged Exposure Therapy (PE)');\n          break;\n        case 'Bipolar disorder (BD)':\n          approaches.add('Dialectical Behavior Therapy (DBT)');\n          approaches.add('Cognitive Behavioral Therapy (CBT)');\n          approaches.add('Psychoeducation');\n          break;\n        default:\n          approaches.add('Cognitive Behavioral Therapy (CBT)');\n          approaches.add('Psychodynamic Therapy');\n      }\n    });\n\n    return Array.from(approaches);\n  }\n\n  /**\n   * Determine required therapist experience level\n   */\n  private determineRequiredExperienceLevel(\n    riskLevel: string,\n    primaryConditions: ClinicalInsight[],\n  ): 'any' | 'intermediate' | 'senior' | 'expert' {\n    if (riskLevel === 'critical') return 'expert';\n    if (riskLevel === 'high') return 'senior';\n\n    const complexConditions = [\n      'Post-traumatic stress disorder (PTSD)',\n      'Bipolar disorder (BD)',\n    ];\n    const hasComplexCondition = primaryConditions.some((c) =>\n      complexConditions.includes(c.condition),\n    );\n\n    if (hasComplexCondition) return 'senior';\n    if (primaryConditions.some((c) => c.clinicalLevel === 'severe'))\n      return 'intermediate';\n\n    return 'any';\n  }\n\n  /**\n   * Map risk level to urgency\n   */\n  private mapRiskToUrgency(\n    riskLevel: string,\n  ): 'immediate' | 'high' | 'moderate' | 'routine' {\n    const mapping = {\n      critical: 'immediate' as const,\n      high: 'high' as const,\n      moderate: 'moderate' as const,\n      low: 'routine' as const,\n    };\n    return mapping[riskLevel] || 'routine';\n  }\n\n  /**\n   * Determine recommended session frequency\n   */\n  private determineSessionFrequency(\n    riskLevel: string,\n    primaryConditions: ClinicalInsight[],\n  ): 'multiple_weekly' | 'weekly' | 'biweekly' | 'monthly' {\n    if (riskLevel === 'critical') return 'multiple_weekly';\n    if (riskLevel === 'high') return 'weekly';\n    if (primaryConditions.some((c) => c.clinicalLevel === 'severe'))\n      return 'weekly';\n    if (primaryConditions.some((c) => c.clinicalLevel === 'moderate'))\n      return 'weekly';\n\n    return 'biweekly';\n  }\n\n  /**\n   * Generate intervention recommendations\n   */\n  private generateInterventionRecommendations(\n    clinicalProfile: ClinicalProfile,\n  ): InterventionRecommendation[] {\n    const recommendations: InterventionRecommendation[] = [];\n    const { primaryConditions, riskFactors, overallRiskLevel } =\n      clinicalProfile;\n\n    // Crisis intervention if needed\n    if (overallRiskLevel === 'critical') {\n      recommendations.push({\n        type: 'crisis_intervention',\n        priority: 1,\n        urgency: 'immediate',\n        description: 'Immediate crisis intervention and safety assessment',\n        provider: 'Crisis intervention specialist or emergency services',\n        duration: 'Immediate',\n        frequency: 'As needed',\n        goals: ['Ensure safety', 'Stabilize crisis', 'Connect to ongoing care'],\n      });\n    }\n\n    // Primary therapy recommendation\n    const primaryCondition = primaryConditions[0];\n    if (primaryCondition) {\n      recommendations.push({\n        type: 'therapy',\n        priority: 2,\n        urgency: this.mapRiskToUrgency(primaryCondition.riskLevel),\n        description: `Individual therapy for ${primaryCondition.condition.toLowerCase()}`,\n        provider: 'Licensed mental health professional',\n        duration: this.estimateCoreTreatmentDuration(primaryCondition),\n        frequency: this.determineSessionFrequency(\n          overallRiskLevel,\n          primaryConditions,\n        ),\n        goals: primaryCondition.therapeuticFocus,\n      });\n    }\n\n    // Psychiatric evaluation if indicated\n    if (\n      this.requiresPsychiatricEvaluation(primaryConditions, overallRiskLevel)\n    ) {\n      recommendations.push({\n        type: 'psychiatric_eval',\n        priority: 3,\n        urgency: overallRiskLevel === 'critical' ? 'immediate' : 'high',\n        description: 'Psychiatric evaluation for medication management',\n        provider: 'Psychiatrist',\n        duration: '1-2 sessions',\n        frequency: 'Initial evaluation, then as needed',\n        goals: [\n          'Medication assessment',\n          'Symptom management',\n          'Treatment coordination',\n        ],\n      });\n    }\n\n    return recommendations.sort((a, b) => a.priority - b.priority);\n  }\n\n  /**\n   * Generate self-care recommendations\n   */\n  private generateSelfCareRecommendations(\n    clinicalProfile: ClinicalProfile,\n  ): SelfCareRecommendation[] {\n    const recommendations: SelfCareRecommendation[] = [];\n    const { primaryConditions } = clinicalProfile;\n\n    // Universal recommendations\n    recommendations.push(\n      {\n        category: 'lifestyle',\n        priority: 'high',\n        recommendation: 'Maintain regular sleep schedule (7-9 hours per night)',\n        frequency: 'Daily',\n        rationale:\n          'Sleep regulation is crucial for mental health and symptom management',\n      },\n      {\n        category: 'physical',\n        priority: 'high',\n        recommendation:\n          'Regular physical exercise (30 minutes, 3-5 times per week)',\n        frequency: '3-5 times per week',\n        rationale:\n          'Exercise has proven benefits for mood regulation and anxiety reduction',\n      },\n      {\n        category: 'mindfulness',\n        priority: 'medium',\n        recommendation: 'Daily mindfulness or meditation practice',\n        frequency: 'Daily (10-20 minutes)',\n        rationale:\n          'Mindfulness improves emotional regulation and reduces stress',\n      },\n    );\n\n    // Condition-specific recommendations\n    primaryConditions.forEach((condition) => {\n      const conditionRecs = this.getConditionSpecificSelfCare(\n        condition.condition,\n      );\n      recommendations.push(...conditionRecs);\n    });\n\n    return recommendations;\n  }\n\n  /**\n   * Get condition-specific self-care recommendations\n   */\n  private getConditionSpecificSelfCare(\n    condition: string,\n  ): SelfCareRecommendation[] {\n    const recommendations: Record<string, SelfCareRecommendation[]> = {\n      Depression: [\n        {\n          category: 'social',\n          priority: 'high',\n          recommendation:\n            'Maintain social connections and engage in meaningful activities',\n          frequency: 'Weekly',\n          rationale:\n            'Social support and behavioral activation are key for depression recovery',\n        },\n        {\n          category: 'lifestyle',\n          priority: 'medium',\n          recommendation:\n            'Exposure to natural light, especially in the morning',\n          frequency: 'Daily',\n          rationale: 'Light exposure helps regulate mood and circadian rhythms',\n        },\n      ],\n      Anxiety: [\n        {\n          category: 'emotional',\n          priority: 'high',\n          recommendation:\n            'Practice deep breathing and progressive muscle relaxation',\n          frequency: 'Daily',\n          rationale:\n            'Relaxation techniques help manage anxiety symptoms and prevent escalation',\n        },\n        {\n          category: 'lifestyle',\n          priority: 'medium',\n          recommendation: 'Limit caffeine and alcohol intake',\n          frequency: 'Daily',\n          rationale: 'These substances can exacerbate anxiety symptoms',\n        },\n      ],\n    };\n\n    return recommendations[condition] || [];\n  }\n\n  /**\n   * Create monitoring plan\n   */\n  private createMonitoringPlan(\n    clinicalProfile: ClinicalProfile,\n  ): MonitoringPlan {\n    const { primaryConditions, overallRiskLevel } = clinicalProfile;\n\n    const assessmentSchedule =\n      overallRiskLevel === 'critical'\n        ? 'Weekly for first month, then biweekly'\n        : overallRiskLevel === 'high'\n          ? 'Biweekly for first 6 weeks, then monthly'\n          : 'Monthly for first 3 months, then quarterly';\n\n    const keyMetrics = [\n      'Symptom severity scores',\n      'Functional improvement measures',\n      'Quality of life indicators',\n      'Treatment adherence',\n      'Safety concerns',\n    ];\n\n    const warningSigns = this.getWarningSignsForConditions(primaryConditions);\n\n    const reviewPoints = [\n      'After 4 weeks of treatment',\n      'At 8-week mark',\n      'At 3-month mark',\n      'Every 6 months thereafter',\n    ];\n\n    return {\n      assessmentSchedule,\n      keyMetrics,\n      warningSigns,\n      reviewPoints,\n    };\n  }\n\n  /**\n   * Create contingency plan for crisis situations\n   */\n  private createContingencyPlan(\n    clinicalProfile: ClinicalProfile,\n  ): ContingencyPlan {\n    const crisisContacts = [\n      'Assigned therapist',\n      'Crisis hotline: 988 (Suicide & Crisis Lifeline)',\n      'Emergency services: 911',\n      'Crisis text line: Text HOME to 741741',\n    ];\n\n    const emergencySteps = [\n      'Recognize warning signs early',\n      'Use learned coping strategies',\n      'Contact support person or therapist',\n      'If immediate danger, call 911 or go to emergency room',\n      'Follow up with treatment team within 24 hours',\n    ];\n\n    const escalationTriggers = this.getEscalationTriggers(clinicalProfile);\n\n    const safetyResources = [\n      'Personal safety plan',\n      'Crisis intervention services',\n      'Mobile crisis teams',\n      'Peer support networks',\n      'Online mental health resources',\n    ];\n\n    return {\n      crisisContacts,\n      emergencySteps,\n      escalationTriggers,\n      safetyResources,\n    };\n  }\n\n  /**\n   * Define success metrics for treatment\n   */\n  private defineSuccessMetrics(\n    clinicalProfile: ClinicalProfile,\n  ): SuccessMetric[] {\n    const { primaryConditions } = clinicalProfile;\n    const metrics: SuccessMetric[] = [];\n\n    // Universal metrics\n    metrics.push(\n      {\n        metric: 'Overall symptom severity reduction',\n        targetImprovement: '50% reduction in primary symptoms',\n        timeframe: '12 weeks',\n        measurementMethod:\n          'Standardized assessment tools and clinical interviews',\n      },\n      {\n        metric: 'Functional improvement',\n        targetImprovement:\n          'Return to baseline functioning in work/school and relationships',\n        timeframe: '16 weeks',\n        measurementMethod: 'Functional assessment scales and self-report',\n      },\n    );\n\n    // Condition-specific metrics\n    primaryConditions.forEach((condition) => {\n      const conditionMetrics = this.getConditionSpecificMetrics(\n        condition.condition,\n      );\n      metrics.push(...conditionMetrics);\n    });\n\n    return metrics;\n  }\n\n  /**\n   * Get condition-specific success metrics\n   */\n  private getConditionSpecificMetrics(condition: string): SuccessMetric[] {\n    const metrics: Record<string, SuccessMetric[]> = {\n      Depression: [\n        {\n          metric: 'PHQ-9 score improvement',\n          targetImprovement: 'Score reduction to below 10 (mild range)',\n          timeframe: '8-12 weeks',\n          measurementMethod: 'PHQ-9 questionnaire administered biweekly',\n        },\n      ],\n      Anxiety: [\n        {\n          metric: 'GAD-7 score improvement',\n          targetImprovement: 'Score reduction to below 8 (mild range)',\n          timeframe: '6-10 weeks',\n          measurementMethod: 'GAD-7 questionnaire administered biweekly',\n        },\n      ],\n    };\n\n    return metrics[condition] || [];\n  }\n\n  // Helper methods\n  private estimateCoreTreatmentDuration(\n    condition: ClinicalInsight | undefined,\n  ): string {\n    if (!condition) return '12-16 weeks';\n\n    const durations = {\n      extreme: '20-24 weeks',\n      severe: '16-20 weeks',\n      moderate: '12-16 weeks',\n      mild: '8-12 weeks',\n      subclinical: '6-8 weeks',\n    };\n\n    return durations[condition.clinicalLevel] || '12-16 weeks';\n  }\n\n  private getCorePhaseGoals(condition: ClinicalInsight | undefined): string[] {\n    if (!condition) return ['Symptom reduction', 'Skill development'];\n\n    return [\n      `Reduce ${condition.condition.toLowerCase()} symptoms`,\n      'Develop effective coping strategies',\n      'Improve daily functioning',\n      'Build therapeutic skills',\n    ];\n  }\n\n  private getCorePhaseApproaches(\n    condition: ClinicalInsight | undefined,\n  ): string[] {\n    if (!condition) return ['Cognitive Behavioral Therapy (CBT)'];\n    return condition.therapeuticFocus.slice(0, 3);\n  }\n\n  private getCorePhaseAreas(condition: ClinicalInsight | undefined): string[] {\n    if (!condition) return ['Symptom management'];\n\n    return [\n      'Symptom identification and management',\n      'Skill building and practice',\n      'Functional improvement',\n      'Therapeutic relationship building',\n    ];\n  }\n\n  private getCorePhaseSuccessCriteria(\n    condition: ClinicalInsight | undefined,\n  ): string[] {\n    if (!condition) return ['Reduced symptoms'];\n\n    return [\n      'Significant symptom reduction',\n      'Improved coping skills',\n      'Enhanced daily functioning',\n      'Strong therapeutic alliance',\n    ];\n  }\n\n  private getSpecialRequirements(conditions: ClinicalInsight[]): string[] {\n    const requirements: string[] = [];\n\n    conditions.forEach((condition) => {\n      if (condition.condition.includes('PTSD')) {\n        requirements.push('Trauma-informed care');\n        requirements.push('EMDR certification preferred');\n      }\n      if (condition.condition.includes('Bipolar')) {\n        requirements.push('Mood disorder specialization');\n        requirements.push('Medication collaboration experience');\n      }\n    });\n\n    return requirements;\n  }\n\n  private estimateOverallTreatmentDuration(\n    conditions: ClinicalInsight[],\n  ): string {\n    if (conditions.some((c) => c.clinicalLevel === 'extreme'))\n      return '6-12 months';\n    if (conditions.some((c) => c.clinicalLevel === 'severe'))\n      return '4-8 months';\n    if (conditions.some((c) => c.clinicalLevel === 'moderate'))\n      return '3-6 months';\n    return '2-4 months';\n  }\n\n  private requiresPsychiatricEvaluation(\n    conditions: ClinicalInsight[],\n    riskLevel: string,\n  ): boolean {\n    if (riskLevel === 'critical' || riskLevel === 'high') return true;\n\n    const medicationIndicatedConditions = [\n      'Depression',\n      'Bipolar disorder (BD)',\n      'Anxiety',\n      'Post-traumatic stress disorder (PTSD)',\n    ];\n\n    return conditions.some(\n      (c) =>\n        medicationIndicatedConditions.includes(c.condition) &&\n        (c.clinicalLevel === 'severe' || c.clinicalLevel === 'extreme'),\n    );\n  }\n\n  private getWarningSignsForConditions(\n    conditions: ClinicalInsight[],\n  ): string[] {\n    const warningSignsSet = new Set<string>();\n\n    conditions.forEach((condition) => {\n      switch (condition.condition) {\n        case 'Depression':\n          warningSignsSet.add('Increased hopelessness or suicidal thoughts');\n          warningSignsSet.add('Significant mood deterioration');\n          warningSignsSet.add('Social withdrawal');\n          break;\n        case 'Anxiety':\n          warningSignsSet.add('Increased panic attacks');\n          warningSignsSet.add('Avoidance behaviors increasing');\n          break;\n        case 'Bipolar disorder (BD)':\n          warningSignsSet.add('Mood episode onset');\n          warningSignsSet.add('Sleep pattern changes');\n          break;\n      }\n    });\n\n    return Array.from(warningSignsSet);\n  }\n\n  private getEscalationTriggers(clinicalProfile: ClinicalProfile): string[] {\n    return [\n      'Suicidal or self-harm thoughts',\n      'Substance use relapse',\n      'Severe symptom deterioration',\n      'Loss of functioning',\n      'Treatment non-adherence',\n      'Social support breakdown',\n    ];\n  }\n}\n"],"version":3}