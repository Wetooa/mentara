673732eea58539ccfcad85b8b0bb375d
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
var _a, _b, _c, _d, _e, _f, _g, _h;
Object.defineProperty(exports, "__esModule", { value: true });
exports.AuthController = void 0;
const common_1 = require("@nestjs/common");
const passport_1 = require("@nestjs/passport");
const throttler_1 = require("@nestjs/throttler");
const swagger_1 = require("@nestjs/swagger");
const jwt_auth_guard_1 = require("./guards/jwt-auth.guard");
const current_user_id_decorator_1 = require("./decorators/current-user-id.decorator");
const public_decorator_1 = require("./decorators/public.decorator");
const zod_validation_pipe_1 = require("../common/pipes/zod-validation.pipe");
const mentara_commons_1 = require("mentara-commons");
const auth_service_1 = require("./auth.service");
const email_verification_service_1 = require("./services/email-verification.service");
const password_reset_service_1 = require("./services/password-reset.service");
const express_1 = require("express");
let AuthController = class AuthController {
    authService;
    emailVerificationService;
    passwordResetService;
    constructor(authService, emailVerificationService, passwordResetService) {
        this.authService = authService;
        this.emailVerificationService = emailVerificationService;
        this.passwordResetService = passwordResetService;
    }
    // Role-specific registration endpoints moved to dedicated controllers:
    // - /auth/client/register
    // - /auth/therapist/register
    // - /auth/admin/create-account
    // - /auth/moderator/create-account
    async getMe(id) {
        return await this.authService.getUser(id);
    }
    async getAllUsers() {
        return await this.authService.getUsers();
    }
    async forceLogout(id) {
        return await this.authService.forceLogout(id);
    }
    // Local Authentication Endpoints
    async register(registerDto) {
        // Only allow client and therapist roles for general registration
        const allowedRole = registerDto.role === 'therapist' ? 'therapist' : 'client';
        return await this.authService.registerUserWithEmail(registerDto.email, registerDto.password, registerDto.firstName, registerDto.lastName, allowedRole);
    }
    async login(loginDto, req) {
        const ipAddress = req.ip;
        const userAgent = req.get('User-Agent');
        const result = await this.authService.loginWithEmail(loginDto.email, loginDto.password, ipAddress, userAgent);
        return {
            user: {
                id: result.user.id,
                email: result.user.email,
                firstName: result.user.firstName,
                lastName: result.user.lastName,
                role: result.user.role,
                emailVerified: result.user.emailVerified,
            },
            accessToken: result.tokens.accessToken,
            refreshToken: result.tokens.refreshToken,
            expiresIn: result.tokens.expiresIn,
        };
    }
    async refreshTokens(refreshDto, req) {
        if (!refreshDto.refreshToken) {
            throw new common_1.UnauthorizedException('Refresh token required');
        }
        const ipAddress = req.ip;
        const userAgent = req.get('User-Agent');
        const tokens = await this.authService.refreshTokens(refreshDto.refreshToken, ipAddress, userAgent);
        return tokens;
    }
    async logout(logoutDto) {
        if (logoutDto.refreshToken) {
            await this.authService.logout(logoutDto.refreshToken);
        }
        return { message: 'Logged out successfully' };
    }
    async getProfile(userId) {
        const user = await this.authService.validateUser(userId);
        if (!user) {
            throw new common_1.UnauthorizedException('User not found');
        }
        return user;
    }
    // Role-specific profile endpoints moved to dedicated controllers:
    // - /auth/client/profile
    // - /auth/therapist/profile
    // - /auth/admin/profile
    // - /auth/moderator/profile
    // ===== PASSWORD RESET ENDPOINTS =====
    async requestPasswordReset(requestResetDto) {
        await this.passwordResetService.requestPasswordReset(requestResetDto.email);
        return {
            message: 'If an account with that email exists, we will send a password reset link.',
        };
    }
    async resetPassword(resetDto) {
        // Validate that passwords match
        if (resetDto.newPassword !== resetDto.confirmPassword) {
            throw new common_1.UnauthorizedException('Passwords do not match');
        }
        const result = await this.passwordResetService.resetPassword(resetDto.token, resetDto.newPassword);
        return result;
    }
    async validateResetToken(token) {
        const result = await this.passwordResetService.validateResetToken(token);
        return result;
    }
    // ===== JWT TOKEN VALIDATION ENDPOINT =====
    async validateToken(body) {
        if (!body.token) {
            throw new common_1.UnauthorizedException('Token is required');
        }
        const result = await this.authService.validateToken(body.token);
        if (!result.valid) {
            return {
                valid: false,
                error: result.error,
            };
        }
        return {
            valid: true,
            user: result.user,
            expires: result.expires,
        };
    }
    // ===== USER EXISTENCE CHECK ENDPOINT =====
    async checkUserExists(email) {
        if (!email) {
            throw new common_1.UnauthorizedException('Email is required');
        }
        // Basic email validation
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(email)) {
            throw new common_1.UnauthorizedException('Invalid email format');
        }
        const result = await this.authService.checkUserExists(email);
        return result;
    }
    // ===== EMAIL VERIFICATION ENDPOINTS =====
    async sendVerificationEmail(userId) {
        await this.emailVerificationService.sendVerificationEmail(userId);
        return {
            message: 'Verification email sent successfully',
        };
    }
    async resendVerificationEmail(resendDto) {
        await this.emailVerificationService.resendVerificationEmail(resendDto.email);
        return {
            message: 'If an account with that email exists, we will send a verification link.',
        };
    }
    async verifyEmail(verifyDto) {
        const result = await this.emailVerificationService.verifyEmail(verifyDto.token);
        return result;
    }
    // Google OAuth Routes
    async googleAuth() {
        // Initiates Google OAuth flow
    }
    async googleAuthRedirect(req, res, query) {
        try {
            // Get role from state parameter if provided (for role-specific OAuth flows)
            const role = query.state || 'client'; // Default to client if no role specified
            // Handle Google OAuth callback and get tokens
            const result = await this.authService.handleOAuthLogin(req.user, 'google', role);
            // Extract tokens from result
            const { accessToken, refreshToken } = result;
            // Determine frontend redirect URL based on environment
            const frontendUrl = process.env.FRONTEND_URL || 'http://localhost:3000';
            const redirectUrl = `${frontendUrl}/sso-callback?token=${accessToken}&refresh_token=${refreshToken}&role=${role}`;
            // Redirect to frontend with tokens in URL parameters
            return res.redirect(redirectUrl);
        }
        catch (error) {
            console.error('Google OAuth callback error:', error);
            // Redirect to frontend with error
            const frontendUrl = process.env.FRONTEND_URL || 'http://localhost:3000';
            const errorUrl = `${frontendUrl}/auth/sign-in?error=oauth_failed&provider=google`;
            return res.redirect(errorUrl);
        }
    }
    // Microsoft OAuth Routes
    async microsoftAuth() {
        // Initiates Microsoft OAuth flow
    }
    async microsoftAuthRedirect(req, res, query) {
        try {
            // Get role from state parameter if provided (for role-specific OAuth flows)
            const role = query.state || 'client'; // Default to client if no role specified
            // Handle Microsoft OAuth callback and get tokens
            const result = await this.authService.handleOAuthLogin(req.user, 'microsoft', role);
            // Extract tokens from result
            const { accessToken, refreshToken } = result;
            // Determine frontend redirect URL based on environment
            const frontendUrl = process.env.FRONTEND_URL || 'http://localhost:3000';
            const redirectUrl = `${frontendUrl}/sso-callback?token=${accessToken}&refresh_token=${refreshToken}&role=${role}`;
            // Redirect to frontend with tokens in URL parameters
            return res.redirect(redirectUrl);
        }
        catch (error) {
            console.error('Microsoft OAuth callback error:', error);
            // Redirect to frontend with error
            const frontendUrl = process.env.FRONTEND_URL || 'http://localhost:3000';
            const errorUrl = `${frontendUrl}/auth/sign-in?error=oauth_failed&provider=microsoft`;
            return res.redirect(errorUrl);
        }
    }
    // OAuth Token Exchange API Endpoint (for frontend to call)
    async exchangeOAuthToken(body) {
        const { provider, code } = body;
        if (!code) {
            throw new common_1.UnauthorizedException('Authorization code is required');
        }
        if (!['google', 'microsoft'].includes(provider)) {
            throw new common_1.UnauthorizedException('Invalid OAuth provider');
        }
        try {
            // TODO: Implement proper OAuth token exchange with provider APIs
            // This would involve exchanging the authorization code for an access token
            // and then fetching user profile information from the OAuth provider
            // For now, this is a placeholder that expects the full OAuth flow
            // to be handled by the existing Passport strategies
            throw new common_1.UnauthorizedException('Direct token exchange not yet implemented. Use OAuth redirect flow.');
        }
        catch (error) {
            console.error('OAuth token exchange error:', error);
            throw new common_1.UnauthorizedException('OAuth token exchange failed');
        }
    }
    // ===== SESSION MANAGEMENT ENDPOINTS =====
    async getSessionInfo(req) {
        // Extract refresh token from Authorization header or cookies
        const refreshToken = req.headers['x-refresh-token'];
        if (!refreshToken) {
            throw new common_1.UnauthorizedException('Refresh token required for session info');
        }
        return await this.authService.getSessionInfo(refreshToken);
    }
    async getActiveSessions(userId, req) {
        const refreshToken = req.headers['x-refresh-token'];
        return await this.authService.getActiveSessions(userId, refreshToken);
    }
    async terminateSession(terminateDto, userId) {
        return await this.authService.terminateSession(terminateDto.sessionId, userId);
    }
    async terminateOtherSessions(userId, req) {
        const refreshToken = req.headers['x-refresh-token'];
        return await this.authService.terminateOtherSessions(userId, refreshToken);
    }
    async universalLogout(userId) {
        return await this.authService.universalLogout(userId);
    }
};
exports.AuthController = AuthController;
__decorate([
    (0, common_1.UseGuards)(jwt_auth_guard_1.JwtAuthGuard),
    (0, swagger_1.ApiBearerAuth)('JWT-auth'),
    (0, swagger_1.ApiOperation)({
        summary: 'Get current user profile',
        description: "Retrieve the authenticated user's profile information",
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'User profile retrieved successfully',
    }),
    (0, swagger_1.ApiResponse)({
        status: 401,
        description: 'Unauthorized - Invalid or missing JWT token',
    }),
    (0, common_1.Get)('me'),
    __param(0, (0, current_user_id_decorator_1.CurrentUserId)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "getMe", null);
__decorate([
    (0, common_1.UseGuards)(jwt_auth_guard_1.JwtAuthGuard),
    (0, common_1.Get)('users'),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", []),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "getAllUsers", null);
__decorate([
    (0, common_1.UseGuards)(jwt_auth_guard_1.JwtAuthGuard),
    (0, throttler_1.Throttle)({ default: { limit: 20, ttl: 300000 } }) // 20 logout attempts per 5 minutes
    ,
    (0, common_1.Post)('force-logout'),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, current_user_id_decorator_1.CurrentUserId)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "forceLogout", null);
__decorate([
    (0, public_decorator_1.Public)(),
    (0, swagger_1.ApiOperation)({
        summary: 'Register new user',
        description: 'Register a new user account with email and password. Supports client and therapist roles only.',
    }),
    (0, swagger_1.ApiBody)({
        description: 'User registration details',
        schema: {
            type: 'object',
            properties: {
                email: { type: 'string', format: 'email', example: 'user@example.com' },
                password: {
                    type: 'string',
                    minLength: 8,
                    example: 'SecurePassword123!',
                },
                firstName: { type: 'string', example: 'John' },
                lastName: { type: 'string', example: 'Doe' },
                role: {
                    type: 'string',
                    enum: ['client', 'therapist'],
                    example: 'client',
                },
            },
            required: ['email', 'password', 'firstName', 'lastName', 'role'],
        },
    }),
    (0, swagger_1.ApiResponse)({
        status: 201,
        description: 'User registered successfully',
        schema: {
            type: 'object',
            properties: {
                user: {
                    type: 'object',
                    properties: {
                        id: { type: 'string' },
                        email: { type: 'string' },
                        firstName: { type: 'string' },
                        lastName: { type: 'string' },
                        role: { type: 'string' },
                    },
                },
                accessToken: { type: 'string' },
                refreshToken: { type: 'string' },
            },
        },
    }),
    (0, swagger_1.ApiResponse)({
        status: 400,
        description: 'Bad request - Invalid input data',
    }),
    (0, swagger_1.ApiResponse)({
        status: 409,
        description: 'Conflict - Email already exists',
    }),
    (0, throttler_1.Throttle)({ default: { limit: 5, ttl: 300000 } }) // 5 registration attempts per 5 minutes
    ,
    (0, common_1.Post)('register'),
    (0, common_1.HttpCode)(common_1.HttpStatus.CREATED),
    __param(0, (0, common_1.Body)(new zod_validation_pipe_1.ZodValidationPipe(mentara_commons_1.RegisterUserDtoSchema))),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "register", null);
__decorate([
    (0, public_decorator_1.Public)(),
    (0, swagger_1.ApiOperation)({
        summary: 'User login',
        description: 'Authenticate user with email and password, returning JWT tokens',
    }),
    (0, swagger_1.ApiBody)({
        description: 'Login credentials',
        schema: {
            type: 'object',
            properties: {
                email: { type: 'string', format: 'email', example: 'user@example.com' },
                password: { type: 'string', example: 'SecurePassword123!' },
            },
            required: ['email', 'password'],
        },
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Login successful',
        schema: {
            type: 'object',
            properties: {
                user: {
                    type: 'object',
                    properties: {
                        id: { type: 'string' },
                        email: { type: 'string' },
                        firstName: { type: 'string' },
                        lastName: { type: 'string' },
                        role: { type: 'string' },
                        emailVerified: { type: 'boolean' },
                    },
                },
                accessToken: { type: 'string' },
                refreshToken: { type: 'string' },
                expiresIn: { type: 'number' },
            },
        },
    }),
    (0, swagger_1.ApiResponse)({
        status: 401,
        description: 'Unauthorized - Invalid credentials',
    }),
    (0, swagger_1.ApiResponse)({
        status: 429,
        description: 'Too many login attempts',
    }),
    (0, throttler_1.Throttle)({ default: { limit: 10, ttl: 300000 } }) // 10 login attempts per 5 minutes
    ,
    (0, common_1.Post)('login'),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, common_1.Body)(new zod_validation_pipe_1.ZodValidationPipe(mentara_commons_1.LoginDtoSchema))),
    __param(1, (0, common_1.Req)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object, typeof (_d = typeof express_1.Request !== "undefined" && express_1.Request) === "function" ? _d : Object]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "login", null);
__decorate([
    (0, public_decorator_1.Public)(),
    (0, throttler_1.Throttle)({ default: { limit: 20, ttl: 300000 } }) // 20 refresh attempts per 5 minutes
    ,
    (0, common_1.Post)('refresh'),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, common_1.Body)(new zod_validation_pipe_1.ZodValidationPipe(mentara_commons_1.RefreshTokenDtoSchema))),
    __param(1, (0, common_1.Req)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object, typeof (_e = typeof express_1.Request !== "undefined" && express_1.Request) === "function" ? _e : Object]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "refreshTokens", null);
__decorate([
    (0, common_1.UseGuards)(jwt_auth_guard_1.JwtAuthGuard),
    (0, common_1.Post)('logout'),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, common_1.Body)(new zod_validation_pipe_1.ZodValidationPipe(mentara_commons_1.LogoutDtoSchema))),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "logout", null);
__decorate([
    (0, common_1.UseGuards)(jwt_auth_guard_1.JwtAuthGuard),
    (0, common_1.Get)('profile'),
    __param(0, (0, current_user_id_decorator_1.CurrentUserId)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "getProfile", null);
__decorate([
    (0, public_decorator_1.Public)(),
    (0, throttler_1.Throttle)({ default: { limit: 5, ttl: 300000 } }) // 5 reset requests per 5 minutes
    ,
    (0, common_1.Post)('request-password-reset'),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, common_1.Body)(new zod_validation_pipe_1.ZodValidationPipe(mentara_commons_1.RequestPasswordResetDtoSchema))),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "requestPasswordReset", null);
__decorate([
    (0, public_decorator_1.Public)(),
    (0, throttler_1.Throttle)({ default: { limit: 10, ttl: 300000 } }) // 10 reset attempts per 5 minutes
    ,
    (0, common_1.Post)('reset-password'),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, common_1.Body)(new zod_validation_pipe_1.ZodValidationPipe(mentara_commons_1.ResetPasswordDtoSchema))),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "resetPassword", null);
__decorate([
    (0, public_decorator_1.Public)(),
    (0, common_1.Get)('validate-reset-token'),
    __param(0, (0, common_1.Query)('token')),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "validateResetToken", null);
__decorate([
    (0, public_decorator_1.Public)(),
    (0, swagger_1.ApiOperation)({
        summary: 'Validate JWT token',
        description: 'Validate a JWT token and return user information if valid',
    }),
    (0, swagger_1.ApiBody)({
        description: 'JWT token to validate',
        schema: {
            type: 'object',
            properties: {
                token: {
                    type: 'string',
                    example: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...',
                },
            },
            required: ['token'],
        },
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Token validation result',
        schema: {
            type: 'object',
            properties: {
                valid: { type: 'boolean' },
                user: {
                    type: 'object',
                    properties: {
                        id: { type: 'string' },
                        email: { type: 'string' },
                        firstName: { type: 'string' },
                        lastName: { type: 'string' },
                        role: { type: 'string' },
                        emailVerified: { type: 'boolean' },
                    },
                },
                expires: { type: 'string', format: 'date-time' },
            },
        },
    }),
    (0, swagger_1.ApiResponse)({
        status: 400,
        description: 'Bad request - Token is required',
    }),
    (0, throttler_1.Throttle)({ default: { limit: 100, ttl: 60000 } }) // 100 validation requests per minute
    ,
    (0, common_1.Post)('validate-token'),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, common_1.Body)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "validateToken", null);
__decorate([
    (0, public_decorator_1.Public)(),
    (0, swagger_1.ApiOperation)({
        summary: 'Check user existence by email',
        description: 'Check if a user exists by email address and return their role and verification status',
    }),
    (0, swagger_1.ApiQuery)({
        name: 'email',
        description: 'Email address to check',
        example: 'user@example.com',
        required: true,
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'User existence check result',
        schema: {
            type: 'object',
            properties: {
                exists: { type: 'boolean' },
                role: {
                    type: 'string',
                    enum: ['client', 'therapist', 'moderator', 'admin'],
                },
                isVerified: { type: 'boolean' },
            },
            required: ['exists'],
        },
    }),
    (0, swagger_1.ApiResponse)({
        status: 400,
        description: 'Bad request - Invalid email format',
    }),
    (0, swagger_1.ApiResponse)({
        status: 429,
        description: 'Too many requests',
    }),
    (0, throttler_1.Throttle)({ default: { limit: 30, ttl: 60000 } }) // 30 requests per minute
    ,
    (0, common_1.Get)('check-user'),
    __param(0, (0, common_1.Query)('email')),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "checkUserExists", null);
__decorate([
    (0, common_1.UseGuards)(jwt_auth_guard_1.JwtAuthGuard),
    (0, throttler_1.Throttle)({ default: { limit: 3, ttl: 300000 } }) // 3 verification emails per 5 minutes
    ,
    (0, common_1.Post)('send-verification-email'),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, current_user_id_decorator_1.CurrentUserId)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "sendVerificationEmail", null);
__decorate([
    (0, public_decorator_1.Public)(),
    (0, throttler_1.Throttle)({ default: { limit: 5, ttl: 300000 } }) // 5 resend attempts per 5 minutes
    ,
    (0, common_1.Post)('resend-verification-email'),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, common_1.Body)(new zod_validation_pipe_1.ZodValidationPipe(mentara_commons_1.ResendVerificationEmailDtoSchema))),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "resendVerificationEmail", null);
__decorate([
    (0, public_decorator_1.Public)(),
    (0, common_1.Post)('verify-email'),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, common_1.Body)(new zod_validation_pipe_1.ZodValidationPipe(mentara_commons_1.VerifyEmailDtoSchema))),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "verifyEmail", null);
__decorate([
    (0, public_decorator_1.Public)(),
    (0, common_1.Get)('google'),
    (0, common_1.UseGuards)((0, passport_1.AuthGuard)('google')),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", []),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "googleAuth", null);
__decorate([
    (0, public_decorator_1.Public)(),
    (0, common_1.Get)('google/callback'),
    (0, common_1.UseGuards)((0, passport_1.AuthGuard)('google')),
    __param(0, (0, common_1.Req)()),
    __param(1, (0, common_1.Res)()),
    __param(2, (0, common_1.Query)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object, Object, Object]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "googleAuthRedirect", null);
__decorate([
    (0, public_decorator_1.Public)(),
    (0, common_1.Get)('microsoft'),
    (0, common_1.UseGuards)((0, passport_1.AuthGuard)('microsoft')),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", []),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "microsoftAuth", null);
__decorate([
    (0, public_decorator_1.Public)(),
    (0, common_1.Get)('microsoft/callback'),
    (0, common_1.UseGuards)((0, passport_1.AuthGuard)('microsoft')),
    __param(0, (0, common_1.Req)()),
    __param(1, (0, common_1.Res)()),
    __param(2, (0, common_1.Query)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object, Object, Object]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "microsoftAuthRedirect", null);
__decorate([
    (0, public_decorator_1.Public)(),
    (0, swagger_1.ApiOperation)({
        summary: 'Exchange OAuth authorization code for tokens',
        description: 'Exchange OAuth authorization code from Google/Microsoft for JWT tokens',
    }),
    (0, swagger_1.ApiBody)({
        description: 'OAuth authorization code and provider information',
        schema: {
            type: 'object',
            properties: {
                provider: {
                    type: 'string',
                    enum: ['google', 'microsoft'],
                    example: 'google',
                },
                code: {
                    type: 'string',
                    example: 'authorization_code_from_oauth_provider',
                },
                state: {
                    type: 'string',
                    example: 'client',
                    description: 'Optional role for new user creation',
                },
            },
            required: ['provider', 'code'],
        },
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'OAuth login successful',
        schema: {
            type: 'object',
            properties: {
                user: {
                    type: 'object',
                    properties: {
                        id: { type: 'string' },
                        email: { type: 'string' },
                        firstName: { type: 'string' },
                        lastName: { type: 'string' },
                        role: { type: 'string' },
                    },
                },
                accessToken: { type: 'string' },
                refreshToken: { type: 'string' },
                expiresIn: { type: 'number' },
            },
        },
    }),
    (0, swagger_1.ApiResponse)({
        status: 400,
        description: 'Invalid OAuth code or provider',
    }),
    (0, common_1.Post)('oauth/token-exchange'),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, common_1.Body)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "exchangeOAuthToken", null);
__decorate([
    (0, common_1.UseGuards)(jwt_auth_guard_1.JwtAuthGuard),
    (0, swagger_1.ApiBearerAuth)('JWT-auth'),
    (0, swagger_1.ApiOperation)({
        summary: 'Get current session information',
        description: 'Retrieve information about the current user session',
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Session information retrieved successfully',
        schema: {
            type: 'object',
            properties: {
                sessionId: { type: 'string' },
                createdAt: { type: 'string', format: 'date-time' },
                lastActivity: { type: 'string', format: 'date-time' },
                device: { type: 'string' },
                location: { type: 'string' },
                ipAddress: { type: 'string' },
                userAgent: { type: 'string' },
            },
        },
    }),
    (0, swagger_1.ApiResponse)({
        status: 401,
        description: 'Unauthorized - Invalid or missing JWT token',
    }),
    (0, common_1.Get)('session-info'),
    __param(0, (0, common_1.Req)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [typeof (_f = typeof express_1.Request !== "undefined" && express_1.Request) === "function" ? _f : Object]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "getSessionInfo", null);
__decorate([
    (0, common_1.UseGuards)(jwt_auth_guard_1.JwtAuthGuard),
    (0, swagger_1.ApiBearerAuth)('JWT-auth'),
    (0, swagger_1.ApiOperation)({
        summary: 'Get all active sessions',
        description: 'Retrieve all active sessions for the current user',
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Active sessions retrieved successfully',
        schema: {
            type: 'object',
            properties: {
                sessions: {
                    type: 'array',
                    items: {
                        type: 'object',
                        properties: {
                            id: { type: 'string' },
                            device: { type: 'string' },
                            location: { type: 'string' },
                            lastActivity: { type: 'string', format: 'date-time' },
                            isCurrent: { type: 'boolean' },
                            ipAddress: { type: 'string' },
                            userAgent: { type: 'string' },
                            createdAt: { type: 'string', format: 'date-time' },
                        },
                    },
                },
            },
        },
    }),
    (0, swagger_1.ApiResponse)({
        status: 401,
        description: 'Unauthorized - Invalid or missing JWT token',
    }),
    (0, common_1.Get)('active-sessions'),
    __param(0, (0, current_user_id_decorator_1.CurrentUserId)()),
    __param(1, (0, common_1.Req)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, typeof (_g = typeof express_1.Request !== "undefined" && express_1.Request) === "function" ? _g : Object]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "getActiveSessions", null);
__decorate([
    (0, common_1.UseGuards)(jwt_auth_guard_1.JwtAuthGuard),
    (0, swagger_1.ApiBearerAuth)('JWT-auth'),
    (0, swagger_1.ApiOperation)({
        summary: 'Terminate a specific session',
        description: 'Terminate a specific session by session ID',
    }),
    (0, swagger_1.ApiBody)({
        description: 'Session ID to terminate',
        schema: {
            type: 'object',
            properties: {
                sessionId: { type: 'string', example: 'session-uuid-here' },
            },
            required: ['sessionId'],
        },
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Session terminated successfully',
        schema: {
            type: 'object',
            properties: {
                success: { type: 'boolean' },
                message: { type: 'string' },
            },
        },
    }),
    (0, swagger_1.ApiResponse)({
        status: 401,
        description: 'Unauthorized - Invalid or missing JWT token',
    }),
    (0, swagger_1.ApiResponse)({
        status: 404,
        description: 'Session not found',
    }),
    (0, throttler_1.Throttle)({ default: { limit: 10, ttl: 60000 } }) // 10 terminations per minute
    ,
    (0, common_1.Delete)('terminate-session'),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, common_1.Body)(new zod_validation_pipe_1.ZodValidationPipe(mentara_commons_1.TerminateSessionDtoSchema))),
    __param(1, (0, current_user_id_decorator_1.CurrentUserId)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object, String]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "terminateSession", null);
__decorate([
    (0, common_1.UseGuards)(jwt_auth_guard_1.JwtAuthGuard),
    (0, swagger_1.ApiBearerAuth)('JWT-auth'),
    (0, swagger_1.ApiOperation)({
        summary: 'Terminate all other sessions',
        description: 'Terminate all other sessions except the current one',
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'Other sessions terminated successfully',
        schema: {
            type: 'object',
            properties: {
                success: { type: 'boolean' },
                terminatedCount: { type: 'number' },
                message: { type: 'string' },
            },
        },
    }),
    (0, swagger_1.ApiResponse)({
        status: 401,
        description: 'Unauthorized - Invalid or missing JWT token',
    }),
    (0, throttler_1.Throttle)({ default: { limit: 5, ttl: 60000 } }) // 5 terminations per minute
    ,
    (0, common_1.Post)('terminate-other-sessions'),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, current_user_id_decorator_1.CurrentUserId)()),
    __param(1, (0, common_1.Req)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String, typeof (_h = typeof express_1.Request !== "undefined" && express_1.Request) === "function" ? _h : Object]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "terminateOtherSessions", null);
__decorate([
    (0, common_1.UseGuards)(jwt_auth_guard_1.JwtAuthGuard),
    (0, swagger_1.ApiBearerAuth)('JWT-auth'),
    (0, swagger_1.ApiOperation)({
        summary: 'Universal logout',
        description: 'Clear all sessions for the current user (logout from all devices)',
    }),
    (0, swagger_1.ApiResponse)({
        status: 200,
        description: 'All sessions terminated successfully',
        schema: {
            type: 'object',
            properties: {
                success: { type: 'boolean' },
                message: { type: 'string' },
            },
        },
    }),
    (0, swagger_1.ApiResponse)({
        status: 401,
        description: 'Unauthorized - Invalid or missing JWT token',
    }),
    (0, throttler_1.Throttle)({ default: { limit: 3, ttl: 60000 } }) // 3 universal logouts per minute
    ,
    (0, common_1.Post)('universal-logout'),
    (0, common_1.HttpCode)(common_1.HttpStatus.OK),
    __param(0, (0, current_user_id_decorator_1.CurrentUserId)()),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [String]),
    __metadata("design:returntype", Promise)
], AuthController.prototype, "universalLogout", null);
exports.AuthController = AuthController = __decorate([
    (0, swagger_1.ApiTags)('auth'),
    (0, common_1.Controller)('auth'),
    __metadata("design:paramtypes", [typeof (_a = typeof auth_service_1.AuthService !== "undefined" && auth_service_1.AuthService) === "function" ? _a : Object, typeof (_b = typeof email_verification_service_1.EmailVerificationService !== "undefined" && email_verification_service_1.EmailVerificationService) === "function" ? _b : Object, typeof (_c = typeof password_reset_service_1.PasswordResetService !== "undefined" && password_reset_service_1.PasswordResetService) === "function" ? _c : Object])
], AuthController);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL2F1dGgvYXV0aC5jb250cm9sbGVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSwyQ0Fhd0I7QUFDeEIsK0NBQTZDO0FBQzdDLGlEQUE2QztBQUM3Qyw2Q0FPeUI7QUFDekIsNERBQXVEO0FBQ3ZELHNGQUF1RTtBQUN2RSxvRUFBdUQ7QUFDdkQsNkVBQXdFO0FBQ3hFLHFEQW1CeUI7QUFDekIsaURBQTZDO0FBQzdDLHNGQUFpRjtBQUNqRiw4RUFBeUU7QUFDekUscUNBQWtDO0FBSTNCLElBQU0sY0FBYyxHQUFwQixNQUFNLGNBQWM7SUFFTjtJQUNBO0lBQ0E7SUFIbkIsWUFDbUIsV0FBd0IsRUFDeEIsd0JBQWtELEVBQ2xELG9CQUEwQztRQUYxQyxnQkFBVyxHQUFYLFdBQVcsQ0FBYTtRQUN4Qiw2QkFBd0IsR0FBeEIsd0JBQXdCLENBQTBCO1FBQ2xELHlCQUFvQixHQUFwQixvQkFBb0IsQ0FBc0I7SUFDMUQsQ0FBQztJQUVKLHVFQUF1RTtJQUN2RSwwQkFBMEI7SUFDMUIsNkJBQTZCO0lBQzdCLCtCQUErQjtJQUMvQixtQ0FBbUM7SUFpQjdCLEFBQU4sS0FBSyxDQUFDLEtBQUssQ0FBa0IsRUFBVTtRQUNyQyxPQUFPLE1BQU0sSUFBSSxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLENBQUM7SUFDNUMsQ0FBQztJQUlLLEFBQU4sS0FBSyxDQUFDLFdBQVc7UUFDZixPQUFPLE1BQU0sSUFBSSxDQUFDLFdBQVcsQ0FBQyxRQUFRLEVBQUUsQ0FBQztJQUMzQyxDQUFDO0lBTUssQUFBTixLQUFLLENBQUMsV0FBVyxDQUFrQixFQUFVO1FBQzNDLE9BQU8sTUFBTSxJQUFJLENBQUMsV0FBVyxDQUFDLFdBQVcsQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUNoRCxDQUFDO0lBRUQsaUNBQWlDO0lBNkQzQixBQUFOLEtBQUssQ0FBQyxRQUFRLENBRVosV0FB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WCxNQUFNLEVBQUUsR0FBRztRQUNYLFdBQVcsRUFBRSw2Q0FBNkM7S0FDM0QsQ0FBQztJQUNELElBQUEsb0JBQVEsRUFBQyxFQUFFLE9BQU8sRUFBRSxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsR0FBRyxFQUFFLEtBQUssRUFBRSxFQUFFLENBQUMsQ0FBQyxpQ0FBaUM7O0lBQ2pGLElBQUEsYUFBSSxFQUFDLGtCQUFrQixDQUFDO0lBQ3hCLElBQUEsaUJBQVEsRUFBQyxtQkFBVSxDQUFDLEVBQUUsQ0FBQztJQUNELFdBQUEsSUFBQSx5Q0FBYSxHQUFFLENBQUE7Ozs7cURBRXJDO3lCQXgwQlUsY0FBYztJQUYxQixJQUFBLGlCQUFPLEVBQUMsTUFBTSxDQUFDO0lBQ2YsSUFBQSxtQkFBVSxFQUFDLE1BQU0sQ0FBQzt5REFHZSwwQkFBVyxvQkFBWCwwQkFBVyxvREFDRSxxREFBd0Isb0JBQXhCLHFEQUF3QixvREFDNUIsNkNBQW9CLG9CQUFwQiw2Q0FBb0I7R0FKbEQsY0FBYyxDQXkwQjFCIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9ob21lL3dldG9vYS9Eb2N1bWVudHMvY29kZS9wcm9qZWN0cy9tZW50YXJhL21lbnRhcmEtYXBpL3NyYy9hdXRoL2F1dGguY29udHJvbGxlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBCb2R5LFxuICBDb250cm9sbGVyLFxuICBHZXQsXG4gIEh0dHBDb2RlLFxuICBIdHRwU3RhdHVzLFxuICBQb3N0LFxuICBEZWxldGUsXG4gIFF1ZXJ5LFxuICBVc2VHdWFyZHMsXG4gIFJlcSxcbiAgUmVzLFxuICBVbmF1dGhvcml6ZWRFeGNlcHRpb24sXG59IGZyb20gJ0BuZXN0anMvY29tbW9uJztcbmltcG9ydCB7IEF1dGhHdWFyZCB9IGZyb20gJ0BuZXN0anMvcGFzc3BvcnQnO1xuaW1wb3J0IHsgVGhyb3R0bGUgfSBmcm9tICdAbmVzdGpzL3Rocm90dGxlcic7XG5pbXBvcnQge1xuICBBcGlUYWdzLFxuICBBcGlPcGVyYXRpb24sXG4gIEFwaVJlc3BvbnNlLFxuICBBcGlCb2R5LFxuICBBcGlCZWFyZXJBdXRoLFxuICBBcGlRdWVyeSxcbn0gZnJvbSAnQG5lc3Rqcy9zd2FnZ2VyJztcbmltcG9ydCB7IEp3dEF1dGhHdWFyZCB9IGZyb20gJy4vZ3VhcmRzL2p3dC1hdXRoLmd1YXJkJztcbmltcG9ydCB7IEN1cnJlbnRVc2VySWQgfSBmcm9tICcuL2RlY29yYXRvcnMvY3VycmVudC11c2VyLWlkLmRlY29yYXRvcic7XG5pbXBvcnQgeyBQdWJsaWMgfSBmcm9tICcuL2RlY29yYXRvcnMvcHVibGljLmRlY29yYXRvcic7XG5pbXBvcnQgeyBab2RWYWxpZGF0aW9uUGlwZSB9IGZyb20gJy4uL2NvbW1vbi9waXBlcy96b2QtdmFsaWRhdGlvbi5waXBlJztcbmltcG9ydCB7XG4gIExvZ2luRHRvU2NoZW1hLFxuICBSZWZyZXNoVG9rZW5EdG9TY2hlbWEsXG4gIFJlZ2lzdGVyVXNlckR0b1NjaGVtYSxcbiAgTG9nb3V0RHRvU2NoZW1hLFxuICBSZXF1ZXN0UGFzc3dvcmRSZXNldER0b1NjaGVtYSxcbiAgUmVzZXRQYXNzd29yZER0b1NjaGVtYSxcbiAgVmVyaWZ5RW1haWxEdG9TY2hlbWEsXG4gIFJlc2VuZFZlcmlmaWNhdGlvbkVtYWlsRHRvU2NoZW1hLFxuICBUZXJtaW5hdGVTZXNzaW9uRHRvU2NoZW1hLFxuICB0eXBlIExvZ2luRHRvLFxuICB0eXBlIFJlZnJlc2hUb2tlbkR0byxcbiAgdHlwZSBSZWdpc3RlclVzZXJEdG8sXG4gIHR5cGUgTG9nb3V0RHRvLFxuICB0eXBlIFJlcXVlc3RQYXNzd29yZFJlc2V0RHRvLFxuICB0eXBlIFJlc2V0UGFzc3dvcmREdG8sXG4gIHR5cGUgVmVyaWZ5RW1haWxEdG8sXG4gIHR5cGUgUmVzZW5kVmVyaWZpY2F0aW9uRW1haWxEdG8sXG4gIHR5cGUgVGVybWluYXRlU2Vzc2lvbkR0byxcbn0gZnJvbSAnbWVudGFyYS1jb21tb25zJztcbmltcG9ydCB7IEF1dGhTZXJ2aWNlIH0gZnJvbSAnLi9hdXRoLnNlcnZpY2UnO1xuaW1wb3J0IHsgRW1haWxWZXJpZmljYXRpb25TZXJ2aWNlIH0gZnJvbSAnLi9zZXJ2aWNlcy9lbWFpbC12ZXJpZmljYXRpb24uc2VydmljZSc7XG5pbXBvcnQgeyBQYXNzd29yZFJlc2V0U2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvcGFzc3dvcmQtcmVzZXQuc2VydmljZSc7XG5pbXBvcnQgeyBSZXF1ZXN0IH0gZnJvbSAnZXhwcmVzcyc7XG5cbkBBcGlUYWdzKCdhdXRoJylcbkBDb250cm9sbGVyKCdhdXRoJylcbmV4cG9ydCBjbGFzcyBBdXRoQ29udHJvbGxlciB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgcmVhZG9ubHkgYXV0aFNlcnZpY2U6IEF1dGhTZXJ2aWNlLFxuICAgIHByaXZhdGUgcmVhZG9ubHkgZW1haWxWZXJpZmljYXRpb25TZXJ2aWNlOiBFbWFpbFZlcmlmaWNhdGlvblNlcnZpY2UsXG4gICAgcHJpdmF0ZSByZWFkb25seSBwYXNzd29yZFJlc2V0U2VydmljZTogUGFzc3dvcmRSZXNldFNlcnZpY2UsXG4gICkge31cblxuICAvLyBSb2xlLXNwZWNpZmljIHJlZ2lzdHJhdGlvbiBlbmRwb2ludHMgbW92ZWQgdG8gZGVkaWNhdGVkIGNvbnRyb2xsZXJzOlxuICAvLyAtIC9hdXRoL2NsaWVudC9yZWdpc3RlclxuICAvLyAtIC9hdXRoL3RoZXJhcGlzdC9yZWdpc3RlclxuICAvLyAtIC9hdXRoL2FkbWluL2NyZWF0ZS1hY2NvdW50XG4gIC8vIC0gL2F1dGgvbW9kZXJhdG9yL2NyZWF0ZS1hY2NvdW50XG5cbiAgQFVzZUd1YXJkcyhKd3RBdXRoR3VhcmQpXG4gIEBBcGlCZWFyZXJBdXRoKCdKV1QtYXV0aCcpXG4gIEBBcGlPcGVyYXRpb24oe1xuICAgIHN1bW1hcnk6ICdHZXQgY3VycmVudCB1c2VyIHByb2ZpbGUnLFxuICAgIGRlc2NyaXB0aW9uOiBcIlJldHJpZXZlIHRoZSBhdXRoZW50aWNhdGVkIHVzZXIncyBwcm9maWxlIGluZm9ybWF0aW9uXCIsXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiAyMDAsXG4gICAgZGVzY3JpcHRpb246ICdVc2VyIHByb2ZpbGUgcmV0cmlldmVkIHN1Y2Nlc3NmdWxseScsXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiA0MDEsXG4gICAgZGVzY3JpcHRpb246ICdVbmF1dGhvcml6ZWQgLSBJbnZhbGlkIG9yIG1pc3NpbmcgSldUIHRva2VuJyxcbiAgfSlcbiAgQEdldCgnbWUnKVxuICBhc3luYyBnZXRNZShAQ3VycmVudFVzZXJJZCgpIGlkOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5hdXRoU2VydmljZS5nZXRVc2VyKGlkKTtcbiAgfVxuXG4gIEBVc2VHdWFyZHMoSnd0QXV0aEd1YXJkKVxuICBAR2V0KCd1c2VycycpXG4gIGFzeW5jIGdldEFsbFVzZXJzKCkge1xuICAgIHJldHVybiBhd2FpdCB0aGlzLmF1dGhTZXJ2aWNlLmdldFVzZXJzKCk7XG4gIH1cblxuICBAVXNlR3VhcmRzKEp3dEF1dGhHdWFyZClcbiAgQFRocm90dGxlKHsgZGVmYXVsdDogeyBsaW1pdDogMjAsIHR0bDogMzAwMDAwIH0gfSkgLy8gMjAgbG9nb3V0IGF0dGVtcHRzIHBlciA1IG1pbnV0ZXNcbiAgQFBvc3QoJ2ZvcmNlLWxvZ291dCcpXG4gIEBIdHRwQ29kZShIdHRwU3RhdHVzLk9LKVxuICBhc3luYyBmb3JjZUxvZ291dChAQ3VycmVudFVzZXJJZCgpIGlkOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5hdXRoU2VydmljZS5mb3JjZUxvZ291dChpZCk7XG4gIH1cblxuICAvLyBMb2NhbCBBdXRoZW50aWNhdGlvbiBFbmRwb2ludHNcbiAgQFB1YmxpYygpXG4gIEBBcGlPcGVyYXRpb24oe1xuICAgIHN1bW1hcnk6ICdSZWdpc3RlciBuZXcgdXNlcicsXG4gICAgZGVzY3JpcHRpb246XG4gICAgICAnUmVnaXN0ZXIgYSBuZXcgdXNlciBhY2NvdW50IHdpdGggZW1haWwgYW5kIHBhc3N3b3JkLiBTdXBwb3J0cyBjbGllbnQgYW5kIHRoZXJhcGlzdCByb2xlcyBvbmx5LicsXG4gIH0pXG4gIEBBcGlCb2R5KHtcbiAgICBkZXNjcmlwdGlvbjogJ1VzZXIgcmVnaXN0cmF0aW9uIGRldGFpbHMnLFxuICAgIHNjaGVtYToge1xuICAgICAgdHlwZTogJ29iamVjdCcsXG4gICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGVtYWlsOiB7IHR5cGU6ICdzdHJpbmcnLCBmb3JtYXQ6ICdlbWFpbCcsIGV4YW1wbGU6ICd1c2VyQGV4YW1wbGUuY29tJyB9LFxuICAgICAgICBwYXNzd29yZDoge1xuICAgICAgICAgIHR5cGU6ICdzdHJpbmcnLFxuICAgICAgICAgIG1pbkxlbmd0aDogOCxcbiAgICAgICAgICBleGFtcGxlOiAnU2VjdXJlUGFzc3dvcmQxMjMhJyxcbiAgICAgICAgfSxcbiAgICAgICAgZmlyc3ROYW1lOiB7IHR5cGU6ICdzdHJpbmcnLCBleGFtcGxlOiAnSm9obicgfSxcbiAgICAgICAgbGFzdE5hbWU6IHsgdHlwZTogJ3N0cmluZycsIGV4YW1wbGU6ICdEb2UnIH0sXG4gICAgICAgIHJvbGU6IHtcbiAgICAgICAgICB0eXBlOiAnc3RyaW5nJyxcbiAgICAgICAgICBlbnVtOiBbJ2NsaWVudCcsICd0aGVyYXBpc3QnXSxcbiAgICAgICAgICBleGFtcGxlOiAnY2xpZW50JyxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICByZXF1aXJlZDogWydlbWFpbCcsICdwYXNzd29yZCcsICdmaXJzdE5hbWUnLCAnbGFzdE5hbWUnLCAncm9sZSddLFxuICAgIH0sXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiAyMDEsXG4gICAgZGVzY3JpcHRpb246ICdVc2VyIHJlZ2lzdGVyZWQgc3VjY2Vzc2Z1bGx5JyxcbiAgICBzY2hlbWE6IHtcbiAgICAgIHR5cGU6ICdvYmplY3QnLFxuICAgICAgcHJvcGVydGllczoge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgdHlwZTogJ29iamVjdCcsXG4gICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgaWQ6IHsgdHlwZTogJ3N0cmluZycgfSxcbiAgICAgICAgICAgIGVtYWlsOiB7IHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICAgICAgICBmaXJzdE5hbWU6IHsgdHlwZTogJ3N0cmluZycgfSxcbiAgICAgICAgICAgIGxhc3ROYW1lOiB7IHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICAgICAgICByb2xlOiB7IHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgYWNjZXNzVG9rZW46IHsgdHlwZTogJ3N0cmluZycgfSxcbiAgICAgICAgcmVmcmVzaFRva2VuOiB7IHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICB9LFxuICAgIH0sXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiA0MDAsXG4gICAgZGVzY3JpcHRpb246ICdCYWQgcmVxdWVzdCAtIEludmFsaWQgaW5wdXQgZGF0YScsXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiA0MDksXG4gICAgZGVzY3JpcHRpb246ICdDb25mbGljdCAtIEVtYWlsIGFscmVhZHkgZXhpc3RzJyxcbiAgfSlcbiAgQFRocm90dGxlKHsgZGVmYXVsdDogeyBsaW1pdDogNSwgdHRsOiAzMDAwMDAgfSB9KSAvLyA1IHJlZ2lzdHJhdGlvbiBhdHRlbXB0cyBwZXIgNSBtaW51dGVzXG4gIEBQb3N0KCdyZWdpc3RlcicpXG4gIEBIdHRwQ29kZShIdHRwU3RhdHVzLkNSRUFURUQpXG4gIGFzeW5jIHJlZ2lzdGVyKFxuICAgIEBCb2R5KG5ldyBab2RWYWxpZGF0aW9uUGlwZShSZWdpc3RlclVzZXJEdG9TY2hlbWEpKVxuICAgIHJlZ2lzdGVyRHRvOiBSZWdpc3RlclVzZXJEdG8sXG4gICkge1xuICAgIC8vIE9ubHkgYWxsb3cgY2xpZW50IGFuZCB0aGVyYXBpc3Qgcm9sZXMgZm9yIGdlbmVyYWwgcmVnaXN0cmF0aW9uXG4gICAgY29uc3QgYWxsb3dlZFJvbGUgPVxuICAgICAgcmVnaXN0ZXJEdG8ucm9sZSA9PT0gJ3RoZXJhcGlzdCcgPyAndGhlcmFwaXN0JyA6ICdjbGllbnQnO1xuXG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuYXV0aFNlcnZpY2UucmVnaXN0ZXJVc2VyV2l0aEVtYWlsKFxuICAgICAgcmVnaXN0ZXJEdG8uZW1haWwsXG4gICAgICByZWdpc3RlckR0by5wYXNzd29yZCxcbiAgICAgIHJlZ2lzdGVyRHRvLmZpcnN0TmFtZSxcbiAgICAgIHJlZ2lzdGVyRHRvLmxhc3ROYW1lLFxuICAgICAgYWxsb3dlZFJvbGUsXG4gICAgKTtcbiAgfVxuXG4gIEBQdWJsaWMoKVxuICBAQXBpT3BlcmF0aW9uKHtcbiAgICBzdW1tYXJ5OiAnVXNlciBsb2dpbicsXG4gICAgZGVzY3JpcHRpb246XG4gICAgICAnQXV0aGVudGljYXRlIHVzZXIgd2l0aCBlbWFpbCBhbmQgcGFzc3dvcmQsIHJldHVybmluZyBKV1QgdG9rZW5zJyxcbiAgfSlcbiAgQEFwaUJvZHkoe1xuICAgIGRlc2NyaXB0aW9uOiAnTG9naW4gY3JlZGVudGlhbHMnLFxuICAgIHNjaGVtYToge1xuICAgICAgdHlwZTogJ29iamVjdCcsXG4gICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGVtYWlsOiB7IHR5cGU6ICdzdHJpbmcnLCBmb3JtYXQ6ICdlbWFpbCcsIGV4YW1wbGU6ICd1c2VyQGV4YW1wbGUuY29tJyB9LFxuICAgICAgICBwYXNzd29yZDogeyB0eXBlOiAnc3RyaW5nJywgZXhhbXBsZTogJ1NlY3VyZVBhc3N3b3JkMTIzIScgfSxcbiAgICAgIH0sXG4gICAgICByZXF1aXJlZDogWydlbWFpbCcsICdwYXNzd29yZCddLFxuICAgIH0sXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiAyMDAsXG4gICAgZGVzY3JpcHRpb246ICdMb2dpbiBzdWNjZXNzZnVsJyxcbiAgICBzY2hlbWE6IHtcbiAgICAgIHR5cGU6ICdvYmplY3QnLFxuICAgICAgcHJvcGVydGllczoge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgdHlwZTogJ29iamVjdCcsXG4gICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgaWQ6IHsgdHlwZTogJ3N0cmluZycgfSxcbiAgICAgICAgICAgIGVtYWlsOiB7IHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICAgICAgICBmaXJzdE5hbWU6IHsgdHlwZTogJ3N0cmluZycgfSxcbiAgICAgICAgICAgIGxhc3ROYW1lOiB7IHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICAgICAgICByb2xlOiB7IHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB7IHR5cGU6ICdib29sZWFuJyB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIGFjY2Vzc1Rva2VuOiB7IHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICAgIHJlZnJlc2hUb2tlbjogeyB0eXBlOiAnc3RyaW5nJyB9LFxuICAgICAgICBleHBpcmVzSW46IHsgdHlwZTogJ251bWJlcicgfSxcbiAgICAgIH0sXG4gICAgfSxcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHtcbiAgICBzdGF0dXM6IDQwMSxcbiAgICBkZXNjcmlwdGlvbjogJ1VuYXV0aG9yaXplZCAtIEludmFsaWQgY3JlZGVudGlhbHMnLFxuICB9KVxuICBAQXBpUmVzcG9uc2Uoe1xuICAgIHN0YXR1czogNDI5LFxuICAgIGRlc2NyaXB0aW9uOiAnVG9vIG1hbnkgbG9naW4gYXR0ZW1wdHMnLFxuICB9KVxuICBAVGhyb3R0bGUoeyBkZWZhdWx0OiB7IGxpbWl0OiAxMCwgdHRsOiAzMDAwMDAgfSB9KSAvLyAxMCBsb2dpbiBhdHRlbXB0cyBwZXIgNSBtaW51dGVzXG4gIEBQb3N0KCdsb2dpbicpXG4gIEBIdHRwQ29kZShIdHRwU3RhdHVzLk9LKVxuICBhc3luYyBsb2dpbihcbiAgICBAQm9keShuZXcgWm9kVmFsaWRhdGlvblBpcGUoTG9naW5EdG9TY2hlbWEpKSBsb2dpbkR0bzogTG9naW5EdG8sXG4gICAgQFJlcSgpIHJlcTogUmVxdWVzdCxcbiAgKSB7XG4gICAgY29uc3QgaXBBZGRyZXNzID0gcmVxLmlwO1xuICAgIGNvbnN0IHVzZXJBZ2VudCA9IHJlcS5nZXQoJ1VzZXItQWdlbnQnKTtcblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuYXV0aFNlcnZpY2UubG9naW5XaXRoRW1haWwoXG4gICAgICBsb2dpbkR0by5lbWFpbCxcbiAgICAgIGxvZ2luRHRvLnBhc3N3b3JkLFxuICAgICAgaXBBZGRyZXNzLFxuICAgICAgdXNlckFnZW50LFxuICAgICk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgdXNlcjoge1xuICAgICAgICBpZDogcmVzdWx0LnVzZXIuaWQsXG4gICAgICAgIGVtYWlsOiByZXN1bHQudXNlci5lbWFpbCxcbiAgICAgICAgZmlyc3ROYW1lOiByZXN1bHQudXNlci5maXJzdE5hbWUsXG4gICAgICAgIGxhc3ROYW1lOiByZXN1bHQudXNlci5sYXN0TmFtZSxcbiAgICAgICAgcm9sZTogcmVzdWx0LnVzZXIucm9sZSxcbiAgICAgICAgZW1haWxWZXJpZmllZDogcmVzdWx0LnVzZXIuZW1haWxWZXJpZmllZCxcbiAgICAgIH0sXG4gICAgICBhY2Nlc3NUb2tlbjogcmVzdWx0LnRva2Vucy5hY2Nlc3NUb2tlbixcbiAgICAgIHJlZnJlc2hUb2tlbjogcmVzdWx0LnRva2Vucy5yZWZyZXNoVG9rZW4sXG4gICAgICBleHBpcmVzSW46IHJlc3VsdC50b2tlbnMuZXhwaXJlc0luLFxuICAgIH07XG4gIH1cblxuICBAUHVibGljKClcbiAgQFRocm90dGxlKHsgZGVmYXVsdDogeyBsaW1pdDogMjAsIHR0bDogMzAwMDAwIH0gfSkgLy8gMjAgcmVmcmVzaCBhdHRlbXB0cyBwZXIgNSBtaW51dGVzXG4gIEBQb3N0KCdyZWZyZXNoJylcbiAgQEh0dHBDb2RlKEh0dHBTdGF0dXMuT0spXG4gIGFzeW5jIHJlZnJlc2hUb2tlbnMoXG4gICAgQEJvZHkobmV3IFpvZFZhbGlkYXRpb25QaXBlKFJlZnJlc2hUb2tlbkR0b1NjaGVtYSkpXG4gICAgcmVmcmVzaER0bzogUmVmcmVzaFRva2VuRHRvLFxuICAgIEBSZXEoKSByZXE6IFJlcXVlc3QsXG4gICkge1xuICAgIGlmICghcmVmcmVzaER0by5yZWZyZXNoVG9rZW4pIHtcbiAgICAgIHRocm93IG5ldyBVbmF1dGhvcml6ZWRFeGNlcHRpb24oJ1JlZnJlc2ggdG9rZW4gcmVxdWlyZWQnKTtcbiAgICB9XG5cbiAgICBjb25zdCBpcEFkZHJlc3MgPSByZXEuaXA7XG4gICAgY29uc3QgdXNlckFnZW50ID0gcmVxLmdldCgnVXNlci1BZ2VudCcpO1xuXG4gICAgY29uc3QgdG9rZW5zID0gYXdhaXQgdGhpcy5hdXRoU2VydmljZS5yZWZyZXNoVG9rZW5zKFxuICAgICAgcmVmcmVzaER0by5yZWZyZXNoVG9rZW4sXG4gICAgICBpcEFkZHJlc3MsXG4gICAgICB1c2VyQWdlbnQsXG4gICAgKTtcblxuICAgIHJldHVybiB0b2tlbnM7XG4gIH1cblxuICBAVXNlR3VhcmRzKEp3dEF1dGhHdWFyZClcbiAgQFBvc3QoJ2xvZ291dCcpXG4gIEBIdHRwQ29kZShIdHRwU3RhdHVzLk9LKVxuICBhc3luYyBsb2dvdXQoXG4gICAgQEJvZHkobmV3IFpvZFZhbGlkYXRpb25QaXBlKExvZ291dER0b1NjaGVtYSkpIGxvZ291dER0bzogTG9nb3V0RHRvLFxuICApIHtcbiAgICBpZiAobG9nb3V0RHRvLnJlZnJlc2hUb2tlbikge1xuICAgICAgYXdhaXQgdGhpcy5hdXRoU2VydmljZS5sb2dvdXQobG9nb3V0RHRvLnJlZnJlc2hUb2tlbik7XG4gICAgfVxuICAgIHJldHVybiB7IG1lc3NhZ2U6ICdMb2dnZWQgb3V0IHN1Y2Nlc3NmdWxseScgfTtcbiAgfVxuXG4gIEBVc2VHdWFyZHMoSnd0QXV0aEd1YXJkKVxuICBAR2V0KCdwcm9maWxlJylcbiAgYXN5bmMgZ2V0UHJvZmlsZShAQ3VycmVudFVzZXJJZCgpIHVzZXJJZDogc3RyaW5nKSB7XG4gICAgY29uc3QgdXNlciA9IGF3YWl0IHRoaXMuYXV0aFNlcnZpY2UudmFsaWRhdGVVc2VyKHVzZXJJZCk7XG4gICAgaWYgKCF1c2VyKSB7XG4gICAgICB0aHJvdyBuZXcgVW5hdXRob3JpemVkRXhjZXB0aW9uKCdVc2VyIG5vdCBmb3VuZCcpO1xuICAgIH1cbiAgICByZXR1cm4gdXNlcjtcbiAgfVxuXG4gIC8vIFJvbGUtc3BlY2lmaWMgcHJvZmlsZSBlbmRwb2ludHMgbW92ZWQgdG8gZGVkaWNhdGVkIGNvbnRyb2xsZXJzOlxuICAvLyAtIC9hdXRoL2NsaWVudC9wcm9maWxlXG4gIC8vIC0gL2F1dGgvdGhlcmFwaXN0L3Byb2ZpbGVcbiAgLy8gLSAvYXV0aC9hZG1pbi9wcm9maWxlXG4gIC8vIC0gL2F1dGgvbW9kZXJhdG9yL3Byb2ZpbGVcblxuICAvLyA9PT09PSBQQVNTV09SRCBSRVNFVCBFTkRQT0lOVFMgPT09PT1cblxuICBAUHVibGljKClcbiAgQFRocm90dGxlKHsgZGVmYXVsdDogeyBsaW1pdDogNSwgdHRsOiAzMDAwMDAgfSB9KSAvLyA1IHJlc2V0IHJlcXVlc3RzIHBlciA1IG1pbnV0ZXNcbiAgQFBvc3QoJ3JlcXVlc3QtcGFzc3dvcmQtcmVzZXQnKVxuICBASHR0cENvZGUoSHR0cFN0YXR1cy5PSylcbiAgYXN5bmMgcmVxdWVzdFBhc3N3b3JkUmVzZXQoXG4gICAgQEJvZHkobmV3IFpvZFZhbGlkYXRpb25QaXBlKFJlcXVlc3RQYXNzd29yZFJlc2V0RHRvU2NoZW1hKSlcbiAgICByZXF1ZXN0UmVzZXREdG86IFJlcXVlc3RQYXNzd29yZFJlc2V0RHRvLFxuICApIHtcbiAgICBhd2FpdCB0aGlzLnBhc3N3b3JkUmVzZXRTZXJ2aWNlLnJlcXVlc3RQYXNzd29yZFJlc2V0KHJlcXVlc3RSZXNldER0by5lbWFpbCk7XG4gICAgcmV0dXJuIHtcbiAgICAgIG1lc3NhZ2U6XG4gICAgICAgICdJZiBhbiBhY2NvdW50IHdpdGggdGhhdCBlbWFpbCBleGlzdHMsIHdlIHdpbGwgc2VuZCBhIHBhc3N3b3JkIHJlc2V0IGxpbmsuJyxcbiAgICB9O1xuICB9XG5cbiAgQFB1YmxpYygpXG4gIEBUaHJvdHRsZSh7IGRlZmF1bHQ6IHsgbGltaXQ6IDEwLCB0dGw6IDMwMDAwMCB9IH0pIC8vIDEwIHJlc2V0IGF0dGVtcHRzIHBlciA1IG1pbnV0ZXNcbiAgQFBvc3QoJ3Jlc2V0LXBhc3N3b3JkJylcbiAgQEh0dHBDb2RlKEh0dHBTdGF0dXMuT0spXG4gIGFzeW5jIHJlc2V0UGFzc3dvcmQoXG4gICAgQEJvZHkobmV3IFpvZFZhbGlkYXRpb25QaXBlKFJlc2V0UGFzc3dvcmREdG9TY2hlbWEpKVxuICAgIHJlc2V0RHRvOiBSZXNldFBhc3N3b3JkRHRvLFxuICApIHtcbiAgICAvLyBWYWxpZGF0ZSB0aGF0IHBhc3N3b3JkcyBtYXRjaFxuICAgIGlmIChyZXNldER0by5uZXdQYXNzd29yZCAhPT0gcmVzZXREdG8uY29uZmlybVBhc3N3b3JkKSB7XG4gICAgICB0aHJvdyBuZXcgVW5hdXRob3JpemVkRXhjZXB0aW9uKCdQYXNzd29yZHMgZG8gbm90IG1hdGNoJyk7XG4gICAgfVxuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5wYXNzd29yZFJlc2V0U2VydmljZS5yZXNldFBhc3N3b3JkKFxuICAgICAgcmVzZXREdG8udG9rZW4sXG4gICAgICByZXNldER0by5uZXdQYXNzd29yZCxcbiAgICApO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICBAUHVibGljKClcbiAgQEdldCgndmFsaWRhdGUtcmVzZXQtdG9rZW4nKVxuICBhc3luYyB2YWxpZGF0ZVJlc2V0VG9rZW4oQFF1ZXJ5KCd0b2tlbicpIHRva2VuOiBzdHJpbmcpIHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnBhc3N3b3JkUmVzZXRTZXJ2aWNlLnZhbGlkYXRlUmVzZXRUb2tlbih0b2tlbik7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8vID09PT09IEpXVCBUT0tFTiBWQUxJREFUSU9OIEVORFBPSU5UID09PT09XG5cbiAgQFB1YmxpYygpXG4gIEBBcGlPcGVyYXRpb24oe1xuICAgIHN1bW1hcnk6ICdWYWxpZGF0ZSBKV1QgdG9rZW4nLFxuICAgIGRlc2NyaXB0aW9uOiAnVmFsaWRhdGUgYSBKV1QgdG9rZW4gYW5kIHJldHVybiB1c2VyIGluZm9ybWF0aW9uIGlmIHZhbGlkJyxcbiAgfSlcbiAgQEFwaUJvZHkoe1xuICAgIGRlc2NyaXB0aW9uOiAnSldUIHRva2VuIHRvIHZhbGlkYXRlJyxcbiAgICBzY2hlbWE6IHtcbiAgICAgIHR5cGU6ICdvYmplY3QnLFxuICAgICAgcHJvcGVydGllczoge1xuICAgICAgICB0b2tlbjoge1xuICAgICAgICAgIHR5cGU6ICdzdHJpbmcnLFxuICAgICAgICAgIGV4YW1wbGU6ICdleUpoYkdjaU9pSklVekkxTmlJc0luUjVjQ0k2SWtwWFZDSjkuLi4nLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIHJlcXVpcmVkOiBbJ3Rva2VuJ10sXG4gICAgfSxcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHtcbiAgICBzdGF0dXM6IDIwMCxcbiAgICBkZXNjcmlwdGlvbjogJ1Rva2VuIHZhbGlkYXRpb24gcmVzdWx0JyxcbiAgICBzY2hlbWE6IHtcbiAgICAgIHR5cGU6ICdvYmplY3QnLFxuICAgICAgcHJvcGVydGllczoge1xuICAgICAgICB2YWxpZDogeyB0eXBlOiAnYm9vbGVhbicgfSxcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIHR5cGU6ICdvYmplY3QnLFxuICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgIGlkOiB7IHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICAgICAgICBlbWFpbDogeyB0eXBlOiAnc3RyaW5nJyB9LFxuICAgICAgICAgICAgZmlyc3ROYW1lOiB7IHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICAgICAgICBsYXN0TmFtZTogeyB0eXBlOiAnc3RyaW5nJyB9LFxuICAgICAgICAgICAgcm9sZTogeyB0eXBlOiAnc3RyaW5nJyB9LFxuICAgICAgICAgICAgZW1haWxWZXJpZmllZDogeyB0eXBlOiAnYm9vbGVhbicgfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBleHBpcmVzOiB7IHR5cGU6ICdzdHJpbmcnLCBmb3JtYXQ6ICdkYXRlLXRpbWUnIH0sXG4gICAgICB9LFxuICAgIH0sXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiA0MDAsXG4gICAgZGVzY3JpcHRpb246ICdCYWQgcmVxdWVzdCAtIFRva2VuIGlzIHJlcXVpcmVkJyxcbiAgfSlcbiAgQFRocm90dGxlKHsgZGVmYXVsdDogeyBsaW1pdDogMTAwLCB0dGw6IDYwMDAwIH0gfSkgLy8gMTAwIHZhbGlkYXRpb24gcmVxdWVzdHMgcGVyIG1pbnV0ZVxuICBAUG9zdCgndmFsaWRhdGUtdG9rZW4nKVxuICBASHR0cENvZGUoSHR0cFN0YXR1cy5PSylcbiAgYXN5bmMgdmFsaWRhdGVUb2tlbihAQm9keSgpIGJvZHk6IHsgdG9rZW46IHN0cmluZyB9KSB7XG4gICAgaWYgKCFib2R5LnRva2VuKSB7XG4gICAgICB0aHJvdyBuZXcgVW5hdXRob3JpemVkRXhjZXB0aW9uKCdUb2tlbiBpcyByZXF1aXJlZCcpO1xuICAgIH1cblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuYXV0aFNlcnZpY2UudmFsaWRhdGVUb2tlbihib2R5LnRva2VuKTtcblxuICAgIGlmICghcmVzdWx0LnZhbGlkKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgIGVycm9yOiByZXN1bHQuZXJyb3IsXG4gICAgICB9O1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICB2YWxpZDogdHJ1ZSxcbiAgICAgIHVzZXI6IHJlc3VsdC51c2VyLFxuICAgICAgZXhwaXJlczogcmVzdWx0LmV4cGlyZXMsXG4gICAgfTtcbiAgfVxuXG4gIC8vID09PT09IFVTRVIgRVhJU1RFTkNFIENIRUNLIEVORFBPSU5UID09PT09XG5cbiAgQFB1YmxpYygpXG4gIEBBcGlPcGVyYXRpb24oe1xuICAgIHN1bW1hcnk6ICdDaGVjayB1c2VyIGV4aXN0ZW5jZSBieSBlbWFpbCcsXG4gICAgZGVzY3JpcHRpb246XG4gICAgICAnQ2hlY2sgaWYgYSB1c2VyIGV4aXN0cyBieSBlbWFpbCBhZGRyZXNzIGFuZCByZXR1cm4gdGhlaXIgcm9sZSBhbmQgdmVyaWZpY2F0aW9uIHN0YXR1cycsXG4gIH0pXG4gIEBBcGlRdWVyeSh7XG4gICAgbmFtZTogJ2VtYWlsJyxcbiAgICBkZXNjcmlwdGlvbjogJ0VtYWlsIGFkZHJlc3MgdG8gY2hlY2snLFxuICAgIGV4YW1wbGU6ICd1c2VyQGV4YW1wbGUuY29tJyxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHtcbiAgICBzdGF0dXM6IDIwMCxcbiAgICBkZXNjcmlwdGlvbjogJ1VzZXIgZXhpc3RlbmNlIGNoZWNrIHJlc3VsdCcsXG4gICAgc2NoZW1hOiB7XG4gICAgICB0eXBlOiAnb2JqZWN0JyxcbiAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgZXhpc3RzOiB7IHR5cGU6ICdib29sZWFuJyB9LFxuICAgICAgICByb2xlOiB7XG4gICAgICAgICAgdHlwZTogJ3N0cmluZycsXG4gICAgICAgICAgZW51bTogWydjbGllbnQnLCAndGhlcmFwaXN0JywgJ21vZGVyYXRvcicsICdhZG1pbiddLFxuICAgICAgICB9LFxuICAgICAgICBpc1ZlcmlmaWVkOiB7IHR5cGU6ICdib29sZWFuJyB9LFxuICAgICAgfSxcbiAgICAgIHJlcXVpcmVkOiBbJ2V4aXN0cyddLFxuICAgIH0sXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiA0MDAsXG4gICAgZGVzY3JpcHRpb246ICdCYWQgcmVxdWVzdCAtIEludmFsaWQgZW1haWwgZm9ybWF0JyxcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHtcbiAgICBzdGF0dXM6IDQyOSxcbiAgICBkZXNjcmlwdGlvbjogJ1RvbyBtYW55IHJlcXVlc3RzJyxcbiAgfSlcbiAgQFRocm90dGxlKHsgZGVmYXVsdDogeyBsaW1pdDogMzAsIHR0bDogNjAwMDAgfSB9KSAvLyAzMCByZXF1ZXN0cyBwZXIgbWludXRlXG4gIEBHZXQoJ2NoZWNrLXVzZXInKVxuICBhc3luYyBjaGVja1VzZXJFeGlzdHMoQFF1ZXJ5KCdlbWFpbCcpIGVtYWlsOiBzdHJpbmcpIHtcbiAgICBpZiAoIWVtYWlsKSB7XG4gICAgICB0aHJvdyBuZXcgVW5hdXRob3JpemVkRXhjZXB0aW9uKCdFbWFpbCBpcyByZXF1aXJlZCcpO1xuICAgIH1cblxuICAgIC8vIEJhc2ljIGVtYWlsIHZhbGlkYXRpb25cbiAgICBjb25zdCBlbWFpbFJlZ2V4ID0gL15bXlxcc0BdK0BbXlxcc0BdK1xcLlteXFxzQF0rJC87XG4gICAgaWYgKCFlbWFpbFJlZ2V4LnRlc3QoZW1haWwpKSB7XG4gICAgICB0aHJvdyBuZXcgVW5hdXRob3JpemVkRXhjZXB0aW9uKCdJbnZhbGlkIGVtYWlsIGZvcm1hdCcpO1xuICAgIH1cblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuYXV0aFNlcnZpY2UuY2hlY2tVc2VyRXhpc3RzKGVtYWlsKTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLy8gPT09PT0gRU1BSUwgVkVSSUZJQ0FUSU9OIEVORFBPSU5UUyA9PT09PVxuXG4gIEBVc2VHdWFyZHMoSnd0QXV0aEd1YXJkKVxuICBAVGhyb3R0bGUoeyBkZWZhdWx0OiB7IGxpbWl0OiAzLCB0dGw6IDMwMDAwMCB9IH0pIC8vIDMgdmVyaWZpY2F0aW9uIGVtYWlscyBwZXIgNSBtaW51dGVzXG4gIEBQb3N0KCdzZW5kLXZlcmlmaWNhdGlvbi1lbWFpbCcpXG4gIEBIdHRwQ29kZShIdHRwU3RhdHVzLk9LKVxuICBhc3luYyBzZW5kVmVyaWZpY2F0aW9uRW1haWwoQEN1cnJlbnRVc2VySWQoKSB1c2VySWQ6IHN0cmluZykge1xuICAgIGF3YWl0IHRoaXMuZW1haWxWZXJpZmljYXRpb25TZXJ2aWNlLnNlbmRWZXJpZmljYXRpb25FbWFpbCh1c2VySWQpO1xuICAgIHJldHVybiB7XG4gICAgICBtZXNzYWdlOiAnVmVyaWZpY2F0aW9uIGVtYWlsIHNlbnQgc3VjY2Vzc2Z1bGx5JyxcbiAgICB9O1xuICB9XG5cbiAgQFB1YmxpYygpXG4gIEBUaHJvdHRsZSh7IGRlZmF1bHQ6IHsgbGltaXQ6IDUsIHR0bDogMzAwMDAwIH0gfSkgLy8gNSByZXNlbmQgYXR0ZW1wdHMgcGVyIDUgbWludXRlc1xuICBAUG9zdCgncmVzZW5kLXZlcmlmaWNhdGlvbi1lbWFpbCcpXG4gIEBIdHRwQ29kZShIdHRwU3RhdHVzLk9LKVxuICBhc3luYyByZXNlbmRWZXJpZmljYXRpb25FbWFpbChcbiAgICBAQm9keShuZXcgWm9kVmFsaWRhdGlvblBpcGUoUmVzZW5kVmVyaWZpY2F0aW9uRW1haWxEdG9TY2hlbWEpKVxuICAgIHJlc2VuZER0bzogUmVzZW5kVmVyaWZpY2F0aW9uRW1haWxEdG8sXG4gICkge1xuICAgIGF3YWl0IHRoaXMuZW1haWxWZXJpZmljYXRpb25TZXJ2aWNlLnJlc2VuZFZlcmlmaWNhdGlvbkVtYWlsKFxuICAgICAgcmVzZW5kRHRvLmVtYWlsLFxuICAgICk7XG4gICAgcmV0dXJuIHtcbiAgICAgIG1lc3NhZ2U6XG4gICAgICAgICdJZiBhbiBhY2NvdW50IHdpdGggdGhhdCBlbWFpbCBleGlzdHMsIHdlIHdpbGwgc2VuZCBhIHZlcmlmaWNhdGlvbiBsaW5rLicsXG4gICAgfTtcbiAgfVxuXG4gIEBQdWJsaWMoKVxuICBAUG9zdCgndmVyaWZ5LWVtYWlsJylcbiAgQEh0dHBDb2RlKEh0dHBTdGF0dXMuT0spXG4gIGFzeW5jIHZlcmlmeUVtYWlsKFxuICAgIEBCb2R5KG5ldyBab2RWYWxpZGF0aW9uUGlwZShWZXJpZnlFbWFpbER0b1NjaGVtYSkpXG4gICAgdmVyaWZ5RHRvOiBWZXJpZnlFbWFpbER0byxcbiAgKSB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5lbWFpbFZlcmlmaWNhdGlvblNlcnZpY2UudmVyaWZ5RW1haWwoXG4gICAgICB2ZXJpZnlEdG8udG9rZW4sXG4gICAgKTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLy8gR29vZ2xlIE9BdXRoIFJvdXRlc1xuICBAUHVibGljKClcbiAgQEdldCgnZ29vZ2xlJylcbiAgQFVzZUd1YXJkcyhBdXRoR3VhcmQoJ2dvb2dsZScpKVxuICBhc3luYyBnb29nbGVBdXRoKCkge1xuICAgIC8vIEluaXRpYXRlcyBHb29nbGUgT0F1dGggZmxvd1xuICB9XG5cbiAgQFB1YmxpYygpXG4gIEBHZXQoJ2dvb2dsZS9jYWxsYmFjaycpXG4gIEBVc2VHdWFyZHMoQXV0aEd1YXJkKCdnb29nbGUnKSlcbiAgYXN5bmMgZ29vZ2xlQXV0aFJlZGlyZWN0KEBSZXEoKSByZXEsIEBSZXMoKSByZXMsIEBRdWVyeSgpIHF1ZXJ5KSB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIEdldCByb2xlIGZyb20gc3RhdGUgcGFyYW1ldGVyIGlmIHByb3ZpZGVkIChmb3Igcm9sZS1zcGVjaWZpYyBPQXV0aCBmbG93cylcbiAgICAgIGNvbnN0IHJvbGUgPSBxdWVyeS5zdGF0ZSB8fCAnY2xpZW50JzsgLy8gRGVmYXVsdCB0byBjbGllbnQgaWYgbm8gcm9sZSBzcGVjaWZpZWRcblxuICAgICAgLy8gSGFuZGxlIEdvb2dsZSBPQXV0aCBjYWxsYmFjayBhbmQgZ2V0IHRva2Vuc1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5hdXRoU2VydmljZS5oYW5kbGVPQXV0aExvZ2luKFxuICAgICAgICByZXEudXNlcixcbiAgICAgICAgJ2dvb2dsZScsXG4gICAgICAgIHJvbGUsXG4gICAgICApO1xuXG4gICAgICAvLyBFeHRyYWN0IHRva2VucyBmcm9tIHJlc3VsdFxuICAgICAgY29uc3QgeyBhY2Nlc3NUb2tlbiwgcmVmcmVzaFRva2VuIH0gPSByZXN1bHQ7XG5cbiAgICAgIC8vIERldGVybWluZSBmcm9udGVuZCByZWRpcmVjdCBVUkwgYmFzZWQgb24gZW52aXJvbm1lbnRcbiAgICAgIGNvbnN0IGZyb250ZW5kVXJsID0gcHJvY2Vzcy5lbnYuRlJPTlRFTkRfVVJMIHx8ICdodHRwOi8vbG9jYWxob3N0OjMwMDAnO1xuICAgICAgY29uc3QgcmVkaXJlY3RVcmwgPSBgJHtmcm9udGVuZFVybH0vc3NvLWNhbGxiYWNrP3Rva2VuPSR7YWNjZXNzVG9rZW59JnJlZnJlc2hfdG9rZW49JHtyZWZyZXNoVG9rZW59JnJvbGU9JHtyb2xlfWA7XG5cbiAgICAgIC8vIFJlZGlyZWN0IHRvIGZyb250ZW5kIHdpdGggdG9rZW5zIGluIFVSTCBwYXJhbWV0ZXJzXG4gICAgICByZXR1cm4gcmVzLnJlZGlyZWN0KHJlZGlyZWN0VXJsKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignR29vZ2xlIE9BdXRoIGNhbGxiYWNrIGVycm9yOicsIGVycm9yKTtcblxuICAgICAgLy8gUmVkaXJlY3QgdG8gZnJvbnRlbmQgd2l0aCBlcnJvclxuICAgICAgY29uc3QgZnJvbnRlbmRVcmwgPSBwcm9jZXNzLmVudi5GUk9OVEVORF9VUkwgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMCc7XG4gICAgICBjb25zdCBlcnJvclVybCA9IGAke2Zyb250ZW5kVXJsfS9hdXRoL3NpZ24taW4/ZXJyb3I9b2F1dGhfZmFpbGVkJnByb3ZpZGVyPWdvb2dsZWA7XG4gICAgICByZXR1cm4gcmVzLnJlZGlyZWN0KGVycm9yVXJsKTtcbiAgICB9XG4gIH1cblxuICAvLyBNaWNyb3NvZnQgT0F1dGggUm91dGVzXG4gIEBQdWJsaWMoKVxuICBAR2V0KCdtaWNyb3NvZnQnKVxuICBAVXNlR3VhcmRzKEF1dGhHdWFyZCgnbWljcm9zb2Z0JykpXG4gIGFzeW5jIG1pY3Jvc29mdEF1dGgoKSB7XG4gICAgLy8gSW5pdGlhdGVzIE1pY3Jvc29mdCBPQXV0aCBmbG93XG4gIH1cblxuICBAUHVibGljKClcbiAgQEdldCgnbWljcm9zb2Z0L2NhbGxiYWNrJylcbiAgQFVzZUd1YXJkcyhBdXRoR3VhcmQoJ21pY3Jvc29mdCcpKVxuICBhc3luYyBtaWNyb3NvZnRBdXRoUmVkaXJlY3QoQFJlcSgpIHJlcSwgQFJlcygpIHJlcywgQFF1ZXJ5KCkgcXVlcnkpIHtcbiAgICB0cnkge1xuICAgICAgLy8gR2V0IHJvbGUgZnJvbSBzdGF0ZSBwYXJhbWV0ZXIgaWYgcHJvdmlkZWQgKGZvciByb2xlLXNwZWNpZmljIE9BdXRoIGZsb3dzKVxuICAgICAgY29uc3Qgcm9sZSA9IHF1ZXJ5LnN0YXRlIHx8ICdjbGllbnQnOyAvLyBEZWZhdWx0IHRvIGNsaWVudCBpZiBubyByb2xlIHNwZWNpZmllZFxuXG4gICAgICAvLyBIYW5kbGUgTWljcm9zb2Z0IE9BdXRoIGNhbGxiYWNrIGFuZCBnZXQgdG9rZW5zXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmF1dGhTZXJ2aWNlLmhhbmRsZU9BdXRoTG9naW4oXG4gICAgICAgIHJlcS51c2VyLFxuICAgICAgICAnbWljcm9zb2Z0JyxcbiAgICAgICAgcm9sZSxcbiAgICAgICk7XG5cbiAgICAgIC8vIEV4dHJhY3QgdG9rZW5zIGZyb20gcmVzdWx0XG4gICAgICBjb25zdCB7IGFjY2Vzc1Rva2VuLCByZWZyZXNoVG9rZW4gfSA9IHJlc3VsdDtcblxuICAgICAgLy8gRGV0ZXJtaW5lIGZyb250ZW5kIHJlZGlyZWN0IFVSTCBiYXNlZCBvbiBlbnZpcm9ubWVudFxuICAgICAgY29uc3QgZnJvbnRlbmRVcmwgPSBwcm9jZXNzLmVudi5GUk9OVEVORF9VUkwgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMCc7XG4gICAgICBjb25zdCByZWRpcmVjdFVybCA9IGAke2Zyb250ZW5kVXJsfS9zc28tY2FsbGJhY2s/dG9rZW49JHthY2Nlc3NUb2tlbn0mcmVmcmVzaF90b2tlbj0ke3JlZnJlc2hUb2tlbn0mcm9sZT0ke3JvbGV9YDtcblxuICAgICAgLy8gUmVkaXJlY3QgdG8gZnJvbnRlbmQgd2l0aCB0b2tlbnMgaW4gVVJMIHBhcmFtZXRlcnNcbiAgICAgIHJldHVybiByZXMucmVkaXJlY3QocmVkaXJlY3RVcmwpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdNaWNyb3NvZnQgT0F1dGggY2FsbGJhY2sgZXJyb3I6JywgZXJyb3IpO1xuXG4gICAgICAvLyBSZWRpcmVjdCB0byBmcm9udGVuZCB3aXRoIGVycm9yXG4gICAgICBjb25zdCBmcm9udGVuZFVybCA9IHByb2Nlc3MuZW52LkZST05URU5EX1VSTCB8fCAnaHR0cDovL2xvY2FsaG9zdDozMDAwJztcbiAgICAgIGNvbnN0IGVycm9yVXJsID0gYCR7ZnJvbnRlbmRVcmx9L2F1dGgvc2lnbi1pbj9lcnJvcj1vYXV0aF9mYWlsZWQmcHJvdmlkZXI9bWljcm9zb2Z0YDtcbiAgICAgIHJldHVybiByZXMucmVkaXJlY3QoZXJyb3JVcmwpO1xuICAgIH1cbiAgfVxuXG4gIC8vIE9BdXRoIFRva2VuIEV4Y2hhbmdlIEFQSSBFbmRwb2ludCAoZm9yIGZyb250ZW5kIHRvIGNhbGwpXG4gIEBQdWJsaWMoKVxuICBAQXBpT3BlcmF0aW9uKHtcbiAgICBzdW1tYXJ5OiAnRXhjaGFuZ2UgT0F1dGggYXV0aG9yaXphdGlvbiBjb2RlIGZvciB0b2tlbnMnLFxuICAgIGRlc2NyaXB0aW9uOlxuICAgICAgJ0V4Y2hhbmdlIE9BdXRoIGF1dGhvcml6YXRpb24gY29kZSBmcm9tIEdvb2dsZS9NaWNyb3NvZnQgZm9yIEpXVCB0b2tlbnMnLFxuICB9KVxuICBAQXBpQm9keSh7XG4gICAgZGVzY3JpcHRpb246ICdPQXV0aCBhdXRob3JpemF0aW9uIGNvZGUgYW5kIHByb3ZpZGVyIGluZm9ybWF0aW9uJyxcbiAgICBzY2hlbWE6IHtcbiAgICAgIHR5cGU6ICdvYmplY3QnLFxuICAgICAgcHJvcGVydGllczoge1xuICAgICAgICBwcm92aWRlcjoge1xuICAgICAgICAgIHR5cGU6ICdzdHJpbmcnLFxuICAgICAgICAgIGVudW06IFsnZ29vZ2xlJywgJ21pY3Jvc29mdCddLFxuICAgICAgICAgIGV4YW1wbGU6ICdnb29nbGUnLFxuICAgICAgICB9LFxuICAgICAgICBjb2RlOiB7XG4gICAgICAgICAgdHlwZTogJ3N0cmluZycsXG4gICAgICAgICAgZXhhbXBsZTogJ2F1dGhvcml6YXRpb25fY29kZV9mcm9tX29hdXRoX3Byb3ZpZGVyJyxcbiAgICAgICAgfSxcbiAgICAgICAgc3RhdGU6IHtcbiAgICAgICAgICB0eXBlOiAnc3RyaW5nJyxcbiAgICAgICAgICBleGFtcGxlOiAnY2xpZW50JyxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogJ09wdGlvbmFsIHJvbGUgZm9yIG5ldyB1c2VyIGNyZWF0aW9uJyxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICByZXF1aXJlZDogWydwcm92aWRlcicsICdjb2RlJ10sXG4gICAgfSxcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHtcbiAgICBzdGF0dXM6IDIwMCxcbiAgICBkZXNjcmlwdGlvbjogJ09BdXRoIGxvZ2luIHN1Y2Nlc3NmdWwnLFxuICAgIHNjaGVtYToge1xuICAgICAgdHlwZTogJ29iamVjdCcsXG4gICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICB0eXBlOiAnb2JqZWN0JyxcbiAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICBpZDogeyB0eXBlOiAnc3RyaW5nJyB9LFxuICAgICAgICAgICAgZW1haWw6IHsgdHlwZTogJ3N0cmluZycgfSxcbiAgICAgICAgICAgIGZpcnN0TmFtZTogeyB0eXBlOiAnc3RyaW5nJyB9LFxuICAgICAgICAgICAgbGFzdE5hbWU6IHsgdHlwZTogJ3N0cmluZycgfSxcbiAgICAgICAgICAgIHJvbGU6IHsgdHlwZTogJ3N0cmluZycgfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBhY2Nlc3NUb2tlbjogeyB0eXBlOiAnc3RyaW5nJyB9LFxuICAgICAgICByZWZyZXNoVG9rZW46IHsgdHlwZTogJ3N0cmluZycgfSxcbiAgICAgICAgZXhwaXJlc0luOiB7IHR5cGU6ICdudW1iZXInIH0sXG4gICAgICB9LFxuICAgIH0sXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiA0MDAsXG4gICAgZGVzY3JpcHRpb246ICdJbnZhbGlkIE9BdXRoIGNvZGUgb3IgcHJvdmlkZXInLFxuICB9KVxuICBAUG9zdCgnb2F1dGgvdG9rZW4tZXhjaGFuZ2UnKVxuICBASHR0cENvZGUoSHR0cFN0YXR1cy5PSylcbiAgYXN5bmMgZXhjaGFuZ2VPQXV0aFRva2VuKFxuICAgIEBCb2R5KClcbiAgICBib2R5OiB7XG4gICAgICBwcm92aWRlcjogJ2dvb2dsZScgfCAnbWljcm9zb2Z0JztcbiAgICAgIGNvZGU6IHN0cmluZztcbiAgICAgIHN0YXRlPzogc3RyaW5nO1xuICAgIH0sXG4gICkge1xuICAgIGNvbnN0IHsgcHJvdmlkZXIsIGNvZGUgfSA9IGJvZHk7XG5cbiAgICBpZiAoIWNvZGUpIHtcbiAgICAgIHRocm93IG5ldyBVbmF1dGhvcml6ZWRFeGNlcHRpb24oJ0F1dGhvcml6YXRpb24gY29kZSBpcyByZXF1aXJlZCcpO1xuICAgIH1cblxuICAgIGlmICghWydnb29nbGUnLCAnbWljcm9zb2Z0J10uaW5jbHVkZXMocHJvdmlkZXIpKSB7XG4gICAgICB0aHJvdyBuZXcgVW5hdXRob3JpemVkRXhjZXB0aW9uKCdJbnZhbGlkIE9BdXRoIHByb3ZpZGVyJyk7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIC8vIFRPRE86IEltcGxlbWVudCBwcm9wZXIgT0F1dGggdG9rZW4gZXhjaGFuZ2Ugd2l0aCBwcm92aWRlciBBUElzXG4gICAgICAvLyBUaGlzIHdvdWxkIGludm9sdmUgZXhjaGFuZ2luZyB0aGUgYXV0aG9yaXphdGlvbiBjb2RlIGZvciBhbiBhY2Nlc3MgdG9rZW5cbiAgICAgIC8vIGFuZCB0aGVuIGZldGNoaW5nIHVzZXIgcHJvZmlsZSBpbmZvcm1hdGlvbiBmcm9tIHRoZSBPQXV0aCBwcm92aWRlclxuXG4gICAgICAvLyBGb3Igbm93LCB0aGlzIGlzIGEgcGxhY2Vob2xkZXIgdGhhdCBleHBlY3RzIHRoZSBmdWxsIE9BdXRoIGZsb3dcbiAgICAgIC8vIHRvIGJlIGhhbmRsZWQgYnkgdGhlIGV4aXN0aW5nIFBhc3Nwb3J0IHN0cmF0ZWdpZXNcbiAgICAgIHRocm93IG5ldyBVbmF1dGhvcml6ZWRFeGNlcHRpb24oXG4gICAgICAgICdEaXJlY3QgdG9rZW4gZXhjaGFuZ2Ugbm90IHlldCBpbXBsZW1lbnRlZC4gVXNlIE9BdXRoIHJlZGlyZWN0IGZsb3cuJyxcbiAgICAgICk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ09BdXRoIHRva2VuIGV4Y2hhbmdlIGVycm9yOicsIGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBVbmF1dGhvcml6ZWRFeGNlcHRpb24oJ09BdXRoIHRva2VuIGV4Y2hhbmdlIGZhaWxlZCcpO1xuICAgIH1cbiAgfVxuXG4gIC8vID09PT09IFNFU1NJT04gTUFOQUdFTUVOVCBFTkRQT0lOVFMgPT09PT1cblxuICBAVXNlR3VhcmRzKEp3dEF1dGhHdWFyZClcbiAgQEFwaUJlYXJlckF1dGgoJ0pXVC1hdXRoJylcbiAgQEFwaU9wZXJhdGlvbih7XG4gICAgc3VtbWFyeTogJ0dldCBjdXJyZW50IHNlc3Npb24gaW5mb3JtYXRpb24nLFxuICAgIGRlc2NyaXB0aW9uOiAnUmV0cmlldmUgaW5mb3JtYXRpb24gYWJvdXQgdGhlIGN1cnJlbnQgdXNlciBzZXNzaW9uJyxcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHtcbiAgICBzdGF0dXM6IDIwMCxcbiAgICBkZXNjcmlwdGlvbjogJ1Nlc3Npb24gaW5mb3JtYXRpb24gcmV0cmlldmVkIHN1Y2Nlc3NmdWxseScsXG4gICAgc2NoZW1hOiB7XG4gICAgICB0eXBlOiAnb2JqZWN0JyxcbiAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgc2Vzc2lvbklkOiB7IHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICAgIGNyZWF0ZWRBdDogeyB0eXBlOiAnc3RyaW5nJywgZm9ybWF0OiAnZGF0ZS10aW1lJyB9LFxuICAgICAgICBsYXN0QWN0aXZpdHk6IHsgdHlwZTogJ3N0cmluZycsIGZvcm1hdDogJ2RhdGUtdGltZScgfSxcbiAgICAgICAgZGV2aWNlOiB7IHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICAgIGxvY2F0aW9uOiB7IHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICAgIGlwQWRkcmVzczogeyB0eXBlOiAnc3RyaW5nJyB9LFxuICAgICAgICB1c2VyQWdlbnQ6IHsgdHlwZTogJ3N0cmluZycgfSxcbiAgICAgIH0sXG4gICAgfSxcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHtcbiAgICBzdGF0dXM6IDQwMSxcbiAgICBkZXNjcmlwdGlvbjogJ1VuYXV0aG9yaXplZCAtIEludmFsaWQgb3IgbWlzc2luZyBKV1QgdG9rZW4nLFxuICB9KVxuICBAR2V0KCdzZXNzaW9uLWluZm8nKVxuICBhc3luYyBnZXRTZXNzaW9uSW5mbyhAUmVxKCkgcmVxOiBSZXF1ZXN0KSB7XG4gICAgLy8gRXh0cmFjdCByZWZyZXNoIHRva2VuIGZyb20gQXV0aG9yaXphdGlvbiBoZWFkZXIgb3IgY29va2llc1xuICAgIGNvbnN0IHJlZnJlc2hUb2tlbiA9IHJlcS5oZWFkZXJzWyd4LXJlZnJlc2gtdG9rZW4nXSBhcyBzdHJpbmc7XG5cbiAgICBpZiAoIXJlZnJlc2hUb2tlbikge1xuICAgICAgdGhyb3cgbmV3IFVuYXV0aG9yaXplZEV4Y2VwdGlvbihcbiAgICAgICAgJ1JlZnJlc2ggdG9rZW4gcmVxdWlyZWQgZm9yIHNlc3Npb24gaW5mbycsXG4gICAgICApO1xuICAgIH1cblxuICAgIHJldHVybiBhd2FpdCB0aGlzLmF1dGhTZXJ2aWNlLmdldFNlc3Npb25JbmZvKHJlZnJlc2hUb2tlbik7XG4gIH1cblxuICBAVXNlR3VhcmRzKEp3dEF1dGhHdWFyZClcbiAgQEFwaUJlYXJlckF1dGgoJ0pXVC1hdXRoJylcbiAgQEFwaU9wZXJhdGlvbih7XG4gICAgc3VtbWFyeTogJ0dldCBhbGwgYWN0aXZlIHNlc3Npb25zJyxcbiAgICBkZXNjcmlwdGlvbjogJ1JldHJpZXZlIGFsbCBhY3RpdmUgc2Vzc2lvbnMgZm9yIHRoZSBjdXJyZW50IHVzZXInLFxuICB9KVxuICBAQXBpUmVzcG9uc2Uoe1xuICAgIHN0YXR1czogMjAwLFxuICAgIGRlc2NyaXB0aW9uOiAnQWN0aXZlIHNlc3Npb25zIHJldHJpZXZlZCBzdWNjZXNzZnVsbHknLFxuICAgIHNjaGVtYToge1xuICAgICAgdHlwZTogJ29iamVjdCcsXG4gICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIHNlc3Npb25zOiB7XG4gICAgICAgICAgdHlwZTogJ2FycmF5JyxcbiAgICAgICAgICBpdGVtczoge1xuICAgICAgICAgICAgdHlwZTogJ29iamVjdCcsXG4gICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgIGlkOiB7IHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICAgICAgICAgIGRldmljZTogeyB0eXBlOiAnc3RyaW5nJyB9LFxuICAgICAgICAgICAgICBsb2NhdGlvbjogeyB0eXBlOiAnc3RyaW5nJyB9LFxuICAgICAgICAgICAgICBsYXN0QWN0aXZpdHk6IHsgdHlwZTogJ3N0cmluZycsIGZvcm1hdDogJ2RhdGUtdGltZScgfSxcbiAgICAgICAgICAgICAgaXNDdXJyZW50OiB7IHR5cGU6ICdib29sZWFuJyB9LFxuICAgICAgICAgICAgICBpcEFkZHJlc3M6IHsgdHlwZTogJ3N0cmluZycgfSxcbiAgICAgICAgICAgICAgdXNlckFnZW50OiB7IHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICAgICAgICAgIGNyZWF0ZWRBdDogeyB0eXBlOiAnc3RyaW5nJywgZm9ybWF0OiAnZGF0ZS10aW1lJyB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9LFxuICB9KVxuICBAQXBpUmVzcG9uc2Uoe1xuICAgIHN0YXR1czogNDAxLFxuICAgIGRlc2NyaXB0aW9uOiAnVW5hdXRob3JpemVkIC0gSW52YWxpZCBvciBtaXNzaW5nIEpXVCB0b2tlbicsXG4gIH0pXG4gIEBHZXQoJ2FjdGl2ZS1zZXNzaW9ucycpXG4gIGFzeW5jIGdldEFjdGl2ZVNlc3Npb25zKFxuICAgIEBDdXJyZW50VXNlcklkKCkgdXNlcklkOiBzdHJpbmcsXG4gICAgQFJlcSgpIHJlcTogUmVxdWVzdCxcbiAgKSB7XG4gICAgY29uc3QgcmVmcmVzaFRva2VuID0gcmVxLmhlYWRlcnNbJ3gtcmVmcmVzaC10b2tlbiddIGFzIHN0cmluZztcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5hdXRoU2VydmljZS5nZXRBY3RpdmVTZXNzaW9ucyh1c2VySWQsIHJlZnJlc2hUb2tlbik7XG4gIH1cblxuICBAVXNlR3VhcmRzKEp3dEF1dGhHdWFyZClcbiAgQEFwaUJlYXJlckF1dGgoJ0pXVC1hdXRoJylcbiAgQEFwaU9wZXJhdGlvbih7XG4gICAgc3VtbWFyeTogJ1Rlcm1pbmF0ZSBhIHNwZWNpZmljIHNlc3Npb24nLFxuICAgIGRlc2NyaXB0aW9uOiAnVGVybWluYXRlIGEgc3BlY2lmaWMgc2Vzc2lvbiBieSBzZXNzaW9uIElEJyxcbiAgfSlcbiAgQEFwaUJvZHkoe1xuICAgIGRlc2NyaXB0aW9uOiAnU2Vzc2lvbiBJRCB0byB0ZXJtaW5hdGUnLFxuICAgIHNjaGVtYToge1xuICAgICAgdHlwZTogJ29iamVjdCcsXG4gICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIHNlc3Npb25JZDogeyB0eXBlOiAnc3RyaW5nJywgZXhhbXBsZTogJ3Nlc3Npb24tdXVpZC1oZXJlJyB9LFxuICAgICAgfSxcbiAgICAgIHJlcXVpcmVkOiBbJ3Nlc3Npb25JZCddLFxuICAgIH0sXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiAyMDAsXG4gICAgZGVzY3JpcHRpb246ICdTZXNzaW9uIHRlcm1pbmF0ZWQgc3VjY2Vzc2Z1bGx5JyxcbiAgICBzY2hlbWE6IHtcbiAgICAgIHR5cGU6ICdvYmplY3QnLFxuICAgICAgcHJvcGVydGllczoge1xuICAgICAgICBzdWNjZXNzOiB7IHR5cGU6ICdib29sZWFuJyB9LFxuICAgICAgICBtZXNzYWdlOiB7IHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICB9LFxuICAgIH0sXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiA0MDEsXG4gICAgZGVzY3JpcHRpb246ICdVbmF1dGhvcml6ZWQgLSBJbnZhbGlkIG9yIG1pc3NpbmcgSldUIHRva2VuJyxcbiAgfSlcbiAgQEFwaVJlc3BvbnNlKHtcbiAgICBzdGF0dXM6IDQwNCxcbiAgICBkZXNjcmlwdGlvbjogJ1Nlc3Npb24gbm90IGZvdW5kJyxcbiAgfSlcbiAgQFRocm90dGxlKHsgZGVmYXVsdDogeyBsaW1pdDogMTAsIHR0bDogNjAwMDAgfSB9KSAvLyAxMCB0ZXJtaW5hdGlvbnMgcGVyIG1pbnV0ZVxuICBARGVsZXRlKCd0ZXJtaW5hdGUtc2Vzc2lvbicpXG4gIEBIdHRwQ29kZShIdHRwU3RhdHVzLk9LKVxuICBhc3luYyB0ZXJtaW5hdGVTZXNzaW9uKFxuICAgIEBCb2R5KG5ldyBab2RWYWxpZGF0aW9uUGlwZShUZXJtaW5hdGVTZXNzaW9uRHRvU2NoZW1hKSlcbiAgICB0ZXJtaW5hdGVEdG86IFRlcm1pbmF0ZVNlc3Npb25EdG8sXG4gICAgQEN1cnJlbnRVc2VySWQoKSB1c2VySWQ6IHN0cmluZyxcbiAgKSB7XG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuYXV0aFNlcnZpY2UudGVybWluYXRlU2Vzc2lvbihcbiAgICAgIHRlcm1pbmF0ZUR0by5zZXNzaW9uSWQsXG4gICAgICB1c2VySWQsXG4gICAgKTtcbiAgfVxuXG4gIEBVc2VHdWFyZHMoSnd0QXV0aEd1YXJkKVxuICBAQXBpQmVhcmVyQXV0aCgnSldULWF1dGgnKVxuICBAQXBpT3BlcmF0aW9uKHtcbiAgICBzdW1tYXJ5OiAnVGVybWluYXRlIGFsbCBvdGhlciBzZXNzaW9ucycsXG4gICAgZGVzY3JpcHRpb246ICdUZXJtaW5hdGUgYWxsIG90aGVyIHNlc3Npb25zIGV4Y2VwdCB0aGUgY3VycmVudCBvbmUnLFxuICB9KVxuICBAQXBpUmVzcG9uc2Uoe1xuICAgIHN0YXR1czogMjAwLFxuICAgIGRlc2NyaXB0aW9uOiAnT3RoZXIgc2Vzc2lvbnMgdGVybWluYXRlZCBzdWNjZXNzZnVsbHknLFxuICAgIHNjaGVtYToge1xuICAgICAgdHlwZTogJ29iamVjdCcsXG4gICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIHN1Y2Nlc3M6IHsgdHlwZTogJ2Jvb2xlYW4nIH0sXG4gICAgICAgIHRlcm1pbmF0ZWRDb3VudDogeyB0eXBlOiAnbnVtYmVyJyB9LFxuICAgICAgICBtZXNzYWdlOiB7IHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICB9LFxuICAgIH0sXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiA0MDEsXG4gICAgZGVzY3JpcHRpb246ICdVbmF1dGhvcml6ZWQgLSBJbnZhbGlkIG9yIG1pc3NpbmcgSldUIHRva2VuJyxcbiAgfSlcbiAgQFRocm90dGxlKHsgZGVmYXVsdDogeyBsaW1pdDogNSwgdHRsOiA2MDAwMCB9IH0pIC8vIDUgdGVybWluYXRpb25zIHBlciBtaW51dGVcbiAgQFBvc3QoJ3Rlcm1pbmF0ZS1vdGhlci1zZXNzaW9ucycpXG4gIEBIdHRwQ29kZShIdHRwU3RhdHVzLk9LKVxuICBhc3luYyB0ZXJtaW5hdGVPdGhlclNlc3Npb25zKFxuICAgIEBDdXJyZW50VXNlcklkKCkgdXNlcklkOiBzdHJpbmcsXG4gICAgQFJlcSgpIHJlcTogUmVxdWVzdCxcbiAgKSB7XG4gICAgY29uc3QgcmVmcmVzaFRva2VuID0gcmVxLmhlYWRlcnNbJ3gtcmVmcmVzaC10b2tlbiddIGFzIHN0cmluZztcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5hdXRoU2VydmljZS50ZXJtaW5hdGVPdGhlclNlc3Npb25zKHVzZXJJZCwgcmVmcmVzaFRva2VuKTtcbiAgfVxuXG4gIEBVc2VHdWFyZHMoSnd0QXV0aEd1YXJkKVxuICBAQXBpQmVhcmVyQXV0aCgnSldULWF1dGgnKVxuICBAQXBpT3BlcmF0aW9uKHtcbiAgICBzdW1tYXJ5OiAnVW5pdmVyc2FsIGxvZ291dCcsXG4gICAgZGVzY3JpcHRpb246XG4gICAgICAnQ2xlYXIgYWxsIHNlc3Npb25zIGZvciB0aGUgY3VycmVudCB1c2VyIChsb2dvdXQgZnJvbSBhbGwgZGV2aWNlcyknLFxuICB9KVxuICBAQXBpUmVzcG9uc2Uoe1xuICAgIHN0YXR1czogMjAwLFxuICAgIGRlc2NyaXB0aW9uOiAnQWxsIHNlc3Npb25zIHRlcm1pbmF0ZWQgc3VjY2Vzc2Z1bGx5JyxcbiAgICBzY2hlbWE6IHtcbiAgICAgIHR5cGU6ICdvYmplY3QnLFxuICAgICAgcHJvcGVydGllczoge1xuICAgICAgICBzdWNjZXNzOiB7IHR5cGU6ICdib29sZWFuJyB9LFxuICAgICAgICBtZXNzYWdlOiB7IHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICB9LFxuICAgIH0sXG4gIH0pXG4gIEBBcGlSZXNwb25zZSh7XG4gICAgc3RhdHVzOiA0MDEsXG4gICAgZGVzY3JpcHRpb246ICdVbmF1dGhvcml6ZWQgLSBJbnZhbGlkIG9yIG1pc3NpbmcgSldUIHRva2VuJyxcbiAgfSlcbiAgQFRocm90dGxlKHsgZGVmYXVsdDogeyBsaW1pdDogMywgdHRsOiA2MDAwMCB9IH0pIC8vIDMgdW5pdmVyc2FsIGxvZ291dHMgcGVyIG1pbnV0ZVxuICBAUG9zdCgndW5pdmVyc2FsLWxvZ291dCcpXG4gIEBIdHRwQ29kZShIdHRwU3RhdHVzLk9LKVxuICBhc3luYyB1bml2ZXJzYWxMb2dvdXQoQEN1cnJlbnRVc2VySWQoKSB1c2VySWQ6IHN0cmluZykge1xuICAgIHJldHVybiBhd2FpdCB0aGlzLmF1dGhTZXJ2aWNlLnVuaXZlcnNhbExvZ291dCh1c2VySWQpO1xuICB9XG59XG4iXSwidmVyc2lvbiI6M30=