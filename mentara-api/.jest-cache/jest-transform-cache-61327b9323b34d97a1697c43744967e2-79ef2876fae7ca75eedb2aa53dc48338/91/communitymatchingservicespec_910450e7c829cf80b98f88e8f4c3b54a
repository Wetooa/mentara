0dccccb5f6373eacfc383524e8e96a04
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const common_1 = require("@nestjs/common");
const community_matching_service_1 = require("./community-matching.service");
const prisma_client_provider_1 = require("../../providers/prisma-client.provider");
describe('CommunityMatchingService', () => {
    let service;
    let prismaService;
    let loggerSpy;
    // Mock data
    const mockCommunity = {
        id: 'community-123',
        name: 'Depression Support Network',
        slug: 'depression-support',
        description: 'A supportive community for depression',
        imageUrl: 'image.jpg',
        createdAt: new Date('2024-01-01'),
        updatedAt: new Date('2024-01-01'),
    };
    const mockAnxietyCommunity = {
        id: 'community-456',
        name: 'Anxiety Warriors',
        slug: 'anxiety-warriors',
        description: 'A supportive community for anxiety',
        imageUrl: 'anxiety.jpg',
        createdAt: new Date('2024-01-01'),
        updatedAt: new Date('2024-01-01'),
    };
    const mockPTSDCommunity = {
        id: 'community-789',
        name: 'PTSD Support Network',
        slug: 'ptsd-support',
        description: 'A supportive community for PTSD',
        imageUrl: 'ptsd.jpg',
        createdAt: new Date('2024-01-01'),
        updatedAt: new Date('2024-01-01'),
    };
    const mockGeneralCommunity = {
        id: 'community-general',
        name: 'General Support',
        slug: 'general-support',
        description: 'General mental health support',
        imageUrl: 'general.jpg',
        createdAt: new Date('2024-01-01'),
        updatedAt: new Date('2024-01-01'),
    };
    const mockPreAssessment = {
        id: 'assessment-123',
        clientId: 'user-123',
        questionnaires: ['phq-9', 'gad-7', 'ptsd-5'],
        answers: [[1, 2, 3], [4, 5, 6], [7, 8, 9]],
        answerMatrix: [[1, 2, 3], [4, 5, 6], [7, 8, 9]],
        scores: {
            phq9Score: 15, // Moderately severe depression
            gad7Score: 12, // Moderate anxiety
            ptsd5Score: 8, // Moderate PTSD
        },
        severityLevels: {
            phq9: 'moderately severe',
            gad7: 'moderate',
            ptsd5: 'moderate',
        },
        aiEstimate: { hasDepression: true, hasAnxiety: true },
        createdAt: new Date('2024-01-01'),
        updatedAt: new Date('2024-01-01'),
    };
    const mockUserAssessmentProfile = {
        userId: 'user-123',
        assessments: {
            phq9: {
                score: 15,
                severity: 'moderately severe',
                date: new Date('2024-01-01'),
            },
            gad7: {
                score: 12,
                severity: 'moderate',
                date: new Date('2024-01-01'),
            },
            ptsd5: {
                score: 8,
                severity: 'moderate',
                date: new Date('2024-01-01'),
            },
        },
    };
    beforeEach(async () => {
        const mockPrismaService = {
            community: {
                findUnique: jest.fn(),
                findMany: jest.fn(),
            },
            preAssessment: {
                findUnique: jest.fn(),
                findFirst: jest.fn(),
            },
        };
        const module = await testing_1.Test.createTestingModule({
            providers: [
                community_matching_service_1.CommunityMatchingService,
                {
                    provide: prisma_client_provider_1.PrismaService,
                    useValue: mockPrismaService,
                },
            ],
        }).compile();
        service = module.get(community_matching_service_1.CommunityMatchingService);
        prismaService = module.get(prisma_client_provider_1.PrismaService);
        // Setup logger spies
        loggerSpy = jest.spyOn(common_1.Logger.prototype, 'log').mockImplementation();
        jest.spyOn(common_1.Logger.prototype, 'warn').mockImplementation();
        jest.spyOn(common_1.Logger.prototype, 'error').mockImplementation();
    });
    afterEach(() => {
        jest.clearAllMocks();
    });
    it('should be defined', () => {
        expect(service).toBeDefined();
    });
    describe('calculateCompatibilityScore', () => {
        beforeEach(() => {
            prismaService.community.findUnique.mockResolvedValue(mockCommunity);
        });
        it('should calculate high compatibility score for matching conditions', async () => {
            const result = await service.calculateCompatibilityScore(mockUserAssessmentProfile, 'depression-support');
            expect(prismaService.community.findUnique).toHaveBeenCalledWith({
                where: { slug: 'depression-support' },
                select: { id: true, name: true, slug: true },
            });
            expect(result).toEqual({
                communityId: 'community-123',
                communitySlug: 'depression-support',
                compatibilityScore: expect.any(Number),
                reasoning: expect.stringContaining('Depression Support Network'),
                matchingFactors: expect.arrayContaining(['PHQ9 (moderately severe)']),
                assessmentContributions: expect.objectContaining({
                    phq9: expect.objectContaining({
                        score: 15,
                        weight: 0.8,
                        contribution: expect.any(Number),
                    }),
                }),
            });
            expect(result.compatibilityScore).toBeGreaterThan(0.7); // High compatibility
        });
        it('should calculate moderate compatibility for general communities', async () => {
            prismaService.community.findUnique.mockResolvedValue(mockGeneralCommunity);
            const result = await service.calculateCompatibilityScore(mockUserAssessmentProfile, 'general-support');
            expect(result.compatibilityScore).toBeLessThan(0.9); // Should be lower due to general community penalty
            expect(result.communitySlug).toBe('general-support');
        });
        it('should throw error for non-existent community', async () => {
            prismaService.community.findUnique.mockResolvedValue(null);
            await expect(service.calculateCompatibilityScore(mockUserAssessmentProfile, 'non-existent-community')).rejects.toThrow('Community not found: non-existent-community');
        });
        it('should return zero compatibility when no assessments match', async () => {
            const noMatchProfile = {
                userId: 'user-123',
                assessments: {
                    unknownAssessment: {
                        score: 15,
                        severity: 'moderate',
                        date: new Date('2024-01-01'),
                    },
                },
            };
            const result = await service.calculateCompatibilityScore(noMatchProfile, 'depression-support');
            expect(result.compatibilityScore).toBe(0);
            expect(result.matchingFactors).toEqual([]);
        });
        it('should apply specificity bonus for targeted communities', async () => {
            prismaService.community.findUnique.mockResolvedValue(mockCommunity);
            const result = await service.calculateCompatibilityScore(mockUserAssessmentProfile, 'depression-support');
            // Depression-support is a specific community for PHQ-9, should get bonus
            expect(result.compatibilityScore).toBeGreaterThan(0.7);
        });
        it('should apply general community penalty', async () => {
            prismaService.community.findUnique.mockResolvedValue(mockGeneralCommunity);
            const result = await service.calculateCompatibilityScore(mockUserAssessmentProfile, 'general-support');
            // General communities get penalty
            expect(result.assessmentContributions.phq9.contribution).toBeLessThan(0.8 * 1.0 * 0.8 // weight * severity * full specificity
            );
        });
        it('should handle multiple assessment contributions correctly', async () => {
            prismaService.community.findUnique.mockResolvedValue(mockAnxietyCommunity);
            const multiAssessmentProfile = {
                userId: 'user-123',
                assessments: {
                    gad7: {
                        score: 15,
                        severity: 'severe',
                        date: new Date('2024-01-01'),
                    },
                    phq9: {
                        score: 10,
                        severity: 'moderate',
                        date: new Date('2024-01-01'),
                    },
                },
            };
            const result = await service.calculateCompatibilityScore(multiAssessmentProfile, 'anxiety-warriors');
            expect(result.matchingFactors).toContain('GAD7 (severe)');
            expect(result.assessmentContributions).toHaveProperty('gad7');
            expect(result.assessmentContributions.gad7.score).toBe(15);
        });
    });
    describe('getSeverityMultiplier', () => {
        it('should return correct multipliers for PHQ-9 scores', () => {
            const getSeverityMultiplier = service.getSeverityMultiplier.bind(service);
            expect(getSeverityMultiplier('phq9', 2)).toBe(0.3); // Minimal
            expect(getSeverityMultiplier('phq9', 7)).toBe(0.6); // Mild
            expect(getSeverityMultiplier('phq9', 12)).toBe(0.9); // Moderate
            expect(getSeverityMultiplier('phq9', 17)).toBe(1.0); // Moderately severe
            expect(getSeverityMultiplier('phq9', 25)).toBe(1.0); // Severe
        });
        it('should return correct multipliers for GAD-7 scores', () => {
            const getSeverityMultiplier = service.getSeverityMultiplier.bind(service);
            expect(getSeverityMultiplier('gad7', 3)).toBe(0.3); // Minimal
            expect(getSeverityMultiplier('gad7', 8)).toBe(0.6); // Mild
            expect(getSeverityMultiplier('gad7', 13)).toBe(0.9); // Moderate
            expect(getSeverityMultiplier('gad7', 18)).toBe(1.0); // Severe
        });
        it('should return correct multipliers for PTSD-5 scores', () => {
            const getSeverityMultiplier = service.getSeverityMultiplier.bind(service);
            expect(getSeverityMultiplier('ptsd5', 1)).toBe(0.3); // Minimal
            expect(getSeverityMultiplier('ptsd5', 5)).toBe(0.6); // Mild
            expect(getSeverityMultiplier('ptsd5', 12)).toBe(0.9); // Moderate
            expect(getSeverityMultiplier('ptsd5', 18)).toBe(1.0); // Severe
        });
        it('should return default multiplier for unknown assessment types', () => {
            const getSeverityMultiplier = service.getSeverityMultiplier.bind(service);
            expect(getSeverityMultiplier('unknown-assessment', 15)).toBe(0.5);
        });
    });
    describe('getCommunitySpecificityBonus', () => {
        it('should return bonus for specific community matches', () => {
            const getCommunitySpecificityBonus = service.getCommunitySpecificityBonus.bind(service);
            expect(getCommunitySpecificityBonus('depression-support', 'phq9')).toBe(1.2);
            expect(getCommunitySpecificityBonus('anxiety-support', 'gad7')).toBe(1.2);
            expect(getCommunitySpecificityBonus('ptsd-support', 'ptsd5')).toBe(1.2);
            expect(getCommunitySpecificityBonus('trauma-recovery', 'ptsd5')).toBe(1.2);
            expect(getCommunitySpecificityBonus('panic-disorder', 'gad7')).toBe(1.2);
            expect(getCommunitySpecificityBonus('social-anxiety', 'gad7')).toBe(1.2);
        });
        it('should return penalty for general communities', () => {
            const getCommunitySpecificityBonus = service.getCommunitySpecificityBonus.bind(service);
            expect(getCommunitySpecificityBonus('general-support', 'phq9')).toBe(0.8);
            expect(getCommunitySpecificityBonus('mental-wellness', 'gad7')).toBe(0.8);
            expect(getCommunitySpecificityBonus('therapy-discussion', 'ptsd5')).toBe(0.8);
        });
        it('should return neutral multiplier for other communities', () => {
            const getCommunitySpecificityBonus = service.getCommunitySpecificityBonus.bind(service);
            expect(getCommunitySpecificityBonus('other-community', 'phq9')).toBe(1.0);
        });
    });
    describe('generateReasoningText', () => {
        it('should generate appropriate text for high compatibility', () => {
            const generateReasoningText = service.generateReasoningText.bind(service);
            const reasoning = generateReasoningText('Depression Support Network', ['PHQ9 (moderately severe)'], 0.85, { phq9: { score: 15, weight: 0.8, contribution: 0.68 } });
            expect(reasoning).toContain('85% compatibility');
            expect(reasoning).toContain('Depression Support Network');
            expect(reasoning).toContain('PHQ9 (moderately severe)');
            expect(reasoning).toContain('excellent match');
        });
        it('should generate appropriate text for moderate compatibility', () => {
            const generateReasoningText = service.generateReasoningText.bind(service);
            const reasoning = generateReasoningText('General Support', ['PHQ9 (mild)'], 0.65, { phq9: { score: 8, weight: 0.8, contribution: 0.52 } });
            expect(reasoning).toContain('65% compatibility');
            expect(reasoning).toContain('good fit');
        });
        it('should generate appropriate text for low compatibility', () => {
            const generateReasoningText = service.generateReasoningText.bind(service);
            const reasoning = generateReasoningText('Specific Community', ['GAD7 (minimal)'], 0.35, { gad7: { score: 3, weight: 0.7, contribution: 0.21 } });
            expect(reasoning).toContain('35% compatibility');
            expect(reasoning).toContain('some relevant support');
        });
        it('should generate appropriate text for very low compatibility', () => {
            const generateReasoningText = service.generateReasoningText.bind(service);
            const reasoning = generateReasoningText('Unrelated Community', [], 0.15, {});
            expect(reasoning).toContain('15% compatibility');
            expect(reasoning).toContain('other communities that are more specifically aligned');
        });
        it('should handle empty matching factors', () => {
            const generateReasoningText = service.generateReasoningText.bind(service);
            const reasoning = generateReasoningText('Community Name', [], 0.5, {});
            expect(reasoning).not.toContain('This recommendation is based on your');
            expect(reasoning).toContain('50% compatibility');
        });
    });
    describe('getRecommendationsForUser', () => {
        beforeEach(() => {
            prismaService.preAssessment.findUnique.mockResolvedValue(mockPreAssessment);
            prismaService.community.findMany.mockResolvedValue([
                { slug: 'depression-support', name: 'Depression Support Network' },
                { slug: 'anxiety-warriors', name: 'Anxiety Warriors' },
                { slug: 'ptsd-support', name: 'PTSD Support Network' },
                { slug: 'general-support', name: 'General Support' },
            ]);
            prismaService.community.findUnique.mockImplementation((args) => {
                const slug = args.where.slug;
                if (slug === 'depression-support')
                    return Promise.resolve(mockCommunity);
                if (slug === 'anxiety-warriors')
                    return Promise.resolve(mockAnxietyCommunity);
                if (slug === 'ptsd-support')
                    return Promise.resolve(mockPTSDCommunity);
                if (slug === 'general-support')
                    return Promise.resolve(mockGeneralCommunity);
                return Promise.resolve(null);
            });
        });
        it('should return sorted recommendations for user', async () => {
            const result = await service.getRecommendationsForUser('user-123');
            expect(prismaService.preAssessment.findUnique).toHaveBeenCalledWith({
                where: { clientId: 'user-123' },
                select: {
                    scores: true,
                    severityLevels: true,
                    createdAt: true,
                },
            });
            expect(prismaService.community.findMany).toHaveBeenCalledWith({
                select: { slug: true, name: true },
            });
            expect(result).toBeInstanceOf(Array);
            expect(result.length).toBeGreaterThan(0);
            // Should be sorted by compatibility score (highest first)
            for (let i = 1; i < result.length; i++) {
                expect(result[i - 1].compatibilityScore).toBeGreaterThanOrEqual(result[i].compatibilityScore);
            }
            // Should only include communities with >20% compatibility
            result.forEach(recommendation => {
                expect(recommendation.compatibilityScore).toBeGreaterThan(0.2);
            });
        });
        it('should return empty array when no assessment data exists', async () => {
            prismaService.preAssessment.findUnique.mockResolvedValue(null);
            const result = await service.getRecommendationsForUser('user-123');
            expect(result).toEqual([]);
            expect(loggerSpy).toHaveBeenCalledWith(expect.stringContaining('No assessment data found for user user-123'));
        });
        it('should return empty array when assessment has no scores', async () => {
            const emptyAssessment = {
                ...mockPreAssessment,
                scores: {},
                severityLevels: {},
            };
            prismaService.preAssessment.findUnique.mockResolvedValue(emptyAssessment);
            const result = await service.getRecommendationsForUser('user-123');
            expect(result).toEqual([]);
            expect(loggerSpy).toHaveBeenCalledWith(expect.stringContaining('No assessment data found for user user-123'));
        });
        it('should filter out low compatibility recommendations', async () => {
            // Mock very low scores that would result in low compatibility
            const lowScoreAssessment = {
                ...mockPreAssessment,
                scores: {
                    phq9Score: 1, // Minimal depression
                    gad7Score: 1, // Minimal anxiety
                },
                severityLevels: {
                    phq9: 'minimal',
                    gad7: 'minimal',
                },
            };
            prismaService.preAssessment.findUnique.mockResolvedValue(lowScoreAssessment);
            const result = await service.getRecommendationsForUser('user-123');
            // Should filter out recommendations with <20% compatibility
            result.forEach(recommendation => {
                expect(recommendation.compatibilityScore).toBeGreaterThan(0.2);
            });
        });
        it('should limit results to top 10 recommendations', async () => {
            // Mock many communities
            const manyCommunities = Array.from({ length: 15 }, (_, i) => ({
                slug: `community-${i}`,
                name: `Community ${i}`,
            }));
            prismaService.community.findMany.mockResolvedValue(manyCommunities);
            // Mock all communities as found
            prismaService.community.findUnique.mockResolvedValue(mockCommunity);
            const result = await service.getRecommendationsForUser('user-123');
            expect(result.length).toBeLessThanOrEqual(10);
        });
        it('should handle errors for individual community calculations gracefully', async () => {
            prismaService.community.findUnique.mockImplementation((args) => {
                if (args.where.slug === 'depression-support')
                    return Promise.resolve(mockCommunity);
                if (args.where.slug === 'anxiety-warriors')
                    return Promise.reject(new Error('Database error'));
                return Promise.resolve(mockGeneralCommunity);
            });
            const errorSpy = jest.spyOn(common_1.Logger.prototype, 'error').mockImplementation();
            const result = await service.getRecommendationsForUser('user-123');
            expect(errorSpy).toHaveBeenCalledWith(expect.stringContaining('Error calculating compatibility for anxiety-warriors'), expect.any(Error));
            // Should still return other successful recommendations
            expect(result.length).toBeGreaterThan(0);
        });
        it('should handle database errors during user profile retrieval', async () => {
            prismaService.preAssessment.findUnique.mockRejectedValue(new Error('Database error'));
            const errorSpy = jest.spyOn(common_1.Logger.prototype, 'error').mockImplementation();
            await expect(service.getRecommendationsForUser('user-123')).rejects.toThrow('Database error');
            expect(errorSpy).toHaveBeenCalledWith(expect.stringContaining('Error getting recommendations for user user-123'), expect.any(Error));
        });
    });
    describe('getUserAssessmentProfile', () => {
        beforeEach(() => {
            prismaService.preAssessment.findUnique.mockResolvedValue(mockPreAssessment);
        });
        it('should map PHQ-9 scores correctly', async () => {
            const getUserAssessmentProfile = service.getUserAssessmentProfile.bind(service);
            const result = await getUserAssessmentProfile('user-123');
            expect(result).toEqual({
                userId: 'user-123',
                assessments: expect.objectContaining({
                    phq9: expect.objectContaining({
                        score: 15,
                        severity: 'moderately severe',
                        date: expect.any(Date),
                    }),
                }),
            });
        });
        it('should map GAD-7 scores correctly', async () => {
            const getUserAssessmentProfile = service.getUserAssessmentProfile.bind(service);
            const result = await getUserAssessmentProfile('user-123');
            expect(result.assessments).toHaveProperty('gad7');
            expect(result.assessments.gad7.score).toBe(12);
            expect(result.assessments.gad7.severity).toBe('moderate');
        });
        it('should map PTSD-5 scores correctly', async () => {
            const getUserAssessmentProfile = service.getUserAssessmentProfile.bind(service);
            const result = await getUserAssessmentProfile('user-123');
            expect(result.assessments).toHaveProperty('ptsd5');
            expect(result.assessments.ptsd5.score).toBe(8);
            expect(result.assessments.ptsd5.severity).toBe('moderate');
        });
        it('should return null when no pre-assessment exists', async () => {
            prismaService.preAssessment.findUnique.mockResolvedValue(null);
            const getUserAssessmentProfile = service.getUserAssessmentProfile.bind(service);
            const result = await getUserAssessmentProfile('user-123');
            expect(result).toBeNull();
        });
        it('should handle missing score fields gracefully', async () => {
            const incompleteAssessment = {
                ...mockPreAssessment,
                scores: {
                    phq9Score: 15,
                    // Missing gad7Score and ptsd5Score
                },
            };
            prismaService.preAssessment.findUnique.mockResolvedValue(incompleteAssessment);
            const getUserAssessmentProfile = service.getUserAssessmentProfile.bind(service);
            const result = await getUserAssessmentProfile('user-123');
            expect(result.assessments).toHaveProperty('phq9');
            expect(result.assessments).not.toHaveProperty('gad7');
            expect(result.assessments).not.toHaveProperty('ptsd5');
        });
        it('should handle null/undefined scores', async () => {
            const nullScoresAssessment = {
                ...mockPreAssessment,
                scores: {
                    phq9Score: null,
                    gad7Score: undefined,
                    ptsd5Score: 0, // Valid zero score
                },
            };
            prismaService.preAssessment.findUnique.mockResolvedValue(nullScoresAssessment);
            const getUserAssessmentProfile = service.getUserAssessmentProfile.bind(service);
            const result = await getUserAssessmentProfile('user-123');
            expect(result.assessments).not.toHaveProperty('phq9');
            expect(result.assessments).not.toHaveProperty('gad7');
            expect(result.assessments).toHaveProperty('ptsd5'); // Zero is valid
        });
        it('should handle database errors', async () => {
            prismaService.preAssessment.findUnique.mockRejectedValue(new Error('Database error'));
            const errorSpy = jest.spyOn(common_1.Logger.prototype, 'error').mockImplementation();
            const getUserAssessmentProfile = service.getUserAssessmentProfile.bind(service);
            const result = await getUserAssessmentProfile('user-123');
            expect(result).toBeNull();
            expect(errorSpy).toHaveBeenCalledWith(expect.stringContaining('Error getting assessment profile for user user-123'), expect.any(Error));
        });
    });
    describe('severity assessment helpers', () => {
        describe('getDepressionSeverity', () => {
            it('should return correct severity levels for PHQ-9 scores', () => {
                const getDepressionSeverity = service.getDepressionSeverity.bind(service);
                expect(getDepressionSeverity(2)).toBe('minimal');
                expect(getDepressionSeverity(4)).toBe('minimal');
                expect(getDepressionSeverity(7)).toBe('mild');
                expect(getDepressionSeverity(9)).toBe('mild');
                expect(getDepressionSeverity(12)).toBe('moderate');
                expect(getDepressionSeverity(14)).toBe('moderate');
                expect(getDepressionSeverity(17)).toBe('moderately severe');
                expect(getDepressionSeverity(19)).toBe('moderately severe');
                expect(getDepressionSeverity(25)).toBe('severe');
            });
        });
        describe('getAnxietySeverity', () => {
            it('should return correct severity levels for GAD-7 scores', () => {
                const getAnxietySeverity = service.getAnxietySeverity.bind(service);
                expect(getAnxietySeverity(3)).toBe('minimal');
                expect(getAnxietySeverity(4)).toBe('minimal');
                expect(getAnxietySeverity(7)).toBe('mild');
                expect(getAnxietySeverity(9)).toBe('mild');
                expect(getAnxietySeverity(12)).toBe('moderate');
                expect(getAnxietySeverity(14)).toBe('moderate');
                expect(getAnxietySeverity(18)).toBe('severe');
                expect(getAnxietySeverity(21)).toBe('severe');
            });
        });
        describe('getPTSDSeverity', () => {
            it('should return correct severity levels for PTSD-5 scores', () => {
                const getPTSDSeverity = service.getPTSDSeverity.bind(service);
                expect(getPTSDSeverity(1)).toBe('minimal');
                expect(getPTSDSeverity(2)).toBe('minimal');
                expect(getPTSDSeverity(5)).toBe('mild');
                expect(getPTSDSeverity(7)).toBe('mild');
                expect(getPTSDSeverity(12)).toBe('moderate');
                expect(getPTSDSeverity(14)).toBe('moderate');
                expect(getPTSDSeverity(18)).toBe('severe');
                expect(getPTSDSeverity(20)).toBe('severe');
            });
        });
    });
    describe('handleAssessmentChange', () => {
        beforeEach(() => {
            prismaService.preAssessment.findUnique.mockResolvedValue(mockPreAssessment);
            prismaService.community.findMany.mockResolvedValue([
                { slug: 'depression-support', name: 'Depression Support Network' },
                { slug: 'anxiety-warriors', name: 'Anxiety Warriors' },
            ]);
            prismaService.community.findUnique.mockResolvedValue(mockCommunity);
        });
        it('should handle assessment change and generate new recommendations', async () => {
            await service.handleAssessmentChange('user-123', 'phq9');
            expect(loggerSpy).toHaveBeenCalledWith('Assessment change detected for user user-123: phq9');
            expect(loggerSpy).toHaveBeenCalledWith(expect.stringContaining('Generated'));
            expect(loggerSpy).toHaveBeenCalledWith(expect.stringContaining('new recommendations for user user-123'));
        });
        it('should handle errors during recommendation generation', async () => {
            prismaService.preAssessment.findUnique.mockRejectedValue(new Error('Database error'));
            const errorSpy = jest.spyOn(common_1.Logger.prototype, 'error').mockImplementation();
            await service.handleAssessmentChange('user-123', 'gad7');
            expect(errorSpy).toHaveBeenCalledWith(expect.stringContaining('Error handling assessment change for user user-123'), expect.any(Error));
        });
        it('should log when no new recommendations are generated', async () => {
            prismaService.preAssessment.findUnique.mockResolvedValue(null); // No assessment
            await service.handleAssessmentChange('user-123', 'ptsd5');
            expect(loggerSpy).toHaveBeenCalledWith('Generated 0 new recommendations for user user-123');
        });
    });
    describe('edge cases and error handling', () => {
        it('should handle empty community list', async () => {
            prismaService.preAssessment.findUnique.mockResolvedValue(mockPreAssessment);
            prismaService.community.findMany.mockResolvedValue([]);
            const result = await service.getRecommendationsForUser('user-123');
            expect(result).toEqual([]);
        });
        it('should handle malformed assessment scores', async () => {
            const malformedAssessment = {
                ...mockPreAssessment,
                scores: 'invalid-scores', // Should be object
                severityLevels: null,
            };
            prismaService.preAssessment.findUnique.mockResolvedValue(malformedAssessment);
            const getUserAssessmentProfile = service.getUserAssessmentProfile.bind(service);
            const result = await getUserAssessmentProfile('user-123');
            expect(result.assessments).toEqual({});
        });
        it('should handle very high scores correctly', async () => {
            const highScoreAssessment = {
                ...mockPreAssessment,
                scores: {
                    phq9Score: 50, // Beyond normal range
                    gad7Score: 100,
                    ptsd5Score: 200,
                },
            };
            prismaService.preAssessment.findUnique.mockResolvedValue(highScoreAssessment);
            const getUserAssessmentProfile = service.getUserAssessmentProfile.bind(service);
            const result = await getUserAssessmentProfile('user-123');
            expect(result.assessments.phq9.severity).toBe('severe');
            expect(result.assessments.gad7.severity).toBe('severe');
            expect(result.assessments.ptsd5.severity).toBe('severe');
        });
        it('should handle negative scores correctly', async () => {
            const negativeScoreAssessment = {
                ...mockPreAssessment,
                scores: {
                    phq9Score: -5, // Invalid negative score
                    gad7Score: -1,
                    ptsd5Score: -10,
                },
            };
            prismaService.preAssessment.findUnique.mockResolvedValue(negativeScoreAssessment);
            const getUserAssessmentProfile = service.getUserAssessmentProfile.bind(service);
            const result = await getUserAssessmentProfile('user-123');
            // Should still process negative scores (might be data error)
            expect(result.assessments.phq9.severity).toBe('minimal'); // Negative treated as minimal
            expect(result.assessments.gad7.severity).toBe('minimal');
            expect(result.assessments.ptsd5.severity).toBe('minimal');
        });
        it('should handle concurrent assessment changes', async () => {
            prismaService.preAssessment.findUnique.mockResolvedValue(mockPreAssessment);
            prismaService.community.findMany.mockResolvedValue([
                { slug: 'depression-support', name: 'Depression Support Network' },
            ]);
            prismaService.community.findUnique.mockResolvedValue(mockCommunity);
            // Simulate concurrent changes
            const promises = [
                service.handleAssessmentChange('user-123', 'phq9'),
                service.handleAssessmentChange('user-123', 'gad7'),
                service.handleAssessmentChange('user-123', 'ptsd5'),
            ];
            await Promise.all(promises);
            // Should handle all changes without errors
            expect(loggerSpy).toHaveBeenCalledTimes(6); // 2 logs per change * 3 changes
        });
        it('should handle assessment community mapping edge cases', () => {
            const getAssessmentCommunityMappings = service.getAssessmentCommunityMappings.bind(service);
            const mappings = getAssessmentCommunityMappings();
            // Verify all mappings have required properties
            Object.values(mappings).forEach((mapping) => {
                expect(mapping).toHaveProperty('score');
                expect(mapping).toHaveProperty('communities');
                expect(mapping).toHaveProperty('weight');
                expect(Array.isArray(mapping.communities)).toBe(true);
                expect(typeof mapping.weight).toBe('number');
                expect(mapping.weight).toBeGreaterThan(0);
                expect(mapping.weight).toBeLessThanOrEqual(1);
            });
        });
        it('should normalize compatibility scores to 0-1 range', async () => {
            // Test with very high contributions that might exceed 1.0
            const highContributionProfile = {
                userId: 'user-123',
                assessments: {
                    phq9: {
                        score: 27, // Maximum PHQ-9 score
                        severity: 'severe',
                        date: new Date('2024-01-01'),
                    },
                    gad7: {
                        score: 21, // Maximum GAD-7 score
                        severity: 'severe',
                        date: new Date('2024-01-01'),
                    },
                    ptsd5: {
                        score: 20, // Maximum PTSD-5 score
                        severity: 'severe',
                        date: new Date('2024-01-01'),
                    },
                },
            };
            prismaService.community.findUnique.mockResolvedValue(mockCommunity);
            const result = await service.calculateCompatibilityScore(highContributionProfile, 'depression-support');
            expect(result.compatibilityScore).toBeLessThanOrEqual(1.0);
            expect(result.compatibilityScore).toBeGreaterThanOrEqual(0);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL2NvbW11bml0aWVzL3NlcnZpY2VzL2NvbW11bml0eS1tYXRjaGluZy5zZXJ2aWNlLnNwZWMudHMiLCJtYXBwaW5ncyI6Ijs7QUFBQSw2Q0FBc0Q7QUFDdEQsMkNBQXdDO0FBQ3hDLDZFQUF3RTtBQUN4RSxtRkFBdUU7QUFFdkUsUUFBUSxDQUFDLDBCQUEwQixFQUFFLEdBQUcsRUFBRTtJQUN4QyxJQUFJLE9BQWlDLENBQUM7SUFDdEMsSUFBSSxhQUF5QyxDQUFDO0lBQzlDLElBQUksU0FBMkIsQ0FBQztJQUVoQyxZQUFZO0lBQ1osTUFBTSxhQUFhLEdBQUc7UUFDcEIsRUFBRSxFQUFFLGVBQWU7UUFDbkIsSUFBSSxFQUFFLDRCQUE0QjtRQUNsQyxJQUFJLEVBQUUsb0JBQW9CO1FBQzFCLFdBQVcsRUFBRSx1Q0FBdUM7UUFDcEQsUUFBUSxFQUFFLFdBQVc7UUFDckIsU0FBUyxFQUFFLElBQUksSUFBSSxDQUFDLFlBQVksQ0FBQztRQUNqQyxTQUFTLEVBQUUsSUFBSSxJQUFJLENBQUMsWUFBWSxDQUFDO0tBQ2xDLENBQUM7SUFFRixNQUFNLG9CQUFvQixHQUFHO1FBQzNCLEVBQUUsRUFBRSxlQUFlO1FBQ25CLElBQUksRUFBRSxrQkFBa0I7UUFDeEIsSUFBSSxFQUFFLGtCQUFrQjtRQUN4QixXQUFXLEVBQUUsb0NBQW9DO1FBQ2pELFFBQVEsRUFBRSxhQUFhO1FBQ3ZCLFNBQVMsRUFBRSxJQUFJLElBQUksQ0FBQyxZQUFZLENBQUM7UUFDakMsU0FBUyxFQUFFLElBQUksSUFBSSxDQUFDLFlBQVksQ0FBQztLQUNsQyxDQUFDO0lBRUYsTUFBTSxpQkFBaUIsR0FBRztRQUN4QixFQUFFLEVBQUUsZUFBZTtRQUNuQixJQUFJLEVBQUUsc0JBQXNCO1FBQzVCLElBQUksRUFBRSxjQUFjO1FBQ3BCLFdBQVcsRUFBRSxpQ0FBaUM7UUFDOUMsUUFBUSxFQUFFLFVBQVU7UUFDcEIsU0FBUyxF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cyI6WyIvaG9tZS93ZXRvb2EvRG9jdW1lbnRzL2NvZGUvcHJvamVjdHMvbWVudGFyYS9tZW50YXJhLWFwaS9zcmMvY29tbXVuaXRpZXMvc2VydmljZXMvY29tbXVuaXR5LW1hdGNoaW5nLnNlcnZpY2Uuc3BlYy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUZXN0LCBUZXN0aW5nTW9kdWxlIH0gZnJvbSAnQG5lc3Rqcy90ZXN0aW5nJztcbmltcG9ydCB7IExvZ2dlciB9IGZyb20gJ0BuZXN0anMvY29tbW9uJztcbmltcG9ydCB7IENvbW11bml0eU1hdGNoaW5nU2VydmljZSB9IGZyb20gJy4vY29tbXVuaXR5LW1hdGNoaW5nLnNlcnZpY2UnO1xuaW1wb3J0IHsgUHJpc21hU2VydmljZSB9IGZyb20gJy4uLy4uL3Byb3ZpZGVycy9wcmlzbWEtY2xpZW50LnByb3ZpZGVyJztcblxuZGVzY3JpYmUoJ0NvbW11bml0eU1hdGNoaW5nU2VydmljZScsICgpID0+IHtcbiAgbGV0IHNlcnZpY2U6IENvbW11bml0eU1hdGNoaW5nU2VydmljZTtcbiAgbGV0IHByaXNtYVNlcnZpY2U6IGplc3QuTW9ja2VkPFByaXNtYVNlcnZpY2U+O1xuICBsZXQgbG9nZ2VyU3B5OiBqZXN0LlNweUluc3RhbmNlO1xuXG4gIC8vIE1vY2sgZGF0YVxuICBjb25zdCBtb2NrQ29tbXVuaXR5ID0ge1xuICAgIGlkOiAnY29tbXVuaXR5LTEyMycsXG4gICAgbmFtZTogJ0RlcHJlc3Npb24gU3VwcG9ydCBOZXR3b3JrJyxcbiAgICBzbHVnOiAnZGVwcmVzc2lvbi1zdXBwb3J0JyxcbiAgICBkZXNjcmlwdGlvbjogJ0Egc3VwcG9ydGl2ZSBjb21tdW5pdHkgZm9yIGRlcHJlc3Npb24nLFxuICAgIGltYWdlVXJsOiAnaW1hZ2UuanBnJyxcbiAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCcyMDI0LTAxLTAxJyksXG4gICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgnMjAyNC0wMS0wMScpLFxuICB9O1xuXG4gIGNvbnN0IG1vY2tBbnhpZXR5Q29tbXVuaXR5ID0ge1xuICAgIGlkOiAnY29tbXVuaXR5LTQ1NicsXG4gICAgbmFtZTogJ0FueGlldHkgV2FycmlvcnMnLFxuICAgIHNsdWc6ICdhbnhpZXR5LXdhcnJpb3JzJyxcbiAgICBkZXNjcmlwdGlvbjogJ0Egc3VwcG9ydGl2ZSBjb21tdW5pdHkgZm9yIGFueGlldHknLFxuICAgIGltYWdlVXJsOiAnYW54aWV0eS5qcGcnLFxuICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoJzIwMjQtMDEtMDEnKSxcbiAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCcyMDI0LTAxLTAxJyksXG4gIH07XG5cbiAgY29uc3QgbW9ja1BUU0RDb21tdW5pdHkgPSB7XG4gICAgaWQ6ICdjb21tdW5pdHktNzg5JyxcbiAgICBuYW1lOiAnUFRTRCBTdXBwb3J0IE5ldHdvcmsnLFxuICAgIHNsdWc6ICdwdHNkLXN1cHBvcnQnLFxuICAgIGRlc2NyaXB0aW9uOiAnQSBzdXBwb3J0aXZlIGNvbW11bml0eSBmb3IgUFRTRCcsXG4gICAgaW1hZ2VVcmw6ICdwdHNkLmpwZycsXG4gICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgnMjAyNC0wMS0wMScpLFxuICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoJzIwMjQtMDEtMDEnKSxcbiAgfTtcblxuICBjb25zdCBtb2NrR2VuZXJhbENvbW11bml0eSA9IHtcbiAgICBpZDogJ2NvbW11bml0eS1nZW5lcmFsJyxcbiAgICBuYW1lOiAnR2VuZXJhbCBTdXBwb3J0JyxcbiAgICBzbHVnOiAnZ2VuZXJhbC1zdXBwb3J0JyxcbiAgICBkZXNjcmlwdGlvbjogJ0dlbmVyYWwgbWVudGFsIGhlYWx0aCBzdXBwb3J0JyxcbiAgICBpbWFnZVVybDogJ2dlbmVyYWwuanBnJyxcbiAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCcyMDI0LTAxLTAxJyksXG4gICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgnMjAyNC0wMS0wMScpLFxuICB9O1xuXG4gIGNvbnN0IG1vY2tQcmVBc3Nlc3NtZW50ID0ge1xuICAgIGlkOiAnYXNzZXNzbWVudC0xMjMnLFxuICAgIGNsaWVudElkOiAndXNlci0xMjMnLFxuICAgIHF1ZXN0aW9ubmFpcmVzOiBbJ3BocS05JywgJ2dhZC03JywgJ3B0c2QtNSddLFxuICAgIGFuc3dlcnM6IFtbMSwgMiwgM10sIFs0LCA1LCA2XSwgWzcsIDgsIDldXSxcbiAgICBhbnN3ZXJNYXRyaXg6IFtbMSwgMiwgM10sIFs0LCA1LCA2XSwgWzcsIDgsIDldXSxcbiAgICBzY29yZXM6IHtcbiAgICAgIHBocTlTY29yZTogMTUsIC8vIE1vZGVyYXRlbHkgc2V2ZXJlIGRlcHJlc3Npb25cbiAgICAgIGdhZDdTY29yZTogMTIsIC8vIE1vZGVyYXRlIGFueGlldHlcbiAgICAgIHB0c2Q1U2NvcmU6IDgsIC8vIE1vZGVyYXRlIFBUU0RcbiAgICB9LFxuICAgIHNldmVyaXR5TGV2ZWxzOiB7XG4gICAgICBwaHE5OiAnbW9kZXJhdGVseSBzZXZlcmUnLFxuICAgICAgZ2FkNzogJ21vZGVyYXRlJyxcbiAgICAgIHB0c2Q1OiAnbW9kZXJhdGUnLFxuICAgIH0sXG4gICAgYWlFc3RpbWF0ZTogeyBoYXNEZXByZXNzaW9uOiB0cnVlLCBoYXNBbnhpZXR5OiB0cnVlIH0sXG4gICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgnMjAyNC0wMS0wMScpLFxuICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoJzIwMjQtMDEtMDEnKSxcbiAgfTtcblxuICBjb25zdCBtb2NrVXNlckFzc2Vzc21lbnRQcm9maWxlID0ge1xuICAgIHVzZXJJZDogJ3VzZXItMTIzJyxcbiAgICBhc3Nlc3NtZW50czoge1xuICAgICAgcGhxOToge1xuICAgICAgICBzY29yZTogMTUsXG4gICAgICAgIHNldmVyaXR5OiAnbW9kZXJhdGVseSBzZXZlcmUnLFxuICAgICAgICBkYXRlOiBuZXcgRGF0ZSgnMjAyNC0wMS0wMScpLFxuICAgICAgfSxcbiAgICAgIGdhZDc6IHtcbiAgICAgICAgc2NvcmU6IDEyLFxuICAgICAgICBzZXZlcml0eTogJ21vZGVyYXRlJyxcbiAgICAgICAgZGF0ZTogbmV3IERhdGUoJzIwMjQtMDEtMDEnKSxcbiAgICAgIH0sXG4gICAgICBwdHNkNToge1xuICAgICAgICBzY29yZTogOCxcbiAgICAgICAgc2V2ZXJpdHk6ICdtb2RlcmF0ZScsXG4gICAgICAgIGRhdGU6IG5ldyBEYXRlKCcyMDI0LTAxLTAxJyksXG4gICAgICB9LFxuICAgIH0sXG4gIH07XG5cbiAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgbW9ja1ByaXNtYVNlcnZpY2UgPSB7XG4gICAgICBjb21tdW5pdHk6IHtcbiAgICAgICAgZmluZFVuaXF1ZTogamVzdC5mbigpLFxuICAgICAgICBmaW5kTWFueTogamVzdC5mbigpLFxuICAgICAgfSxcbiAgICAgIHByZUFzc2Vzc21lbnQ6IHtcbiAgICAgICAgZmluZFVuaXF1ZTogamVzdC5mbigpLFxuICAgICAgICBmaW5kRmlyc3Q6IGplc3QuZm4oKSxcbiAgICAgIH0sXG4gICAgfTtcblxuICAgIGNvbnN0IG1vZHVsZTogVGVzdGluZ01vZHVsZSA9IGF3YWl0IFRlc3QuY3JlYXRlVGVzdGluZ01vZHVsZSh7XG4gICAgICBwcm92aWRlcnM6IFtcbiAgICAgICAgQ29tbXVuaXR5TWF0Y2hpbmdTZXJ2aWNlLFxuICAgICAgICB7XG4gICAgICAgICAgcHJvdmlkZTogUHJpc21hU2VydmljZSxcbiAgICAgICAgICB1c2VWYWx1ZTogbW9ja1ByaXNtYVNlcnZpY2UsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgIH0pLmNvbXBpbGUoKTtcblxuICAgIHNlcnZpY2UgPSBtb2R1bGUuZ2V0PENvbW11bml0eU1hdGNoaW5nU2VydmljZT4oQ29tbXVuaXR5TWF0Y2hpbmdTZXJ2aWNlKTtcbiAgICBwcmlzbWFTZXJ2aWNlID0gbW9kdWxlLmdldChQcmlzbWFTZXJ2aWNlKTtcblxuICAgIC8vIFNldHVwIGxvZ2dlciBzcGllc1xuICAgIGxvZ2dlclNweSA9IGplc3Quc3B5T24oTG9nZ2VyLnByb3RvdHlwZSwgJ2xvZycpLm1vY2tJbXBsZW1lbnRhdGlvbigpO1xuICAgIGplc3Quc3B5T24oTG9nZ2VyLnByb3RvdHlwZSwgJ3dhcm4nKS5tb2NrSW1wbGVtZW50YXRpb24oKTtcbiAgICBqZXN0LnNweU9uKExvZ2dlci5wcm90b3R5cGUsICdlcnJvcicpLm1vY2tJbXBsZW1lbnRhdGlvbigpO1xuICB9KTtcblxuICBhZnRlckVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGJlIGRlZmluZWQnLCAoKSA9PiB7XG4gICAgZXhwZWN0KHNlcnZpY2UpLnRvQmVEZWZpbmVkKCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdjYWxjdWxhdGVDb21wYXRpYmlsaXR5U2NvcmUnLCAoKSA9PiB7XG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICBwcmlzbWFTZXJ2aWNlLmNvbW11bml0eS5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tDb21tdW5pdHkpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjYWxjdWxhdGUgaGlnaCBjb21wYXRpYmlsaXR5IHNjb3JlIGZvciBtYXRjaGluZyBjb25kaXRpb25zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5jYWxjdWxhdGVDb21wYXRpYmlsaXR5U2NvcmUoXG4gICAgICAgIG1vY2tVc2VyQXNzZXNzbWVudFByb2ZpbGUsXG4gICAgICAgICdkZXByZXNzaW9uLXN1cHBvcnQnXG4gICAgICApO1xuXG4gICAgICBleHBlY3QocHJpc21hU2VydmljZS5jb21tdW5pdHkuZmluZFVuaXF1ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICB3aGVyZTogeyBzbHVnOiAnZGVwcmVzc2lvbi1zdXBwb3J0JyB9LFxuICAgICAgICBzZWxlY3Q6IHsgaWQ6IHRydWUsIG5hbWU6IHRydWUsIHNsdWc6IHRydWUgfSxcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHtcbiAgICAgICAgY29tbXVuaXR5SWQ6ICdjb21tdW5pdHktMTIzJyxcbiAgICAgICAgY29tbXVuaXR5U2x1ZzogJ2RlcHJlc3Npb24tc3VwcG9ydCcsXG4gICAgICAgIGNvbXBhdGliaWxpdHlTY29yZTogZXhwZWN0LmFueShOdW1iZXIpLFxuICAgICAgICByZWFzb25pbmc6IGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCdEZXByZXNzaW9uIFN1cHBvcnQgTmV0d29yaycpLFxuICAgICAgICBtYXRjaGluZ0ZhY3RvcnM6IGV4cGVjdC5hcnJheUNvbnRhaW5pbmcoWydQSFE5IChtb2RlcmF0ZWx5IHNldmVyZSknXSksXG4gICAgICAgIGFzc2Vzc21lbnRDb250cmlidXRpb25zOiBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgICAgcGhxOTogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgICAgc2NvcmU6IDE1LFxuICAgICAgICAgICAgd2VpZ2h0OiAwLjgsXG4gICAgICAgICAgICBjb250cmlidXRpb246IGV4cGVjdC5hbnkoTnVtYmVyKSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgfSksXG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5jb21wYXRpYmlsaXR5U2NvcmUpLnRvQmVHcmVhdGVyVGhhbigwLjcpOyAvLyBIaWdoIGNvbXBhdGliaWxpdHlcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY2FsY3VsYXRlIG1vZGVyYXRlIGNvbXBhdGliaWxpdHkgZm9yIGdlbmVyYWwgY29tbXVuaXRpZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBwcmlzbWFTZXJ2aWNlLmNvbW11bml0eS5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tHZW5lcmFsQ29tbXVuaXR5KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5jYWxjdWxhdGVDb21wYXRpYmlsaXR5U2NvcmUoXG4gICAgICAgIG1vY2tVc2VyQXNzZXNzbWVudFByb2ZpbGUsXG4gICAgICAgICdnZW5lcmFsLXN1cHBvcnQnXG4gICAgICApO1xuXG4gICAgICBleHBlY3QocmVzdWx0LmNvbXBhdGliaWxpdHlTY29yZSkudG9CZUxlc3NUaGFuKDAuOSk7IC8vIFNob3VsZCBiZSBsb3dlciBkdWUgdG8gZ2VuZXJhbCBjb21tdW5pdHkgcGVuYWx0eVxuICAgICAgZXhwZWN0KHJlc3VsdC5jb21tdW5pdHlTbHVnKS50b0JlKCdnZW5lcmFsLXN1cHBvcnQnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdGhyb3cgZXJyb3IgZm9yIG5vbi1leGlzdGVudCBjb21tdW5pdHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBwcmlzbWFTZXJ2aWNlLmNvbW11bml0eS5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIHNlcnZpY2UuY2FsY3VsYXRlQ29tcGF0aWJpbGl0eVNjb3JlKG1vY2tVc2VyQXNzZXNzbWVudFByb2ZpbGUsICdub24tZXhpc3RlbnQtY29tbXVuaXR5JylcbiAgICAgICkucmVqZWN0cy50b1Rocm93KCdDb21tdW5pdHkgbm90IGZvdW5kOiBub24tZXhpc3RlbnQtY29tbXVuaXR5Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiB6ZXJvIGNvbXBhdGliaWxpdHkgd2hlbiBubyBhc3Nlc3NtZW50cyBtYXRjaCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG5vTWF0Y2hQcm9maWxlID0ge1xuICAgICAgICB1c2VySWQ6ICd1c2VyLTEyMycsXG4gICAgICAgIGFzc2Vzc21lbnRzOiB7XG4gICAgICAgICAgdW5rbm93bkFzc2Vzc21lbnQ6IHtcbiAgICAgICAgICAgIHNjb3JlOiAxNSxcbiAgICAgICAgICAgIHNldmVyaXR5OiAnbW9kZXJhdGUnLFxuICAgICAgICAgICAgZGF0ZTogbmV3IERhdGUoJzIwMjQtMDEtMDEnKSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5jYWxjdWxhdGVDb21wYXRpYmlsaXR5U2NvcmUoXG4gICAgICAgIG5vTWF0Y2hQcm9maWxlLFxuICAgICAgICAnZGVwcmVzc2lvbi1zdXBwb3J0J1xuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5jb21wYXRpYmlsaXR5U2NvcmUpLnRvQmUoMCk7XG4gICAgICBleHBlY3QocmVzdWx0Lm1hdGNoaW5nRmFjdG9ycykudG9FcXVhbChbXSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFwcGx5IHNwZWNpZmljaXR5IGJvbnVzIGZvciB0YXJnZXRlZCBjb21tdW5pdGllcycsIGFzeW5jICgpID0+IHtcbiAgICAgIHByaXNtYVNlcnZpY2UuY29tbXVuaXR5LmZpbmRVbmlxdWUubW9ja1Jlc29sdmVkVmFsdWUobW9ja0NvbW11bml0eSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuY2FsY3VsYXRlQ29tcGF0aWJpbGl0eVNjb3JlKFxuICAgICAgICBtb2NrVXNlckFzc2Vzc21lbnRQcm9maWxlLFxuICAgICAgICAnZGVwcmVzc2lvbi1zdXBwb3J0J1xuICAgICAgKTtcblxuICAgICAgLy8gRGVwcmVzc2lvbi1zdXBwb3J0IGlzIGEgc3BlY2lmaWMgY29tbXVuaXR5IGZvciBQSFEtOSwgc2hvdWxkIGdldCBib251c1xuICAgICAgZXhwZWN0KHJlc3VsdC5jb21wYXRpYmlsaXR5U2NvcmUpLnRvQmVHcmVhdGVyVGhhbigwLjcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhcHBseSBnZW5lcmFsIGNvbW11bml0eSBwZW5hbHR5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgcHJpc21hU2VydmljZS5jb21tdW5pdHkuZmluZFVuaXF1ZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrR2VuZXJhbENvbW11bml0eSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuY2FsY3VsYXRlQ29tcGF0aWJpbGl0eVNjb3JlKFxuICAgICAgICBtb2NrVXNlckFzc2Vzc21lbnRQcm9maWxlLFxuICAgICAgICAnZ2VuZXJhbC1zdXBwb3J0J1xuICAgICAgKTtcblxuICAgICAgLy8gR2VuZXJhbCBjb21tdW5pdGllcyBnZXQgcGVuYWx0eVxuICAgICAgZXhwZWN0KHJlc3VsdC5hc3Nlc3NtZW50Q29udHJpYnV0aW9ucy5waHE5LmNvbnRyaWJ1dGlvbikudG9CZUxlc3NUaGFuKFxuICAgICAgICAwLjggKiAxLjAgKiAwLjggLy8gd2VpZ2h0ICogc2V2ZXJpdHkgKiBmdWxsIHNwZWNpZmljaXR5XG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbXVsdGlwbGUgYXNzZXNzbWVudCBjb250cmlidXRpb25zIGNvcnJlY3RseScsIGFzeW5jICgpID0+IHtcbiAgICAgIHByaXNtYVNlcnZpY2UuY29tbXVuaXR5LmZpbmRVbmlxdWUubW9ja1Jlc29sdmVkVmFsdWUobW9ja0FueGlldHlDb21tdW5pdHkpO1xuXG4gICAgICBjb25zdCBtdWx0aUFzc2Vzc21lbnRQcm9maWxlID0ge1xuICAgICAgICB1c2VySWQ6ICd1c2VyLTEyMycsXG4gICAgICAgIGFzc2Vzc21lbnRzOiB7XG4gICAgICAgICAgZ2FkNzoge1xuICAgICAgICAgICAgc2NvcmU6IDE1LFxuICAgICAgICAgICAgc2V2ZXJpdHk6ICdzZXZlcmUnLFxuICAgICAgICAgICAgZGF0ZTogbmV3IERhdGUoJzIwMjQtMDEtMDEnKSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHBocTk6IHtcbiAgICAgICAgICAgIHNjb3JlOiAxMCxcbiAgICAgICAgICAgIHNldmVyaXR5OiAnbW9kZXJhdGUnLFxuICAgICAgICAgICAgZGF0ZTogbmV3IERhdGUoJzIwMjQtMDEtMDEnKSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5jYWxjdWxhdGVDb21wYXRpYmlsaXR5U2NvcmUoXG4gICAgICAgIG11bHRpQXNzZXNzbWVudFByb2ZpbGUsXG4gICAgICAgICdhbnhpZXR5LXdhcnJpb3JzJ1xuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5tYXRjaGluZ0ZhY3RvcnMpLnRvQ29udGFpbignR0FENyAoc2V2ZXJlKScpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5hc3Nlc3NtZW50Q29udHJpYnV0aW9ucykudG9IYXZlUHJvcGVydHkoJ2dhZDcnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuYXNzZXNzbWVudENvbnRyaWJ1dGlvbnMuZ2FkNy5zY29yZSkudG9CZSgxNSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdnZXRTZXZlcml0eU11bHRpcGxpZXInLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gY29ycmVjdCBtdWx0aXBsaWVycyBmb3IgUEhRLTkgc2NvcmVzJywgKCkgPT4ge1xuICAgICAgY29uc3QgZ2V0U2V2ZXJpdHlNdWx0aXBsaWVyID0gKHNlcnZpY2UgYXMgYW55KS5nZXRTZXZlcml0eU11bHRpcGxpZXIuYmluZChzZXJ2aWNlKTtcblxuICAgICAgZXhwZWN0KGdldFNldmVyaXR5TXVsdGlwbGllcigncGhxOScsIDIpKS50b0JlKDAuMyk7IC8vIE1pbmltYWxcbiAgICAgIGV4cGVjdChnZXRTZXZlcml0eU11bHRpcGxpZXIoJ3BocTknLCA3KSkudG9CZSgwLjYpOyAvLyBNaWxkXG4gICAgICBleHBlY3QoZ2V0U2V2ZXJpdHlNdWx0aXBsaWVyKCdwaHE5JywgMTIpKS50b0JlKDAuOSk7IC8vIE1vZGVyYXRlXG4gICAgICBleHBlY3QoZ2V0U2V2ZXJpdHlNdWx0aXBsaWVyKCdwaHE5JywgMTcpKS50b0JlKDEuMCk7IC8vIE1vZGVyYXRlbHkgc2V2ZXJlXG4gICAgICBleHBlY3QoZ2V0U2V2ZXJpdHlNdWx0aXBsaWVyKCdwaHE5JywgMjUpKS50b0JlKDEuMCk7IC8vIFNldmVyZVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gY29ycmVjdCBtdWx0aXBsaWVycyBmb3IgR0FELTcgc2NvcmVzJywgKCkgPT4ge1xuICAgICAgY29uc3QgZ2V0U2V2ZXJpdHlNdWx0aXBsaWVyID0gKHNlcnZpY2UgYXMgYW55KS5nZXRTZXZlcml0eU11bHRpcGxpZXIuYmluZChzZXJ2aWNlKTtcblxuICAgICAgZXhwZWN0KGdldFNldmVyaXR5TXVsdGlwbGllcignZ2FkNycsIDMpKS50b0JlKDAuMyk7IC8vIE1pbmltYWxcbiAgICAgIGV4cGVjdChnZXRTZXZlcml0eU11bHRpcGxpZXIoJ2dhZDcnLCA4KSkudG9CZSgwLjYpOyAvLyBNaWxkXG4gICAgICBleHBlY3QoZ2V0U2V2ZXJpdHlNdWx0aXBsaWVyKCdnYWQ3JywgMTMpKS50b0JlKDAuOSk7IC8vIE1vZGVyYXRlXG4gICAgICBleHBlY3QoZ2V0U2V2ZXJpdHlNdWx0aXBsaWVyKCdnYWQ3JywgMTgpKS50b0JlKDEuMCk7IC8vIFNldmVyZVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gY29ycmVjdCBtdWx0aXBsaWVycyBmb3IgUFRTRC01IHNjb3JlcycsICgpID0+IHtcbiAgICAgIGNvbnN0IGdldFNldmVyaXR5TXVsdGlwbGllciA9IChzZXJ2aWNlIGFzIGFueSkuZ2V0U2V2ZXJpdHlNdWx0aXBsaWVyLmJpbmQoc2VydmljZSk7XG5cbiAgICAgIGV4cGVjdChnZXRTZXZlcml0eU11bHRpcGxpZXIoJ3B0c2Q1JywgMSkpLnRvQmUoMC4zKTsgLy8gTWluaW1hbFxuICAgICAgZXhwZWN0KGdldFNldmVyaXR5TXVsdGlwbGllcigncHRzZDUnLCA1KSkudG9CZSgwLjYpOyAvLyBNaWxkXG4gICAgICBleHBlY3QoZ2V0U2V2ZXJpdHlNdWx0aXBsaWVyKCdwdHNkNScsIDEyKSkudG9CZSgwLjkpOyAvLyBNb2RlcmF0ZVxuICAgICAgZXhwZWN0KGdldFNldmVyaXR5TXVsdGlwbGllcigncHRzZDUnLCAxOCkpLnRvQmUoMS4wKTsgLy8gU2V2ZXJlXG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBkZWZhdWx0IG11bHRpcGxpZXIgZm9yIHVua25vd24gYXNzZXNzbWVudCB0eXBlcycsICgpID0+IHtcbiAgICAgIGNvbnN0IGdldFNldmVyaXR5TXVsdGlwbGllciA9IChzZXJ2aWNlIGFzIGFueSkuZ2V0U2V2ZXJpdHlNdWx0aXBsaWVyLmJpbmQoc2VydmljZSk7XG5cbiAgICAgIGV4cGVjdChnZXRTZXZlcml0eU11bHRpcGxpZXIoJ3Vua25vd24tYXNzZXNzbWVudCcsIDE1KSkudG9CZSgwLjUpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZ2V0Q29tbXVuaXR5U3BlY2lmaWNpdHlCb251cycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiBib251cyBmb3Igc3BlY2lmaWMgY29tbXVuaXR5IG1hdGNoZXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBnZXRDb21tdW5pdHlTcGVjaWZpY2l0eUJvbnVzID0gKHNlcnZpY2UgYXMgYW55KS5nZXRDb21tdW5pdHlTcGVjaWZpY2l0eUJvbnVzLmJpbmQoc2VydmljZSk7XG5cbiAgICAgIGV4cGVjdChnZXRDb21tdW5pdHlTcGVjaWZpY2l0eUJvbnVzKCdkZXByZXNzaW9uLXN1cHBvcnQnLCAncGhxOScpKS50b0JlKDEuMik7XG4gICAgICBleHBlY3QoZ2V0Q29tbXVuaXR5U3BlY2lmaWNpdHlCb251cygnYW54aWV0eS1zdXBwb3J0JywgJ2dhZDcnKSkudG9CZSgxLjIpO1xuICAgICAgZXhwZWN0KGdldENvbW11bml0eVNwZWNpZmljaXR5Qm9udXMoJ3B0c2Qtc3VwcG9ydCcsICdwdHNkNScpKS50b0JlKDEuMik7XG4gICAgICBleHBlY3QoZ2V0Q29tbXVuaXR5U3BlY2lmaWNpdHlCb251cygndHJhdW1hLXJlY292ZXJ5JywgJ3B0c2Q1JykpLnRvQmUoMS4yKTtcbiAgICAgIGV4cGVjdChnZXRDb21tdW5pdHlTcGVjaWZpY2l0eUJvbnVzKCdwYW5pYy1kaXNvcmRlcicsICdnYWQ3JykpLnRvQmUoMS4yKTtcbiAgICAgIGV4cGVjdChnZXRDb21tdW5pdHlTcGVjaWZpY2l0eUJvbnVzKCdzb2NpYWwtYW54aWV0eScsICdnYWQ3JykpLnRvQmUoMS4yKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIHBlbmFsdHkgZm9yIGdlbmVyYWwgY29tbXVuaXRpZXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBnZXRDb21tdW5pdHlTcGVjaWZpY2l0eUJvbnVzID0gKHNlcnZpY2UgYXMgYW55KS5nZXRDb21tdW5pdHlTcGVjaWZpY2l0eUJvbnVzLmJpbmQoc2VydmljZSk7XG5cbiAgICAgIGV4cGVjdChnZXRDb21tdW5pdHlTcGVjaWZpY2l0eUJvbnVzKCdnZW5lcmFsLXN1cHBvcnQnLCAncGhxOScpKS50b0JlKDAuOCk7XG4gICAgICBleHBlY3QoZ2V0Q29tbXVuaXR5U3BlY2lmaWNpdHlCb251cygnbWVudGFsLXdlbGxuZXNzJywgJ2dhZDcnKSkudG9CZSgwLjgpO1xuICAgICAgZXhwZWN0KGdldENvbW11bml0eVNwZWNpZmljaXR5Qm9udXMoJ3RoZXJhcHktZGlzY3Vzc2lvbicsICdwdHNkNScpKS50b0JlKDAuOCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBuZXV0cmFsIG11bHRpcGxpZXIgZm9yIG90aGVyIGNvbW11bml0aWVzJywgKCkgPT4ge1xuICAgICAgY29uc3QgZ2V0Q29tbXVuaXR5U3BlY2lmaWNpdHlCb251cyA9IChzZXJ2aWNlIGFzIGFueSkuZ2V0Q29tbXVuaXR5U3BlY2lmaWNpdHlCb251cy5iaW5kKHNlcnZpY2UpO1xuXG4gICAgICBleHBlY3QoZ2V0Q29tbXVuaXR5U3BlY2lmaWNpdHlCb251cygnb3RoZXItY29tbXVuaXR5JywgJ3BocTknKSkudG9CZSgxLjApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZ2VuZXJhdGVSZWFzb25pbmdUZXh0JywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZ2VuZXJhdGUgYXBwcm9wcmlhdGUgdGV4dCBmb3IgaGlnaCBjb21wYXRpYmlsaXR5JywgKCkgPT4ge1xuICAgICAgY29uc3QgZ2VuZXJhdGVSZWFzb25pbmdUZXh0ID0gKHNlcnZpY2UgYXMgYW55KS5nZW5lcmF0ZVJlYXNvbmluZ1RleHQuYmluZChzZXJ2aWNlKTtcblxuICAgICAgY29uc3QgcmVhc29uaW5nID0gZ2VuZXJhdGVSZWFzb25pbmdUZXh0KFxuICAgICAgICAnRGVwcmVzc2lvbiBTdXBwb3J0IE5ldHdvcmsnLFxuICAgICAgICBbJ1BIUTkgKG1vZGVyYXRlbHkgc2V2ZXJlKSddLFxuICAgICAgICAwLjg1LFxuICAgICAgICB7IHBocTk6IHsgc2NvcmU6IDE1LCB3ZWlnaHQ6IDAuOCwgY29udHJpYnV0aW9uOiAwLjY4IH0gfVxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHJlYXNvbmluZykudG9Db250YWluKCc4NSUgY29tcGF0aWJpbGl0eScpO1xuICAgICAgZXhwZWN0KHJlYXNvbmluZykudG9Db250YWluKCdEZXByZXNzaW9uIFN1cHBvcnQgTmV0d29yaycpO1xuICAgICAgZXhwZWN0KHJlYXNvbmluZykudG9Db250YWluKCdQSFE5IChtb2RlcmF0ZWx5IHNldmVyZSknKTtcbiAgICAgIGV4cGVjdChyZWFzb25pbmcpLnRvQ29udGFpbignZXhjZWxsZW50IG1hdGNoJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGdlbmVyYXRlIGFwcHJvcHJpYXRlIHRleHQgZm9yIG1vZGVyYXRlIGNvbXBhdGliaWxpdHknLCAoKSA9PiB7XG4gICAgICBjb25zdCBnZW5lcmF0ZVJlYXNvbmluZ1RleHQgPSAoc2VydmljZSBhcyBhbnkpLmdlbmVyYXRlUmVhc29uaW5nVGV4dC5iaW5kKHNlcnZpY2UpO1xuXG4gICAgICBjb25zdCByZWFzb25pbmcgPSBnZW5lcmF0ZVJlYXNvbmluZ1RleHQoXG4gICAgICAgICdHZW5lcmFsIFN1cHBvcnQnLFxuICAgICAgICBbJ1BIUTkgKG1pbGQpJ10sXG4gICAgICAgIDAuNjUsXG4gICAgICAgIHsgcGhxOTogeyBzY29yZTogOCwgd2VpZ2h0OiAwLjgsIGNvbnRyaWJ1dGlvbjogMC41MiB9IH1cbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyZWFzb25pbmcpLnRvQ29udGFpbignNjUlIGNvbXBhdGliaWxpdHknKTtcbiAgICAgIGV4cGVjdChyZWFzb25pbmcpLnRvQ29udGFpbignZ29vZCBmaXQnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZ2VuZXJhdGUgYXBwcm9wcmlhdGUgdGV4dCBmb3IgbG93IGNvbXBhdGliaWxpdHknLCAoKSA9PiB7XG4gICAgICBjb25zdCBnZW5lcmF0ZVJlYXNvbmluZ1RleHQgPSAoc2VydmljZSBhcyBhbnkpLmdlbmVyYXRlUmVhc29uaW5nVGV4dC5iaW5kKHNlcnZpY2UpO1xuXG4gICAgICBjb25zdCByZWFzb25pbmcgPSBnZW5lcmF0ZVJlYXNvbmluZ1RleHQoXG4gICAgICAgICdTcGVjaWZpYyBDb21tdW5pdHknLFxuICAgICAgICBbJ0dBRDcgKG1pbmltYWwpJ10sXG4gICAgICAgIDAuMzUsXG4gICAgICAgIHsgZ2FkNzogeyBzY29yZTogMywgd2VpZ2h0OiAwLjcsIGNvbnRyaWJ1dGlvbjogMC4yMSB9IH1cbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyZWFzb25pbmcpLnRvQ29udGFpbignMzUlIGNvbXBhdGliaWxpdHknKTtcbiAgICAgIGV4cGVjdChyZWFzb25pbmcpLnRvQ29udGFpbignc29tZSByZWxldmFudCBzdXBwb3J0Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGdlbmVyYXRlIGFwcHJvcHJpYXRlIHRleHQgZm9yIHZlcnkgbG93IGNvbXBhdGliaWxpdHknLCAoKSA9PiB7XG4gICAgICBjb25zdCBnZW5lcmF0ZVJlYXNvbmluZ1RleHQgPSAoc2VydmljZSBhcyBhbnkpLmdlbmVyYXRlUmVhc29uaW5nVGV4dC5iaW5kKHNlcnZpY2UpO1xuXG4gICAgICBjb25zdCByZWFzb25pbmcgPSBnZW5lcmF0ZVJlYXNvbmluZ1RleHQoXG4gICAgICAgICdVbnJlbGF0ZWQgQ29tbXVuaXR5JyxcbiAgICAgICAgW10sXG4gICAgICAgIDAuMTUsXG4gICAgICAgIHt9XG4gICAgICApO1xuXG4gICAgICBleHBlY3QocmVhc29uaW5nKS50b0NvbnRhaW4oJzE1JSBjb21wYXRpYmlsaXR5Jyk7XG4gICAgICBleHBlY3QocmVhc29uaW5nKS50b0NvbnRhaW4oJ290aGVyIGNvbW11bml0aWVzIHRoYXQgYXJlIG1vcmUgc3BlY2lmaWNhbGx5IGFsaWduZWQnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGVtcHR5IG1hdGNoaW5nIGZhY3RvcnMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBnZW5lcmF0ZVJlYXNvbmluZ1RleHQgPSAoc2VydmljZSBhcyBhbnkpLmdlbmVyYXRlUmVhc29uaW5nVGV4dC5iaW5kKHNlcnZpY2UpO1xuXG4gICAgICBjb25zdCByZWFzb25pbmcgPSBnZW5lcmF0ZVJlYXNvbmluZ1RleHQoXG4gICAgICAgICdDb21tdW5pdHkgTmFtZScsXG4gICAgICAgIFtdLFxuICAgICAgICAwLjUsXG4gICAgICAgIHt9XG4gICAgICApO1xuXG4gICAgICBleHBlY3QocmVhc29uaW5nKS5ub3QudG9Db250YWluKCdUaGlzIHJlY29tbWVuZGF0aW9uIGlzIGJhc2VkIG9uIHlvdXInKTtcbiAgICAgIGV4cGVjdChyZWFzb25pbmcpLnRvQ29udGFpbignNTAlIGNvbXBhdGliaWxpdHknKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dldFJlY29tbWVuZGF0aW9uc0ZvclVzZXInLCAoKSA9PiB7XG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICBwcmlzbWFTZXJ2aWNlLnByZUFzc2Vzc21lbnQuZmluZFVuaXF1ZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUHJlQXNzZXNzbWVudCk7XG4gICAgICBwcmlzbWFTZXJ2aWNlLmNvbW11bml0eS5maW5kTWFueS5tb2NrUmVzb2x2ZWRWYWx1ZShbXG4gICAgICAgIHsgc2x1ZzogJ2RlcHJlc3Npb24tc3VwcG9ydCcsIG5hbWU6ICdEZXByZXNzaW9uIFN1cHBvcnQgTmV0d29yaycgfSxcbiAgICAgICAgeyBzbHVnOiAnYW54aWV0eS13YXJyaW9ycycsIG5hbWU6ICdBbnhpZXR5IFdhcnJpb3JzJyB9LFxuICAgICAgICB7IHNsdWc6ICdwdHNkLXN1cHBvcnQnLCBuYW1lOiAnUFRTRCBTdXBwb3J0IE5ldHdvcmsnIH0sXG4gICAgICAgIHsgc2x1ZzogJ2dlbmVyYWwtc3VwcG9ydCcsIG5hbWU6ICdHZW5lcmFsIFN1cHBvcnQnIH0sXG4gICAgICBdKTtcbiAgICAgIHByaXNtYVNlcnZpY2UuY29tbXVuaXR5LmZpbmRVbmlxdWUubW9ja0ltcGxlbWVudGF0aW9uKChhcmdzKSA9PiB7XG4gICAgICAgIGNvbnN0IHNsdWcgPSBhcmdzLndoZXJlLnNsdWc7XG4gICAgICAgIGlmIChzbHVnID09PSAnZGVwcmVzc2lvbi1zdXBwb3J0JykgcmV0dXJuIFByb21pc2UucmVzb2x2ZShtb2NrQ29tbXVuaXR5KTtcbiAgICAgICAgaWYgKHNsdWcgPT09ICdhbnhpZXR5LXdhcnJpb3JzJykgcmV0dXJuIFByb21pc2UucmVzb2x2ZShtb2NrQW54aWV0eUNvbW11bml0eSk7XG4gICAgICAgIGlmIChzbHVnID09PSAncHRzZC1zdXBwb3J0JykgcmV0dXJuIFByb21pc2UucmVzb2x2ZShtb2NrUFRTRENvbW11bml0eSk7XG4gICAgICAgIGlmIChzbHVnID09PSAnZ2VuZXJhbC1zdXBwb3J0JykgcmV0dXJuIFByb21pc2UucmVzb2x2ZShtb2NrR2VuZXJhbENvbW11bml0eSk7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobnVsbCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIHNvcnRlZCByZWNvbW1lbmRhdGlvbnMgZm9yIHVzZXInLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLmdldFJlY29tbWVuZGF0aW9uc0ZvclVzZXIoJ3VzZXItMTIzJyk7XG5cbiAgICAgIGV4cGVjdChwcmlzbWFTZXJ2aWNlLnByZUFzc2Vzc21lbnQuZmluZFVuaXF1ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICB3aGVyZTogeyBjbGllbnRJZDogJ3VzZXItMTIzJyB9LFxuICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICBzY29yZXM6IHRydWUsXG4gICAgICAgICAgc2V2ZXJpdHlMZXZlbHM6IHRydWUsXG4gICAgICAgICAgY3JlYXRlZEF0OiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChwcmlzbWFTZXJ2aWNlLmNvbW11bml0eS5maW5kTWFueSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICBzZWxlY3Q6IHsgc2x1ZzogdHJ1ZSwgbmFtZTogdHJ1ZSB9LFxuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVJbnN0YW5jZU9mKEFycmF5KTtcbiAgICAgIGV4cGVjdChyZXN1bHQubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG5cbiAgICAgIC8vIFNob3VsZCBiZSBzb3J0ZWQgYnkgY29tcGF0aWJpbGl0eSBzY29yZSAoaGlnaGVzdCBmaXJzdClcbiAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgcmVzdWx0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGV4cGVjdChyZXN1bHRbaS0xXS5jb21wYXRpYmlsaXR5U2NvcmUpLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwocmVzdWx0W2ldLmNvbXBhdGliaWxpdHlTY29yZSk7XG4gICAgICB9XG5cbiAgICAgIC8vIFNob3VsZCBvbmx5IGluY2x1ZGUgY29tbXVuaXRpZXMgd2l0aCA+MjAlIGNvbXBhdGliaWxpdHlcbiAgICAgIHJlc3VsdC5mb3JFYWNoKHJlY29tbWVuZGF0aW9uID0+IHtcbiAgICAgICAgZXhwZWN0KHJlY29tbWVuZGF0aW9uLmNvbXBhdGliaWxpdHlTY29yZSkudG9CZUdyZWF0ZXJUaGFuKDAuMik7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGVtcHR5IGFycmF5IHdoZW4gbm8gYXNzZXNzbWVudCBkYXRhIGV4aXN0cycsIGFzeW5jICgpID0+IHtcbiAgICAgIHByaXNtYVNlcnZpY2UucHJlQXNzZXNzbWVudC5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLmdldFJlY29tbWVuZGF0aW9uc0ZvclVzZXIoJ3VzZXItMTIzJyk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoW10pO1xuICAgICAgZXhwZWN0KGxvZ2dlclNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCdObyBhc3Nlc3NtZW50IGRhdGEgZm91bmQgZm9yIHVzZXIgdXNlci0xMjMnKVxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGVtcHR5IGFycmF5IHdoZW4gYXNzZXNzbWVudCBoYXMgbm8gc2NvcmVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZW1wdHlBc3Nlc3NtZW50ID0ge1xuICAgICAgICAuLi5tb2NrUHJlQXNzZXNzbWVudCxcbiAgICAgICAgc2NvcmVzOiB7fSxcbiAgICAgICAgc2V2ZXJpdHlMZXZlbHM6IHt9LFxuICAgICAgfTtcbiAgICAgIHByaXNtYVNlcnZpY2UucHJlQXNzZXNzbWVudC5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKGVtcHR5QXNzZXNzbWVudCk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuZ2V0UmVjb21tZW5kYXRpb25zRm9yVXNlcigndXNlci0xMjMnKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChbXSk7XG4gICAgICBleHBlY3QobG9nZ2VyU3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ05vIGFzc2Vzc21lbnQgZGF0YSBmb3VuZCBmb3IgdXNlciB1c2VyLTEyMycpXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBmaWx0ZXIgb3V0IGxvdyBjb21wYXRpYmlsaXR5IHJlY29tbWVuZGF0aW9ucycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgdmVyeSBsb3cgc2NvcmVzIHRoYXQgd291bGQgcmVzdWx0IGluIGxvdyBjb21wYXRpYmlsaXR5XG4gICAgICBjb25zdCBsb3dTY29yZUFzc2Vzc21lbnQgPSB7XG4gICAgICAgIC4uLm1vY2tQcmVBc3Nlc3NtZW50LFxuICAgICAgICBzY29yZXM6IHtcbiAgICAgICAgICBwaHE5U2NvcmU6IDEsIC8vIE1pbmltYWwgZGVwcmVzc2lvblxuICAgICAgICAgIGdhZDdTY29yZTogMSwgLy8gTWluaW1hbCBhbnhpZXR5XG4gICAgICAgIH0sXG4gICAgICAgIHNldmVyaXR5TGV2ZWxzOiB7XG4gICAgICAgICAgcGhxOTogJ21pbmltYWwnLFxuICAgICAgICAgIGdhZDc6ICdtaW5pbWFsJyxcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgICBwcmlzbWFTZXJ2aWNlLnByZUFzc2Vzc21lbnQuZmluZFVuaXF1ZS5tb2NrUmVzb2x2ZWRWYWx1ZShsb3dTY29yZUFzc2Vzc21lbnQpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLmdldFJlY29tbWVuZGF0aW9uc0ZvclVzZXIoJ3VzZXItMTIzJyk7XG5cbiAgICAgIC8vIFNob3VsZCBmaWx0ZXIgb3V0IHJlY29tbWVuZGF0aW9ucyB3aXRoIDwyMCUgY29tcGF0aWJpbGl0eVxuICAgICAgcmVzdWx0LmZvckVhY2gocmVjb21tZW5kYXRpb24gPT4ge1xuICAgICAgICBleHBlY3QocmVjb21tZW5kYXRpb24uY29tcGF0aWJpbGl0eVNjb3JlKS50b0JlR3JlYXRlclRoYW4oMC4yKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBsaW1pdCByZXN1bHRzIHRvIHRvcCAxMCByZWNvbW1lbmRhdGlvbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIG1hbnkgY29tbXVuaXRpZXNcbiAgICAgIGNvbnN0IG1hbnlDb21tdW5pdGllcyA9IEFycmF5LmZyb20oeyBsZW5ndGg6IDE1IH0sIChfLCBpKSA9PiAoe1xuICAgICAgICBzbHVnOiBgY29tbXVuaXR5LSR7aX1gLFxuICAgICAgICBuYW1lOiBgQ29tbXVuaXR5ICR7aX1gLFxuICAgICAgfSkpO1xuICAgICAgcHJpc21hU2VydmljZS5jb21tdW5pdHkuZmluZE1hbnkubW9ja1Jlc29sdmVkVmFsdWUobWFueUNvbW11bml0aWVzKTtcbiAgICAgIFxuICAgICAgLy8gTW9jayBhbGwgY29tbXVuaXRpZXMgYXMgZm91bmRcbiAgICAgIHByaXNtYVNlcnZpY2UuY29tbXVuaXR5LmZpbmRVbmlxdWUubW9ja1Jlc29sdmVkVmFsdWUobW9ja0NvbW11bml0eSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuZ2V0UmVjb21tZW5kYXRpb25zRm9yVXNlcigndXNlci0xMjMnKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5sZW5ndGgpLnRvQmVMZXNzVGhhbk9yRXF1YWwoMTApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZXJyb3JzIGZvciBpbmRpdmlkdWFsIGNvbW11bml0eSBjYWxjdWxhdGlvbnMgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIHByaXNtYVNlcnZpY2UuY29tbXVuaXR5LmZpbmRVbmlxdWUubW9ja0ltcGxlbWVudGF0aW9uKChhcmdzKSA9PiB7XG4gICAgICAgIGlmIChhcmdzLndoZXJlLnNsdWcgPT09ICdkZXByZXNzaW9uLXN1cHBvcnQnKSByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG1vY2tDb21tdW5pdHkpO1xuICAgICAgICBpZiAoYXJncy53aGVyZS5zbHVnID09PSAnYW54aWV0eS13YXJyaW9ycycpIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoJ0RhdGFiYXNlIGVycm9yJykpO1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG1vY2tHZW5lcmFsQ29tbXVuaXR5KTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBlcnJvclNweSA9IGplc3Quc3B5T24oTG9nZ2VyLnByb3RvdHlwZSwgJ2Vycm9yJykubW9ja0ltcGxlbWVudGF0aW9uKCk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuZ2V0UmVjb21tZW5kYXRpb25zRm9yVXNlcigndXNlci0xMjMnKTtcblxuICAgICAgZXhwZWN0KGVycm9yU3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ0Vycm9yIGNhbGN1bGF0aW5nIGNvbXBhdGliaWxpdHkgZm9yIGFueGlldHktd2FycmlvcnMnKSxcbiAgICAgICAgZXhwZWN0LmFueShFcnJvcilcbiAgICAgICk7XG5cbiAgICAgIC8vIFNob3VsZCBzdGlsbCByZXR1cm4gb3RoZXIgc3VjY2Vzc2Z1bCByZWNvbW1lbmRhdGlvbnNcbiAgICAgIGV4cGVjdChyZXN1bHQubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBkYXRhYmFzZSBlcnJvcnMgZHVyaW5nIHVzZXIgcHJvZmlsZSByZXRyaWV2YWwnLCBhc3luYyAoKSA9PiB7XG4gICAgICBwcmlzbWFTZXJ2aWNlLnByZUFzc2Vzc21lbnQuZmluZFVuaXF1ZS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ0RhdGFiYXNlIGVycm9yJykpO1xuXG4gICAgICBjb25zdCBlcnJvclNweSA9IGplc3Quc3B5T24oTG9nZ2VyLnByb3RvdHlwZSwgJ2Vycm9yJykubW9ja0ltcGxlbWVudGF0aW9uKCk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChzZXJ2aWNlLmdldFJlY29tbWVuZGF0aW9uc0ZvclVzZXIoJ3VzZXItMTIzJykpLnJlamVjdHMudG9UaHJvdygnRGF0YWJhc2UgZXJyb3InKTtcblxuICAgICAgZXhwZWN0KGVycm9yU3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ0Vycm9yIGdldHRpbmcgcmVjb21tZW5kYXRpb25zIGZvciB1c2VyIHVzZXItMTIzJyksXG4gICAgICAgIGV4cGVjdC5hbnkoRXJyb3IpXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZ2V0VXNlckFzc2Vzc21lbnRQcm9maWxlJywgKCkgPT4ge1xuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgcHJpc21hU2VydmljZS5wcmVBc3Nlc3NtZW50LmZpbmRVbmlxdWUubW9ja1Jlc29sdmVkVmFsdWUobW9ja1ByZUFzc2Vzc21lbnQpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBtYXAgUEhRLTkgc2NvcmVzIGNvcnJlY3RseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGdldFVzZXJBc3Nlc3NtZW50UHJvZmlsZSA9IChzZXJ2aWNlIGFzIGFueSkuZ2V0VXNlckFzc2Vzc21lbnRQcm9maWxlLmJpbmQoc2VydmljZSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdldFVzZXJBc3Nlc3NtZW50UHJvZmlsZSgndXNlci0xMjMnKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7XG4gICAgICAgIHVzZXJJZDogJ3VzZXItMTIzJyxcbiAgICAgICAgYXNzZXNzbWVudHM6IGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICBwaHE5OiBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgICAgICBzY29yZTogMTUsXG4gICAgICAgICAgICBzZXZlcml0eTogJ21vZGVyYXRlbHkgc2V2ZXJlJyxcbiAgICAgICAgICAgIGRhdGU6IGV4cGVjdC5hbnkoRGF0ZSksXG4gICAgICAgICAgfSksXG4gICAgICAgIH0pLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG1hcCBHQUQtNyBzY29yZXMgY29ycmVjdGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZ2V0VXNlckFzc2Vzc21lbnRQcm9maWxlID0gKHNlcnZpY2UgYXMgYW55KS5nZXRVc2VyQXNzZXNzbWVudFByb2ZpbGUuYmluZChzZXJ2aWNlKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2V0VXNlckFzc2Vzc21lbnRQcm9maWxlKCd1c2VyLTEyMycpO1xuXG4gICAgICBleHBlY3QocmVzdWx0LmFzc2Vzc21lbnRzKS50b0hhdmVQcm9wZXJ0eSgnZ2FkNycpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5hc3Nlc3NtZW50cy5nYWQ3LnNjb3JlKS50b0JlKDEyKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuYXNzZXNzbWVudHMuZ2FkNy5zZXZlcml0eSkudG9CZSgnbW9kZXJhdGUnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbWFwIFBUU0QtNSBzY29yZXMgY29ycmVjdGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZ2V0VXNlckFzc2Vzc21lbnRQcm9maWxlID0gKHNlcnZpY2UgYXMgYW55KS5nZXRVc2VyQXNzZXNzbWVudFByb2ZpbGUuYmluZChzZXJ2aWNlKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2V0VXNlckFzc2Vzc21lbnRQcm9maWxlKCd1c2VyLTEyMycpO1xuXG4gICAgICBleHBlY3QocmVzdWx0LmFzc2Vzc21lbnRzKS50b0hhdmVQcm9wZXJ0eSgncHRzZDUnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuYXNzZXNzbWVudHMucHRzZDUuc2NvcmUpLnRvQmUoOCk7XG4gICAgICBleHBlY3QocmVzdWx0LmFzc2Vzc21lbnRzLnB0c2Q1LnNldmVyaXR5KS50b0JlKCdtb2RlcmF0ZScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gbnVsbCB3aGVuIG5vIHByZS1hc3Nlc3NtZW50IGV4aXN0cycsIGFzeW5jICgpID0+IHtcbiAgICAgIHByaXNtYVNlcnZpY2UucHJlQXNzZXNzbWVudC5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpO1xuXG4gICAgICBjb25zdCBnZXRVc2VyQXNzZXNzbWVudFByb2ZpbGUgPSAoc2VydmljZSBhcyBhbnkpLmdldFVzZXJBc3Nlc3NtZW50UHJvZmlsZS5iaW5kKHNlcnZpY2UpO1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2V0VXNlckFzc2Vzc21lbnRQcm9maWxlKCd1c2VyLTEyMycpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlTnVsbCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbWlzc2luZyBzY29yZSBmaWVsZHMgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGluY29tcGxldGVBc3Nlc3NtZW50ID0ge1xuICAgICAgICAuLi5tb2NrUHJlQXNzZXNzbWVudCxcbiAgICAgICAgc2NvcmVzOiB7XG4gICAgICAgICAgcGhxOVNjb3JlOiAxNSxcbiAgICAgICAgICAvLyBNaXNzaW5nIGdhZDdTY29yZSBhbmQgcHRzZDVTY29yZVxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICAgIHByaXNtYVNlcnZpY2UucHJlQXNzZXNzbWVudC5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKGluY29tcGxldGVBc3Nlc3NtZW50KTtcblxuICAgICAgY29uc3QgZ2V0VXNlckFzc2Vzc21lbnRQcm9maWxlID0gKHNlcnZpY2UgYXMgYW55KS5nZXRVc2VyQXNzZXNzbWVudFByb2ZpbGUuYmluZChzZXJ2aWNlKTtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdldFVzZXJBc3Nlc3NtZW50UHJvZmlsZSgndXNlci0xMjMnKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5hc3Nlc3NtZW50cykudG9IYXZlUHJvcGVydHkoJ3BocTknKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuYXNzZXNzbWVudHMpLm5vdC50b0hhdmVQcm9wZXJ0eSgnZ2FkNycpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5hc3Nlc3NtZW50cykubm90LnRvSGF2ZVByb3BlcnR5KCdwdHNkNScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbnVsbC91bmRlZmluZWQgc2NvcmVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbnVsbFNjb3Jlc0Fzc2Vzc21lbnQgPSB7XG4gICAgICAgIC4uLm1vY2tQcmVBc3Nlc3NtZW50LFxuICAgICAgICBzY29yZXM6IHtcbiAgICAgICAgICBwaHE5U2NvcmU6IG51bGwsXG4gICAgICAgICAgZ2FkN1Njb3JlOiB1bmRlZmluZWQsXG4gICAgICAgICAgcHRzZDVTY29yZTogMCwgLy8gVmFsaWQgemVybyBzY29yZVxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICAgIHByaXNtYVNlcnZpY2UucHJlQXNzZXNzbWVudC5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKG51bGxTY29yZXNBc3Nlc3NtZW50KTtcblxuICAgICAgY29uc3QgZ2V0VXNlckFzc2Vzc21lbnRQcm9maWxlID0gKHNlcnZpY2UgYXMgYW55KS5nZXRVc2VyQXNzZXNzbWVudFByb2ZpbGUuYmluZChzZXJ2aWNlKTtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdldFVzZXJBc3Nlc3NtZW50UHJvZmlsZSgndXNlci0xMjMnKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5hc3Nlc3NtZW50cykubm90LnRvSGF2ZVByb3BlcnR5KCdwaHE5Jyk7XG4gICAgICBleHBlY3QocmVzdWx0LmFzc2Vzc21lbnRzKS5ub3QudG9IYXZlUHJvcGVydHkoJ2dhZDcnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuYXNzZXNzbWVudHMpLnRvSGF2ZVByb3BlcnR5KCdwdHNkNScpOyAvLyBaZXJvIGlzIHZhbGlkXG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBkYXRhYmFzZSBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBwcmlzbWFTZXJ2aWNlLnByZUFzc2Vzc21lbnQuZmluZFVuaXF1ZS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ0RhdGFiYXNlIGVycm9yJykpO1xuXG4gICAgICBjb25zdCBlcnJvclNweSA9IGplc3Quc3B5T24oTG9nZ2VyLnByb3RvdHlwZSwgJ2Vycm9yJykubW9ja0ltcGxlbWVudGF0aW9uKCk7XG4gICAgICBjb25zdCBnZXRVc2VyQXNzZXNzbWVudFByb2ZpbGUgPSAoc2VydmljZSBhcyBhbnkpLmdldFVzZXJBc3Nlc3NtZW50UHJvZmlsZS5iaW5kKHNlcnZpY2UpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRVc2VyQXNzZXNzbWVudFByb2ZpbGUoJ3VzZXItMTIzJyk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVOdWxsKCk7XG4gICAgICBleHBlY3QoZXJyb3JTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBleHBlY3Quc3RyaW5nQ29udGFpbmluZygnRXJyb3IgZ2V0dGluZyBhc3Nlc3NtZW50IHByb2ZpbGUgZm9yIHVzZXIgdXNlci0xMjMnKSxcbiAgICAgICAgZXhwZWN0LmFueShFcnJvcilcbiAgICAgICk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdzZXZlcml0eSBhc3Nlc3NtZW50IGhlbHBlcnMnLCAoKSA9PiB7XG4gICAgZGVzY3JpYmUoJ2dldERlcHJlc3Npb25TZXZlcml0eScsICgpID0+IHtcbiAgICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvcnJlY3Qgc2V2ZXJpdHkgbGV2ZWxzIGZvciBQSFEtOSBzY29yZXMnLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGdldERlcHJlc3Npb25TZXZlcml0eSA9IChzZXJ2aWNlIGFzIGFueSkuZ2V0RGVwcmVzc2lvblNldmVyaXR5LmJpbmQoc2VydmljZSk7XG5cbiAgICAgICAgZXhwZWN0KGdldERlcHJlc3Npb25TZXZlcml0eSgyKSkudG9CZSgnbWluaW1hbCcpO1xuICAgICAgICBleHBlY3QoZ2V0RGVwcmVzc2lvblNldmVyaXR5KDQpKS50b0JlKCdtaW5pbWFsJyk7XG4gICAgICAgIGV4cGVjdChnZXREZXByZXNzaW9uU2V2ZXJpdHkoNykpLnRvQmUoJ21pbGQnKTtcbiAgICAgICAgZXhwZWN0KGdldERlcHJlc3Npb25TZXZlcml0eSg5KSkudG9CZSgnbWlsZCcpO1xuICAgICAgICBleHBlY3QoZ2V0RGVwcmVzc2lvblNldmVyaXR5KDEyKSkudG9CZSgnbW9kZXJhdGUnKTtcbiAgICAgICAgZXhwZWN0KGdldERlcHJlc3Npb25TZXZlcml0eSgxNCkpLnRvQmUoJ21vZGVyYXRlJyk7XG4gICAgICAgIGV4cGVjdChnZXREZXByZXNzaW9uU2V2ZXJpdHkoMTcpKS50b0JlKCdtb2RlcmF0ZWx5IHNldmVyZScpO1xuICAgICAgICBleHBlY3QoZ2V0RGVwcmVzc2lvblNldmVyaXR5KDE5KSkudG9CZSgnbW9kZXJhdGVseSBzZXZlcmUnKTtcbiAgICAgICAgZXhwZWN0KGdldERlcHJlc3Npb25TZXZlcml0eSgyNSkpLnRvQmUoJ3NldmVyZScpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnZ2V0QW54aWV0eVNldmVyaXR5JywgKCkgPT4ge1xuICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gY29ycmVjdCBzZXZlcml0eSBsZXZlbHMgZm9yIEdBRC03IHNjb3JlcycsICgpID0+IHtcbiAgICAgICAgY29uc3QgZ2V0QW54aWV0eVNldmVyaXR5ID0gKHNlcnZpY2UgYXMgYW55KS5nZXRBbnhpZXR5U2V2ZXJpdHkuYmluZChzZXJ2aWNlKTtcblxuICAgICAgICBleHBlY3QoZ2V0QW54aWV0eVNldmVyaXR5KDMpKS50b0JlKCdtaW5pbWFsJyk7XG4gICAgICAgIGV4cGVjdChnZXRBbnhpZXR5U2V2ZXJpdHkoNCkpLnRvQmUoJ21pbmltYWwnKTtcbiAgICAgICAgZXhwZWN0KGdldEFueGlldHlTZXZlcml0eSg3KSkudG9CZSgnbWlsZCcpO1xuICAgICAgICBleHBlY3QoZ2V0QW54aWV0eVNldmVyaXR5KDkpKS50b0JlKCdtaWxkJyk7XG4gICAgICAgIGV4cGVjdChnZXRBbnhpZXR5U2V2ZXJpdHkoMTIpKS50b0JlKCdtb2RlcmF0ZScpO1xuICAgICAgICBleHBlY3QoZ2V0QW54aWV0eVNldmVyaXR5KDE0KSkudG9CZSgnbW9kZXJhdGUnKTtcbiAgICAgICAgZXhwZWN0KGdldEFueGlldHlTZXZlcml0eSgxOCkpLnRvQmUoJ3NldmVyZScpO1xuICAgICAgICBleHBlY3QoZ2V0QW54aWV0eVNldmVyaXR5KDIxKSkudG9CZSgnc2V2ZXJlJyk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdnZXRQVFNEU2V2ZXJpdHknLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIHJldHVybiBjb3JyZWN0IHNldmVyaXR5IGxldmVscyBmb3IgUFRTRC01IHNjb3JlcycsICgpID0+IHtcbiAgICAgICAgY29uc3QgZ2V0UFRTRFNldmVyaXR5ID0gKHNlcnZpY2UgYXMgYW55KS5nZXRQVFNEU2V2ZXJpdHkuYmluZChzZXJ2aWNlKTtcblxuICAgICAgICBleHBlY3QoZ2V0UFRTRFNldmVyaXR5KDEpKS50b0JlKCdtaW5pbWFsJyk7XG4gICAgICAgIGV4cGVjdChnZXRQVFNEU2V2ZXJpdHkoMikpLnRvQmUoJ21pbmltYWwnKTtcbiAgICAgICAgZXhwZWN0KGdldFBUU0RTZXZlcml0eSg1KSkudG9CZSgnbWlsZCcpO1xuICAgICAgICBleHBlY3QoZ2V0UFRTRFNldmVyaXR5KDcpKS50b0JlKCdtaWxkJyk7XG4gICAgICAgIGV4cGVjdChnZXRQVFNEU2V2ZXJpdHkoMTIpKS50b0JlKCdtb2RlcmF0ZScpO1xuICAgICAgICBleHBlY3QoZ2V0UFRTRFNldmVyaXR5KDE0KSkudG9CZSgnbW9kZXJhdGUnKTtcbiAgICAgICAgZXhwZWN0KGdldFBUU0RTZXZlcml0eSgxOCkpLnRvQmUoJ3NldmVyZScpO1xuICAgICAgICBleHBlY3QoZ2V0UFRTRFNldmVyaXR5KDIwKSkudG9CZSgnc2V2ZXJlJyk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2hhbmRsZUFzc2Vzc21lbnRDaGFuZ2UnLCAoKSA9PiB7XG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICBwcmlzbWFTZXJ2aWNlLnByZUFzc2Vzc21lbnQuZmluZFVuaXF1ZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUHJlQXNzZXNzbWVudCk7XG4gICAgICBwcmlzbWFTZXJ2aWNlLmNvbW11bml0eS5maW5kTWFueS5tb2NrUmVzb2x2ZWRWYWx1ZShbXG4gICAgICAgIHsgc2x1ZzogJ2RlcHJlc3Npb24tc3VwcG9ydCcsIG5hbWU6ICdEZXByZXNzaW9uIFN1cHBvcnQgTmV0d29yaycgfSxcbiAgICAgICAgeyBzbHVnOiAnYW54aWV0eS13YXJyaW9ycycsIG5hbWU6ICdBbnhpZXR5IFdhcnJpb3JzJyB9LFxuICAgICAgXSk7XG4gICAgICBwcmlzbWFTZXJ2aWNlLmNvbW11bml0eS5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tDb21tdW5pdHkpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgYXNzZXNzbWVudCBjaGFuZ2UgYW5kIGdlbmVyYXRlIG5ldyByZWNvbW1lbmRhdGlvbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBzZXJ2aWNlLmhhbmRsZUFzc2Vzc21lbnRDaGFuZ2UoJ3VzZXItMTIzJywgJ3BocTknKTtcblxuICAgICAgZXhwZWN0KGxvZ2dlclNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICdBc3Nlc3NtZW50IGNoYW5nZSBkZXRlY3RlZCBmb3IgdXNlciB1c2VyLTEyMzogcGhxOSdcbiAgICAgICk7XG4gICAgICBleHBlY3QobG9nZ2VyU3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ0dlbmVyYXRlZCcpXG4gICAgICApO1xuICAgICAgZXhwZWN0KGxvZ2dlclNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCduZXcgcmVjb21tZW5kYXRpb25zIGZvciB1c2VyIHVzZXItMTIzJylcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBlcnJvcnMgZHVyaW5nIHJlY29tbWVuZGF0aW9uIGdlbmVyYXRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBwcmlzbWFTZXJ2aWNlLnByZUFzc2Vzc21lbnQuZmluZFVuaXF1ZS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ0RhdGFiYXNlIGVycm9yJykpO1xuXG4gICAgICBjb25zdCBlcnJvclNweSA9IGplc3Quc3B5T24oTG9nZ2VyLnByb3RvdHlwZSwgJ2Vycm9yJykubW9ja0ltcGxlbWVudGF0aW9uKCk7XG5cbiAgICAgIGF3YWl0IHNlcnZpY2UuaGFuZGxlQXNzZXNzbWVudENoYW5nZSgndXNlci0xMjMnLCAnZ2FkNycpO1xuXG4gICAgICBleHBlY3QoZXJyb3JTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBleHBlY3Quc3RyaW5nQ29udGFpbmluZygnRXJyb3IgaGFuZGxpbmcgYXNzZXNzbWVudCBjaGFuZ2UgZm9yIHVzZXIgdXNlci0xMjMnKSxcbiAgICAgICAgZXhwZWN0LmFueShFcnJvcilcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGxvZyB3aGVuIG5vIG5ldyByZWNvbW1lbmRhdGlvbnMgYXJlIGdlbmVyYXRlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIHByaXNtYVNlcnZpY2UucHJlQXNzZXNzbWVudC5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpOyAvLyBObyBhc3Nlc3NtZW50XG5cbiAgICAgIGF3YWl0IHNlcnZpY2UuaGFuZGxlQXNzZXNzbWVudENoYW5nZSgndXNlci0xMjMnLCAncHRzZDUnKTtcblxuICAgICAgZXhwZWN0KGxvZ2dlclNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICdHZW5lcmF0ZWQgMCBuZXcgcmVjb21tZW5kYXRpb25zIGZvciB1c2VyIHVzZXItMTIzJ1xuICAgICAgKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2VkZ2UgY2FzZXMgYW5kIGVycm9yIGhhbmRsaW5nJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIGVtcHR5IGNvbW11bml0eSBsaXN0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgcHJpc21hU2VydmljZS5wcmVBc3Nlc3NtZW50LmZpbmRVbmlxdWUubW9ja1Jlc29sdmVkVmFsdWUobW9ja1ByZUFzc2Vzc21lbnQpO1xuICAgICAgcHJpc21hU2VydmljZS5jb21tdW5pdHkuZmluZE1hbnkubW9ja1Jlc29sdmVkVmFsdWUoW10pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLmdldFJlY29tbWVuZGF0aW9uc0ZvclVzZXIoJ3VzZXItMTIzJyk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoW10pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbWFsZm9ybWVkIGFzc2Vzc21lbnQgc2NvcmVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbWFsZm9ybWVkQXNzZXNzbWVudCA9IHtcbiAgICAgICAgLi4ubW9ja1ByZUFzc2Vzc21lbnQsXG4gICAgICAgIHNjb3JlczogJ2ludmFsaWQtc2NvcmVzJywgLy8gU2hvdWxkIGJlIG9iamVjdFxuICAgICAgICBzZXZlcml0eUxldmVsczogbnVsbCxcbiAgICAgIH07XG4gICAgICBwcmlzbWFTZXJ2aWNlLnByZUFzc2Vzc21lbnQuZmluZFVuaXF1ZS5tb2NrUmVzb2x2ZWRWYWx1ZShtYWxmb3JtZWRBc3Nlc3NtZW50KTtcblxuICAgICAgY29uc3QgZ2V0VXNlckFzc2Vzc21lbnRQcm9maWxlID0gKHNlcnZpY2UgYXMgYW55KS5nZXRVc2VyQXNzZXNzbWVudFByb2ZpbGUuYmluZChzZXJ2aWNlKTtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdldFVzZXJBc3Nlc3NtZW50UHJvZmlsZSgndXNlci0xMjMnKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5hc3Nlc3NtZW50cykudG9FcXVhbCh7fSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSB2ZXJ5IGhpZ2ggc2NvcmVzIGNvcnJlY3RseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGhpZ2hTY29yZUFzc2Vzc21lbnQgPSB7XG4gICAgICAgIC4uLm1vY2tQcmVBc3Nlc3NtZW50LFxuICAgICAgICBzY29yZXM6IHtcbiAgICAgICAgICBwaHE5U2NvcmU6IDUwLCAvLyBCZXlvbmQgbm9ybWFsIHJhbmdlXG4gICAgICAgICAgZ2FkN1Njb3JlOiAxMDAsXG4gICAgICAgICAgcHRzZDVTY29yZTogMjAwLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICAgIHByaXNtYVNlcnZpY2UucHJlQXNzZXNzbWVudC5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKGhpZ2hTY29yZUFzc2Vzc21lbnQpO1xuXG4gICAgICBjb25zdCBnZXRVc2VyQXNzZXNzbWVudFByb2ZpbGUgPSAoc2VydmljZSBhcyBhbnkpLmdldFVzZXJBc3Nlc3NtZW50UHJvZmlsZS5iaW5kKHNlcnZpY2UpO1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2V0VXNlckFzc2Vzc21lbnRQcm9maWxlKCd1c2VyLTEyMycpO1xuXG4gICAgICBleHBlY3QocmVzdWx0LmFzc2Vzc21lbnRzLnBocTkuc2V2ZXJpdHkpLnRvQmUoJ3NldmVyZScpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5hc3Nlc3NtZW50cy5nYWQ3LnNldmVyaXR5KS50b0JlKCdzZXZlcmUnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuYXNzZXNzbWVudHMucHRzZDUuc2V2ZXJpdHkpLnRvQmUoJ3NldmVyZScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbmVnYXRpdmUgc2NvcmVzIGNvcnJlY3RseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG5lZ2F0aXZlU2NvcmVBc3Nlc3NtZW50ID0ge1xuICAgICAgICAuLi5tb2NrUHJlQXNzZXNzbWVudCxcbiAgICAgICAgc2NvcmVzOiB7XG4gICAgICAgICAgcGhxOVNjb3JlOiAtNSwgLy8gSW52YWxpZCBuZWdhdGl2ZSBzY29yZVxuICAgICAgICAgIGdhZDdTY29yZTogLTEsXG4gICAgICAgICAgcHRzZDVTY29yZTogLTEwLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICAgIHByaXNtYVNlcnZpY2UucHJlQXNzZXNzbWVudC5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKG5lZ2F0aXZlU2NvcmVBc3Nlc3NtZW50KTtcblxuICAgICAgY29uc3QgZ2V0VXNlckFzc2Vzc21lbnRQcm9maWxlID0gKHNlcnZpY2UgYXMgYW55KS5nZXRVc2VyQXNzZXNzbWVudFByb2ZpbGUuYmluZChzZXJ2aWNlKTtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdldFVzZXJBc3Nlc3NtZW50UHJvZmlsZSgndXNlci0xMjMnKTtcblxuICAgICAgLy8gU2hvdWxkIHN0aWxsIHByb2Nlc3MgbmVnYXRpdmUgc2NvcmVzIChtaWdodCBiZSBkYXRhIGVycm9yKVxuICAgICAgZXhwZWN0KHJlc3VsdC5hc3Nlc3NtZW50cy5waHE5LnNldmVyaXR5KS50b0JlKCdtaW5pbWFsJyk7IC8vIE5lZ2F0aXZlIHRyZWF0ZWQgYXMgbWluaW1hbFxuICAgICAgZXhwZWN0KHJlc3VsdC5hc3Nlc3NtZW50cy5nYWQ3LnNldmVyaXR5KS50b0JlKCdtaW5pbWFsJyk7XG4gICAgICBleHBlY3QocmVzdWx0LmFzc2Vzc21lbnRzLnB0c2Q1LnNldmVyaXR5KS50b0JlKCdtaW5pbWFsJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBjb25jdXJyZW50IGFzc2Vzc21lbnQgY2hhbmdlcycsIGFzeW5jICgpID0+IHtcbiAgICAgIHByaXNtYVNlcnZpY2UucHJlQXNzZXNzbWVudC5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tQcmVBc3Nlc3NtZW50KTtcbiAgICAgIHByaXNtYVNlcnZpY2UuY29tbXVuaXR5LmZpbmRNYW55Lm1vY2tSZXNvbHZlZFZhbHVlKFtcbiAgICAgICAgeyBzbHVnOiAnZGVwcmVzc2lvbi1zdXBwb3J0JywgbmFtZTogJ0RlcHJlc3Npb24gU3VwcG9ydCBOZXR3b3JrJyB9LFxuICAgICAgXSk7XG4gICAgICBwcmlzbWFTZXJ2aWNlLmNvbW11bml0eS5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tDb21tdW5pdHkpO1xuXG4gICAgICAvLyBTaW11bGF0ZSBjb25jdXJyZW50IGNoYW5nZXNcbiAgICAgIGNvbnN0IHByb21pc2VzID0gW1xuICAgICAgICBzZXJ2aWNlLmhhbmRsZUFzc2Vzc21lbnRDaGFuZ2UoJ3VzZXItMTIzJywgJ3BocTknKSxcbiAgICAgICAgc2VydmljZS5oYW5kbGVBc3Nlc3NtZW50Q2hhbmdlKCd1c2VyLTEyMycsICdnYWQ3JyksXG4gICAgICAgIHNlcnZpY2UuaGFuZGxlQXNzZXNzbWVudENoYW5nZSgndXNlci0xMjMnLCAncHRzZDUnKSxcbiAgICAgIF07XG5cbiAgICAgIGF3YWl0IFByb21pc2UuYWxsKHByb21pc2VzKTtcblxuICAgICAgLy8gU2hvdWxkIGhhbmRsZSBhbGwgY2hhbmdlcyB3aXRob3V0IGVycm9yc1xuICAgICAgZXhwZWN0KGxvZ2dlclNweSkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDYpOyAvLyAyIGxvZ3MgcGVyIGNoYW5nZSAqIDMgY2hhbmdlc1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgYXNzZXNzbWVudCBjb21tdW5pdHkgbWFwcGluZyBlZGdlIGNhc2VzJywgKCkgPT4ge1xuICAgICAgY29uc3QgZ2V0QXNzZXNzbWVudENvbW11bml0eU1hcHBpbmdzID0gKHNlcnZpY2UgYXMgYW55KS5nZXRBc3Nlc3NtZW50Q29tbXVuaXR5TWFwcGluZ3MuYmluZChzZXJ2aWNlKTtcbiAgICAgIGNvbnN0IG1hcHBpbmdzID0gZ2V0QXNzZXNzbWVudENvbW11bml0eU1hcHBpbmdzKCk7XG5cbiAgICAgIC8vIFZlcmlmeSBhbGwgbWFwcGluZ3MgaGF2ZSByZXF1aXJlZCBwcm9wZXJ0aWVzXG4gICAgICBPYmplY3QudmFsdWVzKG1hcHBpbmdzKS5mb3JFYWNoKChtYXBwaW5nOiBhbnkpID0+IHtcbiAgICAgICAgZXhwZWN0KG1hcHBpbmcpLnRvSGF2ZVByb3BlcnR5KCdzY29yZScpO1xuICAgICAgICBleHBlY3QobWFwcGluZykudG9IYXZlUHJvcGVydHkoJ2NvbW11bml0aWVzJyk7XG4gICAgICAgIGV4cGVjdChtYXBwaW5nKS50b0hhdmVQcm9wZXJ0eSgnd2VpZ2h0Jyk7XG4gICAgICAgIGV4cGVjdChBcnJheS5pc0FycmF5KG1hcHBpbmcuY29tbXVuaXRpZXMpKS50b0JlKHRydWUpO1xuICAgICAgICBleHBlY3QodHlwZW9mIG1hcHBpbmcud2VpZ2h0KS50b0JlKCdudW1iZXInKTtcbiAgICAgICAgZXhwZWN0KG1hcHBpbmcud2VpZ2h0KS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICAgIGV4cGVjdChtYXBwaW5nLndlaWdodCkudG9CZUxlc3NUaGFuT3JFcXVhbCgxKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBub3JtYWxpemUgY29tcGF0aWJpbGl0eSBzY29yZXMgdG8gMC0xIHJhbmdlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gVGVzdCB3aXRoIHZlcnkgaGlnaCBjb250cmlidXRpb25zIHRoYXQgbWlnaHQgZXhjZWVkIDEuMFxuICAgICAgY29uc3QgaGlnaENvbnRyaWJ1dGlvblByb2ZpbGUgPSB7XG4gICAgICAgIHVzZXJJZDogJ3VzZXItMTIzJyxcbiAgICAgICAgYXNzZXNzbWVudHM6IHtcbiAgICAgICAgICBwaHE5OiB7XG4gICAgICAgICAgICBzY29yZTogMjcsIC8vIE1heGltdW0gUEhRLTkgc2NvcmVcbiAgICAgICAgICAgIHNldmVyaXR5OiAnc2V2ZXJlJyxcbiAgICAgICAgICAgIGRhdGU6IG5ldyBEYXRlKCcyMDI0LTAxLTAxJyksXG4gICAgICAgICAgfSxcbiAgICAgICAgICBnYWQ3OiB7XG4gICAgICAgICAgICBzY29yZTogMjEsIC8vIE1heGltdW0gR0FELTcgc2NvcmVcbiAgICAgICAgICAgIHNldmVyaXR5OiAnc2V2ZXJlJyxcbiAgICAgICAgICAgIGRhdGU6IG5ldyBEYXRlKCcyMDI0LTAxLTAxJyksXG4gICAgICAgICAgfSxcbiAgICAgICAgICBwdHNkNToge1xuICAgICAgICAgICAgc2NvcmU6IDIwLCAvLyBNYXhpbXVtIFBUU0QtNSBzY29yZVxuICAgICAgICAgICAgc2V2ZXJpdHk6ICdzZXZlcmUnLFxuICAgICAgICAgICAgZGF0ZTogbmV3IERhdGUoJzIwMjQtMDEtMDEnKSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfTtcblxuICAgICAgcHJpc21hU2VydmljZS5jb21tdW5pdHkuZmluZFVuaXF1ZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrQ29tbXVuaXR5KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5jYWxjdWxhdGVDb21wYXRpYmlsaXR5U2NvcmUoXG4gICAgICAgIGhpZ2hDb250cmlidXRpb25Qcm9maWxlLFxuICAgICAgICAnZGVwcmVzc2lvbi1zdXBwb3J0J1xuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5jb21wYXRpYmlsaXR5U2NvcmUpLnRvQmVMZXNzVGhhbk9yRXF1YWwoMS4wKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuY29tcGF0aWJpbGl0eVNjb3JlKS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDApO1xuICAgIH0pO1xuICB9KTtcbn0pOyJdLCJ2ZXJzaW9uIjozfQ==