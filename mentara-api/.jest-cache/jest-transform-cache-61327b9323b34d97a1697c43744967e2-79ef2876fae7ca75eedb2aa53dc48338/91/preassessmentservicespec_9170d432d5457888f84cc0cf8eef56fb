936c12fcfdc445eff9de70324a232f3b
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
// Mock the utility functions
jest.mock('./pre-assessment.utils', () => ({
    calculateAllScores: jest.fn(),
    generateSeverityLevels: jest.fn(),
}));
const testing_1 = require("@nestjs/testing");
const common_1 = require("@nestjs/common");
const pre_assessment_service_1 = require("./pre-assessment.service");
const prisma_client_provider_1 = require("../providers/prisma-client.provider");
const ai_service_client_1 = require("./services/ai-service.client");
const PreAssessmentUtils = require("./pre-assessment.utils");
describe('PreAssessmentService', () => {
    let service;
    let prismaService;
    let aiServiceClient;
    let loggerSpy;
    // Mock data
    const mockUser = {
        id: 'user-123',
        isActive: true,
    };
    const mockClient = {
        userId: 'user-123',
    };
    const mockValidQuestionnaires = ['Anxiety', 'Depression', 'Stress'];
    const mockValidAnswers = [
        [2, 3, 1, 4, 2, 3, 1], // Anxiety: 7 questions
        [1, 2, 3, 2, 1, 4, 3, 2, 1], // Depression: 9 questions
        [3, 4, 2, 1, 3, 4, 2, 1, 3, 2], // Stress: 10 questions
    ];
    const mockValidAnswerMatrix = [
        [1, 2, 3, 4, 5],
        [2, 3, 4, 5, 1],
        [3, 4, 5, 1, 2],
    ];
    const mockCalculatedScores = {
        Anxiety: { score: 15, severity: 'moderate' },
        Depression: { score: 12, severity: 'mild' },
        Stress: { score: 18, severity: 'high' },
    };
    const mockSeverityLevels = {
        Anxiety: 'moderate',
        Depression: 'mild',
        Stress: 'high',
    };
    const mockPreAssessment = {
        id: 'assessment-123',
        clientId: 'user-123',
        questionnaires: mockValidQuestionnaires,
        answers: mockValidAnswers,
        answerMatrix: mockValidAnswerMatrix,
        scores: { Anxiety: 15, Depression: 12, Stress: 18 },
        severityLevels: mockSeverityLevels,
        aiEstimate: { hasAnxiety: true, hasDepression: false },
        createdAt: new Date('2024-01-15T00:00:00Z'),
        updatedAt: new Date('2024-01-15T00:00:00Z'),
    };
    const mockAiResponse = {
        success: true,
        predictions: { hasAnxiety: true, hasDepression: false, hasStress: true },
        responseTime: 150,
    };
    beforeEach(async () => {
        const mockPrismaService = {
            user: {
                findUnique: jest.fn(),
            },
            client: {
                findUnique: jest.fn(),
            },
            preAssessment: {
                findUnique: jest.fn(),
                create: jest.fn(),
                update: jest.fn(),
                delete: jest.fn(),
            },
        };
        const mockAiServiceClient = {
            predict: jest.fn(),
        };
        const module = await testing_1.Test.createTestingModule({
            providers: [
                pre_assessment_service_1.PreAssessmentService,
                {
                    provide: prisma_client_provider_1.PrismaService,
                    useValue: mockPrismaService,
                },
                {
                    provide: ai_service_client_1.AiServiceClient,
                    useValue: mockAiServiceClient,
                },
            ],
        }).compile();
        service = module.get(pre_assessment_service_1.PreAssessmentService);
        prismaService = module.get(prisma_client_provider_1.PrismaService);
        aiServiceClient = module.get(ai_service_client_1.AiServiceClient);
        // Setup utility mocks
        PreAssessmentUtils.calculateAllScores.mockReturnValue(mockCalculatedScores);
        PreAssessmentUtils.generateSeverityLevels.mockReturnValue(mockSeverityLevels);
        // Setup logger spy
        loggerSpy = jest.spyOn(common_1.Logger.prototype, 'log').mockImplementation();
        jest.spyOn(common_1.Logger.prototype, 'debug').mockImplementation();
        jest.spyOn(common_1.Logger.prototype, 'warn').mockImplementation();
        jest.spyOn(common_1.Logger.prototype, 'error').mockImplementation();
    });
    afterEach(() => {
        jest.clearAllMocks();
    });
    it('should be defined', () => {
        expect(service).toBeDefined();
    });
    describe('createPreAssessment', () => {
        const validCreateData = {
            questionnaires: mockValidQuestionnaires,
            answers: mockValidAnswers,
            answerMatrix: mockValidAnswerMatrix,
            scores: { Anxiety: 15, Depression: 12, Stress: 18 },
            severityLevels: mockSeverityLevels,
            aiEstimate: { hasAnxiety: true, hasDepression: false },
        };
        beforeEach(() => {
            prismaService.user.findUnique.mockResolvedValue(mockUser);
            prismaService.client.findUnique.mockResolvedValue(mockClient);
            prismaService.preAssessment.findUnique.mockResolvedValue(null); // No existing assessment
            prismaService.preAssessment.create.mockResolvedValue(mockPreAssessment);
            aiServiceClient.predict.mockResolvedValue(mockAiResponse);
        });
        it('should create a pre-assessment successfully', async () => {
            const result = await service.createPreAssessment('user-123', validCreateData);
            expect(prismaService.user.findUnique).toHaveBeenCalledWith({
                where: { id: 'user-123', isActive: true },
                select: { id: true, isActive: true },
            });
            expect(prismaService.client.findUnique).toHaveBeenCalledWith({
                where: { userId: 'user-123' },
                select: { userId: true },
            });
            expect(prismaService.preAssessment.create).toHaveBeenCalledWith({
                data: {
                    clientId: 'user-123',
                    questionnaires: mockValidQuestionnaires,
                    answers: mockValidAnswers,
                    answerMatrix: mockValidAnswerMatrix,
                    scores: validCreateData.scores,
                    severityLevels: validCreateData.severityLevels,
                    aiEstimate: expect.any(Object),
                },
            });
            expect(result).toEqual(mockPreAssessment);
        });
        it('should throw NotFoundException when user not found', async () => {
            prismaService.user.findUnique.mockResolvedValue(null);
            await expect(service.createPreAssessment('nonexistent-user', validCreateData)).rejects.toThrow(new common_1.NotFoundException('User not found or inactive'));
        });
        it('should throw NotFoundException when user is inactive', async () => {
            // Override the beforeEach mock for this specific test
            prismaService.user.findUnique.mockReset();
            prismaService.user.findUnique.mockResolvedValue(null); // Inactive users return null from WHERE clause
            await expect(service.createPreAssessment('user-123', validCreateData)).rejects.toThrow(new common_1.NotFoundException('User not found or inactive'));
        });
        it('should throw NotFoundException when client profile not found', async () => {
            prismaService.client.findUnique.mockResolvedValue(null);
            await expect(service.createPreAssessment('user-123', validCreateData)).rejects.toThrow(new common_1.NotFoundException('Client profile not found'));
        });
        it('should throw BadRequestException when pre-assessment already exists', async () => {
            prismaService.preAssessment.findUnique.mockResolvedValue(mockPreAssessment);
            await expect(service.createPreAssessment('user-123', validCreateData)).rejects.toThrow(new common_1.BadRequestException('Pre-assessment already exists for this user'));
        });
        it('should calculate scores when not provided', async () => {
            const dataWithoutScores = {
                questionnaires: mockValidQuestionnaires,
                answers: mockValidAnswers,
                answerMatrix: mockValidAnswerMatrix,
                scores: undefined, // Explicitly undefined to trigger calculation
                severityLevels: undefined, // Explicitly undefined to trigger calculation
                aiEstimate: {},
            };
            await service.createPreAssessment('user-123', dataWithoutScores);
            expect(PreAssessmentUtils.calculateAllScores).toHaveBeenCalledWith(mockValidQuestionnaires, mockValidAnswers);
            expect(PreAssessmentUtils.generateSeverityLevels).toHaveBeenCalledWith(mockCalculatedScores);
        });
        it('should handle AI prediction successfully', async () => {
            // Create flat answers array with exactly 201 values
            const flatAnswers = new Array(201).fill(0).map((_, i) => i % 5);
            const dataWith201Values = {
                questionnaires: ['Test'],
                answers: [flatAnswers],
                answerMatrix: [flatAnswers],
                scores: {},
                severityLevels: {},
                aiEstimate: {},
            };
            await service.createPreAssessment('user-123', dataWith201Values);
            expect(aiServiceClient.predict).toHaveBeenCalledWith(flatAnswers);
        });
        it('should continue without AI prediction when AI service fails', async () => {
            aiServiceClient.predict.mockResolvedValue({
                success: false,
                error: 'AI service unavailable',
            });
            const result = await service.createPreAssessment('user-123', validCreateData);
            expect(result).toBeDefined();
            expect(loggerSpy).toHaveBeenCalledWith(expect.stringContaining('Pre-assessment created successfully'));
        });
        it('should handle validation errors for invalid answer types', async () => {
            const invalidData = {
                ...validCreateData,
                answers: [['invalid', 'data']], // Invalid answer types
            };
            // Should throw because validation happens before AI processing
            await expect(service.createPreAssessment('user-123', invalidData)).rejects.toThrow(common_1.BadRequestException);
        });
        describe('Input validation', () => {
            it('should validate questionnaires array', async () => {
                const invalidData = {
                    ...validCreateData,
                    questionnaires: 'invalid-string',
                };
                await expect(service.createPreAssessment('user-123', invalidData)).rejects.toThrow(common_1.BadRequestException);
            });
            it('should validate empty questionnaires array', async () => {
                const invalidData = {
                    ...validCreateData,
                    questionnaires: [],
                };
                await expect(service.createPreAssessment('user-123', invalidData)).rejects.toThrow(new common_1.BadRequestException('At least one questionnaire is required'));
            });
            it('should validate questionnaires and answers alignment', async () => {
                const mismatchedData = {
                    ...validCreateData,
                    questionnaires: ['Anxiety', 'Depression'], // 2 questionnaires
                    answers: [[1, 2, 3]], // 1 answer array
                };
                await expect(service.createPreAssessment('user-123', mismatchedData)).rejects.toThrow(new common_1.BadRequestException('Number of questionnaires must match number of answer arrays'));
            });
            it('should validate answer values are numbers', async () => {
                const invalidData = {
                    ...validCreateData,
                    answers: [[1, 2, 'invalid', 4]], // Invalid answer type
                };
                await expect(service.createPreAssessment('user-123', invalidData)).rejects.toThrow(common_1.BadRequestException);
            });
            it('should validate answer values are in range', async () => {
                const invalidData = {
                    ...validCreateData,
                    answers: [[1, 2, 15, 4]], // Value out of range (0-10)
                };
                await expect(service.createPreAssessment('user-123', invalidData)).rejects.toThrow(common_1.BadRequestException);
            });
            it('should validate answer values are finite', async () => {
                const invalidData = {
                    ...validCreateData,
                    answers: [[1, 2, Infinity, 4]], // Infinite value
                };
                await expect(service.createPreAssessment('user-123', invalidData)).rejects.toThrow(common_1.BadRequestException);
            });
            it('should validate questionnaire names are strings', async () => {
                const invalidData = {
                    ...validCreateData,
                    questionnaires: ['Valid', 123, 'Another'], // Invalid questionnaire type
                };
                await expect(service.createPreAssessment('user-123', invalidData)).rejects.toThrow(common_1.BadRequestException);
            });
            it('should warn about unknown questionnaire types', async () => {
                const dataWithUnknownQuestionnaire = {
                    ...validCreateData,
                    questionnaires: ['Anxiety', 'UnknownType'],
                    answers: [
                        [1, 2, 3],
                        [4, 5, 6],
                    ], // Match the questionnaire count
                };
                await service.createPreAssessment('user-123', dataWithUnknownQuestionnaire);
                expect(common_1.Logger.prototype.warn).toHaveBeenCalledWith('Unknown questionnaire type: UnknownType');
            });
        });
        describe('Error handling', () => {
            it('should handle database errors gracefully', async () => {
                prismaService.preAssessment.create.mockRejectedValue(new Error('Database error'));
                await expect(service.createPreAssessment('user-123', validCreateData)).rejects.toThrow(common_1.InternalServerErrorException);
            });
            it('should preserve specific exception types', async () => {
                const notFoundError = new common_1.NotFoundException('User not found');
                prismaService.user.findUnique.mockRejectedValue(notFoundError);
                await expect(service.createPreAssessment('user-123', validCreateData)).rejects.toThrow(common_1.NotFoundException);
            });
        });
    });
    describe('getPreAssessmentByUserId', () => {
        it('should return pre-assessment for valid user ID', async () => {
            prismaService.preAssessment.findUnique.mockResolvedValue(mockPreAssessment);
            const result = await service.getPreAssessmentByUserId('user-123');
            expect(prismaService.preAssessment.findUnique).toHaveBeenCalledWith({
                where: { clientId: 'user-123' },
            });
            expect(result).toEqual(mockPreAssessment);
        });
        it('should throw NotFoundException when pre-assessment not found', async () => {
            prismaService.preAssessment.findUnique.mockResolvedValue(null);
            await expect(service.getPreAssessmentByUserId('user-123')).rejects.toThrow(new common_1.NotFoundException('Pre-assessment not found'));
        });
        it('should handle database errors', async () => {
            prismaService.preAssessment.findUnique.mockRejectedValue(new Error('Database error'));
            await expect(service.getPreAssessmentByUserId('user-123')).rejects.toThrow(common_1.InternalServerErrorException);
        });
    });
    describe('getPreAssessmentByClientId', () => {
        it('should return pre-assessment with client and user data', async () => {
            const mockPreAssessmentWithClient = {
                ...mockPreAssessment,
                client: {
                    user: mockUser,
                },
            };
            prismaService.preAssessment.findUnique.mockResolvedValue(mockPreAssessmentWithClient);
            const result = await service.getPreAssessmentByClientId('user-123');
            expect(prismaService.preAssessment.findUnique).toHaveBeenCalledWith({
                where: { clientId: 'user-123' },
                include: { client: { include: { user: true } } },
            });
            expect(result).toEqual(mockPreAssessmentWithClient);
        });
        it('should throw NotFoundException when pre-assessment not found', async () => {
            prismaService.preAssessment.findUnique.mockResolvedValue(null);
            await expect(service.getPreAssessmentByClientId('user-123')).rejects.toThrow(new common_1.NotFoundException('Pre-assessment not found'));
        });
    });
    describe('updatePreAssessment', () => {
        const updateData = {
            questionnaires: ['Anxiety', 'Stress'],
            answers: [
                [1, 2, 3],
                [4, 5, 6],
            ],
            answerMatrix: [
                [1, 2],
                [3, 4],
            ],
        };
        beforeEach(() => {
            prismaService.client.findUnique.mockResolvedValue(mockClient);
            prismaService.preAssessment.update.mockResolvedValue(mockPreAssessment);
        });
        it('should update pre-assessment successfully', async () => {
            const result = await service.updatePreAssessment('user-123', updateData);
            expect(prismaService.client.findUnique).toHaveBeenCalledWith({
                where: { userId: 'user-123' },
            });
            expect(prismaService.preAssessment.update).toHaveBeenCalledWith({
                where: { clientId: 'user-123' },
                data: {
                    questionnaires: updateData.questionnaires,
                    answers: updateData.answers,
                    answerMatrix: updateData.answerMatrix,
                    scores: expect.any(Object),
                    severityLevels: expect.any(Object),
                },
            });
            expect(result).toEqual(mockPreAssessment);
        });
        it('should use provided scores when valid', async () => {
            const dataWithScores = {
                ...updateData,
                scores: { Anxiety: 20, Stress: 15 },
                severityLevels: { Anxiety: 'high', Stress: 'moderate' },
            };
            await service.updatePreAssessment('user-123', dataWithScores);
            expect(prismaService.preAssessment.update).toHaveBeenCalledWith({
                where: { clientId: 'user-123' },
                data: expect.objectContaining({
                    scores: { Anxiety: 20, Stress: 15 },
                    severityLevels: { Anxiety: 'high', Stress: 'moderate' },
                }),
            });
        });
        it('should calculate scores when questionnaires and answers provided without scores', async () => {
            await service.updatePreAssessment('user-123', updateData);
            expect(PreAssessmentUtils.calculateAllScores).toHaveBeenCalledWith(updateData.questionnaires, updateData.answers);
            expect(PreAssessmentUtils.generateSeverityLevels).toHaveBeenCalledWith(mockCalculatedScores);
        });
        it('should throw NotFoundException when client not found', async () => {
            prismaService.client.findUnique.mockResolvedValue(null);
            await expect(service.updatePreAssessment('user-123', updateData)).rejects.toThrow(new common_1.NotFoundException('Client not found'));
        });
        it('should handle invalid scores gracefully', async () => {
            const dataWithInvalidScores = {
                ...updateData,
                scores: 'invalid-scores',
                severityLevels: { valid: 'levels' },
            };
            await service.updatePreAssessment('user-123', dataWithInvalidScores);
            expect(prismaService.preAssessment.update).toHaveBeenCalledWith({
                where: { clientId: 'user-123' },
                data: expect.objectContaining({
                    scores: expect.any(Object), // Should be calculated scores
                    severityLevels: { valid: 'levels' },
                }),
            });
        });
        it('should handle invalid severity levels gracefully', async () => {
            const dataWithInvalidLevels = {
                ...updateData,
                scores: { Anxiety: 15 },
                severityLevels: 123, // Invalid type
            };
            await service.updatePreAssessment('user-123', dataWithInvalidLevels);
            expect(prismaService.preAssessment.update).toHaveBeenCalledWith({
                where: { clientId: 'user-123' },
                data: expect.objectContaining({
                    scores: { Anxiety: 15 },
                    severityLevels: expect.any(Object), // Should be calculated levels
                }),
            });
        });
    });
    describe('deletePreAssessment', () => {
        it('should delete pre-assessment successfully', async () => {
            prismaService.preAssessment.delete.mockResolvedValue(mockPreAssessment);
            const result = await service.deletePreAssessment('user-123');
            expect(prismaService.preAssessment.delete).toHaveBeenCalledWith({
                where: { clientId: 'user-123' },
            });
            expect(result).toBeNull();
        });
        it('should handle deletion errors', async () => {
            prismaService.preAssessment.delete.mockRejectedValue(new Error('Delete failed'));
            await expect(service.deletePreAssessment('user-123')).rejects.toThrow(common_1.InternalServerErrorException);
        });
    });
    describe('flattenAnswers', () => {
        it('should flatten 2D array correctly', () => {
            const answers = [
                [1, 2, 3],
                [4, 5],
                [6, 7, 8, 9],
            ];
            // Access private method through service instance
            const result = service.flattenAnswers(answers);
            expect(result).toEqual([1, 2, 3, 4, 5, 6, 7, 8, 9]);
        });
        it('should validate flattened array is not empty', () => {
            const emptyAnswers = [[], [], []];
            expect(() => service.flattenAnswers(emptyAnswers)).toThrow(new common_1.BadRequestException('Flattened answers array cannot be empty'));
        });
        it('should validate all values are finite numbers', () => {
            const invalidAnswers = [
                [1, 2, NaN],
                [4, 5],
            ];
            expect(() => service.flattenAnswers(invalidAnswers)).toThrow(new common_1.BadRequestException('All answer values must be finite numbers'));
        });
        it('should warn when not exactly 201 values for AI prediction', () => {
            const shortAnswers = [[1, 2, 3]];
            const warnSpy = jest.spyOn(common_1.Logger.prototype, 'warn');
            service.flattenAnswers(shortAnswers);
            expect(warnSpy).toHaveBeenCalledWith('Expected 201 values for AI prediction, got 3');
        });
    });
    describe('validateAnswersStructure', () => {
        it('should pass validation for valid answers structure', () => {
            const validAnswers = [
                [1, 2, 3],
                [4, 5, 6],
            ];
            expect(() => service.validateAnswersStructure(validAnswers)).not.toThrow();
        });
        it('should throw error for non-array input', () => {
            expect(() => service.validateAnswersStructure('invalid')).toThrow(new common_1.BadRequestException('Answers must be an array of arrays'));
        });
        it('should throw error for empty answers array', () => {
            expect(() => service.validateAnswersStructure([])).toThrow(new common_1.BadRequestException('Answers array cannot be empty'));
        });
        it('should throw error for non-array questionnaire answers', () => {
            const invalidAnswers = [[1, 2, 3], 'invalid', [4, 5, 6]]; // First element is valid numbers
            expect(() => service.validateAnswersStructure(invalidAnswers)).toThrow(new common_1.BadRequestException('Questionnaire 1 answers must be an array'));
        });
        it('should throw error for empty questionnaire answers', () => {
            const invalidAnswers = [[1, 2, 3], [], [4, 5, 6]];
            expect(() => service.validateAnswersStructure(invalidAnswers)).toThrow(new common_1.BadRequestException('Questionnaire 1 cannot have empty answers'));
        });
        it('should throw error for out-of-range values', () => {
            const invalidAnswers = [
                [1, 2, 15],
                [4, 5, 6],
            ]; // 15 is out of range
            expect(() => service.validateAnswersStructure(invalidAnswers)).toThrow(new common_1.BadRequestException('Answer value out of range (0-10) at questionnaire 0, question 2: 15'));
        });
        it('should throw error for negative values', () => {
            const invalidAnswers = [
                [1, 2, -1],
                [4, 5, 6],
            ]; // -1 is out of range
            expect(() => service.validateAnswersStructure(invalidAnswers)).toThrow(new common_1.BadRequestException('Answer value out of range (0-10) at questionnaire 0, question 2: -1'));
        });
    });
    describe('validateQuestionnaires', () => {
        it('should pass validation for valid questionnaires', () => {
            const validQuestionnaires = ['Anxiety', 'Depression', 'Stress'];
            expect(() => service.validateQuestionnaires(validQuestionnaires)).not.toThrow();
        });
        it('should throw error for non-array input', () => {
            expect(() => service.validateQuestionnaires('invalid')).toThrow(new common_1.BadRequestException('Questionnaires must be an array'));
        });
        it('should throw error for empty questionnaires array', () => {
            expect(() => service.validateQuestionnaires([])).toThrow(new common_1.BadRequestException('At least one questionnaire is required'));
        });
        it('should throw error for non-string questionnaire names', () => {
            const invalidQuestionnaires = ['Valid', 123, 'Another'];
            expect(() => service.validateQuestionnaires(invalidQuestionnaires)).toThrow(new common_1.BadRequestException('All questionnaire names must be non-empty strings'));
        });
        it('should throw error for empty string questionnaire names', () => {
            const invalidQuestionnaires = ['Valid', '', 'Another'];
            expect(() => service.validateQuestionnaires(invalidQuestionnaires)).toThrow(new common_1.BadRequestException('All questionnaire names must be non-empty strings'));
        });
    });
    describe('AI Service Integration', () => {
        it('should handle successful AI prediction', async () => {
            aiServiceClient.predict.mockResolvedValue(mockAiResponse);
            const result = await service.getAiEstimate(new Array(201).fill(1));
            expect(result).toEqual(mockAiResponse.predictions);
            expect(common_1.Logger.prototype.log).toHaveBeenCalledWith('AI prediction completed successfully in 150ms');
        });
        it('should handle AI prediction failure', async () => {
            const failureResponse = { success: false, error: 'Model unavailable' };
            aiServiceClient.predict.mockResolvedValue(failureResponse);
            const result = await service.getAiEstimate(new Array(201).fill(1));
            expect(result).toBeNull();
            expect(common_1.Logger.prototype.warn).toHaveBeenCalledWith('AI prediction failed: Model unavailable');
        });
        it('should handle AI service exceptions', async () => {
            aiServiceClient.predict.mockRejectedValue(new Error('Network error'));
            const result = await service.getAiEstimate(new Array(201).fill(1));
            expect(result).toBeNull();
            expect(common_1.Logger.prototype.error).toHaveBeenCalledWith('AI model prediction error:', 'Network error');
        });
        it('should handle AI service timeout', async () => {
            aiServiceClient.predict.mockRejectedValue(new Error('Timeout'));
            const result = await service.getAiEstimate(new Array(201).fill(1));
            expect(result).toBeNull();
        });
    });
    describe('Edge Cases and Performance', () => {
        it('should handle large questionnaire arrays', async () => {
            const largeAnswers = new Array(50).fill([1, 2, 3, 4, 5]);
            const largeQuestionnaires = new Array(50).fill('Stress');
            prismaService.user.findUnique.mockResolvedValue(mockUser);
            prismaService.client.findUnique.mockResolvedValue(mockClient);
            prismaService.preAssessment.findUnique.mockResolvedValue(null);
            prismaService.preAssessment.create.mockResolvedValue(mockPreAssessment);
            const result = await service.createPreAssessment('user-123', {
                questionnaires: largeQuestionnaires,
                answers: largeAnswers,
                answerMatrix: largeAnswers,
                scores: {},
                severityLevels: {},
                aiEstimate: {},
            });
            expect(result).toBeDefined();
        });
        it('should handle concurrent creation attempts', async () => {
            prismaService.user.findUnique.mockResolvedValue(mockUser);
            prismaService.client.findUnique.mockResolvedValue(mockClient);
            prismaService.preAssessment.findUnique.mockResolvedValue(null);
            prismaService.preAssessment.create.mockResolvedValue(mockPreAssessment);
            const validData = {
                questionnaires: ['Anxiety'],
                answers: [[1, 2, 3]],
                answerMatrix: [[1, 2, 3]],
                scores: {},
                severityLevels: {},
                aiEstimate: {},
            };
            // Simulate concurrent requests
            const promises = [
                service.createPreAssessment('user-123', validData),
                service.createPreAssessment('user-123', validData),
            ];
            const results = await Promise.all(promises);
            expect(results).toHaveLength(2);
        });
        it('should handle null and undefined in scores validation', () => {
            const isValidScores = service.isValidScores;
            expect(isValidScores(null)).toBe(false);
            expect(isValidScores(undefined)).toBe(false);
            expect(isValidScores({})).toBe(true);
            expect(isValidScores({ test: 5 })).toBe(true);
            expect(isValidScores({ test: 'invalid' })).toBe(false);
        });
        it('should handle null and undefined in severity levels validation', () => {
            const isValidSeverityLevels = service.isValidSeverityLevels;
            expect(isValidSeverityLevels(null)).toBe(false);
            expect(isValidSeverityLevels(undefined)).toBe(false);
            expect(isValidSeverityLevels({})).toBe(true);
            expect(isValidSeverityLevels({ test: 'mild' })).toBe(true);
            expect(isValidSeverityLevels({ test: 123 })).toBe(false);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL3ByZS1hc3Nlc3NtZW50L3ByZS1hc3Nlc3NtZW50LnNlcnZpY2Uuc3BlYy50cyIsIm1hcHBpbmdzIjoiOztBQVlBLDZCQUE2QjtBQUM3QixJQUFJLENBQUMsSUFBSSxDQUFDLHdCQUF3QixFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDekMsa0JBQWtCLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUM3QixzQkFBc0IsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0NBQ2xDLENBQUMsQ0FBQyxDQUFDO0FBaEJKLDZDQUFzRDtBQUN0RCwyQ0FLd0I7QUFDeEIscUVBQWdFO0FBQ2hFLGdGQUFvRTtBQUNwRSxvRUFBK0Q7QUFDL0QsNkRBQTZEO0FBUTdELFFBQVEsQ0FBQyxzQkFBc0IsRUFBRSxHQUFHLEVBQUU7SUFDcEMsSUFBSSxPQUE2QixDQUFDO0lBQ2xDLElBQUksYUFBa0IsQ0FBQztJQUN2QixJQUFJLGVBQW9CLENBQUM7SUFDekIsSUFBSSxTQUEyQixDQUFDO0lBRWhDLFlBQVk7SUFDWixNQUFNLFFBQVEsR0FBRztRQUNmLEVBQUUsRUFBRSxVQUFVO1FBQ2QsUUFBUSxFQUFFLElBQUk7S0FDZixDQUFDO0lBRUYsTUFBTSxVQUFVLEdBQUc7UUFDakIsTUFBTSxFQUFFLFVBQVU7S0FDbkIsQ0FBQztJQUVGLE1BQU0sdUJBQXVCLEdBQUcsQ0FBQyxTQUFTLEVBQUUsWUFBWSxFQUFFLFFBQVEsQ0FBQyxDQUFDO0lBQ3BFLE1BQU0sZ0JBQWdCLEdBQUc7UUFDdkIsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSx1QkFBdUI7UUFDOUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxF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QUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDN0MsTUFBTSxDQUFDLHFCQUFxQixDQUFDLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDM0QsTUFBTSxDQUFDLHFCQUFxQixDQUFDLEVBQUUsSUFBSSxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDM0QsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9ob21lL3dldG9vYS9Eb2N1bWVudHMvY29kZS9wcm9qZWN0cy9tZW50YXJhL21lbnRhcmEtYXBpL3NyYy9wcmUtYXNzZXNzbWVudC9wcmUtYXNzZXNzbWVudC5zZXJ2aWNlLnNwZWMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVGVzdCwgVGVzdGluZ01vZHVsZSB9IGZyb20gJ0BuZXN0anMvdGVzdGluZyc7XG5pbXBvcnQge1xuICBOb3RGb3VuZEV4Y2VwdGlvbixcbiAgQmFkUmVxdWVzdEV4Y2VwdGlvbixcbiAgSW50ZXJuYWxTZXJ2ZXJFcnJvckV4Y2VwdGlvbixcbiAgTG9nZ2VyLFxufSBmcm9tICdAbmVzdGpzL2NvbW1vbic7XG5pbXBvcnQgeyBQcmVBc3Nlc3NtZW50U2VydmljZSB9IGZyb20gJy4vcHJlLWFzc2Vzc21lbnQuc2VydmljZSc7XG5pbXBvcnQgeyBQcmlzbWFTZXJ2aWNlIH0gZnJvbSAnLi4vcHJvdmlkZXJzL3ByaXNtYS1jbGllbnQucHJvdmlkZXInO1xuaW1wb3J0IHsgQWlTZXJ2aWNlQ2xpZW50IH0gZnJvbSAnLi9zZXJ2aWNlcy9haS1zZXJ2aWNlLmNsaWVudCc7XG5pbXBvcnQgKiBhcyBQcmVBc3Nlc3NtZW50VXRpbHMgZnJvbSAnLi9wcmUtYXNzZXNzbWVudC51dGlscyc7XG5cbi8vIE1vY2sgdGhlIHV0aWxpdHkgZnVuY3Rpb25zXG5qZXN0Lm1vY2soJy4vcHJlLWFzc2Vzc21lbnQudXRpbHMnLCAoKSA9PiAoe1xuICBjYWxjdWxhdGVBbGxTY29yZXM6IGplc3QuZm4oKSxcbiAgZ2VuZXJhdGVTZXZlcml0eUxldmVsczogamVzdC5mbigpLFxufSkpO1xuXG5kZXNjcmliZSgnUHJlQXNzZXNzbWVudFNlcnZpY2UnLCAoKSA9PiB7XG4gIGxldCBzZXJ2aWNlOiBQcmVBc3Nlc3NtZW50U2VydmljZTtcbiAgbGV0IHByaXNtYVNlcnZpY2U6IGFueTtcbiAgbGV0IGFpU2VydmljZUNsaWVudDogYW55O1xuICBsZXQgbG9nZ2VyU3B5OiBqZXN0LlNweUluc3RhbmNlO1xuXG4gIC8vIE1vY2sgZGF0YVxuICBjb25zdCBtb2NrVXNlciA9IHtcbiAgICBpZDogJ3VzZXItMTIzJyxcbiAgICBpc0FjdGl2ZTogdHJ1ZSxcbiAgfTtcblxuICBjb25zdCBtb2NrQ2xpZW50ID0ge1xuICAgIHVzZXJJZDogJ3VzZXItMTIzJyxcbiAgfTtcblxuICBjb25zdCBtb2NrVmFsaWRRdWVzdGlvbm5haXJlcyA9IFsnQW54aWV0eScsICdEZXByZXNzaW9uJywgJ1N0cmVzcyddO1xuICBjb25zdCBtb2NrVmFsaWRBbnN3ZXJzID0gW1xuICAgIFsyLCAzLCAxLCA0LCAyLCAzLCAxXSwgLy8gQW54aWV0eTogNyBxdWVzdGlvbnNcbiAgICBbMSwgMiwgMywgMiwgMSwgNCwgMywgMiwgMV0sIC8vIERlcHJlc3Npb246IDkgcXVlc3Rpb25zXG4gICAgWzMsIDQsIDIsIDEsIDMsIDQsIDIsIDEsIDMsIDJdLCAvLyBTdHJlc3M6IDEwIHF1ZXN0aW9uc1xuICBdO1xuXG4gIGNvbnN0IG1vY2tWYWxpZEFuc3dlck1hdHJpeCA9IFtcbiAgICBbMSwgMiwgMywgNCwgNV0sXG4gICAgWzIsIDMsIDQsIDUsIDFdLFxuICAgIFszLCA0LCA1LCAxLCAyXSxcbiAgXTtcblxuICBjb25zdCBtb2NrQ2FsY3VsYXRlZFNjb3JlcyA9IHtcbiAgICBBbnhpZXR5OiB7IHNjb3JlOiAxNSwgc2V2ZXJpdHk6ICdtb2RlcmF0ZScgfSxcbiAgICBEZXByZXNzaW9uOiB7IHNjb3JlOiAxMiwgc2V2ZXJpdHk6ICdtaWxkJyB9LFxuICAgIFN0cmVzczogeyBzY29yZTogMTgsIHNldmVyaXR5OiAnaGlnaCcgfSxcbiAgfTtcblxuICBjb25zdCBtb2NrU2V2ZXJpdHlMZXZlbHMgPSB7XG4gICAgQW54aWV0eTogJ21vZGVyYXRlJyxcbiAgICBEZXByZXNzaW9uOiAnbWlsZCcsXG4gICAgU3RyZXNzOiAnaGlnaCcsXG4gIH07XG5cbiAgY29uc3QgbW9ja1ByZUFzc2Vzc21lbnQgPSB7XG4gICAgaWQ6ICdhc3Nlc3NtZW50LTEyMycsXG4gICAgY2xpZW50SWQ6ICd1c2VyLTEyMycsXG4gICAgcXVlc3Rpb25uYWlyZXM6IG1vY2tWYWxpZFF1ZXN0aW9ubmFpcmVzLFxuICAgIGFuc3dlcnM6IG1vY2tWYWxpZEFuc3dlcnMsXG4gICAgYW5zd2VyTWF0cml4OiBtb2NrVmFsaWRBbnN3ZXJNYXRyaXgsXG4gICAgc2NvcmVzOiB7IEFueGlldHk6IDE1LCBEZXByZXNzaW9uOiAxMiwgU3RyZXNzOiAxOCB9LFxuICAgIHNldmVyaXR5TGV2ZWxzOiBtb2NrU2V2ZXJpdHlMZXZlbHMsXG4gICAgYWlFc3RpbWF0ZTogeyBoYXNBbnhpZXR5OiB0cnVlLCBoYXNEZXByZXNzaW9uOiBmYWxzZSB9LFxuICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoJzIwMjQtMDEtMTVUMDA6MDA6MDBaJyksXG4gICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgnMjAyNC0wMS0xNVQwMDowMDowMFonKSxcbiAgfTtcblxuICBjb25zdCBtb2NrQWlSZXNwb25zZSA9IHtcbiAgICBzdWNjZXNzOiB0cnVlLFxuICAgIHByZWRpY3Rpb25zOiB7IGhhc0FueGlldHk6IHRydWUsIGhhc0RlcHJlc3Npb246IGZhbHNlLCBoYXNTdHJlc3M6IHRydWUgfSxcbiAgICByZXNwb25zZVRpbWU6IDE1MCxcbiAgfTtcblxuICBiZWZvcmVFYWNoKGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBtb2NrUHJpc21hU2VydmljZSA9IHtcbiAgICAgIHVzZXI6IHtcbiAgICAgICAgZmluZFVuaXF1ZTogamVzdC5mbigpLFxuICAgICAgfSxcbiAgICAgIGNsaWVudDoge1xuICAgICAgICBmaW5kVW5pcXVlOiBqZXN0LmZuKCksXG4gICAgICB9LFxuICAgICAgcHJlQXNzZXNzbWVudDoge1xuICAgICAgICBmaW5kVW5pcXVlOiBqZXN0LmZuKCksXG4gICAgICAgIGNyZWF0ZTogamVzdC5mbigpLFxuICAgICAgICB1cGRhdGU6IGplc3QuZm4oKSxcbiAgICAgICAgZGVsZXRlOiBqZXN0LmZuKCksXG4gICAgICB9LFxuICAgIH07XG5cbiAgICBjb25zdCBtb2NrQWlTZXJ2aWNlQ2xpZW50ID0ge1xuICAgICAgcHJlZGljdDogamVzdC5mbigpLFxuICAgIH07XG5cbiAgICBjb25zdCBtb2R1bGU6IFRlc3RpbmdNb2R1bGUgPSBhd2FpdCBUZXN0LmNyZWF0ZVRlc3RpbmdNb2R1bGUoe1xuICAgICAgcHJvdmlkZXJzOiBbXG4gICAgICAgIFByZUFzc2Vzc21lbnRTZXJ2aWNlLFxuICAgICAgICB7XG4gICAgICAgICAgcHJvdmlkZTogUHJpc21hU2VydmljZSxcbiAgICAgICAgICB1c2VWYWx1ZTogbW9ja1ByaXNtYVNlcnZpY2UsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlOiBBaVNlcnZpY2VDbGllbnQsXG4gICAgICAgICAgdXNlVmFsdWU6IG1vY2tBaVNlcnZpY2VDbGllbnQsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgIH0pLmNvbXBpbGUoKTtcblxuICAgIHNlcnZpY2UgPSBtb2R1bGUuZ2V0PFByZUFzc2Vzc21lbnRTZXJ2aWNlPihQcmVBc3Nlc3NtZW50U2VydmljZSk7XG4gICAgcHJpc21hU2VydmljZSA9IG1vZHVsZS5nZXQoUHJpc21hU2VydmljZSk7XG4gICAgYWlTZXJ2aWNlQ2xpZW50ID0gbW9kdWxlLmdldChBaVNlcnZpY2VDbGllbnQpO1xuXG4gICAgLy8gU2V0dXAgdXRpbGl0eSBtb2Nrc1xuICAgIChQcmVBc3Nlc3NtZW50VXRpbHMuY2FsY3VsYXRlQWxsU2NvcmVzIGFzIGplc3QuTW9jaykubW9ja1JldHVyblZhbHVlKFxuICAgICAgbW9ja0NhbGN1bGF0ZWRTY29yZXMsXG4gICAgKTtcbiAgICAoUHJlQXNzZXNzbWVudFV0aWxzLmdlbmVyYXRlU2V2ZXJpdHlMZXZlbHMgYXMgamVzdC5Nb2NrKS5tb2NrUmV0dXJuVmFsdWUoXG4gICAgICBtb2NrU2V2ZXJpdHlMZXZlbHMsXG4gICAgKTtcblxuICAgIC8vIFNldHVwIGxvZ2dlciBzcHlcbiAgICBsb2dnZXJTcHkgPSBqZXN0LnNweU9uKExvZ2dlci5wcm90b3R5cGUsICdsb2cnKS5tb2NrSW1wbGVtZW50YXRpb24oKTtcbiAgICBqZXN0LnNweU9uKExvZ2dlci5wcm90b3R5cGUsICdkZWJ1ZycpLm1vY2tJbXBsZW1lbnRhdGlvbigpO1xuICAgIGplc3Quc3B5T24oTG9nZ2VyLnByb3RvdHlwZSwgJ3dhcm4nKS5tb2NrSW1wbGVtZW50YXRpb24oKTtcbiAgICBqZXN0LnNweU9uKExvZ2dlci5wcm90b3R5cGUsICdlcnJvcicpLm1vY2tJbXBsZW1lbnRhdGlvbigpO1xuICB9KTtcblxuICBhZnRlckVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGJlIGRlZmluZWQnLCAoKSA9PiB7XG4gICAgZXhwZWN0KHNlcnZpY2UpLnRvQmVEZWZpbmVkKCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdjcmVhdGVQcmVBc3Nlc3NtZW50JywgKCkgPT4ge1xuICAgIGNvbnN0IHZhbGlkQ3JlYXRlRGF0YSA9IHtcbiAgICAgIHF1ZXN0aW9ubmFpcmVzOiBtb2NrVmFsaWRRdWVzdGlvbm5haXJlcyxcbiAgICAgIGFuc3dlcnM6IG1vY2tWYWxpZEFuc3dlcnMsXG4gICAgICBhbnN3ZXJNYXRyaXg6IG1vY2tWYWxpZEFuc3dlck1hdHJpeCxcbiAgICAgIHNjb3JlczogeyBBbnhpZXR5OiAxNSwgRGVwcmVzc2lvbjogMTIsIFN0cmVzczogMTggfSxcbiAgICAgIHNldmVyaXR5TGV2ZWxzOiBtb2NrU2V2ZXJpdHlMZXZlbHMsXG4gICAgICBhaUVzdGltYXRlOiB7IGhhc0FueGlldHk6IHRydWUsIGhhc0RlcHJlc3Npb246IGZhbHNlIH0sXG4gICAgfTtcblxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgcHJpc21hU2VydmljZS51c2VyLmZpbmRVbmlxdWUubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXIpO1xuICAgICAgcHJpc21hU2VydmljZS5jbGllbnQuZmluZFVuaXF1ZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrQ2xpZW50KTtcbiAgICAgIHByaXNtYVNlcnZpY2UucHJlQXNzZXNzbWVudC5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpOyAvLyBObyBleGlzdGluZyBhc3Nlc3NtZW50XG4gICAgICBwcmlzbWFTZXJ2aWNlLnByZUFzc2Vzc21lbnQuY3JlYXRlLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tQcmVBc3Nlc3NtZW50KTtcbiAgICAgIGFpU2VydmljZUNsaWVudC5wcmVkaWN0Lm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tBaVJlc3BvbnNlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY3JlYXRlIGEgcHJlLWFzc2Vzc21lbnQgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5jcmVhdGVQcmVBc3Nlc3NtZW50KFxuICAgICAgICAndXNlci0xMjMnLFxuICAgICAgICB2YWxpZENyZWF0ZURhdGEsXG4gICAgICApO1xuXG4gICAgICBleHBlY3QocHJpc21hU2VydmljZS51c2VyLmZpbmRVbmlxdWUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6ICd1c2VyLTEyMycsIGlzQWN0aXZlOiB0cnVlIH0sXG4gICAgICAgIHNlbGVjdDogeyBpZDogdHJ1ZSwgaXNBY3RpdmU6IHRydWUgfSxcbiAgICAgIH0pO1xuICAgICAgZXhwZWN0KHByaXNtYVNlcnZpY2UuY2xpZW50LmZpbmRVbmlxdWUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgd2hlcmU6IHsgdXNlcklkOiAndXNlci0xMjMnIH0sXG4gICAgICAgIHNlbGVjdDogeyB1c2VySWQ6IHRydWUgfSxcbiAgICAgIH0pO1xuICAgICAgZXhwZWN0KHByaXNtYVNlcnZpY2UucHJlQXNzZXNzbWVudC5jcmVhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIGNsaWVudElkOiAndXNlci0xMjMnLFxuICAgICAgICAgIHF1ZXN0aW9ubmFpcmVzOiBtb2NrVmFsaWRRdWVzdGlvbm5haXJlcyxcbiAgICAgICAgICBhbnN3ZXJzOiBtb2NrVmFsaWRBbnN3ZXJzLFxuICAgICAgICAgIGFuc3dlck1hdHJpeDogbW9ja1ZhbGlkQW5zd2VyTWF0cml4LFxuICAgICAgICAgIHNjb3JlczogdmFsaWRDcmVhdGVEYXRhLnNjb3JlcyxcbiAgICAgICAgICBzZXZlcml0eUxldmVsczogdmFsaWRDcmVhdGVEYXRhLnNldmVyaXR5TGV2ZWxzLFxuICAgICAgICAgIGFpRXN0aW1hdGU6IGV4cGVjdC5hbnkoT2JqZWN0KSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2NrUHJlQXNzZXNzbWVudCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IE5vdEZvdW5kRXhjZXB0aW9uIHdoZW4gdXNlciBub3QgZm91bmQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBwcmlzbWFTZXJ2aWNlLnVzZXIuZmluZFVuaXF1ZS5tb2NrUmVzb2x2ZWRWYWx1ZShudWxsKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBzZXJ2aWNlLmNyZWF0ZVByZUFzc2Vzc21lbnQoJ25vbmV4aXN0ZW50LXVzZXInLCB2YWxpZENyZWF0ZURhdGEpLFxuICAgICAgKS5yZWplY3RzLnRvVGhyb3cobmV3IE5vdEZvdW5kRXhjZXB0aW9uKCdVc2VyIG5vdCBmb3VuZCBvciBpbmFjdGl2ZScpKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdGhyb3cgTm90Rm91bmRFeGNlcHRpb24gd2hlbiB1c2VyIGlzIGluYWN0aXZlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gT3ZlcnJpZGUgdGhlIGJlZm9yZUVhY2ggbW9jayBmb3IgdGhpcyBzcGVjaWZpYyB0ZXN0XG4gICAgICBwcmlzbWFTZXJ2aWNlLnVzZXIuZmluZFVuaXF1ZS5tb2NrUmVzZXQoKTtcbiAgICAgIHByaXNtYVNlcnZpY2UudXNlci5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpOyAvLyBJbmFjdGl2ZSB1c2VycyByZXR1cm4gbnVsbCBmcm9tIFdIRVJFIGNsYXVzZVxuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIHNlcnZpY2UuY3JlYXRlUHJlQXNzZXNzbWVudCgndXNlci0xMjMnLCB2YWxpZENyZWF0ZURhdGEpLFxuICAgICAgKS5yZWplY3RzLnRvVGhyb3cobmV3IE5vdEZvdW5kRXhjZXB0aW9uKCdVc2VyIG5vdCBmb3VuZCBvciBpbmFjdGl2ZScpKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdGhyb3cgTm90Rm91bmRFeGNlcHRpb24gd2hlbiBjbGllbnQgcHJvZmlsZSBub3QgZm91bmQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBwcmlzbWFTZXJ2aWNlLmNsaWVudC5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIHNlcnZpY2UuY3JlYXRlUHJlQXNzZXNzbWVudCgndXNlci0xMjMnLCB2YWxpZENyZWF0ZURhdGEpLFxuICAgICAgKS5yZWplY3RzLnRvVGhyb3cobmV3IE5vdEZvdW5kRXhjZXB0aW9uKCdDbGllbnQgcHJvZmlsZSBub3QgZm91bmQnKSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IEJhZFJlcXVlc3RFeGNlcHRpb24gd2hlbiBwcmUtYXNzZXNzbWVudCBhbHJlYWR5IGV4aXN0cycsIGFzeW5jICgpID0+IHtcbiAgICAgIHByaXNtYVNlcnZpY2UucHJlQXNzZXNzbWVudC5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKFxuICAgICAgICBtb2NrUHJlQXNzZXNzbWVudCxcbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgc2VydmljZS5jcmVhdGVQcmVBc3Nlc3NtZW50KCd1c2VyLTEyMycsIHZhbGlkQ3JlYXRlRGF0YSksXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhcbiAgICAgICAgbmV3IEJhZFJlcXVlc3RFeGNlcHRpb24oJ1ByZS1hc3Nlc3NtZW50IGFscmVhZHkgZXhpc3RzIGZvciB0aGlzIHVzZXInKSxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNhbGN1bGF0ZSBzY29yZXMgd2hlbiBub3QgcHJvdmlkZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBkYXRhV2l0aG91dFNjb3JlcyA9IHtcbiAgICAgICAgcXVlc3Rpb25uYWlyZXM6IG1vY2tWYWxpZFF1ZXN0aW9ubmFpcmVzLFxuICAgICAgICBhbnN3ZXJzOiBtb2NrVmFsaWRBbnN3ZXJzLFxuICAgICAgICBhbnN3ZXJNYXRyaXg6IG1vY2tWYWxpZEFuc3dlck1hdHJpeCxcbiAgICAgICAgc2NvcmVzOiB1bmRlZmluZWQsIC8vIEV4cGxpY2l0bHkgdW5kZWZpbmVkIHRvIHRyaWdnZXIgY2FsY3VsYXRpb25cbiAgICAgICAgc2V2ZXJpdHlMZXZlbHM6IHVuZGVmaW5lZCwgLy8gRXhwbGljaXRseSB1bmRlZmluZWQgdG8gdHJpZ2dlciBjYWxjdWxhdGlvblxuICAgICAgICBhaUVzdGltYXRlOiB7fSxcbiAgICAgIH07XG5cbiAgICAgIGF3YWl0IHNlcnZpY2UuY3JlYXRlUHJlQXNzZXNzbWVudCgndXNlci0xMjMnLCBkYXRhV2l0aG91dFNjb3Jlcyk7XG5cbiAgICAgIGV4cGVjdChQcmVBc3Nlc3NtZW50VXRpbHMuY2FsY3VsYXRlQWxsU2NvcmVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgbW9ja1ZhbGlkUXVlc3Rpb25uYWlyZXMsXG4gICAgICAgIG1vY2tWYWxpZEFuc3dlcnMsXG4gICAgICApO1xuICAgICAgZXhwZWN0KFByZUFzc2Vzc21lbnRVdGlscy5nZW5lcmF0ZVNldmVyaXR5TGV2ZWxzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgbW9ja0NhbGN1bGF0ZWRTY29yZXMsXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgQUkgcHJlZGljdGlvbiBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBDcmVhdGUgZmxhdCBhbnN3ZXJzIGFycmF5IHdpdGggZXhhY3RseSAyMDEgdmFsdWVzXG4gICAgICBjb25zdCBmbGF0QW5zd2VycyA9IG5ldyBBcnJheSgyMDEpLmZpbGwoMCkubWFwKChfLCBpKSA9PiBpICUgNSk7XG4gICAgICBjb25zdCBkYXRhV2l0aDIwMVZhbHVlcyA9IHtcbiAgICAgICAgcXVlc3Rpb25uYWlyZXM6IFsnVGVzdCddLFxuICAgICAgICBhbnN3ZXJzOiBbZmxhdEFuc3dlcnNdLFxuICAgICAgICBhbnN3ZXJNYXRyaXg6IFtmbGF0QW5zd2Vyc10sXG4gICAgICAgIHNjb3Jlczoge30sXG4gICAgICAgIHNldmVyaXR5TGV2ZWxzOiB7fSxcbiAgICAgICAgYWlFc3RpbWF0ZToge30sXG4gICAgICB9O1xuXG4gICAgICBhd2FpdCBzZXJ2aWNlLmNyZWF0ZVByZUFzc2Vzc21lbnQoJ3VzZXItMTIzJywgZGF0YVdpdGgyMDFWYWx1ZXMpO1xuXG4gICAgICBleHBlY3QoYWlTZXJ2aWNlQ2xpZW50LnByZWRpY3QpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGZsYXRBbnN3ZXJzKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY29udGludWUgd2l0aG91dCBBSSBwcmVkaWN0aW9uIHdoZW4gQUkgc2VydmljZSBmYWlscycsIGFzeW5jICgpID0+IHtcbiAgICAgIGFpU2VydmljZUNsaWVudC5wcmVkaWN0Lm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiAnQUkgc2VydmljZSB1bmF2YWlsYWJsZScsXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5jcmVhdGVQcmVBc3Nlc3NtZW50KFxuICAgICAgICAndXNlci0xMjMnLFxuICAgICAgICB2YWxpZENyZWF0ZURhdGEsXG4gICAgICApO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGxvZ2dlclNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCdQcmUtYXNzZXNzbWVudCBjcmVhdGVkIHN1Y2Nlc3NmdWxseScpLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHZhbGlkYXRpb24gZXJyb3JzIGZvciBpbnZhbGlkIGFuc3dlciB0eXBlcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGludmFsaWREYXRhID0ge1xuICAgICAgICAuLi52YWxpZENyZWF0ZURhdGEsXG4gICAgICAgIGFuc3dlcnM6IFtbJ2ludmFsaWQnLCAnZGF0YSddXSwgLy8gSW52YWxpZCBhbnN3ZXIgdHlwZXNcbiAgICAgIH07XG5cbiAgICAgIC8vIFNob3VsZCB0aHJvdyBiZWNhdXNlIHZhbGlkYXRpb24gaGFwcGVucyBiZWZvcmUgQUkgcHJvY2Vzc2luZ1xuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBzZXJ2aWNlLmNyZWF0ZVByZUFzc2Vzc21lbnQoJ3VzZXItMTIzJywgaW52YWxpZERhdGEpLFxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coQmFkUmVxdWVzdEV4Y2VwdGlvbik7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnSW5wdXQgdmFsaWRhdGlvbicsICgpID0+IHtcbiAgICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgcXVlc3Rpb25uYWlyZXMgYXJyYXknLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGludmFsaWREYXRhID0ge1xuICAgICAgICAgIC4uLnZhbGlkQ3JlYXRlRGF0YSxcbiAgICAgICAgICBxdWVzdGlvbm5haXJlczogJ2ludmFsaWQtc3RyaW5nJyxcbiAgICAgICAgfTtcblxuICAgICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgICAgc2VydmljZS5jcmVhdGVQcmVBc3Nlc3NtZW50KCd1c2VyLTEyMycsIGludmFsaWREYXRhKSxcbiAgICAgICAgKS5yZWplY3RzLnRvVGhyb3coQmFkUmVxdWVzdEV4Y2VwdGlvbik7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBlbXB0eSBxdWVzdGlvbm5haXJlcyBhcnJheScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgaW52YWxpZERhdGEgPSB7XG4gICAgICAgICAgLi4udmFsaWRDcmVhdGVEYXRhLFxuICAgICAgICAgIHF1ZXN0aW9ubmFpcmVzOiBbXSxcbiAgICAgICAgfTtcblxuICAgICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgICAgc2VydmljZS5jcmVhdGVQcmVBc3Nlc3NtZW50KCd1c2VyLTEyMycsIGludmFsaWREYXRhKSxcbiAgICAgICAgKS5yZWplY3RzLnRvVGhyb3coXG4gICAgICAgICAgbmV3IEJhZFJlcXVlc3RFeGNlcHRpb24oJ0F0IGxlYXN0IG9uZSBxdWVzdGlvbm5haXJlIGlzIHJlcXVpcmVkJyksXG4gICAgICAgICk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBxdWVzdGlvbm5haXJlcyBhbmQgYW5zd2VycyBhbGlnbm1lbnQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IG1pc21hdGNoZWREYXRhID0ge1xuICAgICAgICAgIC4uLnZhbGlkQ3JlYXRlRGF0YSxcbiAgICAgICAgICBxdWVzdGlvbm5haXJlczogWydBbnhpZXR5JywgJ0RlcHJlc3Npb24nXSwgLy8gMiBxdWVzdGlvbm5haXJlc1xuICAgICAgICAgIGFuc3dlcnM6IFtbMSwgMiwgM11dLCAvLyAxIGFuc3dlciBhcnJheVxuICAgICAgICB9O1xuXG4gICAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgICBzZXJ2aWNlLmNyZWF0ZVByZUFzc2Vzc21lbnQoJ3VzZXItMTIzJywgbWlzbWF0Y2hlZERhdGEpLFxuICAgICAgICApLnJlamVjdHMudG9UaHJvdyhcbiAgICAgICAgICBuZXcgQmFkUmVxdWVzdEV4Y2VwdGlvbihcbiAgICAgICAgICAgICdOdW1iZXIgb2YgcXVlc3Rpb25uYWlyZXMgbXVzdCBtYXRjaCBudW1iZXIgb2YgYW5zd2VyIGFycmF5cycsXG4gICAgICAgICAgKSxcbiAgICAgICAgKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIGFuc3dlciB2YWx1ZXMgYXJlIG51bWJlcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGludmFsaWREYXRhID0ge1xuICAgICAgICAgIC4uLnZhbGlkQ3JlYXRlRGF0YSxcbiAgICAgICAgICBhbnN3ZXJzOiBbWzEsIDIsICdpbnZhbGlkJywgNF1dLCAvLyBJbnZhbGlkIGFuc3dlciB0eXBlXG4gICAgICAgIH07XG5cbiAgICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICAgIHNlcnZpY2UuY3JlYXRlUHJlQXNzZXNzbWVudCgndXNlci0xMjMnLCBpbnZhbGlkRGF0YSksXG4gICAgICAgICkucmVqZWN0cy50b1Rocm93KEJhZFJlcXVlc3RFeGNlcHRpb24pO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgYW5zd2VyIHZhbHVlcyBhcmUgaW4gcmFuZ2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGludmFsaWREYXRhID0ge1xuICAgICAgICAgIC4uLnZhbGlkQ3JlYXRlRGF0YSxcbiAgICAgICAgICBhbnN3ZXJzOiBbWzEsIDIsIDE1LCA0XV0sIC8vIFZhbHVlIG91dCBvZiByYW5nZSAoMC0xMClcbiAgICAgICAgfTtcblxuICAgICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgICAgc2VydmljZS5jcmVhdGVQcmVBc3Nlc3NtZW50KCd1c2VyLTEyMycsIGludmFsaWREYXRhKSxcbiAgICAgICAgKS5yZWplY3RzLnRvVGhyb3coQmFkUmVxdWVzdEV4Y2VwdGlvbik7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBhbnN3ZXIgdmFsdWVzIGFyZSBmaW5pdGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGludmFsaWREYXRhID0ge1xuICAgICAgICAgIC4uLnZhbGlkQ3JlYXRlRGF0YSxcbiAgICAgICAgICBhbnN3ZXJzOiBbWzEsIDIsIEluZmluaXR5LCA0XV0sIC8vIEluZmluaXRlIHZhbHVlXG4gICAgICAgIH07XG5cbiAgICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICAgIHNlcnZpY2UuY3JlYXRlUHJlQXNzZXNzbWVudCgndXNlci0xMjMnLCBpbnZhbGlkRGF0YSksXG4gICAgICAgICkucmVqZWN0cy50b1Rocm93KEJhZFJlcXVlc3RFeGNlcHRpb24pO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgcXVlc3Rpb25uYWlyZSBuYW1lcyBhcmUgc3RyaW5ncycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgaW52YWxpZERhdGEgPSB7XG4gICAgICAgICAgLi4udmFsaWRDcmVhdGVEYXRhLFxuICAgICAgICAgIHF1ZXN0aW9ubmFpcmVzOiBbJ1ZhbGlkJywgMTIzLCAnQW5vdGhlciddLCAvLyBJbnZhbGlkIHF1ZXN0aW9ubmFpcmUgdHlwZVxuICAgICAgICB9O1xuXG4gICAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgICBzZXJ2aWNlLmNyZWF0ZVByZUFzc2Vzc21lbnQoJ3VzZXItMTIzJywgaW52YWxpZERhdGEpLFxuICAgICAgICApLnJlamVjdHMudG9UaHJvdyhCYWRSZXF1ZXN0RXhjZXB0aW9uKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIHdhcm4gYWJvdXQgdW5rbm93biBxdWVzdGlvbm5haXJlIHR5cGVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBkYXRhV2l0aFVua25vd25RdWVzdGlvbm5haXJlID0ge1xuICAgICAgICAgIC4uLnZhbGlkQ3JlYXRlRGF0YSxcbiAgICAgICAgICBxdWVzdGlvbm5haXJlczogWydBbnhpZXR5JywgJ1Vua25vd25UeXBlJ10sXG4gICAgICAgICAgYW5zd2VyczogW1xuICAgICAgICAgICAgWzEsIDIsIDNdLFxuICAgICAgICAgICAgWzQsIDUsIDZdLFxuICAgICAgICAgIF0sIC8vIE1hdGNoIHRoZSBxdWVzdGlvbm5haXJlIGNvdW50XG4gICAgICAgIH07XG5cbiAgICAgICAgYXdhaXQgc2VydmljZS5jcmVhdGVQcmVBc3Nlc3NtZW50KFxuICAgICAgICAgICd1c2VyLTEyMycsXG4gICAgICAgICAgZGF0YVdpdGhVbmtub3duUXVlc3Rpb25uYWlyZSxcbiAgICAgICAgKTtcblxuICAgICAgICBleHBlY3QoTG9nZ2VyLnByb3RvdHlwZS53YXJuKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgICAnVW5rbm93biBxdWVzdGlvbm5haXJlIHR5cGU6IFVua25vd25UeXBlJyxcbiAgICAgICAgKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ0Vycm9yIGhhbmRsaW5nJywgKCkgPT4ge1xuICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgZGF0YWJhc2UgZXJyb3JzIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIHByaXNtYVNlcnZpY2UucHJlQXNzZXNzbWVudC5jcmVhdGUubW9ja1JlamVjdGVkVmFsdWUoXG4gICAgICAgICAgbmV3IEVycm9yKCdEYXRhYmFzZSBlcnJvcicpLFxuICAgICAgICApO1xuXG4gICAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgICBzZXJ2aWNlLmNyZWF0ZVByZUFzc2Vzc21lbnQoJ3VzZXItMTIzJywgdmFsaWRDcmVhdGVEYXRhKSxcbiAgICAgICAgKS5yZWplY3RzLnRvVGhyb3coSW50ZXJuYWxTZXJ2ZXJFcnJvckV4Y2VwdGlvbik7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBwcmVzZXJ2ZSBzcGVjaWZpYyBleGNlcHRpb24gdHlwZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IG5vdEZvdW5kRXJyb3IgPSBuZXcgTm90Rm91bmRFeGNlcHRpb24oJ1VzZXIgbm90IGZvdW5kJyk7XG4gICAgICAgIHByaXNtYVNlcnZpY2UudXNlci5maW5kVW5pcXVlLm1vY2tSZWplY3RlZFZhbHVlKG5vdEZvdW5kRXJyb3IpO1xuXG4gICAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgICBzZXJ2aWNlLmNyZWF0ZVByZUFzc2Vzc21lbnQoJ3VzZXItMTIzJywgdmFsaWRDcmVhdGVEYXRhKSxcbiAgICAgICAgKS5yZWplY3RzLnRvVGhyb3coTm90Rm91bmRFeGNlcHRpb24pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdnZXRQcmVBc3Nlc3NtZW50QnlVc2VySWQnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gcHJlLWFzc2Vzc21lbnQgZm9yIHZhbGlkIHVzZXIgSUQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBwcmlzbWFTZXJ2aWNlLnByZUFzc2Vzc21lbnQuZmluZFVuaXF1ZS5tb2NrUmVzb2x2ZWRWYWx1ZShcbiAgICAgICAgbW9ja1ByZUFzc2Vzc21lbnQsXG4gICAgICApO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLmdldFByZUFzc2Vzc21lbnRCeVVzZXJJZCgndXNlci0xMjMnKTtcblxuICAgICAgZXhwZWN0KHByaXNtYVNlcnZpY2UucHJlQXNzZXNzbWVudC5maW5kVW5pcXVlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIHdoZXJlOiB7IGNsaWVudElkOiAndXNlci0xMjMnIH0sXG4gICAgICB9KTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja1ByZUFzc2Vzc21lbnQpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0aHJvdyBOb3RGb3VuZEV4Y2VwdGlvbiB3aGVuIHByZS1hc3Nlc3NtZW50IG5vdCBmb3VuZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIHByaXNtYVNlcnZpY2UucHJlQXNzZXNzbWVudC5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIHNlcnZpY2UuZ2V0UHJlQXNzZXNzbWVudEJ5VXNlcklkKCd1c2VyLTEyMycpLFxuICAgICAgKS5yZWplY3RzLnRvVGhyb3cobmV3IE5vdEZvdW5kRXhjZXB0aW9uKCdQcmUtYXNzZXNzbWVudCBub3QgZm91bmQnKSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBkYXRhYmFzZSBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBwcmlzbWFTZXJ2aWNlLnByZUFzc2Vzc21lbnQuZmluZFVuaXF1ZS5tb2NrUmVqZWN0ZWRWYWx1ZShcbiAgICAgICAgbmV3IEVycm9yKCdEYXRhYmFzZSBlcnJvcicpLFxuICAgICAgKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBzZXJ2aWNlLmdldFByZUFzc2Vzc21lbnRCeVVzZXJJZCgndXNlci0xMjMnKSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KEludGVybmFsU2VydmVyRXJyb3JFeGNlcHRpb24pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZ2V0UHJlQXNzZXNzbWVudEJ5Q2xpZW50SWQnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gcHJlLWFzc2Vzc21lbnQgd2l0aCBjbGllbnQgYW5kIHVzZXIgZGF0YScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tQcmVBc3Nlc3NtZW50V2l0aENsaWVudCA9IHtcbiAgICAgICAgLi4ubW9ja1ByZUFzc2Vzc21lbnQsXG4gICAgICAgIGNsaWVudDoge1xuICAgICAgICAgIHVzZXI6IG1vY2tVc2VyLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICAgIHByaXNtYVNlcnZpY2UucHJlQXNzZXNzbWVudC5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKFxuICAgICAgICBtb2NrUHJlQXNzZXNzbWVudFdpdGhDbGllbnQsXG4gICAgICApO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLmdldFByZUFzc2Vzc21lbnRCeUNsaWVudElkKCd1c2VyLTEyMycpO1xuXG4gICAgICBleHBlY3QocHJpc21hU2VydmljZS5wcmVBc3Nlc3NtZW50LmZpbmRVbmlxdWUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgd2hlcmU6IHsgY2xpZW50SWQ6ICd1c2VyLTEyMycgfSxcbiAgICAgICAgaW5jbHVkZTogeyBjbGllbnQ6IHsgaW5jbHVkZTogeyB1c2VyOiB0cnVlIH0gfSB9LFxuICAgICAgfSk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKG1vY2tQcmVBc3Nlc3NtZW50V2l0aENsaWVudCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IE5vdEZvdW5kRXhjZXB0aW9uIHdoZW4gcHJlLWFzc2Vzc21lbnQgbm90IGZvdW5kJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcHJpc21hU2VydmljZS5wcmVBc3Nlc3NtZW50LmZpbmRVbmlxdWUubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgc2VydmljZS5nZXRQcmVBc3Nlc3NtZW50QnlDbGllbnRJZCgndXNlci0xMjMnKSxcbiAgICAgICkucmVqZWN0cy50b1Rocm93KG5ldyBOb3RGb3VuZEV4Y2VwdGlvbignUHJlLWFzc2Vzc21lbnQgbm90IGZvdW5kJykpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgndXBkYXRlUHJlQXNzZXNzbWVudCcsICgpID0+IHtcbiAgICBjb25zdCB1cGRhdGVEYXRhID0ge1xuICAgICAgcXVlc3Rpb25uYWlyZXM6IFsnQW54aWV0eScsICdTdHJlc3MnXSxcbiAgICAgIGFuc3dlcnM6IFtcbiAgICAgICAgWzEsIDIsIDNdLFxuICAgICAgICBbNCwgNSwgNl0sXG4gICAgICBdLFxuICAgICAgYW5zd2VyTWF0cml4OiBbXG4gICAgICAgIFsxLCAyXSxcbiAgICAgICAgWzMsIDRdLFxuICAgICAgXSxcbiAgICB9O1xuXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICBwcmlzbWFTZXJ2aWNlLmNsaWVudC5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tDbGllbnQpO1xuICAgICAgcHJpc21hU2VydmljZS5wcmVBc3Nlc3NtZW50LnVwZGF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUHJlQXNzZXNzbWVudCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHVwZGF0ZSBwcmUtYXNzZXNzbWVudCBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLnVwZGF0ZVByZUFzc2Vzc21lbnQoJ3VzZXItMTIzJywgdXBkYXRlRGF0YSk7XG5cbiAgICAgIGV4cGVjdChwcmlzbWFTZXJ2aWNlLmNsaWVudC5maW5kVW5pcXVlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIHdoZXJlOiB7IHVzZXJJZDogJ3VzZXItMTIzJyB9LFxuICAgICAgfSk7XG4gICAgICBleHBlY3QocHJpc21hU2VydmljZS5wcmVBc3Nlc3NtZW50LnVwZGF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICB3aGVyZTogeyBjbGllbnRJZDogJ3VzZXItMTIzJyB9LFxuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgcXVlc3Rpb25uYWlyZXM6IHVwZGF0ZURhdGEucXVlc3Rpb25uYWlyZXMsXG4gICAgICAgICAgYW5zd2VyczogdXBkYXRlRGF0YS5hbnN3ZXJzLFxuICAgICAgICAgIGFuc3dlck1hdHJpeDogdXBkYXRlRGF0YS5hbnN3ZXJNYXRyaXgsXG4gICAgICAgICAgc2NvcmVzOiBleHBlY3QuYW55KE9iamVjdCksXG4gICAgICAgICAgc2V2ZXJpdHlMZXZlbHM6IGV4cGVjdC5hbnkoT2JqZWN0KSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2NrUHJlQXNzZXNzbWVudCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHVzZSBwcm92aWRlZCBzY29yZXMgd2hlbiB2YWxpZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGRhdGFXaXRoU2NvcmVzID0ge1xuICAgICAgICAuLi51cGRhdGVEYXRhLFxuICAgICAgICBzY29yZXM6IHsgQW54aWV0eTogMjAsIFN0cmVzczogMTUgfSxcbiAgICAgICAgc2V2ZXJpdHlMZXZlbHM6IHsgQW54aWV0eTogJ2hpZ2gnLCBTdHJlc3M6ICdtb2RlcmF0ZScgfSxcbiAgICAgIH07XG5cbiAgICAgIGF3YWl0IHNlcnZpY2UudXBkYXRlUHJlQXNzZXNzbWVudCgndXNlci0xMjMnLCBkYXRhV2l0aFNjb3Jlcyk7XG5cbiAgICAgIGV4cGVjdChwcmlzbWFTZXJ2aWNlLnByZUFzc2Vzc21lbnQudXBkYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIHdoZXJlOiB7IGNsaWVudElkOiAndXNlci0xMjMnIH0sXG4gICAgICAgIGRhdGE6IGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICBzY29yZXM6IHsgQW54aWV0eTogMjAsIFN0cmVzczogMTUgfSxcbiAgICAgICAgICBzZXZlcml0eUxldmVsczogeyBBbnhpZXR5OiAnaGlnaCcsIFN0cmVzczogJ21vZGVyYXRlJyB9LFxuICAgICAgICB9KSxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjYWxjdWxhdGUgc2NvcmVzIHdoZW4gcXVlc3Rpb25uYWlyZXMgYW5kIGFuc3dlcnMgcHJvdmlkZWQgd2l0aG91dCBzY29yZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBzZXJ2aWNlLnVwZGF0ZVByZUFzc2Vzc21lbnQoJ3VzZXItMTIzJywgdXBkYXRlRGF0YSk7XG5cbiAgICAgIGV4cGVjdChQcmVBc3Nlc3NtZW50VXRpbHMuY2FsY3VsYXRlQWxsU2NvcmVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgdXBkYXRlRGF0YS5xdWVzdGlvbm5haXJlcyxcbiAgICAgICAgdXBkYXRlRGF0YS5hbnN3ZXJzLFxuICAgICAgKTtcbiAgICAgIGV4cGVjdChQcmVBc3Nlc3NtZW50VXRpbHMuZ2VuZXJhdGVTZXZlcml0eUxldmVscykudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIG1vY2tDYWxjdWxhdGVkU2NvcmVzLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdGhyb3cgTm90Rm91bmRFeGNlcHRpb24gd2hlbiBjbGllbnQgbm90IGZvdW5kJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcHJpc21hU2VydmljZS5jbGllbnQuZmluZFVuaXF1ZS5tb2NrUmVzb2x2ZWRWYWx1ZShudWxsKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBzZXJ2aWNlLnVwZGF0ZVByZUFzc2Vzc21lbnQoJ3VzZXItMTIzJywgdXBkYXRlRGF0YSksXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhuZXcgTm90Rm91bmRFeGNlcHRpb24oJ0NsaWVudCBub3QgZm91bmQnKSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBpbnZhbGlkIHNjb3JlcyBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZGF0YVdpdGhJbnZhbGlkU2NvcmVzID0ge1xuICAgICAgICAuLi51cGRhdGVEYXRhLFxuICAgICAgICBzY29yZXM6ICdpbnZhbGlkLXNjb3JlcycsXG4gICAgICAgIHNldmVyaXR5TGV2ZWxzOiB7IHZhbGlkOiAnbGV2ZWxzJyB9LFxuICAgICAgfTtcblxuICAgICAgYXdhaXQgc2VydmljZS51cGRhdGVQcmVBc3Nlc3NtZW50KCd1c2VyLTEyMycsIGRhdGFXaXRoSW52YWxpZFNjb3Jlcyk7XG5cbiAgICAgIGV4cGVjdChwcmlzbWFTZXJ2aWNlLnByZUFzc2Vzc21lbnQudXBkYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIHdoZXJlOiB7IGNsaWVudElkOiAndXNlci0xMjMnIH0sXG4gICAgICAgIGRhdGE6IGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICBzY29yZXM6IGV4cGVjdC5hbnkoT2JqZWN0KSwgLy8gU2hvdWxkIGJlIGNhbGN1bGF0ZWQgc2NvcmVzXG4gICAgICAgICAgc2V2ZXJpdHlMZXZlbHM6IHsgdmFsaWQ6ICdsZXZlbHMnIH0sXG4gICAgICAgIH0pLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBpbnZhbGlkIHNldmVyaXR5IGxldmVscyBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZGF0YVdpdGhJbnZhbGlkTGV2ZWxzID0ge1xuICAgICAgICAuLi51cGRhdGVEYXRhLFxuICAgICAgICBzY29yZXM6IHsgQW54aWV0eTogMTUgfSxcbiAgICAgICAgc2V2ZXJpdHlMZXZlbHM6IDEyMywgLy8gSW52YWxpZCB0eXBlXG4gICAgICB9O1xuXG4gICAgICBhd2FpdCBzZXJ2aWNlLnVwZGF0ZVByZUFzc2Vzc21lbnQoJ3VzZXItMTIzJywgZGF0YVdpdGhJbnZhbGlkTGV2ZWxzKTtcblxuICAgICAgZXhwZWN0KHByaXNtYVNlcnZpY2UucHJlQXNzZXNzbWVudC51cGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgd2hlcmU6IHsgY2xpZW50SWQ6ICd1c2VyLTEyMycgfSxcbiAgICAgICAgZGF0YTogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgIHNjb3JlczogeyBBbnhpZXR5OiAxNSB9LFxuICAgICAgICAgIHNldmVyaXR5TGV2ZWxzOiBleHBlY3QuYW55KE9iamVjdCksIC8vIFNob3VsZCBiZSBjYWxjdWxhdGVkIGxldmVsc1xuICAgICAgICB9KSxcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZGVsZXRlUHJlQXNzZXNzbWVudCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGRlbGV0ZSBwcmUtYXNzZXNzbWVudCBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBwcmlzbWFTZXJ2aWNlLnByZUFzc2Vzc21lbnQuZGVsZXRlLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tQcmVBc3Nlc3NtZW50KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5kZWxldGVQcmVBc3Nlc3NtZW50KCd1c2VyLTEyMycpO1xuXG4gICAgICBleHBlY3QocHJpc21hU2VydmljZS5wcmVBc3Nlc3NtZW50LmRlbGV0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICB3aGVyZTogeyBjbGllbnRJZDogJ3VzZXItMTIzJyB9LFxuICAgICAgfSk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlTnVsbCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZGVsZXRpb24gZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcHJpc21hU2VydmljZS5wcmVBc3Nlc3NtZW50LmRlbGV0ZS5tb2NrUmVqZWN0ZWRWYWx1ZShcbiAgICAgICAgbmV3IEVycm9yKCdEZWxldGUgZmFpbGVkJyksXG4gICAgICApO1xuXG4gICAgICBhd2FpdCBleHBlY3Qoc2VydmljZS5kZWxldGVQcmVBc3Nlc3NtZW50KCd1c2VyLTEyMycpKS5yZWplY3RzLnRvVGhyb3coXG4gICAgICAgIEludGVybmFsU2VydmVyRXJyb3JFeGNlcHRpb24sXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZmxhdHRlbkFuc3dlcnMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBmbGF0dGVuIDJEIGFycmF5IGNvcnJlY3RseScsICgpID0+IHtcbiAgICAgIGNvbnN0IGFuc3dlcnMgPSBbXG4gICAgICAgIFsxLCAyLCAzXSxcbiAgICAgICAgWzQsIDVdLFxuICAgICAgICBbNiwgNywgOCwgOV0sXG4gICAgICBdO1xuICAgICAgLy8gQWNjZXNzIHByaXZhdGUgbWV0aG9kIHRocm91Z2ggc2VydmljZSBpbnN0YW5jZVxuICAgICAgY29uc3QgcmVzdWx0ID0gKHNlcnZpY2UgYXMgYW55KS5mbGF0dGVuQW5zd2VycyhhbnN3ZXJzKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChbMSwgMiwgMywgNCwgNSwgNiwgNywgOCwgOV0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBmbGF0dGVuZWQgYXJyYXkgaXMgbm90IGVtcHR5JywgKCkgPT4ge1xuICAgICAgY29uc3QgZW1wdHlBbnN3ZXJzID0gW1tdLCBbXSwgW11dO1xuXG4gICAgICBleHBlY3QoKCkgPT4gKHNlcnZpY2UgYXMgYW55KS5mbGF0dGVuQW5zd2VycyhlbXB0eUFuc3dlcnMpKS50b1Rocm93KFxuICAgICAgICBuZXcgQmFkUmVxdWVzdEV4Y2VwdGlvbignRmxhdHRlbmVkIGFuc3dlcnMgYXJyYXkgY2Fubm90IGJlIGVtcHR5JyksXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBhbGwgdmFsdWVzIGFyZSBmaW5pdGUgbnVtYmVycycsICgpID0+IHtcbiAgICAgIGNvbnN0IGludmFsaWRBbnN3ZXJzID0gW1xuICAgICAgICBbMSwgMiwgTmFOXSxcbiAgICAgICAgWzQsIDVdLFxuICAgICAgXTtcblxuICAgICAgZXhwZWN0KCgpID0+IChzZXJ2aWNlIGFzIGFueSkuZmxhdHRlbkFuc3dlcnMoaW52YWxpZEFuc3dlcnMpKS50b1Rocm93KFxuICAgICAgICBuZXcgQmFkUmVxdWVzdEV4Y2VwdGlvbignQWxsIGFuc3dlciB2YWx1ZXMgbXVzdCBiZSBmaW5pdGUgbnVtYmVycycpLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgd2FybiB3aGVuIG5vdCBleGFjdGx5IDIwMSB2YWx1ZXMgZm9yIEFJIHByZWRpY3Rpb24nLCAoKSA9PiB7XG4gICAgICBjb25zdCBzaG9ydEFuc3dlcnMgPSBbWzEsIDIsIDNdXTtcbiAgICAgIGNvbnN0IHdhcm5TcHkgPSBqZXN0LnNweU9uKExvZ2dlci5wcm90b3R5cGUsICd3YXJuJyk7XG5cbiAgICAgIChzZXJ2aWNlIGFzIGFueSkuZmxhdHRlbkFuc3dlcnMoc2hvcnRBbnN3ZXJzKTtcblxuICAgICAgZXhwZWN0KHdhcm5TcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAnRXhwZWN0ZWQgMjAxIHZhbHVlcyBmb3IgQUkgcHJlZGljdGlvbiwgZ290IDMnLFxuICAgICAgKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3ZhbGlkYXRlQW5zd2Vyc1N0cnVjdHVyZScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHBhc3MgdmFsaWRhdGlvbiBmb3IgdmFsaWQgYW5zd2VycyBzdHJ1Y3R1cmUnLCAoKSA9PiB7XG4gICAgICBjb25zdCB2YWxpZEFuc3dlcnMgPSBbXG4gICAgICAgIFsxLCAyLCAzXSxcbiAgICAgICAgWzQsIDUsIDZdLFxuICAgICAgXTtcblxuICAgICAgZXhwZWN0KCgpID0+XG4gICAgICAgIChzZXJ2aWNlIGFzIGFueSkudmFsaWRhdGVBbnN3ZXJzU3RydWN0dXJlKHZhbGlkQW5zd2VycyksXG4gICAgICApLm5vdC50b1Rocm93KCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IGVycm9yIGZvciBub24tYXJyYXkgaW5wdXQnLCAoKSA9PiB7XG4gICAgICBleHBlY3QoKCkgPT5cbiAgICAgICAgKHNlcnZpY2UgYXMgYW55KS52YWxpZGF0ZUFuc3dlcnNTdHJ1Y3R1cmUoJ2ludmFsaWQnKSxcbiAgICAgICkudG9UaHJvdyhuZXcgQmFkUmVxdWVzdEV4Y2VwdGlvbignQW5zd2VycyBtdXN0IGJlIGFuIGFycmF5IG9mIGFycmF5cycpKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdGhyb3cgZXJyb3IgZm9yIGVtcHR5IGFuc3dlcnMgYXJyYXknLCAoKSA9PiB7XG4gICAgICBleHBlY3QoKCkgPT4gKHNlcnZpY2UgYXMgYW55KS52YWxpZGF0ZUFuc3dlcnNTdHJ1Y3R1cmUoW10pKS50b1Rocm93KFxuICAgICAgICBuZXcgQmFkUmVxdWVzdEV4Y2VwdGlvbignQW5zd2VycyBhcnJheSBjYW5ub3QgYmUgZW1wdHknKSxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IGVycm9yIGZvciBub24tYXJyYXkgcXVlc3Rpb25uYWlyZSBhbnN3ZXJzJywgKCkgPT4ge1xuICAgICAgY29uc3QgaW52YWxpZEFuc3dlcnMgPSBbWzEsIDIsIDNdLCAnaW52YWxpZCcsIFs0LCA1LCA2XV07IC8vIEZpcnN0IGVsZW1lbnQgaXMgdmFsaWQgbnVtYmVyc1xuXG4gICAgICBleHBlY3QoKCkgPT5cbiAgICAgICAgKHNlcnZpY2UgYXMgYW55KS52YWxpZGF0ZUFuc3dlcnNTdHJ1Y3R1cmUoaW52YWxpZEFuc3dlcnMpLFxuICAgICAgKS50b1Rocm93KFxuICAgICAgICBuZXcgQmFkUmVxdWVzdEV4Y2VwdGlvbignUXVlc3Rpb25uYWlyZSAxIGFuc3dlcnMgbXVzdCBiZSBhbiBhcnJheScpLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdGhyb3cgZXJyb3IgZm9yIGVtcHR5IHF1ZXN0aW9ubmFpcmUgYW5zd2VycycsICgpID0+IHtcbiAgICAgIGNvbnN0IGludmFsaWRBbnN3ZXJzID0gW1sxLCAyLCAzXSwgW10sIFs0LCA1LCA2XV07XG5cbiAgICAgIGV4cGVjdCgoKSA9PlxuICAgICAgICAoc2VydmljZSBhcyBhbnkpLnZhbGlkYXRlQW5zd2Vyc1N0cnVjdHVyZShpbnZhbGlkQW5zd2VycyksXG4gICAgICApLnRvVGhyb3coXG4gICAgICAgIG5ldyBCYWRSZXF1ZXN0RXhjZXB0aW9uKCdRdWVzdGlvbm5haXJlIDEgY2Fubm90IGhhdmUgZW1wdHkgYW5zd2VycycpLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdGhyb3cgZXJyb3IgZm9yIG91dC1vZi1yYW5nZSB2YWx1ZXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBpbnZhbGlkQW5zd2VycyA9IFtcbiAgICAgICAgWzEsIDIsIDE1XSxcbiAgICAgICAgWzQsIDUsIDZdLFxuICAgICAgXTsgLy8gMTUgaXMgb3V0IG9mIHJhbmdlXG5cbiAgICAgIGV4cGVjdCgoKSA9PlxuICAgICAgICAoc2VydmljZSBhcyBhbnkpLnZhbGlkYXRlQW5zd2Vyc1N0cnVjdHVyZShpbnZhbGlkQW5zd2VycyksXG4gICAgICApLnRvVGhyb3coXG4gICAgICAgIG5ldyBCYWRSZXF1ZXN0RXhjZXB0aW9uKFxuICAgICAgICAgICdBbnN3ZXIgdmFsdWUgb3V0IG9mIHJhbmdlICgwLTEwKSBhdCBxdWVzdGlvbm5haXJlIDAsIHF1ZXN0aW9uIDI6IDE1JyxcbiAgICAgICAgKSxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IGVycm9yIGZvciBuZWdhdGl2ZSB2YWx1ZXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBpbnZhbGlkQW5zd2VycyA9IFtcbiAgICAgICAgWzEsIDIsIC0xXSxcbiAgICAgICAgWzQsIDUsIDZdLFxuICAgICAgXTsgLy8gLTEgaXMgb3V0IG9mIHJhbmdlXG5cbiAgICAgIGV4cGVjdCgoKSA9PlxuICAgICAgICAoc2VydmljZSBhcyBhbnkpLnZhbGlkYXRlQW5zd2Vyc1N0cnVjdHVyZShpbnZhbGlkQW5zd2VycyksXG4gICAgICApLnRvVGhyb3coXG4gICAgICAgIG5ldyBCYWRSZXF1ZXN0RXhjZXB0aW9uKFxuICAgICAgICAgICdBbnN3ZXIgdmFsdWUgb3V0IG9mIHJhbmdlICgwLTEwKSBhdCBxdWVzdGlvbm5haXJlIDAsIHF1ZXN0aW9uIDI6IC0xJyxcbiAgICAgICAgKSxcbiAgICAgICk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCd2YWxpZGF0ZVF1ZXN0aW9ubmFpcmVzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcGFzcyB2YWxpZGF0aW9uIGZvciB2YWxpZCBxdWVzdGlvbm5haXJlcycsICgpID0+IHtcbiAgICAgIGNvbnN0IHZhbGlkUXVlc3Rpb25uYWlyZXMgPSBbJ0FueGlldHknLCAnRGVwcmVzc2lvbicsICdTdHJlc3MnXTtcblxuICAgICAgZXhwZWN0KCgpID0+XG4gICAgICAgIChzZXJ2aWNlIGFzIGFueSkudmFsaWRhdGVRdWVzdGlvbm5haXJlcyh2YWxpZFF1ZXN0aW9ubmFpcmVzKSxcbiAgICAgICkubm90LnRvVGhyb3coKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdGhyb3cgZXJyb3IgZm9yIG5vbi1hcnJheSBpbnB1dCcsICgpID0+IHtcbiAgICAgIGV4cGVjdCgoKSA9PiAoc2VydmljZSBhcyBhbnkpLnZhbGlkYXRlUXVlc3Rpb25uYWlyZXMoJ2ludmFsaWQnKSkudG9UaHJvdyhcbiAgICAgICAgbmV3IEJhZFJlcXVlc3RFeGNlcHRpb24oJ1F1ZXN0aW9ubmFpcmVzIG11c3QgYmUgYW4gYXJyYXknKSxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IGVycm9yIGZvciBlbXB0eSBxdWVzdGlvbm5haXJlcyBhcnJheScsICgpID0+IHtcbiAgICAgIGV4cGVjdCgoKSA9PiAoc2VydmljZSBhcyBhbnkpLnZhbGlkYXRlUXVlc3Rpb25uYWlyZXMoW10pKS50b1Rocm93KFxuICAgICAgICBuZXcgQmFkUmVxdWVzdEV4Y2VwdGlvbignQXQgbGVhc3Qgb25lIHF1ZXN0aW9ubmFpcmUgaXMgcmVxdWlyZWQnKSxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IGVycm9yIGZvciBub24tc3RyaW5nIHF1ZXN0aW9ubmFpcmUgbmFtZXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBpbnZhbGlkUXVlc3Rpb25uYWlyZXMgPSBbJ1ZhbGlkJywgMTIzLCAnQW5vdGhlciddO1xuXG4gICAgICBleHBlY3QoKCkgPT5cbiAgICAgICAgKHNlcnZpY2UgYXMgYW55KS52YWxpZGF0ZVF1ZXN0aW9ubmFpcmVzKGludmFsaWRRdWVzdGlvbm5haXJlcyksXG4gICAgICApLnRvVGhyb3coXG4gICAgICAgIG5ldyBCYWRSZXF1ZXN0RXhjZXB0aW9uKFxuICAgICAgICAgICdBbGwgcXVlc3Rpb25uYWlyZSBuYW1lcyBtdXN0IGJlIG5vbi1lbXB0eSBzdHJpbmdzJyxcbiAgICAgICAgKSxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IGVycm9yIGZvciBlbXB0eSBzdHJpbmcgcXVlc3Rpb25uYWlyZSBuYW1lcycsICgpID0+IHtcbiAgICAgIGNvbnN0IGludmFsaWRRdWVzdGlvbm5haXJlcyA9IFsnVmFsaWQnLCAnJywgJ0Fub3RoZXInXTtcblxuICAgICAgZXhwZWN0KCgpID0+XG4gICAgICAgIChzZXJ2aWNlIGFzIGFueSkudmFsaWRhdGVRdWVzdGlvbm5haXJlcyhpbnZhbGlkUXVlc3Rpb25uYWlyZXMpLFxuICAgICAgKS50b1Rocm93KFxuICAgICAgICBuZXcgQmFkUmVxdWVzdEV4Y2VwdGlvbihcbiAgICAgICAgICAnQWxsIHF1ZXN0aW9ubmFpcmUgbmFtZXMgbXVzdCBiZSBub24tZW1wdHkgc3RyaW5ncycsXG4gICAgICAgICksXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQUkgU2VydmljZSBJbnRlZ3JhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzdWNjZXNzZnVsIEFJIHByZWRpY3Rpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBhaVNlcnZpY2VDbGllbnQucHJlZGljdC5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrQWlSZXNwb25zZSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IChzZXJ2aWNlIGFzIGFueSkuZ2V0QWlFc3RpbWF0ZShcbiAgICAgICAgbmV3IEFycmF5KDIwMSkuZmlsbCgxKSxcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja0FpUmVzcG9uc2UucHJlZGljdGlvbnMpO1xuICAgICAgZXhwZWN0KExvZ2dlci5wcm90b3R5cGUubG9nKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgJ0FJIHByZWRpY3Rpb24gY29tcGxldGVkIHN1Y2Nlc3NmdWxseSBpbiAxNTBtcycsXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgQUkgcHJlZGljdGlvbiBmYWlsdXJlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZmFpbHVyZVJlc3BvbnNlID0geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdNb2RlbCB1bmF2YWlsYWJsZScgfTtcbiAgICAgIGFpU2VydmljZUNsaWVudC5wcmVkaWN0Lm1vY2tSZXNvbHZlZFZhbHVlKGZhaWx1cmVSZXNwb25zZSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IChzZXJ2aWNlIGFzIGFueSkuZ2V0QWlFc3RpbWF0ZShcbiAgICAgICAgbmV3IEFycmF5KDIwMSkuZmlsbCgxKSxcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVOdWxsKCk7XG4gICAgICBleHBlY3QoTG9nZ2VyLnByb3RvdHlwZS53YXJuKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgJ0FJIHByZWRpY3Rpb24gZmFpbGVkOiBNb2RlbCB1bmF2YWlsYWJsZScsXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgQUkgc2VydmljZSBleGNlcHRpb25zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgYWlTZXJ2aWNlQ2xpZW50LnByZWRpY3QubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdOZXR3b3JrIGVycm9yJykpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCAoc2VydmljZSBhcyBhbnkpLmdldEFpRXN0aW1hdGUoXG4gICAgICAgIG5ldyBBcnJheSgyMDEpLmZpbGwoMSksXG4gICAgICApO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlTnVsbCgpO1xuICAgICAgZXhwZWN0KExvZ2dlci5wcm90b3R5cGUuZXJyb3IpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAnQUkgbW9kZWwgcHJlZGljdGlvbiBlcnJvcjonLFxuICAgICAgICAnTmV0d29yayBlcnJvcicsXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgQUkgc2VydmljZSB0aW1lb3V0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgYWlTZXJ2aWNlQ2xpZW50LnByZWRpY3QubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdUaW1lb3V0JykpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCAoc2VydmljZSBhcyBhbnkpLmdldEFpRXN0aW1hdGUoXG4gICAgICAgIG5ldyBBcnJheSgyMDEpLmZpbGwoMSksXG4gICAgICApO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlTnVsbCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRWRnZSBDYXNlcyBhbmQgUGVyZm9ybWFuY2UnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbGFyZ2UgcXVlc3Rpb25uYWlyZSBhcnJheXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBsYXJnZUFuc3dlcnMgPSBuZXcgQXJyYXkoNTApLmZpbGwoWzEsIDIsIDMsIDQsIDVdKTtcbiAgICAgIGNvbnN0IGxhcmdlUXVlc3Rpb25uYWlyZXMgPSBuZXcgQXJyYXkoNTApLmZpbGwoJ1N0cmVzcycpO1xuXG4gICAgICBwcmlzbWFTZXJ2aWNlLnVzZXIuZmluZFVuaXF1ZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXNlcik7XG4gICAgICBwcmlzbWFTZXJ2aWNlLmNsaWVudC5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tDbGllbnQpO1xuICAgICAgcHJpc21hU2VydmljZS5wcmVBc3Nlc3NtZW50LmZpbmRVbmlxdWUubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7XG4gICAgICBwcmlzbWFTZXJ2aWNlLnByZUFzc2Vzc21lbnQuY3JlYXRlLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tQcmVBc3Nlc3NtZW50KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5jcmVhdGVQcmVBc3Nlc3NtZW50KCd1c2VyLTEyMycsIHtcbiAgICAgICAgcXVlc3Rpb25uYWlyZXM6IGxhcmdlUXVlc3Rpb25uYWlyZXMsXG4gICAgICAgIGFuc3dlcnM6IGxhcmdlQW5zd2VycyxcbiAgICAgICAgYW5zd2VyTWF0cml4OiBsYXJnZUFuc3dlcnMsXG4gICAgICAgIHNjb3Jlczoge30sXG4gICAgICAgIHNldmVyaXR5TGV2ZWxzOiB7fSxcbiAgICAgICAgYWlFc3RpbWF0ZToge30sXG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbmN1cnJlbnQgY3JlYXRpb24gYXR0ZW1wdHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBwcmlzbWFTZXJ2aWNlLnVzZXIuZmluZFVuaXF1ZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXNlcik7XG4gICAgICBwcmlzbWFTZXJ2aWNlLmNsaWVudC5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tDbGllbnQpO1xuICAgICAgcHJpc21hU2VydmljZS5wcmVBc3Nlc3NtZW50LmZpbmRVbmlxdWUubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7XG4gICAgICBwcmlzbWFTZXJ2aWNlLnByZUFzc2Vzc21lbnQuY3JlYXRlLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tQcmVBc3Nlc3NtZW50KTtcblxuICAgICAgY29uc3QgdmFsaWREYXRhID0ge1xuICAgICAgICBxdWVzdGlvbm5haXJlczogWydBbnhpZXR5J10sXG4gICAgICAgIGFuc3dlcnM6IFtbMSwgMiwgM11dLFxuICAgICAgICBhbnN3ZXJNYXRyaXg6IFtbMSwgMiwgM11dLFxuICAgICAgICBzY29yZXM6IHt9LFxuICAgICAgICBzZXZlcml0eUxldmVsczoge30sXG4gICAgICAgIGFpRXN0aW1hdGU6IHt9LFxuICAgICAgfTtcblxuICAgICAgLy8gU2ltdWxhdGUgY29uY3VycmVudCByZXF1ZXN0c1xuICAgICAgY29uc3QgcHJvbWlzZXMgPSBbXG4gICAgICAgIHNlcnZpY2UuY3JlYXRlUHJlQXNzZXNzbWVudCgndXNlci0xMjMnLCB2YWxpZERhdGEpLFxuICAgICAgICBzZXJ2aWNlLmNyZWF0ZVByZUFzc2Vzc21lbnQoJ3VzZXItMTIzJywgdmFsaWREYXRhKSxcbiAgICAgIF07XG5cbiAgICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCBQcm9taXNlLmFsbChwcm9taXNlcyk7XG4gICAgICBleHBlY3QocmVzdWx0cykudG9IYXZlTGVuZ3RoKDIpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbnVsbCBhbmQgdW5kZWZpbmVkIGluIHNjb3JlcyB2YWxpZGF0aW9uJywgKCkgPT4ge1xuICAgICAgY29uc3QgaXNWYWxpZFNjb3JlcyA9IChzZXJ2aWNlIGFzIGFueSkuaXNWYWxpZFNjb3JlcztcblxuICAgICAgZXhwZWN0KGlzVmFsaWRTY29yZXMobnVsbCkpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KGlzVmFsaWRTY29yZXModW5kZWZpbmVkKSkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QoaXNWYWxpZFNjb3Jlcyh7fSkpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QoaXNWYWxpZFNjb3Jlcyh7IHRlc3Q6IDUgfSkpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QoaXNWYWxpZFNjb3Jlcyh7IHRlc3Q6ICdpbnZhbGlkJyB9KSkudG9CZShmYWxzZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBudWxsIGFuZCB1bmRlZmluZWQgaW4gc2V2ZXJpdHkgbGV2ZWxzIHZhbGlkYXRpb24nLCAoKSA9PiB7XG4gICAgICBjb25zdCBpc1ZhbGlkU2V2ZXJpdHlMZXZlbHMgPSAoc2VydmljZSBhcyBhbnkpLmlzVmFsaWRTZXZlcml0eUxldmVscztcblxuICAgICAgZXhwZWN0KGlzVmFsaWRTZXZlcml0eUxldmVscyhudWxsKSkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QoaXNWYWxpZFNldmVyaXR5TGV2ZWxzKHVuZGVmaW5lZCkpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KGlzVmFsaWRTZXZlcml0eUxldmVscyh7fSkpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QoaXNWYWxpZFNldmVyaXR5TGV2ZWxzKHsgdGVzdDogJ21pbGQnIH0pKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KGlzVmFsaWRTZXZlcml0eUxldmVscyh7IHRlc3Q6IDEyMyB9KSkudG9CZShmYWxzZSk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwidmVyc2lvbiI6M30=