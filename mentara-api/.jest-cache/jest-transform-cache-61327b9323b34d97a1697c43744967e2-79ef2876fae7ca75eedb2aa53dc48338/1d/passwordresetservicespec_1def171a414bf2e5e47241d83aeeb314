45a6b2c41b836fae7b50bab25008e073
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
jest.mock('crypto');
const testing_1 = require("@nestjs/testing");
const password_reset_service_1 = require("./password-reset.service");
const prisma_client_provider_1 = require("../../providers/prisma-client.provider");
const email_service_1 = require("../../services/email.service");
const token_service_1 = require("./token.service");
const common_1 = require("@nestjs/common");
const crypto = require("crypto");
describe('PasswordResetService', () => {
    let service;
    let prismaService;
    let emailService;
    let tokenService;
    const mockUser = {
        id: 'user-123',
        email: 'test@example.com',
        firstName: 'John',
        deactivatedAt: null,
        resetToken: null,
        resetTokenExpiry: null,
        password: 'current-hashed-password',
    };
    const mockUserWithToken = {
        id: 'user-123',
        email: 'test@example.com',
        firstName: 'John',
        deactivatedAt: null,
        resetToken: 'hashed-token',
        resetTokenExpiry: new Date(Date.now() + 60 * 60 * 1000), // 1 hour from now
        password: 'current-hashed-password',
    };
    const mockTokenData = {
        token: 'raw-token',
        hashedToken: 'hashed-token',
        expiresAt: new Date(Date.now() + 60 * 60 * 1000),
    };
    beforeEach(async () => {
        const module = await testing_1.Test.createTestingModule({
            providers: [
                password_reset_service_1.PasswordResetService,
                {
                    provide: prisma_client_provider_1.PrismaService,
                    useValue: {
                        user: {
                            findUnique: jest.fn(),
                            update: jest.fn(),
                            updateMany: jest.fn(),
                        },
                    },
                },
                {
                    provide: email_service_1.EmailService,
                    useValue: {
                        sendGenericEmail: jest.fn(),
                    },
                },
                {
                    provide: token_service_1.TokenService,
                    useValue: {
                        generatePasswordResetToken: jest.fn(),
                        comparePassword: jest.fn(),
                        hashPassword: jest.fn(),
                        revokeAllUserTokens: jest.fn(),
                    },
                },
            ],
        }).compile();
        service = module.get(password_reset_service_1.PasswordResetService);
        prismaService = module.get(prisma_client_provider_1.PrismaService);
        emailService = module.get(email_service_1.EmailService);
        tokenService = module.get(token_service_1.TokenService);
        // Setup crypto mock
        crypto.createHash.mockImplementation(() => ({
            update: jest.fn().mockReturnThis(),
            digest: jest.fn().mockReturnValue('hashed-token'),
        }));
        // Setup environment variables
        process.env.FRONTEND_URL = 'https://mentara.com';
        process.env.SUPPORT_EMAIL = 'support@mentara.com';
        process.env.MIN_PASSWORD_LENGTH = '8';
    });
    afterEach(() => {
        jest.clearAllMocks();
    });
    it('should be defined', () => {
        expect(service).toBeDefined();
    });
    describe('requestPasswordReset', () => {
        it('should send password reset email for valid user', async () => {
            prismaService.user.findUnique.mockResolvedValue(mockUser);
            tokenService.generatePasswordResetToken.mockResolvedValue(mockTokenData);
            prismaService.user.update.mockResolvedValue(mockUser);
            emailService.sendGenericEmail.mockResolvedValue(undefined);
            await service.requestPasswordReset('test@example.com');
            expect(prismaService.user.findUnique).toHaveBeenCalledWith({
                where: { email: 'test@example.com' },
                select: {
                    id: true,
                    email: true,
                    firstName: true,
                    deactivatedAt: true,
                    resetToken: true,
                    resetTokenExpiry: true,
                },
            });
            expect(tokenService.generatePasswordResetToken).toHaveBeenCalled();
            expect(prismaService.user.update).toHaveBeenCalledWith({
                where: { id: 'user-123' },
                data: {
                    resetToken: mockTokenData.hashedToken,
                    resetTokenExpiry: mockTokenData.expiresAt,
                },
            });
            expect(emailService.sendGenericEmail).toHaveBeenCalledWith({
                to: 'test@example.com',
                subject: 'Reset Your Mentara Password',
                template: 'password-reset',
                data: {
                    firstName: 'John',
                    resetUrl: `https://mentara.com/reset-password?token=${mockTokenData.token}`,
                    expiryTime: '1 hour',
                    supportEmail: 'support@mentara.com',
                },
            });
        });
        it('should silently return for non-existent user (security)', async () => {
            prismaService.user.findUnique.mockResolvedValue(null);
            await expect(service.requestPasswordReset('nonexistent@example.com')).resolves.not.toThrow();
            expect(tokenService.generatePasswordResetToken).not.toHaveBeenCalled();
            expect(emailService.sendGenericEmail).not.toHaveBeenCalled();
        });
        it('should throw BadRequestException for deactivated user', async () => {
            const deactivatedUser = {
                ...mockUser,
                deactivatedAt: new Date(),
            };
            prismaService.user.findUnique.mockResolvedValue(deactivatedUser);
            await expect(service.requestPasswordReset('test@example.com')).rejects.toThrow(common_1.BadRequestException);
        });
        it('should throw BadRequestException for recent token request', async () => {
            const userWithRecentToken = {
                ...mockUser,
                resetToken: 'existing-token',
                resetTokenExpiry: new Date(Date.now() + 55 * 60 * 1000), // 55 minutes from now
            };
            prismaService.user.findUnique.mockResolvedValue(userWithRecentToken);
            await expect(service.requestPasswordReset('test@example.com')).rejects.toThrow(common_1.BadRequestException);
        });
        it('should allow new token request for old token with less than 10 minutes remaining', async () => {
            const userWithOldToken = {
                ...mockUser,
                resetToken: 'existing-token',
                resetTokenExpiry: new Date(Date.now() + 5 * 60 * 1000), // 5 minutes from now
            };
            prismaService.user.findUnique.mockResolvedValue(userWithOldToken);
            tokenService.generatePasswordResetToken.mockResolvedValue(mockTokenData);
            prismaService.user.update.mockResolvedValue(mockUser);
            emailService.sendGenericEmail.mockResolvedValue(undefined);
            await service.requestPasswordReset('test@example.com');
            expect(tokenService.generatePasswordResetToken).toHaveBeenCalled();
        });
        it('should handle email service failure', async () => {
            prismaService.user.findUnique.mockResolvedValue(mockUser);
            tokenService.generatePasswordResetToken.mockResolvedValue(mockTokenData);
            prismaService.user.update.mockResolvedValue(mockUser);
            emailService.sendGenericEmail.mockRejectedValue(new Error('Email service error'));
            await expect(service.requestPasswordReset('test@example.com')).rejects.toThrow(common_1.BadRequestException);
        });
    });
    describe('resetPassword', () => {
        const validPassword = 'NewPassword123!';
        it('should reset password successfully', async () => {
            const token = 'valid-token';
            const hashedNewPassword = 'new-hashed-password';
            prismaService.user.findUnique.mockResolvedValue(mockUserWithToken);
            tokenService.comparePassword.mockResolvedValue(false); // New password is different
            tokenService.hashPassword.mockResolvedValue(hashedNewPassword);
            prismaService.user.update.mockResolvedValue(mockUser);
            tokenService.revokeAllUserTokens.mockResolvedValue(undefined);
            emailService.sendGenericEmail.mockResolvedValue(undefined);
            const result = await service.resetPassword(token, validPassword);
            expect(result).toEqual({
                success: true,
                message: 'Password reset successfully',
            });
            expect(prismaService.user.update).toHaveBeenCalledWith({
                where: { id: 'user-123' },
                data: {
                    password: hashedNewPassword,
                    resetToken: null,
                    resetTokenExpiry: null,
                    failedLoginCount: 0,
                    lockoutUntil: null,
                },
            });
            expect(tokenService.revokeAllUserTokens).toHaveBeenCalledWith('user-123');
        });
        it('should throw BadRequestException for missing token', async () => {
            await expect(service.resetPassword('', validPassword)).rejects.toThrow(common_1.BadRequestException);
        });
        it('should throw BadRequestException for missing password', async () => {
            await expect(service.resetPassword('token', '')).rejects.toThrow(common_1.BadRequestException);
        });
        it('should throw BadRequestException for weak password', async () => {
            const weakPassword = 'weak';
            await expect(service.resetPassword('token', weakPassword)).rejects.toThrow(common_1.BadRequestException);
        });
        it('should throw BadRequestException for invalid token', async () => {
            prismaService.user.findUnique.mockResolvedValue(null);
            await expect(service.resetPassword('invalid-token', validPassword)).rejects.toThrow(common_1.BadRequestException);
        });
        it('should throw BadRequestException for expired token', async () => {
            const userWithExpiredToken = {
                ...mockUserWithToken,
                resetTokenExpiry: new Date(Date.now() - 1000),
            };
            prismaService.user.findUnique.mockResolvedValue(userWithExpiredToken);
            prismaService.user.update.mockResolvedValue(mockUser);
            await expect(service.resetPassword('expired-token', validPassword)).rejects.toThrow(common_1.BadRequestException);
            expect(prismaService.user.update).toHaveBeenCalledWith({
                where: { id: 'user-123' },
                data: {
                    resetToken: null,
                    resetTokenExpiry: null,
                },
            });
        });
        it('should throw BadRequestException for deactivated user', async () => {
            const deactivatedUser = {
                ...mockUserWithToken,
                deactivatedAt: new Date(),
            };
            prismaService.user.findUnique.mockResolvedValue(deactivatedUser);
            await expect(service.resetPassword('token', validPassword)).rejects.toThrow(common_1.BadRequestException);
        });
        it('should throw BadRequestException for same password', async () => {
            const token = 'valid-token';
            prismaService.user.findUnique.mockResolvedValue(mockUserWithToken);
            tokenService.comparePassword.mockResolvedValue(true); // Same password
            await expect(service.resetPassword(token, validPassword)).rejects.toThrow(common_1.BadRequestException);
        });
        it('should allow password reset for user without existing password', async () => {
            const token = 'valid-token';
            const userWithoutPassword = {
                ...mockUserWithToken,
                password: null,
            };
            const hashedNewPassword = 'new-hashed-password';
            prismaService.user.findUnique.mockResolvedValue(userWithoutPassword);
            tokenService.hashPassword.mockResolvedValue(hashedNewPassword);
            prismaService.user.update.mockResolvedValue(mockUser);
            tokenService.revokeAllUserTokens.mockResolvedValue(undefined);
            emailService.sendGenericEmail.mockResolvedValue(undefined);
            const result = await service.resetPassword(token, validPassword);
            expect(result.success).toBe(true);
            expect(tokenService.comparePassword).not.toHaveBeenCalled();
        });
    });
    describe('validateResetToken', () => {
        it('should validate token successfully', async () => {
            const token = 'valid-token';
            const userWithValidToken = {
                email: 'test@example.com',
                resetTokenExpiry: new Date(Date.now() + 60 * 60 * 1000),
                deactivatedAt: null,
            };
            prismaService.user.findUnique.mockResolvedValue(userWithValidToken);
            const result = await service.validateResetToken(token);
            expect(result).toEqual({
                valid: true,
                email: 'test@example.com',
            });
        });
        it('should return invalid for missing token', async () => {
            const result = await service.validateResetToken('');
            expect(result).toEqual({ valid: false });
        });
        it('should return invalid for non-existent token', async () => {
            prismaService.user.findUnique.mockResolvedValue(null);
            const result = await service.validateResetToken('invalid-token');
            expect(result).toEqual({ valid: false });
        });
        it('should return invalid for deactivated user', async () => {
            const deactivatedUser = {
                email: 'test@example.com',
                resetTokenExpiry: new Date(Date.now() + 60 * 60 * 1000),
                deactivatedAt: new Date(),
            };
            prismaService.user.findUnique.mockResolvedValue(deactivatedUser);
            const result = await service.validateResetToken('token');
            expect(result).toEqual({ valid: false });
        });
        it('should return invalid for expired token', async () => {
            const userWithExpiredToken = {
                email: 'test@example.com',
                resetTokenExpiry: new Date(Date.now() - 1000),
                deactivatedAt: null,
            };
            prismaService.user.findUnique.mockResolvedValue(userWithExpiredToken);
            const result = await service.validateResetToken('expired-token');
            expect(result).toEqual({ valid: false });
        });
        it('should return invalid for token without expiry', async () => {
            const userWithoutExpiry = {
                email: 'test@example.com',
                resetTokenExpiry: null,
                deactivatedAt: null,
            };
            prismaService.user.findUnique.mockResolvedValue(userWithoutExpiry);
            const result = await service.validateResetToken('token');
            expect(result).toEqual({ valid: false });
        });
    });
    describe('validatePasswordStrength', () => {
        it('should validate strong password', () => {
            const strongPassword = 'StrongPassword123!';
            expect(() => service.validatePasswordStrength(strongPassword)).not.toThrow();
        });
        it('should throw for too short password', () => {
            const shortPassword = 'Ab1!';
            expect(() => service.validatePasswordStrength(shortPassword)).toThrow(common_1.BadRequestException);
        });
        it('should throw for password without uppercase', () => {
            const noUpperPassword = 'password123!';
            expect(() => service.validatePasswordStrength(noUpperPassword)).toThrow(common_1.BadRequestException);
        });
        it('should throw for password without lowercase', () => {
            const noLowerPassword = 'PASSWORD123!';
            expect(() => service.validatePasswordStrength(noLowerPassword)).toThrow(common_1.BadRequestException);
        });
        it('should throw for password without number', () => {
            const noNumberPassword = 'Password!';
            expect(() => service.validatePasswordStrength(noNumberPassword)).toThrow(common_1.BadRequestException);
        });
        it('should throw for password without special character', () => {
            const noSpecialPassword = 'Password123';
            expect(() => service.validatePasswordStrength(noSpecialPassword)).toThrow(common_1.BadRequestException);
        });
        it('should throw for common password', () => {
            const commonPassword = 'password123';
            expect(() => service.validatePasswordStrength(commonPassword)).toThrow(common_1.BadRequestException);
        });
        it('should use default min length when env variable not set', () => {
            delete process.env.MIN_PASSWORD_LENGTH;
            const shortPassword = 'Ab1!567'; // 7 characters
            expect(() => service.validatePasswordStrength(shortPassword)).toThrow(common_1.BadRequestException);
        });
        it('should accept various special characters', () => {
            const specialChars = '!@#$%^&*()_+-=[]{};\':"|,.<>/?';
            for (const char of specialChars) {
                const password = `Password123${char}`;
                expect(() => service.validatePasswordStrength(password)).not.toThrow();
            }
        });
    });
    describe('cleanupExpiredTokens', () => {
        it('should clean up expired reset tokens', async () => {
            prismaService.user.updateMany.mockResolvedValue({ count: 3 });
            await service.cleanupExpiredTokens();
            expect(prismaService.user.updateMany).toHaveBeenCalledWith({
                where: {
                    resetTokenExpiry: {
                        lt: expect.any(Date),
                    },
                },
                data: {
                    resetToken: null,
                    resetTokenExpiry: null,
                },
            });
        });
    });
    describe('sendPasswordResetEmail (private method)', () => {
        it('should send password reset email with correct template data', async () => {
            const email = 'test@example.com';
            const firstName = 'John';
            const token = 'reset-token';
            emailService.sendGenericEmail.mockResolvedValue(undefined);
            await service.sendPasswordResetEmail(email, firstName, token);
            expect(emailService.sendGenericEmail).toHaveBeenCalledWith({
                to: email,
                subject: 'Reset Your Mentara Password',
                template: 'password-reset',
                data: {
                    firstName,
                    resetUrl: `https://mentara.com/reset-password?token=${token}`,
                    expiryTime: '1 hour',
                    supportEmail: 'support@mentara.com',
                },
            });
        });
        it('should use default support email when env variable not set', async () => {
            delete process.env.SUPPORT_EMAIL;
            const email = 'test@example.com';
            const firstName = 'John';
            const token = 'reset-token';
            emailService.sendGenericEmail.mockResolvedValue(undefined);
            await service.sendPasswordResetEmail(email, firstName, token);
            expect(emailService.sendGenericEmail).toHaveBeenCalledWith({
                to: email,
                subject: 'Reset Your Mentara Password',
                template: 'password-reset',
                data: {
                    firstName,
                    resetUrl: `https://mentara.com/reset-password?token=${token}`,
                    expiryTime: '1 hour',
                    supportEmail: 'support@mentara.com',
                },
            });
        });
        it('should handle email service failure', async () => {
            const email = 'test@example.com';
            const firstName = 'John';
            const token = 'reset-token';
            emailService.sendGenericEmail.mockRejectedValue(new Error('Email service error'));
            await expect(service.sendPasswordResetEmail(email, firstName, token)).rejects.toThrow(common_1.BadRequestException);
        });
    });
    describe('sendPasswordResetConfirmationEmail (private method)', () => {
        it('should send confirmation email after successful reset', async () => {
            const email = 'test@example.com';
            emailService.sendGenericEmail.mockResolvedValue(undefined);
            await service.sendPasswordResetConfirmationEmail(email);
            expect(emailService.sendGenericEmail).toHaveBeenCalledWith({
                to: email,
                subject: 'Password Reset Successful',
                template: 'password-reset-confirmation',
                data: {
                    supportEmail: 'support@mentara.com',
                    loginUrl: 'https://mentara.com/login',
                },
            });
        });
        it('should not throw error if confirmation email fails', async () => {
            const email = 'test@example.com';
            emailService.sendGenericEmail.mockRejectedValue(new Error('Email service error'));
            await expect(service.sendPasswordResetConfirmationEmail(email)).resolves.not.toThrow();
        });
    });
    describe('crypto hash integration', () => {
        it('should use crypto.createHash for token hashing', async () => {
            const token = 'test-token';
            const mockHash = {
                update: jest.fn().mockReturnThis(),
                digest: jest.fn().mockReturnValue('hashed-token'),
            };
            crypto.createHash.mockReturnValue(mockHash);
            await service.validateResetToken(token);
            expect(crypto.createHash).toHaveBeenCalledWith('sha256');
            expect(mockHash.update).toHaveBeenCalledWith(token);
            expect(mockHash.digest).toHaveBeenCalledWith('hex');
        });
    });
    describe('environment variable handling', () => {
        it('should handle missing FRONTEND_URL in reset email', async () => {
            delete process.env.FRONTEND_URL;
            const email = 'test@example.com';
            const firstName = 'John';
            const token = 'reset-token';
            emailService.sendGenericEmail.mockResolvedValue(undefined);
            await service.sendPasswordResetEmail(email, firstName, token);
            expect(emailService.sendGenericEmail).toHaveBeenCalledWith({
                to: email,
                subject: 'Reset Your Mentara Password',
                template: 'password-reset',
                data: {
                    firstName,
                    resetUrl: `undefined/reset-password?token=${token}`,
                    expiryTime: '1 hour',
                    supportEmail: 'support@mentara.com',
                },
            });
        });
        it('should handle missing FRONTEND_URL in confirmation email', async () => {
            delete process.env.FRONTEND_URL;
            const email = 'test@example.com';
            emailService.sendGenericEmail.mockResolvedValue(undefined);
            await service.sendPasswordResetConfirmationEmail(email);
            expect(emailService.sendGenericEmail).toHaveBeenCalledWith({
                to: email,
                subject: 'Password Reset Successful',
                template: 'password-reset-confirmation',
                data: {
                    supportEmail: 'support@mentara.com',
                    loginUrl: 'undefined/login',
                },
            });
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvd2V0b29hL0RvY3VtZW50cy9jb2RlL3Byb2plY3RzL21lbnRhcmEvbWVudGFyYS1hcGkvc3JjL2F1dGgvc2VydmljZXMvcGFzc3dvcmQtcmVzZXQuc2VydmljZS5zcGVjLnRzIiwibWFwcGluZ3MiOiI7O0FBV0EsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztBQVhwQiw2Q0FBc0Q7QUFDdEQscUVBQWdFO0FBQ2hFLG1GQUF1RTtBQUN2RSxnRUFBNEQ7QUFDNUQsbURBQStDO0FBQy9DLDJDQUd3QjtBQUN4QixpQ0FBaUM7QUFJakMsUUFBUSxDQUFDLHNCQUFzQixFQUFFLEdBQUcsRUFBRTtJQUNwQyxJQUFJLE9BQTZCLENBQUM7SUFDbEMsSUFBSSxhQUF5QyxDQUFDO0lBQzlDLElBQUksWUFBdUMsQ0FBQztJQUM1QyxJQUFJLFlBQXVDLENBQUM7SUFFNUMsTUFBTSxRQUFRLEdBQUc7UUFDZixFQUFFLEVBQUUsVUFBVTtRQUNkLEtBQUssRUFBRSxrQkFBa0I7UUFDekIsU0FBUyxFQUFFLE1BQU07UUFDakIsYUFBYSxFQUFFLElBQUk7UUFDbkIsVUFBVSxFQUFFLElBQUk7UUFDaEIsZ0JBQWdCLEVBQUUsSUFBSTtRQUN0QixRQUFRLEVBQUUseUJBQXlCO0tBQ3BDLENBQUM7SUFFRixNQUFNLGlCQUFpQixHQUFHO1FBQ3hCLEVBQUUsRUFBRSxVQUFVO1FBQ2QsS0FBSyxFQUFFLGtCQUFrQjtRQUN6QixTQUFTLEVBQUUsTUFBTTtRQUNqQixhQUFhLEVBQUUsSUFBSTtRQUNuQixVQUFVLEVBQUUsY0FBYztRQUMxQixnQkFBZ0IsRUFBRSxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxJQUFJLENBQUMsRUFBRSxrQkFBa0I7UUFDM0UsUUFBUSxFQUFFLHlCQUF5QjtLQUNwQyxDQUFDO0lBRUYsTUFBTSxhQUFhLEdBQUc7UUFDcEIsS0FBSyxFQUFFLFdBQVc7UUFDbEIsV0FBVyxFQUFFLGNBQWM7UUFDM0Is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QUksRUFBRTtvQkFDSixZQUFZLEVBQUUscUJBQXFCO29CQUNuQyxRQUFRLEVBQUUsaUJBQWlCO2lCQUM1QjthQUNGLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS93ZXRvb2EvRG9jdW1lbnRzL2NvZGUvcHJvamVjdHMvbWVudGFyYS9tZW50YXJhLWFwaS9zcmMvYXV0aC9zZXJ2aWNlcy9wYXNzd29yZC1yZXNldC5zZXJ2aWNlLnNwZWMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVGVzdCwgVGVzdGluZ01vZHVsZSB9IGZyb20gJ0BuZXN0anMvdGVzdGluZyc7XG5pbXBvcnQgeyBQYXNzd29yZFJlc2V0U2VydmljZSB9IGZyb20gJy4vcGFzc3dvcmQtcmVzZXQuc2VydmljZSc7XG5pbXBvcnQgeyBQcmlzbWFTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vcHJvdmlkZXJzL3ByaXNtYS1jbGllbnQucHJvdmlkZXInO1xuaW1wb3J0IHsgRW1haWxTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvZW1haWwuc2VydmljZSc7XG5pbXBvcnQgeyBUb2tlblNlcnZpY2UgfSBmcm9tICcuL3Rva2VuLnNlcnZpY2UnO1xuaW1wb3J0IHtcbiAgQmFkUmVxdWVzdEV4Y2VwdGlvbixcbiAgTm90Rm91bmRFeGNlcHRpb24sXG59IGZyb20gJ0BuZXN0anMvY29tbW9uJztcbmltcG9ydCAqIGFzIGNyeXB0byBmcm9tICdjcnlwdG8nO1xuXG5qZXN0Lm1vY2soJ2NyeXB0bycpO1xuXG5kZXNjcmliZSgnUGFzc3dvcmRSZXNldFNlcnZpY2UnLCAoKSA9PiB7XG4gIGxldCBzZXJ2aWNlOiBQYXNzd29yZFJlc2V0U2VydmljZTtcbiAgbGV0IHByaXNtYVNlcnZpY2U6IGplc3QuTW9ja2VkPFByaXNtYVNlcnZpY2U+O1xuICBsZXQgZW1haWxTZXJ2aWNlOiBqZXN0Lk1vY2tlZDxFbWFpbFNlcnZpY2U+O1xuICBsZXQgdG9rZW5TZXJ2aWNlOiBqZXN0Lk1vY2tlZDxUb2tlblNlcnZpY2U+O1xuXG4gIGNvbnN0IG1vY2tVc2VyID0ge1xuICAgIGlkOiAndXNlci0xMjMnLFxuICAgIGVtYWlsOiAndGVzdEBleGFtcGxlLmNvbScsXG4gICAgZmlyc3ROYW1lOiAnSm9obicsXG4gICAgZGVhY3RpdmF0ZWRBdDogbnVsbCxcbiAgICByZXNldFRva2VuOiBudWxsLFxuICAgIHJlc2V0VG9rZW5FeHBpcnk6IG51bGwsXG4gICAgcGFzc3dvcmQ6ICdjdXJyZW50LWhhc2hlZC1wYXNzd29yZCcsXG4gIH07XG5cbiAgY29uc3QgbW9ja1VzZXJXaXRoVG9rZW4gPSB7XG4gICAgaWQ6ICd1c2VyLTEyMycsXG4gICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcbiAgICBmaXJzdE5hbWU6ICdKb2huJyxcbiAgICBkZWFjdGl2YXRlZEF0OiBudWxsLFxuICAgIHJlc2V0VG9rZW46ICdoYXNoZWQtdG9rZW4nLFxuICAgIHJlc2V0VG9rZW5FeHBpcnk6IG5ldyBEYXRlKERhdGUubm93KCkgKyA2MCAqIDYwICogMTAwMCksIC8vIDEgaG91ciBmcm9tIG5vd1xuICAgIHBhc3N3b3JkOiAnY3VycmVudC1oYXNoZWQtcGFzc3dvcmQnLFxuICB9O1xuXG4gIGNvbnN0IG1vY2tUb2tlbkRhdGEgPSB7XG4gICAgdG9rZW46ICdyYXctdG9rZW4nLFxuICAgIGhhc2hlZFRva2VuOiAnaGFzaGVkLXRva2VuJyxcbiAgICBleHBpcmVzQXQ6IG5ldyBEYXRlKERhdGUubm93KCkgKyA2MCAqIDYwICogMTAwMCksXG4gIH07XG5cbiAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgbW9kdWxlOiBUZXN0aW5nTW9kdWxlID0gYXdhaXQgVGVzdC5jcmVhdGVUZXN0aW5nTW9kdWxlKHtcbiAgICAgIHByb3ZpZGVyczogW1xuICAgICAgICBQYXNzd29yZFJlc2V0U2VydmljZSxcbiAgICAgICAge1xuICAgICAgICAgIHByb3ZpZGU6IFByaXNtYVNlcnZpY2UsXG4gICAgICAgICAgdXNlVmFsdWU6IHtcbiAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgZmluZFVuaXF1ZTogamVzdC5mbigpLFxuICAgICAgICAgICAgICB1cGRhdGU6IGplc3QuZm4oKSxcbiAgICAgICAgICAgICAgdXBkYXRlTWFueTogamVzdC5mbigpLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgcHJvdmlkZTogRW1haWxTZXJ2aWNlLFxuICAgICAgICAgIHVzZVZhbHVlOiB7XG4gICAgICAgICAgICBzZW5kR2VuZXJpY0VtYWlsOiBqZXN0LmZuKCksXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHByb3ZpZGU6IFRva2VuU2VydmljZSxcbiAgICAgICAgICB1c2VWYWx1ZToge1xuICAgICAgICAgICAgZ2VuZXJhdGVQYXNzd29yZFJlc2V0VG9rZW46IGplc3QuZm4oKSxcbiAgICAgICAgICAgIGNvbXBhcmVQYXNzd29yZDogamVzdC5mbigpLFxuICAgICAgICAgICAgaGFzaFBhc3N3b3JkOiBqZXN0LmZuKCksXG4gICAgICAgICAgICByZXZva2VBbGxVc2VyVG9rZW5zOiBqZXN0LmZuKCksXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSkuY29tcGlsZSgpO1xuXG4gICAgc2VydmljZSA9IG1vZHVsZS5nZXQ8UGFzc3dvcmRSZXNldFNlcnZpY2U+KFBhc3N3b3JkUmVzZXRTZXJ2aWNlKTtcbiAgICBwcmlzbWFTZXJ2aWNlID0gbW9kdWxlLmdldChQcmlzbWFTZXJ2aWNlKTtcbiAgICBlbWFpbFNlcnZpY2UgPSBtb2R1bGUuZ2V0KEVtYWlsU2VydmljZSk7XG4gICAgdG9rZW5TZXJ2aWNlID0gbW9kdWxlLmdldChUb2tlblNlcnZpY2UpO1xuXG4gICAgLy8gU2V0dXAgY3J5cHRvIG1vY2tcbiAgICAoY3J5cHRvLmNyZWF0ZUhhc2ggYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4gKHtcbiAgICAgIHVwZGF0ZTogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXG4gICAgICBkaWdlc3Q6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoJ2hhc2hlZC10b2tlbicpLFxuICAgIH0pKTtcblxuICAgIC8vIFNldHVwIGVudmlyb25tZW50IHZhcmlhYmxlc1xuICAgIHByb2Nlc3MuZW52LkZST05URU5EX1VSTCA9ICdodHRwczovL21lbnRhcmEuY29tJztcbiAgICBwcm9jZXNzLmVudi5TVVBQT1JUX0VNQUlMID0gJ3N1cHBvcnRAbWVudGFyYS5jb20nO1xuICAgIHByb2Nlc3MuZW52Lk1JTl9QQVNTV09SRF9MRU5HVEggPSAnOCc7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgYmUgZGVmaW5lZCcsICgpID0+IHtcbiAgICBleHBlY3Qoc2VydmljZSkudG9CZURlZmluZWQoKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3JlcXVlc3RQYXNzd29yZFJlc2V0JywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgc2VuZCBwYXNzd29yZCByZXNldCBlbWFpbCBmb3IgdmFsaWQgdXNlcicsIGFzeW5jICgpID0+IHtcbiAgICAgIHByaXNtYVNlcnZpY2UudXNlci5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVc2VyKTtcbiAgICAgIHRva2VuU2VydmljZS5nZW5lcmF0ZVBhc3N3b3JkUmVzZXRUb2tlbi5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVG9rZW5EYXRhKTtcbiAgICAgIHByaXNtYVNlcnZpY2UudXNlci51cGRhdGUubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXIpO1xuICAgICAgZW1haWxTZXJ2aWNlLnNlbmRHZW5lcmljRW1haWwubW9ja1Jlc29sdmVkVmFsdWUodW5kZWZpbmVkKTtcblxuICAgICAgYXdhaXQgc2VydmljZS5yZXF1ZXN0UGFzc3dvcmRSZXNldCgndGVzdEBleGFtcGxlLmNvbScpO1xuXG4gICAgICBleHBlY3QocHJpc21hU2VydmljZS51c2VyLmZpbmRVbmlxdWUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgd2hlcmU6IHsgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyB9LFxuICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICBlbWFpbDogdHJ1ZSxcbiAgICAgICAgICBmaXJzdE5hbWU6IHRydWUsXG4gICAgICAgICAgZGVhY3RpdmF0ZWRBdDogdHJ1ZSxcbiAgICAgICAgICByZXNldFRva2VuOiB0cnVlLFxuICAgICAgICAgIHJlc2V0VG9rZW5FeHBpcnk6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KHRva2VuU2VydmljZS5nZW5lcmF0ZVBhc3N3b3JkUmVzZXRUb2tlbikudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgZXhwZWN0KHByaXNtYVNlcnZpY2UudXNlci51cGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6ICd1c2VyLTEyMycgfSxcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHJlc2V0VG9rZW46IG1vY2tUb2tlbkRhdGEuaGFzaGVkVG9rZW4sXG4gICAgICAgICAgcmVzZXRUb2tlbkV4cGlyeTogbW9ja1Rva2VuRGF0YS5leHBpcmVzQXQsXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KGVtYWlsU2VydmljZS5zZW5kR2VuZXJpY0VtYWlsKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIHRvOiAndGVzdEBleGFtcGxlLmNvbScsXG4gICAgICAgIHN1YmplY3Q6ICdSZXNldCBZb3VyIE1lbnRhcmEgUGFzc3dvcmQnLFxuICAgICAgICB0ZW1wbGF0ZTogJ3Bhc3N3b3JkLXJlc2V0JyxcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIGZpcnN0TmFtZTogJ0pvaG4nLFxuICAgICAgICAgIHJlc2V0VXJsOiBgaHR0cHM6Ly9tZW50YXJhLmNvbS9yZXNldC1wYXNzd29yZD90b2tlbj0ke21vY2tUb2tlbkRhdGEudG9rZW59YCxcbiAgICAgICAgICBleHBpcnlUaW1lOiAnMSBob3VyJyxcbiAgICAgICAgICBzdXBwb3J0RW1haWw6ICdzdXBwb3J0QG1lbnRhcmEuY29tJyxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzaWxlbnRseSByZXR1cm4gZm9yIG5vbi1leGlzdGVudCB1c2VyIChzZWN1cml0eSknLCBhc3luYyAoKSA9PiB7XG4gICAgICBwcmlzbWFTZXJ2aWNlLnVzZXIuZmluZFVuaXF1ZS5tb2NrUmVzb2x2ZWRWYWx1ZShudWxsKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KHNlcnZpY2UucmVxdWVzdFBhc3N3b3JkUmVzZXQoJ25vbmV4aXN0ZW50QGV4YW1wbGUuY29tJykpLnJlc29sdmVzLm5vdC50b1Rocm93KCk7XG4gICAgICBleHBlY3QodG9rZW5TZXJ2aWNlLmdlbmVyYXRlUGFzc3dvcmRSZXNldFRva2VuKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgZXhwZWN0KGVtYWlsU2VydmljZS5zZW5kR2VuZXJpY0VtYWlsKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0aHJvdyBCYWRSZXF1ZXN0RXhjZXB0aW9uIGZvciBkZWFjdGl2YXRlZCB1c2VyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZGVhY3RpdmF0ZWRVc2VyID0ge1xuICAgICAgICAuLi5tb2NrVXNlcixcbiAgICAgICAgZGVhY3RpdmF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgIH07XG5cbiAgICAgIHByaXNtYVNlcnZpY2UudXNlci5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKGRlYWN0aXZhdGVkVXNlcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChzZXJ2aWNlLnJlcXVlc3RQYXNzd29yZFJlc2V0KCd0ZXN0QGV4YW1wbGUuY29tJykpLnJlamVjdHMudG9UaHJvdyhcbiAgICAgICAgQmFkUmVxdWVzdEV4Y2VwdGlvbixcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IEJhZFJlcXVlc3RFeGNlcHRpb24gZm9yIHJlY2VudCB0b2tlbiByZXF1ZXN0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdXNlcldpdGhSZWNlbnRUb2tlbiA9IHtcbiAgICAgICAgLi4ubW9ja1VzZXIsXG4gICAgICAgIHJlc2V0VG9rZW46ICdleGlzdGluZy10b2tlbicsXG4gICAgICAgIHJlc2V0VG9rZW5FeHBpcnk6IG5ldyBEYXRlKERhdGUubm93KCkgKyA1NSAqIDYwICogMTAwMCksIC8vIDU1IG1pbnV0ZXMgZnJvbSBub3dcbiAgICAgIH07XG5cbiAgICAgIHByaXNtYVNlcnZpY2UudXNlci5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKHVzZXJXaXRoUmVjZW50VG9rZW4pO1xuXG4gICAgICBhd2FpdCBleHBlY3Qoc2VydmljZS5yZXF1ZXN0UGFzc3dvcmRSZXNldCgndGVzdEBleGFtcGxlLmNvbScpKS5yZWplY3RzLnRvVGhyb3coXG4gICAgICAgIEJhZFJlcXVlc3RFeGNlcHRpb24sXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhbGxvdyBuZXcgdG9rZW4gcmVxdWVzdCBmb3Igb2xkIHRva2VuIHdpdGggbGVzcyB0aGFuIDEwIG1pbnV0ZXMgcmVtYWluaW5nJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdXNlcldpdGhPbGRUb2tlbiA9IHtcbiAgICAgICAgLi4ubW9ja1VzZXIsXG4gICAgICAgIHJlc2V0VG9rZW46ICdleGlzdGluZy10b2tlbicsXG4gICAgICAgIHJlc2V0VG9rZW5FeHBpcnk6IG5ldyBEYXRlKERhdGUubm93KCkgKyA1ICogNjAgKiAxMDAwKSwgLy8gNSBtaW51dGVzIGZyb20gbm93XG4gICAgICB9O1xuXG4gICAgICBwcmlzbWFTZXJ2aWNlLnVzZXIuZmluZFVuaXF1ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh1c2VyV2l0aE9sZFRva2VuKTtcbiAgICAgIHRva2VuU2VydmljZS5nZW5lcmF0ZVBhc3N3b3JkUmVzZXRUb2tlbi5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVG9rZW5EYXRhKTtcbiAgICAgIHByaXNtYVNlcnZpY2UudXNlci51cGRhdGUubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXIpO1xuICAgICAgZW1haWxTZXJ2aWNlLnNlbmRHZW5lcmljRW1haWwubW9ja1Jlc29sdmVkVmFsdWUodW5kZWZpbmVkKTtcblxuICAgICAgYXdhaXQgc2VydmljZS5yZXF1ZXN0UGFzc3dvcmRSZXNldCgndGVzdEBleGFtcGxlLmNvbScpO1xuXG4gICAgICBleHBlY3QodG9rZW5TZXJ2aWNlLmdlbmVyYXRlUGFzc3dvcmRSZXNldFRva2VuKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBlbWFpbCBzZXJ2aWNlIGZhaWx1cmUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBwcmlzbWFTZXJ2aWNlLnVzZXIuZmluZFVuaXF1ZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXNlcik7XG4gICAgICB0b2tlblNlcnZpY2UuZ2VuZXJhdGVQYXNzd29yZFJlc2V0VG9rZW4ubW9ja1Jlc29sdmVkVmFsdWUobW9ja1Rva2VuRGF0YSk7XG4gICAgICBwcmlzbWFTZXJ2aWNlLnVzZXIudXBkYXRlLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVc2VyKTtcbiAgICAgIGVtYWlsU2VydmljZS5zZW5kR2VuZXJpY0VtYWlsLm1vY2tSZWplY3RlZFZhbHVlKG5ldyBFcnJvcignRW1haWwgc2VydmljZSBlcnJvcicpKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KHNlcnZpY2UucmVxdWVzdFBhc3N3b3JkUmVzZXQoJ3Rlc3RAZXhhbXBsZS5jb20nKSkucmVqZWN0cy50b1Rocm93KFxuICAgICAgICBCYWRSZXF1ZXN0RXhjZXB0aW9uLFxuICAgICAgKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3Jlc2V0UGFzc3dvcmQnLCAoKSA9PiB7XG4gICAgY29uc3QgdmFsaWRQYXNzd29yZCA9ICdOZXdQYXNzd29yZDEyMyEnO1xuXG4gICAgaXQoJ3Nob3VsZCByZXNldCBwYXNzd29yZCBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB0b2tlbiA9ICd2YWxpZC10b2tlbic7XG4gICAgICBjb25zdCBoYXNoZWROZXdQYXNzd29yZCA9ICduZXctaGFzaGVkLXBhc3N3b3JkJztcblxuICAgICAgcHJpc21hU2VydmljZS51c2VyLmZpbmRVbmlxdWUubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXJXaXRoVG9rZW4pO1xuICAgICAgdG9rZW5TZXJ2aWNlLmNvbXBhcmVQYXNzd29yZC5tb2NrUmVzb2x2ZWRWYWx1ZShmYWxzZSk7IC8vIE5ldyBwYXNzd29yZCBpcyBkaWZmZXJlbnRcbiAgICAgIHRva2VuU2VydmljZS5oYXNoUGFzc3dvcmQubW9ja1Jlc29sdmVkVmFsdWUoaGFzaGVkTmV3UGFzc3dvcmQpO1xuICAgICAgcHJpc21hU2VydmljZS51c2VyLnVwZGF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXNlcik7XG4gICAgICB0b2tlblNlcnZpY2UucmV2b2tlQWxsVXNlclRva2Vucy5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpO1xuICAgICAgZW1haWxTZXJ2aWNlLnNlbmRHZW5lcmljRW1haWwubW9ja1Jlc29sdmVkVmFsdWUodW5kZWZpbmVkKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5yZXNldFBhc3N3b3JkKHRva2VuLCB2YWxpZFBhc3N3b3JkKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIG1lc3NhZ2U6ICdQYXNzd29yZCByZXNldCBzdWNjZXNzZnVsbHknLFxuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChwcmlzbWFTZXJ2aWNlLnVzZXIudXBkYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIHdoZXJlOiB7IGlkOiAndXNlci0xMjMnIH0sXG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBwYXNzd29yZDogaGFzaGVkTmV3UGFzc3dvcmQsXG4gICAgICAgICAgcmVzZXRUb2tlbjogbnVsbCxcbiAgICAgICAgICByZXNldFRva2VuRXhwaXJ5OiBudWxsLFxuICAgICAgICAgIGZhaWxlZExvZ2luQ291bnQ6IDAsXG4gICAgICAgICAgbG9ja291dFVudGlsOiBudWxsLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdCh0b2tlblNlcnZpY2UucmV2b2tlQWxsVXNlclRva2VucykudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ3VzZXItMTIzJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IEJhZFJlcXVlc3RFeGNlcHRpb24gZm9yIG1pc3NpbmcgdG9rZW4nLCBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBleHBlY3Qoc2VydmljZS5yZXNldFBhc3N3b3JkKCcnLCB2YWxpZFBhc3N3b3JkKSkucmVqZWN0cy50b1Rocm93KFxuICAgICAgICBCYWRSZXF1ZXN0RXhjZXB0aW9uLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdGhyb3cgQmFkUmVxdWVzdEV4Y2VwdGlvbiBmb3IgbWlzc2luZyBwYXNzd29yZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IGV4cGVjdChzZXJ2aWNlLnJlc2V0UGFzc3dvcmQoJ3Rva2VuJywgJycpKS5yZWplY3RzLnRvVGhyb3coXG4gICAgICAgIEJhZFJlcXVlc3RFeGNlcHRpb24sXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0aHJvdyBCYWRSZXF1ZXN0RXhjZXB0aW9uIGZvciB3ZWFrIHBhc3N3b3JkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgd2Vha1Bhc3N3b3JkID0gJ3dlYWsnO1xuXG4gICAgICBhd2FpdCBleHBlY3Qoc2VydmljZS5yZXNldFBhc3N3b3JkKCd0b2tlbicsIHdlYWtQYXNzd29yZCkpLnJlamVjdHMudG9UaHJvdyhcbiAgICAgICAgQmFkUmVxdWVzdEV4Y2VwdGlvbixcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IEJhZFJlcXVlc3RFeGNlcHRpb24gZm9yIGludmFsaWQgdG9rZW4nLCBhc3luYyAoKSA9PiB7XG4gICAgICBwcmlzbWFTZXJ2aWNlLnVzZXIuZmluZFVuaXF1ZS5tb2NrUmVzb2x2ZWRWYWx1ZShudWxsKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KHNlcnZpY2UucmVzZXRQYXNzd29yZCgnaW52YWxpZC10b2tlbicsIHZhbGlkUGFzc3dvcmQpKS5yZWplY3RzLnRvVGhyb3coXG4gICAgICAgIEJhZFJlcXVlc3RFeGNlcHRpb24sXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0aHJvdyBCYWRSZXF1ZXN0RXhjZXB0aW9uIGZvciBleHBpcmVkIHRva2VuJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdXNlcldpdGhFeHBpcmVkVG9rZW4gPSB7XG4gICAgICAgIC4uLm1vY2tVc2VyV2l0aFRva2VuLFxuICAgICAgICByZXNldFRva2VuRXhwaXJ5OiBuZXcgRGF0ZShEYXRlLm5vdygpIC0gMTAwMCksXG4gICAgICB9O1xuXG4gICAgICBwcmlzbWFTZXJ2aWNlLnVzZXIuZmluZFVuaXF1ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh1c2VyV2l0aEV4cGlyZWRUb2tlbik7XG4gICAgICBwcmlzbWFTZXJ2aWNlLnVzZXIudXBkYXRlLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVc2VyKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KHNlcnZpY2UucmVzZXRQYXNzd29yZCgnZXhwaXJlZC10b2tlbicsIHZhbGlkUGFzc3dvcmQpKS5yZWplY3RzLnRvVGhyb3coXG4gICAgICAgIEJhZFJlcXVlc3RFeGNlcHRpb24sXG4gICAgICApO1xuXG4gICAgICBleHBlY3QocHJpc21hU2VydmljZS51c2VyLnVwZGF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICB3aGVyZTogeyBpZDogJ3VzZXItMTIzJyB9LFxuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgcmVzZXRUb2tlbjogbnVsbCxcbiAgICAgICAgICByZXNldFRva2VuRXhwaXJ5OiBudWxsLFxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IEJhZFJlcXVlc3RFeGNlcHRpb24gZm9yIGRlYWN0aXZhdGVkIHVzZXInLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBkZWFjdGl2YXRlZFVzZXIgPSB7XG4gICAgICAgIC4uLm1vY2tVc2VyV2l0aFRva2VuLFxuICAgICAgICBkZWFjdGl2YXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgfTtcblxuICAgICAgcHJpc21hU2VydmljZS51c2VyLmZpbmRVbmlxdWUubW9ja1Jlc29sdmVkVmFsdWUoZGVhY3RpdmF0ZWRVc2VyKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KHNlcnZpY2UucmVzZXRQYXNzd29yZCgndG9rZW4nLCB2YWxpZFBhc3N3b3JkKSkucmVqZWN0cy50b1Rocm93KFxuICAgICAgICBCYWRSZXF1ZXN0RXhjZXB0aW9uLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdGhyb3cgQmFkUmVxdWVzdEV4Y2VwdGlvbiBmb3Igc2FtZSBwYXNzd29yZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRva2VuID0gJ3ZhbGlkLXRva2VuJztcblxuICAgICAgcHJpc21hU2VydmljZS51c2VyLmZpbmRVbmlxdWUubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXJXaXRoVG9rZW4pO1xuICAgICAgdG9rZW5TZXJ2aWNlLmNvbXBhcmVQYXNzd29yZC5tb2NrUmVzb2x2ZWRWYWx1ZSh0cnVlKTsgLy8gU2FtZSBwYXNzd29yZFxuXG4gICAgICBhd2FpdCBleHBlY3Qoc2VydmljZS5yZXNldFBhc3N3b3JkKHRva2VuLCB2YWxpZFBhc3N3b3JkKSkucmVqZWN0cy50b1Rocm93KFxuICAgICAgICBCYWRSZXF1ZXN0RXhjZXB0aW9uLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYWxsb3cgcGFzc3dvcmQgcmVzZXQgZm9yIHVzZXIgd2l0aG91dCBleGlzdGluZyBwYXNzd29yZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRva2VuID0gJ3ZhbGlkLXRva2VuJztcbiAgICAgIGNvbnN0IHVzZXJXaXRob3V0UGFzc3dvcmQgPSB7XG4gICAgICAgIC4uLm1vY2tVc2VyV2l0aFRva2VuLFxuICAgICAgICBwYXNzd29yZDogbnVsbCxcbiAgICAgIH07XG4gICAgICBjb25zdCBoYXNoZWROZXdQYXNzd29yZCA9ICduZXctaGFzaGVkLXBhc3N3b3JkJztcblxuICAgICAgcHJpc21hU2VydmljZS51c2VyLmZpbmRVbmlxdWUubW9ja1Jlc29sdmVkVmFsdWUodXNlcldpdGhvdXRQYXNzd29yZCk7XG4gICAgICB0b2tlblNlcnZpY2UuaGFzaFBhc3N3b3JkLm1vY2tSZXNvbHZlZFZhbHVlKGhhc2hlZE5ld1Bhc3N3b3JkKTtcbiAgICAgIHByaXNtYVNlcnZpY2UudXNlci51cGRhdGUubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VzZXIpO1xuICAgICAgdG9rZW5TZXJ2aWNlLnJldm9rZUFsbFVzZXJUb2tlbnMubW9ja1Jlc29sdmVkVmFsdWUodW5kZWZpbmVkKTtcbiAgICAgIGVtYWlsU2VydmljZS5zZW5kR2VuZXJpY0VtYWlsLm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UucmVzZXRQYXNzd29yZCh0b2tlbiwgdmFsaWRQYXNzd29yZCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdCh0b2tlblNlcnZpY2UuY29tcGFyZVBhc3N3b3JkKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgndmFsaWRhdGVSZXNldFRva2VuJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgdG9rZW4gc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdG9rZW4gPSAndmFsaWQtdG9rZW4nO1xuICAgICAgY29uc3QgdXNlcldpdGhWYWxpZFRva2VuID0ge1xuICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgICByZXNldFRva2VuRXhwaXJ5OiBuZXcgRGF0ZShEYXRlLm5vdygpICsgNjAgKiA2MCAqIDEwMDApLFxuICAgICAgICBkZWFjdGl2YXRlZEF0OiBudWxsLFxuICAgICAgfTtcblxuICAgICAgcHJpc21hU2VydmljZS51c2VyLmZpbmRVbmlxdWUubW9ja1Jlc29sdmVkVmFsdWUodXNlcldpdGhWYWxpZFRva2VuKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS52YWxpZGF0ZVJlc2V0VG9rZW4odG9rZW4pO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHtcbiAgICAgICAgdmFsaWQ6IHRydWUsXG4gICAgICAgIGVtYWlsOiAndGVzdEBleGFtcGxlLmNvbScsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGludmFsaWQgZm9yIG1pc3NpbmcgdG9rZW4nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLnZhbGlkYXRlUmVzZXRUb2tlbignJyk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoeyB2YWxpZDogZmFsc2UgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBpbnZhbGlkIGZvciBub24tZXhpc3RlbnQgdG9rZW4nLCBhc3luYyAoKSA9PiB7XG4gICAgICBwcmlzbWFTZXJ2aWNlLnVzZXIuZmluZFVuaXF1ZS5tb2NrUmVzb2x2ZWRWYWx1ZShudWxsKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS52YWxpZGF0ZVJlc2V0VG9rZW4oJ2ludmFsaWQtdG9rZW4nKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7IHZhbGlkOiBmYWxzZSB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGludmFsaWQgZm9yIGRlYWN0aXZhdGVkIHVzZXInLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBkZWFjdGl2YXRlZFVzZXIgPSB7XG4gICAgICAgIGVtYWlsOiAndGVzdEBleGFtcGxlLmNvbScsXG4gICAgICAgIHJlc2V0VG9rZW5FeHBpcnk6IG5ldyBEYXRlKERhdGUubm93KCkgKyA2MCAqIDYwICogMTAwMCksXG4gICAgICAgIGRlYWN0aXZhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICB9O1xuXG4gICAgICBwcmlzbWFTZXJ2aWNlLnVzZXIuZmluZFVuaXF1ZS5tb2NrUmVzb2x2ZWRWYWx1ZShkZWFjdGl2YXRlZFVzZXIpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLnZhbGlkYXRlUmVzZXRUb2tlbigndG9rZW4nKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7IHZhbGlkOiBmYWxzZSB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGludmFsaWQgZm9yIGV4cGlyZWQgdG9rZW4nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB1c2VyV2l0aEV4cGlyZWRUb2tlbiA9IHtcbiAgICAgICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcbiAgICAgICAgcmVzZXRUb2tlbkV4cGlyeTogbmV3IERhdGUoRGF0ZS5ub3coKSAtIDEwMDApLFxuICAgICAgICBkZWFjdGl2YXRlZEF0OiBudWxsLFxuICAgICAgfTtcblxuICAgICAgcHJpc21hU2VydmljZS51c2VyLmZpbmRVbmlxdWUubW9ja1Jlc29sdmVkVmFsdWUodXNlcldpdGhFeHBpcmVkVG9rZW4pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLnZhbGlkYXRlUmVzZXRUb2tlbignZXhwaXJlZC10b2tlbicpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKHsgdmFsaWQ6IGZhbHNlIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gaW52YWxpZCBmb3IgdG9rZW4gd2l0aG91dCBleHBpcnknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB1c2VyV2l0aG91dEV4cGlyeSA9IHtcbiAgICAgICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcbiAgICAgICAgcmVzZXRUb2tlbkV4cGlyeTogbnVsbCxcbiAgICAgICAgZGVhY3RpdmF0ZWRBdDogbnVsbCxcbiAgICAgIH07XG5cbiAgICAgIHByaXNtYVNlcnZpY2UudXNlci5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKHVzZXJXaXRob3V0RXhwaXJ5KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS52YWxpZGF0ZVJlc2V0VG9rZW4oJ3Rva2VuJyk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoeyB2YWxpZDogZmFsc2UgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCd2YWxpZGF0ZVBhc3N3b3JkU3RyZW5ndGgnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBzdHJvbmcgcGFzc3dvcmQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBzdHJvbmdQYXNzd29yZCA9ICdTdHJvbmdQYXNzd29yZDEyMyEnO1xuICAgICAgZXhwZWN0KCgpID0+IChzZXJ2aWNlIGFzIGFueSkudmFsaWRhdGVQYXNzd29yZFN0cmVuZ3RoKHN0cm9uZ1Bhc3N3b3JkKSkubm90LnRvVGhyb3coKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdGhyb3cgZm9yIHRvbyBzaG9ydCBwYXNzd29yZCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHNob3J0UGFzc3dvcmQgPSAnQWIxISc7XG4gICAgICBleHBlY3QoKCkgPT4gKHNlcnZpY2UgYXMgYW55KS52YWxpZGF0ZVBhc3N3b3JkU3RyZW5ndGgoc2hvcnRQYXNzd29yZCkpLnRvVGhyb3coXG4gICAgICAgIEJhZFJlcXVlc3RFeGNlcHRpb24sXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0aHJvdyBmb3IgcGFzc3dvcmQgd2l0aG91dCB1cHBlcmNhc2UnLCAoKSA9PiB7XG4gICAgICBjb25zdCBub1VwcGVyUGFzc3dvcmQgPSAncGFzc3dvcmQxMjMhJztcbiAgICAgIGV4cGVjdCgoKSA9PiAoc2VydmljZSBhcyBhbnkpLnZhbGlkYXRlUGFzc3dvcmRTdHJlbmd0aChub1VwcGVyUGFzc3dvcmQpKS50b1Rocm93KFxuICAgICAgICBCYWRSZXF1ZXN0RXhjZXB0aW9uLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdGhyb3cgZm9yIHBhc3N3b3JkIHdpdGhvdXQgbG93ZXJjYXNlJywgKCkgPT4ge1xuICAgICAgY29uc3Qgbm9Mb3dlclBhc3N3b3JkID0gJ1BBU1NXT1JEMTIzISc7XG4gICAgICBleHBlY3QoKCkgPT4gKHNlcnZpY2UgYXMgYW55KS52YWxpZGF0ZVBhc3N3b3JkU3RyZW5ndGgobm9Mb3dlclBhc3N3b3JkKSkudG9UaHJvdyhcbiAgICAgICAgQmFkUmVxdWVzdEV4Y2VwdGlvbixcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IGZvciBwYXNzd29yZCB3aXRob3V0IG51bWJlcicsICgpID0+IHtcbiAgICAgIGNvbnN0IG5vTnVtYmVyUGFzc3dvcmQgPSAnUGFzc3dvcmQhJztcbiAgICAgIGV4cGVjdCgoKSA9PiAoc2VydmljZSBhcyBhbnkpLnZhbGlkYXRlUGFzc3dvcmRTdHJlbmd0aChub051bWJlclBhc3N3b3JkKSkudG9UaHJvdyhcbiAgICAgICAgQmFkUmVxdWVzdEV4Y2VwdGlvbixcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IGZvciBwYXNzd29yZCB3aXRob3V0IHNwZWNpYWwgY2hhcmFjdGVyJywgKCkgPT4ge1xuICAgICAgY29uc3Qgbm9TcGVjaWFsUGFzc3dvcmQgPSAnUGFzc3dvcmQxMjMnO1xuICAgICAgZXhwZWN0KCgpID0+IChzZXJ2aWNlIGFzIGFueSkudmFsaWRhdGVQYXNzd29yZFN0cmVuZ3RoKG5vU3BlY2lhbFBhc3N3b3JkKSkudG9UaHJvdyhcbiAgICAgICAgQmFkUmVxdWVzdEV4Y2VwdGlvbixcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IGZvciBjb21tb24gcGFzc3dvcmQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBjb21tb25QYXNzd29yZCA9ICdwYXNzd29yZDEyMyc7XG4gICAgICBleHBlY3QoKCkgPT4gKHNlcnZpY2UgYXMgYW55KS52YWxpZGF0ZVBhc3N3b3JkU3RyZW5ndGgoY29tbW9uUGFzc3dvcmQpKS50b1Rocm93KFxuICAgICAgICBCYWRSZXF1ZXN0RXhjZXB0aW9uLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdXNlIGRlZmF1bHQgbWluIGxlbmd0aCB3aGVuIGVudiB2YXJpYWJsZSBub3Qgc2V0JywgKCkgPT4ge1xuICAgICAgZGVsZXRlIHByb2Nlc3MuZW52Lk1JTl9QQVNTV09SRF9MRU5HVEg7XG4gICAgICBjb25zdCBzaG9ydFBhc3N3b3JkID0gJ0FiMSE1NjcnOyAvLyA3IGNoYXJhY3RlcnNcbiAgICAgIGV4cGVjdCgoKSA9PiAoc2VydmljZSBhcyBhbnkpLnZhbGlkYXRlUGFzc3dvcmRTdHJlbmd0aChzaG9ydFBhc3N3b3JkKSkudG9UaHJvdyhcbiAgICAgICAgQmFkUmVxdWVzdEV4Y2VwdGlvbixcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFjY2VwdCB2YXJpb3VzIHNwZWNpYWwgY2hhcmFjdGVycycsICgpID0+IHtcbiAgICAgIGNvbnN0IHNwZWNpYWxDaGFycyA9ICchQCMkJV4mKigpXystPVtde307XFwnOlwifCwuPD4vPyc7XG4gICAgICBmb3IgKGNvbnN0IGNoYXIgb2Ygc3BlY2lhbENoYXJzKSB7XG4gICAgICAgIGNvbnN0IHBhc3N3b3JkID0gYFBhc3N3b3JkMTIzJHtjaGFyfWA7XG4gICAgICAgIGV4cGVjdCgoKSA9PiAoc2VydmljZSBhcyBhbnkpLnZhbGlkYXRlUGFzc3dvcmRTdHJlbmd0aChwYXNzd29yZCkpLm5vdC50b1Rocm93KCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdjbGVhbnVwRXhwaXJlZFRva2VucycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGNsZWFuIHVwIGV4cGlyZWQgcmVzZXQgdG9rZW5zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcHJpc21hU2VydmljZS51c2VyLnVwZGF0ZU1hbnkubW9ja1Jlc29sdmVkVmFsdWUoeyBjb3VudDogMyB9KTtcblxuICAgICAgYXdhaXQgc2VydmljZS5jbGVhbnVwRXhwaXJlZFRva2VucygpO1xuXG4gICAgICBleHBlY3QocHJpc21hU2VydmljZS51c2VyLnVwZGF0ZU1hbnkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICByZXNldFRva2VuRXhwaXJ5OiB7XG4gICAgICAgICAgICBsdDogZXhwZWN0LmFueShEYXRlKSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgcmVzZXRUb2tlbjogbnVsbCxcbiAgICAgICAgICByZXNldFRva2VuRXhwaXJ5OiBudWxsLFxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdzZW5kUGFzc3dvcmRSZXNldEVtYWlsIChwcml2YXRlIG1ldGhvZCknLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBzZW5kIHBhc3N3b3JkIHJlc2V0IGVtYWlsIHdpdGggY29ycmVjdCB0ZW1wbGF0ZSBkYXRhJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZW1haWwgPSAndGVzdEBleGFtcGxlLmNvbSc7XG4gICAgICBjb25zdCBmaXJzdE5hbWUgPSAnSm9obic7XG4gICAgICBjb25zdCB0b2tlbiA9ICdyZXNldC10b2tlbic7XG5cbiAgICAgIGVtYWlsU2VydmljZS5zZW5kR2VuZXJpY0VtYWlsLm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCk7XG5cbiAgICAgIGF3YWl0IChzZXJ2aWNlIGFzIGFueSkuc2VuZFBhc3N3b3JkUmVzZXRFbWFpbChlbWFpbCwgZmlyc3ROYW1lLCB0b2tlbik7XG5cbiAgICAgIGV4cGVjdChlbWFpbFNlcnZpY2Uuc2VuZEdlbmVyaWNFbWFpbCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICB0bzogZW1haWwsXG4gICAgICAgIHN1YmplY3Q6ICdSZXNldCBZb3VyIE1lbnRhcmEgUGFzc3dvcmQnLFxuICAgICAgICB0ZW1wbGF0ZTogJ3Bhc3N3b3JkLXJlc2V0JyxcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIGZpcnN0TmFtZSxcbiAgICAgICAgICByZXNldFVybDogYGh0dHBzOi8vbWVudGFyYS5jb20vcmVzZXQtcGFzc3dvcmQ/dG9rZW49JHt0b2tlbn1gLFxuICAgICAgICAgIGV4cGlyeVRpbWU6ICcxIGhvdXInLFxuICAgICAgICAgIHN1cHBvcnRFbWFpbDogJ3N1cHBvcnRAbWVudGFyYS5jb20nLFxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHVzZSBkZWZhdWx0IHN1cHBvcnQgZW1haWwgd2hlbiBlbnYgdmFyaWFibGUgbm90IHNldCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGRlbGV0ZSBwcm9jZXNzLmVudi5TVVBQT1JUX0VNQUlMO1xuICAgICAgY29uc3QgZW1haWwgPSAndGVzdEBleGFtcGxlLmNvbSc7XG4gICAgICBjb25zdCBmaXJzdE5hbWUgPSAnSm9obic7XG4gICAgICBjb25zdCB0b2tlbiA9ICdyZXNldC10b2tlbic7XG5cbiAgICAgIGVtYWlsU2VydmljZS5zZW5kR2VuZXJpY0VtYWlsLm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCk7XG5cbiAgICAgIGF3YWl0IChzZXJ2aWNlIGFzIGFueSkuc2VuZFBhc3N3b3JkUmVzZXRFbWFpbChlbWFpbCwgZmlyc3ROYW1lLCB0b2tlbik7XG5cbiAgICAgIGV4cGVjdChlbWFpbFNlcnZpY2Uuc2VuZEdlbmVyaWNFbWFpbCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICB0bzogZW1haWwsXG4gICAgICAgIHN1YmplY3Q6ICdSZXNldCBZb3VyIE1lbnRhcmEgUGFzc3dvcmQnLFxuICAgICAgICB0ZW1wbGF0ZTogJ3Bhc3N3b3JkLXJlc2V0JyxcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIGZpcnN0TmFtZSxcbiAgICAgICAgICByZXNldFVybDogYGh0dHBzOi8vbWVudGFyYS5jb20vcmVzZXQtcGFzc3dvcmQ/dG9rZW49JHt0b2tlbn1gLFxuICAgICAgICAgIGV4cGlyeVRpbWU6ICcxIGhvdXInLFxuICAgICAgICAgIHN1cHBvcnRFbWFpbDogJ3N1cHBvcnRAbWVudGFyYS5jb20nLFxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBlbWFpbCBzZXJ2aWNlIGZhaWx1cmUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBlbWFpbCA9ICd0ZXN0QGV4YW1wbGUuY29tJztcbiAgICAgIGNvbnN0IGZpcnN0TmFtZSA9ICdKb2huJztcbiAgICAgIGNvbnN0IHRva2VuID0gJ3Jlc2V0LXRva2VuJztcblxuICAgICAgZW1haWxTZXJ2aWNlLnNlbmRHZW5lcmljRW1haWwubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdFbWFpbCBzZXJ2aWNlIGVycm9yJykpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIChzZXJ2aWNlIGFzIGFueSkuc2VuZFBhc3N3b3JkUmVzZXRFbWFpbChlbWFpbCwgZmlyc3ROYW1lLCB0b2tlbiksXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhCYWRSZXF1ZXN0RXhjZXB0aW9uKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3NlbmRQYXNzd29yZFJlc2V0Q29uZmlybWF0aW9uRW1haWwgKHByaXZhdGUgbWV0aG9kKScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHNlbmQgY29uZmlybWF0aW9uIGVtYWlsIGFmdGVyIHN1Y2Nlc3NmdWwgcmVzZXQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBlbWFpbCA9ICd0ZXN0QGV4YW1wbGUuY29tJztcblxuICAgICAgZW1haWxTZXJ2aWNlLnNlbmRHZW5lcmljRW1haWwubW9ja1Jlc29sdmVkVmFsdWUodW5kZWZpbmVkKTtcblxuICAgICAgYXdhaXQgKHNlcnZpY2UgYXMgYW55KS5zZW5kUGFzc3dvcmRSZXNldENvbmZpcm1hdGlvbkVtYWlsKGVtYWlsKTtcblxuICAgICAgZXhwZWN0KGVtYWlsU2VydmljZS5zZW5kR2VuZXJpY0VtYWlsKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIHRvOiBlbWFpbCxcbiAgICAgICAgc3ViamVjdDogJ1Bhc3N3b3JkIFJlc2V0IFN1Y2Nlc3NmdWwnLFxuICAgICAgICB0ZW1wbGF0ZTogJ3Bhc3N3b3JkLXJlc2V0LWNvbmZpcm1hdGlvbicsXG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBzdXBwb3J0RW1haWw6ICdzdXBwb3J0QG1lbnRhcmEuY29tJyxcbiAgICAgICAgICBsb2dpblVybDogJ2h0dHBzOi8vbWVudGFyYS5jb20vbG9naW4nLFxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG5vdCB0aHJvdyBlcnJvciBpZiBjb25maXJtYXRpb24gZW1haWwgZmFpbHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBlbWFpbCA9ICd0ZXN0QGV4YW1wbGUuY29tJztcblxuICAgICAgZW1haWxTZXJ2aWNlLnNlbmRHZW5lcmljRW1haWwubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdFbWFpbCBzZXJ2aWNlIGVycm9yJykpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIChzZXJ2aWNlIGFzIGFueSkuc2VuZFBhc3N3b3JkUmVzZXRDb25maXJtYXRpb25FbWFpbChlbWFpbCksXG4gICAgICApLnJlc29sdmVzLm5vdC50b1Rocm93KCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdjcnlwdG8gaGFzaCBpbnRlZ3JhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHVzZSBjcnlwdG8uY3JlYXRlSGFzaCBmb3IgdG9rZW4gaGFzaGluZycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRva2VuID0gJ3Rlc3QtdG9rZW4nO1xuICAgICAgY29uc3QgbW9ja0hhc2ggPSB7XG4gICAgICAgIHVwZGF0ZTogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXG4gICAgICAgIGRpZ2VzdDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnaGFzaGVkLXRva2VuJyksXG4gICAgICB9O1xuXG4gICAgICAoY3J5cHRvLmNyZWF0ZUhhc2ggYXMgamVzdC5Nb2NrKS5tb2NrUmV0dXJuVmFsdWUobW9ja0hhc2gpO1xuXG4gICAgICBhd2FpdCBzZXJ2aWNlLnZhbGlkYXRlUmVzZXRUb2tlbih0b2tlbik7XG5cbiAgICAgIGV4cGVjdChjcnlwdG8uY3JlYXRlSGFzaCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ3NoYTI1NicpO1xuICAgICAgZXhwZWN0KG1vY2tIYXNoLnVwZGF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgodG9rZW4pO1xuICAgICAgZXhwZWN0KG1vY2tIYXNoLmRpZ2VzdCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ2hleCcpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZW52aXJvbm1lbnQgdmFyaWFibGUgaGFuZGxpbmcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbWlzc2luZyBGUk9OVEVORF9VUkwgaW4gcmVzZXQgZW1haWwnLCBhc3luYyAoKSA9PiB7XG4gICAgICBkZWxldGUgcHJvY2Vzcy5lbnYuRlJPTlRFTkRfVVJMO1xuICAgICAgY29uc3QgZW1haWwgPSAndGVzdEBleGFtcGxlLmNvbSc7XG4gICAgICBjb25zdCBmaXJzdE5hbWUgPSAnSm9obic7XG4gICAgICBjb25zdCB0b2tlbiA9ICdyZXNldC10b2tlbic7XG5cbiAgICAgIGVtYWlsU2VydmljZS5zZW5kR2VuZXJpY0VtYWlsLm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCk7XG5cbiAgICAgIGF3YWl0IChzZXJ2aWNlIGFzIGFueSkuc2VuZFBhc3N3b3JkUmVzZXRFbWFpbChlbWFpbCwgZmlyc3ROYW1lLCB0b2tlbik7XG5cbiAgICAgIGV4cGVjdChlbWFpbFNlcnZpY2Uuc2VuZEdlbmVyaWNFbWFpbCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICB0bzogZW1haWwsXG4gICAgICAgIHN1YmplY3Q6ICdSZXNldCBZb3VyIE1lbnRhcmEgUGFzc3dvcmQnLFxuICAgICAgICB0ZW1wbGF0ZTogJ3Bhc3N3b3JkLXJlc2V0JyxcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIGZpcnN0TmFtZSxcbiAgICAgICAgICByZXNldFVybDogYHVuZGVmaW5lZC9yZXNldC1wYXNzd29yZD90b2tlbj0ke3Rva2VufWAsXG4gICAgICAgICAgZXhwaXJ5VGltZTogJzEgaG91cicsXG4gICAgICAgICAgc3VwcG9ydEVtYWlsOiAnc3VwcG9ydEBtZW50YXJhLmNvbScsXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG1pc3NpbmcgRlJPTlRFTkRfVVJMIGluIGNvbmZpcm1hdGlvbiBlbWFpbCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGRlbGV0ZSBwcm9jZXNzLmVudi5GUk9OVEVORF9VUkw7XG4gICAgICBjb25zdCBlbWFpbCA9ICd0ZXN0QGV4YW1wbGUuY29tJztcblxuICAgICAgZW1haWxTZXJ2aWNlLnNlbmRHZW5lcmljRW1haWwubW9ja1Jlc29sdmVkVmFsdWUodW5kZWZpbmVkKTtcblxuICAgICAgYXdhaXQgKHNlcnZpY2UgYXMgYW55KS5zZW5kUGFzc3dvcmRSZXNldENvbmZpcm1hdGlvbkVtYWlsKGVtYWlsKTtcblxuICAgICAgZXhwZWN0KGVtYWlsU2VydmljZS5zZW5kR2VuZXJpY0VtYWlsKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIHRvOiBlbWFpbCxcbiAgICAgICAgc3ViamVjdDogJ1Bhc3N3b3JkIFJlc2V0IFN1Y2Nlc3NmdWwnLFxuICAgICAgICB0ZW1wbGF0ZTogJ3Bhc3N3b3JkLXJlc2V0LWNvbmZpcm1hdGlvbicsXG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBzdXBwb3J0RW1haWw6ICdzdXBwb3J0QG1lbnRhcmEuY29tJyxcbiAgICAgICAgICBsb2dpblVybDogJ3VuZGVmaW5lZC9sb2dpbicsXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG59KTsiXSwidmVyc2lvbiI6M30=