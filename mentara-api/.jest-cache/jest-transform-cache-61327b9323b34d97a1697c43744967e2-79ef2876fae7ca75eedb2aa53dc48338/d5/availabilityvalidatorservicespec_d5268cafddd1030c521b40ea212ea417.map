{"file":"/home/wetooa/Documents/code/projects/mentara/mentara-api/src/booking/services/availability-validator.service.spec.ts","mappings":"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","names":[],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/booking/services/availability-validator.service.spec.ts"],"sourcesContent":["import { Test, TestingModule } from '@nestjs/testing';\nimport { AvailabilityValidatorService, ValidationConfig } from './availability-validator.service';\nimport { PrismaService } from '../../providers/prisma-client.provider';\nimport { BadRequestException } from '@nestjs/common';\n\ndescribe('AvailabilityValidatorService', () => {\n  let service: AvailabilityValidatorService;\n  let prismaService: jest.Mocked<PrismaService>;\n\n  const mockTherapistAvailability = {\n    id: 'availability-123',\n    therapistId: 'therapist-123',\n    dayOfWeek: 1, // Monday\n    startTime: '09:00',\n    endTime: '17:00',\n    isAvailable: true,\n    createdAt: new Date(),\n    updatedAt: new Date(),\n  };\n\n  const mockTherapist = {\n    id: 'therapist-123',\n    userId: 'therapist-user-123',\n    status: 'approved',\n    user: {\n      isActive: true,\n    },\n    createdAt: new Date(),\n    updatedAt: new Date(),\n  };\n\n  const mockClientTherapistRelationship = {\n    id: 'relationship-123',\n    clientId: 'client-123',\n    therapistId: 'therapist-123',\n    status: 'ACTIVE',\n    createdAt: new Date(),\n    updatedAt: new Date(),\n  };\n\n  const mockValidationConfig: ValidationConfig = {\n    allowedDurations: [30, 60, 90],\n    timeFormat: 'HH:MM',\n    timezone: 'UTC',\n    businessHours: {\n      start: '08:00',\n      end: '18:00',\n    },\n    advanceBooking: {\n      minHours: 2,\n      maxDays: 30,\n    },\n    weekendBooking: false,\n  };\n\n  beforeEach(async () => {\n    const module: TestingModule = await Test.createTestingModule({\n      providers: [\n        AvailabilityValidatorService,\n        {\n          provide: PrismaService,\n          useValue: {\n            therapistAvailability: {\n              findFirst: jest.fn(),\n            },\n            clientTherapist: {\n              findFirst: jest.fn(),\n            },\n            therapist: {\n              findFirst: jest.fn(),\n            },\n          },\n        },\n      ],\n    }).compile();\n\n    service = module.get<AvailabilityValidatorService>(AvailabilityValidatorService);\n    prismaService = module.get(PrismaService);\n  });\n\n  afterEach(() => {\n    jest.clearAllMocks();\n  });\n\n  it('should be defined', () => {\n    expect(service).toBeDefined();\n  });\n\n  describe('validateTimeFormat', () => {\n    it('should validate correct time format HH:MM', () => {\n      const validTimes = ['09:30', '14:45', '23:59', '00:00'];\n      \n      validTimes.forEach(time => {\n        expect(service.validateTimeFormat(time, 'HH:MM')).toBe(true);\n      });\n    });\n\n    it('should validate correct time format HH:mm', () => {\n      const validTimes = ['09:30', '14:45', '23:59', '00:00'];\n      \n      validTimes.forEach(time => {\n        expect(service.validateTimeFormat(time, 'HH:mm')).toBe(true);\n      });\n    });\n\n    it('should throw BadRequestException for invalid time format', () => {\n      const invalidTimes = ['9:30', '24:00', '12:60', '12:ab', 'invalid', ''];\n      \n      invalidTimes.forEach(time => {\n        expect(() => service.validateTimeFormat(time)).toThrow(BadRequestException);\n        expect(() => service.validateTimeFormat(time)).toThrow('Invalid time format');\n      });\n    });\n\n    it('should use default format HH:MM when format not specified', () => {\n      expect(service.validateTimeFormat('09:30')).toBe(true);\n      expect(() => service.validateTimeFormat('9:30')).toThrow(BadRequestException);\n    });\n  });\n\n  describe('validateDuration', () => {\n    it('should validate allowed durations', () => {\n      const defaultAllowed = [30, 60, 90, 120];\n      \n      defaultAllowed.forEach(duration => {\n        expect(service.validateDuration(duration)).toBe(true);\n      });\n    });\n\n    it('should validate custom allowed durations', () => {\n      const customAllowed = [45, 75, 105];\n      \n      customAllowed.forEach(duration => {\n        expect(service.validateDuration(duration, customAllowed)).toBe(true);\n      });\n    });\n\n    it('should throw BadRequestException for invalid duration', () => {\n      expect(() => service.validateDuration(15)).toThrow(BadRequestException);\n      expect(() => service.validateDuration(15)).toThrow('Invalid duration. Allowed durations are: 30, 60, 90, 120 minutes');\n    });\n\n    it('should throw BadRequestException for invalid custom duration', () => {\n      const customAllowed = [45, 75];\n      \n      expect(() => service.validateDuration(60, customAllowed)).toThrow(BadRequestException);\n      expect(() => service.validateDuration(60, customAllowed)).toThrow('Invalid duration. Allowed durations are: 45, 75 minutes');\n    });\n  });\n\n  describe('validateBookingDateTime', () => {\n    it('should validate valid booking date and time', () => {\n      const futureDate = new Date();\n      futureDate.setDate(futureDate.getDate() + 1);\n      futureDate.setHours(10, 0, 0, 0);\n      \n      expect(service.validateBookingDateTime(futureDate, 60)).toBe(true);\n    });\n\n    it('should validate booking with custom config', () => {\n      const futureDate = new Date();\n      futureDate.setDate(futureDate.getDate() + 1);\n      futureDate.setHours(10, 0, 0, 0);\n      \n      const customConfig = {\n        allowedDurations: [60, 90],\n        businessHours: { start: '09:00', end: '18:00' },\n        advanceBooking: { minHours: 1, maxDays: 60 },\n        weekendBooking: true,\n      };\n      \n      expect(service.validateBookingDateTime(futureDate, 60, customConfig)).toBe(true);\n    });\n\n    it('should throw error for past booking time', () => {\n      const pastDate = new Date();\n      pastDate.setHours(pastDate.getHours() - 1);\n      \n      expect(() => service.validateBookingDateTime(pastDate, 60)).toThrow(BadRequestException);\n      expect(() => service.validateBookingDateTime(pastDate, 60)).toThrow('at least 2 hours in advance');\n    });\n\n    it('should throw error for booking too far in advance', () => {\n      const farFutureDate = new Date();\n      farFutureDate.setDate(farFutureDate.getDate() + 100);\n      \n      expect(() => service.validateBookingDateTime(farFutureDate, 60)).toThrow(BadRequestException);\n      expect(() => service.validateBookingDateTime(farFutureDate, 60)).toThrow('up to 90 days in advance');\n    });\n\n    it('should throw error for booking outside business hours', () => {\n      const futureDate = new Date();\n      futureDate.setDate(futureDate.getDate() + 1);\n      futureDate.setHours(7, 0, 0, 0); // Before business hours\n      \n      expect(() => service.validateBookingDateTime(futureDate, 60)).toThrow(BadRequestException);\n      expect(() => service.validateBookingDateTime(futureDate, 60)).toThrow('within business hours');\n    });\n\n    it('should throw error for weekend booking when not allowed', () => {\n      const saturday = new Date();\n      saturday.setDate(saturday.getDate() + (6 - saturday.getDay())); // Next Saturday\n      saturday.setHours(10, 0, 0, 0);\n      \n      const config = { weekendBooking: false };\n      \n      expect(() => service.validateBookingDateTime(saturday, 60, config)).toThrow(BadRequestException);\n      expect(() => service.validateBookingDateTime(saturday, 60, config)).toThrow('Weekend bookings are not allowed');\n    });\n  });\n\n  describe('validateAdvanceBooking', () => {\n    it('should validate advance booking within allowed range', () => {\n      const futureDate = new Date();\n      futureDate.setDate(futureDate.getDate() + 1);\n      futureDate.setHours(10, 0, 0, 0);\n      \n      // Should not throw for valid advance booking\n      expect(() => (service as any).validateAdvanceBooking(futureDate, mockValidationConfig)).not.toThrow();\n    });\n\n    it('should throw error for booking too soon', () => {\n      const soonDate = new Date();\n      soonDate.setHours(soonDate.getHours() + 1); // Only 1 hour in advance\n      \n      expect(() => (service as any).validateAdvanceBooking(soonDate, mockValidationConfig)).toThrow(BadRequestException);\n      expect(() => (service as any).validateAdvanceBooking(soonDate, mockValidationConfig)).toThrow('at least 2 hours in advance');\n    });\n\n    it('should throw error for booking too far in advance', () => {\n      const farDate = new Date();\n      farDate.setDate(farDate.getDate() + 40); // 40 days in advance (max is 30)\n      \n      expect(() => (service as any).validateAdvanceBooking(farDate, mockValidationConfig)).toThrow(BadRequestException);\n      expect(() => (service as any).validateAdvanceBooking(farDate, mockValidationConfig)).toThrow('up to 30 days in advance');\n    });\n  });\n\n  describe('validateBusinessHours', () => {\n    it('should validate booking within business hours', () => {\n      const validDate = new Date();\n      validDate.setHours(10, 0, 0, 0);\n      \n      expect(() => (service as any).validateBusinessHours(validDate, 60, mockValidationConfig)).not.toThrow();\n    });\n\n    it('should throw error for booking starting before business hours', () => {\n      const earlyDate = new Date();\n      earlyDate.setHours(7, 0, 0, 0);\n      \n      expect(() => (service as any).validateBusinessHours(earlyDate, 60, mockValidationConfig)).toThrow(BadRequestException);\n      expect(() => (service as any).validateBusinessHours(earlyDate, 60, mockValidationConfig)).toThrow('within business hours');\n    });\n\n    it('should throw error for booking ending after business hours', () => {\n      const lateDate = new Date();\n      lateDate.setHours(17, 30, 0, 0); // 5:30 PM with 60 min duration ends at 6:30 PM\n      \n      expect(() => (service as any).validateBusinessHours(lateDate, 60, mockValidationConfig)).toThrow(BadRequestException);\n      expect(() => (service as any).validateBusinessHours(lateDate, 60, mockValidationConfig)).toThrow('within business hours');\n    });\n  });\n\n  describe('validateWeekendBooking', () => {\n    it('should allow weekend booking when enabled', () => {\n      const saturday = new Date();\n      saturday.setDate(saturday.getDate() + (6 - saturday.getDay()));\n      \n      const config = { ...mockValidationConfig, weekendBooking: true };\n      \n      expect(() => (service as any).validateWeekendBooking(saturday, config)).not.toThrow();\n    });\n\n    it('should throw error for weekend booking when disabled', () => {\n      const saturday = new Date();\n      saturday.setDate(saturday.getDate() + (6 - saturday.getDay()));\n      \n      expect(() => (service as any).validateWeekendBooking(saturday, mockValidationConfig)).toThrow(BadRequestException);\n      expect(() => (service as any).validateWeekendBooking(saturday, mockValidationConfig)).toThrow('Weekend bookings are not allowed');\n    });\n\n    it('should throw error for Sunday booking when disabled', () => {\n      const sunday = new Date();\n      sunday.setDate(sunday.getDate() + (7 - sunday.getDay()));\n      \n      expect(() => (service as any).validateWeekendBooking(sunday, mockValidationConfig)).toThrow(BadRequestException);\n      expect(() => (service as any).validateWeekendBooking(sunday, mockValidationConfig)).toThrow('Weekend bookings are not allowed');\n    });\n  });\n\n  describe('validateTherapistAvailability', () => {\n    it('should validate therapist availability successfully', async () => {\n      const monday = new Date();\n      monday.setDate(monday.getDate() + (1 - monday.getDay())); // Next Monday\n      monday.setHours(10, 0, 0, 0);\n      \n      prismaService.therapistAvailability.findFirst.mockResolvedValue(mockTherapistAvailability);\n      \n      const result = await service.validateTherapistAvailability('therapist-123', monday, 60);\n      \n      expect(result).toBe(true);\n      expect(prismaService.therapistAvailability.findFirst).toHaveBeenCalledWith({\n        where: {\n          therapistId: 'therapist-123',\n          dayOfWeek: 1,\n          startTime: { lte: '10:00' },\n          endTime: { gte: '11:00' },\n          isAvailable: true,\n        },\n      });\n    });\n\n    it('should throw error when therapist is not available', async () => {\n      const monday = new Date();\n      monday.setDate(monday.getDate() + (1 - monday.getDay()));\n      monday.setHours(10, 0, 0, 0);\n      \n      prismaService.therapistAvailability.findFirst.mockResolvedValue(null);\n      \n      await expect(service.validateTherapistAvailability('therapist-123', monday, 60))\n        .rejects.toThrow(BadRequestException);\n      await expect(service.validateTherapistAvailability('therapist-123', monday, 60))\n        .rejects.toThrow('Therapist is not available at the requested time');\n    });\n  });\n\n  describe('validateClientTherapistRelationship', () => {\n    it('should validate active client-therapist relationship', async () => {\n      prismaService.clientTherapist.findFirst.mockResolvedValue(mockClientTherapistRelationship);\n      \n      const result = await service.validateClientTherapistRelationship('client-123', 'therapist-123');\n      \n      expect(result).toBe(true);\n      expect(prismaService.clientTherapist.findFirst).toHaveBeenCalledWith({\n        where: {\n          clientId: 'client-123',\n          therapistId: 'therapist-123',\n          status: 'ACTIVE',\n        },\n      });\n    });\n\n    it('should throw error when relationship does not exist', async () => {\n      prismaService.clientTherapist.findFirst.mockResolvedValue(null);\n      \n      await expect(service.validateClientTherapistRelationship('client-123', 'therapist-123'))\n        .rejects.toThrow(BadRequestException);\n      await expect(service.validateClientTherapistRelationship('client-123', 'therapist-123'))\n        .rejects.toThrow('You can only book sessions with your assigned therapists');\n    });\n  });\n\n  describe('validateTherapistExists', () => {\n    it('should validate active approved therapist', async () => {\n      prismaService.therapist.findFirst.mockResolvedValue(mockTherapist);\n      \n      const result = await service.validateTherapistExists('therapist-123');\n      \n      expect(result).toBe(true);\n      expect(prismaService.therapist.findFirst).toHaveBeenCalledWith({\n        where: {\n          userId: 'therapist-123',\n          status: 'approved',\n        },\n        include: {\n          user: {\n            select: {\n              isActive: true,\n            },\n          },\n        },\n      });\n    });\n\n    it('should throw error when therapist does not exist', async () => {\n      prismaService.therapist.findFirst.mockResolvedValue(null);\n      \n      await expect(service.validateTherapistExists('therapist-123'))\n        .rejects.toThrow(BadRequestException);\n      await expect(service.validateTherapistExists('therapist-123'))\n        .rejects.toThrow('Therapist not found or inactive');\n    });\n\n    it('should throw error when therapist is inactive', async () => {\n      const inactiveTherapist = {\n        ...mockTherapist,\n        user: { isActive: false },\n      };\n      \n      prismaService.therapist.findFirst.mockResolvedValue(inactiveTherapist);\n      \n      await expect(service.validateTherapistExists('therapist-123'))\n        .rejects.toThrow(BadRequestException);\n      await expect(service.validateTherapistExists('therapist-123'))\n        .rejects.toThrow('Therapist not found or inactive');\n    });\n  });\n\n  describe('validateAvailabilityOverlap', () => {\n    it('should validate non-overlapping availability slots', () => {\n      const result = service.validateAvailabilityOverlap('09:00', '12:00', '13:00', '17:00');\n      expect(result).toBe(true);\n    });\n\n    it('should throw error for overlapping slots', () => {\n      expect(() => service.validateAvailabilityOverlap('09:00', '13:00', '11:00', '15:00'))\n        .toThrow(BadRequestException);\n      expect(() => service.validateAvailabilityOverlap('09:00', '13:00', '11:00', '15:00'))\n        .toThrow('Availability slot overlaps with existing availability');\n    });\n\n    it('should throw error for adjacent overlapping slots', () => {\n      expect(() => service.validateAvailabilityOverlap('09:00', '12:00', '11:00', '14:00'))\n        .toThrow(BadRequestException);\n    });\n\n    it('should throw error when start time is after end time', () => {\n      expect(() => service.validateAvailabilityOverlap('13:00', '09:00', '14:00', '17:00'))\n        .toThrow(BadRequestException);\n      expect(() => service.validateAvailabilityOverlap('13:00', '09:00', '14:00', '17:00'))\n        .toThrow('Start time must be before end time');\n    });\n\n    it('should allow touching time slots', () => {\n      const result = service.validateAvailabilityOverlap('09:00', '12:00', '12:00', '15:00');\n      expect(result).toBe(true);\n    });\n  });\n\n  describe('validateTimezone', () => {\n    it('should validate valid timezones', () => {\n      const validTimezones = ['UTC', 'America/New_York', 'Europe/London', 'Asia/Tokyo'];\n      \n      validTimezones.forEach(timezone => {\n        expect(service.validateTimezone(timezone)).toBe(true);\n      });\n    });\n\n    it('should throw error for invalid timezone', () => {\n      expect(() => service.validateTimezone('Invalid/Timezone')).toThrow(BadRequestException);\n      expect(() => service.validateTimezone('Invalid/Timezone')).toThrow('Invalid timezone: Invalid/Timezone');\n    });\n  });\n\n  describe('validateMeetingCreation', () => {\n    it('should validate meeting creation successfully', async () => {\n      const futureDate = new Date();\n      futureDate.setDate(futureDate.getDate() + 1);\n      futureDate.setHours(10, 0, 0, 0);\n      \n      prismaService.therapist.findFirst.mockResolvedValue(mockTherapist);\n      prismaService.clientTherapist.findFirst.mockResolvedValue(mockClientTherapistRelationship);\n      prismaService.therapistAvailability.findFirst.mockResolvedValue(mockTherapistAvailability);\n      \n      const result = await service.validateMeetingCreation({\n        therapistId: 'therapist-123',\n        clientId: 'client-123',\n        startTime: futureDate,\n        duration: 60,\n      });\n      \n      expect(result).toBe(true);\n      expect(prismaService.therapist.findFirst).toHaveBeenCalled();\n      expect(prismaService.clientTherapist.findFirst).toHaveBeenCalled();\n      expect(prismaService.therapistAvailability.findFirst).toHaveBeenCalled();\n    });\n\n    it('should throw error when therapist validation fails', async () => {\n      const futureDate = new Date();\n      futureDate.setDate(futureDate.getDate() + 1);\n      futureDate.setHours(10, 0, 0, 0);\n      \n      prismaService.therapist.findFirst.mockResolvedValue(null);\n      \n      await expect(service.validateMeetingCreation({\n        therapistId: 'therapist-123',\n        clientId: 'client-123',\n        startTime: futureDate,\n        duration: 60,\n      })).rejects.toThrow(BadRequestException);\n    });\n\n    it('should throw error when relationship validation fails', async () => {\n      const futureDate = new Date();\n      futureDate.setDate(futureDate.getDate() + 1);\n      futureDate.setHours(10, 0, 0, 0);\n      \n      prismaService.therapist.findFirst.mockResolvedValue(mockTherapist);\n      prismaService.clientTherapist.findFirst.mockResolvedValue(null);\n      \n      await expect(service.validateMeetingCreation({\n        therapistId: 'therapist-123',\n        clientId: 'client-123',\n        startTime: futureDate,\n        duration: 60,\n      })).rejects.toThrow(BadRequestException);\n    });\n\n    it('should throw error when availability validation fails', async () => {\n      const futureDate = new Date();\n      futureDate.setDate(futureDate.getDate() + 1);\n      futureDate.setHours(10, 0, 0, 0);\n      \n      prismaService.therapist.findFirst.mockResolvedValue(mockTherapist);\n      prismaService.clientTherapist.findFirst.mockResolvedValue(mockClientTherapistRelationship);\n      prismaService.therapistAvailability.findFirst.mockResolvedValue(null);\n      \n      await expect(service.validateMeetingCreation({\n        therapistId: 'therapist-123',\n        clientId: 'client-123',\n        startTime: futureDate,\n        duration: 60,\n      })).rejects.toThrow(BadRequestException);\n    });\n  });\n\n  describe('validateAvailabilityCreation', () => {\n    it('should validate availability creation successfully', async () => {\n      prismaService.therapist.findFirst.mockResolvedValue(mockTherapist);\n      prismaService.therapistAvailability.findFirst.mockResolvedValue(null); // No overlapping\n      \n      const result = await service.validateAvailabilityCreation({\n        therapistId: 'therapist-123',\n        dayOfWeek: 1,\n        startTime: '09:00',\n        endTime: '17:00',\n      });\n      \n      expect(result).toBe(true);\n      expect(prismaService.therapist.findFirst).toHaveBeenCalled();\n      expect(prismaService.therapistAvailability.findFirst).toHaveBeenCalledWith({\n        where: {\n          therapistId: 'therapist-123',\n          dayOfWeek: 1,\n          OR: [\n            {\n              startTime: { lt: '17:00' },\n              endTime: { gt: '09:00' },\n            },\n          ],\n        },\n      });\n    });\n\n    it('should throw error for invalid day of week', async () => {\n      prismaService.therapist.findFirst.mockResolvedValue(mockTherapist);\n      \n      await expect(service.validateAvailabilityCreation({\n        therapistId: 'therapist-123',\n        dayOfWeek: 7, // Invalid day\n        startTime: '09:00',\n        endTime: '17:00',\n      })).rejects.toThrow(BadRequestException);\n      await expect(service.validateAvailabilityCreation({\n        therapistId: 'therapist-123',\n        dayOfWeek: 7,\n        startTime: '09:00',\n        endTime: '17:00',\n      })).rejects.toThrow('Day of week must be between 0 (Sunday) and 6 (Saturday)');\n    });\n\n    it('should throw error when start time is after end time', async () => {\n      prismaService.therapist.findFirst.mockResolvedValue(mockTherapist);\n      \n      await expect(service.validateAvailabilityCreation({\n        therapistId: 'therapist-123',\n        dayOfWeek: 1,\n        startTime: '17:00',\n        endTime: '09:00',\n      })).rejects.toThrow(BadRequestException);\n      await expect(service.validateAvailabilityCreation({\n        therapistId: 'therapist-123',\n        dayOfWeek: 1,\n        startTime: '17:00',\n        endTime: '09:00',\n      })).rejects.toThrow('Start time must be before end time');\n    });\n\n    it('should throw error for overlapping availability', async () => {\n      prismaService.therapist.findFirst.mockResolvedValue(mockTherapist);\n      prismaService.therapistAvailability.findFirst.mockResolvedValue(mockTherapistAvailability);\n      \n      await expect(service.validateAvailabilityCreation({\n        therapistId: 'therapist-123',\n        dayOfWeek: 1,\n        startTime: '10:00',\n        endTime: '16:00',\n      })).rejects.toThrow(BadRequestException);\n      await expect(service.validateAvailabilityCreation({\n        therapistId: 'therapist-123',\n        dayOfWeek: 1,\n        startTime: '10:00',\n        endTime: '16:00',\n      })).rejects.toThrow('Availability slot overlaps with existing availability');\n    });\n  });\n\n  describe('formatTime', () => {\n    it('should format date to HH:MM string', () => {\n      const date = new Date();\n      date.setHours(10, 30, 45, 123);\n      \n      const result = (service as any).formatTime(date);\n      expect(result).toBe('10:30');\n    });\n\n    it('should format date with single digit hours and minutes', () => {\n      const date = new Date();\n      date.setHours(9, 5, 0, 0);\n      \n      const result = (service as any).formatTime(date);\n      expect(result).toBe('09:05');\n    });\n  });\n\n  describe('parseTimeToMinutes', () => {\n    it('should parse time string to minutes since midnight', () => {\n      expect((service as any).parseTimeToMinutes('00:00')).toBe(0);\n      expect((service as any).parseTimeToMinutes('01:00')).toBe(60);\n      expect((service as any).parseTimeToMinutes('12:30')).toBe(750);\n      expect((service as any).parseTimeToMinutes('23:59')).toBe(1439);\n    });\n\n    it('should handle single digit hours and minutes', () => {\n      expect((service as any).parseTimeToMinutes('9:5')).toBe(545);\n      expect((service as any).parseTimeToMinutes('09:05')).toBe(545);\n    });\n  });\n\n  describe('minutesToTimeString', () => {\n    it('should convert minutes to HH:MM string', () => {\n      expect((service as any).minutesToTimeString(0)).toBe('00:00');\n      expect((service as any).minutesToTimeString(60)).toBe('01:00');\n      expect((service as any).minutesToTimeString(750)).toBe('12:30');\n      expect((service as any).minutesToTimeString(1439)).toBe('23:59');\n    });\n\n    it('should handle single digit hours and minutes', () => {\n      expect((service as any).minutesToTimeString(545)).toBe('09:05');\n      expect((service as any).minutesToTimeString(125)).toBe('02:05');\n    });\n  });\n\n  describe('integration tests', () => {\n    it('should handle complex validation scenarios', async () => {\n      const futureMonday = new Date();\n      futureMonday.setDate(futureMonday.getDate() + (1 - futureMonday.getDay() + 7)); // Next Monday\n      futureMonday.setHours(10, 0, 0, 0);\n      \n      prismaService.therapist.findFirst.mockResolvedValue(mockTherapist);\n      prismaService.clientTherapist.findFirst.mockResolvedValue(mockClientTherapistRelationship);\n      prismaService.therapistAvailability.findFirst.mockResolvedValue(mockTherapistAvailability);\n      \n      const result = await service.validateMeetingCreation({\n        therapistId: 'therapist-123',\n        clientId: 'client-123',\n        startTime: futureMonday,\n        duration: 60,\n        config: {\n          allowedDurations: [60, 90],\n          businessHours: { start: '09:00', end: '18:00' },\n          advanceBooking: { minHours: 1, maxDays: 30 },\n          weekendBooking: false,\n        },\n      });\n      \n      expect(result).toBe(true);\n    });\n\n    it('should handle edge case time calculations', () => {\n      const date = new Date();\n      date.setHours(23, 59, 59, 999);\n      \n      const timeStr = (service as any).formatTime(date);\n      expect(timeStr).toBe('23:59');\n      \n      const minutes = (service as any).parseTimeToMinutes(timeStr);\n      expect(minutes).toBe(1439);\n      \n      const backToTime = (service as any).minutesToTimeString(minutes);\n      expect(backToTime).toBe('23:59');\n    });\n  });\n});"],"version":3}