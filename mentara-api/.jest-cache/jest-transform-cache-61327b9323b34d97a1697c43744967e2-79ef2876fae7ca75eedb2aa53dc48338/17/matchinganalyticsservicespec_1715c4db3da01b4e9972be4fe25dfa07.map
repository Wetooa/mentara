{"file":"/home/wetooa/Documents/code/projects/mentara/mentara-api/src/therapist/services/matching-analytics.service.spec.ts","mappings":"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","names":[],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/therapist/services/matching-analytics.service.spec.ts"],"sourcesContent":["import { Test, TestingModule } from '@nestjs/testing';\nimport { MatchingAnalyticsService } from './matching-analytics.service';\nimport { PrismaService } from '../../providers/prisma-client.provider';\nimport { TherapistScore } from './advanced-matching.service';\nimport { CompatibilityAnalysis } from './compatibility-analysis.service';\n\ndescribe('MatchingAnalyticsService', () => {\n  let service: MatchingAnalyticsService;\n  let prismaService: jest.Mocked<PrismaService>;\n\n  const mockTherapistScore: TherapistScore = {\n    therapist: {\n      id: 'therapist-123',\n      userId: 'therapist-user-123',\n      status: 'approved',\n      mobile: '+1234567890',\n      province: 'Metro Manila',\n      providerType: 'Licensed Psychologist',\n      professionalLicenseType: 'Clinical Psychology',\n      isPRCLicensed: 'Yes',\n      prcLicenseNumber: 'PRC123456',\n      expirationDateOfLicense: new Date('2025-12-31'),\n      practiceStartDate: new Date('2015-01-01'),\n      sessionLength: '60 minutes',\n      hourlyRate: 1800,\n      providedOnlineTherapyBefore: true,\n      comfortableUsingVideoConferencing: true,\n      compliesWithDataPrivacyAct: true,\n      willingToAbideByPlatformGuidelines: true,\n      expertise: ['Depression', 'Anxiety', 'Trauma'],\n      illnessSpecializations: ['PTSD', 'Panic Disorder'],\n      approaches: ['Cognitive Behavioral Therapy (CBT)'],\n      therapeuticApproachesUsedList: ['Mindfulness-Based Cognitive Therapy (MBCT)'],\n      treatmentSuccessRates: {\n        'Depression': 85,\n        'Anxiety': 90,\n        'PTSD': 78,\n      },\n      yearsOfExperience: 8,\n      languagesOffered: ['English', 'Filipino'],\n      acceptsInsurance: true,\n      acceptedInsuranceTypes: ['PhilHealth', 'HMO'],\n      createdAt: new Date(),\n      updatedAt: new Date(),\n      user: {\n        firstName: 'Dr. Jane',\n        lastName: 'Smith',\n        avatarUrl: 'https://example.com/therapist-avatar.jpg',\n      },\n      reviews: [\n        {\n          rating: 5,\n          status: 'APPROVED',\n        },\n        {\n          rating: 4,\n          status: 'APPROVED',\n        },\n      ],\n    },\n    totalScore: 85,\n    breakdown: {\n      conditionScore: 80,\n      approachScore: 85,\n      experienceScore: 90,\n      reviewScore: 88,\n      logisticsScore: 92,\n    },\n    matchExplanation: {\n      primaryMatches: ['Depression', 'Anxiety'],\n      secondaryMatches: ['PTSD'],\n      approachMatches: ['CBT'],\n      experienceYears: 8,\n      averageRating: 4.5,\n      totalReviews: 2,\n      successRates: {\n        'Depression': 85,\n        'Anxiety': 90,\n      },\n    },\n  };\n\n  const mockCompatibilityAnalysis: CompatibilityAnalysis = {\n    personalityCompatibility: {\n      communicationStyle: 85,\n      personalityMatch: 80,\n      culturalCompatibility: 90,\n      overallCompatibility: 85,\n    },\n    sessionCompatibility: {\n      formatMatch: 90,\n      durationMatch: 85,\n      frequencyMatch: 80,\n      schedulingCompatibility: 88,\n      overallCompatibility: 86,\n    },\n    demographicCompatibility: {\n      ageCompatibility: 75,\n      genderCompatibility: 80,\n      languageCompatibility: 95,\n      culturalCompatibility: 88,\n      overallCompatibility: 85,\n    },\n    overallCompatibilityScore: 85,\n    compatibilityFactors: {\n      strengths: ['Excellent communication style match', 'Strong personality compatibility'],\n      concerns: ['Minor age preference difference'],\n      recommendations: ['Consider discussing communication preferences in initial session'],\n    },\n  };\n\n  const mockMatchHistory = [\n    {\n      id: 'match-1',\n      clientId: 'client-123',\n      therapistId: 'therapist-user-123',\n      totalScore: 85,\n      conditionScore: 80,\n      approachScore: 85,\n      experienceScore: 90,\n      reviewScore: 88,\n      logisticsScore: 92,\n      primaryMatches: ['Depression', 'Anxiety'],\n      secondaryMatches: ['PTSD'],\n      approachMatches: ['CBT'],\n      recommendationRank: 1,\n      totalRecommendations: 3,\n      recommendationAlgorithm: 'advanced_v1.0',\n      wasViewed: true,\n      wasContacted: false,\n      becameClient: true,\n      clientSatisfactionScore: 4.5,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    },\n    {\n      id: 'match-2',\n      clientId: 'client-123',\n      therapistId: 'therapist-user-456',\n      totalScore: 78,\n      conditionScore: 75,\n      approachScore: 80,\n      experienceScore: 85,\n      reviewScore: 82,\n      logisticsScore: 88,\n      primaryMatches: ['Depression'],\n      secondaryMatches: ['Anxiety'],\n      approachMatches: ['CBT'],\n      recommendationRank: 2,\n      totalRecommendations: 3,\n      recommendationAlgorithm: 'advanced_v1.0',\n      wasViewed: false,\n      wasContacted: false,\n      becameClient: false,\n      clientSatisfactionScore: null,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    },\n  ];\n\n  const mockFeedback = [\n    {\n      id: 'feedback-1',\n      clientId: 'client-123',\n      therapistId: 'therapist-user-123',\n      matchHistoryId: 'match-1',\n      relevanceScore: 4.5,\n      accuracyScore: 4.0,\n      helpfulnessScore: 4.8,\n      overallSatisfaction: 4.4,\n      feedbackText: 'Great recommendation!',\n      selectedTherapist: true,\n      reasonNotSelected: null,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    },\n  ];\n\n  beforeEach(async () => {\n    const module: TestingModule = await Test.createTestingModule({\n      providers: [\n        MatchingAnalyticsService,\n        {\n          provide: PrismaService,\n          useValue: {\n            matchHistory: {\n              createMany: jest.fn(),\n              updateMany: jest.fn(),\n              findMany: jest.fn(),\n              findFirst: jest.fn(),\n              groupBy: jest.fn(),\n            },\n            clientCompatibility: {\n              upsert: jest.fn(),\n            },\n            recommendationFeedback: {\n              create: jest.fn(),\n              findMany: jest.fn(),\n            },\n            algorithmPerformance: {\n              create: jest.fn(),\n            },\n            therapist: {\n              findUnique: jest.fn(),\n            },\n          },\n        },\n      ],\n    }).compile();\n\n    service = module.get<MatchingAnalyticsService>(MatchingAnalyticsService);\n    prismaService = module.get(PrismaService);\n  });\n\n  afterEach(() => {\n    jest.clearAllMocks();\n  });\n\n  it('should be defined', () => {\n    expect(service).toBeDefined();\n  });\n\n  describe('trackRecommendation', () => {\n    it('should track multiple therapist recommendations successfully', async () => {\n      const therapistScores = [mockTherapistScore];\n      prismaService.matchHistory.createMany.mockResolvedValue({\n        count: 1,\n        skipDuplicates: true,\n      });\n\n      await service.trackRecommendation('client-123', therapistScores, 'advanced_v1.0');\n\n      expect(prismaService.matchHistory.createMany).toHaveBeenCalledWith({\n        data: [\n          {\n            clientId: 'client-123',\n            therapistId: 'therapist-user-123',\n            totalScore: 85,\n            conditionScore: 80,\n            approachScore: 85,\n            experienceScore: 90,\n            reviewScore: 88,\n            logisticsScore: 92,\n            primaryMatches: ['Depression', 'Anxiety'],\n            secondaryMatches: ['PTSD'],\n            approachMatches: ['CBT'],\n            recommendationRank: 1,\n            totalRecommendations: 1,\n            recommendationAlgorithm: 'advanced_v1.0',\n          },\n        ],\n        skipDuplicates: true,\n      });\n    });\n\n    it('should use default algorithm version when not provided', async () => {\n      const therapistScores = [mockTherapistScore];\n      prismaService.matchHistory.createMany.mockResolvedValue({\n        count: 1,\n        skipDuplicates: true,\n      });\n\n      await service.trackRecommendation('client-123', therapistScores);\n\n      expect(prismaService.matchHistory.createMany).toHaveBeenCalledWith({\n        data: expect.arrayContaining([\n          expect.objectContaining({\n            recommendationAlgorithm: 'advanced_v1.0',\n          }),\n        ]),\n        skipDuplicates: true,\n      });\n    });\n\n    it('should handle database errors gracefully', async () => {\n      const therapistScores = [mockTherapistScore];\n      prismaService.matchHistory.createMany.mockRejectedValue(new Error('Database error'));\n\n      // Should not throw error\n      await expect(service.trackRecommendation('client-123', therapistScores)).resolves.not.toThrow();\n    });\n\n    it('should track recommendation rank correctly for multiple therapists', async () => {\n      const therapistScores = [mockTherapistScore, mockTherapistScore];\n      prismaService.matchHistory.createMany.mockResolvedValue({\n        count: 2,\n        skipDuplicates: true,\n      });\n\n      await service.trackRecommendation('client-123', therapistScores);\n\n      expect(prismaService.matchHistory.createMany).toHaveBeenCalledWith({\n        data: [\n          expect.objectContaining({\n            recommendationRank: 1,\n            totalRecommendations: 2,\n          }),\n          expect.objectContaining({\n            recommendationRank: 2,\n            totalRecommendations: 2,\n          }),\n        ],\n        skipDuplicates: true,\n      });\n    });\n  });\n\n  describe('trackCompatibilityAnalysis', () => {\n    it('should track compatibility analysis successfully', async () => {\n      prismaService.clientCompatibility.upsert.mockResolvedValue({\n        id: 'compatibility-1',\n        clientId: 'client-123',\n        therapistId: 'therapist-user-123',\n        personalityCompatibility: 85,\n        sessionCompatibility: 86,\n        demographicCompatibility: 85,\n        overallCompatibility: 85,\n      });\n\n      await service.trackCompatibilityAnalysis(\n        'client-123',\n        'therapist-user-123',\n        mockCompatibilityAnalysis,\n        '1.0',\n      );\n\n      expect(prismaService.clientCompatibility.upsert).toHaveBeenCalledWith({\n        where: {\n          clientId_therapistId: {\n            clientId: 'client-123',\n            therapistId: 'therapist-user-123',\n          },\n        },\n        update: expect.objectContaining({\n          personalityCompatibility: 85,\n          sessionCompatibility: 86,\n          demographicCompatibility: 85,\n          overallCompatibility: 85,\n          communicationStyleScore: 85,\n          personalityMatchScore: 80,\n          culturalCompatibilityScore: 90,\n          formatMatchScore: 90,\n          durationMatchScore: 85,\n          frequencyMatchScore: 80,\n          schedulingCompatibilityScore: 88,\n          ageCompatibilityScore: 75,\n          genderCompatibilityScore: 80,\n          languageCompatibilityScore: 95,\n          strengths: ['Excellent communication style match', 'Strong personality compatibility'],\n          concerns: ['Minor age preference difference'],\n          recommendations: ['Consider discussing communication preferences in initial session'],\n          analysisVersion: '1.0',\n        }),\n        create: expect.objectContaining({\n          clientId: 'client-123',\n          therapistId: 'therapist-user-123',\n          personalityCompatibility: 85,\n          sessionCompatibility: 86,\n          demographicCompatibility: 85,\n          overallCompatibility: 85,\n          analysisVersion: '1.0',\n        }),\n      });\n    });\n\n    it('should use default analysis version when not provided', async () => {\n      prismaService.clientCompatibility.upsert.mockResolvedValue({});\n\n      await service.trackCompatibilityAnalysis(\n        'client-123',\n        'therapist-user-123',\n        mockCompatibilityAnalysis,\n      );\n\n      expect(prismaService.clientCompatibility.upsert).toHaveBeenCalledWith({\n        where: expect.any(Object),\n        update: expect.objectContaining({\n          analysisVersion: '1.0',\n        }),\n        create: expect.objectContaining({\n          analysisVersion: '1.0',\n        }),\n      });\n    });\n\n    it('should handle database errors gracefully', async () => {\n      prismaService.clientCompatibility.upsert.mockRejectedValue(new Error('Database error'));\n\n      // Should not throw error\n      await expect(\n        service.trackCompatibilityAnalysis(\n          'client-123',\n          'therapist-user-123',\n          mockCompatibilityAnalysis,\n        ),\n      ).resolves.not.toThrow();\n    });\n  });\n\n  describe('trackRecommendationView', () => {\n    it('should track recommendation view successfully', async () => {\n      prismaService.matchHistory.updateMany.mockResolvedValue({ count: 1 });\n\n      await service.trackRecommendationView('client-123', 'therapist-user-123');\n\n      expect(prismaService.matchHistory.updateMany).toHaveBeenCalledWith({\n        where: {\n          clientId: 'client-123',\n          therapistId: 'therapist-user-123',\n          wasViewed: false,\n        },\n        data: {\n          wasViewed: true,\n          updatedAt: expect.any(Date),\n        },\n      });\n    });\n\n    it('should handle database errors gracefully', async () => {\n      prismaService.matchHistory.updateMany.mockRejectedValue(new Error('Database error'));\n\n      // Should not throw error\n      await expect(\n        service.trackRecommendationView('client-123', 'therapist-user-123'),\n      ).resolves.not.toThrow();\n    });\n  });\n\n  describe('trackTherapistContact', () => {\n    it('should track therapist contact successfully', async () => {\n      prismaService.matchHistory.updateMany.mockResolvedValue({ count: 1 });\n\n      await service.trackTherapistContact('client-123', 'therapist-user-123');\n\n      expect(prismaService.matchHistory.updateMany).toHaveBeenCalledWith({\n        where: {\n          clientId: 'client-123',\n          therapistId: 'therapist-user-123',\n          wasContacted: false,\n        },\n        data: {\n          wasContacted: true,\n          updatedAt: expect.any(Date),\n        },\n      });\n    });\n\n    it('should handle database errors gracefully', async () => {\n      prismaService.matchHistory.updateMany.mockRejectedValue(new Error('Database error'));\n\n      // Should not throw error\n      await expect(\n        service.trackTherapistContact('client-123', 'therapist-user-123'),\n      ).resolves.not.toThrow();\n    });\n  });\n\n  describe('trackSuccessfulMatch', () => {\n    it('should track successful match successfully', async () => {\n      prismaService.matchHistory.updateMany.mockResolvedValue({ count: 1 });\n\n      await service.trackSuccessfulMatch('client-123', 'therapist-user-123');\n\n      expect(prismaService.matchHistory.updateMany).toHaveBeenCalledWith({\n        where: {\n          clientId: 'client-123',\n          therapistId: 'therapist-user-123',\n          becameClient: false,\n        },\n        data: {\n          becameClient: true,\n          updatedAt: expect.any(Date),\n        },\n      });\n    });\n\n    it('should handle database errors gracefully', async () => {\n      prismaService.matchHistory.updateMany.mockRejectedValue(new Error('Database error'));\n\n      // Should not throw error\n      await expect(\n        service.trackSuccessfulMatch('client-123', 'therapist-user-123'),\n      ).resolves.not.toThrow();\n    });\n  });\n\n  describe('recordRecommendationFeedback', () => {\n    it('should record feedback successfully', async () => {\n      const feedback = {\n        relevanceScore: 4.5,\n        accuracyScore: 4.0,\n        helpfulnessScore: 4.8,\n        feedbackText: 'Great recommendation!',\n        selectedTherapist: true,\n        reasonNotSelected: null,\n      };\n\n      prismaService.matchHistory.findFirst.mockResolvedValue(mockMatchHistory[0]);\n      prismaService.recommendationFeedback.create.mockResolvedValue({\n        id: 'feedback-1',\n        ...feedback,\n      });\n\n      await service.recordRecommendationFeedback('client-123', 'therapist-user-123', feedback);\n\n      expect(prismaService.matchHistory.findFirst).toHaveBeenCalledWith({\n        where: { clientId: 'client-123', therapistId: 'therapist-user-123' },\n        orderBy: { createdAt: 'desc' },\n      });\n\n      expect(prismaService.recommendationFeedback.create).toHaveBeenCalledWith({\n        data: {\n          clientId: 'client-123',\n          therapistId: 'therapist-user-123',\n          matchHistoryId: 'match-1',\n          relevanceScore: 4.5,\n          accuracyScore: 4.0,\n          helpfulnessScore: 4.8,\n          feedbackText: 'Great recommendation!',\n          selectedTherapist: true,\n          reasonNotSelected: null,\n        },\n      });\n    });\n\n    it('should handle feedback without matching history', async () => {\n      const feedback = {\n        relevanceScore: 4.5,\n        accuracyScore: 4.0,\n        helpfulnessScore: 4.8,\n      };\n\n      prismaService.matchHistory.findFirst.mockResolvedValue(null);\n      prismaService.recommendationFeedback.create.mockResolvedValue({\n        id: 'feedback-1',\n        ...feedback,\n      });\n\n      await service.recordRecommendationFeedback('client-123', 'therapist-user-123', feedback);\n\n      expect(prismaService.recommendationFeedback.create).toHaveBeenCalledWith({\n        data: {\n          clientId: 'client-123',\n          therapistId: 'therapist-user-123',\n          matchHistoryId: null,\n          relevanceScore: 4.5,\n          accuracyScore: 4.0,\n          helpfulnessScore: 4.8,\n          feedbackText: undefined,\n          selectedTherapist: false,\n          reasonNotSelected: undefined,\n        },\n      });\n    });\n\n    it('should handle database errors gracefully', async () => {\n      const feedback = {\n        relevanceScore: 4.5,\n        accuracyScore: 4.0,\n        helpfulnessScore: 4.8,\n      };\n\n      prismaService.matchHistory.findFirst.mockRejectedValue(new Error('Database error'));\n\n      // Should not throw error\n      await expect(\n        service.recordRecommendationFeedback('client-123', 'therapist-user-123', feedback),\n      ).resolves.not.toThrow();\n    });\n  });\n\n  describe('getAlgorithmPerformance', () => {\n    it('should calculate algorithm performance metrics correctly', async () => {\n      const startDate = new Date('2023-01-01');\n      const endDate = new Date('2023-12-31');\n\n      prismaService.matchHistory.findMany.mockResolvedValue(mockMatchHistory);\n      prismaService.recommendationFeedback.findMany.mockResolvedValue(mockFeedback);\n\n      const result = await service.getAlgorithmPerformance('advanced_v1.0', startDate, endDate);\n\n      expect(result).toEqual({\n        totalRecommendations: 2,\n        successfulMatches: 1,\n        averageMatchScore: 81.5, // (85 + 78) / 2\n        averageSatisfactionScore: 4.4,\n        clickThroughRate: 50, // 1 viewed out of 2 recommendations\n        conversionRate: 50, // 1 successful match out of 2 recommendations\n        retentionRate: 0, // Placeholder\n      });\n\n      expect(prismaService.matchHistory.findMany).toHaveBeenCalledWith({\n        where: {\n          recommendationAlgorithm: 'advanced_v1.0',\n          createdAt: {\n            gte: startDate,\n            lte: endDate,\n          },\n        },\n      });\n\n      expect(prismaService.recommendationFeedback.findMany).toHaveBeenCalledWith({\n        where: {\n          createdAt: {\n            gte: startDate,\n            lte: endDate,\n          },\n          overallSatisfaction: {\n            not: null,\n          },\n        },\n      });\n    });\n\n    it('should handle empty data gracefully', async () => {\n      const startDate = new Date('2023-01-01');\n      const endDate = new Date('2023-12-31');\n\n      prismaService.matchHistory.findMany.mockResolvedValue([]);\n      prismaService.recommendationFeedback.findMany.mockResolvedValue([]);\n\n      const result = await service.getAlgorithmPerformance('advanced_v1.0', startDate, endDate);\n\n      expect(result).toEqual({\n        totalRecommendations: 0,\n        successfulMatches: 0,\n        averageMatchScore: 0,\n        averageSatisfactionScore: 0,\n        clickThroughRate: 0,\n        conversionRate: 0,\n        retentionRate: 0,\n      });\n    });\n\n    it('should handle database errors by throwing', async () => {\n      const startDate = new Date('2023-01-01');\n      const endDate = new Date('2023-12-31');\n\n      prismaService.matchHistory.findMany.mockRejectedValue(new Error('Database error'));\n\n      await expect(\n        service.getAlgorithmPerformance('advanced_v1.0', startDate, endDate),\n      ).rejects.toThrow('Database error');\n    });\n  });\n\n  describe('storePerformanceSnapshot', () => {\n    it('should store performance snapshot successfully', async () => {\n      const metrics = {\n        totalRecommendations: 100,\n        successfulMatches: 25,\n        averageMatchScore: 82.5,\n        averageSatisfactionScore: 4.2,\n        clickThroughRate: 75,\n        conversionRate: 25,\n        retentionRate: 80,\n      };\n\n      const periodStart = new Date('2023-01-01');\n      const periodEnd = new Date('2023-01-31');\n\n      prismaService.algorithmPerformance.create.mockResolvedValue({\n        id: 'performance-1',\n        algorithmName: 'advanced_v1.0',\n        version: '1.0',\n        ...metrics,\n        periodStart,\n        periodEnd,\n      });\n\n      await service.storePerformanceSnapshot('advanced_v1.0', '1.0', metrics, periodStart, periodEnd);\n\n      expect(prismaService.algorithmPerformance.create).toHaveBeenCalledWith({\n        data: {\n          algorithmName: 'advanced_v1.0',\n          version: '1.0',\n          totalRecommendations: 100,\n          successfulMatches: 25,\n          averageMatchScore: 82.5,\n          averageSatisfactionScore: 4.2,\n          clickThroughRate: 75,\n          conversionRate: 25,\n          retentionRate: 80,\n          periodStart,\n          periodEnd,\n        },\n      });\n    });\n\n    it('should handle database errors gracefully', async () => {\n      const metrics = {\n        totalRecommendations: 100,\n        successfulMatches: 25,\n        averageMatchScore: 82.5,\n        averageSatisfactionScore: 4.2,\n        clickThroughRate: 75,\n        conversionRate: 25,\n        retentionRate: 80,\n      };\n\n      prismaService.algorithmPerformance.create.mockRejectedValue(new Error('Database error'));\n\n      // Should not throw error\n      await expect(\n        service.storePerformanceSnapshot('advanced_v1.0', '1.0', metrics, new Date(), new Date()),\n      ).resolves.not.toThrow();\n    });\n  });\n\n  describe('getTopPerformingTherapists', () => {\n    it('should get top performing therapists successfully', async () => {\n      const mockGroupByResults = [\n        {\n          therapistId: 'therapist-user-123',\n          _count: { id: 5 },\n          _avg: { totalScore: 85, clientSatisfactionScore: 4.5 },\n        },\n        {\n          therapistId: 'therapist-user-456',\n          _count: { id: 3 },\n          _avg: { totalScore: 82, clientSatisfactionScore: 4.2 },\n        },\n      ];\n\n      const mockTherapist = {\n        id: 'therapist-123',\n        userId: 'therapist-user-123',\n        user: {\n          firstName: 'Dr. Jane',\n          lastName: 'Smith',\n        },\n      };\n\n      prismaService.matchHistory.groupBy.mockResolvedValue(mockGroupByResults);\n      prismaService.therapist.findUnique.mockResolvedValue(mockTherapist);\n\n      const result = await service.getTopPerformingTherapists(10);\n\n      expect(result).toEqual([\n        {\n          therapist: mockTherapist,\n          successfulMatches: 5,\n          averageMatchScore: 85,\n          averageSatisfactionScore: 4.5,\n        },\n        {\n          therapist: mockTherapist,\n          successfulMatches: 3,\n          averageMatchScore: 82,\n          averageSatisfactionScore: 4.2,\n        },\n      ]);\n\n      expect(prismaService.matchHistory.groupBy).toHaveBeenCalledWith({\n        by: ['therapistId'],\n        where: {\n          becameClient: true,\n        },\n        _count: {\n          id: true,\n        },\n        _avg: {\n          totalScore: true,\n          clientSatisfactionScore: true,\n        },\n        orderBy: {\n          _count: {\n            id: 'desc',\n          },\n        },\n        take: 10,\n      });\n    });\n\n    it('should filter by date range when provided', async () => {\n      const startDate = new Date('2023-01-01');\n      const endDate = new Date('2023-12-31');\n\n      prismaService.matchHistory.groupBy.mockResolvedValue([]);\n\n      await service.getTopPerformingTherapists(10, startDate, endDate);\n\n      expect(prismaService.matchHistory.groupBy).toHaveBeenCalledWith({\n        by: ['therapistId'],\n        where: {\n          becameClient: true,\n          createdAt: {\n            gte: startDate,\n            lte: endDate,\n          },\n        },\n        _count: {\n          id: true,\n        },\n        _avg: {\n          totalScore: true,\n          clientSatisfactionScore: true,\n        },\n        orderBy: {\n          _count: {\n            id: 'desc',\n          },\n        },\n        take: 10,\n      });\n    });\n\n    it('should handle database errors by throwing', async () => {\n      prismaService.matchHistory.groupBy.mockRejectedValue(new Error('Database error'));\n\n      await expect(service.getTopPerformingTherapists(10)).rejects.toThrow('Database error');\n    });\n  });\n\n  describe('getMatchingInsights', () => {\n    it('should get matching insights successfully', async () => {\n      const startDate = new Date('2023-01-01');\n      const endDate = new Date('2023-12-31');\n\n      const mockConditionMatches = [\n        {\n          primaryMatches: ['Depression'],\n          secondaryMatches: ['Anxiety'],\n          totalScore: 85,\n        },\n      ];\n\n      const mockApproachMatches = [\n        {\n          approachMatches: ['CBT'],\n          totalScore: 85,\n        },\n      ];\n\n      const mockScoreDistribution = [\n        {\n          totalScore: 85,\n          _count: { id: 5 },\n        },\n        {\n          totalScore: 78,\n          _count: { id: 3 },\n        },\n      ];\n\n      prismaService.matchHistory.findMany\n        .mockResolvedValueOnce(mockConditionMatches)\n        .mockResolvedValueOnce(mockApproachMatches);\n\n      prismaService.matchHistory.groupBy.mockResolvedValue(mockScoreDistribution);\n\n      const result = await service.getMatchingInsights(startDate, endDate);\n\n      expect(result).toEqual({\n        conditionMatches: mockConditionMatches,\n        approachMatches: mockApproachMatches,\n        scoreDistribution: mockScoreDistribution,\n      });\n\n      // Verify condition matches query\n      expect(prismaService.matchHistory.findMany).toHaveBeenCalledWith({\n        where: {\n          becameClient: true,\n          createdAt: {\n            gte: startDate,\n            lte: endDate,\n          },\n        },\n        select: {\n          primaryMatches: true,\n          secondaryMatches: true,\n          totalScore: true,\n        },\n      });\n\n      // Verify approach matches query\n      expect(prismaService.matchHistory.findMany).toHaveBeenCalledWith({\n        where: {\n          becameClient: true,\n          createdAt: {\n            gte: startDate,\n            lte: endDate,\n          },\n        },\n        select: {\n          approachMatches: true,\n          totalScore: true,\n        },\n      });\n\n      // Verify score distribution query\n      expect(prismaService.matchHistory.groupBy).toHaveBeenCalledWith({\n        by: ['totalScore'],\n        where: {\n          createdAt: {\n            gte: startDate,\n            lte: endDate,\n          },\n        },\n        _count: {\n          id: true,\n        },\n        orderBy: {\n          totalScore: 'asc',\n        },\n      });\n    });\n\n    it('should handle database errors by throwing', async () => {\n      const startDate = new Date('2023-01-01');\n      const endDate = new Date('2023-12-31');\n\n      prismaService.matchHistory.findMany.mockRejectedValue(new Error('Database error'));\n\n      await expect(service.getMatchingInsights(startDate, endDate)).rejects.toThrow('Database error');\n    });\n  });\n\n  describe('integration tests', () => {\n    it('should handle complete analytics workflow', async () => {\n      const clientId = 'client-123';\n      const therapistId = 'therapist-user-123';\n      const therapistScores = [mockTherapistScore];\n\n      // Mock all database operations\n      prismaService.matchHistory.createMany.mockResolvedValue({ count: 1 });\n      prismaService.clientCompatibility.upsert.mockResolvedValue({});\n      prismaService.matchHistory.updateMany.mockResolvedValue({ count: 1 });\n      prismaService.matchHistory.findFirst.mockResolvedValue(mockMatchHistory[0]);\n      prismaService.recommendationFeedback.create.mockResolvedValue({});\n\n      // Track recommendation\n      await service.trackRecommendation(clientId, therapistScores);\n\n      // Track compatibility analysis\n      await service.trackCompatibilityAnalysis(clientId, therapistId, mockCompatibilityAnalysis);\n\n      // Track user interactions\n      await service.trackRecommendationView(clientId, therapistId);\n      await service.trackTherapistContact(clientId, therapistId);\n      await service.trackSuccessfulMatch(clientId, therapistId);\n\n      // Record feedback\n      await service.recordRecommendationFeedback(clientId, therapistId, {\n        relevanceScore: 4.5,\n        accuracyScore: 4.0,\n        helpfulnessScore: 4.8,\n      });\n\n      // Verify all operations were called\n      expect(prismaService.matchHistory.createMany).toHaveBeenCalled();\n      expect(prismaService.clientCompatibility.upsert).toHaveBeenCalled();\n      expect(prismaService.matchHistory.updateMany).toHaveBeenCalledTimes(3);\n      expect(prismaService.recommendationFeedback.create).toHaveBeenCalled();\n    });\n\n    it('should handle performance metrics calculation accurately', async () => {\n      const startDate = new Date('2023-01-01');\n      const endDate = new Date('2023-12-31');\n\n      // Setup comprehensive mock data\n      const comprehensiveMatchHistory = [\n        { ...mockMatchHistory[0], wasViewed: true, wasContacted: true, becameClient: true },\n        { ...mockMatchHistory[1], wasViewed: true, wasContacted: false, becameClient: false },\n        { ...mockMatchHistory[1], wasViewed: false, wasContacted: false, becameClient: false },\n      ];\n\n      prismaService.matchHistory.findMany.mockResolvedValue(comprehensiveMatchHistory);\n      prismaService.recommendationFeedback.findMany.mockResolvedValue([\n        { ...mockFeedback[0], overallSatisfaction: 4.5 },\n        { ...mockFeedback[0], overallSatisfaction: 4.0 },\n      ]);\n\n      const result = await service.getAlgorithmPerformance('advanced_v1.0', startDate, endDate);\n\n      expect(result.totalRecommendations).toBe(3);\n      expect(result.successfulMatches).toBe(1);\n      expect(result.clickThroughRate).toBe(66.67); // 2 viewed out of 3\n      expect(result.conversionRate).toBe(33.33); // 1 successful out of 3\n      expect(result.averageSatisfactionScore).toBe(4.25); // (4.5 + 4.0) / 2\n    });\n  });\n});"],"version":3}