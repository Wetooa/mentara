{"file":"/home/wetooa/Documents/code/projects/mentara/mentara-api/src/auth/auth.controller.ts","mappings":";;;;;;;;;;;;;;;AAAA,2CAQwB;AACxB,iDAA6C;AAC7C,kEAA6D;AAC7D,wFAAyE;AACzE,iDAA6C;AAC7C,4CAAwE;AAGjE,IAAM,cAAc,GAApB,MAAM,cAAc;IACI;IAA7B,YAA6B,WAAwB;QAAxB,gBAAW,GAAX,WAAW,CAAa;IAAG,CAAC;IAMnD,AAAN,KAAK,CAAC,cAAc,CACD,EAAU,EACnB,eAAgC;QAExC,OAAO,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,CAAC,EAAE,EAAE,eAAe,CAAC,CAAC;IACpE,CAAC;IAMK,AAAN,KAAK,CAAC,iBAAiB,CACJ,EAAU,EACnB,oBAAwC;QAEhD,OAAO,MAAM,IAAI,CAAC,WAAW,CAAC,iBAAiB,CAAC,EAAE,EAAE,oBAAoB,CAAC,CAAC;IAC5E,CAAC;IAIK,AAAN,KAAK,CAAC,KAAK,CAAkB,EAAU;QACrC,OAAO,MAAM,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;IAC5C,CAAC;IAIK,AAAN,KAAK,CAAC,WAAW;QACf,OAAO,MAAM,IAAI,CAAC,WAAW,CAAC,QAAQ,EAAE,CAAC;IAC3C,CAAC;IAMK,AAAN,KAAK,CAAC,WAAW,CAAkB,EAAU;QAC3C,OAAO,MAAM,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC;IAChD,CAAC;CACF,CAAA;AA5CY,wCAAc;AAOnB;IAJL,IAAA,kBAAS,EAAC,iCAAc,CAAC;IACzB,IAAA,oBAAQ,EAAC,EAAE,OAAO,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,GAAG,EAAE,MAAM,EAAE,EAAE,CAAC,CAAC,gCAAgC;;IACjF,IAAA,aAAI,EAAC,iBAAiB,CAAC;IACvB,IAAA,iBAAQ,EAAC,mBAAU,CAAC,OAAO,CAAC;IAE1B,WAAA,IAAA,yCAAa,GAAE,CAAA;IACf,WAAA,IAAA,aAAI,GAAE,CAAA;;6CAAkB,sBAAe;;oDAGzC;AAMK;IAJL,IAAA,kBAAS,EAAC,iCAAc,CAAC;IACzB,IAAA,oBAAQ,EAAC,EAAE,OAAO,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,GAAG,EAAE,MAAM,EAAE,EAAE,CAAC,CAAC,2CAA2C;;IAC5F,IAAA,aAAI,EAAC,oBAAoB,CAAC;IAC1B,IAAA,iBAAQ,EAAC,mBAAU,CAAC,OAAO,CAAC;IAE1B,WAAA,IAAA,yCAAa,GAAE,CAAA;IACf,WAAA,IAAA,aAAI,GAAE,CAAA;;6CAAuB,yBAAkB;;uDAGjD;AAIK;IAFL,IAAA,kBAAS,EAAC,iCAAc,CAAC;IACzB,IAAA,YAAG,EAAC,IAAI,CAAC;IACG,WAAA,IAAA,yCAAa,GAAE,CAAA;;;;2CAE3B;AAIK;IAFL,IAAA,kBAAS,EAAC,iCAAc,CAAC;IACzB,IAAA,YAAG,EAAC,OAAO,CAAC;;;;iDAGZ;AAMK;IAJL,IAAA,kBAAS,EAAC,iCAAc,CAAC;IACzB,IAAA,oBAAQ,EAAC,EAAE,OAAO,EAAE,EAAE,KAAK,EAAE,EAAE,EAAE,GAAG,EAAE,MAAM,EAAE,EAAE,CAAC,CAAC,mCAAmC;;IACrF,IAAA,aAAI,EAAC,cAAc,CAAC;IACpB,IAAA,iBAAQ,EAAC,mBAAU,CAAC,EAAE,CAAC;IACL,WAAA,IAAA,yCAAa,GAAE,CAAA;;;;iDAEjC;yBA3CU,cAAc;IAD1B,IAAA,mBAAU,EAAC,MAAM,CAAC;qCAEyB,0BAAW;GAD1C,cAAc,CA4C1B","names":[],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/auth/auth.controller.ts"],"sourcesContent":["import {\n  Body,\n  Controller,\n  Get,\n  HttpCode,\n  HttpStatus,\n  Post,\n  UseGuards,\n} from '@nestjs/common';\nimport { Throttle } from '@nestjs/throttler';\nimport { ClerkAuthGuard } from 'src/guards/clerk-auth.guard';\nimport { CurrentUserId } from 'src/decorators/current-user-id.decorator';\nimport { AuthService } from './auth.service';\nimport { ClientCreateDto, TherapistCreateDto } from '../../schema/auth';\n\n@Controller('auth')\nexport class AuthController {\n  constructor(private readonly authService: AuthService) {}\n\n  @UseGuards(ClerkAuthGuard)\n  @Throttle({ default: { limit: 5, ttl: 300000 } }) // 5 registrations per 5 minutes\n  @Post('register/client')\n  @HttpCode(HttpStatus.CREATED)\n  async registerClient(\n    @CurrentUserId() id: string,\n    @Body() registerUserDto: ClientCreateDto,\n  ) {\n    return await this.authService.registerClient(id, registerUserDto);\n  }\n\n  @UseGuards(ClerkAuthGuard)\n  @Throttle({ default: { limit: 3, ttl: 600000 } }) // 3 therapist registrations per 10 minutes\n  @Post('register/therapist')\n  @HttpCode(HttpStatus.CREATED)\n  async registerTherapist(\n    @CurrentUserId() id: string,\n    @Body() registerTherapistDto: TherapistCreateDto,\n  ) {\n    return await this.authService.registerTherapist(id, registerTherapistDto);\n  }\n\n  @UseGuards(ClerkAuthGuard)\n  @Get('me')\n  async getMe(@CurrentUserId() id: string) {\n    return await this.authService.getUser(id);\n  }\n\n  @UseGuards(ClerkAuthGuard)\n  @Get('users')\n  async getAllUsers() {\n    return await this.authService.getUsers();\n  }\n\n  @UseGuards(ClerkAuthGuard)\n  @Throttle({ default: { limit: 20, ttl: 300000 } }) // 20 logout attempts per 5 minutes\n  @Post('force-logout')\n  @HttpCode(HttpStatus.OK)\n  async forceLogout(@CurrentUserId() id: string) {\n    return await this.authService.forceLogout(id);\n  }\n}\n"],"version":3}