{"file":"/home/wetooa/Documents/code/projects/mentara/mentara-api/src/auth/controllers/moderator-auth.controller.spec.ts","mappings":"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","names":[],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/auth/controllers/moderator-auth.controller.spec.ts"],"sourcesContent":["import { Test, TestingModule } from '@nestjs/testing';\nimport { \n  UnauthorizedException, \n  BadRequestException, \n  ForbiddenException \n} from '@nestjs/common';\nimport { ThrottlerGuard, ThrottlerModule } from '@nestjs/throttler';\nimport { ModeratorAuthController } from './moderator-auth.controller';\nimport { ModeratorAuthService } from '../../services/auth/moderator-auth.service';\nimport { JwtAuthGuard } from '../guards/jwt-auth.guard';\nimport { ZodValidationPipe } from '../../common/pipes/zod-validation.pipe';\nimport {\n  MockBuilder,\n  TestDataGenerator,\n  TestAssertions,\n  SecurityGuardTestUtils,\n  RoleBasedTestUtils,\n  TEST_USER_IDS,\n  TEST_EMAILS,\n  TEST_COMMUNITY_IDS,\n} from '../../test-utils/auth-testing-helpers';\n\ndescribe('ModeratorAuthController', () => {\n  let controller: ModeratorAuthController;\n  let moderatorAuthService: ModeratorAuthService;\n  let mockJwtAuthGuard: jest.Mocked<JwtAuthGuard>;\n\n  // Test data constants\n  const mockModeratorUser = {\n    id: TEST_USER_IDS.MODERATOR,\n    email: TEST_EMAILS.MODERATOR,\n    firstName: 'Jane',\n    lastName: 'Moderator',\n    role: 'moderator',\n    emailVerified: true,\n    permissions: ['moderate_posts', 'ban_users', 'delete_comments'],\n    assignedCommunities: [TEST_COMMUNITY_IDS.ANXIETY_SUPPORT, TEST_COMMUNITY_IDS.DEPRESSION_HELP],\n    createdAt: new Date(),\n    lastLoginAt: new Date(),\n  };\n\n  const mockTokens = {\n    accessToken: 'mock-access-token',\n    refreshToken: 'mock-refresh-token',\n    expiresIn: 3600,\n  };\n\n  const mockCreateAccountResult = {\n    user: mockModeratorUser,\n    message: 'Moderator account created successfully',\n  };\n\n  const mockLoginResult = {\n    user: mockModeratorUser,\n    tokens: mockTokens,\n  };\n\n  const mockPermissions = {\n    permissions: ['moderate_posts', 'ban_users', 'delete_comments'],\n    canModeratePosts: true,\n    canBanUsers: true,\n    canDeleteComments: true,\n    canAccessReports: true,\n  };\n\n  const mockAssignedCommunities = {\n    assignedCommunities: [\n      {\n        id: TEST_COMMUNITY_IDS.ANXIETY_SUPPORT,\n        name: 'Anxiety Support',\n        description: 'A supportive community for anxiety management',\n        memberCount: 150,\n        pendingPosts: 5,\n      },\n      {\n        id: TEST_COMMUNITY_IDS.DEPRESSION_HELP,\n        name: 'Depression Help',\n        description: 'Support for depression recovery',\n        memberCount: 120,\n        pendingPosts: 3,\n      },\n    ],\n  };\n\n  const mockDashboardStats = {\n    totalPostsModerated: 45,\n    pendingReports: 8,\n    communitiesManaged: 2,\n    usersModerated: 12,\n    recentActivity: [\n      {\n        action: 'post_moderated',\n        timestamp: new Date().toISOString(),\n        communityId: TEST_COMMUNITY_IDS.ANXIETY_SUPPORT,\n      },\n      {\n        action: 'user_banned',\n        timestamp: new Date().toISOString(),\n        communityId: TEST_COMMUNITY_IDS.DEPRESSION_HELP,\n      },\n    ],\n  };\n\n  beforeEach(async () => {\n    // Create mock services\n    const mockModeratorAuthService = {\n      createModeratorAccount: jest.fn(),\n      loginModerator: jest.fn(),\n      getModeratorProfile: jest.fn(),\n      getModeratorPermissions: jest.fn(),\n      getAssignedCommunities: jest.fn(),\n      getModeratorDashboardStats: jest.fn(),\n    };\n\n    mockJwtAuthGuard = {\n      canActivate: jest.fn().mockReturnValue(true),\n    } as any;\n\n    const module: TestingModule = await Test.createTestingModule({\n      imports: [\n        ThrottlerModule.forRoot([\n          {\n            name: 'short',\n            ttl: 1000,\n            limit: 3,\n          },\n        ]),\n      ],\n      controllers: [ModeratorAuthController],\n      providers: [\n        {\n          provide: ModeratorAuthService,\n          useValue: mockModeratorAuthService,\n        },\n      ],\n    })\n      .overrideGuard(JwtAuthGuard)\n      .useValue(mockJwtAuthGuard)\n      .overrideGuard(ThrottlerGuard)\n      .useValue({ canActivate: jest.fn().mockReturnValue(true) })\n      .compile();\n\n    controller = module.get<ModeratorAuthController>(ModeratorAuthController);\n    moderatorAuthService = module.get<ModeratorAuthService>(ModeratorAuthService);\n  });\n\n  afterEach(() => {\n    jest.clearAllMocks();\n  });\n\n  describe('createModeratorAccount', () => {\n    const validRegisterDto = {\n      email: 'newmoderator@mentara.com',\n      password: 'SecurePass123!',\n      firstName: 'New',\n      lastName: 'Moderator',\n      permissions: ['moderate_posts', 'ban_users'],\n      assignedCommunities: [TEST_COMMUNITY_IDS.ANXIETY_SUPPORT],\n    };\n\n    it('should create moderator account successfully for admin user', async () => {\n      // Arrange\n      jest.spyOn(moderatorAuthService, 'createModeratorAccount').mockResolvedValue(mockCreateAccountResult);\n\n      // Act\n      const result = await controller.createModeratorAccount('admin', validRegisterDto);\n\n      // Assert\n      expect(moderatorAuthService.createModeratorAccount).toHaveBeenCalledWith(\n        validRegisterDto.email,\n        validRegisterDto.password,\n        validRegisterDto.firstName,\n        validRegisterDto.lastName,\n        validRegisterDto.permissions,\n        validRegisterDto.assignedCommunities,\n      );\n      expect(result).toEqual({\n        user: {\n          id: mockModeratorUser.id,\n          email: mockModeratorUser.email,\n          firstName: mockModeratorUser.firstName,\n          lastName: mockModeratorUser.lastName,\n          role: mockModeratorUser.role,\n          emailVerified: mockModeratorUser.emailVerified,\n        },\n        message: mockCreateAccountResult.message,\n      });\n    });\n\n    it('should create moderator account with optional fields', async () => {\n      // Arrange\n      const minimalRegisterDto = {\n        email: 'minimal@mentara.com',\n        password: 'SecurePass123!',\n        firstName: 'Minimal',\n        lastName: 'Moderator',\n      };\n\n      jest.spyOn(moderatorAuthService, 'createModeratorAccount').mockResolvedValue(mockCreateAccountResult);\n\n      // Act\n      const result = await controller.createModeratorAccount('admin', minimalRegisterDto);\n\n      // Assert\n      expect(moderatorAuthService.createModeratorAccount).toHaveBeenCalledWith(\n        minimalRegisterDto.email,\n        minimalRegisterDto.password,\n        minimalRegisterDto.firstName,\n        minimalRegisterDto.lastName,\n        [], // empty permissions array\n        [], // empty assignedCommunities array\n      );\n      expect(result).toBeDefined();\n    });\n\n    it('should throw ForbiddenException for non-admin users', async () => {\n      // Act & Assert\n      await expect(controller.createModeratorAccount('client', validRegisterDto)).rejects.toThrow(\n        ForbiddenException,\n      );\n      await expect(controller.createModeratorAccount('therapist', validRegisterDto)).rejects.toThrow(\n        ForbiddenException,\n      );\n      await expect(controller.createModeratorAccount('moderator', validRegisterDto)).rejects.toThrow(\n        ForbiddenException,\n      );\n    });\n\n    it('should handle email already exists error', async () => {\n      // Arrange\n      const error = new BadRequestException('Email already exists');\n      jest.spyOn(moderatorAuthService, 'createModeratorAccount').mockRejectedValue(error);\n\n      // Act & Assert\n      await expect(controller.createModeratorAccount('admin', validRegisterDto)).rejects.toThrow(\n        BadRequestException,\n      );\n    });\n\n    it('should handle service errors', async () => {\n      // Arrange\n      const error = new Error('Database error');\n      jest.spyOn(moderatorAuthService, 'createModeratorAccount').mockRejectedValue(error);\n\n      // Act & Assert\n      await expect(controller.createModeratorAccount('admin', validRegisterDto)).rejects.toThrow(error);\n    });\n  });\n\n  describe('login', () => {\n    const validLoginDto = {\n      email: TEST_EMAILS.MODERATOR,\n      password: 'SecurePass123!',\n    };\n\n    const mockRequest = {\n      ip: '192.168.1.1',\n      get: jest.fn().mockReturnValue('Test User Agent'),\n    } as any;\n\n    it('should login moderator successfully with valid credentials', async () => {\n      // Arrange\n      jest.spyOn(moderatorAuthService, 'loginModerator').mockResolvedValue(mockLoginResult);\n\n      // Act\n      const result = await controller.login(validLoginDto, mockRequest);\n\n      // Assert\n      expect(moderatorAuthService.loginModerator).toHaveBeenCalledWith(\n        validLoginDto.email,\n        validLoginDto.password,\n        mockRequest.ip,\n        'Test User Agent',\n      );\n\n      expect(result).toEqual({\n        user: {\n          id: mockModeratorUser.id,\n          email: mockModeratorUser.email,\n          firstName: mockModeratorUser.firstName,\n          lastName: mockModeratorUser.lastName,\n          role: mockModeratorUser.role,\n          emailVerified: mockModeratorUser.emailVerified,\n        },\n        accessToken: mockTokens.accessToken,\n        refreshToken: mockTokens.refreshToken,\n        expiresIn: mockTokens.expiresIn,\n      });\n    });\n\n    it('should handle missing User-Agent header', async () => {\n      // Arrange\n      const mockRequestWithoutUserAgent = {\n        ip: '192.168.1.1',\n        get: jest.fn().mockReturnValue(undefined),\n      } as any;\n\n      jest.spyOn(moderatorAuthService, 'loginModerator').mockResolvedValue(mockLoginResult);\n\n      // Act\n      await controller.login(validLoginDto, mockRequestWithoutUserAgent);\n\n      // Assert\n      expect(moderatorAuthService.loginModerator).toHaveBeenCalledWith(\n        validLoginDto.email,\n        validLoginDto.password,\n        mockRequestWithoutUserAgent.ip,\n        undefined,\n      );\n    });\n\n    it('should handle invalid credentials', async () => {\n      // Arrange\n      const authError = new UnauthorizedException('Invalid credentials');\n      jest.spyOn(moderatorAuthService, 'loginModerator').mockRejectedValue(authError);\n\n      // Act & Assert\n      await expect(controller.login(validLoginDto, mockRequest)).rejects.toThrow(authError);\n    });\n\n    it('should handle service errors', async () => {\n      // Arrange\n      const serviceError = new Error('Database connection failed');\n      jest.spyOn(moderatorAuthService, 'loginModerator').mockRejectedValue(serviceError);\n\n      // Act & Assert\n      await expect(controller.login(validLoginDto, mockRequest)).rejects.toThrow(serviceError);\n    });\n  });\n\n  describe('getProfile', () => {\n    it('should return moderator profile successfully', async () => {\n      // Arrange\n      jest.spyOn(moderatorAuthService, 'getModeratorProfile').mockResolvedValue(mockModeratorUser);\n\n      // Act\n      const result = await controller.getProfile(TEST_USER_IDS.MODERATOR);\n\n      // Assert\n      expect(moderatorAuthService.getModeratorProfile).toHaveBeenCalledWith(TEST_USER_IDS.MODERATOR);\n      expect(result).toEqual(mockModeratorUser);\n    });\n\n    it('should handle profile not found', async () => {\n      // Arrange\n      const notFoundError = new Error('Moderator profile not found');\n      jest.spyOn(moderatorAuthService, 'getModeratorProfile').mockRejectedValue(notFoundError);\n\n      // Act & Assert\n      await expect(controller.getProfile(TEST_USER_IDS.MODERATOR)).rejects.toThrow(notFoundError);\n    });\n  });\n\n  describe('getPermissions', () => {\n    it('should return moderator permissions successfully', async () => {\n      // Arrange\n      jest.spyOn(moderatorAuthService, 'getModeratorPermissions').mockResolvedValue(mockPermissions);\n\n      // Act\n      const result = await controller.getPermissions(TEST_USER_IDS.MODERATOR);\n\n      // Assert\n      expect(moderatorAuthService.getModeratorPermissions).toHaveBeenCalledWith(TEST_USER_IDS.MODERATOR);\n      expect(result).toEqual(mockPermissions);\n    });\n\n    it('should handle permissions not found', async () => {\n      // Arrange\n      const notFoundError = new Error('Moderator permissions not found');\n      jest.spyOn(moderatorAuthService, 'getModeratorPermissions').mockRejectedValue(notFoundError);\n\n      // Act & Assert\n      await expect(controller.getPermissions(TEST_USER_IDS.MODERATOR)).rejects.toThrow(notFoundError);\n    });\n  });\n\n  describe('getAssignedCommunities', () => {\n    it('should return assigned communities successfully', async () => {\n      // Arrange\n      jest.spyOn(moderatorAuthService, 'getAssignedCommunities').mockResolvedValue(mockAssignedCommunities);\n\n      // Act\n      const result = await controller.getAssignedCommunities(TEST_USER_IDS.MODERATOR);\n\n      // Assert\n      expect(moderatorAuthService.getAssignedCommunities).toHaveBeenCalledWith(TEST_USER_IDS.MODERATOR);\n      expect(result).toEqual(mockAssignedCommunities);\n    });\n\n    it('should handle assigned communities not found', async () => {\n      // Arrange\n      const notFoundError = new Error('Assigned communities not found');\n      jest.spyOn(moderatorAuthService, 'getAssignedCommunities').mockRejectedValue(notFoundError);\n\n      // Act & Assert\n      await expect(controller.getAssignedCommunities(TEST_USER_IDS.MODERATOR)).rejects.toThrow(notFoundError);\n    });\n  });\n\n  describe('getDashboardStats', () => {\n    it('should return dashboard statistics successfully', async () => {\n      // Arrange\n      jest.spyOn(moderatorAuthService, 'getModeratorDashboardStats').mockResolvedValue(mockDashboardStats);\n\n      // Act\n      const result = await controller.getDashboardStats(TEST_USER_IDS.MODERATOR);\n\n      // Assert\n      expect(moderatorAuthService.getModeratorDashboardStats).toHaveBeenCalledWith(TEST_USER_IDS.MODERATOR);\n      expect(result).toEqual(mockDashboardStats);\n    });\n\n    it('should handle dashboard stats not found', async () => {\n      // Arrange\n      const notFoundError = new Error('Dashboard stats not found');\n      jest.spyOn(moderatorAuthService, 'getModeratorDashboardStats').mockRejectedValue(notFoundError);\n\n      // Act & Assert\n      await expect(controller.getDashboardStats(TEST_USER_IDS.MODERATOR)).rejects.toThrow(notFoundError);\n    });\n  });\n\n  describe('Security Tests', () => {\n    it('should validate input data through ZodValidationPipe', () => {\n      // This tests that the controller uses proper validation\n      const validationPipe = new ZodValidationPipe({} as any);\n      expect(validationPipe).toBeDefined();\n    });\n\n    it('should apply rate limiting through ThrottlerGuard', () => {\n      // Test that throttling is configured\n      const createAccountMetadata = Reflect.getMetadata('__throttler_options__', controller.createModeratorAccount);\n      const loginMetadata = Reflect.getMetadata('__throttler_options__', controller.login);\n      \n      expect(createAccountMetadata).toBeDefined();\n      expect(loginMetadata).toBeDefined();\n    });\n\n    it('should require authentication for protected endpoints', () => {\n      // Test that protected endpoints have JwtAuthGuard\n      const protectedMethods = ['createModeratorAccount', 'getProfile', 'getPermissions', 'getAssignedCommunities', 'getDashboardStats'];\n      \n      protectedMethods.forEach(method => {\n        const guards = Reflect.getMetadata('__guards__', controller[method as keyof ModeratorAuthController]);\n        expect(guards).toBeDefined();\n      });\n    });\n\n    it('should allow public access to login endpoint', () => {\n      // Test that login endpoint is marked as public\n      const publicMetadata = Reflect.getMetadata('isPublic', controller.login);\n      expect(publicMetadata).toBeTruthy();\n    });\n  });\n\n  describe('Role-based Access Control', () => {\n    it('should test role-based access for moderator creation', async () => {\n      // Test that only admin role can create moderators\n      const registerDto = {\n        email: 'test@mentara.com',\n        password: 'SecurePass123!',\n        firstName: 'Test',\n        lastName: 'Moderator',\n      };\n\n      await RoleBasedTestUtils.testWithRoles(\n        async (userId: string, role: string) => {\n          try {\n            await controller.createModeratorAccount(role, registerDto);\n            return true;\n          } catch (error) {\n            return false;\n          }\n        },\n        {\n          client: false,\n          therapist: false,\n          admin: true,\n          moderator: false,\n        },\n      );\n    });\n\n    it('should validate moderator-specific functionality', async () => {\n      // Test that moderator-specific endpoints work for moderators\n      const moderatorContext = MockBuilder.createAuthContext('moderator');\n      \n      jest.spyOn(moderatorAuthService, 'getModeratorProfile').mockResolvedValue(mockModeratorUser);\n      \n      const result = await controller.getProfile(moderatorContext.userId);\n      \n      expect(result).toBeDefined();\n      expect(result.role).toBe('moderator');\n    });\n  });\n\n  describe('Error Handling', () => {\n    it('should handle network errors gracefully', async () => {\n      // Arrange\n      const networkError = new Error('Network timeout');\n      jest.spyOn(moderatorAuthService, 'getModeratorProfile').mockRejectedValue(networkError);\n\n      // Act & Assert\n      await expect(controller.getProfile(TEST_USER_IDS.MODERATOR)).rejects.toThrow(networkError);\n    });\n\n    it('should handle validation errors', async () => {\n      // Test that invalid data would be caught by the validation pipe\n      const invalidData = {\n        email: 'invalid-email',\n        password: '123', // Too short\n        firstName: '',\n        lastName: '',\n      };\n\n      // In a real scenario, this would throw a validation error\n      // The pipe would catch this before it reaches the controller\n      expect(() => {\n        // This would be handled by ZodValidationPipe\n        // and would throw a BadRequestException\n      }).not.toThrow();\n    });\n  });\n\n  describe('Integration Tests', () => {\n    it('should handle complete moderator account creation workflow', async () => {\n      // Arrange\n      const createAccountDto = {\n        email: 'integration@mentara.com',\n        password: 'SecurePass123!',\n        firstName: 'Integration',\n        lastName: 'Test',\n        permissions: ['moderate_posts', 'ban_users'],\n        assignedCommunities: [TEST_COMMUNITY_IDS.ANXIETY_SUPPORT],\n      };\n\n      jest.spyOn(moderatorAuthService, 'createModeratorAccount').mockResolvedValue(mockCreateAccountResult);\n\n      // Act\n      const result = await controller.createModeratorAccount('admin', createAccountDto);\n\n      // Assert\n      expect(result).toBeDefined();\n      expect(result.user.email).toBe(mockModeratorUser.email);\n      expect(result.user.role).toBe('moderator');\n      expect(result.message).toBe(mockCreateAccountResult.message);\n    });\n\n    it('should handle complete moderator login workflow', async () => {\n      // Arrange\n      const loginDto = {\n        email: TEST_EMAILS.MODERATOR,\n        password: 'SecurePass123!',\n      };\n\n      const mockRequest = {\n        ip: '192.168.1.1',\n        get: jest.fn().mockReturnValue('Test User Agent'),\n      } as any;\n\n      jest.spyOn(moderatorAuthService, 'loginModerator').mockResolvedValue(mockLoginResult);\n\n      // Act\n      const result = await controller.login(loginDto, mockRequest);\n\n      // Assert\n      expect(result).toBeDefined();\n      expect(result.user.email).toBe(mockModeratorUser.email);\n      expect(result.accessToken).toBe(mockTokens.accessToken);\n      expect(result.refreshToken).toBe(mockTokens.refreshToken);\n      expect(result.expiresIn).toBe(mockTokens.expiresIn);\n    });\n\n    it('should handle complete moderator profile workflow', async () => {\n      // Arrange\n      jest.spyOn(moderatorAuthService, 'getModeratorProfile').mockResolvedValue(mockModeratorUser);\n      jest.spyOn(moderatorAuthService, 'getModeratorPermissions').mockResolvedValue(mockPermissions);\n      jest.spyOn(moderatorAuthService, 'getAssignedCommunities').mockResolvedValue(mockAssignedCommunities);\n\n      // Act - Get profile\n      const profile = await controller.getProfile(TEST_USER_IDS.MODERATOR);\n      \n      // Act - Get permissions\n      const permissions = await controller.getPermissions(TEST_USER_IDS.MODERATOR);\n      \n      // Act - Get assigned communities\n      const communities = await controller.getAssignedCommunities(TEST_USER_IDS.MODERATOR);\n\n      // Assert\n      expect(profile).toBeDefined();\n      expect(profile.role).toBe('moderator');\n      expect(profile.permissions).toEqual(mockModeratorUser.permissions);\n      \n      expect(permissions).toBeDefined();\n      expect(permissions.canModeratePosts).toBe(true);\n      expect(permissions.canBanUsers).toBe(true);\n      \n      expect(communities).toBeDefined();\n      expect(communities.assignedCommunities).toHaveLength(2);\n    });\n\n    it('should handle complete moderator dashboard workflow', async () => {\n      // Arrange\n      jest.spyOn(moderatorAuthService, 'getModeratorDashboardStats').mockResolvedValue(mockDashboardStats);\n\n      // Act\n      const stats = await controller.getDashboardStats(TEST_USER_IDS.MODERATOR);\n\n      // Assert\n      expect(stats).toBeDefined();\n      expect(stats.totalPostsModerated).toBe(45);\n      expect(stats.pendingReports).toBe(8);\n      expect(stats.communitiesManaged).toBe(2);\n      expect(stats.recentActivity).toHaveLength(2);\n    });\n  });\n\n  describe('Data Validation', () => {\n    it('should validate moderator creation data structure', () => {\n      // Test that we're using the correct DTO structure\n      const validModeratorData = {\n        email: 'test@mentara.com',\n        password: 'SecurePass123!',\n        firstName: 'Test',\n        lastName: 'Moderator',\n        permissions: ['moderate_posts', 'ban_users'],\n        assignedCommunities: [TEST_COMMUNITY_IDS.ANXIETY_SUPPORT],\n      };\n\n      // Verify all required fields are present\n      expect(validModeratorData.email).toBeDefined();\n      expect(validModeratorData.password).toBeDefined();\n      expect(validModeratorData.firstName).toBeDefined();\n      expect(validModeratorData.lastName).toBeDefined();\n      expect(validModeratorData.permissions).toBeDefined();\n      expect(validModeratorData.assignedCommunities).toBeDefined();\n    });\n\n    it('should validate login data structure', () => {\n      // Test that we're using the correct DTO structure\n      const validLoginData = {\n        email: 'test@mentara.com',\n        password: 'SecurePass123!',\n      };\n\n      // Verify all required fields are present\n      expect(validLoginData.email).toBeDefined();\n      expect(validLoginData.password).toBeDefined();\n    });\n  });\n\n  describe('Response Format Validation', () => {\n    it('should return correctly formatted moderator creation response', async () => {\n      // Arrange\n      const createAccountDto = {\n        email: 'format@mentara.com',\n        password: 'SecurePass123!',\n        firstName: 'Format',\n        lastName: 'Test',\n        permissions: ['moderate_posts'],\n        assignedCommunities: [TEST_COMMUNITY_IDS.ANXIETY_SUPPORT],\n      };\n\n      jest.spyOn(moderatorAuthService, 'createModeratorAccount').mockResolvedValue(mockCreateAccountResult);\n\n      // Act\n      const result = await controller.createModeratorAccount('admin', createAccountDto);\n\n      // Assert\n      expect(result).toHaveProperty('user');\n      expect(result).toHaveProperty('message');\n      expect(result).not.toHaveProperty('accessToken'); // Creation doesn't include tokens\n      expect(result).not.toHaveProperty('refreshToken');\n      \n      expect(result.user).toHaveProperty('id');\n      expect(result.user).toHaveProperty('email');\n      expect(result.user).toHaveProperty('firstName');\n      expect(result.user).toHaveProperty('lastName');\n      expect(result.user).toHaveProperty('role');\n      expect(result.user).toHaveProperty('emailVerified');\n    });\n\n    it('should return correctly formatted login response', async () => {\n      // Arrange\n      const loginDto = {\n        email: TEST_EMAILS.MODERATOR,\n        password: 'SecurePass123!',\n      };\n\n      const mockRequest = {\n        ip: '192.168.1.1',\n        get: jest.fn().mockReturnValue('Test User Agent'),\n      } as any;\n\n      jest.spyOn(moderatorAuthService, 'loginModerator').mockResolvedValue(mockLoginResult);\n\n      // Act\n      const result = await controller.login(loginDto, mockRequest);\n\n      // Assert\n      expect(result).toHaveProperty('user');\n      expect(result).toHaveProperty('accessToken');\n      expect(result).toHaveProperty('refreshToken');\n      expect(result).toHaveProperty('expiresIn');\n      expect(result).not.toHaveProperty('message'); // Login doesn't include message\n    });\n\n    it('should return correctly formatted permissions response', async () => {\n      // Arrange\n      jest.spyOn(moderatorAuthService, 'getModeratorPermissions').mockResolvedValue(mockPermissions);\n\n      // Act\n      const result = await controller.getPermissions(TEST_USER_IDS.MODERATOR);\n\n      // Assert\n      expect(result).toHaveProperty('permissions');\n      expect(result).toHaveProperty('canModeratePosts');\n      expect(result).toHaveProperty('canBanUsers');\n      expect(result).toHaveProperty('canDeleteComments');\n      expect(result).toHaveProperty('canAccessReports');\n      \n      expect(result.permissions).toBeInstanceOf(Array);\n      expect(result.canModeratePosts).toBe(true);\n      expect(result.canBanUsers).toBe(true);\n    });\n\n    it('should return correctly formatted dashboard stats response', async () => {\n      // Arrange\n      jest.spyOn(moderatorAuthService, 'getModeratorDashboardStats').mockResolvedValue(mockDashboardStats);\n\n      // Act\n      const result = await controller.getDashboardStats(TEST_USER_IDS.MODERATOR);\n\n      // Assert\n      expect(result).toHaveProperty('totalPostsModerated');\n      expect(result).toHaveProperty('pendingReports');\n      expect(result).toHaveProperty('communitiesManaged');\n      expect(result).toHaveProperty('usersModerated');\n      expect(result).toHaveProperty('recentActivity');\n      \n      expect(result.totalPostsModerated).toBe(45);\n      expect(result.recentActivity).toBeInstanceOf(Array);\n      expect(result.recentActivity).toHaveLength(2);\n    });\n  });\n\n  describe('Admin-only Functionality', () => {\n    it('should enforce admin-only access for moderator creation', async () => {\n      // Arrange\n      const createAccountDto = {\n        email: 'admin-only@mentara.com',\n        password: 'SecurePass123!',\n        firstName: 'Admin',\n        lastName: 'Only',\n      };\n\n      // Test each role\n      const roles = ['client', 'therapist', 'moderator'];\n      \n      for (const role of roles) {\n        await expect(controller.createModeratorAccount(role, createAccountDto)).rejects.toThrow(\n          ForbiddenException,\n        );\n      }\n\n      // Test admin access\n      jest.spyOn(moderatorAuthService, 'createModeratorAccount').mockResolvedValue(mockCreateAccountResult);\n      const result = await controller.createModeratorAccount('admin', createAccountDto);\n      expect(result).toBeDefined();\n    });\n\n    it('should validate admin role before moderator creation', async () => {\n      // Arrange\n      const createAccountDto = {\n        email: 'validation@mentara.com',\n        password: 'SecurePass123!',\n        firstName: 'Validation',\n        lastName: 'Test',\n      };\n\n      // Act & Assert\n      await expect(controller.createModeratorAccount('invalid-role', createAccountDto)).rejects.toThrow(\n        ForbiddenException,\n      );\n    });\n  });\n});"],"version":3}