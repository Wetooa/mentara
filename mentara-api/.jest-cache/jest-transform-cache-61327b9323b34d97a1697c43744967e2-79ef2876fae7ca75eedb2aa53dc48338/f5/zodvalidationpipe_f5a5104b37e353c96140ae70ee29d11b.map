{"file":"/home/wetooa/Documents/code/projects/mentara/mentara-api/src/common/pipes/zod-validation.pipe.ts","mappings":";;;;;;;;;;;;AAqCA,4DAEC;AAGD,oCAKC;AAGD,sCAIC;AAGD,sCAIC;AA7DD,2CAKwB;AACxB,6BAAwB;AAGjB,IAAM,iBAAiB,GAAvB,MAAM,iBAAiB;IACR;IAApB,YAAoB,MAAW;QAAX,WAAM,GAAN,MAAM,CAAK;IAAG,CAAC;IAEnC,SAAS,CAAC,KAAU,EAAE,QAA0B;QAC9C,IAAI,CAAC;YACH,yCAAyC;YACzC,MAAM,WAAW,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;YAC7C,OAAO,WAAW,CAAC;QACrB,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YACf,IAAI,KAAK,YAAY,OAAC,CAAC,QAAQ,EAAE,CAAC;gBAChC,MAAM,aAAa,GAAG,KAAK,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,EAAE;oBAC7C,MAAM,IAAI,GAAG,GAAG,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC;oBAC/D,OAAO,GAAG,IAAI,KAAK,GAAG,CAAC,OAAO,EAAE,CAAC;gBACnC,CAAC,CAAC,CAAC;gBAEH,MAAM,IAAI,4BAAmB,CAAC;oBAC5B,OAAO,EAAE,mBAAmB;oBAC5B,MAAM,EAAE,aAAa;oBACrB,UAAU,EAAE,GAAG;oBACf,IAAI,EAAE,QAAQ,CAAC,IAAI;iBACpB,CAAC,CAAC;YACL,CAAC;YACD,MAAM,IAAI,4BAAmB,CAAC,mBAAmB,CAAC,CAAC;QACrD,CAAC;IACH,CAAC;CACF,CAAA;AAzBY,8CAAiB;4BAAjB,iBAAiB;IAD7B,IAAA,mBAAU,GAAE;;GACA,iBAAiB,CAyB7B;AAED,8CAA8C;AAC9C,SAAgB,wBAAwB,CAAC,MAAW;IAClD,OAAO,IAAI,iBAAiB,CAAC,MAAM,CAAC,CAAC;AACvC,CAAC;AAED,0CAA0C;AAC1C,SAAgB,YAAY,CAAC,MAAW;IACtC,OAAO,UAAU,MAAW,EAAE,WAAmB,EAAE,cAAsB;QACvE,yDAAyD;QACzD,sDAAsD;IACxD,CAAC,CAAC;AACJ,CAAC;AAED,iCAAiC;AACjC,SAAgB,aAAa,CAAC,MAAW;IACvC,OAAO,UAAU,MAAW,EAAE,WAAmB,EAAE,cAAsB;QACvE,yDAAyD;IAC3D,CAAC,CAAC;AACJ,CAAC;AAED,iCAAiC;AACjC,SAAgB,aAAa,CAAC,MAAW;IACvC,OAAO,UAAU,MAAW,EAAE,WAAmB,EAAE,cAAsB;QACvE,yDAAyD;IAC3D,CAAC,CAAC;AACJ,CAAC","names":[],"sources":["/home/wetooa/Documents/code/projects/mentara/mentara-api/src/common/pipes/zod-validation.pipe.ts"],"sourcesContent":["import {\n  PipeTransform,\n  Injectable,\n  ArgumentMetadata,\n  BadRequestException,\n} from '@nestjs/common';\nimport { z } from 'zod';\n\n@Injectable()\nexport class ZodValidationPipe implements PipeTransform {\n  constructor(private schema: any) {}\n\n  transform(value: any, metadata: ArgumentMetadata) {\n    try {\n      // Validate all types: body, query, param\n      const parsedValue = this.schema.parse(value);\n      return parsedValue;\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        const errorMessages = error.issues.map((err) => {\n          const path = err.path.length > 0 ? err.path.join('.') : 'root';\n          return `${path}: ${err.message}`;\n        });\n\n        throw new BadRequestException({\n          message: 'Validation failed',\n          errors: errorMessages,\n          statusCode: 400,\n          type: metadata.type,\n        });\n      }\n      throw new BadRequestException('Validation failed');\n    }\n  }\n}\n\n// Factory function to create validation pipes\nexport function ZodValidationPipeFactory(schema: any) {\n  return new ZodValidationPipe(schema);\n}\n\n// Decorator for easy parameter validation\nexport function ValidateBody(schema: any) {\n  return function (target: any, propertyKey: string, parameterIndex: number) {\n    // This would work with a custom decorator implementation\n    // For now, we'll use the pipe directly in controllers\n  };\n}\n\n// Decorator for query validation\nexport function ValidateQuery(schema: any) {\n  return function (target: any, propertyKey: string, parameterIndex: number) {\n    // This would work with a custom decorator implementation\n  };\n}\n\n// Decorator for param validation\nexport function ValidateParam(schema: any) {\n  return function (target: any, propertyKey: string, parameterIndex: number) {\n    // This would work with a custom decorator implementation\n  };\n}\n"],"version":3}