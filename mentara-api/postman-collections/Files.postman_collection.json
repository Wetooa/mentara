{
  "info": {
    "name": "Mentara - Files",
    "description": "Files module endpoints for file upload, download, management, and storage operations including profile pictures, documents, and media attachments.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_exporter_id": "mentara-files"
  },
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{accessToken}}",
        "type": "string"
      }
    ]
  },
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Set Bearer token for authenticated requests",
          "if (pm.environment.get('accessToken') && !pm.request.headers.has('Authorization')) {",
          "    pm.request.headers.add({",
          "        key: 'Authorization',",
          "        value: 'Bearer ' + pm.environment.get('accessToken')",
          "    });",
          "}"
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Global error handling for all requests",
          "pm.test('Response time is acceptable', function () {",
          "    pm.expect(pm.response.responseTime).to.be.below(5000);",
          "});",
          "",
          "// Auto-handle Zod validation errors",
          "if (pm.response.code === 400) {",
          "    try {",
          "        const responseJson = pm.response.json();",
          "        if (responseJson.issues && Array.isArray(responseJson.issues)) {",
          "            responseJson.issues.forEach(issue => {",
          "                console.error('❌ Validation Error: ' + issue.message + ' (' + issue.path.join('.') + ');',
          "            });"",
          "        }",
          "    } catch (e) {",
          "        console.error('❌ Failed to parse validation error response');",
          "    }",
          "}"
        ]
      }
    }
  ],
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:3001/api",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "File Upload",
      "item": [
        {
          "name": "Upload File",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('File uploaded successfully', function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Response has file ID', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.have.property('id');",
                  "    pm.environment.set('fileId', responseJson.id);",
                  "});",
                  "",
                  "pm.test('File has required metadata', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.have.property('filename');",
                  "    pm.expect(responseJson).to.have.property('mimeType');",
                  "    pm.expect(responseJson).to.have.property('size');",
                  "    pm.expect(responseJson).to.have.property('url');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "file",
                  "type": "file",
                  "src": "/path/to/test-document.pdf"
                },
                {
                  "key": "category",
                  "value": "document",
                  "type": "text"
                },
                {
                  "key": "description",
                  "value": "Test document for worksheet attachment",
                  "type": "text"
                },
                {
                  "key": "tags",
                  "value": "test,worksheet,document",
                  "type": "text"
                },
                {
                  "key": "isPublic",
                  "value": "false",
                  "type": "text"
                }
              ]
            },
            "url": {
              "raw": "{{baseUrl}}/files/upload",
              "host": ["{{baseUrl}}"],
              "path": ["files", "upload"]
            },
            "description": "Upload a file with metadata"
          },
          "response": []
        },
        {
          "name": "Upload Profile Picture",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Profile picture uploaded successfully', function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Response has thumbnail URLs', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.have.property('thumbnails');",
                  "    pm.expect(responseJson.thumbnails).to.have.property('small');",
                  "    pm.expect(responseJson.thumbnails).to.have.property('medium');",
                  "    pm.expect(responseJson.thumbnails).to.have.property('large');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "file",
                  "type": "file",
                  "src": "/path/to/profile-picture.jpg"
                },
                {
                  "key": "category",
                  "value": "profile_picture",
                  "type": "text"
                },
                {
                  "key": "generateThumbnails",
                  "value": "true",
                  "type": "text"
                },
                {
                  "key": "cropSquare",
                  "value": "true",
                  "type": "text"
                }
              ]
            },
            "url": {
              "raw": "{{baseUrl}}/files/upload/profile-picture",
              "host": ["{{baseUrl}}"],
              "path": ["files", "upload", "profile-picture"]
            },
            "description": "Upload profile picture with automatic thumbnail generation"
          },
          "response": []
        },
        {
          "name": "Upload Multiple Files",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Multiple files uploaded successfully', function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Response contains array of uploaded files', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.have.property('files');",
                  "    pm.expect(responseJson.files).to.be.an('array');",
                  "    pm.expect(responseJson.files.length).to.be.greaterThan(0);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "files",
                  "type": "file",
                  "src": ["/path/to/file1.pdf", "/path/to/file2.jpg"]
                },
                {
                  "key": "category",
                  "value": "media",
                  "type": "text"
                },
                {
                  "key": "folderPath",
                  "value": "community/posts",
                  "type": "text"
                }
              ]
            },
            "url": {
              "raw": "{{baseUrl}}/files/upload/multiple",
              "host": ["{{baseUrl}}"],
              "path": ["files", "upload", "multiple"]
            },
            "description": "Upload multiple files at once"
          },
          "response": []
        },
        {
          "name": "Get Upload URL",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Upload URL generated successfully', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response has upload URL', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.have.property('uploadUrl');",
                  "    pm.expect(responseJson).to.have.property('uploadId');",
                  "    pm.environment.set('uploadUrl', responseJson.uploadUrl);",
                  "    pm.environment.set('uploadId', responseJson.uploadId);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"filename\": \"large-video-file.mp4\",\n  \"mimeType\": \"video/mp4\",\n  \"size\": 104857600,\n  \"category\": \"media\",\n  \"description\": \"Large video file for direct upload\",\n  \"chunkSize\": 10485760\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/files/upload/url",
              "host": ["{{baseUrl}}"],
              "path": ["files", "upload", "url"]
            },
            "description": "Get presigned URL for direct upload (for large files)"
          },
          "response": []
        },
        {
          "name": "Confirm Upload",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"uploadId\": \"{{uploadId}}\",\n  \"etag\": \"\\\"abc123def456\\\"\",\n  \"finalSize\": 104857600\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/files/upload/confirm",
              "host": ["{{baseUrl}}"],
              "path": ["files", "upload", "confirm"]
            },
            "description": "Confirm successful direct upload"
          },
          "response": []
        }
      ]
    },
    {
      "name": "File Management",
      "item": [
        {
          "name": "Get File Info",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('File info retrieved successfully', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('File info has required fields', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.have.property('id');",
                  "    pm.expect(responseJson).to.have.property('filename');",
                  "    pm.expect(responseJson).to.have.property('mimeType');",
                  "    pm.expect(responseJson).to.have.property('size');",
                  "    pm.expect(responseJson).to.have.property('uploadedAt');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/files/{{fileId}}",
              "host": ["{{baseUrl}}"],
              "path": ["files", "{{fileId}}"]
            },
            "description": "Get file information and metadata"
          },
          "response": []
        },
        {
          "name": "Get User Files",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('User files retrieved successfully', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response has files array', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.have.property('files');",
                  "    pm.expect(responseJson.files).to.be.an('array');",
                  "});",
                  "",
                  "pm.test('Storage usage info included', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.have.property('usage');",
                  "    pm.expect(responseJson.usage).to.have.property('totalSize');",
                  "    pm.expect(responseJson.usage).to.have.property('fileCount');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/files?category=document&sortBy=uploadedAt&sortOrder=desc&page=1&limit=20",
              "host": ["{{baseUrl}}"],
              "path": ["files"],
              "query": [
                {
                  "key": "category",
                  "value": "document"
                },
                {
                  "key": "sortBy",
                  "value": "uploadedAt"
                },
                {
                  "key": "sortOrder",
                  "value": "desc"
                },
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "20"
                }
              ]
            },
            "description": "Get user's files with filtering and pagination"
          },
          "response": []
        },
        {
          "name": "Update File Metadata",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('File metadata updated successfully', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Updated metadata reflected', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.have.property('description');",
                  "    pm.expect(responseJson.description).to.include('updated');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"filename\": \"updated-document-name.pdf\",\n  \"description\": \"Updated description for the test document\",\n  \"tags\": [\"updated\", \"worksheet\", \"document\", \"therapy\"],\n  \"isPublic\": false,\n  \"category\": \"document\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/files/{{fileId}}",
              "host": ["{{baseUrl}}"],
              "path": ["files", "{{fileId}}"]
            },
            "description": "Update file metadata (owner only)"
          },
          "response": []
        },
        {
          "name": "Move File",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"newFolderPath\": \"therapy/worksheets/completed\",\n  \"reason\": \"Moving to completed worksheets folder\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/files/{{fileId}}/move",
              "host": ["{{baseUrl}}"],
              "path": ["files", "{{fileId}}", "move"]
            },
            "description": "Move file to different folder"
          },
          "response": []
        },
        {
          "name": "Copy File",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"newFilename\": \"copy-of-document.pdf\",\n  \"folderPath\": \"therapy/templates\",\n  \"copyMetadata\": true\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/files/{{fileId}}/copy",
              "host": ["{{baseUrl}}"],
              "path": ["files", "{{fileId}}", "copy"]
            },
            "description": "Create copy of file"
          },
          "response": []
        },
        {
          "name": "Delete File",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('File deleted successfully', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Deletion confirmed', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.have.property('message');",
                  "    pm.expect(responseJson.message).to.include('deleted');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"reason\": \"No longer needed\",\n  \"permanent\": false\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/files/{{fileId}}",
              "host": ["{{baseUrl}}"],
              "path": ["files", "{{fileId}}"]
            },
            "description": "Delete file (soft delete by default)"
          },
          "response": []
        }
      ]
    },
    {
      "name": "File Access",
      "item": [
        {
          "name": "Download File",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('File downloaded successfully', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Content-Disposition header present', function () {",
                  "    pm.expect(pm.response.headers.get('Content-Disposition')).to.exist;",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/files/{{fileId}}/download",
              "host": ["{{baseUrl}}"],
              "path": ["files", "{{fileId}}", "download"]
            },
            "description": "Download file directly"
          },
          "response": []
        },
        {
          "name": "Get Download URL",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Download URL generated successfully', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response has download URL', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.have.property('downloadUrl');",
                  "    pm.expect(responseJson).to.have.property('expiresAt');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/files/{{fileId}}/download-url?expiresIn=3600",
              "host": ["{{baseUrl}}"],
              "path": ["files", "{{fileId}}", "download-url"],
              "query": [
                {
                  "key": "expiresIn",
                  "value": "3600"
                }
              ]
            },
            "description": "Get temporary download URL"
          },
          "response": []
        },
        {
          "name": "Stream File",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Range",
                "value": "bytes=0-1023"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/files/{{fileId}}/stream",
              "host": ["{{baseUrl}}"],
              "path": ["files", "{{fileId}}", "stream"]
            },
            "description": "Stream file with range support"
          },
          "response": []
        },
        {
          "name": "Get File Thumbnail",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/files/{{fileId}}/thumbnail?size=medium&format=webp",
              "host": ["{{baseUrl}}"],
              "path": ["files", "{{fileId}}", "thumbnail"],
              "query": [
                {
                  "key": "size",
                  "value": "medium"
                },
                {
                  "key": "format",
                  "value": "webp"
                }
              ]
            },
            "description": "Get file thumbnail (images only)"
          },
          "response": []
        }
      ]
    },
    {
      "name": "File Sharing",
      "item": [
        {
          "name": "Share File",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('File shared successfully', function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Response has share link', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.have.property('shareUrl');",
                  "    pm.expect(responseJson).to.have.property('shareId');",
                  "    pm.environment.set('shareId', responseJson.shareId);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"fileId\": \"{{fileId}}\",\n  \"shareWith\": [\"{{therapistId}}\"],\n  \"permissions\": [\"view\", \"download\"],\n  \"expiresAt\": \"2024-03-15T23:59:59.000Z\",\n  \"message\": \"Here's the completed worksheet for your review\",\n  \"requireAuth\": true,\n  \"allowPublicAccess\": false\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/files/{{fileId}}/share",
              "host": ["{{baseUrl}}"],
              "path": ["files", "{{fileId}}", "share"]
            },
            "description": "Share file with specific users"
          },
          "response": []
        },
        {
          "name": "Get Shared Files",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/files/shared?sharedBy=me&status=active&page=1&limit=10",
              "host": ["{{baseUrl}}"],
              "path": ["files", "shared"],
              "query": [
                {
                  "key": "sharedBy",
                  "value": "me"
                },
                {
                  "key": "status",
                  "value": "active"
                },
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "10"
                }
              ]
            },
            "description": "Get files shared by user"
          },
          "response": []
        },
        {
          "name": "Get Files Shared With Me",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/files/shared-with-me?status=active&page=1&limit=10",
              "host": ["{{baseUrl}}"],
              "path": ["files", "shared-with-me"],
              "query": [
                {
                  "key": "status",
                  "value": "active"
                },
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "10"
                }
              ]
            },
            "description": "Get files shared with user"
          },
          "response": []
        },
        {
          "name": "Update Share Permissions",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"permissions\": [\"view\", \"download\", \"comment\"],\n  \"expiresAt\": \"2024-04-15T23:59:59.000Z\",\n  \"message\": \"Updated permissions to include commenting\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/files/shares/{{shareId}}",
              "host": ["{{baseUrl}}"],
              "path": ["files", "shares", "{{shareId}}"]
            },
            "description": "Update share permissions"
          },
          "response": []
        },
        {
          "name": "Revoke Share",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"reason\": \"No longer needed\",\n  \"notifyUsers\": true\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/files/shares/{{shareId}}",
              "host": ["{{baseUrl}}"],
              "path": ["files", "shares", "{{shareId}}"]
            },
            "description": "Revoke file share"
          },
          "response": []
        }
      ]
    },
    {
      "name": "File Organization",
      "item": [
        {
          "name": "Create Folder",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Folder created successfully', function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Response has folder ID', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.have.property('id');",
                  "    pm.environment.set('folderId', responseJson.id);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Therapy Worksheets\",\n  \"description\": \"Folder for completed therapy worksheets\",\n  \"parentPath\": \"therapy\",\n  \"isPublic\": false,\n  \"tags\": [\"therapy\", \"worksheets\", \"organization\"]\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/files/folders",
              "host": ["{{baseUrl}}"],
              "path": ["files", "folders"]
            },
            "description": "Create new folder"
          },
          "response": []
        },
        {
          "name": "Get Folder Contents",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/files/folders/{{folderId}}?includeSubfolders=true&sortBy=name&sortOrder=asc",
              "host": ["{{baseUrl}}"],
              "path": ["files", "folders", "{{folderId}}"],
              "query": [
                {
                  "key": "includeSubfolders",
                  "value": "true"
                },
                {
                  "key": "sortBy",
                  "value": "name"
                },
                {
                  "key": "sortOrder",
                  "value": "asc"
                }
              ]
            },
            "description": "Get folder contents"
          },
          "response": []
        },
        {
          "name": "Rename Folder",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Completed Therapy Worksheets\",\n  \"description\": \"Updated folder for completed therapy worksheets and assignments\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/files/folders/{{folderId}}",
              "host": ["{{baseUrl}}"],
              "path": ["files", "folders", "{{folderId}}"]
            },
            "description": "Rename folder"
          },
          "response": []
        },
        {
          "name": "Delete Folder",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"recursive\": true,\n  \"reason\": \"Folder no longer needed\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/files/folders/{{folderId}}",
              "host": ["{{baseUrl}}"],
              "path": ["files", "folders", "{{folderId}}"]
            },
            "description": "Delete folder and contents"
          },
          "response": []
        }
      ]
    },
    {
      "name": "File Analytics",
      "item": [
        {
          "name": "Get Storage Usage",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/files/usage?detailed=true",
              "host": ["{{baseUrl}}"],
              "path": ["files", "usage"],
              "query": [
                {
                  "key": "detailed",
                  "value": "true"
                }
              ]
            },
            "description": "Get user storage usage statistics"
          },
          "response": []
        },
        {
          "name": "Get File Activity",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/files/{{fileId}}/activity?limit=20",
              "host": ["{{baseUrl}}"],
              "path": ["files", "{{fileId}}", "activity"],
              "query": [
                {
                  "key": "limit",
                  "value": "20"
                }
              ]
            },
            "description": "Get file activity log"
          },
          "response": []
        },
        {
          "name": "Get Popular Files",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/files/popular?timeframe=month&limit=10",
              "host": ["{{baseUrl}}"],
              "path": ["files", "popular"],
              "query": [
                {
                  "key": "timeframe",
                  "value": "month"
                },
                {
                  "key": "limit",
                  "value": "10"
                }
              ]
            },
            "description": "Get most accessed files"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Error Handling & Validation",
      "item": [
        {
          "name": "Upload Invalid File Type",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Returns 400 for invalid file type', function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "pm.test('Error message mentions file type', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson.message).to.include('file type');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "file",
                  "type": "file",
                  "src": "/path/to/malicious.exe"
                },
                {
                  "key": "category",
                  "value": "document",
                  "type": "text"
                }
              ]
            },
            "url": {
              "raw": "{{baseUrl}}/files/upload",
              "host": ["{{baseUrl}}"],
              "path": ["files", "upload"]
            },
            "description": "Test upload with invalid file type"
          },
          "response": []
        },
        {
          "name": "Upload Too Large File",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Returns 413 for file too large', function () {",
                  "    pm.response.to.have.status(413);",
                  "});",
                  "",
                  "pm.test('Error message mentions file size', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson.message).to.include('size');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "file",
                  "type": "file",
                  "src": "/path/to/huge-file.zip"
                },
                {
                  "key": "category",
                  "value": "document",
                  "type": "text"
                }
              ]
            },
            "url": {
              "raw": "{{baseUrl}}/files/upload",
              "host": ["{{baseUrl}}"],
              "path": ["files", "upload"]
            },
            "description": "Test upload with file too large"
          },
          "response": []
        },
        {
          "name": "Access Unauthorized File",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Returns 403 for unauthorized access', function () {",
                  "    pm.response.to.have.status(403);",
                  "});",
                  "",
                  "pm.test('Error message mentions permissions', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson.message).to.include('permission');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/files/{{otherUserFileId}}",
              "host": ["{{baseUrl}}"],
              "path": ["files", "{{otherUserFileId}}"]
            },
            "description": "Test access to unauthorized file"
          },
          "response": []
        }
      ]
    }
  ]
}