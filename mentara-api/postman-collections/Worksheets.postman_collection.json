{
  "info": {
    "name": "Mentara - Worksheets",
    "description": "Worksheets module endpoints for therapy assignments, interactive exercises, progress tracking, and client-therapist worksheet collaboration.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_exporter_id": "mentara-worksheets"
  },
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{accessToken}}",
        "type": "string"
      }
    ]
  },
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Set Bearer token for authenticated requests",
          "if (pm.environment.get('accessToken') && !pm.request.headers.has('Authorization')) {",
          "    pm.request.headers.add({",
          "        key: 'Authorization',",
          "        value: 'Bearer ' + pm.environment.get('accessToken')",
          "    });",
          "}"
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Global error handling for all requests",
          "pm.test('Response time is acceptable', function () {",
          "    pm.expect(pm.response.responseTime).to.be.below(3000);",
          "});",
          "",
          "// Auto-handle Zod validation errors",
          "if (pm.response.code === 400) {",
          "    try {",
          "        const responseJson = pm.response.json();",
          "        if (responseJson.issues && Array.isArray(responseJson.issues)) {",
          "            responseJson.issues.forEach(issue => {",
          "                console.error('❌ Validation Error: ' + issue.message + ' (' + issue.path.join('.') + ');',
          "            });"",
          "        }",
          "    } catch (e) {",
          "        console.error('❌ Failed to parse validation error response');",
          "    }",
          "}"
        ]
      }
    }
  ],
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:3001/api",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "Worksheet Templates",
      "item": [
        {
          "name": "Get All Templates",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Templates retrieved successfully', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response has templates array', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.have.property('templates');",
                  "    pm.expect(responseJson.templates).to.be.an('array');",
                  "});",
                  "",
                  "pm.test('Templates have required fields', function () {",
                  "    const responseJson = pm.response.json();",
                  "    if (responseJson.templates.length > 0) {",
                  "        const template = responseJson.templates[0];",
                  "        pm.expect(template).to.have.property('id');",
                  "        pm.expect(template).to.have.property('title');",
                  "        pm.expect(template).to.have.property('category');",
                  "        pm.expect(template).to.have.property('difficulty');",
                  "    }",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/worksheets/templates?category=anxiety&difficulty=beginner&page=1&limit=20",
              "host": ["{{baseUrl}}"],
              "path": ["worksheets", "templates"],
              "query": [
                {
                  "key": "category",
                  "value": "anxiety"
                },
                {
                  "key": "difficulty",
                  "value": "beginner"
                },
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "20"
                }
              ]
            },
            "description": "Get worksheet templates with filtering"
          },
          "response": []
        },
        {
          "name": "Get Template by ID",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Template retrieved successfully', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Template has structure', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.have.property('structure');",
                  "    pm.expect(responseJson.structure).to.have.property('sections');",
                  "    pm.environment.set('templateId', responseJson.id);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/worksheets/templates/{{templateId}}",
              "host": ["{{baseUrl}}"],
              "path": ["worksheets", "templates", "{{templateId}}"]
            },
            "description": "Get detailed template structure"
          },
          "response": []
        },
        {
          "name": "Create Custom Template",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Template created successfully', function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Response has template ID', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.have.property('id');",
                  "    pm.environment.set('customTemplateId', responseJson.id);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Daily Gratitude & Reflection Journal\",\n  \"description\": \"A customized worksheet for daily gratitude practice and self-reflection, designed to help clients develop positive thinking patterns.\",\n  \"category\": \"gratitude\",\n  \"difficulty\": \"beginner\",\n  \"estimatedTime\": 15,\n  \"tags\": [\"gratitude\", \"mindfulness\", \"daily-practice\", \"positivity\"],\n  \"structure\": {\n    \"sections\": [\n      {\n        \"id\": \"gratitude\",\n        \"title\": \"Three Things I'm Grateful For Today\",\n        \"type\": \"text_list\",\n        \"required\": true,\n        \"instructions\": \"List three things you're grateful for today. Be specific and think about why each one matters to you.\",\n        \"fields\": [\n          {\n            \"id\": \"gratitude_1\",\n            \"label\": \"Gratitude #1\",\n            \"type\": \"textarea\",\n            \"placeholder\": \"I'm grateful for...\",\n            \"required\": true\n          },\n          {\n            \"id\": \"gratitude_2\",\n            \"label\": \"Gratitude #2\",\n            \"type\": \"textarea\",\n            \"placeholder\": \"I'm grateful for...\",\n            \"required\": true\n          },\n          {\n            \"id\": \"gratitude_3\",\n            \"label\": \"Gratitude #3\",\n            \"type\": \"textarea\",\n            \"placeholder\": \"I'm grateful for...\",\n            \"required\": true\n          }\n        ]\n      },\n      {\n        \"id\": \"reflection\",\n        \"title\": \"Daily Reflection\",\n        \"type\": \"text_input\",\n        \"required\": true,\n        \"instructions\": \"Reflect on your day and share any insights or feelings.\",\n        \"fields\": [\n          {\n            \"id\": \"mood_rating\",\n            \"label\": \"How would you rate your overall mood today?\",\n            \"type\": \"scale\",\n            \"min\": 1,\n            \"max\": 10,\n            \"required\": true\n          },\n          {\n            \"id\": \"highlight\",\n            \"label\": \"What was the highlight of your day?\",\n            \"type\": \"textarea\",\n            \"required\": true\n          },\n          {\n            \"id\": \"challenge\",\n            \"label\": \"What was challenging today and how did you handle it?\",\n            \"type\": \"textarea\",\n            \"required\": false\n          },\n          {\n            \"id\": \"tomorrow_intention\",\n            \"label\": \"What intention do you want to set for tomorrow?\",\n            \"type\": \"textarea\",\n            \"required\": false\n          }\n        ]\n      }\n    ]\n  },\n  \"isPublic\": false,\n  \"isActive\": true\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/worksheets/templates",
              "host": ["{{baseUrl}}"],
              "path": ["worksheets", "templates"]
            },
            "description": "Create a custom worksheet template (therapist only)"
          },
          "response": []
        },
        {
          "name": "Update Template",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Daily Gratitude & Reflection Journal - Enhanced\",\n  \"description\": \"An enhanced version of the gratitude journal with additional mindfulness elements.\",\n  \"estimatedTime\": 20,\n  \"tags\": [\"gratitude\", \"mindfulness\", \"daily-practice\", \"positivity\", \"enhanced\"],\n  \"structure\": {\n    \"sections\": [\n      {\n        \"id\": \"gratitude\",\n        \"title\": \"Three Things I'm Grateful For Today\",\n        \"type\": \"text_list\",\n        \"required\": true,\n        \"instructions\": \"List three things you're grateful for today. Be specific and think about why each one matters to you.\",\n        \"fields\": [\n          {\n            \"id\": \"gratitude_1\",\n            \"label\": \"Gratitude #1\",\n            \"type\": \"textarea\",\n            \"placeholder\": \"I'm grateful for...\",\n            \"required\": true\n          },\n          {\n            \"id\": \"gratitude_2\",\n            \"label\": \"Gratitude #2\",\n            \"type\": \"textarea\",\n            \"placeholder\": \"I'm grateful for...\",\n            \"required\": true\n          },\n          {\n            \"id\": \"gratitude_3\",\n            \"label\": \"Gratitude #3\",\n            \"type\": \"textarea\",\n            \"placeholder\": \"I'm grateful for...\",\n            \"required\": true\n          }\n        ]\n      },\n      {\n        \"id\": \"mindfulness\",\n        \"title\": \"Mindfulness Check-in\",\n        \"type\": \"assessment\",\n        \"required\": true,\n        \"instructions\": \"Take a moment to check in with yourself mindfully.\",\n        \"fields\": [\n          {\n            \"id\": \"breath_awareness\",\n            \"label\": \"How aware were you of your breathing today?\",\n            \"type\": \"scale\",\n            \"min\": 1,\n            \"max\": 5,\n            \"required\": true\n          },\n          {\n            \"id\": \"present_moment\",\n            \"label\": \"How often did you feel present in the moment?\",\n            \"type\": \"scale\",\n            \"min\": 1,\n            \"max\": 5,\n            \"required\": true\n          }\n        ]\n      },\n      {\n        \"id\": \"reflection\",\n        \"title\": \"Daily Reflection\",\n        \"type\": \"text_input\",\n        \"required\": true,\n        \"instructions\": \"Reflect on your day and share any insights or feelings.\",\n        \"fields\": [\n          {\n            \"id\": \"mood_rating\",\n            \"label\": \"How would you rate your overall mood today?\",\n            \"type\": \"scale\",\n            \"min\": 1,\n            \"max\": 10,\n            \"required\": true\n          },\n          {\n            \"id\": \"highlight\",\n            \"label\": \"What was the highlight of your day?\",\n            \"type\": \"textarea\",\n            \"required\": true\n          },\n          {\n            \"id\": \"challenge\",\n            \"label\": \"What was challenging today and how did you handle it?\",\n            \"type\": \"textarea\",\n            \"required\": false\n          },\n          {\n            \"id\": \"tomorrow_intention\",\n            \"label\": \"What intention do you want to set for tomorrow?\",\n            \"type\": \"textarea\",\n            \"required\": false\n          }\n        ]\n      }\n    ]\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/worksheets/templates/{{customTemplateId}}",
              "host": ["{{baseUrl}}"],
              "path": ["worksheets", "templates", "{{customTemplateId}}"]
            },
            "description": "Update a template (creator only)"
          },
          "response": []
        },
        {
          "name": "Delete Template",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/worksheets/templates/{{customTemplateId}}",
              "host": ["{{baseUrl}}"],
              "path": ["worksheets", "templates", "{{customTemplateId}}"]
            },
            "description": "Delete a custom template (creator only)"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Worksheet Assignments",
      "item": [
        {
          "name": "Assign Worksheet",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Worksheet assigned successfully', function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Response has assignment ID', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.have.property('id');",
                  "    pm.environment.set('worksheetId', responseJson.id);",
                  "});",
                  "",
                  "pm.test('Assignment has required fields', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.have.property('clientId');",
                  "    pm.expect(responseJson).to.have.property('templateId');",
                  "    pm.expect(responseJson).to.have.property('dueDate');",
                  "    pm.expect(responseJson).to.have.property('status');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"clientId\": \"{{clientId}}\",\n  \"templateId\": \"{{templateId}}\",\n  \"title\": \"Weekly Gratitude Practice\",\n  \"instructions\": \"Please complete this gratitude journal daily for the next week. Focus on being specific and genuine in your responses. This will help us discuss your progress in our next session.\",\n  \"dueDate\": \"2024-02-15T23:59:59.000Z\",\n  \"priority\": \"medium\",\n  \"isRecurring\": true,\n  \"recurrencePattern\": {\n    \"frequency\": \"daily\",\n    \"interval\": 1,\n    \"endDate\": \"2024-03-15T23:59:59.000Z\"\n  },\n  \"customizations\": {\n    \"additionalInstructions\": \"Pay special attention to the mindfulness check-in section - this will help with our breathing exercises.\",\n    \"modifiedFields\": [\n      {\n        \"fieldId\": \"mood_rating\",\n        \"newLabel\": \"How would you rate your anxiety level today?\",\n        \"newInstructions\": \"Rate from 1 (very calm) to 10 (very anxious)\"\n      }\n    ]\n  },\n  \"reminderSettings\": {\n    \"enabled\": true,\n    \"reminderTime\": \"19:00\",\n    \"reminderDays\": [1, 2, 3, 4, 5, 6, 7]\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/worksheets/assignments",
              "host": ["{{baseUrl}}"],
              "path": ["worksheets", "assignments"]
            },
            "description": "Assign a worksheet to a client (therapist only)"
          },
          "response": []
        },
        {
          "name": "Get Client Assignments",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Assignments retrieved successfully', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response has assignments array', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.have.property('assignments');",
                  "    pm.expect(responseJson.assignments).to.be.an('array');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/worksheets/assignments?clientId={{clientId}}&status=active&page=1&limit=10",
              "host": ["{{baseUrl}}"],
              "path": ["worksheets", "assignments"],
              "query": [
                {
                  "key": "clientId",
                  "value": "{{clientId}}"
                },
                {
                  "key": "status",
                  "value": "active"
                },
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "10"
                }
              ]
            },
            "description": "Get worksheet assignments for a client"
          },
          "response": []
        },
        {
          "name": "Get Assignment by ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/worksheets/assignments/{{worksheetId}}",
              "host": ["{{baseUrl}}"],
              "path": ["worksheets", "assignments", "{{worksheetId}}"]
            },
            "description": "Get specific worksheet assignment details"
          },
          "response": []
        },
        {
          "name": "Update Assignment",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Weekly Gratitude Practice - Extended\",\n  \"instructions\": \"Please complete this gratitude journal daily for the next week. Focus on being specific and genuine in your responses. This will help us discuss your progress in our next session. I've extended the due date to give you more time.\",\n  \"dueDate\": \"2024-02-22T23:59:59.000Z\",\n  \"priority\": \"high\",\n  \"customizations\": {\n    \"additionalInstructions\": \"Pay special attention to the mindfulness check-in section - this will help with our breathing exercises. Also, try to complete this at the same time each day to establish a routine.\",\n    \"modifiedFields\": [\n      {\n        \"fieldId\": \"mood_rating\",\n        \"newLabel\": \"How would you rate your anxiety level today?\",\n        \"newInstructions\": \"Rate from 1 (very calm) to 10 (very anxious)\"\n      }\n    ]\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/worksheets/assignments/{{worksheetId}}",
              "host": ["{{baseUrl}}"],
              "path": ["worksheets", "assignments", "{{worksheetId}}"]
            },
            "description": "Update worksheet assignment (therapist only)"
          },
          "response": []
        },
        {
          "name": "Cancel Assignment",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"reason\": \"Client requested to focus on different exercises\",\n  \"notifyClient\": true\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/worksheets/assignments/{{worksheetId}}",
              "host": ["{{baseUrl}}"],
              "path": ["worksheets", "assignments", "{{worksheetId}}"]
            },
            "description": "Cancel worksheet assignment (therapist only)"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Worksheet Submissions",
      "item": [
        {
          "name": "Submit Worksheet",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Worksheet submitted successfully', function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Response has submission ID', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.have.property('id');",
                  "    pm.environment.set('submissionId', responseJson.id);",
                  "});",
                  "",
                  "pm.test('Submission has required fields', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.have.property('worksheetId');",
                  "    pm.expect(responseJson).to.have.property('responses');",
                  "    pm.expect(responseJson).to.have.property('submittedAt');",
                  "    pm.expect(responseJson).to.have.property('status');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"worksheetId\": \"{{worksheetId}}\",\n  \"responses\": {\n    \"gratitude\": {\n      \"gratitude_1\": \"I'm grateful for my morning coffee and the peaceful moment it gives me to start the day. It's a simple pleasure that helps me feel grounded.\",\n      \"gratitude_2\": \"I'm grateful for my friend Sarah who called to check on me today. Her kindness and support mean so much, especially when I'm feeling anxious.\",\n      \"gratitude_3\": \"I'm grateful for the sunny weather today. It motivated me to go for a walk outside, which helped improve my mood significantly.\"\n    },\n    \"mindfulness\": {\n      \"breath_awareness\": 4,\n      \"present_moment\": 3\n    },\n    \"reflection\": {\n      \"mood_rating\": 6,\n      \"highlight\": \"The highlight was definitely my walk in the park. I felt so much more relaxed afterward and even noticed some beautiful flowers blooming.\",\n      \"challenge\": \"I had a moment of anxiety when I got an unexpected work email. I handled it by taking deep breaths and reminding myself that it could wait until tomorrow.\",\n      \"tomorrow_intention\": \"I want to practice mindful breathing for 5 minutes when I wake up tomorrow.\"\n    }\n  },\n  \"completionTime\": 18,\n  \"notes\": \"This felt really helpful today. The gratitude section especially helped shift my perspective when I was feeling overwhelmed.\",\n  \"mood\": {\n    \"before\": 4,\n    \"after\": 7\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/worksheets/submissions",
              "host": ["{{baseUrl}}"],
              "path": ["worksheets", "submissions"]
            },
            "description": "Submit completed worksheet (client only)"
          },
          "response": []
        },
        {
          "name": "Save Draft",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"worksheetId\": \"{{worksheetId}}\",\n  \"responses\": {\n    \"gratitude\": {\n      \"gratitude_1\": \"I'm grateful for my morning coffee and the peaceful moment it gives me to start the day.\",\n      \"gratitude_2\": \"I'm grateful for my friend Sarah who called to check on me today.\",\n      \"gratitude_3\": \"\"\n    },\n    \"mindfulness\": {\n      \"breath_awareness\": 4,\n      \"present_moment\": null\n    },\n    \"reflection\": {\n      \"mood_rating\": null,\n      \"highlight\": \"\",\n      \"challenge\": \"\",\n      \"tomorrow_intention\": \"\"\n    }\n  },\n  \"isDraft\": true,\n  \"notes\": \"Starting to work on this, will finish later\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/worksheets/submissions/draft",
              "host": ["{{baseUrl}}"],
              "path": ["worksheets", "submissions", "draft"]
            },
            "description": "Save worksheet as draft (client only)"
          },
          "response": []
        },
        {
          "name": "Get Submission",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/worksheets/submissions/{{submissionId}}",
              "host": ["{{baseUrl}}"],
              "path": ["worksheets", "submissions", "{{submissionId}}"]
            },
            "description": "Get specific worksheet submission"
          },
          "response": []
        },
        {
          "name": "Update Submission",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"responses\": {\n    \"gratitude\": {\n      \"gratitude_1\": \"I'm grateful for my morning coffee and the peaceful moment it gives me to start the day. It's a simple pleasure that helps me feel grounded.\",\n      \"gratitude_2\": \"I'm grateful for my friend Sarah who called to check on me today. Her kindness and support mean so much, especially when I'm feeling anxious.\",\n      \"gratitude_3\": \"I'm grateful for the sunny weather today. It motivated me to go for a walk outside, which helped improve my mood significantly.\"\n    },\n    \"mindfulness\": {\n      \"breath_awareness\": 4,\n      \"present_moment\": 4\n    },\n    \"reflection\": {\n      \"mood_rating\": 7,\n      \"highlight\": \"The highlight was definitely my walk in the park. I felt so much more relaxed afterward and even noticed some beautiful flowers blooming. Also, I managed to complete a work task I'd been putting off.\",\n      \"challenge\": \"I had a moment of anxiety when I got an unexpected work email. I handled it by taking deep breaths and reminding myself that it could wait until tomorrow.\",\n      \"tomorrow_intention\": \"I want to practice mindful breathing for 5 minutes when I wake up tomorrow and maybe try to go for another walk.\"\n    }\n  },\n  \"completionTime\": 22,\n  \"notes\": \"This felt really helpful today. The gratitude section especially helped shift my perspective when I was feeling overwhelmed. Updated with some additional thoughts.\",\n  \"mood\": {\n    \"before\": 4,\n    \"after\": 8\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/worksheets/submissions/{{submissionId}}",
              "host": ["{{baseUrl}}"],
              "path": ["worksheets", "submissions", "{{submissionId}}"]
            },
            "description": "Update worksheet submission (within edit window)"
          },
          "response": []
        },
        {
          "name": "Get Client Submissions",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/worksheets/submissions?clientId={{clientId}}&status=submitted&page=1&limit=10&sortBy=submittedAt&sortOrder=desc",
              "host": ["{{baseUrl}}"],
              "path": ["worksheets", "submissions"],
              "query": [
                {
                  "key": "clientId",
                  "value": "{{clientId}}"
                },
                {
                  "key": "status",
                  "value": "submitted"
                },
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "10"
                },
                {
                  "key": "sortBy",
                  "value": "submittedAt"
                },
                {
                  "key": "sortOrder",
                  "value": "desc"
                }
              ]
            },
            "description": "Get worksheet submissions for a client"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Worksheet Collaboration",
      "item": [
        {
          "name": "Add Therapist Feedback",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Feedback added successfully', function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Response has feedback ID', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.have.property('id');",
                  "    pm.environment.set('feedbackId', responseJson.id);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"submissionId\": \"{{submissionId}}\",\n  \"overallFeedback\": \"This is excellent work! I can see real progress in your ability to identify specific things you're grateful for and connect them to your emotions. Your mindfulness awareness is improving too.\",\n  \"fieldFeedback\": [\n    {\n      \"fieldId\": \"gratitude_1\",\n      \"comment\": \"I love how specific you were about the morning coffee ritual. This shows great awareness of how small moments can ground us.\",\n      \"type\": \"positive\"\n    },\n    {\n      \"fieldId\": \"challenge\",\n      \"comment\": \"Great job using the breathing technique we practiced! This is exactly the kind of in-the-moment coping strategy we want to develop.\",\n      \"type\": \"positive\"\n    },\n    {\n      \"fieldId\": \"tomorrow_intention\",\n      \"comment\": \"This is a wonderful intention. Remember, even 2-3 minutes of mindful breathing can make a difference. Don't put pressure on yourself for the full 5 minutes right away.\",\n      \"type\": \"suggestion\"\n    }\n  ],\n  \"suggestedImprovements\": [\n    \"Try to notice the physical sensations during your gratitude practice - does your body feel different when you focus on positive things?\",\n    \"Consider keeping a small notebook for gratitude thoughts throughout the day, not just during the formal practice.\"\n  ],\n  \"nextSteps\": [\n    \"Continue with daily gratitude practice\",\n    \"Try the 5-minute morning breathing exercise\",\n    \"We'll discuss your progress with anxiety management in our next session\"\n  ],\n  \"rating\": 4.5,\n  \"isPrivate\": false\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/worksheets/submissions/{{submissionId}}/feedback",
              "host": ["{{baseUrl}}"],
              "path": ["worksheets", "submissions", "{{submissionId}}", "feedback"]
            },
            "description": "Add therapist feedback to worksheet submission (therapist only)"
          },
          "response": []
        },
        {
          "name": "Get Submission Feedback",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/worksheets/submissions/{{submissionId}}/feedback",
              "host": ["{{baseUrl}}"],
              "path": ["worksheets", "submissions", "{{submissionId}}", "feedback"]
            },
            "description": "Get feedback for a worksheet submission"
          },
          "response": []
        },
        {
          "name": "Add Client Response to Feedback",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"feedbackId\": \"{{feedbackId}}\",\n  \"response\": \"Thank you so much for this feedback! It really helps to know I'm on the right track. I tried the 5-minute breathing exercise this morning and you're right - even 3 minutes felt really good. I'll keep practicing and maybe work up to the full 5 minutes gradually.\",\n  \"questions\": [\n    \"Is it normal to feel a bit emotional during gratitude practice? Sometimes I get a bit teary when I really think about what I'm grateful for.\",\n    \"Should I stick to the same three categories (people, experiences, things) or is it okay to mix it up?\"\n  ]\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/worksheets/feedback/{{feedbackId}}/response",
              "host": ["{{baseUrl}}"],
              "path": ["worksheets", "feedback", "{{feedbackId}}", "response"]
            },
            "description": "Add client response to therapist feedback (client only)"
          },
          "response": []
        },
        {
          "name": "Create Collaborative Note",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"worksheetId\": \"{{worksheetId}}\",\n  \"note\": \"We discussed this worksheet in today's session. Client showed great insight about the connection between gratitude practice and reduced anxiety. We agreed to continue this exercise while also introducing a new breathing technique worksheet next week.\",\n  \"type\": \"session_note\",\n  \"isSharedWithClient\": true,\n  \"actionItems\": [\n    \"Continue daily gratitude practice\",\n    \"Try progressive muscle relaxation before bed\",\n    \"Bring questions about emotional responses to next session\"\n  ]\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/worksheets/{{worksheetId}}/notes",
              "host": ["{{baseUrl}}"],
              "path": ["worksheets", "{{worksheetId}}", "notes"]
            },
            "description": "Create collaborative note about worksheet (therapist only)"
          },
          "response": []
        },
        {
          "name": "Get Worksheet Notes",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/worksheets/{{worksheetId}}/notes?includePrivate=false",
              "host": ["{{baseUrl}}"],
              "path": ["worksheets", "{{worksheetId}}", "notes"],
              "query": [
                {
                  "key": "includePrivate",
                  "value": "false"
                }
              ]
            },
            "description": "Get notes for a worksheet"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Progress Tracking",
      "item": [
        {
          "name": "Get Client Progress",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/worksheets/progress?clientId={{clientId}}&timeframe=month&includeMetrics=true",
              "host": ["{{baseUrl}}"],
              "path": ["worksheets", "progress"],
              "query": [
                {
                  "key": "clientId",
                  "value": "{{clientId}}"
                },
                {
                  "key": "timeframe",
                  "value": "month"
                },
                {
                  "key": "includeMetrics",
                  "value": "true"
                }
              ]
            },
            "description": "Get client's worksheet progress and metrics"
          },
          "response": []
        },
        {
          "name": "Get Completion Statistics",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/worksheets/statistics?clientId={{clientId}}&period=week&groupBy=template",
              "host": ["{{baseUrl}}"],
              "path": ["worksheets", "statistics"],
              "query": [
                {
                  "key": "clientId",
                  "value": "{{clientId}}"
                },
                {
                  "key": "period",
                  "value": "week"
                },
                {
                  "key": "groupBy",
                  "value": "template"
                }
              ]
            },
            "description": "Get worksheet completion statistics"
          },
          "response": []
        },
        {
          "name": "Get Mood Trends",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/worksheets/mood-trends?clientId={{clientId}}&period=month&includeComparison=true",
              "host": ["{{baseUrl}}"],
              "path": ["worksheets", "mood-trends"],
              "query": [
                {
                  "key": "clientId",
                  "value": "{{clientId}}"
                },
                {
                  "key": "period",
                  "value": "month"
                },
                {
                  "key": "includeComparison",
                  "value": "true"
                }
              ]
            },
            "description": "Get mood trends from worksheet data"
          },
          "response": []
        },
        {
          "name": "Export Progress Report",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/worksheets/export/progress?clientId={{clientId}}&format=pdf&period=month&includeDetails=true",
              "host": ["{{baseUrl}}"],
              "path": ["worksheets", "export", "progress"],
              "query": [
                {
                  "key": "clientId",
                  "value": "{{clientId}}"
                },
                {
                  "key": "format",
                  "value": "pdf"
                },
                {
                  "key": "period",
                  "value": "month"
                },
                {
                  "key": "includeDetails",
                  "value": "true"
                }
              ]
            },
            "description": "Export client progress report (therapist only)"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Error Handling & Validation",
      "item": [
        {
          "name": "Submit Worksheet - Missing Required Fields",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Returns 400 for missing required fields', function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "pm.test('Error message mentions validation', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson.message).to.include('required');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"worksheetId\": \"{{worksheetId}}\",\n  \"responses\": {\n    \"gratitude\": {\n      \"gratitude_1\": \"Something I'm grateful for\",\n      \"gratitude_2\": \"\",\n      \"gratitude_3\": \"\"\n    }\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/worksheets/submissions",
              "host": ["{{baseUrl}}"],
              "path": ["worksheets", "submissions"]
            },
            "description": "Test validation for incomplete worksheet submission"
          },
          "response": []
        },
        {
          "name": "Access Expired Assignment",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Returns 410 for expired assignment', function () {",
                  "    pm.response.to.have.status(410);",
                  "});",
                  "",
                  "pm.test('Error message mentions expiration', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson.message).to.include('expired');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/worksheets/assignments/{{expiredWorksheetId}}",
              "host": ["{{baseUrl}}"],
              "path": ["worksheets", "assignments", "{{expiredWorksheetId}}"]
            },
            "description": "Test access to expired worksheet assignment"
          },
          "response": []
        },
        {
          "name": "Unauthorized Template Access",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Returns 403 for unauthorized access', function () {",
                  "    pm.response.to.have.status(403);",
                  "});",
                  "",
                  "pm.test('Error message mentions permissions', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson.message).to.include('permission');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Trying to modify someone else's template\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/worksheets/templates/{{otherUserTemplateId}}",
              "host": ["{{baseUrl}}"],
              "path": ["worksheets", "templates", "{{otherUserTemplateId}}"]
            },
            "description": "Test unauthorized template modification"
          },
          "response": []
        }
      ]
    }
  ]
}